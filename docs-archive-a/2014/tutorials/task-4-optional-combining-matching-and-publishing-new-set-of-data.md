---
title: 'Задача 4 (необязательно): объединение, сопоставление и публикация нового набора данных | Документация Майкрософт'
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: data-quality-services
ms.topic: conceptual
ms.assetid: 13a13f03-b307-4555-8e33-6d98c459d994
author: lrtoyou1223
ms.author: lle
ms.openlocfilehash: 9ddcec19fa8b957bf77b6ea5269b4d033779bdf1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655458"
---
# <a name="task-4-optional-combining-matching-and-publishing-new-set-of-data"></a>Задача 4 (необязательно). Объединение, сопоставление и публикация нового набора данных
  Со временем в репозиторий MDS потребуется добавить дополнительные данные. Перед добавлением данных может оказаться полезным сравнить новые данные с данными, которые уже управляются в MDS, чтобы не добавлять дублирующиеся или неточные данные. В надстройке служб Master Data Services для Excel можно объединять данные из двух листов, а также сравнивать данные для обнаружения и удаления повторений перед публикацией данных в MDS. Функция сопоставления надстройки MDS для Excel использует функциональность сопоставления служб DQS для выявления совпадений в данных. В этой задаче будет выполнено объединение данных из двух листов в один, а затем будет выполнено действие для выявления и удаления повторений перед публикацией в MDS. Дополнительные сведения см. [в разделе Сопоставление качества данных в разделах надстройка MDS для Excel](https://msdn.microsoft.com/library/hh548681.aspx) и [Объединение данных](https://msdn.microsoft.com/library/hh548680.aspx) .  
  
1.  Запуск нового экземпляра **Excel**. Нажмите кнопку **Пуск**, наведите указатель на пункт **выполнить**, введите **Excel**и нажмите кнопку **ОК**.  
  
2.  Перейдите на вкладку **основные данные** , выбрав пункт **основные данные** в строке меню.  
  
3.  Нажмите кнопку **подключить** на ленте в группе **подключить и загрузить** , чтобы подключиться к **серверу MDS**. Это соединение было настроено ранее на этом занятии.  
  
     ![Excel — кнопка отображения обозревателя на вкладке основных данных](../../2014/tutorials/media/et-combinematchandpublishnewsod-01.jpg "Excel — кнопка отображения обозревателя на вкладке основных данных")  
  
4.  Справа появится область **Master обозреватель данных** . Если мастер обозреватель данных не отображается, нажмите кнопку **Показать обозреватель** на ленте.  
  
5.  В окне **главный обозреватель данных** в раскрывающемся списке **модели**выберите **поставщики** . Вы должны увидеть, что модель имеет одну сущность: **поставщик**.  
  
     ![Excel — окно обозревателя основных данных](../../2014/tutorials/media/et-combinematchandpublishnewsod-02.jpg "Excel — окно обозревателя основных данных")  
  
6.  Дважды щелкните **поставщик** в списке сущностей, чтобы загрузить элементы сущности в лист Excel.  
  
7.  Щелкните элемент **Лист2** внизу, чтобы перейти на вкладку **Лист2** . Если вы не видите элемент **Лист2**, добавьте новый лист.  
  
8.  Откройте файл **Suppliers.xls** (исходный входной файл, который включен в файлы учебников) и скопируйте все (три) строки из листа **комбинеандклеансе** в **Лист2**.  
  
9. Вернитесь к таблице **поставщиков** в **книге 1 — Microsoft Excel** (не **очищенный и сопоставленный список поставщиков** Excel), подключенный к **MDS**.  
  
10. В строке меню щелкните **основные данные** .  
  
11. Нажмите кнопку **объединить данные** на ленте. Вы увидите диалоговое окно **Объединение данных** .  
  
12. В диалоговом окне **Объединение данных** нажмите кнопку рядом с полем **диапазон для объединения с данными MDS** , как показано на следующем рисунке.  
  
     ![Excel — диалоговое окно «Объединение данных»](../../2014/tutorials/media/et-combinematchandpublishnewsod-03.jpg "Excel — диалоговое окно «Объединение данных»")  
  
13. Теперь должно отобразиться свернутое диалоговое окно. Теперь нажмите кнопку **Лист2** , чтобы перейти на вкладку **Лист2** с данными о новом поставщике с 4 строками (включая одну строку заголовка).  
  
14. На странице **Лист2**выберите **все строки, включая строку заголовка** (даже если они уже выбраны). Вы увидите, что **диапазон для объединения с данными MDS** обновляется автоматически.  
  
     ![Excel — диалоговое окно «Объединение данных» — минимизировано](../../2014/tutorials/media/et-combinematchandpublishnewsod-04.jpg "Excel — диалоговое окно «Объединение данных» — минимизировано")  
  
15. Вернитесь на вкладку **поставщики** , не закрывая диалоговое окно **Объединение данных** .  
  
16. Нажмите кнопку **рядом с** **текстовым полем**. Убедитесь, что диалоговое окно развернуто. Вы увидите, что все сопоставления столбцов **сущности** MDS **поставщика** с столбцами **Excel** заполняются автоматически.  
  
     ![Excel — диалоговое окно «Объединение данных» с данными](../../2014/tutorials/media/et-combinematchandpublishnewsod-05.jpg "Excel — диалоговое окно «Объединение данных» с данными")  
  
17. Убедитесь, что столбец сущности **кода** сопоставлен со столбцом « **КодПоставщика** » на листе, а столбец сущности « **почтовый** индекс» сопоставлен со столбцом « **почтовый** индекс» на листе.  
  
18. В диалоговом окне **Объединение данных** нажмите кнопку **объединить**.  
  
19. Убедитесь, что 3 строки данных были помещены в конец листа. Они должны быть выделены цветом.  
  
     ![Excel — новые элементы после объединения](../../2014/tutorials/media/et-combinematchandpublishnewsod-06.jpg "Excel — новые элементы после объединения")  
  
20. Щелкните **математические данные** на ленте, чтобы выделить дубликаты. Эта функция использует функции сопоставления служб DQS.  
  
21. В диалоговом окне **сопоставление данных** выберите **поставщики** для **базы знаний DQS**.  
  
     ![Excel — диалоговое окно «Сопоставление данных»](../../2014/tutorials/media/et-combinematchandpublishnewsod-07.jpg "Excel — диалоговое окно «Сопоставление данных»")  
  
22. Сопоставьте столбцы листа с доменами, как показано в следующей таблице.  
  
    |Столбец листа|Домен|  
    |----------------------|------------|  
    |Code (Supplier ID был загружен как Code для сущности Supplier в MDS)|Supplier ID|  
    |Name (Supplier Name было загружено как Name для сущности Supplier в MDS)|Имя поставщика|  
    |ContactEmailAddress|ContactEmail|  
  
23. Выберите **необходимый компонент** для сопоставления столбцов **кода** .  
  
24. Введите **70%** в качестве **веса** для **имени поставщика** и **30%** в качестве **веса** для **контактного адреса электронной почты** , как показано на рисунке.  
  
25. Нажмите кнопку **ОК**.  
  
26. Процесс сопоставления должен обозначать один дубликат для поставщика с **кодом: S1**.  
  
     ![Excel — результаты сопоставления](../../2014/tutorials/media/et-combinematchandpublishnewsod-08.jpg "Excel — результаты сопоставления")  
  
27. Выберите **повторяющуюся строку (оранжевый)**, щелкните ее правой кнопкой мыши и нажмите кнопку **Удалить** , чтобы удалить строку.  
  
28. Удалите столбец **CLUSTER_ID** , так как он больше не нужен.  
  
29. Щелкните **опубликовать** , чтобы опубликовать две новые записи с **кодами S66** и **S57** в MDS.  
  
30. В диалоговом окне **Публикация и заметки** добавьте **заметку**и нажмите кнопку **опубликовать**.  
  
31. Переключитесь на **Диспетчер основных данных веб-приложение**.  
  
32. На домашней странице убедитесь, что для **модели**выбраны **поставщики** , и нажмите кнопку **Обозреватель**. Если **Обозреватель** уже открыт, обновите веб – браузер.  
  
33. **Отсортируйте** список по **коду** и ищите записи с **S57** и **S66** в виде кодов. Можно также использовать кнопку **Фильтр** на панели инструментов для поиска конкретной записи в списке.  
  
34. Теперь закройте окно **book1 — Microsoft Excel** без сохранения файла.  
  
## <a name="next-step"></a>Следующий шаг  
 [Задача 5. Создание атрибута на основе домена в Excel](../../2014/tutorials/task-5-creating-a-domain-based-attribute-from-excel.md)  
  
  
