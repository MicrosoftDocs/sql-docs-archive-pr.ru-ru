---
title: Создание прогнозов в модели кластеризации последовательностей (учебник по интеллектуальному анализу данных — средний уровень) | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 94a8d4f9-a76a-49c5-9785-917010359511
author: minewiskan
ms.author: owend
manager: kfilee
ms.openlocfilehash: 2402c28a564502df9ce12c5e3f97b9d19590cfea
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87653981"
---
# <a name="creating-predictions-on-a-sequence-clustering-model-intermediate-data-mining-tutorial"></a><span data-ttu-id="670b2-102">Создание прогнозов для модели кластеризации последовательностей (учебник по интеллектуальному анализу данных — средний уровень)</span><span class="sxs-lookup"><span data-stu-id="670b2-102">Creating Predictions on a Sequence Clustering Model (Intermediate Data Mining Tutorial)</span></span>
  <span data-ttu-id="670b2-103">После того, как модель кластеризации последовательностей будет лучше понять, просмотрев ее в средстве просмотра, можно создать прогнозирующие запросы с помощью конструктор запросов прогнозирования на вкладке **Прогноз модели интеллектуального анализа** данных в конструкторе интеллектуального анализа.</span><span class="sxs-lookup"><span data-stu-id="670b2-103">After you understand the sequence clustering model better by browsing it in the viewer, you can create prediction queries by using Prediction Query Builder on the **Mining Model Prediction** tab in Data Mining Designer.</span></span> <span data-ttu-id="670b2-104">Чтобы создать прогноз, сначала необходимо выбрать модель кластеризации последовательностей, а затем входные данные.</span><span class="sxs-lookup"><span data-stu-id="670b2-104">To create a prediction, you first select the sequence clustering model, and then select the input data.</span></span> <span data-ttu-id="670b2-105">Входные данные можно выбрать из внешнего источника данных или можно создать одноэлементный запрос и предоставить значения в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="670b2-105">For inputs, you can use either an external data source, or you can build a singleton query and provide values in a dialog box.</span></span>  
  
 <span data-ttu-id="670b2-106">В этом занятии предполагается, что вы уже знакомы с работой построителя прогнозирующих запросов и хотите научиться создавать запросы, относящиеся к модели кластеризации последовательностей.</span><span class="sxs-lookup"><span data-stu-id="670b2-106">This lesson assumes that you are already familiar with how to use the prediction query builder and want to learn how to build queries that are specific to a sequence clustering model.</span></span> <span data-ttu-id="670b2-107">Общие сведения об использовании конструктор запросов прогнозирования см. в статьях [интерфейсы запросов интеллектуального](../../2014/analysis-services/data-mining/data-mining-query-tools.md) анализа данных или в разделе учебника по интеллектуальному анализу данных — [создание прогнозов &#40;учебник по интеллектуальному анализу данных&#41;](../../2014/tutorials/creating-predictions-basic-data-mining-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="670b2-107">For general information about how to use Prediction Query Builder, see [Data Mining Query Interfaces](../../2014/analysis-services/data-mining/data-mining-query-tools.md) or the section of the Basic Data Mining tutorial, [Creating Predictions &#40;Basic Data Mining Tutorial&#41;](../../2014/tutorials/creating-predictions-basic-data-mining-tutorial.md).</span></span>  
  
## <a name="creating-predictions-on-the-regional-model"></a><span data-ttu-id="670b2-108">Создание прогнозов для региональной модели</span><span class="sxs-lookup"><span data-stu-id="670b2-108">Creating Predictions on the Regional Model</span></span>  
 <span data-ttu-id="670b2-109">В этом сценарии сначала будет создано несколько одноэлементных прогнозирующих запросов, чтобы получить представление о том, насколько прогнозы могут отличаться друг от друга в зависимости от региона.</span><span class="sxs-lookup"><span data-stu-id="670b2-109">For this scenario, you will first create some singleton prediction queries, to get an idea of how predictions might be different by region.</span></span>  
  
#### <a name="to-create-a-singleton-query-on-a-sequence-clustering-model"></a><span data-ttu-id="670b2-110">Создание одноэлементного запроса к модели кластеризации последовательностей</span><span class="sxs-lookup"><span data-stu-id="670b2-110">To create a singleton query on a sequence clustering model</span></span>  
  
1.  <span data-ttu-id="670b2-111">Перейдите на вкладку **Прогноз модели интеллектуального анализа** данных конструктора интеллектуального анализа.</span><span class="sxs-lookup"><span data-stu-id="670b2-111">Click the **Mining Model Prediction** tab of Data Mining Designer.</span></span>  
  
2.  <span data-ttu-id="670b2-112">В меню столбец **модели интеллектуального анализа данных** выберите **одноэлементный запрос**.</span><span class="sxs-lookup"><span data-stu-id="670b2-112">In the **Mining Model** column menu, select **Singleton Query**.</span></span>  
  
     <span data-ttu-id="670b2-113">Появится панель **модель интеллектуального анализа данных** и **одноэлементный запрос** .</span><span class="sxs-lookup"><span data-stu-id="670b2-113">The **Mining Model** pane and **Singleton Query Input** pane appear.</span></span>  
  
3.  <span data-ttu-id="670b2-114">На панели **модель интеллектуального анализа данных** щелкните **выбрать модель**.</span><span class="sxs-lookup"><span data-stu-id="670b2-114">In the **Mining Model** pane, click **Select Model**.</span></span> <span data-ttu-id="670b2-115">(Если модель кластеризации последовательностей уже выбрана, этот шаг можно пропустить.)</span><span class="sxs-lookup"><span data-stu-id="670b2-115">(You can skip this step if the sequence clustering mode is already selected.)</span></span>  
  
     <span data-ttu-id="670b2-116">Откроется диалоговое окно **Выбор модели интеллектуального анализа данных** .</span><span class="sxs-lookup"><span data-stu-id="670b2-116">The **Select Mining Model** dialog box opens.</span></span>  
  
4.  <span data-ttu-id="670b2-117">Разверните узел, представляющий структуру интеллектуального анализа данных **Кластеризация последовательностей с помощью региона**, и выберите модель **Кластеризация последовательностей с регионом**.</span><span class="sxs-lookup"><span data-stu-id="670b2-117">Expand the node that represents the mining structure **Sequence Clustering with Region**, and select the model **Sequence Clustering with Region**.</span></span> <span data-ttu-id="670b2-118">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="670b2-118">Click **OK**.</span></span> <span data-ttu-id="670b2-119">На данном этапе входная панель не учитывается. Входные данные нужно будет указать после настройки прогнозирующих функций.</span><span class="sxs-lookup"><span data-stu-id="670b2-119">For now, ignore the input pane; you will specify the inputs after you have set up the prediction functions.</span></span>  
  
5.  <span data-ttu-id="670b2-120">В сетке щелкните пустую ячейку в разделе **источник** и выберите **функция прогнозирования.**</span><span class="sxs-lookup"><span data-stu-id="670b2-120">In the grid, click the empty cell under **Source** and select **Prediction Function.**</span></span> <span data-ttu-id="670b2-121">В **поле**в ячейке выберите **PredictSequence**.</span><span class="sxs-lookup"><span data-stu-id="670b2-121">In the cell under **Field**, select **PredictSequence**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="670b2-122">Можно также использовать функцию **Predict** .</span><span class="sxs-lookup"><span data-stu-id="670b2-122">You can also use the **Predict** function.</span></span> <span data-ttu-id="670b2-123">В этом случае выберите версию функции **Predict** , которая принимает столбец таблицы в качестве аргумента.</span><span class="sxs-lookup"><span data-stu-id="670b2-123">If you do, be sure to choose the version of the **Predict** function that takes a table column as argument..</span></span>  
  
6.  <span data-ttu-id="670b2-124">На панели **модель интеллектуального анализа данных** выберите вложенную таблицу `v Assoc Seq Line Items` и перетащите ее в сетку в поле **критерий или аргумент** для функции **PredictSequence** .</span><span class="sxs-lookup"><span data-stu-id="670b2-124">In the **Mining Model** pane, select the nested table `v Assoc Seq Line Items`, and drag it into the grid, to the **Criteria/Argument** box for the **PredictSequence** function.</span></span>  
  
     <span data-ttu-id="670b2-125">Путем перетаскивания имен таблиц и столбцов можно создавать сложные инструкции без синтаксических ошибок.</span><span class="sxs-lookup"><span data-stu-id="670b2-125">Dragging and dropping table and column names enables you to build complex statements without syntax errors.</span></span> <span data-ttu-id="670b2-126">Однако он заменяет текущее содержимое ячейки, которое содержит другие необязательные аргументы функции **PredictSequence** .</span><span class="sxs-lookup"><span data-stu-id="670b2-126">However, it replaces the current contents of the cell, which include other optional arguments for the **PredictSequence** function.</span></span> <span data-ttu-id="670b2-127">Чтобы просмотреть другие аргументы, можно на время добавить в сетку второй экземпляр функции и использовать его для справки.</span><span class="sxs-lookup"><span data-stu-id="670b2-127">To view the other arguments, you can temporarily add a second instance of the function to the grid for reference.</span></span>  
  
7.  <span data-ttu-id="670b2-128">Нажмите кнопку **результат** в верхнем углу конструктор запросов прогноза.</span><span class="sxs-lookup"><span data-stu-id="670b2-128">Click the **Result** button in the upper corner of the Prediction Query Builder.</span></span>  
  
 <span data-ttu-id="670b2-129">Ожидаемые результаты содержат один столбец с **выражением**заголовка.</span><span class="sxs-lookup"><span data-stu-id="670b2-129">The expected results contain a single column with the heading **Expression**.</span></span> <span data-ttu-id="670b2-130">Столбец **выражение** содержит вложенную таблицу с тремя столбцами, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="670b2-130">The **Expression** column contains a nested table with three columns as follows:</span></span>  
  
|<span data-ttu-id="670b2-131">$SEQUENCE</span><span class="sxs-lookup"><span data-stu-id="670b2-131">$SEQUENCE</span></span>|<span data-ttu-id="670b2-132">Line Number</span><span class="sxs-lookup"><span data-stu-id="670b2-132">Line Number</span></span>|<span data-ttu-id="670b2-133">Модель</span><span class="sxs-lookup"><span data-stu-id="670b2-133">Model</span></span>|  
|---------------|-----------------|-----------|  
|<span data-ttu-id="670b2-134">1</span><span class="sxs-lookup"><span data-stu-id="670b2-134">1</span></span>||<span data-ttu-id="670b2-135">Велосипед Mountain-200</span><span class="sxs-lookup"><span data-stu-id="670b2-135">Mountain-200</span></span>|  
  
 <span data-ttu-id="670b2-136">Что означают эти результаты?</span><span class="sxs-lookup"><span data-stu-id="670b2-136">What do these results mean?</span></span> <span data-ttu-id="670b2-137">Помните, что входные данные не были указаны.</span><span class="sxs-lookup"><span data-stu-id="670b2-137">Remember that you did not specify any inputs.</span></span> <span data-ttu-id="670b2-138">Следовательно, прогноз создается для всей совокупности вариантов, а службы Analysis Services возвращают наиболее вероятный общий прогноз.</span><span class="sxs-lookup"><span data-stu-id="670b2-138">Therefore, the prediction is made against the entire population of cases, and Analysis Services returns the most likely prediction overall.</span></span>  
  
### <a name="adding-inputs-to-a-singleton-prediction-query"></a><span data-ttu-id="670b2-139">Добавление входных данных к одноэлементному прогнозирующему запросу</span><span class="sxs-lookup"><span data-stu-id="670b2-139">Adding Inputs to a Singleton Prediction Query</span></span>  
 <span data-ttu-id="670b2-140">До настоящего момента никакие входные данные не были указаны.</span><span class="sxs-lookup"><span data-stu-id="670b2-140">Until now, you have not specified any inputs.</span></span> <span data-ttu-id="670b2-141">В следующей задаче будет использоваться панель **ввода одноэлементного запроса** , чтобы указать некоторые входные данные для запроса.</span><span class="sxs-lookup"><span data-stu-id="670b2-141">In the next task, you will use the **Singleton Query Input** pane to specify some inputs to the query.</span></span> <span data-ttu-id="670b2-142">Во-первых, необходимо использовать столбец [Region] в качестве входных данных для региональной модели кластеризации последовательностей, чтобы определить, одинаковы ли спрогнозированные последовательности для всех регионов.</span><span class="sxs-lookup"><span data-stu-id="670b2-142">First, you will use [Region] as an input to the regional sequence clustering model, to determine whether the predicted sequences are the same for all regions.</span></span> <span data-ttu-id="670b2-143">Затем будет рассмотрено, как изменить запрос, чтобы добавить вероятность для каждого прогноза, а также как преобразовать результаты в плоский формат для более удобного просмотра.</span><span class="sxs-lookup"><span data-stu-id="670b2-143">You will then learn how to modify the query to add the probability for each prediction, and flatten the results to make them easier to view.</span></span>  
  
##### <a name="to-generate-predictions-for-a-specific-customer-group"></a><span data-ttu-id="670b2-144">Создание прогнозов для определенной группы клиентов</span><span class="sxs-lookup"><span data-stu-id="670b2-144">To generate predictions for a specific customer group</span></span>  
  
1.  <span data-ttu-id="670b2-145">Нажмите кнопку **конструктор** в верхнем левом углу конструктор запросов прогнозирования, чтобы вернуться к сетке создания запросов.</span><span class="sxs-lookup"><span data-stu-id="670b2-145">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="670b2-146">В диалоговом окне **Ввод одноэлементного запроса** щелкните поле **значение** для `Region` и выберите **Европа**.</span><span class="sxs-lookup"><span data-stu-id="670b2-146">In the **Singleton Query Input** dialog box, click the **Value** box for `Region`, and select **Europe**.</span></span>  
  
3.  <span data-ttu-id="670b2-147">Нажмите кнопку **результат** , чтобы просмотреть прогнозы для клиентов в Европе.</span><span class="sxs-lookup"><span data-stu-id="670b2-147">Click the **Result** button to view predictions for customers in Europe.</span></span>  
  
4.  <span data-ttu-id="670b2-148">Нажмите кнопку **конструктор** в верхнем левом углу конструктор запросов прогнозирования, чтобы вернуться к сетке создания запросов.</span><span class="sxs-lookup"><span data-stu-id="670b2-148">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
5.  <span data-ttu-id="670b2-149">В диалоговом окне **Ввод одноэлементного запроса** щелкните поле **значение** для `Region` и выберите **Северная Америка**.</span><span class="sxs-lookup"><span data-stu-id="670b2-149">In the **Singleton Query Input** dialog box, click the **Value** box for `Region`, and select **North America**.</span></span>  
  
6.  <span data-ttu-id="670b2-150">Нажмите кнопку **результат** , чтобы просмотреть прогнозы для клиентов в Северная Америка.</span><span class="sxs-lookup"><span data-stu-id="670b2-150">Click the **Result** button to view predictions for customers in North America.</span></span>  
  
### <a name="adding-probabilities-by-using-a-custom-expression"></a><span data-ttu-id="670b2-151">Добавление вероятностей с помощью пользовательского выражения</span><span class="sxs-lookup"><span data-stu-id="670b2-151">Adding Probabilities by Using a Custom Expression</span></span>  
 <span data-ttu-id="670b2-152">Немного сложнее получить степень вероятности для каждого прогноза, поскольку вероятность является атрибутом прогноза и выводится в виде вложенной таблицы.</span><span class="sxs-lookup"><span data-stu-id="670b2-152">To output the probability for each prediction is slightly more complicated, because the probability is an attribute of the prediction and is output as a nested table.</span></span> <span data-ttu-id="670b2-153">Владея языком расширений интеллектуального анализа данных (DMX), запрос можно легко изменить, добавив в него инструкцию подзапроса выборки для вложенной таблицы.</span><span class="sxs-lookup"><span data-stu-id="670b2-153">If you are familiar with Data Mining Extensions (DMX), you can easily alter the query to add a sub-select statement on the nested table.</span></span> <span data-ttu-id="670b2-154">При этом инструкцию подзапроса выборки также можно создать и в построителе прогнозирующих запросов путем добавления пользовательского выражения.</span><span class="sxs-lookup"><span data-stu-id="670b2-154">However, you can also create a sub-select statement in the Prediction Query Builder by adding a custom expression.</span></span>  
  
##### <a name="to-output-probabilities-for-a-predicted-sequence-by-using-a-custom-expression"></a><span data-ttu-id="670b2-155">Вывод вероятностей для прогнозируемой последовательности с помощью пользовательского выражения</span><span class="sxs-lookup"><span data-stu-id="670b2-155">To output probabilities for a predicted sequence by using a custom expression</span></span>  
  
1.  <span data-ttu-id="670b2-156">Нажмите кнопку **конструктор** в верхнем левом углу конструктор запросов прогнозирования, чтобы вернуться к сетке создания запросов.</span><span class="sxs-lookup"><span data-stu-id="670b2-156">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="670b2-157">В сетке в разделе **источник**щелкните новую строку и выберите **пользовательское выражение**.</span><span class="sxs-lookup"><span data-stu-id="670b2-157">In the grid, under **Source**, click a new row, and select **Custom Expression**.</span></span>  
  
3.  <span data-ttu-id="670b2-158">Оставьте **поле в поле пустым.**</span><span class="sxs-lookup"><span data-stu-id="670b2-158">Leave the box under **Field** blank.</span></span>  
  
4.  <span data-ttu-id="670b2-159">В качестве **псевдонима**введите `t` .</span><span class="sxs-lookup"><span data-stu-id="670b2-159">For **Alias**, type `t`.</span></span>  
  
5.  <span data-ttu-id="670b2-160">В поле **критерий или аргумент** введите полную инструкцию подзапроса выборки, как показано в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="670b2-160">In the **Criteria/Argument** box, type the complete sub-select statement as shown in the following code sample.</span></span> <span data-ttu-id="670b2-161">Не забудьте включить открывающую и закрывающую круглые скобки.</span><span class="sxs-lookup"><span data-stu-id="670b2-161">Be sure to include the starting and ending parentheses.</span></span>  
  
    ```  
    (SELECT PredictProbability([Model]) FROM PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]))  
    ```  
  
6.  <span data-ttu-id="670b2-162">Нажмите кнопку **результат** , чтобы просмотреть прогнозы для клиентов в Европе.</span><span class="sxs-lookup"><span data-stu-id="670b2-162">Click the **Result** button to view predictions for customers in Europe.</span></span>  
  
 <span data-ttu-id="670b2-163">Теперь результаты содержат две вложенные таблицы, в первой из которых указан прогноз, а во второй — степень вероятности этого прогноза.</span><span class="sxs-lookup"><span data-stu-id="670b2-163">The results now contain two nested tables, one with the prediction, and one with the probability for the prediction.</span></span> <span data-ttu-id="670b2-164">Если запрос не работает, можно переключиться в режим проектирования запросов и проверить полную инструкцию запроса, которая должна иметь следующий вид:</span><span class="sxs-lookup"><span data-stu-id="670b2-164">If the query does not work, you can switch to query design view and review the complete query statement, which should be as follows:</span></span>  
  
```  
SELECT  
  PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]),  
  ( (SELECT PredictProbability([Model]) FROM PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]))) as [t]  
FROM  
  [Sequence Clustering with Region]  
NATURAL PREDICTION JOIN  
(SELECT 'Europe' AS [Region]) AS t  
```  
  
### <a name="working-with-results"></a><span data-ttu-id="670b2-165">Работа с результатами</span><span class="sxs-lookup"><span data-stu-id="670b2-165">Working with Results</span></span>  
 <span data-ttu-id="670b2-166">Если результаты содержат много вложенных таблиц, такие результаты можно преобразовать в плоский формат для более удобного просмотра.</span><span class="sxs-lookup"><span data-stu-id="670b2-166">When there are many nested tables in the results, you might want to flatten the results for easier viewing.</span></span> <span data-ttu-id="670b2-167">С этой целью можно вручную изменить запрос и добавить ключевое слово `FLATTENED`.</span><span class="sxs-lookup"><span data-stu-id="670b2-167">To do this, you can manually modify the query and add the `FLATTENED` keyword.</span></span>  
  
##### <a name="to-flatten-nested-rowsets-in-a-prediction-query"></a><span data-ttu-id="670b2-168">Преобразование вложенных наборов строк в плоский формат в прогнозирующем запросе</span><span class="sxs-lookup"><span data-stu-id="670b2-168">To flatten nested rowsets in a prediction query</span></span>  
  
1.  <span data-ttu-id="670b2-169">Нажмите кнопку **запроса** в углу конструктор запросов прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="670b2-169">Click the **Query** button in the corner of the Prediction Query Builder.</span></span>  
  
     <span data-ttu-id="670b2-170">Сетка будет преобразована в открытую панель, в которой можно просмотреть и изменить инструкцию DMX, созданную построителем прогнозирующих запросов.</span><span class="sxs-lookup"><span data-stu-id="670b2-170">The grid changes to an open pane where you can view and modify the DMX statement that was created by the Prediction Query Builder.</span></span>  
  
2.  <span data-ttu-id="670b2-171">После ключевого слова `SELECT` введите `FLATTENED`.</span><span class="sxs-lookup"><span data-stu-id="670b2-171">After the `SELECT` keyword, type `FLATTENED`.</span></span>  
  
     <span data-ttu-id="670b2-172">Полный текст запроса должен быть аналогичен следующему:</span><span class="sxs-lookup"><span data-stu-id="670b2-172">The complete text of the query should be similar to the following:</span></span>  
  
    ```  
    SELECT FLATTENED  
      PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]),  
      ( (SELECT PredictProbability([Model]) FROM PredictSequence([Sequence Clustering with Region].[v Assoc Seq Line Items]))) as [t]  
    FROM  
      [Sequence Clustering with Region]  
    NATURAL PREDICTION JOIN  
    (SELECT 'Europe' AS [Region]) AS t  
    ```  
  
3.  <span data-ttu-id="670b2-173">Нажмите кнопку **результаты** в верхнем углу конструктор запросов прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="670b2-173">Click the **Results** button in the upper corner of the Prediction Query Builder.</span></span>  
  
 <span data-ttu-id="670b2-174">После редактирования запроса вручную нельзя вернуться в конструктор, не потеряв изменения.</span><span class="sxs-lookup"><span data-stu-id="670b2-174">After you have manually edited a query, you will not be able to switch back to Design view without losing the changes.</span></span> <span data-ttu-id="670b2-175">Тем не менее созданную вручную инструкцию DMX можно сохранить в текстовый файл, а затем снова вернуться в конструктор.</span><span class="sxs-lookup"><span data-stu-id="670b2-175">You can, however, save the DMX statement that you created manually to a text file, and then change back to Design view.</span></span> <span data-ttu-id="670b2-176">При этом в окне конструктора будет восстанавливаться последняя версия запроса, имевшаяся до выхода из него.</span><span class="sxs-lookup"><span data-stu-id="670b2-176">When you do so, the query is reverted to the last version that was valid in Design view.</span></span>  
  
## <a name="creating-predictions-on-the-related-model"></a><span data-ttu-id="670b2-177">Создание прогнозов для связанной модели</span><span class="sxs-lookup"><span data-stu-id="670b2-177">Creating Predictions on the Related Model</span></span>  
 <span data-ttu-id="670b2-178">В предыдущих примерах в качестве входных данных для одноэлементного прогнозирующего запроса использовался столбец Region в таблице вариантов, так как вам было интересно узнать, нашла ли модель какие-либо различия между регионами.</span><span class="sxs-lookup"><span data-stu-id="670b2-178">The previous examples used a case table column, Region, as the input to the singleton prediction query, because you were interested in knowing whether the model had found any differences between regions.</span></span> <span data-ttu-id="670b2-179">Однако после изучения модели стало понятно, что эти различия недостаточно существенны для составления рекомендаций по товарам на основании региона.</span><span class="sxs-lookup"><span data-stu-id="670b2-179">However, after exploring the model, you decided that the differences are not strong enough to justify customizing product recommendations by region.</span></span> <span data-ttu-id="670b2-180">Что вас действительно интересует в прогнозировании — это элементы, выбираемые клиентами.</span><span class="sxs-lookup"><span data-stu-id="670b2-180">What you are really interested in predicting is the items that customers select.</span></span> <span data-ttu-id="670b2-181">Поэтому в последующих запросах будет использована модель кластеризации последовательностей, не содержащая столбец Region, в целях создания рекомендаций для всех клиентов.</span><span class="sxs-lookup"><span data-stu-id="670b2-181">Therefore, in the queries that follow, you will use the sequence clustering model that does not include Region, to generate recommendations for all customers.</span></span>  
  
### <a name="using-nested-table-columns-as-input"></a><span data-ttu-id="670b2-182">Использование столбцов вложенной таблицы в качестве входных данных</span><span class="sxs-lookup"><span data-stu-id="670b2-182">Using Nested Table Columns as Input</span></span>  
 <span data-ttu-id="670b2-183">Прежде всего необходимо создать одноэлементный прогнозирующий запрос, который в качестве входных данных использует один элемент и возвращает следующий наиболее вероятный элемент.</span><span class="sxs-lookup"><span data-stu-id="670b2-183">First you will create a singleton prediction query that takes a single item as input and returns the next most likely item.</span></span> <span data-ttu-id="670b2-184">Чтобы получить прогноз такого типа, нужно в качестве входного значения использовать столбец вложенной таблицы.</span><span class="sxs-lookup"><span data-stu-id="670b2-184">To get a prediction of this kind, you have to use a nested table column as the input value.</span></span> <span data-ttu-id="670b2-185">Это требование вызвано тем, что прогнозируемый атрибут Model является частью вложенной таблицы.</span><span class="sxs-lookup"><span data-stu-id="670b2-185">This is because the attribute that you are predicting, Model, is part of a nested table.</span></span> <span data-ttu-id="670b2-186">Analysis Services предоставляет диалоговое окно **входные данные вложенной таблицы** , помогающее легко создавать прогнозирующие запросы к атрибутам вложенной таблицы с помощью конструктор запросов прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="670b2-186">Analysis Services provides the **Nested Table Input** dialog box to help you easily create prediction queries on nested table attributes, by using the Prediction Query Builder.</span></span>  
  
##### <a name="to-use-a-nested-table-as-input-to-a-prediction"></a><span data-ttu-id="670b2-187">Использование вложенной таблицы в качестве входных данных для прогноза</span><span class="sxs-lookup"><span data-stu-id="670b2-187">To use a nested table as input to a prediction</span></span>  
  
1.  <span data-ttu-id="670b2-188">Нажмите кнопку **конструктор** в верхнем левом углу конструктор запросов прогнозирования, чтобы вернуться к сетке создания запросов.</span><span class="sxs-lookup"><span data-stu-id="670b2-188">Click the **Design** button in the upper left-hand corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="670b2-189">В диалоговом окне **Ввод одноэлементного запроса** щелкните поле **значение** для `Region` и выберите пустую строку, чтобы очистить входные данные для этого поля.</span><span class="sxs-lookup"><span data-stu-id="670b2-189">In the **Singleton Query Input** dialog box, click the **Value** box for `Region`, and select the empty row to clear the input for this field.</span></span>  
  
3.  <span data-ttu-id="670b2-190">В диалоговом окне **Ввод одноэлементного запроса** щелкните поле **значение** для `vAssocSeqLineItems` , а затем нажмите кнопку (...).</span><span class="sxs-lookup"><span data-stu-id="670b2-190">In the **Singleton Query Input** dialog box, click the **Value** box for `vAssocSeqLineItems`, and then click the (...) button.</span></span>  
  
4.  <span data-ttu-id="670b2-191">В диалоговом окне **входные данные вложенной таблицы** нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="670b2-191">In the **Nested Table Input** dialog box, click **Add**.</span></span>  
  
5.  <span data-ttu-id="670b2-192">В новой строке щелкните поле в разделе `Model` и выберите в списке пункт Туристический велосипед.</span><span class="sxs-lookup"><span data-stu-id="670b2-192">In the new row, click the box under `Model`, and select Touring Tire from the list.</span></span> <span data-ttu-id="670b2-193">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="670b2-193">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="670b2-194">Нажмите кнопку **результат** , чтобы просмотреть прогнозы.</span><span class="sxs-lookup"><span data-stu-id="670b2-194">Click the **Result** button to view the predictions.</span></span>  
  
 <span data-ttu-id="670b2-195">Модель рекомендует следующие элементы, перечисленные ниже, для всех клиентов, выбравших в качестве первого элемента шину для велосипеда (Touring Tire).</span><span class="sxs-lookup"><span data-stu-id="670b2-195">The model recommends the following next items for all customers who choose the Touring Tire as the first item.</span></span> <span data-ttu-id="670b2-196">В результате изучения модели уже становится известно, что товары Touring Tire и Touring Tire Tube часто приобретаются клиентами вместе. Следовательно, эти рекомендации вполне обоснованы.</span><span class="sxs-lookup"><span data-stu-id="670b2-196">You already know from exploring the model that customers frequently purchase the products Touring Tire and Touring Tire Tube together, so these recommendations look good.</span></span>  
  
|<span data-ttu-id="670b2-197">$SEQUENCE</span><span class="sxs-lookup"><span data-stu-id="670b2-197">$SEQUENCE</span></span>|<span data-ttu-id="670b2-198">Line Number</span><span class="sxs-lookup"><span data-stu-id="670b2-198">Line Number</span></span>|<span data-ttu-id="670b2-199">Модель</span><span class="sxs-lookup"><span data-stu-id="670b2-199">Model</span></span>|  
|---------------|-----------------|-----------|  
|<span data-ttu-id="670b2-200">1</span><span class="sxs-lookup"><span data-stu-id="670b2-200">1</span></span>||<span data-ttu-id="670b2-201">Камера для покрышки туристического велосипеда</span><span class="sxs-lookup"><span data-stu-id="670b2-201">Touring Tire Tube</span></span>|  
|<span data-ttu-id="670b2-202">2</span><span class="sxs-lookup"><span data-stu-id="670b2-202">2</span></span>||<span data-ttu-id="670b2-203">Sport-100</span><span class="sxs-lookup"><span data-stu-id="670b2-203">Sport-100</span></span>|  
|<span data-ttu-id="670b2-204">3</span><span class="sxs-lookup"><span data-stu-id="670b2-204">3</span></span>||<span data-ttu-id="670b2-205">Кофта с длинными рукавами и эмблемой</span><span class="sxs-lookup"><span data-stu-id="670b2-205">Long-Sleeve Logo Jersey</span></span>|  
  
### <a name="creating-a-bulk-prediction-query-using-nested-table-inputs"></a><span data-ttu-id="670b2-206">Создание массового прогнозирующего запроса, используя входные данные вложенной таблицы</span><span class="sxs-lookup"><span data-stu-id="670b2-206">Creating a Bulk Prediction Query using Nested Table Inputs</span></span>  
 <span data-ttu-id="670b2-207">Теперь, когда модель создает прогнозы, которые можно использовать для предоставления рекомендаций, нужно создать прогнозирующий запрос, который сопоставляется с внешним источником данных.</span><span class="sxs-lookup"><span data-stu-id="670b2-207">Now that you are satisfied that the model creates the kind of predictions that you can use in making recommendations, you will create a prediction query that is mapped to an external data source.</span></span> <span data-ttu-id="670b2-208">Из источника данных будут взяты значения, представляющие текущие продукты.</span><span class="sxs-lookup"><span data-stu-id="670b2-208">That data source will provide values representing current products.</span></span> <span data-ttu-id="670b2-209">Поскольку необходимо создать прогнозирующий запрос, предоставляющий идентификатор клиента и список продуктов в качестве входных данных, потребуется добавить таблицу клиентов в качестве таблицы вариантов и таблицу покупок в качестве вложенной таблицы.</span><span class="sxs-lookup"><span data-stu-id="670b2-209">Because you are interested in creating a prediction query that provides Customer ID and a list of products as input, you will add the customer table as the case table, and the purchases table as the nested table.</span></span> <span data-ttu-id="670b2-210">Затем нужно добавить прогнозирующие функции для создания рекомендаций, как это делалось ранее.</span><span class="sxs-lookup"><span data-stu-id="670b2-210">Then you will add prediction functions as you did previously to create recommendations.</span></span>  
  
 <span data-ttu-id="670b2-211">Данная процедура аналогична процедуре создания прогнозов в сценарии потребительской корзины, описанном в занятии 3. Однако в модели кластеризации последовательностей для прогнозов также нужно указать заказ в качестве входных данных.</span><span class="sxs-lookup"><span data-stu-id="670b2-211">This is the same procedure that you use to create predictions for the market basket scenario in Lesson 3; however, in a sequence clustering model predictions also need the order as input.</span></span>  
  
##### <a name="to-create-a-prediction-query-using-nested-table-inputs"></a><span data-ttu-id="670b2-212">Создание прогнозирующего запроса с использованием входных данных вложенной таблицы</span><span class="sxs-lookup"><span data-stu-id="670b2-212">To create a prediction query using nested table inputs</span></span>  
  
1.  <span data-ttu-id="670b2-213">На панели **модель интеллектуального анализа данных** выберите модель кластеризации последовательностей, если она еще не выбрана.</span><span class="sxs-lookup"><span data-stu-id="670b2-213">In the **Mining Model** pane, select the Sequence Clustering model, if it is not already selected.</span></span>  
  
2.  <span data-ttu-id="670b2-214">В диалоговом окне **Выбор входных таблиц** нажмите кнопку **выбрать таблицу вариантов**.</span><span class="sxs-lookup"><span data-stu-id="670b2-214">In the **Select Input Table(s)** dialog box, click **Select Case Table**.</span></span>  
  
3.  <span data-ttu-id="670b2-215">В диалоговом окне **Выбор таблицы** для поля источник данных выберите заказы.</span><span class="sxs-lookup"><span data-stu-id="670b2-215">In the **Select Table** dialog box, for Data Source, select Orders.</span></span> <span data-ttu-id="670b2-216">В списке **имя таблицы или представления** выберите vAssocSeqOrders и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="670b2-216">In the **Table/View Name** list, select vAssocSeqOrders, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="670b2-217">В диалоговом окне **Выбор входных таблиц** нажмите кнопку **выбрать вложенную таблицу**.</span><span class="sxs-lookup"><span data-stu-id="670b2-217">In the **Select Input Table(s)** dialog box, click **Select Nested Table**.</span></span>  
  
5.  <span data-ttu-id="670b2-218">В диалоговом окне **Выбор таблицы** для поля **источник данных**выберите заказы.</span><span class="sxs-lookup"><span data-stu-id="670b2-218">In the **Select Table** dialog box, for **Data Source**, select Orders.</span></span> <span data-ttu-id="670b2-219">В списке **имя таблицы или представления** выберите vAssocSeqLineItems и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="670b2-219">In the **Table/View name** list, select vAssocSeqLineItems, and then click **OK**.</span></span>  
  
     <span data-ttu-id="670b2-220">Службы Analysis Services выполнят попытку выявить связи и создать их автоматически, если типы данных и имена столбцов совпадают.</span><span class="sxs-lookup"><span data-stu-id="670b2-220">Analysis Services will try to detect relationships and create them automatically if the data types match and the column names are similar.</span></span> <span data-ttu-id="670b2-221">Если создаваемые связи неверны, можно щелкнуть правой кнопкой мыши линию соединения и выбрать пункт **Изменить соединения** , чтобы изменить сопоставление столбцов, или щелкнуть правой кнопкой мыши строку соединения и выбрать команду **Удалить** , чтобы полностью удалить связь.</span><span class="sxs-lookup"><span data-stu-id="670b2-221">If the relationships that it creates are wrong, you can right-click the join line and select **Modify Connections** to edit the column mapping, or you can right-click the join line and select **Delete** to remove the relationship completely.</span></span> <span data-ttu-id="670b2-222">В таком случае эти связи автоматически добавляются на панели конструирования, поскольку таблицы уже были соединены в представлении источника данных.</span><span class="sxs-lookup"><span data-stu-id="670b2-222">In this case, because the tables were already joined in the data source view, those relationships are automatically added to the design pane.</span></span>  
  
6.  <span data-ttu-id="670b2-223">Добавьте в сетку новую строку.</span><span class="sxs-lookup"><span data-stu-id="670b2-223">Add a new row to the grid.</span></span> <span data-ttu-id="670b2-224">В поле **источник**выберите vAssocSeqOrders, а для **поля**выберите CustomerKey.</span><span class="sxs-lookup"><span data-stu-id="670b2-224">For **Source**, select vAssocSeqOrders, and for **Field**, select CustomerKey.</span></span>  
  
7.  <span data-ttu-id="670b2-225">Добавьте в сетку новую строку.</span><span class="sxs-lookup"><span data-stu-id="670b2-225">Add a new row to the grid.</span></span> <span data-ttu-id="670b2-226">В поле **источник**выберите **функция прогнозирования**, а для **поля**выберите **PredictSequence**.</span><span class="sxs-lookup"><span data-stu-id="670b2-226">For **Source**, select **Prediction Function**, and for **Field**, select **PredictSequence**.</span></span>  
  
8.  <span data-ttu-id="670b2-227">Перетащите vAssocSeqLineItems в поле **критерий или аргумент** .</span><span class="sxs-lookup"><span data-stu-id="670b2-227">Drag vAssocSeqLineItems, into the **Criteria/Argument** box.</span></span> <span data-ttu-id="670b2-228">Щелкните в конце поля **критерий или аргумент** и введите следующие аргументы: `2` .</span><span class="sxs-lookup"><span data-stu-id="670b2-228">Click at the end of the **Criteria/Argument** box and then type the following arguments: `2`.</span></span>  
  
     <span data-ttu-id="670b2-229">Полный текст в поле **критерий или аргумент** должен быть следующим:`[Sequence Clustering].[v Assoc Seq Line Items],2`</span><span class="sxs-lookup"><span data-stu-id="670b2-229">The complete text in the **Criteria/Argument** box should be: `[Sequence Clustering].[v Assoc Seq Line Items],2`</span></span>  
  
9. <span data-ttu-id="670b2-230">Нажмите кнопку **результат** , чтобы просмотреть прогнозы для каждого клиента.</span><span class="sxs-lookup"><span data-stu-id="670b2-230">Click the **Result** button to view the predictions for each customer.</span></span>  
  
 <span data-ttu-id="670b2-231">Учебник по моделям кластеризации последовательностей завершен.</span><span class="sxs-lookup"><span data-stu-id="670b2-231">You have completed the tutorial on sequence clustering models.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="670b2-232">Next Steps</span><span class="sxs-lookup"><span data-stu-id="670b2-232">Next Steps</span></span>  
 <span data-ttu-id="670b2-233">Если вы выполнили все разделы [учебника по интеллектуальному анализу данных &#40;Analysis Services-&#41;интеллектуального анализа данных ](../../2014/tutorials/intermediate-data-mining-tutorial-analysis-services-data-mining.md), то на следующем этапе можно научиться использовать инструкции расширений интеллектуального анализа данных для построения моделей и формирования прогнозов.</span><span class="sxs-lookup"><span data-stu-id="670b2-233">If you have finished all the sections in the [Intermediate Data Mining Tutorial &#40;Analysis Services - Data Mining&#41;](../../2014/tutorials/intermediate-data-mining-tutorial-analysis-services-data-mining.md), the next step might be to learn to use Data Mining Extensions (DMX) statements to build models and generate predictions.</span></span> <span data-ttu-id="670b2-234">Дополнительные сведения см. в статьях [Создание и запрос моделей интеллектуального анализа данных с помощью расширений интеллектуального анализа: учебники &#40;Analysis Services-&#41;интеллектуального анализа данных ](../../2014/tutorials/create-query-data-mining-models-dmx-tutorials.md).</span><span class="sxs-lookup"><span data-stu-id="670b2-234">For more information, see [Creating and Querying Data Mining Models with DMX: Tutorials &#40;Analysis Services - Data Mining&#41;](../../2014/tutorials/create-query-data-mining-models-dmx-tutorials.md).</span></span>  
  
 <span data-ttu-id="670b2-235">Пользователи, которым знакомы основные понятия программирования, также могут использовать объекты AMO для работы с объектами интеллектуального анализа данных программным путем.</span><span class="sxs-lookup"><span data-stu-id="670b2-235">If you are familiar with programming concepts, you can also use Analysis Management Objects (AMO) to programmatically work with data mining objects.</span></span> <span data-ttu-id="670b2-236">Дополнительные сведения см. в разделе [Классы интеллектуального анализа данных объектов AMO](https://docs.microsoft.com/bi-reference/amo/amo-data-mining-classes).</span><span class="sxs-lookup"><span data-stu-id="670b2-236">For more information, see [AMO Data Mining Classes](https://docs.microsoft.com/bi-reference/amo/amo-data-mining-classes).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="670b2-237">См. также:</span><span class="sxs-lookup"><span data-stu-id="670b2-237">See Also</span></span>  
 <span data-ttu-id="670b2-238">[Примеры запросов к модели кластеризации последовательностей](../../2014/analysis-services/data-mining/sequence-clustering-model-query-examples.md) </span><span class="sxs-lookup"><span data-stu-id="670b2-238">[Sequence Clustering Model Query Examples](../../2014/analysis-services/data-mining/sequence-clustering-model-query-examples.md) </span></span>  
 [<span data-ttu-id="670b2-239">Содержимое моделей интеллектуального анализа данных для моделей кластеризации последовательностей (службы Analysis Services — интеллектуальный анализ данных)</span><span class="sxs-lookup"><span data-stu-id="670b2-239">Mining Model Content for Sequence Clustering Models &#40;Analysis Services - Data Mining&#41;</span></span>](../../2014/analysis-services/data-mining/mining-model-content-for-sequence-clustering-models.md)  
  
  
