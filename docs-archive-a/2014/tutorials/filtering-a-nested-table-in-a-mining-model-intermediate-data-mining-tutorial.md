---
title: Фильтрация вложенной таблицы в модели интеллектуального анализа (учебник по интеллектуальному анализу данных — средний уровень) | Документация Майкрософт
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 0a3ae0e5-897b-4898-a60d-5455eec3d305
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: a1e6ce2936a3c6763ea41999b2724c0fe8c79301
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739014"
---
# <a name="filtering-a-nested-table-in-a-mining-model-intermediate-data-mining-tutorial"></a>Фильтрование вложенной таблицы в модели интеллектуального анализа данных (учебник по интеллектуальному анализу данных — средний уровень)
  После создания и изучения модели принимается решение сосредоточить внимание на подмножестве данных о клиентах. Например, можно выполнить анализ только тех потребительских корзин, которые содержат конкретный элемент, или проанализировать демографические данных клиентов, которые ничего не купили в течение определенного периода времени.  
  
 Службы [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] предоставляют возможность фильтрации данных, которые используются в модели интеллектуального анализа данных. Эта функция полезна, поскольку не нужно настраивать новое представление источника данных для использования других данных. В учебнике по интеллектуальному анализу данных (начальный уровень) рассматривалось, как фильтровать данные из плоской таблицы путем применения условий к таблице вариантов. В этой задаче создается фильтр для применения к вложенной таблице.  
  
## <a name="filters-on-nested-vs-case-tables"></a>Фильтры для вложенных таблиц и таблиц вариантов  
 Если представление источника данных содержит таблицу вариантов и вложенную таблицу (подобно представлению источника данных, которое используется в модели взаимосвязей), фильтр можно использовать на основании значений из таблицы вариантов, наличия или отсутствия определенного значения во вложенной таблице либо сочетания тех и других.  
  
 В этой задаче сначала создается копия модели взаимосвязей, а затем к новой связанной модели добавляются атрибуты IncomeGroup и Region, чтобы можно было выполнить фильтрация по этим атрибутам в таблице вариантов.  
  
#### <a name="to-create-and-modify-a-copy-of-the-association-model"></a>Создание и изменение копии модели «Взаимосвязь»  
  
1.  На вкладке **модели интеллектуального анализа** данных в щелкните [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] правой кнопкой мыши `Association` модель и выберите пункт **создать модель интеллектуального анализа данных**.  
  
2.  В качестве **имени модели**введите `Association Filtered` . В качестве **имени алгоритма**выберите **Правила взаимосвязей (Майкрософт**). Нажмите кнопку **ОК**.  
  
3.  В столбце для фильтрованной модели взаимосвязей щелкните строку IncomeGroup и измените значение с **Ignore** на **input**.  
  
 После этого следует создать фильтр для таблицы вариантов в новой модели взаимосвязей. Этот фильтр передаст модели только тех заказчиков, которые находятся в целевом регионе или имеют определенный уровень дохода. Затем нужно добавить второй набор условий фильтра, чтобы указать, что модель использует только клиентов, в чьих корзинах заказов содержался по крайней мере один элемент.  
  
#### <a name="to-add-a-filter-to-a-mining-model"></a>Добавление фильтра в модель интеллектуального анализа данных  
  
1.  На вкладке **модели интеллектуального анализа данных** щелкните правой кнопкой мыши отфильтрованную связь модели и выберите команду **задать фильтр модели**.  
  
2.  В диалоговом окне **Фильтр модели** щелкните верхнюю строку сетки в текстовом поле **Столбец структуры интеллектуального анализа данных** .  
  
3.  В текстовом поле **столбец структуры интеллектуального анализа данных** выберите IncomeGroup.  
  
     Значок слева от текстового поля изменится, указывая, что выбранным элементом является столбец.  
  
4.  Щелкните текстовое поле **оператор** и выберите **=** оператор из списка.  
  
5.  Щелкните текстовое поле **значение** и введите `High` в поле.  
  
6.  Щелкните следующую строку сетки.  
  
7.  Щелкните текстовое поле **и/или** в следующей строке сетки и выберите **или**.  
  
8.  В текстовом поле **столбец структуры интеллектуального анализа данных** выберите IncomeGroup. В текстовом поле **значение** введите `Moderate` .  
  
     Созданное условие фильтра автоматически добавляется в текстовое поле **выражение** и должно выглядеть следующим образом:  
  
     `[IncomeGroup] = 'High' OR [IncomeGroup] = 'Moderate'`  
  
9. Щелкните следующую строку в сетке, оставьте оператор в качестве значения по умолчанию **и**.  
  
10. В поле **оператор**оставьте значение по умолчанию, **содержащее**. Щелкните текстовое поле **значение** .  
  
11. В диалоговом окне **Фильтр** в первой строке **столбца структура интеллектуального анализа данных**выберите `Model` .  
  
12. Для **оператора**SELECT не равно **null**. Оставьте текстовое поле **значение** пустым. Нажмите кнопку **ОК**.  
  
     Условие фильтра в текстовом поле **выражение** диалогового окна **Фильтр модели** автоматически обновляется для включения нового условия во вложенную таблицу. Законченное выражение выглядит следующим образом:  
  
     `[IncomeGroup] = 'High' OR [IncomeGroup] = 'Moderate' AND EXISTS SELECT * FROM [vAssocSeqLineItems] WHERE [Model] <> NULL).`  
  
13. [!INCLUDE[clickOK](../includes/clickok-md.md)] ``  
  
#### <a name="to-enable-drillthrough-and-to-process-the-filtered-model"></a>Включение детализации и обработка отфильтрованной модели  
  
1.  На вкладке **модели интеллектуального анализа данных** щелкните правой кнопкой мыши `Association Filtered` модель и выберите пункт **Свойства**.  
  
2.  Измените значение свойства **AllowDrillthrough** на **true**.  
  
3.  Щелкните правой кнопкой мыши `Association Filtered` модель интеллектуального анализа данных и выберите команду **обработать модель**.  
  
4.  Нажмите кнопку **Да** в сообщении об ошибке, чтобы развернуть новую модель в [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] базе данных.  
  
5.  В диалоговом окне **Обработка структуры интеллектуального анализа данных** нажмите кнопку **выполнить**.  
  
6.  После завершения обработки нажмите кнопку **Закрыть** , чтобы выйти из диалогового окна **Ход обработки** , и нажмите кнопку **Закрыть** еще раз, чтобы закрыть диалоговое окно **Обработка структуры интеллектуального анализа данных** .  
  
 Чтобы убедиться в том, что отфильтрованная модель содержит меньше вариантов, чем исходная модель, проверьте значение параметра NODE_SUPPORT в средстве просмотра деревьев содержимого общего вида (Майкрософт).  
  
## <a name="remarks"></a>Remarks  
 Только что созданный фильтр вложенной таблицы проверяет лишь наличие по крайней мере одной строки во вложенной таблице. Также можно создать условия фильтра для проверки наличия конкретных продуктов.  Например, можно создать следующий фильтр:  
  
```  
[IncomeGroup] = 'High' AND  
 EXISTS (SELECT * FROM [<nested table name>] WHERE [Model] = 'Water Bottle' )   
```  
  
 Данная инструкция означает, что клиенты из таблицы вариантов будут ограничены лишь теми клиентами, которые приобрели флягу для воды. Количество атрибутов вложенной таблицы потенциально может быть неограниченным, поэтому службы [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] не предоставляют список возможных значений для выбора. Вместо этого необходимо вводить точное значение.  
  
 Можно нажать кнопку **изменить запрос** , чтобы вручную изменить критерий фильтра. Однако если какая-либо часть критерия фильтра изменяется вручную, сетка становится недоступной и работать с выражением фильтра в дальнейшем можно только в режиме изменения текста. Чтобы снова перейти в режим изменения с помощью сетки, необходимо очистить критерий фильтра и начать сначала.  
  
> [!WARNING]  
>  В фильтре для вложенной таблицы нельзя использовать оператор LIKE.  
  
## <a name="next-task-in-lesson"></a>Следующая задача занятия  
 [Учебник по прогнозированию взаимосвязей &#40;промежуточного интеллектуального анализа данных&#41;](../../2014/tutorials/predicting-associations-intermediate-data-mining-tutorial.md)  
  
## <a name="see-also"></a>См. также:  
 [Синтаксис и примеры фильтров моделей &#40;Analysis Services — интеллектуальный анализ данных&#41;](../../2014/analysis-services/data-mining/model-filter-syntax-and-examples-analysis-services-data-mining.md)   
 [Фильтры для моделей интеллектуального анализа данных (службы Analysis Services — интеллектуальный анализ данных)](../../2014/analysis-services/data-mining/filters-for-mining-models-analysis-services-data-mining.md)  
  
  
