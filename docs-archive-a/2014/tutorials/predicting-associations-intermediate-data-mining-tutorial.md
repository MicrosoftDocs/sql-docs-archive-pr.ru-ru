---
title: Прогнозирование взаимосвязей (учебник по интеллектуальному анализу данных — средний уровень) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 9140c5f2-b340-45a6-9c27-d870d15aafea
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: bee5ca4ded1b2fd5cbda0712cb766c825b9d0318
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87654670"
---
# <a name="predicting-associations-intermediate-data-mining-tutorial"></a><span data-ttu-id="1bd93-102">Прогноз взаимосвязей (учебник по интеллектуальному анализу данных — средний уровень)</span><span class="sxs-lookup"><span data-stu-id="1bd93-102">Predicting Associations (Intermediate Data Mining Tutorial)</span></span>
  <span data-ttu-id="1bd93-103">После обработки моделей для создания прогнозов можно использовать сведения о взаимосвязях, хранящиеся в модели.</span><span class="sxs-lookup"><span data-stu-id="1bd93-103">After the models have been processed, you can use the information about associations stored in the model to create predictions.</span></span> <span data-ttu-id="1bd93-104">В последней задаче этого занятия предстоит изучить, как создавать прогнозирующие запросы к созданным моделям взаимосвязей.</span><span class="sxs-lookup"><span data-stu-id="1bd93-104">In the final task of this lesson, you learn how to build prediction queries against the association models that you created.</span></span> <span data-ttu-id="1bd93-105">В этом занятии предполагается, что вы знакомы с работой построителя прогнозирующих запросов и хотите научиться создавать прогнозирующие запросы к моделям взаимосвязей.</span><span class="sxs-lookup"><span data-stu-id="1bd93-105">This lesson assumes that you are familiar with how to use the Prediction Query Builder and want to learn how to build prediction queries against association models.</span></span> <span data-ttu-id="1bd93-106">Дополнительные сведения об использовании конструктор запросов прогнозирования см. в разделе [интерфейсы запросов интеллектуального анализа данных](../../2014/analysis-services/data-mining/data-mining-query-tools.md).</span><span class="sxs-lookup"><span data-stu-id="1bd93-106">For more information how to use Prediction Query Builder, see [Data Mining Query Interfaces](../../2014/analysis-services/data-mining/data-mining-query-tools.md).</span></span>  
  
## <a name="creating-a-singleton-prediction-query"></a><span data-ttu-id="1bd93-107">Создание одноэлементных прогнозирующих запросов</span><span class="sxs-lookup"><span data-stu-id="1bd93-107">Creating a Singleton Prediction Query</span></span>  
 <span data-ttu-id="1bd93-108">Прогнозирующие запросы для модели взаимосвязей могут быть весьма полезными:</span><span class="sxs-lookup"><span data-stu-id="1bd93-108">Prediction queries on an association model can be very useful:</span></span>  
  
-   <span data-ttu-id="1bd93-109">Рекомендуйте клиентам элементы на основе предыдущих или связанных покупок</span><span class="sxs-lookup"><span data-stu-id="1bd93-109">Recommend items to a customer, based on prior or related purchases</span></span>  
  
-   <span data-ttu-id="1bd93-110">Найдите связанные события.</span><span class="sxs-lookup"><span data-stu-id="1bd93-110">Find related events.</span></span>  
  
-   <span data-ttu-id="1bd93-111">Определите отношения в наборах транзакций или через них.</span><span class="sxs-lookup"><span data-stu-id="1bd93-111">Identify relationships in or across sets of transactions.</span></span>  
  
 <span data-ttu-id="1bd93-112">Чтобы создать прогнозирующий запрос, сначала необходимо выбрать модель взаимосвязей, которая будет использоваться, а затем указать входные данные.</span><span class="sxs-lookup"><span data-stu-id="1bd93-112">To build a prediction query, you first select the association model you want to use, and then you specify the input data.</span></span> <span data-ttu-id="1bd93-113">Входные данные могут поступать из внешнего источника данных, например из списка значений, или можно создать одноэлементный запрос и предоставить значения по ходу выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="1bd93-113">Inputs can come from an external data source, such as a list of values, or you can build a singleton query and provide values as you go.</span></span>  
  
 <span data-ttu-id="1bd93-114">В этом сценарии сначала будет создано несколько одноэлементных прогнозирующих запросов, чтобы получить представление о том, как работает прогнозирование.</span><span class="sxs-lookup"><span data-stu-id="1bd93-114">For this scenario, you will first create some singleton prediction queries, to get an idea of how prediction works.</span></span> <span data-ttu-id="1bd93-115">Затем будет создан запрос для пакетных прогнозов, которые можно использовать для предоставления рекомендаций на основании текущих покупок клиента.</span><span class="sxs-lookup"><span data-stu-id="1bd93-115">Then you will create a query for batch predictions that you could use for making recommendations based on a customer's current purchases.</span></span>  
  
#### <a name="to-create-a-prediction-query-on-an-association-model"></a><span data-ttu-id="1bd93-116">Создание прогнозирующего запроса для модели взаимосвязей</span><span class="sxs-lookup"><span data-stu-id="1bd93-116">To create a prediction query on an association model</span></span>  
  
1.  <span data-ttu-id="1bd93-117">Перейдите на вкладку **Прогноз модели интеллектуального анализа** данных конструктора интеллектуального анализа.</span><span class="sxs-lookup"><span data-stu-id="1bd93-117">Click the **Mining Model Prediction** tab of Data Mining Designer.</span></span>  
  
2.  <span data-ttu-id="1bd93-118">На панели **модель интеллектуального анализа данных** щелкните **выбрать модель**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-118">In the **Mining Model** pane, click **Select Model**.</span></span> <span data-ttu-id="1bd93-119">(Если нужная модель уже выбрана, этот и следующий шаги можно пропустить.)</span><span class="sxs-lookup"><span data-stu-id="1bd93-119">(You can skip this step and the next step if the correct model is already selected.)</span></span>  
  
3.  <span data-ttu-id="1bd93-120">В диалоговом окне **Выбор модели интеллектуального анализа данных** разверните узел, представляющий **ассоциацию**структуры интеллектуального анализа данных, и выберите **связь**модели.</span><span class="sxs-lookup"><span data-stu-id="1bd93-120">In the **Select Mining Model** dialog box, expand the node that represents the mining structure **Association**, and select the model **Association**.</span></span> <span data-ttu-id="1bd93-121">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-121">Click **OK**.</span></span>  
  
     <span data-ttu-id="1bd93-122">На данном этапе можно не учитывать входную панель.</span><span class="sxs-lookup"><span data-stu-id="1bd93-122">For now, you can ignore the input pane.</span></span>  
  
4.  <span data-ttu-id="1bd93-123">В сетке щелкните пустую ячейку в разделе **источник** и выберите **функция прогнозирования.**</span><span class="sxs-lookup"><span data-stu-id="1bd93-123">In the grid, click the empty cell under **Source** and select **Prediction Function.**</span></span> <span data-ttu-id="1bd93-124">В **поле**в ячейке выберите `PredictAssociation` .</span><span class="sxs-lookup"><span data-stu-id="1bd93-124">In the cell under **Field**, select `PredictAssociation`.</span></span>  
  
     <span data-ttu-id="1bd93-125">Для прогнозирования взаимосвязей можно также использовать функцию **Predict** .</span><span class="sxs-lookup"><span data-stu-id="1bd93-125">You can also use the **Predict** function to predict associations.</span></span> <span data-ttu-id="1bd93-126">В этом случае следует выбрать версию функции **Predict** , которая принимает столбец таблицы в качестве аргумента.</span><span class="sxs-lookup"><span data-stu-id="1bd93-126">If you do, be sure to choose the version of the **Predict** function that takes a table column as argument.</span></span>  
  
5.  <span data-ttu-id="1bd93-127">На панели **модель интеллектуального анализа данных** выберите вложенную таблицу `vAssocSeqLineItems` и перетащите ее в сетку в поле **критерий или аргумент** для `PredictAssociation` функции.</span><span class="sxs-lookup"><span data-stu-id="1bd93-127">In the **Mining Model** pane, select the nested table `vAssocSeqLineItems`, and drag it into the grid, to the **Criteria/Argument** box for the `PredictAssociation` function.</span></span>  
  
     <span data-ttu-id="1bd93-128">Путем перетаскивания имен таблиц и столбцов можно создавать сложные инструкции без синтаксических ошибок.</span><span class="sxs-lookup"><span data-stu-id="1bd93-128">Dragging and dropping table and column names lets you build complex statements without syntax errors.</span></span> <span data-ttu-id="1bd93-129">Однако он заменяет текущее содержимое ячейки, которое содержит другие необязательные аргументы `PredictAssociation` функции.</span><span class="sxs-lookup"><span data-stu-id="1bd93-129">However, it replaces the current contents of the cell, which include other optional arguments for the `PredictAssociation` function.</span></span> <span data-ttu-id="1bd93-130">Чтобы просмотреть другие аргументы, можно на время добавить в сетку второй экземпляр функции и использовать его для справки.</span><span class="sxs-lookup"><span data-stu-id="1bd93-130">To view the other arguments, you can temporarily add a second instance of the function to the grid for reference.</span></span>  
  
6.  <span data-ttu-id="1bd93-131">Щелкните поле **критерий или аргумент** и введите следующий текст после имени таблицы:`,3`</span><span class="sxs-lookup"><span data-stu-id="1bd93-131">Click the **Criteria/Argument** box and type the following text after the table name: `,3`</span></span>  
  
     <span data-ttu-id="1bd93-132">Полный текст в поле **критерий или аргумент** должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1bd93-132">The complete text in the **Criteria/Argument** box should be as follows:</span></span>  
  
     `[Association].[v Assoc Seq Line Items],3`  
  
7.  <span data-ttu-id="1bd93-133">Нажмите кнопку **результаты** в верхнем углу конструктор запросов прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="1bd93-133">Click the **Results** button in the upper corner of the Prediction Query Builder.</span></span>  
  
 <span data-ttu-id="1bd93-134">Ожидаемые результаты содержат один столбец с **выражением**заголовка.</span><span class="sxs-lookup"><span data-stu-id="1bd93-134">The expected results contain a single column with the heading **Expression**.</span></span> <span data-ttu-id="1bd93-135">Столбец **выражение** содержит вложенную таблицу с одним столбцом и следующими тремя строками.</span><span class="sxs-lookup"><span data-stu-id="1bd93-135">The **Expression** column contains a nested table with a single column and the following three rows.</span></span> <span data-ttu-id="1bd93-136">Поскольку входное значение не было указано, эти прогнозы представляют наиболее вероятные взаимосвязи продуктов для модели в целом.</span><span class="sxs-lookup"><span data-stu-id="1bd93-136">Because you did not specify an input value, these predictions represent the most likely product associations for the model as a whole.</span></span>  
  
|<span data-ttu-id="1bd93-137">Модель</span><span class="sxs-lookup"><span data-stu-id="1bd93-137">Model</span></span>|  
|-----------|  
|<span data-ttu-id="1bd93-138">Женские шорты Mountain</span><span class="sxs-lookup"><span data-stu-id="1bd93-138">Women's Mountain Shorts</span></span>|  
|<span data-ttu-id="1bd93-139">Фляга для воды</span><span class="sxs-lookup"><span data-stu-id="1bd93-139">Water Bottle</span></span>|  
|<span data-ttu-id="1bd93-140">Touring-3000</span><span class="sxs-lookup"><span data-stu-id="1bd93-140">Touring-3000</span></span>|  
  
 <span data-ttu-id="1bd93-141">Далее вы будете использовать панель **ввода одноэлементного запроса** для указания продукта в качестве входных данных для запроса и просмотра продуктов, которые, скорее всего, связаны с этим элементом.</span><span class="sxs-lookup"><span data-stu-id="1bd93-141">Next, you will use the **Singleton Query Input** pane to specify a product as input to the query, and view the products that are most likely associated with that item.</span></span>  
  
#### <a name="to-create-a-singleton-prediction-query-with-nested-table-inputs"></a><span data-ttu-id="1bd93-142">Создание одноэлементного прогнозирующего запроса с входными данными вложенной таблицы</span><span class="sxs-lookup"><span data-stu-id="1bd93-142">To create a singleton prediction query with nested table inputs</span></span>  
  
1.  <span data-ttu-id="1bd93-143">Нажмите кнопку **конструктор** в углу конструктор запросов прогнозирования, чтобы вернуться к сетке создания запросов.</span><span class="sxs-lookup"><span data-stu-id="1bd93-143">Click the **Design** button in the corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="1bd93-144">В меню **модель интеллектуального анализа данных** выберите пункт **одноэлементный запрос**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-144">On the **Mining Model** menu, select **Singleton Query**.</span></span>  
  
3.  <span data-ttu-id="1bd93-145">В диалоговом окне **модель интеллектуального анализа данных** выберите модель **взаимосвязей** .</span><span class="sxs-lookup"><span data-stu-id="1bd93-145">In the **Mining Model** dialog box, select the **Association** model.</span></span>  
  
4.  <span data-ttu-id="1bd93-146">В сетке щелкните пустую ячейку в разделе **источник** и выберите **функция прогнозирования.**</span><span class="sxs-lookup"><span data-stu-id="1bd93-146">In the grid, click the empty cell under **Source** and select **Prediction Function.**</span></span> <span data-ttu-id="1bd93-147">В **поле**в ячейке выберите `PredictAssociation` .</span><span class="sxs-lookup"><span data-stu-id="1bd93-147">In the cell under **Field**, select `PredictAssociation`.</span></span>  
  
5.  <span data-ttu-id="1bd93-148">На панели **модель интеллектуального анализа данных** выберите вложенную таблицу `vAssocSeqLineItems` и перетащите ее в сетку в поле **критерий или аргумент** для `PredictAssociation` функции.</span><span class="sxs-lookup"><span data-stu-id="1bd93-148">In the **Mining Model** pane, select the nested table `vAssocSeqLineItems`, and drag it into the grid, to the **Criteria/Argument** box for the `PredictAssociation` function.</span></span> <span data-ttu-id="1bd93-149">Введите `,3` после имени вложенной таблицы точно так же, как в предыдущей процедуре.</span><span class="sxs-lookup"><span data-stu-id="1bd93-149">Type `,3` after the nested table name just as in the previous procedure.</span></span>  
  
6.  <span data-ttu-id="1bd93-150">В диалоговом окне **Ввод одноэлементного запроса** щелкните поле **значение** рядом с пунктом **вассок Seq Line Items**, а затем нажмите кнопку **(...)** .</span><span class="sxs-lookup"><span data-stu-id="1bd93-150">In the **Singleton Query Input** dialog box, click the **Value** box next to **vAssoc Seq Line Items**, and then click the **(...)** button.</span></span>  
  
7.  <span data-ttu-id="1bd93-151">В диалоговом окне **входные данные вложенной таблицы** выберите `Touring Tire` на панели **ключевой столбец** и нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-151">In the **Nested Table Input** dialog box, select `Touring Tire` in the **Key column** pane, and then click **Add**.</span></span>  
  
8.  <span data-ttu-id="1bd93-152">Нажмите кнопку **результаты** .</span><span class="sxs-lookup"><span data-stu-id="1bd93-152">Click the **Results** button.</span></span>  
  
 <span data-ttu-id="1bd93-153">Теперь в результатах отображаются прогнозы для продуктов, которые с наибольшей вероятностью связаны с шинами для туристических велосипедов.</span><span class="sxs-lookup"><span data-stu-id="1bd93-153">The results now show the predictions for products that are most likely associated with the Touring Tire.</span></span>  
  
|<span data-ttu-id="1bd93-154">Модель</span><span class="sxs-lookup"><span data-stu-id="1bd93-154">Model</span></span>|  
|-----------|  
|<span data-ttu-id="1bd93-155">Камера для покрышки туристического велосипеда</span><span class="sxs-lookup"><span data-stu-id="1bd93-155">Touring Tire Tube</span></span>|  
|<span data-ttu-id="1bd93-156">Sport-100</span><span class="sxs-lookup"><span data-stu-id="1bd93-156">Sport-100</span></span>|  
|<span data-ttu-id="1bd93-157">Фляга для воды</span><span class="sxs-lookup"><span data-stu-id="1bd93-157">Water Bottle</span></span>|  
  
 <span data-ttu-id="1bd93-158">В результате изучения модели уже становится известно, что камера шины для велосипеда часто приобретается вместе с шиной. Теперь вас больше интересует то, какие продукты можно порекомендовать клиентам, купившим оба этих элемента.</span><span class="sxs-lookup"><span data-stu-id="1bd93-158">However, you already know from exploring the model that the Touring Tire Tube is frequently purchased with the Touring Tire; you are more interested in knowing what products you can recommend to customers who purchase these items together.</span></span> <span data-ttu-id="1bd93-159">Запрос необходимо изменить таким образом, чтобы спрогнозировать связанные продукты на основании двух элементов в корзине.</span><span class="sxs-lookup"><span data-stu-id="1bd93-159">You will change the query so that it predicts related products based on two items in the basket.</span></span> <span data-ttu-id="1bd93-160">Также в запрос нужно добавить степень вероятности для каждого прогнозируемого продукта.</span><span class="sxs-lookup"><span data-stu-id="1bd93-160">You will also modify the query to add the probability for each predicted product.</span></span>  
  
#### <a name="to-add-inputs-and-probabilities-to-the-singleton-prediction-query"></a><span data-ttu-id="1bd93-161">Добавление входных данных и вероятностей в одноэлементный прогнозирующий запрос</span><span class="sxs-lookup"><span data-stu-id="1bd93-161">To add inputs and probabilities to the singleton prediction query</span></span>  
  
1.  <span data-ttu-id="1bd93-162">Нажмите кнопку **конструктор** в углу конструктор запросов прогнозирования, чтобы вернуться к сетке создания запросов.</span><span class="sxs-lookup"><span data-stu-id="1bd93-162">Click the **Design** button in the corner of the Prediction Query Builder to switch back to the query building grid.</span></span>  
  
2.  <span data-ttu-id="1bd93-163">В диалоговом окне **Ввод одноэлементного запроса** щелкните поле **значение** рядом с пунктом **вассок Seq Line Items**, а затем нажмите кнопку **(...)** .</span><span class="sxs-lookup"><span data-stu-id="1bd93-163">In the **Singleton Query Input** dialog box, click the **Value** box next to **vAssoc Seq Line Items**, and then click the **(...)** button.</span></span>  
  
3.  <span data-ttu-id="1bd93-164">На панели **ключевой столбец** выберите `Touring Tire` и нажмите кнопку **добавить**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-164">In the **Key column** pane, select `Touring Tire`, and then click **Add**.</span></span>  
  
4.  <span data-ttu-id="1bd93-165">В сетке щелкните пустую ячейку в разделе **источник** и выберите **функция прогнозирования.**</span><span class="sxs-lookup"><span data-stu-id="1bd93-165">In the grid, click the empty cell under **Source** and select **Prediction Function.**</span></span> <span data-ttu-id="1bd93-166">В **поле**в ячейке выберите `PredictAssociation` .</span><span class="sxs-lookup"><span data-stu-id="1bd93-166">In the cell under **Field**, select `PredictAssociation`.</span></span>  
  
5.  <span data-ttu-id="1bd93-167">На панели **модель интеллектуального анализа данных** выберите вложенную таблицу `vAssocSeqLineItems` и перетащите ее в сетку в поле **критерий или аргумент** для `PredictAssociation` функции.</span><span class="sxs-lookup"><span data-stu-id="1bd93-167">In the **Mining Model** pane, select the nested table `vAssocSeqLineItems`, and drag it into the grid, to the **Criteria/Argument** box for the `PredictAssociation` function.</span></span> <span data-ttu-id="1bd93-168">Введите `,3` после имени вложенной таблицы точно так же, как в предыдущей процедуре.</span><span class="sxs-lookup"><span data-stu-id="1bd93-168">Type `,3` after the nested table name just as in the previous procedure.</span></span>  
  
6.  <span data-ttu-id="1bd93-169">В диалоговом окне **входные данные вложенной таблицы** выберите `Touring Tire Tube` на панели **ключевой столбец** и нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-169">In the **Nested Table Input** dialog box, select `Touring Tire Tube` in the **Key column** pane, and then click **Add**.</span></span>  
  
7.  <span data-ttu-id="1bd93-170">В сетке в строке `PredictAssociation` функции щелкните поле **критерий или аргумент** и измените аргументы, чтобы добавить аргумент, INCLUDE_STATISTICS.</span><span class="sxs-lookup"><span data-stu-id="1bd93-170">In the grid, in the row for the `PredictAssociation` function, click the **Criteria/Argument** box, and change the arguments to add the argument, INCLUDE_STATISTICS.</span></span>  
  
     <span data-ttu-id="1bd93-171">Полный текст в поле **критерий или аргумент** должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1bd93-171">The complete text in the **Criteria/Argument** box should be as follows:</span></span>  
  
     `[Association].[v Assoc Seq Line Items], INCLUDE_STATISTICS, 3`  
  
8.  <span data-ttu-id="1bd93-172">Нажмите кнопку **результаты** .</span><span class="sxs-lookup"><span data-stu-id="1bd93-172">Click the **Results** button.</span></span>  
  
 <span data-ttu-id="1bd93-173">Результаты во вложенной таблице меняются, отображая прогнозы вместе с поддержкой и вероятностью.</span><span class="sxs-lookup"><span data-stu-id="1bd93-173">The results in the nested table now change to show the predictions, together with support and probability.</span></span> <span data-ttu-id="1bd93-174">Дополнительные сведения об интерпретации этих значений см. в разделе [содержимое моделей интеллектуального анализа данных для моделей взаимосвязей &#40;Analysis Services-&#41;интеллектуального анализа ](../../2014/analysis-services/data-mining/mining-model-content-for-association-models-analysis-services-data-mining.md).</span><span class="sxs-lookup"><span data-stu-id="1bd93-174">For more information about how to interpret these values, see [Mining Model Content for Association Models &#40;Analysis Services - Data Mining&#41;](../../2014/analysis-services/data-mining/mining-model-content-for-association-models-analysis-services-data-mining.md).</span></span>  
  
|<span data-ttu-id="1bd93-175">Модель</span><span class="sxs-lookup"><span data-stu-id="1bd93-175">Model</span></span>|<span data-ttu-id="1bd93-176">$SUPPORT</span><span class="sxs-lookup"><span data-stu-id="1bd93-176">$SUPPORT</span></span>|<span data-ttu-id="1bd93-177">$PROBABILITY</span><span class="sxs-lookup"><span data-stu-id="1bd93-177">$PROBABILITY</span></span>|<span data-ttu-id="1bd93-178">$ADJUSTEDPROBABILITY</span><span class="sxs-lookup"><span data-stu-id="1bd93-178">$ADJUSTEDPROBABILITY</span></span>|  
|-----------|--------------|------------------|--------------------------|  
|<span data-ttu-id="1bd93-179">Sport-100</span><span class="sxs-lookup"><span data-stu-id="1bd93-179">Sport-100</span></span>|<span data-ttu-id="1bd93-180">4334</span><span class="sxs-lookup"><span data-stu-id="1bd93-180">4334</span></span>|<span data-ttu-id="1bd93-181">0,291...</span><span class="sxs-lookup"><span data-stu-id="1bd93-181">0.291...</span></span>|<span data-ttu-id="1bd93-182">0,252...</span><span class="sxs-lookup"><span data-stu-id="1bd93-182">0.252...</span></span>|  
|<span data-ttu-id="1bd93-183">Фляга для воды</span><span class="sxs-lookup"><span data-stu-id="1bd93-183">Water Bottle</span></span>|<span data-ttu-id="1bd93-184">2866</span><span class="sxs-lookup"><span data-stu-id="1bd93-184">2866</span></span>|<span data-ttu-id="1bd93-185">0,192...</span><span class="sxs-lookup"><span data-stu-id="1bd93-185">0.192...</span></span>|<span data-ttu-id="1bd93-186">0,175...</span><span class="sxs-lookup"><span data-stu-id="1bd93-186">0.175...</span></span>|  
|<span data-ttu-id="1bd93-187">Ремонтный комплект</span><span class="sxs-lookup"><span data-stu-id="1bd93-187">Patch Kit</span></span>|<span data-ttu-id="1bd93-188">2113</span><span class="sxs-lookup"><span data-stu-id="1bd93-188">2113</span></span>|<span data-ttu-id="1bd93-189">0,142...</span><span class="sxs-lookup"><span data-stu-id="1bd93-189">0.142...</span></span>|<span data-ttu-id="1bd93-190">0,132</span><span class="sxs-lookup"><span data-stu-id="1bd93-190">0.132</span></span>|  
  
## <a name="working-with-results"></a><span data-ttu-id="1bd93-191">Работа с результатами</span><span class="sxs-lookup"><span data-stu-id="1bd93-191">Working with Results</span></span>  
 <span data-ttu-id="1bd93-192">Если результаты содержат много вложенных таблиц, такие результаты можно преобразовать в плоский формат для более удобного просмотра.</span><span class="sxs-lookup"><span data-stu-id="1bd93-192">When there are many nested tables in the results, you might want to flatten the results for easier viewing.</span></span> <span data-ttu-id="1bd93-193">С этой целью можно вручную изменить запрос и добавить ключевое слово `FLATTENED`.</span><span class="sxs-lookup"><span data-stu-id="1bd93-193">To do this, you can manually modify the query and add the `FLATTENED` keyword.</span></span>  
  
#### <a name="to-flatten-nested-rowsets-in-a-prediction-query"></a><span data-ttu-id="1bd93-194">Преобразование вложенных наборов строк в плоский формат в прогнозирующем запросе</span><span class="sxs-lookup"><span data-stu-id="1bd93-194">To flatten nested rowsets in a prediction query</span></span>  
  
1.  <span data-ttu-id="1bd93-195">Нажмите кнопку **SQL** в углу конструктор запросов прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="1bd93-195">Click the **SQL** button in the corner of the Prediction Query Builder.</span></span>  
  
     <span data-ttu-id="1bd93-196">Сетка будет преобразована в открытую панель, в которой можно просмотреть и изменить инструкцию DMX, созданную построителем прогнозирующих запросов.</span><span class="sxs-lookup"><span data-stu-id="1bd93-196">The grid changes to an open pane where you can view and modify the DMX statement that was created by the Prediction Query Builder.</span></span>  
  
2.  <span data-ttu-id="1bd93-197">После ключевого слова `SELECT` введите `FLATTENED`.</span><span class="sxs-lookup"><span data-stu-id="1bd93-197">After the `SELECT` keyword, type `FLATTENED`.</span></span>  
  
     <span data-ttu-id="1bd93-198">Полный текст запроса должен иметь следующий вид:</span><span class="sxs-lookup"><span data-stu-id="1bd93-198">The complete text of the query should be as follows:</span></span>  
  
    ```  
    SELECT FLATTENED  
      PredictAssociation([Association].[v Assoc Seq Line Items],INCLUDE_STATISTICS,3)  
    FROM  
      [Association]  
    NATURAL PREDICTION JOIN  
    (SELECT (SELECT 'Touring Tire' AS [Model]  
      UNION SELECT 'Touring Tire Tube' AS [Model]) AS [v Assoc Seq Line Items]) AS t  
    ```  
  
3.  <span data-ttu-id="1bd93-199">Нажмите кнопку **результаты** в верхнем углу конструктор запросов прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="1bd93-199">Click the **Results** button in the upper corner of the Prediction Query Builder.</span></span>  
  
 <span data-ttu-id="1bd93-200">Следует отметить, что после редактирования запроса вручную нельзя вернуться в конструктор, не потеряв изменения.</span><span class="sxs-lookup"><span data-stu-id="1bd93-200">Note that after you have manually edited a query, you will not be able to switch back to Design view without losing the changes.</span></span> <span data-ttu-id="1bd93-201">Чтобы сохранить запрос, созданную инструкцию DMX можно вручную скопировать в текстовый файл.</span><span class="sxs-lookup"><span data-stu-id="1bd93-201">If you wish to save the query, you can copy the DMX statement that you created manually to a text file.</span></span> <span data-ttu-id="1bd93-202">При возврате в конструктор в нем восстанавливается последняя версия запроса, имевшаяся до выхода из него.</span><span class="sxs-lookup"><span data-stu-id="1bd93-202">When you change back to Design view, the query is reverted to the last version that was valid in Design view.</span></span>  
  
## <a name="creating-multiple-predictions"></a><span data-ttu-id="1bd93-203">Создание нескольких прогнозов</span><span class="sxs-lookup"><span data-stu-id="1bd93-203">Creating Multiple Predictions</span></span>  
 <span data-ttu-id="1bd93-204">Предположим, необходимо получить наилучшие прогнозы для отдельных клиентов на основании их прошлых покупок.</span><span class="sxs-lookup"><span data-stu-id="1bd93-204">Suppose you want to know the best predictions for individual customers, based on past purchases.</span></span> <span data-ttu-id="1bd93-205">Можно использовать внешние данные в качестве входных данных для прогнозирующего запроса, например таблицы, содержащие идентификаторы клиентов и их последние покупки товаров.</span><span class="sxs-lookup"><span data-stu-id="1bd93-205">You can use external data as input to the prediction query, such as tables containing the customer ID and the most recent product purchases.</span></span> <span data-ttu-id="1bd93-206">При этом требуется, чтобы таблицы данных уже были определены как представление источника данных служб Analysis Services. Кроме того, входные данные должны содержать таблицы вариантов и вложенные таблицы наподобие тех, которые используются в модели.</span><span class="sxs-lookup"><span data-stu-id="1bd93-206">The requirements are that the data tables be already defined as an Analysis Services data source view; moreover, the input data must contain case and nested tables like those used in the model.</span></span> <span data-ttu-id="1bd93-207">Им не обязательно иметь одинаковые имена, но структура должна быть сходной.</span><span class="sxs-lookup"><span data-stu-id="1bd93-207">They need not have the same names, but the structure must be similar.</span></span> <span data-ttu-id="1bd93-208">В целях этого учебника будут использоваться исходные таблицы, которые применялись для обучения модели.</span><span class="sxs-lookup"><span data-stu-id="1bd93-208">For the purpose of this tutorial, you will use the original tables on which the model was trained.</span></span>  
  
#### <a name="to-change-the-input-method-for-the-prediction-query"></a><span data-ttu-id="1bd93-209">Изменение метода ввода для прогнозирующего запроса</span><span class="sxs-lookup"><span data-stu-id="1bd93-209">To change the input method for the prediction query</span></span>  
  
1.  <span data-ttu-id="1bd93-210">В меню **модель интеллектуального анализа данных** выберите **одноэлементный запрос** еще раз, чтобы снять флажок.</span><span class="sxs-lookup"><span data-stu-id="1bd93-210">In the **Mining Model** menu, select **Singleton Query** again, to clear the check mark.</span></span>  
  
2.  <span data-ttu-id="1bd93-211">Появится сообщение об ошибке, предупреждая о том, что одноэлементный запрос будет утерян.</span><span class="sxs-lookup"><span data-stu-id="1bd93-211">An error message appears warning that your singleton query will be lost.</span></span> <span data-ttu-id="1bd93-212">Нажмите кнопку **Да**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-212">Click **Yes**.</span></span>  
  
     <span data-ttu-id="1bd93-213">Имя диалогового окна ввода меняется на **Выбор входных таблиц**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-213">The name of the input dialog box changes to **Select Input Table(s)**.</span></span>  
  
 <span data-ttu-id="1bd93-214">Поскольку необходимо создать прогнозирующий запрос, предоставляющий идентификатор клиента и список продуктов в качестве входных данных, потребуется добавить таблицу клиентов в качестве таблицы вариантов и таблицу покупок в качестве вложенной таблицы.</span><span class="sxs-lookup"><span data-stu-id="1bd93-214">Because you are interested in creating a prediction query that provides Customer ID and a list of products as input, you will add the customer table as the case table, and the purchases table as the nested table.</span></span> <span data-ttu-id="1bd93-215">Затем нужно добавить прогнозирующие функции для создания рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="1bd93-215">Then you will add prediction functions to create recommendations.</span></span>  
  
#### <a name="to-create-a-prediction-query-using-nested-table-inputs"></a><span data-ttu-id="1bd93-216">Создание прогнозирующего запроса с использованием входных данных вложенной таблицы</span><span class="sxs-lookup"><span data-stu-id="1bd93-216">To create a prediction query using nested table inputs</span></span>  
  
1.  <span data-ttu-id="1bd93-217">На панели «Модель интеллектуального анализа данных» выберите «Фильтруемые взаимосвязи».</span><span class="sxs-lookup"><span data-stu-id="1bd93-217">In the Mining Model pane, select the Association Filtered model.</span></span>  
  
2.  <span data-ttu-id="1bd93-218">В диалоговом окне **Выбор входных таблиц** нажмите кнопку **выбрать таблицу вариантов**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-218">In the **Select Input Table(s)** dialog box, click **Select Case Table**.</span></span>  
  
3.  <span data-ttu-id="1bd93-219">В диалоговом окне **Выбор таблицы** для поля **источник данных**выберите AdventureWorksDW2008.</span><span class="sxs-lookup"><span data-stu-id="1bd93-219">In the **Select Table** dialog box, for **Data Source**, select AdventureWorksDW2008.</span></span> <span data-ttu-id="1bd93-220">В списке **имя таблицы или представления** выберите vAssocSeqOrders и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-220">In the **Table/View Name** list, select vAssocSeqOrders, and then click **OK**.</span></span>  
  
     <span data-ttu-id="1bd93-221">Таблица vAssocSeqOrders добавляется на панель.</span><span class="sxs-lookup"><span data-stu-id="1bd93-221">The table vAssocSeqOrders is added to the pane.</span></span>  
  
4.  <span data-ttu-id="1bd93-222">В диалоговом окне **Выбор входных таблиц** нажмите кнопку **выбрать вложенную таблицу**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-222">In the **Select Input Table(s)** dialog box, click **Select Nested Table**.</span></span>  
  
5.  <span data-ttu-id="1bd93-223">В диалоговом окне **Выбор таблицы** для поля **источник данных**выберите AdventureWorksDW2008.</span><span class="sxs-lookup"><span data-stu-id="1bd93-223">In the **Select Table** dialog box, for **Data Source**, select AdventureWorksDW2008.</span></span> <span data-ttu-id="1bd93-224">В списке **имя таблицы или представления** выберите vAssocSeqLineItems и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-224">In the **Table/View name** list, select vAssocSeqLineItems, and then click **OK**.</span></span>  
  
     <span data-ttu-id="1bd93-225">Таблица vAssocSeqLineItems добавляется на панель.</span><span class="sxs-lookup"><span data-stu-id="1bd93-225">The table vAssocSeqLineItems is added to the pane.</span></span>  
  
6.  <span data-ttu-id="1bd93-226">В диалоговом окне **Указание вложенного объединения** перетащите поле OrderNumber из таблицы вариантов и поместите его в поле OrderNumber во вложенной таблице.</span><span class="sxs-lookup"><span data-stu-id="1bd93-226">In the **Specify Nested Join** dialog box, drag the OrderNumber field from the case table and drop it onto the OrderNumber field in the nested table.</span></span>  
  
     <span data-ttu-id="1bd93-227">Можно также щелкнуть **Добавить связь** и создать связь, выбрав столбцы из списка.</span><span class="sxs-lookup"><span data-stu-id="1bd93-227">You can also click **Add Relationship** and create the relationship by selecting columns from a list.</span></span>  
  
7.  <span data-ttu-id="1bd93-228">В диалоговом окне **Определение связи** убедитесь, что поля OrderNumber сопоставлены правильно, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-228">In the **Specify Relationship** dialog box, verify that the OrderNumber fields are mapped correctly, and then click **OK**.</span></span>  
  
8.  <span data-ttu-id="1bd93-229">Нажмите кнопку **ОК** , чтобы закрыть диалоговое окно **Указание вложенного объединения** .</span><span class="sxs-lookup"><span data-stu-id="1bd93-229">Click **OK** to close the **Specify Nested Join** dialog box.</span></span>  
  
     <span data-ttu-id="1bd93-230">Таблица вариантов и вложенная таблица обновляются на панели конструирования для отображения соединений между столбцами внешних данных и столбцами модели.</span><span class="sxs-lookup"><span data-stu-id="1bd93-230">The case and nested tables are updated in the design pane to show the joins connecting the external data columns to the columns in the model.</span></span> <span data-ttu-id="1bd93-231">Если связи неверны, можно щелкнуть правой кнопкой мыши линию соединения и выбрать пункт **Изменить соединения** , чтобы изменить сопоставление столбцов, или щелкнуть правой кнопкой мыши строку соединения и выбрать команду **Удалить** , чтобы полностью удалить связь.</span><span class="sxs-lookup"><span data-stu-id="1bd93-231">If the relationships are wrong, you can right-click the join line and select **Modify Connections** to edit the column mapping, or you can right-click the join line and select **Delete** to remove the relationship completely.</span></span>  
  
9. <span data-ttu-id="1bd93-232">Добавьте в сетку новую строку.</span><span class="sxs-lookup"><span data-stu-id="1bd93-232">Add a new row to the grid.</span></span> <span data-ttu-id="1bd93-233">В качестве **источника**выберите **vAssocSeqOrders таблица**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-233">For **Source**, select **vAssocSeqOrders table**.</span></span> <span data-ttu-id="1bd93-234">Для **поля поле**выберите CustomerKey.</span><span class="sxs-lookup"><span data-stu-id="1bd93-234">For **Field**, select CustomerKey.</span></span>  
  
10. <span data-ttu-id="1bd93-235">Добавьте в сетку новую строку.</span><span class="sxs-lookup"><span data-stu-id="1bd93-235">Add a new row to the grid.</span></span> <span data-ttu-id="1bd93-236">В качестве **источника**выберите **vAssocSeqOrders таблица**.</span><span class="sxs-lookup"><span data-stu-id="1bd93-236">For **Source**, select **vAssocSeqOrders table**.</span></span> <span data-ttu-id="1bd93-237">Для **поля**выберите регион.</span><span class="sxs-lookup"><span data-stu-id="1bd93-237">For **Field**, select Region.</span></span>  
  
11. <span data-ttu-id="1bd93-238">Добавьте в сетку новую строку.</span><span class="sxs-lookup"><span data-stu-id="1bd93-238">Add a new row to the grid.</span></span> <span data-ttu-id="1bd93-239">В поле **источник**выберите **функция прогнозирование**, а для **поля**выберите `PredictAssociation` .</span><span class="sxs-lookup"><span data-stu-id="1bd93-239">For **Source**, select **Prediction Function**, and for **Field**, select `PredictAssociation`.</span></span>  
  
12. <span data-ttu-id="1bd93-240">Перетащите vAssocSeqLineItems в поле **критерий или аргумент** `PredictAssociation` строки.</span><span class="sxs-lookup"><span data-stu-id="1bd93-240">Drag vAssocSeqLineItems, into the **Criteria/Argument** box of the `PredictAssociation` row.</span></span> <span data-ttu-id="1bd93-241">Щелкните в конце поля **критерий или аргумент** и введите следующий текст:`INCLUDE_STATISTICS,3`</span><span class="sxs-lookup"><span data-stu-id="1bd93-241">Click at the end of the **Criteria/Argument** box and then type the following text: `INCLUDE_STATISTICS,3`</span></span>  
  
     <span data-ttu-id="1bd93-242">Полный текст в поле **критерий или аргумент** должен быть следующим:`[Association].[v Assoc Seq Line Items], INCLUDE_STATISTICS, 3`</span><span class="sxs-lookup"><span data-stu-id="1bd93-242">The complete text in the **Criteria/Argument** box should be: `[Association].[v Assoc Seq Line Items], INCLUDE_STATISTICS, 3`</span></span>  
  
13. <span data-ttu-id="1bd93-243">Нажмите кнопку **результат** , чтобы просмотреть прогнозы для каждого клиента.</span><span class="sxs-lookup"><span data-stu-id="1bd93-243">Click the **Result** button to view the predictions for each customer.</span></span>  
  
 <span data-ttu-id="1bd93-244">Можно попытаться создать подобный прогнозирующий запрос для нескольких моделей и узнать, изменятся ли результаты прогнозов после фильтрации.</span><span class="sxs-lookup"><span data-stu-id="1bd93-244">You might try creating a similar prediction query on the multiple models, to see whether filtering changes the prediction results.</span></span> <span data-ttu-id="1bd93-245">Дополнительные сведения о создании прогнозов и других типов запросов см. в разделе [примеры запросов модели взаимосвязей](../../2014/analysis-services/data-mining/association-model-query-examples.md).</span><span class="sxs-lookup"><span data-stu-id="1bd93-245">For more information about creating predictions and other types of queries, see [Association Model Query Examples](../../2014/analysis-services/data-mining/association-model-query-examples.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1bd93-246">См. также:</span><span class="sxs-lookup"><span data-stu-id="1bd93-246">See Also</span></span>  
 <span data-ttu-id="1bd93-247">[Содержимое моделей интеллектуального анализа данных для моделей взаимосвязей &#40;Analysis Services — интеллектуальный анализ&#41;](../../2014/analysis-services/data-mining/mining-model-content-for-association-models-analysis-services-data-mining.md) </span><span class="sxs-lookup"><span data-stu-id="1bd93-247">[Mining Model Content for Association Models &#40;Analysis Services - Data Mining&#41;](../../2014/analysis-services/data-mining/mining-model-content-for-association-models-analysis-services-data-mining.md) </span></span>  
 <span data-ttu-id="1bd93-248">[PredictAssociation &#40;расширений интеллектуального анализа данных&#41;](/sql/dmx/predictassociation-dmx) </span><span class="sxs-lookup"><span data-stu-id="1bd93-248">[PredictAssociation &#40;DMX&#41;](/sql/dmx/predictassociation-dmx) </span></span>  
 [<span data-ttu-id="1bd93-249">Создание прогнозирующего запроса с помощью построителя прогнозирующих запросов</span><span class="sxs-lookup"><span data-stu-id="1bd93-249">Create a Prediction Query Using the Prediction Query Builder</span></span>](../../2014/analysis-services/data-mining/create-a-prediction-query-using-the-prediction-query-builder.md)  
  
  
