---
title: Обновление PowerPivot для SharePoint | Документация Майкрософт
ms.custom: ''
ms.date: 03/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: 80ba9e43-f3f0-4730-9fb1-2afd2dd3e6fc
author: Minewiskan
ms.author: owend
ms.openlocfilehash: bebcfed02aa30ffc686b2a74807b6a4cc3955c90
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87657868"
---
# <a name="upgrade-powerpivot-for-sharepoint"></a><span data-ttu-id="d46eb-102">Обновление PowerPivot для SharePoint</span><span class="sxs-lookup"><span data-stu-id="d46eb-102">Upgrade PowerPivot for SharePoint</span></span>
  <span data-ttu-id="d46eb-103">В этом разделе описаны шаги, необходимые для обновления развертывания [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] до [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d46eb-103">This topic summarizes the steps required to upgrade a deployment of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] to [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)].</span></span> <span data-ttu-id="d46eb-104">Конкретная последовательность действий зависит от версии SharePoint вашей среды и включает надстройку PowerPivot для SharePoint (**spPowerPivot.msi**).</span><span class="sxs-lookup"><span data-stu-id="d46eb-104">The specific steps depend on the version of SharePoint your environment is currently running and include the PowerPivot for SharePoint Add-in (**spPowerPivot.msi**).</span></span>  
  
 <span data-ttu-id="d46eb-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="d46eb-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span></span>  
  
 <span data-ttu-id="d46eb-106">Сведения о выпуске см. в разделе [Заметки о выпуске SQL Server 2014](https://go.microsoft.com/fwlink/?LinkID=296445).</span><span class="sxs-lookup"><span data-stu-id="d46eb-106">For release notes, see [SQL Server 2014 Release Notes](https://go.microsoft.com/fwlink/?LinkID=296445).</span></span>  
  

  
## <a name="background"></a><span data-ttu-id="d46eb-107">Историческая справка</span><span class="sxs-lookup"><span data-stu-id="d46eb-107">Background</span></span>  
  
-   <span data-ttu-id="d46eb-108">При обновлении многосерверной фермы SharePoint 2010 с двумя или более экземпляров [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] необходимо полностью обновить каждый сервер, **прежде** чем переходить к следующему серверу.</span><span class="sxs-lookup"><span data-stu-id="d46eb-108">If you are upgrading a multi-server SharePoint 2010 farm that has two or more [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instances, you must fully upgrade each server **before** continuing to the next server.</span></span> <span data-ttu-id="d46eb-109">Полное обновление включает запуск программы установки SQL Server для обновления программных файлов [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , вслед за чем выполняются действия по обновлению SharePoint, которые состоят в настройке обновленных служб.</span><span class="sxs-lookup"><span data-stu-id="d46eb-109">A full upgrade includes running SQL Server Setup to upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] program files, followed by SharePoint upgrade actions that configure the upgraded services.</span></span> <span data-ttu-id="d46eb-110">Доступность сервера будет ограниченна, пока не выполнены действия по обновлению в подходящем средстве настройки PowerPivot или Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d46eb-110">Server availability will be limited until you run upgrade actions in the appropriate PowerPivot Configuration Tool or Windows PowerShell.</span></span>  
  
-   <span data-ttu-id="d46eb-111">Все экземпляры служб PowerPivot System Service и Analysis Services в ферме SharePoint 2010 должны иметь одинаковые версии.</span><span class="sxs-lookup"><span data-stu-id="d46eb-111">All instances of PowerPivot System Service and Analysis Services in a SharePoint 2010 farm must be the same version.</span></span> <span data-ttu-id="d46eb-112">Сведения о том, как проверить версию, см. в разделе [Проверка версий компонентов и служб PowerPivot](#bkmk_verify_versions) в этой статье.</span><span class="sxs-lookup"><span data-stu-id="d46eb-112">For information on how to verify the version, see the section [Verify the Versions of PowerPivot Components and Services](#bkmk_verify_versions) in this topic.</span></span>  
  
-   <span data-ttu-id="d46eb-113">Средства настройки PowerPivot — это одни из общих компонентов SQL Server. Все общие компоненты обновляются одновременно.</span><span class="sxs-lookup"><span data-stu-id="d46eb-113">The PowerPivot configuration tools are one of the SQL Server shared features and all shared features upgrade at the same time.</span></span> <span data-ttu-id="d46eb-114">Если во время обновления будут выбраны другие экземпляры SQL Server или функции, для которых требуется обновление общих компонентов, то средство настройки PowerPivot также будет обновлено.</span><span class="sxs-lookup"><span data-stu-id="d46eb-114">If during an upgrade process you select other SQL Server instances or features that require a shared feature upgrade, then the PowerPivot configuration tool will also be upgraded.</span></span> <span data-ttu-id="d46eb-115">Если средство настройки PowerPivot было обновлено, а экземпляр PowerPivot не был, могут возникнуть проблемы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-115">You may have issues if the PowerPivot configuration tool is upgraded but your PowerPivot instance is not.</span></span> <span data-ttu-id="d46eb-116">Дополнительные сведения о SQL Server общих компонентах см. в статье [обновление до SQL Server 2014 с помощью мастера установки &#40;&#41;установки ](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span><span class="sxs-lookup"><span data-stu-id="d46eb-116">For more information about SQL Server shared features, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
-   <span data-ttu-id="d46eb-117">Надстройка PowerPivot для SharePoint (**spPowerPivot.msi**) устанавливается параллельно с предыдущими версиями.</span><span class="sxs-lookup"><span data-stu-id="d46eb-117">The PowerPivot for SharePoint Add-in (**spPowerPivot.msi**) installs side by side with previous versions.</span></span> <span data-ttu-id="d46eb-118">Например, надстройка [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] устанавливается в папку `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`.</span><span class="sxs-lookup"><span data-stu-id="d46eb-118">For example the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] add-in installs to the folder `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`.</span></span>  
  

  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="d46eb-119">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="d46eb-119">Prerequisites</span></span>  
 <span data-ttu-id="d46eb-120">**Разрешения**</span><span class="sxs-lookup"><span data-stu-id="d46eb-120">**Permissions**</span></span>  
  
-   <span data-ttu-id="d46eb-121">Чтобы обновить PowerPivot для SharePoint, пользователь должен быть администратором фермы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-121">You must be a farm administrator to upgrade a PowerPivot for SharePoint installation.</span></span> <span data-ttu-id="d46eb-122">Для запуска программы установки SQL Server необходимо быть локальным администратором.</span><span class="sxs-lookup"><span data-stu-id="d46eb-122">You must be a local administrator to run SQL Server Setup.</span></span>  
  
-   <span data-ttu-id="d46eb-123">Необходимо иметь разрешения **db_owner** в базе данных конфигураций фермы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-123">You must have **db_owner** permissions on the farm configuration database.</span></span>  
  
 <span data-ttu-id="d46eb-124">**SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="d46eb-124">**SQL Server:**</span></span>  
  
-   <span data-ttu-id="d46eb-125">Если существующая установка PowerPivot имеет значение [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] , то [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] для обновления до требуется пакет обновления 2 (SP2) [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d46eb-125">If the existing PowerPivot installation is [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)], the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] Service Pack 2 (SP2) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="d46eb-126">Если существующая установка PowerPivot — [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] пакет обновления 1 (SP1) необходим для обновления до [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d46eb-126">If the existing PowerPivot installation is [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Service Pack 1 (SP1) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="d46eb-127">**SharePoint 2010.**</span><span class="sxs-lookup"><span data-stu-id="d46eb-127">**SharePoint 2010:**</span></span>  
  
-   <span data-ttu-id="d46eb-128">Если существующая установка выполняет SharePoint 2010, установите пакет обновления 2 (SP2) для SharePoint 2010 перед обновлением до [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d46eb-128">If the existing installation is running SharePoint 2010, install the SharePoint 2010 Service Pack 2 before upgrading to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="d46eb-129">Дополнительные сведения см. в разделе [Пакет обновления 2 (SP2) для Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672).</span><span class="sxs-lookup"><span data-stu-id="d46eb-129">For more information, see [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672).</span></span> <span data-ttu-id="d46eb-130">Используйте команду PowerShell `(Get-SPfarm).BuildVersion.ToString()` , чтобы проверить версию.</span><span class="sxs-lookup"><span data-stu-id="d46eb-130">Use the PowerShell command `(Get-SPfarm).BuildVersion.ToString()` to verify the version.</span></span> <span data-ttu-id="d46eb-131">Для получения информации о дате выпуска по версии сборки см. раздел [Номера сборок в SharePoint 2010](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224).</span><span class="sxs-lookup"><span data-stu-id="d46eb-131">To reference the build version to release date, see [SharePoint 2010 Build Numbers](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224).</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2013-farm"></a><a name="bkmk_uprgade_sharepoint2013"></a> <span data-ttu-id="d46eb-132">Обновление существующей фермы SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="d46eb-132">Upgrade an Existing SharePoint 2013 Farm</span></span>  
 <span data-ttu-id="d46eb-133">Для обновления [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , развернутых в SharePoint 2013, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d46eb-133">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2013, do the following:</span></span>  
  
 <span data-ttu-id="d46eb-134">![обновление powerpivot для sharepoint 2013](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "обновление powerpivot для sharepoint 2013")</span><span class="sxs-lookup"><span data-stu-id="d46eb-134">![powerpivot for sharepoint 2013 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "powerpivot for sharepoint 2013 upgrade")</span></span>  
  
1.  <span data-ttu-id="d46eb-135">Запустите программу установки [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] на внутренних серверах, выполняющих [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d46eb-135">Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup on backend server(s) that run [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode.</span></span> <span data-ttu-id="d46eb-136">Если сервер содержит несколько экземпляров [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], обновите по крайней мере экземпляр **POWERPIVOT** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-136">If the server hosts multiple instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], upgrade at least the **POWERPIVOT** instance.</span></span> <span data-ttu-id="d46eb-137">В следующем списке приведена сводка шагов мастера установки, относящихся к обновлению [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="d46eb-137">The following list is a summary of setup wizard steps related to a [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] upgrade:</span></span>  
  
    1.  <span data-ttu-id="d46eb-138">В мастере установки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] нажмите кнопку **Установка**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-138">In the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup Wizard, click **Installation**.</span></span>  
  
    2.  <span data-ttu-id="d46eb-139">Выберите **Обновление с SQL Server...** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-139">Click **Upgrade from SQL Server.....**.</span></span>  
  
    3.  <span data-ttu-id="d46eb-140">На странице **Выбор экземпляра** выберите экземпляр с именем **POWERPIVOT** и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-140">On the **Select Instance** page, select the **POWERPIVOT** instance name and then click **Next**.</span></span>  
  
    4.  <span data-ttu-id="d46eb-141">Дополнительные сведения см. в статье [обновление до SQL Server 2014 с помощью мастера установки &#40;установки&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span><span class="sxs-lookup"><span data-stu-id="d46eb-141">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span></span>  
  
2.  <span data-ttu-id="d46eb-142">Перезапустите сервер.</span><span class="sxs-lookup"><span data-stu-id="d46eb-142">Restart the server.</span></span>  
  
3.  <span data-ttu-id="d46eb-143">Запустите надстройку [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint (**spPowerPivot.msi**) на каждом сервере в ферме SharePoint 2013, чтобы установить поставщики данных.</span><span class="sxs-lookup"><span data-stu-id="d46eb-143">Run the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint add-in (**spPowerPivot.msi**) on each server in the SharePoint 2013 farm to install the data providers.</span></span> <span data-ttu-id="d46eb-144">Исключением будут серверы, где вы запустили мастер установки SQL Server, который также обновляет поставщики данных.</span><span class="sxs-lookup"><span data-stu-id="d46eb-144">The exception is servers where you ran the SQL Server setup wizard, which also upgrades data providers.</span></span> <span data-ttu-id="d46eb-145">Дополнительные сведения см. в разделе [Установка или удаление надстройки PowerPivot для SharePoint &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span><span class="sxs-lookup"><span data-stu-id="d46eb-145">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
4.  <span data-ttu-id="d46eb-146">**Запустите средство настройки PowerPivot для SharePoint 2013** на одном из серверов приложений SharePoint для настройки фермы SharePoint на работу с обновленными файлами решения, которые установила надстройка.</span><span class="sxs-lookup"><span data-stu-id="d46eb-146">**Run the PowerPivot for SharePoint 2013 Configuration** tool on one of the SharePoint application servers to configure the SharePoint farm with the updated solution files that the add-in installed.</span></span> <span data-ttu-id="d46eb-147">На этом шаге нельзя использовать центр администрирования SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d46eb-147">You cannot use Central SharePoint Administration for this step.</span></span> <span data-ttu-id="d46eb-148">Дополнительные сведения см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="d46eb-148">For more information, see the following:</span></span>  
  
    1.  <span data-ttu-id="d46eb-149">На начальной странице в Windows введите **PowerPivot** и в результатах поиска щелкните **Настройка PowerPivot для SharePoint 2013**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-149">From the Windows Start page, type **PowerPivot** and in the search results, click **PowerPivot for SharePoint 2013 Configuration**.</span></span> <span data-ttu-id="d46eb-150">Обратите внимание, что в результатах поиска могут быть возвращены обе версии средства настройки.</span><span class="sxs-lookup"><span data-stu-id="d46eb-150">Note the search may return both versions of the configuration tool.</span></span>  
  
         <span data-ttu-id="d46eb-151">![два средства настройки powerpivot](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "два средства настройки powerpivot")</span><span class="sxs-lookup"><span data-stu-id="d46eb-151">![two powerpivot configuratoin tools](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "two powerpivot configuratoin tools")</span></span>  
  
         <span data-ttu-id="d46eb-152">либо</span><span class="sxs-lookup"><span data-stu-id="d46eb-152">Or</span></span>  
  
         <span data-ttu-id="d46eb-153">В меню **Пуск** последовательно выберите пункты **Все программы**, [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], **Средства настройки**, **Средство настройки PowerPivot для SharePoint 2013**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-153">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot for SharePoint 2013 Configuration Too**.</span></span> <span data-ttu-id="d46eb-154">Обратите внимание, что это средство присутствует в списке вариантов, только если на локальном сервере установлен компонент [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d46eb-154">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="d46eb-155">Во время запуска средство настройки проверяет состояние обновления решения фермы и решений веб-приложений PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d46eb-155">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="d46eb-156">Если обнаружены более старые версии этих решений, вы увидите сообщение "**обнаружены более новые версии файлов решения PowerPivot. Выберите вариант обновления для обновления фермы**".</span><span class="sxs-lookup"><span data-stu-id="d46eb-156">If older versions of these solutions are detected, you will see the message "**Newer versions of the PowerPivot solution files have been detected. Please select the upgrade option to upgrade your farm**."</span></span> <span data-ttu-id="d46eb-157">Нажмите кнопку **ОК** , чтобы закрыть сообщение проверки системы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-157">Click **OK** to close the system validation message.</span></span>  
  
    3.  <span data-ttu-id="d46eb-158">Выберите **Удаление компонентов, служб, приложений и решений**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-158">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="d46eb-159">Просмотрите действия в списке задач левой панели и исключите те, которые не хотите применять.</span><span class="sxs-lookup"><span data-stu-id="d46eb-159">Review the actions in the left pane task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="d46eb-160">По умолчанию в список включены все действия.</span><span class="sxs-lookup"><span data-stu-id="d46eb-160">All actions are included by default.</span></span> <span data-ttu-id="d46eb-161">Чтобы удалить действие, выберите его в левом списке задач и снимите флажок напротив параметра **Включить это действие в список задач** на странице **Параметры** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-161">To remove an action, select it in the left task list, and then on the **Parameters** page, clear the **Include this action in the task list** checkbox.</span></span>  
  
    5.  <span data-ttu-id="d46eb-162">При необходимости просмотрите подробную информацию на вкладке **Скрипт** или **Вывод** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-162">Optionally, review detailed information in the **Script** or **Output** tab.</span></span>  
  
         <span data-ttu-id="d46eb-163">Вкладка «Вывод» содержит краткое описание действий, которые будут выполнены средством.</span><span class="sxs-lookup"><span data-stu-id="d46eb-163">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="d46eb-164">Эти сведения сохраняются в файлах журналов, расположенных в папке `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`.</span><span class="sxs-lookup"><span data-stu-id="d46eb-164">This information is saved in log files at `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`.</span></span>  
  
         <span data-ttu-id="d46eb-165">Вкладка «Скрипт» содержит командлеты PowerShell или ссылки на файлы скриптов PowerShell, которые будут выполнены средством.</span><span class="sxs-lookup"><span data-stu-id="d46eb-165">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    6.  <span data-ttu-id="d46eb-166">Нажмите кнопку **Проверка** , чтобы убедиться, что каждое действие является допустимым.</span><span class="sxs-lookup"><span data-stu-id="d46eb-166">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="d46eb-167">Если кнопка **Проверка** недоступна, значит, все действия являются допустимыми.</span><span class="sxs-lookup"><span data-stu-id="d46eb-167">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="d46eb-168">Если кнопка **Проверка** доступна, возможно, вы изменили входное значение (например, имя приложения службы Excel), либо средство определило, что определенное действие выполнить невозможно.</span><span class="sxs-lookup"><span data-stu-id="d46eb-168">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="d46eb-169">Если действие не может быть выполнено, следует исключить его или исправить базовые условия, из-за которых действие было отмечено как недопустимое.</span><span class="sxs-lookup"><span data-stu-id="d46eb-169">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="d46eb-170">Первое действие, **Обновление решения фермы**, должно всегда обрабатываться в первую очередь.</span><span class="sxs-lookup"><span data-stu-id="d46eb-170">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="d46eb-171">Это действие регистрирует командлеты PowerShell, которые используются для настройки сервера.</span><span class="sxs-lookup"><span data-stu-id="d46eb-171">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="d46eb-172">При получении ошибки, связанной с этим действием, не продолжайте операцию.</span><span class="sxs-lookup"><span data-stu-id="d46eb-172">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="d46eb-173">Вместо этого используйте сведения из сообщения об ошибке для диагностики и разрешения проблемы, прежде чем обрабатывать другие действия в списке задач.</span><span class="sxs-lookup"><span data-stu-id="d46eb-173">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    7.  <span data-ttu-id="d46eb-174">Нажмите кнопку **Запуск** , чтобы выполнить все действия, которые являются допустимыми для данной задачи.</span><span class="sxs-lookup"><span data-stu-id="d46eb-174">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="d46eb-175">Кнопка**Запуск** становится доступной только после прохождения проверки.</span><span class="sxs-lookup"><span data-stu-id="d46eb-175">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="d46eb-176">При нажатии кнопки **Запуск** появится предупреждение о том, что действия обрабатываются в пакетном режиме: "**Все параметры конфигурации, отмеченные в средстве как действительные, будут применены к ферме SharePoint. Продолжить?** ".</span><span class="sxs-lookup"><span data-stu-id="d46eb-176">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "**All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm. Do you want to continue?**".</span></span>  
  
    8.  <span data-ttu-id="d46eb-177">Чтобы продолжить, нажмите кнопку **Да** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-177">Click **Yes** to continue.</span></span>  
  
    9. <span data-ttu-id="d46eb-178">Обновление решений и компонентов в ферме может занять несколько минут.</span><span class="sxs-lookup"><span data-stu-id="d46eb-178">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="d46eb-179">В течение этого времени запросы на подключение к данным PowerPivot **будут завершаться** с ошибками, похожими на "**не удается обновить данные**" или "при**попытке выполнить запрошенное действие произошла ошибка. Повторите попытку**".</span><span class="sxs-lookup"><span data-stu-id="d46eb-179">During this time, connection requests for PowerPivot data **will fail** with errors similar to "**Unable to refresh data**" or "**An error has occurred trying to perform the requested action. Please try again**."</span></span> <span data-ttu-id="d46eb-180">После завершения обновления сервер станет доступным, и эти ошибки больше не будут возникать.</span><span class="sxs-lookup"><span data-stu-id="d46eb-180">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
     <span data-ttu-id="d46eb-181">Дополнительные сведения см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="d46eb-181">For more information, see the following:</span></span>  
  
    -   [<span data-ttu-id="d46eb-182">PowerPivot Configuration Tools</span><span class="sxs-lookup"><span data-stu-id="d46eb-182">PowerPivot Configuration Tools</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-tools)  
  
    -   [<span data-ttu-id="d46eb-183">Настройка или восстановление PowerPivot для SharePoint 2013 &#40;средства настройки PowerPivot&#41;</span><span class="sxs-lookup"><span data-stu-id="d46eb-183">Configure or Repair PowerPivot for SharePoint 2013 &#40;PowerPivot Configuration Tool&#41;</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-or-repair-power-pivot-for-sharepoint-2013)  
  
    -   [<span data-ttu-id="d46eb-184">Настройка PowerPivot с помощью Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="d46eb-184">PowerPivot Configuration using Windows PowerShell</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-using-windows-powershell)  
  
    -   [<span data-ttu-id="d46eb-185">Справочник по PowerShell для PowerPivot для SharePoint</span><span class="sxs-lookup"><span data-stu-id="d46eb-185">PowerShell Reference for PowerPivot for SharePoint</span></span>](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint)  
  
5.  <span data-ttu-id="d46eb-186">Убедитесь, что обновление выполнено успешно, выполнив шаги после завершения обновления и проверив версию серверов PowerPivot в ферме.</span><span class="sxs-lookup"><span data-stu-id="d46eb-186">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="d46eb-187">Подробные сведения см. в разделе [Post-upgrade verification tasks](#verify) и следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="d46eb-187">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2010-farm"></a><a name="bkmk_uprgade_sharepoint2010"></a> <span data-ttu-id="d46eb-188">Обновление существующей фермы SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="d46eb-188">Upgrade an Existing SharePoint 2010 Farm</span></span>  
 <span data-ttu-id="d46eb-189">Для обновления [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , развернутых в SharePoint 2010, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d46eb-189">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2010, do the following:</span></span>  
  
 <span data-ttu-id="d46eb-190">![обновление powerpivot для sharepoint 2010](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "обновление powerpivot для sharepoint 2010")</span><span class="sxs-lookup"><span data-stu-id="d46eb-190">![powerpivot for sharepoint 2010 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "powerpivot for sharepoint 2010 upgrade")</span></span>  
  
1.  <span data-ttu-id="d46eb-191">Загрузите [Пакет обновления 2 (SP2) для Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) и примените его на всех серверах в ферме.</span><span class="sxs-lookup"><span data-stu-id="d46eb-191">Download [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) and apply it on all servers in the farm.</span></span> <span data-ttu-id="d46eb-192">Проверьте успешность установки SharePoint с пакетом обновления 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="d46eb-192">Verify that SharePoint SP2 installation succeeded.</span></span> <span data-ttu-id="d46eb-193">В центре администрирования на странице «Обновление и миграция» откройте страницу состояния «Проверка установки продукта и обновлений», чтобы просмотреть сообщения о состоянии, относящиеся к пакету обновления 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="d46eb-193">In Central Administration, on the Upgrade and Migration page, open the Check product and patch installation status page to view status messages related to SP2.</span></span>  
  
2.  <span data-ttu-id="d46eb-194">Убедитесь, что служба администрирования Windows SharePoint 2010 запущена.</span><span class="sxs-lookup"><span data-stu-id="d46eb-194">Verify that the SharePoint 2010 Administration Windows service is running.</span></span>  
  
    ```powershell
    Get-Service | Where {$_.displayname -like "*SharePoint*"}  
    ```  
  
3.  <span data-ttu-id="d46eb-195">Убедитесь, что службы **SharePoint\*\*\*\*SQL Server Analysis Services** и **SQL Server PowerPivot System Service** запущены в центре администрирования SharePoint, или выполните следующую команду PowerShell:</span><span class="sxs-lookup"><span data-stu-id="d46eb-195">Verify the **SharePoint** services **SQL Server Analysis Services** and **SQL Server PowerPivot System Service** are started in SharePoint Central Administration or use the following PowerShell command:.</span></span>  
  
    ```powershell
    Get-SPServiceInstance | where {$_.typename -like "*sql*"}  
    ```  
  
4.  <span data-ttu-id="d46eb-196">Убедитесь, что службы **Windows\*\*\*\*Службы SQL Server Analysis Services (PowerPivot)** запущены.</span><span class="sxs-lookup"><span data-stu-id="d46eb-196">Verify the **Windows** service **SQL Server Analysis Services (PowerPivot)** is running.</span></span>  
  
    ```powershell
    Get-Service | where {$_.displayname -like "*powerpivot*"}  
    ```  
  
5.  <span data-ttu-id="d46eb-197">**Запустите программу установки [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Установку** на первом сервере приложений SharePoint, где запущена служба Windows **Службы SQL Server Analysis Services (PowerPivot)** , чтобы обновить экземпляр POWERPIVOT.</span><span class="sxs-lookup"><span data-stu-id="d46eb-197">**Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup** on the first SharePoint application server that runs the **SQL Server Analysis Services (PowerPivot)** Windows service to upgrade the POWERPIVOT instance.</span></span> <span data-ttu-id="d46eb-198">На странице «Установка» мастера установки SQL Server выберите вариант обновления.</span><span class="sxs-lookup"><span data-stu-id="d46eb-198">On the Installation page of the SQL Server Setup Wizard, choose the upgrade option.</span></span> <span data-ttu-id="d46eb-199">Дополнительные сведения см. в разделе [Upgrade to SQL Server 2014 с помощью мастера установки &#40;&#41;установки ](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span><span class="sxs-lookup"><span data-stu-id="d46eb-199">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
6.  <span data-ttu-id="d46eb-200">**Перезапустите сервер** перед запуском средства настройки.</span><span class="sxs-lookup"><span data-stu-id="d46eb-200">**Restart the server** before running the configuration tool.</span></span> <span data-ttu-id="d46eb-201">В этом случае любые обновления или необходимые компоненты, установленные программой установки SQL Server, будут полностью настроены в системе.</span><span class="sxs-lookup"><span data-stu-id="d46eb-201">This step ensures that any updates or prerequisites installed by SQL Server Setup are fully configured on the system.</span></span>  
  
7.  <span data-ttu-id="d46eb-202">**Запустите средство настройки PowerPivot** на первом сервере приложений SharePoint, на котором запущена служба SQL Server Analysis Services (PowerPivot), чтобы обновить решения и веб-службы в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d46eb-202">**Run the PowerPivot Configuration Tool** on the first SharePoint application server that runs SQL Server Analysis Services (PowerPivot) service to upgrade the solutions and Web services in SharePoint.</span></span> <span data-ttu-id="d46eb-203">На этом шаге нельзя использовать центр администрирования.</span><span class="sxs-lookup"><span data-stu-id="d46eb-203">You cannot use Central Administration for this step.</span></span>  
  
    1.  <span data-ttu-id="d46eb-204">В меню **Пуск** последовательно укажите пункты **Все программы**, щелкните [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], щелкните **Средства настройки**и выберите пункт **Средство настройки PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-204">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot Configuration Tool**.</span></span> <span data-ttu-id="d46eb-205">Обратите внимание, что это средство присутствует в списке вариантов, только если на локальном сервере установлен компонент [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d46eb-205">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="d46eb-206">Во время запуска средство настройки проверяет состояние обновления решения фермы и решений веб-приложений PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d46eb-206">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="d46eb-207">Если обнаружены более старые версии этих решений, вы увидите сообщение "обнаружены более новые версии файлов решения PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d46eb-207">If older versions of these solutions are detected, you will see the message "Newer versions of the PowerPivot solution files have been detected.</span></span> <span data-ttu-id="d46eb-208">Выберите параметр обновления для обновления фермы".</span><span class="sxs-lookup"><span data-stu-id="d46eb-208">Please select the upgrade option to upgrade your farm."</span></span> <span data-ttu-id="d46eb-209">Нажмите кнопку **OК** , чтобы закрыть окно сообщения.</span><span class="sxs-lookup"><span data-stu-id="d46eb-209">Click **OK** to close the message.</span></span>  
  
    3.  <span data-ttu-id="d46eb-210">Для продолжения выберите **Обновление компонентов, служб, приложений и решений**и нажмите кнопку **ОК** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-210">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK** to continue.</span></span>  
  
    4.  <span data-ttu-id="d46eb-211">Появится следующее предупреждение: "книги на панели управления PowerPivot будут обновлены до последней версии.</span><span class="sxs-lookup"><span data-stu-id="d46eb-211">The following warning appears: "Workbooks in the PowerPivot Management Dashboard are about to be upgraded to the latest version.</span></span> <span data-ttu-id="d46eb-212">Все настройки, внесенные в существующие книги, будут утеряны.</span><span class="sxs-lookup"><span data-stu-id="d46eb-212">Any customizations you made to the existing workbooks will be lost.</span></span> <span data-ttu-id="d46eb-213">Продолжить?".</span><span class="sxs-lookup"><span data-stu-id="d46eb-213">Do you want to continue?"</span></span>  
  
         <span data-ttu-id="d46eb-214">Это предупреждение относится к книгам на панели управления PowerPivot, связанным с обновлением данных.</span><span class="sxs-lookup"><span data-stu-id="d46eb-214">This warning refers to workbooks in the PowerPivot Management Dashboard that report on data refresh activity.</span></span> <span data-ttu-id="d46eb-215">Если эти книги были настроены, изменения, внесенные в книги, будут утеряны при замене существующих файлов файлами новой версии.</span><span class="sxs-lookup"><span data-stu-id="d46eb-215">If you customized these workbooks, any changes you made to those workbooks will be lost when existing files are replaced with newer versions.</span></span>  
  
         <span data-ttu-id="d46eb-216">Нажмите кнопку **Да** для перезаписи книг книгами более новой версии.</span><span class="sxs-lookup"><span data-stu-id="d46eb-216">Click **Yes** to overwrite the workbooks with newer versions.</span></span> <span data-ttu-id="d46eb-217">В противном случае нажмите кнопку **Нет** , чтобы вернуться на главную страницу.</span><span class="sxs-lookup"><span data-stu-id="d46eb-217">Otherwise, click **No** to return to the home page.</span></span> <span data-ttu-id="d46eb-218">Сохраните книги в другой папке, чтобы иметь их копии, и затем вернитесь к этому шагу для продолжения.</span><span class="sxs-lookup"><span data-stu-id="d46eb-218">Save the workbooks to a different location so that you have a copy, and then return to this step when you are ready to continue.</span></span>  
  
         <span data-ttu-id="d46eb-219">Дополнительные сведения о настройке книг, используемых на панели управления, см. в разделе [Настройка панели управления PowerPivot](https://go.microsoft.com/fwlink/?linkID=229639).</span><span class="sxs-lookup"><span data-stu-id="d46eb-219">For more information about customizing workbooks used in the dashboard, see [Customizing the PowerPivot Management Dashboard](https://go.microsoft.com/fwlink/?linkID=229639).</span></span>  
  
    5.  <span data-ttu-id="d46eb-220">Просмотрите действия в списке задач и исключите те, которые средство настройки не должно выполнять.</span><span class="sxs-lookup"><span data-stu-id="d46eb-220">Review the actions in the task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="d46eb-221">По умолчанию в список включены все действия.</span><span class="sxs-lookup"><span data-stu-id="d46eb-221">All actions are included by default.</span></span> <span data-ttu-id="d46eb-222">Чтобы удалить действие, выберите его в списке задач и снимите флажок напротив параметра **Включить это действие в список задач** на странице «Параметры».</span><span class="sxs-lookup"><span data-stu-id="d46eb-222">To remove an action, select it in the task list, and then clear the **Include this action in the task list** checkbox on the Parameters page.</span></span>  
  
    6.  <span data-ttu-id="d46eb-223">При необходимости просмотрите подробную информацию на вкладке **Вывод** или **Скрипт** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-223">Optionally, review detailed information in the **Output** tab or **Script** tab.</span></span>  
  
         <span data-ttu-id="d46eb-224">Вкладка «Вывод» содержит краткое описание действий, которые будут выполнены средством.</span><span class="sxs-lookup"><span data-stu-id="d46eb-224">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="d46eb-225">Эти сведения сохраняются в файлах журналов, расположенных в папке `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`.</span><span class="sxs-lookup"><span data-stu-id="d46eb-225">This information is saved in log files at `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`.</span></span>  
  
         <span data-ttu-id="d46eb-226">Вкладка «Скрипт» содержит командлеты PowerShell или ссылки на файлы скриптов PowerShell, которые будут выполнены средством.</span><span class="sxs-lookup"><span data-stu-id="d46eb-226">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    7.  <span data-ttu-id="d46eb-227">Нажмите кнопку **Проверка** , чтобы убедиться, что каждое действие является допустимым.</span><span class="sxs-lookup"><span data-stu-id="d46eb-227">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="d46eb-228">Если кнопка **Проверка** недоступна, значит, все действия являются допустимыми.</span><span class="sxs-lookup"><span data-stu-id="d46eb-228">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="d46eb-229">Если кнопка **Проверка** доступна, возможно, вы изменили входное значение (например, имя приложения службы Excel), либо средство определило, что определенное действие выполнить невозможно.</span><span class="sxs-lookup"><span data-stu-id="d46eb-229">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="d46eb-230">Если действие не может быть выполнено, следует исключить его или исправить базовые условия, из-за которых действие было отмечено как недопустимое.</span><span class="sxs-lookup"><span data-stu-id="d46eb-230">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="d46eb-231">Первое действие, **Обновление решения фермы**, должно всегда обрабатываться в первую очередь.</span><span class="sxs-lookup"><span data-stu-id="d46eb-231">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="d46eb-232">Это действие регистрирует командлеты PowerShell, которые используются для настройки сервера.</span><span class="sxs-lookup"><span data-stu-id="d46eb-232">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="d46eb-233">При получении ошибки, связанной с этим действием, не продолжайте операцию.</span><span class="sxs-lookup"><span data-stu-id="d46eb-233">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="d46eb-234">Вместо этого используйте сведения из сообщения об ошибке для диагностики и разрешения проблемы, прежде чем обрабатывать другие действия в списке задач.</span><span class="sxs-lookup"><span data-stu-id="d46eb-234">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    8.  <span data-ttu-id="d46eb-235">Нажмите кнопку **Запуск** , чтобы выполнить все действия, которые являются допустимыми для данной задачи.</span><span class="sxs-lookup"><span data-stu-id="d46eb-235">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="d46eb-236">Кнопка**Запуск** становится доступной только после прохождения проверки.</span><span class="sxs-lookup"><span data-stu-id="d46eb-236">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="d46eb-237">При нажатии кнопки **Запуск** появится предупреждение о том, что действия обрабатываются в пакетном режиме: "Все параметры конфигурации, отмеченные в средстве как действительные, будут применены к ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d46eb-237">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm.</span></span> <span data-ttu-id="d46eb-238">Продолжить?".</span><span class="sxs-lookup"><span data-stu-id="d46eb-238">Do you want to continue?"</span></span>  
  
    9. <span data-ttu-id="d46eb-239">Чтобы продолжить, нажмите кнопку **Да** .</span><span class="sxs-lookup"><span data-stu-id="d46eb-239">Click **Yes** to continue.</span></span>  
  
    10. <span data-ttu-id="d46eb-240">Обновление решений и компонентов в ферме может занять несколько минут.</span><span class="sxs-lookup"><span data-stu-id="d46eb-240">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="d46eb-241">В течение этого времени запросы на соединение с данными PowerPivot завершатся ошибкой, например "не удалось обновить данные" или "произошла ошибка при попытке выполнить запрошенное действие.</span><span class="sxs-lookup"><span data-stu-id="d46eb-241">During this time, connection requests for PowerPivot data will fail with errors like "Unable to refresh data" or "An error has occurred trying to perform the requested action.</span></span> <span data-ttu-id="d46eb-242">Повторите попытку".</span><span class="sxs-lookup"><span data-stu-id="d46eb-242">Please try again."</span></span> <span data-ttu-id="d46eb-243">После завершения обновления сервер станет доступным, и эти ошибки больше не будут возникать.</span><span class="sxs-lookup"><span data-stu-id="d46eb-243">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
8.  <span data-ttu-id="d46eb-244">**Повторите эту процедуру** для каждой службы SQL Server Analysis Services (PowerPivot) в ферме: 1) запустите SQL Server Setup 2) запустите средство настройки PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d46eb-244">**Repeat the process** for each SQL Server Analysis Services (PowerPivot) service in the farm: 1) Run SQL Server setup 2) Run the PowerPivot Configuration tool.</span></span>  
  
9. <span data-ttu-id="d46eb-245">Убедитесь, что обновление выполнено успешно, выполнив шаги после завершения обновления и проверив версию серверов PowerPivot в ферме.</span><span class="sxs-lookup"><span data-stu-id="d46eb-245">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="d46eb-246">Подробные сведения см. в разделе [Post-upgrade verification tasks](#verify) и следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="d46eb-246">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
10. <span data-ttu-id="d46eb-247">**Устранение ошибок**</span><span class="sxs-lookup"><span data-stu-id="d46eb-247">**Troubleshooting errors**</span></span>  
  
     <span data-ttu-id="d46eb-248">На панели «Параметры» для каждого действия можно просмотреть сведения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="d46eb-248">You can view error information in the Parameters pane for each action.</span></span>  
  
     <span data-ttu-id="d46eb-249">Для решения проблем, связанных с развертыванием или откатом решения, убедитесь, что служба администрирования SharePoint 2010 запущена.</span><span class="sxs-lookup"><span data-stu-id="d46eb-249">For problems related to solution deployment or retraction, verify the SharePoint 2010 Administrator service is started.</span></span> <span data-ttu-id="d46eb-250">Эта служба запускает задания таймера, которые вызывают изменения конфигурации фермы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-250">This service runs the timer jobs that trigger configuration changes in a farm.</span></span> <span data-ttu-id="d46eb-251">Если служба не запущена, развертывание или откат решения будет невозможен.</span><span class="sxs-lookup"><span data-stu-id="d46eb-251">If the service is not running, solution deployment or retraction will fail.</span></span> <span data-ttu-id="d46eb-252">Повторяющиеся ошибки указывают на то, что существующее задание развертывания или отката уже поставлено в очередь и происходит блокирование дальнейших действий средства настройки.</span><span class="sxs-lookup"><span data-stu-id="d46eb-252">Persistent errors indicate that an existing deployment or retraction job is already in the queue and blocking further action from the configuration tool.</span></span>  
  
    1.  <span data-ttu-id="d46eb-253">Запустите консоль управления SharePoint 2010 с учетной записью администратора и выполните следующую команду для просмотра заданий, поставленных в очередь:</span><span class="sxs-lookup"><span data-stu-id="d46eb-253">Start the SharePoint 2010 Management Shell as an administrator and then run the following command to view jobs in the queue:</span></span>  
  
        ```cmd
        stsadm -o enumdeployments  
        ```  
  
    2.  <span data-ttu-id="d46eb-254">Просмотрите существующие развертывания для уточнения следующих сведений: **Тип** — откат или развертывание, **Файл** — powerpivotwebapp.wsp или powerpivotfarm.wsp.</span><span class="sxs-lookup"><span data-stu-id="d46eb-254">Review existing deployments for the following information: **Type** is Retraction or Deployment, **File** is powerpivotwebapp.wsp or powerpivotfarm.wsp.</span></span>  
  
    3.  <span data-ttu-id="d46eb-255">Для развертываний или реотзывов, связанных с решениями PowerPivot, скопируйте значение GUID для **JOBID** и вставьте его в следующую команду (используйте команды "отметить", "Копировать" и "вставить" в меню "Правка" оболочки, чтобы скопировать GUID):</span><span class="sxs-lookup"><span data-stu-id="d46eb-255">For deployments or retractions related to PowerPivot solutions, copy the GUID value for **JobId** and then paste it into the following command (use the Mark, Copy, and Paste commands on the Shell's Edit menu to copy the GUID):</span></span>  
  
        ```cmd
        stsadm -o canceldeployment -id "<GUID>"  
        ```  
  
    4.  <span data-ttu-id="d46eb-256">Повторите задачу в средстве настройки, нажав кнопку **Проверка** , а затем кнопку **Запуск**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-256">Retry the task in the configuration tool by clicking **Validate** followed by **Run**.</span></span>  
  
     <span data-ttu-id="d46eb-257">Сведения о других ошибках см. в журналах ULS.</span><span class="sxs-lookup"><span data-stu-id="d46eb-257">For all other errors, check the ULS logs.</span></span> <span data-ttu-id="d46eb-258">Дополнительные сведения см. в статьях [Настройка и просмотр файлов журнала SharePoint и журнала диагностики &#40;PowerPivot для SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging).</span><span class="sxs-lookup"><span data-stu-id="d46eb-258">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging).</span></span>  
  

  
##  <a name="workbooks"></a><a name="bkmk_workbooks"></a> <span data-ttu-id="d46eb-259">книги</span><span class="sxs-lookup"><span data-stu-id="d46eb-259">Workbooks</span></span>  
 <span data-ttu-id="d46eb-260">При обновлении сервера книги PowerPivot, расположенные на сервере, не обязательно обновляются, но старые книги, созданные в предыдущей версии PowerPivot для Excel, будут работать как и прежде, используя функции, доступные в старом выпуске.</span><span class="sxs-lookup"><span data-stu-id="d46eb-260">Upgrading a server does not necessarily upgrade the PowerPivot workbooks that run on it, but older workbooks created in the previous version of PowerPivot for Excel will continue to work as before, using the features available in that release.</span></span> <span data-ttu-id="d46eb-261">Работоспособность книг сохраняется, поскольку обновленный сервер имеет версию поставщика OLE DB служб Analysis Services, который был частью предыдущей установки.</span><span class="sxs-lookup"><span data-stu-id="d46eb-261">Workbooks remain functional because an upgraded server has the version of the Analysis Services OLE DB provider that was part of the previous installation.</span></span>  
  
  
  
##  <a name="data-refresh"></a><a name="bkmk_datarefresh"></a> <span data-ttu-id="d46eb-262">Обновление данных</span><span class="sxs-lookup"><span data-stu-id="d46eb-262">Data Refresh</span></span>  
 <span data-ttu-id="d46eb-263">Обновление повлияет на операции обновления данных.</span><span class="sxs-lookup"><span data-stu-id="d46eb-263">Upgrade will impact data refresh operations.</span></span> <span data-ttu-id="d46eb-264">Плановое обновление данных на сервере доступно только для книг, соответствующих версии сервера.</span><span class="sxs-lookup"><span data-stu-id="d46eb-264">Scheduled data refresh on the server is available only for workbooks that match the server version.</span></span> <span data-ttu-id="d46eb-265">Если имеются книги предыдущей версии, то обновление данных для этих книг может перестать работать.</span><span class="sxs-lookup"><span data-stu-id="d46eb-265">If you are hosting workbooks from the previous version, data refresh might no longer work for those workbooks.</span></span> <span data-ttu-id="d46eb-266">Чтобы снова обеспечить возможность обновления данных, необходимо выполнить обновление этих книг.</span><span class="sxs-lookup"><span data-stu-id="d46eb-266">To re-enable data refresh, you must upgrade the workbooks.</span></span> <span data-ttu-id="d46eb-267">Каждую книгу можно обновить вручную в PowerPivot для Excel или включить автоматическое обновление для компонента обновления данных в SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="d46eb-267">You can upgrade each workbook manually in PowerPivot for Excel, or enable the auto-upgrade for data refresh feature in SharePoint 2010.</span></span> <span data-ttu-id="d46eb-268">Автоматическое обновление обновит книгу до текущей версии перед тем, как выполнять обновление данных, что позволяет выполнять операции обновления данных по расписанию.</span><span class="sxs-lookup"><span data-stu-id="d46eb-268">Auto-upgrade will upgrade a workbook to the current version prior to running data refresh, allowing data refresh operations to remain on schedule.</span></span>  
  

  
##  <a name="verify-the-versions-of-powerpivot-components-and-services"></a><a name="bkmk_verify_versions"></a><span data-ttu-id="d46eb-269">Проверка версий компонентов и служб PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d46eb-269">Verify the Versions of PowerPivot Components and Services</span></span>  
 <span data-ttu-id="d46eb-270">Все экземпляры служб [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] PowerPivot System Service и Analysis Services должны иметь одну и ту же версию.</span><span class="sxs-lookup"><span data-stu-id="d46eb-270">All instances of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] System Service and Analysis Services must be the same version.</span></span> <span data-ttu-id="d46eb-271">Чтобы убедиться, что все компоненты сервера имеют одну и ту же версию, проверьте сведения о версии следующих объектов.</span><span class="sxs-lookup"><span data-stu-id="d46eb-271">To verify that all server components are at the same version, check version information for the following:</span></span>  
  
### <a name="verify-the-version-of-powerpivot-solutions-and-the-powerpivot-system-service"></a><span data-ttu-id="d46eb-272">Проверьте версии решений PowerPivot и службы PowerPivot System Service</span><span class="sxs-lookup"><span data-stu-id="d46eb-272">Verify the version of PowerPivot Solutions and the PowerPivot System Service</span></span>  
 <span data-ttu-id="d46eb-273">Выполните следующую команду PowerShell:</span><span class="sxs-lookup"><span data-stu-id="d46eb-273">Run the following PowerShell command:</span></span>  
  
```powershell
Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="d46eb-274">Проверьте **CurrentSolutionVersion**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-274">Verify the **CurrentSolutionVersion**.</span></span> [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="d46eb-275">версия 12,0. \<major build> .\<minor build></span><span class="sxs-lookup"><span data-stu-id="d46eb-275">is version 12.0.\<major build>.\<minor build></span></span>  
  
### <a name="verify-the-version-of-the-analysis-services-windows-service"></a><span data-ttu-id="d46eb-276">Проверьте версию службы Windows Analysis Services</span><span class="sxs-lookup"><span data-stu-id="d46eb-276">Verify the version of the Analysis Services Windows Service</span></span>  
 <span data-ttu-id="d46eb-277">Если обновлены лишь некоторые серверы [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] в ферме SharePoint 2010, экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] на необновленных серверах будет более старым, чем версия, ожидаемая в ферме.</span><span class="sxs-lookup"><span data-stu-id="d46eb-277">If you upgraded only some of your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] servers in a SharePoint 2010 farm, the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] on un-upgraded servers will be older than the version expected in the farm.</span></span> <span data-ttu-id="d46eb-278">Чтобы использовать все серверы, потребуется обновить их до одной и той же версии.</span><span class="sxs-lookup"><span data-stu-id="d46eb-278">You will need to upgrade all of your servers to the same version in order for them to be usable.</span></span> <span data-ttu-id="d46eb-279">Чтобы проверить версию службы Windows SQL Server Analysis Services (PowerPivot) на каждом компьютере, используйте один из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="d46eb-279">Use one of the following methods to verify the version of the SQL Server Analysis Services (PowerPivot) Windows service on each computer.</span></span>  
  
 <span data-ttu-id="d46eb-280">**Обозреватель файлов Windows**:</span><span class="sxs-lookup"><span data-stu-id="d46eb-280">**Windows File Explorer**:</span></span>  
  
1.  <span data-ttu-id="d46eb-281">Перейдите к папке **Bin** для экземпляра [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d46eb-281">Navigate to the **Bin** folder for the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] instance.</span></span> <span data-ttu-id="d46eb-282">Например, `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`.</span><span class="sxs-lookup"><span data-stu-id="d46eb-282">For example `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`.</span></span>  
  
2.  <span data-ttu-id="d46eb-283">Щелкните `msmdsrv.exe`правой кнопкой мыши и выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-283">Right-click `msmdsrv.exe`, and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="d46eb-284">Щелкните **Сведения**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-284">Click **Details**.</span></span>  
  
4.  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="d46eb-285">Версия файла должна быть 12,00. \<major build> . \<minor build> .</span><span class="sxs-lookup"><span data-stu-id="d46eb-285">file version should be 12.00.\<major build>.\<minor build>.</span></span>  
  
5.  <span data-ttu-id="d46eb-286">Проверьте, что этот номер такой же, как у версии решения PowerPivot и версии системной службы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-286">Verify that this number is identical to the PowerPivot solution and system service version.</span></span>  
  
 <span data-ttu-id="d46eb-287">**Сведения о запуске службы.**</span><span class="sxs-lookup"><span data-stu-id="d46eb-287">**Service start information:**</span></span>  
  
 <span data-ttu-id="d46eb-288">При запуске службы PowerPivot она записывает сведения о версии в журнал событий Windows.</span><span class="sxs-lookup"><span data-stu-id="d46eb-288">When the PowerPivot service starts, it writes version information into the Windows event log.</span></span>  
  
1.  <span data-ttu-id="d46eb-289">Запустите Windows `eventvwr`</span><span class="sxs-lookup"><span data-stu-id="d46eb-289">Run Windows `eventvwr`</span></span>  
  
2.  <span data-ttu-id="d46eb-290">Создайте фильтр для источника `MSOLAP$POWERPIVOT`.</span><span class="sxs-lookup"><span data-stu-id="d46eb-290">Create a filter for source `MSOLAP$POWERPIVOT`.</span></span>  
  
3.  <span data-ttu-id="d46eb-291">Найдите информационное событие следующего вида:</span><span class="sxs-lookup"><span data-stu-id="d46eb-291">Look for an information level event similar to the following</span></span>  
  
     <span data-ttu-id="d46eb-292">Служба   запущена.</span><span class="sxs-lookup"><span data-stu-id="d46eb-292">Service started.</span></span> <span data-ttu-id="d46eb-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**.</span></span>  
  
 <span data-ttu-id="d46eb-294">**Использование PowerShell для проверки версии файла.**</span><span class="sxs-lookup"><span data-stu-id="d46eb-294">**Use PowerShell to verify file version.**</span></span>  
  
 <span data-ttu-id="d46eb-295">Для проверки версии продукта можно использовать PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d46eb-295">You can use PowerShell to verify the product version.</span></span> <span data-ttu-id="d46eb-296">Использование PowerShell будет хорошим вариантом, если вы хотите запрограммировать в скрипте или автоматизировать проверку версии.</span><span class="sxs-lookup"><span data-stu-id="d46eb-296">PowerShell is a good option if you want to script or automate version verification.</span></span>  
  
```powershell
(Get-ChildItem "C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe").VersionInfo  
```  
  
 <span data-ttu-id="d46eb-297">Вышеуказанная команда PowerShell возвращает информацию, аналогичную следующей.</span><span class="sxs-lookup"><span data-stu-id="d46eb-297">The above PowerShell command returns information similar to the following:</span></span>  
  
 <span data-ttu-id="d46eb-298">ProductVersion   FileVersion           FileName</span><span class="sxs-lookup"><span data-stu-id="d46eb-298">ProductVersion   FileVersion           FileName</span></span>  
  
 <span data-ttu-id="d46eb-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span><span class="sxs-lookup"><span data-stu-id="d46eb-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span></span>  
  
### <a name="verify-the-msolap-data-provider-version-on-sharepoint"></a><span data-ttu-id="d46eb-300">Проверка версии поставщика данных MSOLAP в SharePoint</span><span class="sxs-lookup"><span data-stu-id="d46eb-300">Verify the MSOLAP Data Provider Version on SharePoint</span></span>  
 <span data-ttu-id="d46eb-301">Чтобы проверить, какие версии поставщиков OLE DB служб Analysis Services являются надежными для служб Excel, используйте следующие инструкции.</span><span class="sxs-lookup"><span data-stu-id="d46eb-301">Use the following instructions to check which versions of the Analysis Services OLE DB providers are trusted by Excel Services.</span></span> <span data-ttu-id="d46eb-302">Проверить настройки надежного поставщика данных служб Excel может только администратор фермы или приложения службы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-302">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="d46eb-303">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-303">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="d46eb-304">Щелкните имя приложения служб Excel, например **ExcelServiceApp1**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-304">Click the name of the Excel Services service application, for example **ExcelServiceApp1**.</span></span>  
  
3.  <span data-ttu-id="d46eb-305">Щелкните **Надежные поставщики данных**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-305">Click **Trusted Data Providers**.</span></span> <span data-ttu-id="d46eb-306">Должна отобразиться MSOLAP.5 (поставщик Microsoft OLE DB для служб OLAP 11.0).</span><span class="sxs-lookup"><span data-stu-id="d46eb-306">You should see MSOLAP.5 (Microsoft OLE DB Provider for OLAP Services 11.0).</span></span> <span data-ttu-id="d46eb-307">Если вы обновили установку [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , также будет показано MSOLAP.4 из предыдущей версии.</span><span class="sxs-lookup"><span data-stu-id="d46eb-307">If you upgraded your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, you will also see MSOLAP.4 from the previous version.</span></span>  
  
4.  <span data-ttu-id="d46eb-308">Дополнительные сведения см. в разделе [Добавление MSOLAP.5 в качестве надежного поставщика данных в службах Excel Services](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services).</span><span class="sxs-lookup"><span data-stu-id="d46eb-308">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services).</span></span>  
  
 <span data-ttu-id="d46eb-309">MSOLAP.4 описывается как поставщик OLE DB (Майкрософт) для служб OLAP 10.0.</span><span class="sxs-lookup"><span data-stu-id="d46eb-309">MSOLAP.4 is described as the Microsoft OLE DB Provider for OLAP Services 10.0.</span></span> <span data-ttu-id="d46eb-310">Эта версия может являться версией по умолчанию для [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] , которая устанавливается со службами Excel, или это может быть версия [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d46eb-310">This version might be the default version from [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] that is installed with Excel Services, or it might be the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version.</span></span> <span data-ttu-id="d46eb-311">Версия по умолчанию, устанавливаемая SharePoint, не поддерживает доступ к данным PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d46eb-311">The default version that SharePoint installs does not support PowerPivot data access.</span></span> <span data-ttu-id="d46eb-312">Чтобы подключиться к книгам PowerPivot на сервере SharePoint, требуется версия [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] или более поздняя.</span><span class="sxs-lookup"><span data-stu-id="d46eb-312">You must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version or later to connect to PowerPivot workbooks on SharePoint.</span></span> <span data-ttu-id="d46eb-313">Чтобы убедиться в наличии версии [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] , используйте инструкции в предыдущем разделе, в котором описывается проверка версий путем просмотра свойств файлов.</span><span class="sxs-lookup"><span data-stu-id="d46eb-313">To verify you have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version, use the instructions in the previous section that explain how to verify the version by viewing file properties.</span></span>  
  
### <a name="verify-the-adomdnet-data-provider-version"></a><span data-ttu-id="d46eb-314">Проверка версии поставщика данных ADOMD.NET</span><span class="sxs-lookup"><span data-stu-id="d46eb-314">Verify the ADOMD.NET Data Provider Version</span></span>  
 <span data-ttu-id="d46eb-315">Для определения установленной версии ADOMD.NET действуйте следующим образом.</span><span class="sxs-lookup"><span data-stu-id="d46eb-315">Use the following instructions to check which version of ADOMD.NET is installed.</span></span> <span data-ttu-id="d46eb-316">Проверить настройки надежного поставщика данных служб Excel может только администратор фермы или приложения службы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-316">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="d46eb-317">На сервере приложений SharePoint перейдите к `c:\Windows\Assembly`.</span><span class="sxs-lookup"><span data-stu-id="d46eb-317">On your SharePoint application server, browse to `c:\Windows\Assembly`.</span></span>  
  
2.  <span data-ttu-id="d46eb-318">Отсортируйте результаты по имени сборки и найдите **Microsoft.Analysis Services.Adomd.Client**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-318">Sort by assembly name and find the **Microsoft.Analysis Services.Adomd.Client**.</span></span>  
  
3.  <span data-ttu-id="d46eb-319">Убедитесь, что у вас установлена версия 12,0. \<build number> .</span><span class="sxs-lookup"><span data-stu-id="d46eb-319">Verify you have version 12.0.\<build number>.</span></span>  
  

##  <a name="upgrading-multiple-powerpivot-for-sharepoint-servers-in-a-sharepoint-farm"></a><a name="geminifarm"></a><span data-ttu-id="d46eb-320">Обновление нескольких серверов PowerPivot для SharePoint в ферме SharePoint</span><span class="sxs-lookup"><span data-stu-id="d46eb-320">Upgrading Multiple PowerPivot for SharePoint Servers in a SharePoint Farm</span></span>  
 <span data-ttu-id="d46eb-321">В многосерверной топологии, включающей более одного сервера [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , все экземпляры серверов и компонентов должны иметь одинаковую версию.</span><span class="sxs-lookup"><span data-stu-id="d46eb-321">In a multi-server topology that includes more than one [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] server, all server instances and components must be the same version.</span></span> <span data-ttu-id="d46eb-322">Сервер, на котором работает более высокая версия ПО, задает уровень поддержки для всех серверов фермы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-322">The server that runs the highest version of the software sets the level for all servers in the farm.</span></span> <span data-ttu-id="d46eb-323">Если обновить лишь некоторые из серверов, то все оставшиеся, на которых работают предыдущие версии ПО, станут недоступными до тех пор, пока тоже не будут обновлены.</span><span class="sxs-lookup"><span data-stu-id="d46eb-323">If you upgrade just some of the servers, the ones that are running older versions of the software will become unavailable until they are also upgraded.</span></span>  
  
 <span data-ttu-id="d46eb-324">После обновления первого сервера дополнительные серверы, которые еще не обновлены, **станут недоступными**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-324">After you upgrade the first server, additional servers that are not yet upgraded **will become unavailable**.</span></span> <span data-ttu-id="d46eb-325">Доступность восстанавливается после того, как все серверы начнут работать на одном и том же уровне.</span><span class="sxs-lookup"><span data-stu-id="d46eb-325">Availability is restored after all servers run at the same level.</span></span>  
  
 <span data-ttu-id="d46eb-326">Программа установки SQL Server обновляет файлы решения PowerPivot на месте на физическом компьютере, но для обновления решений, которые используются в ферме, необходимо воспользоваться средством настройки PowerPivot, описанном в предыдущем подразделе.</span><span class="sxs-lookup"><span data-stu-id="d46eb-326">SQL Server Setup upgrades the PowerPivot solution files in place on the physical computer, but to upgrade the solutions in use by the farm, you must use the PowerPivot Configuration Tool described in a previous section of this topic..</span></span>  

##  <a name="applying-a-qfe-to-a-powerpivot-instance-in-the-farm"></a><a name="qfe"></a><span data-ttu-id="d46eb-327">Применение QFE к экземпляру PowerPivot в ферме</span><span class="sxs-lookup"><span data-stu-id="d46eb-327">Applying a QFE to a PowerPivot instance in the farm</span></span>  
 <span data-ttu-id="d46eb-328">При обновлении сервера PowerPivot для SharePoint существующие программные файлы будут обновлены до новых версий, включая исправления некоторых проблем.</span><span class="sxs-lookup"><span data-stu-id="d46eb-328">Patching a PowerPivot for SharePoint server updates existing program files with a newer version that includes a fix for a specific problem.</span></span> <span data-ttu-id="d46eb-329">При применении QFE к многосерверной топологии отсутствует основной сервер, с которого нужно начинать.</span><span class="sxs-lookup"><span data-stu-id="d46eb-329">When applying a QFE to a multi-server topology, there is no primary server that you must begin with.</span></span> <span data-ttu-id="d46eb-330">Поэтому обновление можно начать с любого сервера, при условии, что к остальным серверам PowerPivot в ферме будет применяться тот же QFE.</span><span class="sxs-lookup"><span data-stu-id="d46eb-330">You can start with any server as long as you apply the same QFE to the other PowerPivot servers in the farm.</span></span>  
  
 <span data-ttu-id="d46eb-331">При применении QFE также необходимо выполнить шаг настройки, в котором информация о версии сервера обновляется в базе данных конфигурации фермы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-331">When you apply the QFE, you must also perform a configuration step that updates the server version information in the farm configuration database.</span></span> <span data-ttu-id="d46eb-332">Версия обновленного сервера становится новой ожидаемой версией фермы.</span><span class="sxs-lookup"><span data-stu-id="d46eb-332">The version of the patched server becomes the new expected version for the farm.</span></span> <span data-ttu-id="d46eb-333">До применения и настройки QFE на всех компьютерах экземпляры PowerPivot для SharePoint, к которым не применен QFE, будут недоступны для обработки запросов данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d46eb-333">Until the QFE is applied and configured across all machines, the PowerPivot for SharePoint instances that do not have the QFE will be unavailable to handle requests for PowerPivot data.</span></span>  
  
 <span data-ttu-id="d46eb-334">Следуйте данным инструкциям, чтобы обеспечить применения и правильную настройку QFE.</span><span class="sxs-lookup"><span data-stu-id="d46eb-334">To ensure the QFE is applied and configured correctly, follow these instructions:</span></span>  
  
1.  <span data-ttu-id="d46eb-335">Установите обновление, следуя инструкциям, прилагаемым к QFE.</span><span class="sxs-lookup"><span data-stu-id="d46eb-335">Install the patch using the instructions that are provided with the QFE.</span></span>  
  
2.  <span data-ttu-id="d46eb-336">Запустите средство настройки PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d46eb-336">Start the PowerPivot Configuration Tool.</span></span>  
  
3.  <span data-ttu-id="d46eb-337">Выберите **Удаление компонентов, служб, приложений и решений**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-337">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="d46eb-338">Ознакомьтесь с действиями, которые включены в обновления задач и затем щелкните **Проверить**.</span><span class="sxs-lookup"><span data-stu-id="d46eb-338">Review the actions that are included in the upgrade task, and then click **Validate**.</span></span>  
  
5.  <span data-ttu-id="d46eb-339">Нажмите кнопку **Выполнить** для предварительного просмотра отчета.</span><span class="sxs-lookup"><span data-stu-id="d46eb-339">Click **Run** to apply the actions.</span></span>  
  
6.  <span data-ttu-id="d46eb-340">Повторите для дополнительных экземпляров PowerPivot для SharePoint в ферме.</span><span class="sxs-lookup"><span data-stu-id="d46eb-340">Repeat for additional PowerPivot for SharePoint instances in the farm.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="d46eb-341">В многосерверной среде развертывания убедитесь, что обновление применено и настроено на каждом экземпляре. Затем переходите к следующему компьютеру.</span><span class="sxs-lookup"><span data-stu-id="d46eb-341">In a multi-server deployment, be sure to both patch and configure each instance before continuing to the next machine.</span></span> <span data-ttu-id="d46eb-342">Перед тем как перейти к следующему экземпляру, необходимо выполнить с помощью средства настройки PowerPivot обновление для текущего экземпляра.</span><span class="sxs-lookup"><span data-stu-id="d46eb-342">The PowerPivot Configuration Tool must complete the upgrade task for the current instance before you move on to the next instance.</span></span>  
  
 <span data-ttu-id="d46eb-343">Проверить сведения о версии для служб в ферме можно на странице **Проверка состояния установки продукта и обновлений** в разделе «Управление обновлением и исправлениями» центра администрирования.</span><span class="sxs-lookup"><span data-stu-id="d46eb-343">To check version information for services in the farm, use the **Check product and patch installation status** page in the Upgrade and Patch Management section in Central Administration.</span></span>  
  
##  <a name="post-upgrade-verification-tasks"></a><a name="verify"></a> <span data-ttu-id="d46eb-344">Задачи проверки после обновления</span><span class="sxs-lookup"><span data-stu-id="d46eb-344">Post-upgrade verification tasks</span></span>  
 <span data-ttu-id="d46eb-345">После завершения обновления выполните следующие действия, чтобы проверить работоспособность сервера.</span><span class="sxs-lookup"><span data-stu-id="d46eb-345">After upgrade is complete, use the following steps to verify the server is operational.</span></span>  
  
|<span data-ttu-id="d46eb-346">Задача</span><span class="sxs-lookup"><span data-stu-id="d46eb-346">Task</span></span>|<span data-ttu-id="d46eb-347">Ссылка</span><span class="sxs-lookup"><span data-stu-id="d46eb-347">Link</span></span>|  
|----------|----------|  
|<span data-ttu-id="d46eb-348">Проверьте, запущена ли служба на всех компьютерах, где работает PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d46eb-348">Verify the service is running on all computers that run PowerPivot for SharePoint.</span></span>|[<span data-ttu-id="d46eb-349">Запуск и остановка PowerPivot для сервера SharePoint</span><span class="sxs-lookup"><span data-stu-id="d46eb-349">Start or Stop a PowerPivot for SharePoint Server</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/start-or-stop-a-power-pivot-for-sharepoint-server)|  
|<span data-ttu-id="d46eb-350">Проверьте активацию компонентов на уровне семейства веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="d46eb-350">Verify feature activation at the site collection level.</span></span>|[<span data-ttu-id="d46eb-351">Активация интеграции функций PowerPivot для семейств веб-сайтов в центре администрирования</span><span class="sxs-lookup"><span data-stu-id="d46eb-351">Activate PowerPivot Feature Integration for Site Collections in Central Administration</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/activate-power-pivot-integration-for-site-collections-in-ca)|  
|<span data-ttu-id="d46eb-352">Проверьте, правильно ли загружаются книги PowerPivot, открыв книгу и выбрав фильтры и срезы, чтобы выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="d46eb-352">Verify individual PowerPivot workbooks are loading properly by opening a workbook and clicking on filters and slicers to initiate a query.</span></span>|<span data-ttu-id="d46eb-353">Проверьте наличие кэшированных файлов на жестком диске.</span><span class="sxs-lookup"><span data-stu-id="d46eb-353">Check for the presence of cached files on the hard drive.</span></span> <span data-ttu-id="d46eb-354">Если файл присутствует в кэше, значит этот файл данных загрузился на данном физическом сервере.</span><span class="sxs-lookup"><span data-stu-id="d46eb-354">A cached file confirms that the data file was loaded on that physical server.</span></span> <span data-ttu-id="d46eb-355">Ищите кэшированные файлы в папке c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup.</span><span class="sxs-lookup"><span data-stu-id="d46eb-355">Look for cached files in the c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup folder.</span></span>|  
|<span data-ttu-id="d46eb-356">Проверьте функцию обновления данных в выбранных книгах, настроенных для поддержки обновления данных.</span><span class="sxs-lookup"><span data-stu-id="d46eb-356">Test data refresh on selected workbooks that are configured for data refresh.</span></span>|<span data-ttu-id="d46eb-357">Самый простой способ проверки обновления данных заключается в изменении расписания обновления данных с помощью установки флажка **Обновлять при первой возможности** , чтобы операции обновления данных выполнялись немедленно.</span><span class="sxs-lookup"><span data-stu-id="d46eb-357">The easiest way to test data refresh is to modify a data refresh schedule, choosing the **Also refresh as soon as possible** checkbox so that data refresh runs immediately.</span></span> <span data-ttu-id="d46eb-358">При помощи этого шага удастся определить успешность обновления данных для текущей книги.</span><span class="sxs-lookup"><span data-stu-id="d46eb-358">This step will determine whether data refresh is successful for the current workbook.</span></span> <span data-ttu-id="d46eb-359">Повторите эти шаги для других часто используемых книг, чтобы убедиться, что обновление данных работает.</span><span class="sxs-lookup"><span data-stu-id="d46eb-359">Repeat these steps for other frequently used workbooks to ensure that data refresh is functional.</span></span> <span data-ttu-id="d46eb-360">Дополнительные сведения о планировании обновления данных см. [в разделе планирование &#40;обновления данных PowerPivot для SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="d46eb-360">For more information about scheduling data refresh, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>|  
|<span data-ttu-id="d46eb-361">Следите за отчетами об обновлении данных на панели мониторинга PowerPivot, чтобы убедиться в отсутствии ошибок.</span><span class="sxs-lookup"><span data-stu-id="d46eb-361">Over time, monitor the data refresh reports in PowerPivot Management Dashboard to confirm there are no data refresh errors.</span></span>|[<span data-ttu-id="d46eb-362">Панель мониторинга управления PowerPivot и данные об использовании</span><span class="sxs-lookup"><span data-stu-id="d46eb-362">PowerPivot Management Dashboard and Usage Data</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data)|  
  
 <span data-ttu-id="d46eb-363">Дополнительные сведения о настройке параметров и компонентов PowerPivot см. [в разделе Администрирование сервера PowerPivot и настройка в центре администрирования](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration).</span><span class="sxs-lookup"><span data-stu-id="d46eb-363">For more information about how to configure PowerPivot settings and features, see [PowerPivot Server Administration and Configuration in Central Administration](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration).</span></span>  
  
 <span data-ttu-id="d46eb-364">Пошаговые инструкции по выполнению всех задач настройки после установки см. в разделе [Начальная настройка &#40;PowerPivot для SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="d46eb-364">For step-by-step instructions that guide you through all of the post-installation configuration tasks, see [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  

## <a name="see-also"></a><span data-ttu-id="d46eb-365">См. также:</span><span class="sxs-lookup"><span data-stu-id="d46eb-365">See Also</span></span>  
 <span data-ttu-id="d46eb-366">[Функции, поддерживаемые различными выпусками SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span><span class="sxs-lookup"><span data-stu-id="d46eb-366">[Features Supported by the Editions of SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span></span>  
 [<span data-ttu-id="d46eb-367">Установка PowerPivot для SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="d46eb-367">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
