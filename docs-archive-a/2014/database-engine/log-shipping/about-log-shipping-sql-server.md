---
title: Сведения о доставке журналов (SQL Server) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- secondary servers [SQL Server]
- log shipping [SQL Server], jobs
- copy jobs [SQL Server]
- primary databases [SQL Server]
- log shipping [SQL Server], monitoring
- log shipping [SQL Server], about log shipping
- alert jobs [SQL Server]
- availability [SQL Server]
- jobs [SQL Server], log shipping
- monitor servers [SQL Server]
- restore jobs [SQL Server]
- log shipping [SQL Server]
- backup jobs [SQL Server]
- primary servers [SQL Server]
ms.assetid: 55da6b94-3a4b-4bae-850f-4bf7f6e918ca
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: cbf36e0ddd94ec0ab0a40a448e50602decfc0645
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87730870"
---
# <a name="about-log-shipping-sql-server"></a>Сведения о доставке журналов (SQL Server)
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] позволяет автоматически отправлять резервные копии журналов транзакций из *базы данных-источника* экземпляра *сервера-источника* в одну или более *баз данных-получателей* других экземпляров *сервера-получателя* . Резервные копии журналов транзакций применяются к каждой из баз данных-получателей индивидуально. Необязательный третий экземпляр сервера, известный как *сервер мониторинга*, ведет журнал и отслеживает состояние операций резервного копирования и восстановления и при необходимости выдает предупреждение, если в этих запланированных операциях происходит сбой.  
  
 **В этом разделе.**  
  
-   [Преимущества](#Benefits)  
  
-   [Термины и определения](#TermsAndDefinitions)  
  
-   [Общие сведения о доставке журналов](#ComponentsAndConcepts)  
  
-   [Совместимость](#Interoperability)  
  
-   [Связанные задачи](#RelatedTasks)  
  
##  <a name="benefits"></a><a name="Benefits"></a> Преимущества  
  
-   Предоставляет решение восстановления при аварии для одной базы данных-источника и одной или нескольких баз данных-получателей, каждая из которых расположена на отдельном экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
-   Поддерживает ограниченный доступ только на чтение к базам данных-получателям (в перерывах между заданиями восстановления).  
  
-   Позволяет пользователю задать задержку между моментом, когда сервер-источник создает резервную копию журнала базы данных-источника, и моментом, когда сервер-получатель должен восстановить (применить) резервную копию журнала. Большая задержка может быть полезной, например если данные в базе данных-источнике изменены случайно. Если случайное изменение будет замечено достаточно быстро, задержка позволит получить еще не измененные данные с базы данных-получателя до того, как изменения будут отражены в ней.  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> Термины и определения  
 сервера-источника  
 Экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , являющийся рабочим сервером.  
  
 базы данных-источника  
 База данных сервера-источника, резервную копию которой нужно создать на другом сервере. Все администрирование конфигурации доставки журналов через среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] производится на базе данных-источнике.  
  
 сервера-получателя  
 Экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , на котором нужно хранить «горячую» копию базы данных-источника.  
  
 база данных-получатель  
 «Горячая» копия базы данных-источника. База данных-получатель может находиться в состояниях RECOVERING или STANDBY, что означает, что она доступна в ограниченном режиме только для чтения.  
  
 сервер мониторинга  
 Необязательный экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , который отслеживает весь процесс доставки журналов, в том числе:  
  
-   когда резервная копия журнала транзакций на базе данных-источнике была сохранена в последний раз;  
  
-   когда серверы-получатели в последний раз копировали и восстанавливали файлы резервных копий;  
  
-   сведения о любых предупреждениях о сбоях.  
  
> [!IMPORTANT]  
>  После настройки сервера мониторинга конфигурацию доставки журналов нельзя изменить, не удалив предварительно доставку журналов.  
  
 задание резервного копирования  
 Задание агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которое выполняет операцию резервного копирования, ведет журнал на локальном сервере и на сервере мониторинга и удаляет старые файлы резервных копий и записи своего журнала. При включении доставки журналов на экземпляре сервера-источника создается задание категории «Резервное копирование доставки журналов».  
  
 задание копирования  
 Задание агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которое копирует файлы резервных копий журналов с сервера-источника на указанный сервер-получатель, ведет журнал на сервере-получателе и сервере мониторинга. При включении доставки журналов в базе данных на каждом сервере-получателе в конфигурации доставки журналов создается задание категории «Копирование доставки журналов».  
  
 задание восстановления  
 Задание агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которое восстанавливает резервные копии журналов в базах данных-получателях. Оно ведет журнал на локальном сервере и на сервере мониторинга и удаляет старые файлы и записи своего журнала. При включении доставки журналов для базы данных на экземпляре сервера-получателя создается задание категории «Восстановление доставки журналов».  
  
 задание предупреждения  
 Задание агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которое создает предупреждения для баз данных-источников и получателей, если операции резервного копирования или восстановления не были завершены успешно в течение указанного срока. Если в базе данных включена доставка журналов, на экземпляре сервера мониторинга создается задание категории «Предупреждение доставки журналов».  
  
> [!TIP]  
>  Для каждого предупреждения необходимо задать номер. Также необходимо настроить предупреждение для оповещения оператора при появлении этого предупреждения.  
  
##  <a name="log-shipping-overview"></a><a name="ComponentsAndConcepts"></a> Общие сведения о доставке журналов  
 Доставка журналов состоит из этих трех операций:  
  
1.  резервное копирование журнала транзакций на экземпляре сервера-источника;  
  
2.  копирование резервных копий журнала транзакций на экземпляр сервера-получателя;  
  
3.  восстановление из резервных копий журнала транзакций на экземпляре сервера-получателя.  
  
 Журнал может доставляться нескольким экземплярам серверов-получателей. В этих случаях операции 2 и 3 повторяются для каждого экземпляра сервера-получателя.  
  
 Конфигурация доставки журналов не позволяет автоматически переходить с сервера-источника на сервер-получатель. Если база данных-источник становится недоступна, любой из серверов-получателей может быть вручную переведен в режим «в сети».  
  
 Сервер-получатель можно использовать для построения отчетов.  
  
 Кроме того, можно настроить предупреждения в конфигурации доставки журналов.  
  
### <a name="a-typical-log-shipping-configuration"></a>Типичная конфигурация доставки журналов  
 Следующий рисунок показывает конфигурацию доставки журналов с экземпляром сервера-источника, тремя экземплярами сервера-получателя и экземпляром сервера мониторинга. Рисунок отображает шаги, выполняемые задачами резервного копирования, копирования и восстановления, следующим образом:  
  
1.  экземпляр сервера-источника запускает задачу резервного копирования, чтобы создать резервную копию журнала транзакций в базе данных-источнике. Затем этот экземпляр сервера размещает резервную копию журнала в первичный файл резервной копии журнала, который сохраняется в папке резервного копирования.  На данном рисунке папка резервного копирования находится в общедоступном каталоге — *общем каталоге резервных копий*.  
  
2.  каждый из трех экземпляров сервера-получателя выполняет задачу копирования файла-источника резервной копии журнала в его локальную целевую папку;  
  
3.  каждый экземпляр сервера-получателя запускает собственную задачу восстановления резервной копии журналов из локальной целевой папки в локальную базу данных-получатель.  
  
 Экземпляры сервера-источника и сервера-получателя посылают собственный журнал и состояние экземпляру сервера мониторинга.  
  
 ![Конфигурация с отображением заданий резервного копирования, копирования и восстановления](../media/ls-typical-configuration.gif "Конфигурация с отображением заданий резервного копирования, копирования и восстановления")  
  
##  <a name="interoperability"></a><a name="Interoperability"></a> Совместимость  
 Доставка журналов может использоваться вместе со следующими функциями и компонентами [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
-   [Необходимые условия для перехода с доставки журналов на группы доступности AlwaysOn &#40;SQL Server&#41;](../availability-groups/windows/prereqs-migrating-log-shipping-to-always-on-availability-groups.md)  
  
-   [Зеркальное отображение баз данных и доставка журналов (SQL Server)](../database-mirroring/database-mirroring-and-log-shipping-sql-server.md)  
  
-   [Репликация и доставка журналов (SQL Server)](log-shipping-and-replication-sql-server.md)  
  
> [!NOTE]  
>  [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] и зеркальное отображение баз данных являются взаимоисключающими. База данных, в которой настроена одна из этих функций, не может использоваться в другой функции.  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> Связанные задачи  
  
-   [Обновление доставки журналов до SQL Server 2014 &#40;Transact-SQL&#41;](upgrading-log-shipping-to-sql-server-2016-transact-sql.md)  
  
-   [Настройка доставки журналов (SQL Server)](configure-log-shipping-sql-server.md)  
  
-   [Добавление базы данных-получателя в конфигурацию доставки журналов (SQL Server)](add-a-secondary-database-to-a-log-shipping-configuration-sql-server.md)  
  
-   [Удаление базы данных-получателя из конфигурации доставки журналов (SQL Server)](remove-a-secondary-database-from-a-log-shipping-configuration-sql-server.md)  
  
-   [Удаление доставки журналов (SQL Server)](remove-log-shipping-sql-server.md)  
  
-   [Просмотр отчета о доставке журналов (среда SQL Server Management Studio)](view-the-log-shipping-report-sql-server-management-studio.md)  
  
-   [Наблюдение за доставкой журналов (Transact-SQL)](monitor-log-shipping-transact-sql.md)  
  
-   [Переход на вторичный сервер доставки журналов (SQL Server)](fail-over-to-a-log-shipping-secondary-sql-server.md)  
  
-   [Переход на вторичный сервер доставки журналов (SQL Server)](fail-over-to-a-log-shipping-secondary-sql-server.md)  
  
-   [Управление именами входа и заданиями после переключения ролей (SQL Server)](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md)  
  
## <a name="see-also"></a>См. также:  
 [Общие сведения о группы доступности AlwaysOn &#40;SQL Server&#41;](../availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md)  
  
  
