---
title: Включить зашифрованные подключения к ядро СУБД (диспетчер конфигурации SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- connections [SQL Server], encrypted
- SSL [SQL Server]
- Secure Sockets Layer (SSL)
- encryption [SQL Server], connections
- cryptography [SQL Server], connections
- certificates [SQL Server], installing
- requesting encrypted connections
- installing certificates
- security [SQL Server], encryption
ms.assetid: e1e55519-97ec-4404-81ef-881da3b42006
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: e1653df929e3f8bc67158a0685ce07b8ba65de6e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750140"
---
# <a name="enable-encrypted-connections-to-the-database-engine-sql-server-configuration-manager"></a>Включение шифрования соединений в ядре СУБД (диспетчер конфигурации SQL Server)
  В этом разделе описано, как активировать зашифрованные соединения для экземпляра компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] , указав сертификат для компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] с помощью диспетчера конфигурации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Компьютеру сервера должен быть назначен сертификат, а компьютер клиента должен доверять корневому центру сертификации. Провизионирование — это процесс установки сертификата путем импорта сертификата в систему Windows.  
  
 Сертификат должен быть включен для **проверки подлинности сервера**. Имя сертификата должно быть полным доменным именем (FQDN) компьютера.  
  
 Сертификаты хранятся локально на пользовательских компьютерах. Чтобы установить сертификат для использования в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], необходимо запустить диспетчер конфигурации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] под той же учетной записью пользователя, что и службу [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , если только служба не запущена как LocalSystem, NetworkService или LocalService — в этих случаях необходима учетная запись администратора.  
  
 Клиент должен уметь проверить принадлежность сертификата, используемого сервером. Если у клиента есть сертификат открытого ключа центра сертификации, который подписал сертификат сервера, то дальнейшее конфигурирование не требуется. [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows включает сертификаты открытого ключа нескольких центров сертификации. Если сертификат сервера был подписан общедоступным или частным центром сертификации, для которого у клиента нет сертификата открытого ключа, необходимо установить сертификат открытого ключа того центра сертификации, который подписал сертификат сервера.  
  
> [!NOTE]  
>  Чтобы использовать шифрование в отказоустойчивом кластере, необходимо установить сертификат сервера с полным именем DNS виртуального сервера на все узлы отказоустойчивого кластера. Например, если имеется кластер из двух узлов с узлами с именем Test1. *\<your company>* . com и test2. *\<your company>* . com и у вас есть виртуальный сервер с именем Virtsql, необходимо установить сертификат для *\<your company>* Virtsql. com на обоих узлах. Параметру **ForceEncryption**можно присвоить значение **Да**.  
  
 **В этом разделе**  
  
-   **Включение зашифрованных соединений**  
  
     [Установка сертификата на сервер](#Provision)  
  
     [Экспорт сертификата сервера](#Export)  
  
     [Настройка сервера на прием зашифрованных соединений](#ConfigureServerConnections)  
  
     [Настройка клиента для запроса зашифрованных соединений](#ConfigureClientConnections)  
  
     [Шифрование соединения из среды SQL Server Management Studio](#EncryptConnection)  
  
##  <a name="SSMSProcedure"></a>  
  
###  <a name="to-provision-install-a-certificate-on-the-server"></a><a name="Provision"></a> Назначение (установка) сертификата на сервер  
  
1.  В меню **Пуск** выберите пункт **выполнить**, а затем в поле **Открыть** введите `MMC` и нажмите кнопку **ОК**.  
  
2.  В консоли MMC в меню **Файл** выберите **Добавить или удалить оснастку**.  
  
3.  В диалоговом окне **Добавление или удаление оснастки** нажмите кнопку **Добавить**.  
  
4.  В диалоговом окне **Добавление изолированной оснастки** выберите **Сертификаты**и нажмите кнопку **Добавить**.  
  
5.  В диалоговом окне **Оснастка диспетчера сертификатов** выберите **Учетная запись компьютера**и нажмите кнопку **Готово**.  
  
6.  В диалоговом окне **Добавить изолированную оснастку** нажмите кнопку **Закрыть**.  
  
7.  В диалоговом окне **Добавление или удаление оснастки** нажмите кнопку **ОК**.  
  
8.  В оснастке **Сертификаты** последовательно разверните узлы **Сертификаты**и **Личное**, а затем правой кнопкой мыши щелкните **Сертификаты**, выберите **Все задачи**и нажмите кнопку **Импорт**.  
  
9. Чтобы добавить сертификат на компьютер, выполните **Мастер импорта сертификатов**и закройте консоль MMC. Дополнительные сведения о добавлении сертификатов на компьютер см. в документации по Windows.  
  
###  <a name="to-export-the-server-certificate"></a><a name="Export"></a> Экспорт сертификата сервера  
  
1.  В оснастке **Сертификаты** найдите сертификат в папке **Сертификаты** / **Личное** , правой кнопкой мыши щелкните **Сертификат**, выберите **Все задачи**и нажмите **Экспорт**.  
  
2.  Чтобы сохранить файл сертификата в удобном расположении, выполните **мастер экспорта сертификатов**.  
  
###  <a name="to-configure-the-server-to-accept-encrypted-connections"></a><a name="ConfigureServerConnections"></a> Настройка сервера на прием зашифрованных соединений  
  
1.  В окне **Диспетчер конфигурации SQL Server** разверните узел **Сетевая конфигурация SQL Server**, щелкните правой кнопкой мыши элемент **Протоколы для** _\<server instance>_ , затем выберите пункт **Свойства**.  
  
2.  В диалоговом окне **протоколы для** _\<instance name>_ **свойств** на вкладке **сертификат** выберите нужный сертификат из раскрывающегося списка **сертификат** и нажмите кнопку **ОК**.  
  
3.  На вкладке **Флаги** в поле **ForceEncryption** выберите **Да**, затем нажмите кнопку **ОК** , чтобы закрыть диалоговое окно.  
  
4.  Перезапустите службу [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
###  <a name="to-configure-the-client-to-request-encrypted-connections"></a><a name="ConfigureClientConnections"></a> Настройка клиента на прием зашифрованных соединений  
  
1.  Скопируйте на компьютер клиента исходный сертификат или экспортированный файл сертификата.  
  
2.  Чтобы установить корневой сертификат или экспортированный файл сертификата на клиентском компьютере, используйте оснастку **Сертификаты** .  
  
3.  На панели консоли щелкните правой кнопкой мыши элемент **Конфигурация собственного клиента SQL Server**, затем нажмите **Свойства**.  
  
4.  На странице **Флаги** в диалоговом окне **Принудительное шифрование протокола** выберите **Да**.  
  
###  <a name="to-encrypt-a-connection-from-sql-server-management-studio"></a><a name="EncryptConnection"></a>Шифрование соединения из SQL Server Management Studio  
  
1.  На панели инструментов обозревателя объектов нажмите кнопку **Соединить**и выберите **Компонент Database Engine**.  
  
2.  В диалоговом окне **Соединение с сервером** введите все данные, необходимые для подключения, а затем нажмите **Параметры**.  
  
3.  На вкладке **Свойства соединения** щелкните **Шифровать соединение**.  
  
  
