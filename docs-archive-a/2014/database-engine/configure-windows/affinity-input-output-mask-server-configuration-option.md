---
title: Параметр конфигурации сервера "affinity Input-Output mask" | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- affinity I/O mask option
- processor affinity [SQL Server]
- binding processors [SQL Server]
- CPU affinity mask option
ms.assetid: 9950a8c9-9fe0-4003-95df-6f0d1becb0e7
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 3d0606e2a3f5480b27e27a4a585562f4b289b640
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87654496"
---
# <a name="affinity-input-output-mask-server-configuration-option"></a><span data-ttu-id="050ea-102">Параметр конфигурации сервера "affinity Input-Output mask"</span><span class="sxs-lookup"><span data-stu-id="050ea-102">affinity Input-Output mask Server Configuration Option</span></span>
  <span data-ttu-id="050ea-103">Для одновременного выполнения множества задач операционные системы [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 2000 и Windows Server 2003 иногда распределяют потоки обработки задач по различным процессорам.</span><span class="sxs-lookup"><span data-stu-id="050ea-103">To carry out multitasking, [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 2000 and Windows Server 2003 sometimes move process threads among different processors.</span></span> <span data-ttu-id="050ea-104">Хотя с точки зрения операционной системы эти действия эффективны, они могут снизить производительность [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] при больших системных нагрузках, так как данные кэша каждого процессора будут постоянно обновляться.</span><span class="sxs-lookup"><span data-stu-id="050ea-104">Although efficient from an operating system point of view, this activity can reduce [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] performance under heavy system loads, as each processor cache is repeatedly reloaded with data.</span></span> <span data-ttu-id="050ea-105">В этих условиях назначение определенного потока задач процессору может улучшить производительность, поскольку количество перезагрузок процессора будет снижено; такая связь между определенным потоком задач и процессором называется соответствием процессоров.</span><span class="sxs-lookup"><span data-stu-id="050ea-105">Assigning processors to specific threads can improve performance under these conditions by eliminating processor reloads; such an association between a thread and a processor is called processor affinity.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="050ea-106">поддерживает схожесть процессоров с помощью двух параметров: **affinity mask** (также известен как **CPU affinity mask**) и **affinity I/O mask**.</span><span class="sxs-lookup"><span data-stu-id="050ea-106">supports processor affinity by means of two affinity mask options: **affinity mask** (also known as **CPU affinity mask**) and **affinity I/O mask**.</span></span> <span data-ttu-id="050ea-107">Дополнительные сведения о параметре **affinity mask** см. в разделе [Параметр конфигурации сервера "affinity mask"](affinity-mask-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="050ea-107">For more information on the **affinity mask** option, see [affinity mask Server Configuration Option](affinity-mask-server-configuration-option.md).</span></span> <span data-ttu-id="050ea-108">Поддержка соответствия процессоров и ввода-вывода для серверов с числом ЦП от 33 до 64 требует также использования параметров [Параметр конфигурации сервера "affinity64 mask"](affinity64-mask-server-configuration-option.md) и [Параметр конфигурации сервера "affinity64 I/O mask"](affinity64-input-output-mask-server-configuration-option.md) соответственно.</span><span class="sxs-lookup"><span data-stu-id="050ea-108">CPU and I/O affinity support for servers with 33 to 64 processors requires the additional use of the [affinity64 mask Server Configuration Option](affinity64-mask-server-configuration-option.md) and [affinity64 Input-Output mask Server Configuration Option](affinity64-input-output-mask-server-configuration-option.md) respectively.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="050ea-109">Поддержка соответствия процессоров для серверов с числом процессоров от 33 до 64 доступна только в 64-разрядных версиях операционных систем.</span><span class="sxs-lookup"><span data-stu-id="050ea-109">Affinity support for servers with 33 to 64 processors is only available on 64-bit operating systems.</span></span>  
  
 <span data-ttu-id="050ea-110">Параметр **affinity I/O mask** привязывает операцию дискового ввода-вывода [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] к определенному подмножеству ЦП.</span><span class="sxs-lookup"><span data-stu-id="050ea-110">The **affinity I/O mask** option binds [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O to a specified subset of CPUs.</span></span> <span data-ttu-id="050ea-111">В средах [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] высокоскоростной обработки транзакций (OLTP) данное расширение может улучшать производительность потоков [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , выдающих вводы-выводы.</span><span class="sxs-lookup"><span data-stu-id="050ea-111">In high-end [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] online transactional processing (OLTP) environments, this extension can enhance the performance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] threads issuing I/Os.</span></span> <span data-ttu-id="050ea-112">Это улучшение не поддерживает привязку оборудования для отдельных дисков или контроллеров дисков.</span><span class="sxs-lookup"><span data-stu-id="050ea-112">This enhancement does not support hardware affinity for individual disks or disk controllers.</span></span>  
  
 <span data-ttu-id="050ea-113">Значение параметра **affinity I/O mask** указывает, какие ЦП в многопроцессорном компьютере подходят для обработки операций ввода-вывода на диске [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="050ea-113">The value for **affinity I/O mask** specifies which CPUs in a multiprocessor computer are eligible to process [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O operations.</span></span> <span data-ttu-id="050ea-114">Маска — это битовая карта, в которой самый правый бит обозначает ЦП самого низкого уровня (0), второй бит справа обозначает ЦП второго снизу уровня (1) и т. д.</span><span class="sxs-lookup"><span data-stu-id="050ea-114">The mask is a bitmap in which the rightmost bit specifies the lowest-order CPU(0), the bit to its immediate left specifies the next-lowest-order CPU(1), and so on.</span></span> <span data-ttu-id="050ea-115">Чтобы настроить более 32 процессоров, нужно задать и параметр **affinity I/O mask** , и параметр **affinity64 I/O mask**.</span><span class="sxs-lookup"><span data-stu-id="050ea-115">To configure more than 32 processors, set both the **affinity I/O mask** and the **affinity64 I/O mask**.</span></span>  
  
 <span data-ttu-id="050ea-116">Ниже приведены возможные значения параметра **affinity I/O mask** .</span><span class="sxs-lookup"><span data-stu-id="050ea-116">The values for **affinity I/O mask** are as follows:</span></span>  
  
-   <span data-ttu-id="050ea-117">Однобайтовое значение **affinity I/O mask** обеспечивает управление компьютерами, содержащими до 8 ЦП.</span><span class="sxs-lookup"><span data-stu-id="050ea-117">A 1-byte **affinity I/O mask** covers up to 8 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="050ea-118">Двухбайтовое значение **affinity I/O mask** обеспечивает управление компьютерами, содержащими до 16 ЦП.</span><span class="sxs-lookup"><span data-stu-id="050ea-118">A 2-byte **affinity I/O mask** covers up to 16 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="050ea-119">Трехбайтовое значение **affinity I/O mask** обеспечивает управление компьютерами, содержащими до 24 ЦП.</span><span class="sxs-lookup"><span data-stu-id="050ea-119">A 3-byte **affinity I/O mask** covers up to 24 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="050ea-120">Четырехбайтовое значение **affinity I/O mask** обеспечивает управление компьютерами, содержащими до 32 ЦП.</span><span class="sxs-lookup"><span data-stu-id="050ea-120">A 4-byte **affinity I/O mask** covers up to 32 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="050ea-121">Для работы более чем с 32 ЦП настройте четырехбайтовое значение **affinity I/O mask** для первых 32 ЦП и включающее до 4 байт значение **affinity64 I/O mask** для оставшихся ЦП.</span><span class="sxs-lookup"><span data-stu-id="050ea-121">To cover more than 32 CPUs, configure a four-byte **affinity I/O mask** for the first 32 CPUs and up to a four-byte **affinity64 I/O mask** for the remaining CPUs.</span></span>  
  
 <span data-ttu-id="050ea-122">1 бит в шаблоне привязки ввода-вывода показывает, что соответствующий ЦП может выполнять операции ввода-вывода с диском [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ; 0 бит указывает, что для соответствующего ЦП не следует планировать никаких операций ввода-вывода с диском [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="050ea-122">A 1 bit in the affinity I/O pattern specifies that the corresponding CPU is eligible to perform [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O operations; a 0 bit specifies that no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O operations should be scheduled for the corresponding CPU.</span></span> <span data-ttu-id="050ea-123">Когда все биты установлены на ноль или параметр **affinity I/O mask** не указан, ввод-вывод диска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] планируется для любого ЦП, способного обрабатывать потоки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="050ea-123">When all bits are set to zero, or **affinity I/O mask** is not specified, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O is scheduled to any of the CPUs eligible to process [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] threads.</span></span>  
  
 <span data-ttu-id="050ea-124">Поскольку настройка параметра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **affinity I/O mask** является специализированной операцией, она должна использоваться только при необходимости.</span><span class="sxs-lookup"><span data-stu-id="050ea-124">Because setting the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **affinity I/O mask** option is a specialized operation, it should be used only when necessary.</span></span> <span data-ttu-id="050ea-125">В большинстве случаев привязка по умолчанию в системах Windows 2000 или Windows Server 2003 обеспечивает самую высокую производительность.</span><span class="sxs-lookup"><span data-stu-id="050ea-125">In most cases, the Windows 2000 or Windows Server 2003 default affinity provides the best performance.</span></span>  
  
 <span data-ttu-id="050ea-126">При задании параметра **affinity I/O mask** его следует использовать вместе с параметром конфигурации **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="050ea-126">When specifying the **affinity I/O mask** option, you must use it with the **affinity mask** configuration option.</span></span> <span data-ttu-id="050ea-127">Не следует включать один и тот же процессор и в переключателе **affinity I/O mask** , и в параметре **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="050ea-127">Do not enable the same CPU in both the **affinity I/O mask** switch and the **affinity mask** option.</span></span> <span data-ttu-id="050ea-128">Биты, относящиеся к каждому процессору, могут находиться в одном из трех состояний:</span><span class="sxs-lookup"><span data-stu-id="050ea-128">The bits corresponding to each CPU should be in one of the following three states:</span></span>  
  
-   <span data-ttu-id="050ea-129">0 в параметре **affinity I/O mask** и в параметре **affinity mask** ;</span><span class="sxs-lookup"><span data-stu-id="050ea-129">0 in both the **affinity I/O mask** option and the **affinity mask** option.</span></span>  
  
-   <span data-ttu-id="050ea-130">1 в параметре **affinity I/O mask** и 0 в параметре **affinity mask** ;</span><span class="sxs-lookup"><span data-stu-id="050ea-130">1 in the **affinity I/O mask** option and 0 in the **affinity mask** option.</span></span>  
  
-   <span data-ttu-id="050ea-131">0 в параметре **affinity I/O mask** и 1 в параметре **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="050ea-131">0 in the **affinity I/O mask** option and 1 in the **affinity mask** option.</span></span>  
  
 <span data-ttu-id="050ea-132">Параметр **affinity I/O mask** является дополнительным параметром.</span><span class="sxs-lookup"><span data-stu-id="050ea-132">The **affinity I/O mask** option is an advanced option.</span></span> <span data-ttu-id="050ea-133">Если `sp_configure` для изменения параметра используется системная хранимая процедура, **маску сопоставления ввода-вывода** можно изменить только в том случае, если параметру **Показывать дополнительные параметры** присвоено значение 1.</span><span class="sxs-lookup"><span data-stu-id="050ea-133">If you are using the `sp_configure` system stored procedure to change the setting, you can change **affinity I/O mask** only when **show advanced options** is set to 1.</span></span> <span data-ttu-id="050ea-134">В [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]для изменения параметра **affinity I/O mask** требуется перезапуск экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="050ea-134">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], reconfiguring the **affinity I/O mask** option requires a restart of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="050ea-135">Не используйте маску привязки процессоров в операционной системе Windows и маску привязки в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]одновременно.</span><span class="sxs-lookup"><span data-stu-id="050ea-135">Do not configure CPU affinity in the Windows operating system and also configure the affinity mask in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="050ea-136">Эти настройки предназначены для достижения одного результата, и если их значения будут несогласованными, результат может быть непредсказуем.</span><span class="sxs-lookup"><span data-stu-id="050ea-136">These settings are attempting to achieve the same result, and if the configurations are inconsistent, you may have unpredictable results.</span></span> <span data-ttu-id="050ea-137">Привязка ЦП [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] лучше всего настраивается с использованием параметра `sp_configure` в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="050ea-137">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] CPU affinity is best configured using the `sp_configure` option in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="050ea-138">См. также:</span><span class="sxs-lookup"><span data-stu-id="050ea-138">See Also</span></span>  
 <span data-ttu-id="050ea-139">[Наблюдение за использованием ресурсов (системный монитор)](../../relational-databases/performance-monitor/monitor-resource-usage-system-monitor.md) </span><span class="sxs-lookup"><span data-stu-id="050ea-139">[Monitor Resource Usage &#40;System Monitor&#41;](../../relational-databases/performance-monitor/monitor-resource-usage-system-monitor.md) </span></span>  
 <span data-ttu-id="050ea-140">[RECONFIGURE (Transact-SQL)](/sql/t-sql/language-elements/reconfigure-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="050ea-140">[RECONFIGURE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/reconfigure-transact-sql) </span></span>  
 <span data-ttu-id="050ea-141">[Параметры конфигурации сервера (SQL Server)](server-configuration-options-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="050ea-141">[Server Configuration Options &#40;SQL Server&#41;](server-configuration-options-sql-server.md) </span></span>  
 [<span data-ttu-id="050ea-142">sp_configure (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="050ea-142">sp_configure &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql)  
  
  
