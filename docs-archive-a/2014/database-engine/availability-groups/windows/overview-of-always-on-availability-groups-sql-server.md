---
title: Общие сведения о группы доступности AlwaysOn (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 10/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- secondary databases [SQL Server], in availability group
- primary databases [SQL Server], in availability group
- Availability Groups [SQL Server], about
- Availability Groups [SQL Server], data movement
- Availability Groups [SQL Server]
ms.assetid: 04fd9d95-4624-420f-a3be-1794309b3a47
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: bc49a841daaeb0f7bda6f793890433f26c6b5c1f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656560"
---
# <a name="overview-of-alwayson-availability-groups-sql-server"></a><span data-ttu-id="5218f-102">Обзор групп доступности AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="5218f-102">Overview of AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="5218f-103">В этом разделе рассматриваются основные понятия [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , которые имеют большое значение для настройки групп доступности и управления группами доступности в среде [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5218f-103">This topic introduces the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] concepts that are central for configuring and managing one or more availability groups in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="5218f-104">Сводное описание преимуществ групп доступности и общие сведения по терминологии [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] см. в разделе [Группы доступности AlwaysOn (SQL Server)](always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-104">For a summary of the benefits offered by availability groups and an overview of [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] terminology, see [AlwaysOn Availability Groups &#40;SQL Server&#41;](always-on-availability-groups-sql-server.md).</span></span>

 <span data-ttu-id="5218f-105">*Группа доступности* поддерживает среду отработки отказа для дискретного набора пользовательских баз данных, известных как *базы данных доступности*, которые совместно отключаются при отработке отказа.</span><span class="sxs-lookup"><span data-stu-id="5218f-105">An *availability group* supports a failover environment for a discrete set of user databases, known as *availability databases*, that fail over together.</span></span> <span data-ttu-id="5218f-106">Группа доступности поддерживает набор первичных баз данных и восьми наборов соответствующих вторичных баз данных.</span><span class="sxs-lookup"><span data-stu-id="5218f-106">An availability group supports a set of primary databases and one to eight sets of corresponding secondary databases.</span></span> <span data-ttu-id="5218f-107">Базы данных-получатели *не являются* резервными копиями.</span><span class="sxs-lookup"><span data-stu-id="5218f-107">Secondary databases are *not* backups.</span></span> <span data-ttu-id="5218f-108">Продолжайте регулярно создавать резервные копии баз данных и их журналов транзакций.</span><span class="sxs-lookup"><span data-stu-id="5218f-108">Continue to back up your databases and their transaction logs on a regular basis.</span></span>

> [!TIP]
>  <span data-ttu-id="5218f-109">Можно создать резервную копию базы данных-источника любого типа.</span><span class="sxs-lookup"><span data-stu-id="5218f-109">You can create any type of backup of a primary database.</span></span> <span data-ttu-id="5218f-110">Кроме того, также можно создавать резервные копии журналов и полные резервные копии баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="5218f-110">Alternatively, you can create log backups and copy-only full backups of secondary databases.</span></span> <span data-ttu-id="5218f-111">Дополнительные сведения см. в разделе [Активные вторичные реплики: резервное копирование на вторичных репликах (группы доступности AlwaysOn)](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-111">For more information, see [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span></span>

 <span data-ttu-id="5218f-112">Каждый набор баз данных доступности размещается с помощью *реплики доступности*.</span><span class="sxs-lookup"><span data-stu-id="5218f-112">Each set of availability database is hosted by an *availability replica*.</span></span> <span data-ttu-id="5218f-113">Существует два типа реплик доступности: одна *первичная реплика*,</span><span class="sxs-lookup"><span data-stu-id="5218f-113">Two types of availability replicas exist: a single *primary replica*.</span></span> <span data-ttu-id="5218f-114">которая размещает основные базы данных, и до восьми *вторичных реплик*, каждая из которых размещает набор вторичных баз данных и серверов как потенциальных объектов отказа для группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-114">which hosts the primary databases, and one to eight *secondary replicas*, each of which hosts a set of secondary databases and serves as a potential failover targets for the availability group.</span></span> <span data-ttu-id="5218f-115">Группа доступности выполняет переход на другой ресурс на уровне реплики доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-115">An availability group fails over at the level of an availability replica.</span></span> <span data-ttu-id="5218f-116">Реплика доступности обеспечивает избыточность только на уровне базы данных: для набора баз данных из одной группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-116">An availability replica provides redundancy only at the database level-for the set of databases in one availability group.</span></span> <span data-ttu-id="5218f-117">Отработка отказа не вызывается проблемами баз данных, например обозначением базы данных как подозрительной в связи с потерей файла данных или повреждением журнала транзакций.</span><span class="sxs-lookup"><span data-stu-id="5218f-117">Failovers are not caused by database issues such as a database becoming suspect due to a loss of a data file or corruption of a transaction log.</span></span>

 <span data-ttu-id="5218f-118">Первичная реплика делает базы данных-источники доступными для соединений с клиентами для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="5218f-118">The primary replica makes the primary databases available for read-write connections from clients.</span></span> <span data-ttu-id="5218f-119">Кроме того, в процессе, называемом *синхронизацией данных*, который происходит на уровне базы данных,</span><span class="sxs-lookup"><span data-stu-id="5218f-119">Also, in a process known as *data synchronization*, which occurs at the database level.</span></span> <span data-ttu-id="5218f-120">первичная реплика отправляет записи журнала транзакций каждой базы данных-источника в каждую базу данных-получатель.</span><span class="sxs-lookup"><span data-stu-id="5218f-120">The primary replica sends transaction log records of each primary database to every secondary database.</span></span> <span data-ttu-id="5218f-121">В каждой вторичной реплике кэшируются записи журнала транзакций (*фиксируется* журнал), а затем эти записи применяются в соответствующей базе данных-получателе.</span><span class="sxs-lookup"><span data-stu-id="5218f-121">Every secondary replica caches the transaction log records (*hardens* the log) and then applies them to its corresponding secondary database.</span></span> <span data-ttu-id="5218f-122">Синхронизация данных выполняется между базой данных-источником и каждой подключенной базой данных-получателем независимо от остальных баз данных.</span><span class="sxs-lookup"><span data-stu-id="5218f-122">Data synchronization occurs between the primary database and each connected secondary database, independently of the other databases.</span></span> <span data-ttu-id="5218f-123">Поэтому приостановка или сбой базы данных-получателя не затрагивает другие базы данных-получатели, а приостановка или сбой базы данных-источника не затрагивает остальные базы данных-источники.</span><span class="sxs-lookup"><span data-stu-id="5218f-123">Therefore, a secondary database can be suspended or fail without affecting other secondary databases, and a primary database can be suspended or fail without affecting other primary databases.</span></span>

 <span data-ttu-id="5218f-124">Также можно настроить одну или несколько вторичных реплик для поддержки доступа только для чтения к базам данных-получателям и настроить какую-либо вторичную реплику для резервного копирования в базы данных-получатели.</span><span class="sxs-lookup"><span data-stu-id="5218f-124">Optionally, you can configure one or more secondary replicas to support read-only access to secondary databases, and you can configure any secondary replica to permit backups on secondary databases.</span></span>

 <span data-ttu-id="5218f-125">Для развертывания [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] требуется WSFC-кластер.</span><span class="sxs-lookup"><span data-stu-id="5218f-125">Deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requires a Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="5218f-126">Все реплики доступности в заданной группе доступности должны располагаться на разных узлах одного кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="5218f-126">Each availability replica of a given availability group must reside on a different node of the same WSFC cluster.</span></span> <span data-ttu-id="5218f-127">Единственное исключение состоит в том, что при переносе в другой кластер WSFC группа доступности может временно находится в двух кластерах.</span><span class="sxs-lookup"><span data-stu-id="5218f-127">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>

 <span data-ttu-id="5218f-128">Группа ресурсов WSFC создается для каждой создаваемой группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-128">A WSFC resource group is created for every availability group that you create.</span></span> <span data-ttu-id="5218f-129">Кластер WSFC отслеживает данную группу ресурсов для оценки работоспособности первичной реплики.</span><span class="sxs-lookup"><span data-stu-id="5218f-129">The WSFC cluster monitors this resource group to evaluate the health of the primary replica.</span></span> <span data-ttu-id="5218f-130">Кворум для [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] рассчитывается на всех узлах в кластере WSFC вне зависимости от того, хранится ли на данном узле кластера какая-либо реплика доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-130">The quorum for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is based on all nodes in the WSFC cluster regardless of whether a given cluster node hosts any availability replicas.</span></span> <span data-ttu-id="5218f-131">В отличие от процесса зеркального отображения базы данных, в [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] нет роли следящего объекта.</span><span class="sxs-lookup"><span data-stu-id="5218f-131">In contrast to database mirroring, there is no witness role in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>

> [!NOTE]
>  <span data-ttu-id="5218f-132">Сведения о связи компонентов AlwaysOn SQL Server с кластером WSFC см. в разделе [Отказоустойчивая кластеризация Windows Server (WSFC) с использованием SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-132">For information about the relationship of SQL Server AlwaysOn components to the WSFC cluster, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>

 <span data-ttu-id="5218f-133">Ниже показана группа доступности, которая содержит одну первичную реплику и четыре вторичные реплики.</span><span class="sxs-lookup"><span data-stu-id="5218f-133">The following illustration shows an availability group that contains one primary replica and four secondary replicas.</span></span> <span data-ttu-id="5218f-134">Поддерживаются до 8 вторичных реплик, в том числе одна первичная реплика и две вторичные реплики с синхронной фиксацией.</span><span class="sxs-lookup"><span data-stu-id="5218f-134">Up to eight secondary replicas are supported, including one primary replica and two synchronous-commit secondary replicas.</span></span>

 <span data-ttu-id="5218f-135">![Группа доступности с пятью репликами](../../media/aoag-agintrofigure.gif "Группа доступности с пятью репликами")</span><span class="sxs-lookup"><span data-stu-id="5218f-135">![Availability group with five replicas](../../media/aoag-agintrofigure.gif "Availability group with five replicas")</span></span>


##  <a name="availability-databases"></a><a name="AvDbs"></a><span data-ttu-id="5218f-136">Базы данных доступности</span><span class="sxs-lookup"><span data-stu-id="5218f-136">Availability Databases</span></span>
 <span data-ttu-id="5218f-137">Чтобы можно было добавить базу данных в группу доступности, база данных должна быть в сети, быть доступной для чтения и записи и существовать на экземпляре сервера, на котором располагается первичная реплика.</span><span class="sxs-lookup"><span data-stu-id="5218f-137">To add a database to an availability group, the database must be an online, read-write database that exists on the server instance that hosts the primary replica.</span></span> <span data-ttu-id="5218f-138">При добавлении база данных присоединяется к группе доступности как база данных-источник, оставаясь доступной для клиентов.</span><span class="sxs-lookup"><span data-stu-id="5218f-138">When you add a database, it joins the availability group as a primary database, while remaining available to clients.</span></span> <span data-ttu-id="5218f-139">База данных-получатель не существует до тех пор, пока резервные копии новой базы данных-источника не будут восстановлены на экземпляр сервера, на котором размещается вторичная реплика (с помощью инструкции RESTORE WITH NORECOVERY).</span><span class="sxs-lookup"><span data-stu-id="5218f-139">No corresponding secondary database exists until backups of the new primary database are restored to the server instance that hosts the secondary replica (using RESTORE WITH NORECOVERY).</span></span> <span data-ttu-id="5218f-140">Новая база данных-получатель находится в состоянии RESTORING до тех пор, пока не войдет в состав группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-140">The new secondary database is in the RESTORING state until it is joined to the availability group.</span></span> <span data-ttu-id="5218f-141">Дополнительные сведения см. в разделе [Запуск перемещения данных в базе данных-получателе AlwaysOn (SQL Server)](start-data-movement-on-an-always-on-secondary-database-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-141">For more information, see [Start Data Movement on an AlwaysOn Secondary Database &#40;SQL Server&#41;](start-data-movement-on-an-always-on-secondary-database-sql-server.md).</span></span>

 <span data-ttu-id="5218f-142">Присоединение переводит базу данных-получатель в режим ONLINE и инициирует синхронизацию данных с соответствующей базой данных-источником.</span><span class="sxs-lookup"><span data-stu-id="5218f-142">Joining places the secondary database into the ONLINE state and initiates data synchronization with the corresponding primary database.</span></span> <span data-ttu-id="5218f-143">*Синхронизация данных* — это процесс, в ходе которого изменения в базе данных-источнике воспроизводятся в базе данных-получателе.</span><span class="sxs-lookup"><span data-stu-id="5218f-143">*Data synchronization* is the process by which changes to a primary database are reproduced on a secondary database.</span></span> <span data-ttu-id="5218f-144">В процессе синхронизации данных база данных-источник отправляет записи журнала транзакций в базу данных-получатель.</span><span class="sxs-lookup"><span data-stu-id="5218f-144">Data synchronization involves the primary database sending transaction log records to the secondary database.</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="5218f-145">База данных доступности в *, Powershell и управляющих объектах SQL Server (SMO) иногда называется* репликой базы данных [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5218f-145">An availability database is sometimes called a *database replica* in [!INCLUDE[tsql](../../../includes/tsql-md.md)], PowerShell, and SQL Server Management Objects (SMO) names.</span></span> <span data-ttu-id="5218f-146">Например, выражение «реплика базы данных» используется в именах динамических административных представлений, возвращающих сведения о базах данных доступности:  **sys.dm_hadr_database_replica_states** и **sys.dm_hadr_database_replica_cluster_states**.</span><span class="sxs-lookup"><span data-stu-id="5218f-146">For example, the term "database replica" is used in the names of the AlwaysOn dynamic management views that return information about availability databases:  **sys.dm_hadr_database_replica_states** and **sys.dm_hadr_database_replica_cluster_states**.</span></span> <span data-ttu-id="5218f-147">Однако в электронной документации по SQL Server термин «реплика» обычно относится к репликам доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-147">However, in SQL Server Books Online, the term "replica" typically refers to availability replicas.</span></span> <span data-ttu-id="5218f-148">Например, фразы «первичная реплика» и «вторичная реплика» всегда относятся к репликам доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-148">For example, "primary replica" and "secondary replica" always refer to availability replicas.</span></span>

##  <a name="availability-replicas"></a><a name="AGsARsADBs"></a><span data-ttu-id="5218f-149">Реплики доступности</span><span class="sxs-lookup"><span data-stu-id="5218f-149">Availability Replicas</span></span>
 <span data-ttu-id="5218f-150">Каждая группа доступности определяет набор из двух или более партнеров по обеспечению отработки отказа, известных как реплики доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-150">Each availability group defines a set of two or more failover partners known as availability replicas.</span></span> <span data-ttu-id="5218f-151">*Реплики доступности* являются компонентами группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-151">*Availability replicas* are components of the availability group.</span></span> <span data-ttu-id="5218f-152">На каждой реплике доступности размещается копия баз данных доступности в группе доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-152">Each availability replica hosts a copy of the availability databases in the availability group.</span></span> <span data-ttu-id="5218f-153">Для данной группы доступности реплики доступности должны находиться на разных экземплярах [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , работающих на разных узлах кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="5218f-153">For a given availability group, the availability replicas must be hosted by separate instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] residing on different nodes of a WSFC cluster.</span></span> <span data-ttu-id="5218f-154">На каждом из этих экземпляров сервера необходимо включить AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="5218f-154">Each of these server instances must be enabled for AlwaysOn.</span></span>

 <span data-ttu-id="5218f-155">Данный экземпляр может размещать только одну реплику доступности для отдельной группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-155">A given instance can host only one availability replica per availability group.</span></span> <span data-ttu-id="5218f-156">Однако каждый экземпляр можно использовать на нескольких групп доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-156">However, each instance can be used for many availability groups.</span></span> <span data-ttu-id="5218f-157">Данный экземпляр сервера может быть изолированным экземпляром или экземпляром кластера отработки отказа [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="5218f-157">A given instance can be either a stand-alone instance or a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI).</span></span> <span data-ttu-id="5218f-158">Если требуется обеспечить избыточность на уровне сервера, используйте экземпляры кластера отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="5218f-158">If you require server-level redundancy, use Failover Cluster Instances.</span></span>

 <span data-ttu-id="5218f-159">Каждая реплика доступности получает роль — *первичную роль* или *вторичную роль*, которая наследуется базами данных доступности этой реплики.</span><span class="sxs-lookup"><span data-stu-id="5218f-159">Every availability replica is assigned an initial role-either the *primary role* or the *secondary role*, which is inherited by the availability databases of that replica.</span></span> <span data-ttu-id="5218f-160">Роль данной реплики определяет, размещает ли она базы данных, доступные для чтения и записи, или базы данных только для чтения.</span><span class="sxs-lookup"><span data-stu-id="5218f-160">The role of a given replica determines whether it hosts read-write databases or read-only databases.</span></span> <span data-ttu-id="5218f-161">Одна реплика, известная как *первичная реплика*, получает первичную роль и размещает базы данных, доступные для чтения и записи, которые известны как *базы данных-получатели*.</span><span class="sxs-lookup"><span data-stu-id="5218f-161">One replica, known as the *primary replica*, is assigned the primary role and hosts read-write databases, which are known as *primary databases*.</span></span> <span data-ttu-id="5218f-162">По крайней мере одна из остальных реплик, называемая *вторичной репликой*, получает вторичную роль.</span><span class="sxs-lookup"><span data-stu-id="5218f-162">At least one other replica, known as a *secondary replica*, is assigned the secondary role.</span></span> <span data-ttu-id="5218f-163">Вторичная реплика размещает базы данных только для чтения, называемые базами данных-получателями.</span><span class="sxs-lookup"><span data-stu-id="5218f-163">A secondary replica hosts read-only databases, known as secondary databases.</span></span>

> [!NOTE]
>  <span data-ttu-id="5218f-164">Если роль реплики доступности не определена, например, во время отработки отказа, ее базы данных временно пребывают в состоянии NOT SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="5218f-164">When the role of an availability replica is indeterminate, such as during a failover, its databases are temporarily in a NOT SYNCHRONIZING state.</span></span> <span data-ttu-id="5218f-165">Их роль устанавливается в значение RESOLVING до тех пор, пока роль реплики доступности не будет разрешена.</span><span class="sxs-lookup"><span data-stu-id="5218f-165">Their role is set to RESOLVING until the role of the availability replica has resolved.</span></span> <span data-ttu-id="5218f-166">Если реплика доступности разрешается в основную роль, ее базы данных становятся базами данных-источниками.</span><span class="sxs-lookup"><span data-stu-id="5218f-166">If an availability replica resolves to the primary role, its databases become the primary databases.</span></span> <span data-ttu-id="5218f-167">Если реплика доступности разрешается во вторичную роль, ее базы данных становятся базами данных-получателями.</span><span class="sxs-lookup"><span data-stu-id="5218f-167">If an availability replica resolves to the secondary role, its databases become secondary databases.</span></span>

##  <a name="availability-modes"></a><a name="AvailabilityModes"></a><span data-ttu-id="5218f-168">Режимы доступности</span><span class="sxs-lookup"><span data-stu-id="5218f-168">Availability Modes</span></span>
 <span data-ttu-id="5218f-169">Режим доступности — это свойство каждой реплики доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-169">The availability mode is a property of each availability replica.</span></span> <span data-ttu-id="5218f-170">Режим доступности определяет, ждет ли первичная реплика перед фиксацией транзакций для базы данных, чтобы данная вторичная реплика записала записи журнала транзакций на диск (записала журнал на диск).</span><span class="sxs-lookup"><span data-stu-id="5218f-170">The availability mode determines whether the primary replica waits to commit transactions on a database until a given secondary replica has written the transaction log records to disk (hardened the log).</span></span> [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="5218f-171">поддерживает два режима доступности — *режим асинхронной фиксации* и *режим синхронной фиксации*.</span><span class="sxs-lookup"><span data-stu-id="5218f-171">supports two availability modes-*asynchronous-commit mode* and *synchronous-commit mode*.</span></span>

-   <span data-ttu-id="5218f-172">**Asynchronous-commit mode**</span><span class="sxs-lookup"><span data-stu-id="5218f-172">**Asynchronous-commit mode**</span></span>

     <span data-ttu-id="5218f-173">Реплика доступности, которая использует этот режим доступности, называется*репликой асинхронной фиксации*.</span><span class="sxs-lookup"><span data-stu-id="5218f-173">An availability replica that uses this availability mode is known as an*asynchronous-commit replica*.</span></span> <span data-ttu-id="5218f-174">В режиме асинхронной фиксации первичная реплика фиксирует транзакции, не ожидая подтверждения, что вторичная реплика асинхронной фиксации записала журнал на диск.</span><span class="sxs-lookup"><span data-stu-id="5218f-174">Under asynchronous-commit mode, the primary replica commits transactions without waiting for acknowledgement that an asynchronous-commit secondary replica has hardened the log.</span></span> <span data-ttu-id="5218f-175">Режим асинхронной фиксации минимизирует задержку транзакций в базах данных-получателях, но позволяет им не успевать за базами данных-источниками, что создает риск возможной потери данных.</span><span class="sxs-lookup"><span data-stu-id="5218f-175">Asynchronous-commit mode minimizes transaction latency on the secondary databases but allows them to lag behind the primary databases, making some data loss possible.</span></span>

-   <span data-ttu-id="5218f-176">**Synchronous-commit mode**</span><span class="sxs-lookup"><span data-stu-id="5218f-176">**Synchronous-commit mode**</span></span>

     <span data-ttu-id="5218f-177">Реплика доступности, которая использует этот режим доступности, называется *репликой синхронной фиксации*.</span><span class="sxs-lookup"><span data-stu-id="5218f-177">An availability replica that uses this availability mode is known as a *synchronous-commit replica*.</span></span> <span data-ttu-id="5218f-178">В режиме синхронной фиксации, прежде чем фиксировать транзакции, первичная реплика синхронной фиксации ждет, чтобы вторичная реплика синхронной фиксации подтвердила, что запись журнала на диск завершена.</span><span class="sxs-lookup"><span data-stu-id="5218f-178">Under synchronous-commit mode, before committing transactions, a synchronous-commit primary replica waits for a synchronous-commit secondary replica to acknowledge that it has finished hardening the log.</span></span> <span data-ttu-id="5218f-179">В режиме синхронной фиксации после синхронизации базы данных-получателя с базой данных-источником зафиксированные транзакции полностью защищены.</span><span class="sxs-lookup"><span data-stu-id="5218f-179">Synchronous-commit mode ensures that once a given secondary database is synchronized with the primary database, committed transactions are fully protected.</span></span> <span data-ttu-id="5218f-180">Эта защита достигается за счет повышения задержки транзакций.</span><span class="sxs-lookup"><span data-stu-id="5218f-180">This protection comes at the cost of increased transaction latency.</span></span>

 <span data-ttu-id="5218f-181">Дополнительные сведения см. в разделе [Режимы доступности (группы доступности AlwaysOn)](availability-modes-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-181">For more information, see [Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md).</span></span>

##  <a name="types-of-failover"></a><a name="FormsOfFailover"></a><span data-ttu-id="5218f-182">Типы отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5218f-182">Types of Failover</span></span>
 <span data-ttu-id="5218f-183">В рамках контекста сеанса между первичной репликой и вторичной репликой, первичная и вторичная роли становятся потенциально взаимозаменяемыми в процессе, который называется *отработка отказа*.</span><span class="sxs-lookup"><span data-stu-id="5218f-183">Within the context of a session between the primary replica and a secondary replica, the primary and secondary roles are potentially interchangeable in a process known as *failover*.</span></span> <span data-ttu-id="5218f-184">Во время отработки отказа вторичная реплика принимает первичную роль и становится новой первичной репликой.</span><span class="sxs-lookup"><span data-stu-id="5218f-184">During a failover the target secondary replica transitions to the primary role, becoming the new primary replica.</span></span> <span data-ttu-id="5218f-185">Новая первичная реплика переводит свои базы данных в режим «в сети» в качестве баз данных-источников и выполняет откат всех незафиксированных транзакций.</span><span class="sxs-lookup"><span data-stu-id="5218f-185">The new primary replica brings its databases online as the primary databases, and client applications can connect to them.</span></span> <span data-ttu-id="5218f-186">Когда прежняя первичная реплика становится доступной, она принимает вторичную роль и становится вторичной репликой.</span><span class="sxs-lookup"><span data-stu-id="5218f-186">When the former primary replica is available, it transitions to the secondary role, becoming a secondary replica.</span></span> <span data-ttu-id="5218f-187">Прежние базы данных-источники становятся базами данных-получателями, и синхронизация данных возобновляется.</span><span class="sxs-lookup"><span data-stu-id="5218f-187">The former primary databases become secondary databases and data synchronization resumes.</span></span>

 <span data-ttu-id="5218f-188">Существует три вида перехода на другой ресурс: автоматическая отработка отказа, отработка отказа вручную и принудительное обслуживание (с возможной потерей данных).</span><span class="sxs-lookup"><span data-stu-id="5218f-188">Three forms of failover exist-automatic, manual, and forced (with possible data loss).</span></span> <span data-ttu-id="5218f-189">Форма или формы отработки отказа, поддерживаемые определенной вторичной репликой, зависят от режима доступности и, для режима синхронной фиксации, от режима отработки отказа для первичной реплики и целевой вторичной реплики, как будет показано ниже.</span><span class="sxs-lookup"><span data-stu-id="5218f-189">The form or forms of failover supported by a given secondary replica depends on its availability mode, and, for synchronous-commit mode, on the failover mode on the primary replica and target secondary replica, as follows.</span></span>

-   <span data-ttu-id="5218f-190">Режим синхронной фиксации поддерживает две формы отработки отказа,*запланированные вручную* , и *Автоматический переход на другой*ресурс, если целевая вторичная реплика в настоящее время синхронизирована с avt1.</span><span class="sxs-lookup"><span data-stu-id="5218f-190">Synchronous-commit mode supports two forms of failover-*planned manual failover* and *automatic failover*, if the target secondary replica is currently synchronized with the avt1.</span></span> <span data-ttu-id="5218f-191">Поддержка этих форм отработки отказа зависит от *свойства режима отработки отказа* партнеров по обеспечению отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="5218f-191">The support for these forms of failover depends on the setting of the *failover mode property* on the failover partners.</span></span> <span data-ttu-id="5218f-192">Если режим перехода на другой ресурс имеет значение «вручную» для первичной или вторичной реплики, то для этой вторичной реплики поддерживается только режим перехода на другой ресурс «вручную».</span><span class="sxs-lookup"><span data-stu-id="5218f-192">If failover mode is set to "manual" on either the primary or secondary replica, only manual failover is supported for that secondary replica.</span></span> <span data-ttu-id="5218f-193">Если режим перехода на другой ресурс имеет значение «автоматический» как для первичной, так и для вторичной реплики, то эта вторичная реплика поддерживает как автоматический, так и переход на другой ресурс вручную.</span><span class="sxs-lookup"><span data-stu-id="5218f-193">If failover mode is set to "automatic" on both the primary and secondary replicas, both automatic and manual failover are supported on that secondary replica.</span></span>

    -   <span data-ttu-id="5218f-194">**Переход на другой ресурс вручную** (без потери данных)</span><span class="sxs-lookup"><span data-stu-id="5218f-194">**Planned manual failover** (without data loss)</span></span>

         <span data-ttu-id="5218f-195">Переход на другой ресурс вручную происходит вслед за тем, как администратор баз данных выполняет команду перехода на другой ресурс, после чего синхронизируемая вторичная реплика принимает первичную роль (с гарантированной защитой данных), а первичная реплика — вторичную роль.</span><span class="sxs-lookup"><span data-stu-id="5218f-195">A manual failover occurs after a database administrator issues a failover command and causes a synchronized secondary replica to transition to the primary role (with guaranteed data protection) and the primary replica to transition to the secondary role.</span></span> <span data-ttu-id="5218f-196">Для перехода на другой ресурс вручную требуется, чтобы первичная реплика и целевая вторичная реплика работали в режиме синхронной фиксации, при этом вторичная реплика уже должна быть синхронизирована.</span><span class="sxs-lookup"><span data-stu-id="5218f-196">A manual failover requires that both the primary replica and the target secondary replica are running under synchronous-commit mode, and the secondary replica must already be synchronized.</span></span>

    -   <span data-ttu-id="5218f-197">**Автоматический переход на другой ресурс** (без потери данных)</span><span class="sxs-lookup"><span data-stu-id="5218f-197">**Automatic failover** (without data loss)</span></span>

         <span data-ttu-id="5218f-198">Автоматический переход на другой ресурс возникает в ответ на сбой, в результате которого синхронизируемая вторичная реплика принимает первичную роль (с гарантированной защитой данных).</span><span class="sxs-lookup"><span data-stu-id="5218f-198">An automatic failover occurs in response to a failure that causes a synchronized secondary replica to transition to the primary role (with guaranteed data protection).</span></span> <span data-ttu-id="5218f-199">Когда прежняя первичная реплика становится доступной, она принимает вторичную роль.</span><span class="sxs-lookup"><span data-stu-id="5218f-199">When the former primary replica becomes available, it transitions to the secondary role.</span></span> <span data-ttu-id="5218f-200">Для автоматического перехода на другой ресурс требуется, чтобы первичная реплика и целевая вторичная реплика работали в режиме синхронной фиксации, а режим отработки отказа имел значение «Автоматический».</span><span class="sxs-lookup"><span data-stu-id="5218f-200">Automatic failover requires that both the primary replica and the target secondary replica are running under synchronous-commit mode with the failover mode set to "Automatic".</span></span> <span data-ttu-id="5218f-201">Помимо этого, вторичная реплика уже должна быть синхронизирована, иметь WSFC-кворум и отвечать условиям, указанным в [гибкой политике перехода на другой ресурс](flexible-automatic-failover-policy-availability-group.md)для группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-201">In addition, the secondary replica must already be synchronized, have WSFC quorum, and meet the conditions specified by the [flexible failover policy](flexible-automatic-failover-policy-availability-group.md)of the availability group.</span></span>

        > [!IMPORTANT]
        >  <span data-ttu-id="5218f-202">Экземпляры отказоустойчивого кластера SQL Server не поддерживают автоматический переход на другой ресурс с учетом групп доступности, поэтому любая реплика доступности, размещенная в них, должна быть настроена для перехода на другой ресурс вручную.</span><span class="sxs-lookup"><span data-stu-id="5218f-202">SQL Server Failover Cluster Instances (FCIs) do not support automatic failover by availability groups, so any availability replica that is hosted by an FCI can only be configured for manual failover.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="5218f-203">Заметьте, что если команда принудительной отработки отказа выполняется в синхронизированной вторичной реплике, то она работает так же, как в случае запланированного перехода на другой ресурс вручную.</span><span class="sxs-lookup"><span data-stu-id="5218f-203">Note that if you issue a forced failover command on a synchronized secondary replica, the secondary replica behaves the same as for a planned manual failover.</span></span>

-   <span data-ttu-id="5218f-204">В режиме асинхронной фиксации единственная возможная форма отработки отказа — это принудительный переход на другой ресурс вручную (с возможной потерей данных), который обычно называется *принудительная отработка отказа*.</span><span class="sxs-lookup"><span data-stu-id="5218f-204">Under asynchronous-commit mode, the only form of failover is forced manual failover (with possible data loss), typically called *forced failover*.</span></span> <span data-ttu-id="5218f-205">Принудительная отработка отказа считается формой перехода на другой ресурс вручную, поскольку она может быть инициирована только вручную.</span><span class="sxs-lookup"><span data-stu-id="5218f-205">Forced failover is considered a form of manual failover because it can only be initiated manually.</span></span> <span data-ttu-id="5218f-206">Принудительная отработка отказа является вариантом аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="5218f-206">Forced failover is a disaster recovery option.</span></span> <span data-ttu-id="5218f-207">Это единственная форма отработки отказа, которая возможна в случае, если целевая вторичная реплика не синхронизирована с первичной репликой.</span><span class="sxs-lookup"><span data-stu-id="5218f-207">It is the only form of failover that is possible when the target secondary replica is not synchronized with the primary replica.</span></span>

 <span data-ttu-id="5218f-208">Дополнительные сведения см. в статье [Отработка отказа и режимы отработки отказа (группы доступности AlwaysOn)](failover-and-failover-modes-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-208">For more information, see [Failover and Failover Modes &#40;AlwaysOn Availability Groups&#41;](failover-and-failover-modes-always-on-availability-groups.md).</span></span>

##  <a name="client-connections"></a><a name="ClientConnections"></a> <span data-ttu-id="5218f-209">Клиентские соединения</span><span class="sxs-lookup"><span data-stu-id="5218f-209">Client Connections</span></span>
 <span data-ttu-id="5218f-210">Можно обеспечить клиентское соединение с первичной репликой данной группы доступности, создав прослушиватель группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-210">You can provide client connectivity to the primary replica of a given availability group by creating an availability group listener.</span></span> <span data-ttu-id="5218f-211">*Прослушиватель группы доступности* предоставляет набор ресурсов, который закрепляется за определенной группой доступности и направляет клиентские соединения на соответствующую реплику доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-211">An *availability group listener* provides a set of resources that is attached to a given availability group to direct client connections to the appropriate availability replica.</span></span>

 <span data-ttu-id="5218f-212">Прослушиватель группы доступности связан с уникальным DNS-именем, которое является виртуальным сетевым именем (VNN), одним или несколькими виртуальными IP-адресами (VIP) и номером TCP-порта.</span><span class="sxs-lookup"><span data-stu-id="5218f-212">An availability group listener is associated with a unique DNS name that serves as a virtual network name (VNN), one or more virtual IP addresses (VIPs), and a TCP port number.</span></span> <span data-ttu-id="5218f-213">Дополнительные сведения см. в разделе [Прослушиватели групп доступности, возможность подключения клиентов и отработка отказа приложений (SQL Server)](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-213">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>

> [!TIP]
>  <span data-ttu-id="5218f-214">Если в группе доступности имеется только две реплики доступности и в ней не разрешен доступ только для чтения к вторичной реплике доступности, клиенты смогут подключаться к первичной реплике доступности с помощью [строк подключения к зеркальному отображению базы данных](../../database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-214">If an availability group possesses only two availability replicas and is not configured to allow read-access to the secondary replica, clients can connect to the primary replica by using a [database mirroring connection string](../../database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span> <span data-ttu-id="5218f-215">Этот подход может быть временно полезным после миграции базы данных с зеркального отображения базы данных на сервер [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5218f-215">This approach can be useful temporarily after you migrate a database from database mirroring to [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="5218f-216">Прежде чем добавлять другие вторичные реплики, потребуется создать прослушиватель группы доступности, группу доступности и обновить приложения так, чтобы они использовали сетевое имя прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="5218f-216">Before you add additional secondary replicas, you will need to create an availability group listener the availability group and update your applications to use the network name of the listener.</span></span>

##  <a name="active-secondary-replicas"></a><a name="ActiveSecondaries"></a><span data-ttu-id="5218f-217">Активные вторичные реплики</span><span class="sxs-lookup"><span data-stu-id="5218f-217">Active Secondary Replicas</span></span>
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="5218f-218">поддерживает активные вторичные реплики.</span><span class="sxs-lookup"><span data-stu-id="5218f-218">supports active secondary replicas.</span></span> <span data-ttu-id="5218f-219">Активные вторичные функции поддерживают следующее.</span><span class="sxs-lookup"><span data-stu-id="5218f-219">Active secondary capabilities include support for:</span></span>

-   <span data-ttu-id="5218f-220">**Проведение операций резервного копирования со вторичными репликами.**</span><span class="sxs-lookup"><span data-stu-id="5218f-220">**Performing backup operations on secondary replicas**</span></span>

     <span data-ttu-id="5218f-221">Вторичные реплики поддерживают создание резервных копий журнала и резервных копий [только для копирования](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) всей базы данных, файлов и файловых групп.</span><span class="sxs-lookup"><span data-stu-id="5218f-221">The secondary replicas support performing log backups and [copy-only](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) backups of a full database, file, or filegroup.</span></span> <span data-ttu-id="5218f-222">Можно настроить группу доступности, указав предпочтение, где следует выполнять резервное копирование.</span><span class="sxs-lookup"><span data-stu-id="5218f-222">You can configure the availability group to specify a preference for where backups should be performed.</span></span> <span data-ttu-id="5218f-223">Важно понимать, что приоритет не определяется в SQL Server, поэтому не влияет на выполнение нерегламентированного резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="5218f-223">It is important to understand that the preference is not enforced by SQL Server, so it has no impact on ad-hoc backups.</span></span> <span data-ttu-id="5218f-224">Интерпретация данного приоритета зависит от логики, при ее наличии, которая внесена в задания резервного копирования для каждой из баз данных в указанной группе доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-224">The interpretation of this preference depends on the logic, if any, that you script into your back jobs for each of the databases in a given availability group.</span></span> <span data-ttu-id="5218f-225">Для отдельной реплики доступности можно указать приоритет выполнения резервного копирования на данной реплике по отношению к другим репликам из той же группы доступности.</span><span class="sxs-lookup"><span data-stu-id="5218f-225">For an individual availability replica, you can specify your priority for performing backups on this replica relative to the other replicas in the same availability group.</span></span> <span data-ttu-id="5218f-226">Дополнительные сведения см. в разделе [Активные вторичные реплики: резервное копирование на вторичных репликах (группы доступности AlwaysOn)](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-226">For more information, see [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span></span>

-   <span data-ttu-id="5218f-227">**Доступ только для чтения к одной или нескольким вторичным репликам (доступные для чтения вторичные реплики)**</span><span class="sxs-lookup"><span data-stu-id="5218f-227">**Read-only access to one or more secondary replicas (readable secondary replicas)**</span></span>

     <span data-ttu-id="5218f-228">Любая реплика доступности может быть настроена на получение доступа только для чтения ко своим локальным базам данных (при выполнении вторичной роли), хотя некоторые операции поддерживаются не полностью.</span><span class="sxs-lookup"><span data-stu-id="5218f-228">Any availability replica can be configured to allow read-only access to its local databases when performing the secondary role, though some operations are not fully supported.</span></span> <span data-ttu-id="5218f-229">Кроме того, если требуется предотвратить выполнение на первичной реплике рабочих нагрузок в режиме только чтения, то при выполнении реплик в первичной роли для них можно настроить доступ только на чтение и запись.</span><span class="sxs-lookup"><span data-stu-id="5218f-229">Also, if you would like to prevent read-only workloads from running on the primary replica, you can configure the replicas to allow only read-write access when running under the primary role.</span></span> <span data-ttu-id="5218f-230">Дополнительные сведения см. в разделе [Активные вторичные реплики: вторичные реплики для чтения (группы доступности AlwaysOn)](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-230">For more information, see [Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>

     <span data-ttu-id="5218f-231">Если в группе доступности имеется прослушиватель группы доступности и одна или несколько доступных для чтения вторичных реплик, то [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] может направлять запросы на установку соединения (с целью считывания данных) к одной из них (*маршрутизация только для чтения*).</span><span class="sxs-lookup"><span data-stu-id="5218f-231">If an availability group currently possesses an availability group listener and one or more readable secondary replicas, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can route read-intent connection requests to one of them (*read-only routing*).</span></span> <span data-ttu-id="5218f-232">Дополнительные сведения см. в разделе [Прослушиватели групп доступности, возможность подключения клиентов и отработка отказа приложений (SQL Server)](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-232">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>

##  <a name="session-timeout-period"></a><a name="SessionTimeoutPerios"></a><span data-ttu-id="5218f-233">Период времени ожидания сеанса</span><span class="sxs-lookup"><span data-stu-id="5218f-233">Session-Timeout Period</span></span>
 <span data-ttu-id="5218f-234">Период времени ожидания сеанса — это свойство реплики доступности, которое определяет, как долго соединение с другой репликой доступности может оставаться неактивным до закрытия соединения.</span><span class="sxs-lookup"><span data-stu-id="5218f-234">The session-timeout period is an availability-replica property that determines how long connection with another availability replica can remain inactive before the connection is closed.</span></span> <span data-ttu-id="5218f-235">Первичные и вторичные реплики проверяют связь друг с другом, чтобы подтвердить собственную активность.</span><span class="sxs-lookup"><span data-stu-id="5218f-235">The primary and secondary replicas ping each other to signal that they are still active.</span></span> <span data-ttu-id="5218f-236">Получение сообщения проверки связи от другой реплики до истечения периода времени ожидания указывает на то, что соединение все еще открыто и экземпляры сервера поддерживают связь.</span><span class="sxs-lookup"><span data-stu-id="5218f-236">Receiving a ping from the other replica during the timeout period indicates that the connection is still open and that the server instances are communicating.</span></span> <span data-ttu-id="5218f-237">После получения сообщения проверки связи реплика доступности сбрасывает счетчик времени ожидания сеанса для данного соединения.</span><span class="sxs-lookup"><span data-stu-id="5218f-237">On receiving a ping, an availability replica resets its session-timeout counter on that connection.</span></span>

 <span data-ttu-id="5218f-238">Ограничение времени ожидания сеанса исключает неограниченное продолжение работы реплики, ожидающей сообщения проверки связи от другой реплики.</span><span class="sxs-lookup"><span data-stu-id="5218f-238">The session-timeout period prevents either replica from waiting indefinitely to receive a ping from the other replica.</span></span> <span data-ttu-id="5218f-239">Если в течение периода ожидания от другой реплики не приходит сообщение проверки связи, то реплика прекращает ожидание. Соединение закрывается, и реплика переходит в состояние DISCONNECTED.</span><span class="sxs-lookup"><span data-stu-id="5218f-239">If no ping is received from the other replica within the session-timeout period, the replica times out. Its connection is closed, and the timed-out replica enters the DISCONNECTED state.</span></span> <span data-ttu-id="5218f-240">Даже если для отключенной реплики настроен режим синхронной фиксации, транзакции не будут ожидать ее повторного подключения и повторной синхронизации.</span><span class="sxs-lookup"><span data-stu-id="5218f-240">Even if a disconnected replica is configured for synchronous-commit mode, transactions will not wait for that replica to reconnect and resynchronize.</span></span>

 <span data-ttu-id="5218f-241">По умолчанию период времени ожидания сеанса каждой реплики доступности составляет 10 секунд.</span><span class="sxs-lookup"><span data-stu-id="5218f-241">The default session-timeout period for each availability replica is 10 seconds.</span></span> <span data-ttu-id="5218f-242">Это значение задается пользователем и не может быть меньше 5 секунд.</span><span class="sxs-lookup"><span data-stu-id="5218f-242">This value is user-configurable, with a minimum of 5 seconds.</span></span> <span data-ttu-id="5218f-243">Обычно рекомендуется установить период времени ожидания 10 секунд и более.</span><span class="sxs-lookup"><span data-stu-id="5218f-243">Generally, we recommend that you keep the time-out period at 10 seconds or greater.</span></span> <span data-ttu-id="5218f-244">При установке значения меньше 10 секунд в сильно загруженной системе возникает вероятность ошибочного сообщения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="5218f-244">Setting the value to less than 10 seconds creates the possibility of a heavily loaded system declaring a false failure.</span></span>

> [!NOTE]
>  <span data-ttu-id="5218f-245">В роли разрешения период времени ожидания сеанса не применяется, поскольку проверка связи не выполняется.</span><span class="sxs-lookup"><span data-stu-id="5218f-245">In the resolving role, the session-timeout period does not apply because pinging does not occur.</span></span>

##  <a name="automatic-page-repair"></a><a name="APR"></a><span data-ttu-id="5218f-246">Автоматическое восстановление страниц</span><span class="sxs-lookup"><span data-stu-id="5218f-246">Automatic Page Repair</span></span>
 <span data-ttu-id="5218f-247">Каждая реплика доступности пытается автоматически восстановиться с учетом поврежденных страниц в локальной базе данных, разрешая определенные типы ошибок, которые предотвращают чтение страницы данных.</span><span class="sxs-lookup"><span data-stu-id="5218f-247">Each availability replica tries to automatically recover from corrupted pages on a local database by resolving certain types of errors that prevent reading a data page.</span></span> <span data-ttu-id="5218f-248">Если вторичная реплика не может прочитать страницу, реплика запрашивает свежую копию страницы с первичной реплики.</span><span class="sxs-lookup"><span data-stu-id="5218f-248">If a secondary replica cannot read a page, the replica requests a fresh copy of the page from the primary replica.</span></span> <span data-ttu-id="5218f-249">Если первичная реплика не может прочесть страницу, реплика направляет запрос получения свежей копии для всех вторичных реплик и получает страницу от первой ответившей реплики.</span><span class="sxs-lookup"><span data-stu-id="5218f-249">If the primary replica cannot read a page, the replica broadcasts a request for a fresh copy to all the secondary replicas and gets the page from the first to respond.</span></span> <span data-ttu-id="5218f-250">Если этот запрос завершился успешно, то нечитаемая страница заменяется копией, в результате чего ошибка обычно устраняется.</span><span class="sxs-lookup"><span data-stu-id="5218f-250">If this request succeeds, the unreadable page is replaced by the copy, which usually resolves the error.</span></span>

 <span data-ttu-id="5218f-251">Дополнительные сведения см. в разделе [Автоматическое восстановление страниц (для групп доступности и зеркального отображения баз данных)](../../../sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="5218f-251">For more information, see [Automatic Page Repair &#40;For Availability Groups and Database Mirroring&#41;](../../../sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring.md).</span></span>

##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="5218f-252">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="5218f-252">Related Tasks</span></span>

-   [<span data-ttu-id="5218f-253">Начало работы с группы доступности AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="5218f-253">Getting Started with AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](getting-started-with-always-on-availability-groups-sql-server.md)

##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="5218f-254">См. также</span><span class="sxs-lookup"><span data-stu-id="5218f-254">Related Content</span></span>

-   <span data-ttu-id="5218f-255">**Блоги**</span><span class="sxs-lookup"><span data-stu-id="5218f-255">**Blogs:**</span></span>

     [<span data-ttu-id="5218f-256">Обучающая серия AlwaysON — HADRON. использование пулов рабочих потоков для баз данных с HADRON</span><span class="sxs-lookup"><span data-stu-id="5218f-256">AlwaysON - HADRON Learning Series: Worker Pool Usage for HADRON Enabled Databases</span></span>](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx)

     [<span data-ttu-id="5218f-257">Блоги команды разработчиков SQL Server AlwaysOn: официальный блог по SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="5218f-257">SQL Server AlwaysOn Team Blogs: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)

     [<span data-ttu-id="5218f-258">Блоги инженеров CSS SQL Server</span><span class="sxs-lookup"><span data-stu-id="5218f-258">CSS SQL Server Engineers Blogs</span></span>](https://blogs.msdn.com/b/psssql/)

-   <span data-ttu-id="5218f-259">**Видеоролики**</span><span class="sxs-lookup"><span data-stu-id="5218f-259">**Videos:**</span></span>

     [<span data-ttu-id="5218f-260">Microsoft SQL Server с рабочим названием Denali AlwaysOn, часть 1: вводные сведения о решении следующего поколения по обеспечению высокого уровня доступности</span><span class="sxs-lookup"><span data-stu-id="5218f-260">Microsoft SQL Server Code-Named "Denali" AlwaysOn Series,Part 1: Introducing the Next Generation High Availability Solution</span></span>](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2011/DBI302)

     [<span data-ttu-id="5218f-261">Microsoft SQL Server с рабочим названием Denali AlwaysOn, часть 2: создание критически важного решения по обеспечению высокого уровня доступности с использованием AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="5218f-261">Microsoft SQL Server Code-Named "Denali" AlwaysOn Series,Part 2: Building a Mission-Critical High Availability Solution Using AlwaysOn</span></span>](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2011/DBI404)

-   <span data-ttu-id="5218f-262">**Технические документы**</span><span class="sxs-lookup"><span data-stu-id="5218f-262">**Whitepapers:**</span></span>

     [<span data-ttu-id="5218f-263">Руководство по решениям режима AlwaysOn в Microsoft SQL Server для обеспечения высокой доступности и аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="5218f-263">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)

     [<span data-ttu-id="5218f-264">Технические документы Майкрософт Microsoft по SQL Server 2012</span><span class="sxs-lookup"><span data-stu-id="5218f-264">Microsoft White Papers for SQL Server 2012</span></span>](https://msdn.microsoft.com/library/hh403491.aspx)

     [<span data-ttu-id="5218f-265">Технические документы группы консультантов по SQL Server</span><span class="sxs-lookup"><span data-stu-id="5218f-265">SQL Server Customer Advisory Team Whitepapers</span></span>](http://sqlcat.com/)

## <a name="see-also"></a><span data-ttu-id="5218f-266">См. также:</span><span class="sxs-lookup"><span data-stu-id="5218f-266">See Also</span></span>
 <span data-ttu-id="5218f-267">[Режимы доступности &#40;группы доступности AlwaysOn&#41;](availability-modes-always-on-availability-groups.md) [отработки отказа и режимы Отработки отказа &#40;группы доступности AlwaysOn](failover-and-failover-modes-always-on-availability-groups.md)&#41;общие сведения о [командлетах](overview-of-powershell-cmdlets-for-always-on-availability-groups-sql-server.md) [Transact-SQL для](transact-sql-statements-for-always-on-availability-groups.md) группы доступности AlwaysOn &#40;SQL Server&#41;[Поддержка высокого уровня доступности для работы с базами данных OLTP в памяти](../../../relational-databases/in-memory-oltp/high-availability-support-for-in-memory-oltp-databases.md) [, ограничения и рекомендации для группы доступности AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md) [создания и настройки групп доступности &#40;SQL Server](creation-and-configuration-of-availability-groups-sql-server.md)&#41;[активных получателей: вторичные реплики, доступные для чтения](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) , &#40;группы доступности AlwaysOn&#41;[Активные](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) вторичные реплики</span><span class="sxs-lookup"><span data-stu-id="5218f-267">[Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md) [Failover and Failover Modes &#40;AlwaysOn Availability Groups&#41;](failover-and-failover-modes-always-on-availability-groups.md) [Overview of Transact-SQL Statements for AlwaysOn Availability Groups &#40;SQL Server&#41;](transact-sql-statements-for-always-on-availability-groups.md) [Overview of PowerShell Cmdlets for AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-powershell-cmdlets-for-always-on-availability-groups-sql-server.md) [High Availability Support for In-Memory OLTP databases](../../../relational-databases/in-memory-oltp/high-availability-support-for-in-memory-oltp-databases.md) [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md) [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](creation-and-configuration-of-availability-groups-sql-server.md) [Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)</span></span>

