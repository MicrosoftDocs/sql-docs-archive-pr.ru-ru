---
title: Предварительные требования, ограничения и рекомендации для группы доступности AlwaysOn (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], server instance
- Availability Groups [SQL Server], deploying
- Availability Groups [SQL Server], WSFC clusters
- Availability Groups [SQL Server], about
- Availability Groups [SQL Server], prerequisites and restrictions
- Availability Groups [SQL Server], Failover Cluster Instances
- Availability Groups [SQL Server], databases
- Availability Groups [SQL Server]
ms.assetid: edbab896-42bb-4d17-8d75-e92ca11f7abb
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 078f38058c612037a8013f7955349e94d6db610e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87740502"
---
# <a name="prerequisites-restrictions-and-recommendations-for-alwayson-availability-groups-sql-server"></a><span data-ttu-id="c6eab-102">предварительными требованиями, и ограничениями и рекомендациями для групп доступности AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-102">Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="c6eab-103">В этом разделе приводятся рекомендации по развертыванию [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], в т.ч. предварительные условия, ограничения и рекомендации в отношении компьютеров, отказоустойчивых кластеров Windows Server (WSFC), экземпляров сервера и групп доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-103">This topic describes considerations for deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], including prerequisites, restrictions, and recommendations for host computers, Windows Server Failover Clustering (WSFC) clusters, server instances, and availability groups.</span></span> <span data-ttu-id="c6eab-104">Для каждого из этих компонентов описываются имеющиеся вопросы безопасности и необходимые разрешения.</span><span class="sxs-lookup"><span data-stu-id="c6eab-104">For each of these components security considerations and required permissions, if any, are indicated.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="c6eab-105">Перед началом развертывания [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]настоятельно рекомендуется ознакомиться со всеми подразделами данного раздела.</span><span class="sxs-lookup"><span data-stu-id="c6eab-105">Before you deploy [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], we strongly recommend that you read every section of this topic.</span></span>  
  
 
  
##  <a name="net-hotfixes-that-support-alwayson-availability-groups"></a><a name="DotNetHotfixes"></a><span data-ttu-id="c6eab-106">Исправления .NET, которые поддерживают группы доступности AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="c6eab-106">.NET Hotfixes that Support AlwaysOn Availability Groups</span></span>  
 <span data-ttu-id="c6eab-107">В зависимости от [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] компонентов и функций, которые будут использоваться с [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , может потребоваться установить дополнительные исправления .NET, указанные в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="c6eab-107">Depending on the [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] components and features you will use with [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], you may need to install additional .NET hotfixes identified in the following table.</span></span> <span data-ttu-id="c6eab-108">Исправления можно устанавливать в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="c6eab-108">The hotfixes can be installed in any order.</span></span>  
  
||<span data-ttu-id="c6eab-109">Зависимый компонент</span><span class="sxs-lookup"><span data-stu-id="c6eab-109">Dependent Feature</span></span>|<span data-ttu-id="c6eab-110">Исправление</span><span class="sxs-lookup"><span data-stu-id="c6eab-110">Hotfix</span></span>|<span data-ttu-id="c6eab-111">Ссылка</span><span class="sxs-lookup"><span data-stu-id="c6eab-111">Link</span></span>|  
|------|-----------------------|------------|----------|  
|<span data-ttu-id="c6eab-112">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-112">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]|<span data-ttu-id="c6eab-113">Исправление для .NET 3,5 SP1 добавляет поддержку клиента SQL для функций AlwaysOn, предназначенных для чтения, чтения и MultiSubnetFailover.</span><span class="sxs-lookup"><span data-stu-id="c6eab-113">Hotfix for .NET 3.5 SP1 adds support to SQL Client for AlwaysOn features of Read-intent, readonly, and multisubnetfailover.</span></span> <span data-ttu-id="c6eab-114">Это исправление необходимо установить на каждом сервере отчетов служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c6eab-114">The hotfix needs to be installed on each [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] report server.</span></span>|<span data-ttu-id="c6eab-115">KB 2654347: [исправление для .net 3,5 SP1 для добавления поддержки функций AlwaysOn](https://go.microsoft.com/fwlink/?LinkId=242896)</span><span class="sxs-lookup"><span data-stu-id="c6eab-115">KB 2654347: [Hotfix for .NET 3.5 SP1 to add support for AlwaysOn features](https://go.microsoft.com/fwlink/?LinkId=242896)</span></span>|  
  
##  <a name="windows-system-requirements-and-recommendations"></a><a name="SystemReqsForAOAG"></a><span data-ttu-id="c6eab-116">Системные требования и рекомендации по Windows</span><span class="sxs-lookup"><span data-stu-id="c6eab-116">Windows System Requirements and Recommendations</span></span>  
  
  
###  <a name="checklist-requirements-windows-system"></a><a name="SystemRequirements"></a> <span data-ttu-id="c6eab-117">Контрольный список. Требования (ОС Windows)</span><span class="sxs-lookup"><span data-stu-id="c6eab-117">Checklist: Requirements (Windows System)</span></span>  
 <span data-ttu-id="c6eab-118">Чтобы обеспечить поддержку функции [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , необходимо, чтобы каждый компьютер, участвующий в одной или нескольких группах доступности, соответствовал следующим основным требованиям.</span><span class="sxs-lookup"><span data-stu-id="c6eab-118">To support the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature, ensure that every computer that is to participate in one or more availability groups meets the following fundamental requirements:</span></span>  
  
||<span data-ttu-id="c6eab-119">Требование</span><span class="sxs-lookup"><span data-stu-id="c6eab-119">Requirement</span></span>|<span data-ttu-id="c6eab-120">Ссылка</span><span class="sxs-lookup"><span data-stu-id="c6eab-120">Link</span></span>|  
|------|-----------------|----------|  
|<span data-ttu-id="c6eab-121">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-121">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-122">Убедитесь, что система не является контроллером домена.</span><span class="sxs-lookup"><span data-stu-id="c6eab-122">Ensure that the system is not a domain controller.</span></span>|<span data-ttu-id="c6eab-123">Группы доступности не поддерживаются на контроллерах домена.</span><span class="sxs-lookup"><span data-stu-id="c6eab-123">Availability groups are not supported on domain controllers.</span></span>|  
|<span data-ttu-id="c6eab-124">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-124">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-125">Убедитесь, что каждый компьютер работает под управлением либо системы x86 (без режима WoW64), либо на платформе x64 Windows Server 2008 или более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="c6eab-125">Ensure that each computer is running either x86 (non-WOW64) or x64 Windows Server 2008 or later versions.</span></span>|<span data-ttu-id="c6eab-126">WOW64 (Windows 32-бит на Windows 64-бит) не поддерживает функцию [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c6eab-126">WOW64 (Windows 32-bit on Windows 64-bit) does not support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>|  
|<span data-ttu-id="c6eab-127">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-127">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-128">Убедитесь, что каждый компьютер является узлом в отказоустойчивой кластеризации Windows Server (WSFC).</span><span class="sxs-lookup"><span data-stu-id="c6eab-128">Ensure that each computer is a node in a Windows Server Failover Clustering (WSFC) cluster.</span></span>|[<span data-ttu-id="c6eab-129">Отказоустойчивая кластеризация Windows Server (WSFC) с SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6eab-129">Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server</span></span>](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md)|  
|<span data-ttu-id="c6eab-130">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-130">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-131">Убедитесь, что кластер WSFC содержит достаточное количество узлов для поддержки требуемых конфигураций групп доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-131">Ensure that the WSFC cluster contains sufficient nodes to support your availability group configurations.</span></span>|<span data-ttu-id="c6eab-132">На узле WSFC можно размещать только одну реплику доступности для отдельной группы доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-132">A WSFC node can host only one availability replica for a given availability group.</span></span> <span data-ttu-id="c6eab-133">На каждом отдельном узле WSFC один или несколько экземпляров [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] могут содержать реплики доступности для многих групп доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-133">On a given WSFC node, one or more instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can host availability replicas for many availability groups.</span></span><br /><br /> <span data-ttu-id="c6eab-134">Обратитесь к администраторам базы данных, чтобы узнать, сколько узлов кластера WSFC требуется для поддержки реплик доступности для планируемых групп доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-134">Ask your database administrators how many WSFC nodes are required for to support the availability replicas of the planned availability groups.</span></span><br /><br /> <span data-ttu-id="c6eab-135">[Обзор групп доступности AlwaysOn (SQL Server)](overview-of-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c6eab-135">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md).</span></span>|  
|<span data-ttu-id="c6eab-136">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-136">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-137">Убедитесь, что все применимые исправления Windows были установлены на всех узлах кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-137">Ensure that all applicable Window hotfixes have been installed on every node in the WSFC cluster.</span></span>|<span data-ttu-id="c6eab-138">Важно. для узлов кластера WSFC, на которых выполняется развертывание, требуются или рекомендуются некоторые исправления. \*\* \* \* \* \* \*\* [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]</span><span class="sxs-lookup"><span data-stu-id="c6eab-138">**\*\* Important \*\*** A number of hotfixes are required or recommended for the nodes of a WSFC cluster on which [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is being deployed.</span></span> <span data-ttu-id="c6eab-139">Дополнительные сведения см. в подразделе [Исправления Windows для поддержки групп доступности AlwaysOn (ОС Windows)](#WinHotfixes) ниже.</span><span class="sxs-lookup"><span data-stu-id="c6eab-139">For more information, see [Windows Hotfixes that Support AlwaysOn Availability Groups (Windows System)](#WinHotfixes), later in this section.</span></span>|  
  
> [!IMPORTANT]  
>  <span data-ttu-id="c6eab-140">Кроме того, убедитесь, что среда правильно настроена для соединения с группой доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-140">Also ensure that your environment is correctly configured for connecting to an availability group.</span></span> <span data-ttu-id="c6eab-141">Дополнительные сведения см. в разделе [подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c6eab-141">For more information, see [AlwaysOn Client Connectivity (SQL Server)](always-on-client-connectivity-sql-server.md).</span></span>  
  
####  <a name="windows-hotfixes-that-support-alwayson-availability-groups-windows-system"></a><a name="WinHotfixes"></a><span data-ttu-id="c6eab-142">Исправления Windows, которые поддерживают группы доступности AlwaysOn (Windows System)</span><span class="sxs-lookup"><span data-stu-id="c6eab-142">Windows Hotfixes that Support AlwaysOn Availability Groups (Windows System)</span></span>  
 <span data-ttu-id="c6eab-143">В зависимости от топологии кластера для поддержки [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] могут потребоваться несколько дополнительных исправлений Windows Server 2008 с пакетом обновления 2 (SP2) или Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="c6eab-143">Depending on your cluster topology, several additional Windows Server 2008 Service Pack 2 (SP2) or Windows Server 2008 R2 hotfixes might be applicable for supporting [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="c6eab-144">Эти исправления перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="c6eab-144">The following table identifies these hotfixes.</span></span> <span data-ttu-id="c6eab-145">Их можно устанавливать в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="c6eab-145">They hotfixes can be installed in any order.</span></span>  
  
||<span data-ttu-id="c6eab-146">Область применения: Windows 2008 с пакетом обновления 2 (SP2)</span><span class="sxs-lookup"><span data-stu-id="c6eab-146">Applies to Windows 2008 SP2</span></span>|<span data-ttu-id="c6eab-147">Область применения: Windows 2008 R2 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="c6eab-147">Applies to Windows 2008 R2 SP1</span></span>|<span data-ttu-id="c6eab-148">Входит в состав Windows 2012</span><span class="sxs-lookup"><span data-stu-id="c6eab-148">Included in Windows 2012</span></span>|<span data-ttu-id="c6eab-149">Для поддержки...</span><span class="sxs-lookup"><span data-stu-id="c6eab-149">To Support...</span></span>|<span data-ttu-id="c6eab-150">Исправление</span><span class="sxs-lookup"><span data-stu-id="c6eab-150">Hotfix</span></span>|<span data-ttu-id="c6eab-151">Ссылка</span><span class="sxs-lookup"><span data-stu-id="c6eab-151">Link</span></span>|  
|------|---------------------------------|------------------------------------|------------------------------|-----------------|------------|----------|  
|<span data-ttu-id="c6eab-152">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-152">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-153">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-153">Yes</span></span>|<span data-ttu-id="c6eab-154">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-154">Yes</span></span>|<span data-ttu-id="c6eab-155">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-155">Yes</span></span>|<span data-ttu-id="c6eab-156">**Настройка оптимального кворума WSFC**</span><span class="sxs-lookup"><span data-stu-id="c6eab-156">**Configuring optimal WSFC quorum**</span></span>|<span data-ttu-id="c6eab-157">Убедитесь, что на каждом узле кластера WSFC было установлено исправление, описанное в статье базы знаний 2494036.</span><span class="sxs-lookup"><span data-stu-id="c6eab-157">On each WSFC node, ensure that the hotfix described in Knowledge Base article 2494036 is installed.</span></span><br /><br /> <span data-ttu-id="c6eab-158">Это исправление поддерживает настройку оптимального кворума с неавтоматическими целями отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="c6eab-158">This hotfix supports configuring optimal quorum with non-automatic failover targets.</span></span> <span data-ttu-id="c6eab-159">Эта функция улучшает работу многосайтовых кластеров, позволяя выбирать голосующие узлы.</span><span class="sxs-lookup"><span data-stu-id="c6eab-159">This functionality improves multi-site clusters by enabling you to select which nodes vote.</span></span>|<span data-ttu-id="c6eab-160">KB 2494036:  [Доступно исправление, позволяющее настраивать узел кластера, на котором нет кворума голосов, в Windows Server 2008 и в Windows Server 2008 R2](https://support.microsoft.com/kb/2494036)</span><span class="sxs-lookup"><span data-stu-id="c6eab-160">KB 2494036:  [A hotfix is available to let you configure a cluster node that does not have quorum votes in Windows Server 2008 and in Windows Server 2008 R2](https://support.microsoft.com/kb/2494036)</span></span><br /><br /> <span data-ttu-id="c6eab-161">Сведения о голосовании кворума см. в разделе [Режим кворума и участвующая в голосовании конфигурация WSFC (SQL Server)](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md)</span><span class="sxs-lookup"><span data-stu-id="c6eab-161">For information about quorum voting, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md)</span></span>|  
|<span data-ttu-id="c6eab-162">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-162">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-163">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-163">Yes</span></span>|<span data-ttu-id="c6eab-164">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-164">Yes</span></span>|<span data-ttu-id="c6eab-165">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-165">Yes</span></span>|<span data-ttu-id="c6eab-166">**Более эффективное использование пропускной способности сети**</span><span class="sxs-lookup"><span data-stu-id="c6eab-166">**More efficient use of network bandwidth**</span></span>|<span data-ttu-id="c6eab-167">Убедитесь, что на каждом узле кластера WSFC было установлено исправление, описанное в статье базы знаний 2616514.</span><span class="sxs-lookup"><span data-stu-id="c6eab-167">On each WSFC node, ensure that the hotfix described in Knowledge Base article 2616514 is installed.</span></span><br /><br /> <span data-ttu-id="c6eab-168">Без этого исправления служба кластеров будет отправлять узлам кластера ненужные уведомления реестра.</span><span class="sxs-lookup"><span data-stu-id="c6eab-168">Without this hotfix, the Cluster service sends unnecessary registry notifications among cluster nodes.</span></span> <span data-ttu-id="c6eab-169">Такое поведение ограничивает пропускную способность сети, что является серьезной проблемой для [!INCLUDE[ssHADRc](../../../includes/sshadrc-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c6eab-169">This behavior limits network bandwidth, which is a serious issue for [!INCLUDE[ssHADRc](../../../includes/sshadrc-md.md)].</span></span>|<span data-ttu-id="c6eab-170">KB 2616514.  [Служба кластеров отправляет узлам кластера ненужные уведомления об изменении разделов реестра в Windows Server 2008 и Windows Server 2008 R2](https://support.microsoft.com/kb/2616514)</span><span class="sxs-lookup"><span data-stu-id="c6eab-170">KB 2616514:  [Cluster service sends unnecessary registry key change notifications among cluster nodes in Windows Server 2008 or in Windows Server 2008 R2](https://support.microsoft.com/kb/2616514)</span></span>|  
|<span data-ttu-id="c6eab-171">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-171">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>||<span data-ttu-id="c6eab-172">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-172">Yes</span></span>|<span data-ttu-id="c6eab-173">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="c6eab-173">Not applicable</span></span>|<span data-ttu-id="c6eab-174">**Проверка хранения важных данных продукта (VPD) на дисках, которые не доступны всем узлам WSFC**</span><span class="sxs-lookup"><span data-stu-id="c6eab-174">**VPD storage testing on disks that are not available to all WSFC nodes**</span></span>|<span data-ttu-id="c6eab-175">Если узел WSFC работает под управлением Windows Server 2008 R2 с пакетом обновления 1 (SP1) и тест системы хранения «Проверка SCSI устройства жизненно важных продуктов данных (VPD)» завершается неудачно после некорректного запуска на дисках, которые подключены, но недоступны для всех узлов кластера WSFC, установите исправление, описанное в статье KB 2531907 базы знаний.</span><span class="sxs-lookup"><span data-stu-id="c6eab-175">If a WSFC node is running Windows Server 2008 R2 Service Pack 1 (SP1) and the Validate SCSI Device Vital Product Data (VPD) storage test fails after incorrectly running on disks that are online and not available to all nodes in the WSFC cluster, install the hotfix described in Knowledge Base article 2531907.</span></span><br /><br /> <span data-ttu-id="c6eab-176">Это исправление отключает неверные предупреждения и ошибки в отчете проверки, когда диски подключены.</span><span class="sxs-lookup"><span data-stu-id="c6eab-176">This hotfix eliminates incorrect warnings or errors in the validation report when disks are online.</span></span>|<span data-ttu-id="c6eab-177">KB 2531907: [Тест "Проверка важных данных продукта (VPD) SCSI-устройства" завершается неудачей после установки Windows Server 2008 R2 с пакетом обновления 1 (SP1)](https://support.microsoft.com/kb/2531907)</span><span class="sxs-lookup"><span data-stu-id="c6eab-177">KB 2531907:  [Validate SCSI Device Vital Product Data (VPD) test fails after you install Windows Server 2008 R2 SP1](https://support.microsoft.com/kb/2531907)</span></span>|  
|<span data-ttu-id="c6eab-178">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-178">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>||<span data-ttu-id="c6eab-179">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-179">Yes</span></span>|<span data-ttu-id="c6eab-180">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-180">Yes</span></span>|<span data-ttu-id="c6eab-181">**Более быстрый переход на локальные реплики при сбое**</span><span class="sxs-lookup"><span data-stu-id="c6eab-181">**Faster failover to local replicas**</span></span>|<span data-ttu-id="c6eab-182">Если на узле WSFC работает Windows Server 2008 R2 с пакетом обновления 1 (SP1), убедитесь, что установлено исправление, описанное в статье базы знаний 2687741.</span><span class="sxs-lookup"><span data-stu-id="c6eab-182">If a WSFC node is running Windows Server 2008 R2 Service Pack 1 (SP1), ensure that the hotfix described in Knowledge Base article 2687741 is installed.</span></span><br /><br /> <span data-ttu-id="c6eab-183">Это исправление позволяет повысить производительность перехода [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] на локальные реплики при сбое.</span><span class="sxs-lookup"><span data-stu-id="c6eab-183">This hotfix improves the performance of [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] failover to local replicas.</span></span>|<span data-ttu-id="c6eab-184">KB 2687741.  [Исправление, повышающее производительность функции «Группы доступности AlwaysOn» в SQL Server 2012, доступно в Windows Server 2008 R2](https://support.microsoft.com/KB/2687741)</span><span class="sxs-lookup"><span data-stu-id="c6eab-184">KB 2687741:  [A hotfix that improves the performance of the "AlwaysOn Availability Group" feature in SQL Server 2012 is available for Windows Server 2008 R2](https://support.microsoft.com/KB/2687741)</span></span>|  
|<span data-ttu-id="c6eab-185">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-185">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-186">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-186">Yes</span></span>|<span data-ttu-id="c6eab-187">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-187">Yes</span></span>|<span data-ttu-id="c6eab-188">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-188">Yes</span></span>|<span data-ttu-id="c6eab-189">**Асимметричное хранилище — для экземпляров отказоустойчивого кластера (FCI)**</span><span class="sxs-lookup"><span data-stu-id="c6eab-189">**Asymmetric storage-for Failover Cluster Instances (FCIs)**</span></span>|<span data-ttu-id="c6eab-190">Если будет включен какой-либо экземпляр отказоустойчивого кластера (FCI) для [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], установите исправление 976097 для Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c6eab-190">If any Failover Cluster Instance (FCI) will be enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], install the Windows Server 2008 hotfix 976097.</span></span><br /><br /> <span data-ttu-id="c6eab-191">Это исправление включает оснастку консоли управления (MMC) отказоустойчивого кластера для поддержки асимметричных общих дисков хранилища, доступных только на некоторых узлах WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-191">This hotfix enables the Failover Cluster Management Microsoft Management Console (MMC) snap-in to support asymmetric storage-shared disks that are available on only some of the WSFC nodes.</span></span>|<span data-ttu-id="c6eab-192">Статья базы знаний 976097: [Исправление, предназначенное для добавления функции поддержки асимметричных систем хранения данных в оснастку MMC управления отказоустойчивым кластером для отказоустойчивых кластеров под управлением ОС Windows Server 2008 или Windows Server 2008 R2](https://support.microsoft.com/kb/976097)</span><span class="sxs-lookup"><span data-stu-id="c6eab-192">KB 976097:  [Hotfix to add support for asymmetric storages to the Failover Cluster Management MMC snap-in for a failover cluster that is running Windows Server 2008 or Windows Server 2008 R2](https://support.microsoft.com/kb/976097)</span></span><br /><br /> [<span data-ttu-id="c6eab-193">Руководство по архитектуре AlwaysOn. Построение решения для обеспечения высокого уровня доступности и аварийного восстановления с помощью экземпляров отказоустойчивого кластера и групп доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-193">AlwaysOn Architecture Guide: Building a High Availability and Disaster Recovery Solution by Using Failover Cluster Instances and Availability Groups</span></span>](https://technet.microsoft.com/library/jj215886.aspx)|  
|<span data-ttu-id="c6eab-194">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-194">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-195">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-195">Yes</span></span>|<span data-ttu-id="c6eab-196">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-196">Yes</span></span>|<span data-ttu-id="c6eab-197">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="c6eab-197">Not applicable</span></span>|<span data-ttu-id="c6eab-198">**Безопасность протокола IP (IPsec)**</span><span class="sxs-lookup"><span data-stu-id="c6eab-198">**Internet Protocol Security (IPsec)**</span></span>|<span data-ttu-id="c6eab-199">Если в среде используются соединения IPsec, то в процессе повторного установления клиентскими компьютерами соединения по протоколу IPsec с виртуальным сетевым именем (в данном контексте — к прослушивателю группы доступности) могут возникать длительные задержки (около двух-трех минут).</span><span class="sxs-lookup"><span data-stu-id="c6eab-199">If your environment uses IPsec connections, you could experience a long time delay (about two or three minutes) when a client computer reestablishes the IPsec connection to a virtual network name (in this context, to connect to the availability group listener).</span></span> <span data-ttu-id="c6eab-200">Если используются соединения IPsec, то рекомендуется изучить соответствующие сценарии, описанные в следующей статье базы знаний (KB 980915).</span><span class="sxs-lookup"><span data-stu-id="c6eab-200">If you use IPsec connections, we recommend that you review the specific scenarios detailed in Knowledge Base article (KB 980915).</span></span>|<span data-ttu-id="c6eab-201">KB 980915.  [На компьютерах под управлением Windows Server 2003, Windows Vista, Windows Server 2008, Windows 7 или Windows Server 2008 R2 возникают длительные задержки при повторном соединении по протоколу IPSec](https://support.microsoft.com/kb/980915)</span><span class="sxs-lookup"><span data-stu-id="c6eab-201">KB 980915:  [A long time delay occurs when you reconnect an IPSec connection from a computer that is running Windows Server 2003, Windows Vista, Windows Server 2008, Windows 7, or Windows Server 2008 R2](https://support.microsoft.com/kb/980915)</span></span>|  
|<span data-ttu-id="c6eab-202">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-202">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-203">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-203">Yes</span></span>|<span data-ttu-id="c6eab-204">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-204">Yes</span></span>|<span data-ttu-id="c6eab-205">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-205">Yes</span></span>|<span data-ttu-id="c6eab-206">**Протокол**</span><span class="sxs-lookup"><span data-stu-id="c6eab-206">**IPv6**</span></span>|<span data-ttu-id="c6eab-207">При использовании IPv6 рекомендуется изучить специфические сценарии, рассмотренные в статье 2578103 или 2578113 базы знаний, в зависимости от операционной системы Windows Server.</span><span class="sxs-lookup"><span data-stu-id="c6eab-207">If you use IPv6, we recommend that you review the specific scenarios detailed in Knowledge Base article 2578103 or 2578113, depending on your Windows Server operating system.</span></span><br /><br /> <span data-ttu-id="c6eab-208">Если в топологии Windows Server используются IP-адреса версии 6 (IPv6), то службе кластеров WSFC требуется примерно 30 секунд для отработки отказа при обработке IP-адресов IPv6.</span><span class="sxs-lookup"><span data-stu-id="c6eab-208">If your Windows Server topology uses IP version 6 (IPv6), the WSFC Cluster service requires about 30 seconds to fail over the IPv6 IP address.</span></span> <span data-ttu-id="c6eab-209">При этом клиенту приходится ждать около 30 секунд для повторного соединения по IP-адресу IPv6.</span><span class="sxs-lookup"><span data-stu-id="c6eab-209">This causes clients to wait for about 30 seconds to reconnect to the IPv6 IP address.</span></span>|<span data-ttu-id="c6eab-210">KB 2578103 (Windows Server 2008): [Службе кластеров необходимо около 30 секунд для отработки отказа IP-адресов IPv6 на Windows Server 2008](https://support.microsoft.com/kb/2578103)</span><span class="sxs-lookup"><span data-stu-id="c6eab-210">KB 2578103 (Windows Server 2008):  [The Cluster service takes about 30 seconds to fail over IPv6 IP addresses in Windows Server 2008](https://support.microsoft.com/kb/2578103)</span></span><br /><br /> <span data-ttu-id="c6eab-211">KB 2578113 (Windows Server 2008 R2): **Windows Server 2008 R2:** [Службе кластеров необходимо около 30 секунд для отработки отказа IP-адресов IPv6 на Windows Server 2008 R2](https://support.microsoft.com/kb/2578113)</span><span class="sxs-lookup"><span data-stu-id="c6eab-211">KB 2578113 (Windows Server 2008 R2):  **Windows Server 2008 R2:** [The Cluster service takes about 30 seconds to fail over IPv6 IP addresses in Windows Server 2008 R2](https://support.microsoft.com/kb/2578113)</span></span>|  
|<span data-ttu-id="c6eab-212">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-212">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-213">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-213">Yes</span></span>|<span data-ttu-id="c6eab-214">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-214">Yes</span></span>|<span data-ttu-id="c6eab-215">Да</span><span class="sxs-lookup"><span data-stu-id="c6eab-215">Yes</span></span>|<span data-ttu-id="c6eab-216">**Отсутствует маршрутизатор между кластером и сервером приложений**</span><span class="sxs-lookup"><span data-stu-id="c6eab-216">**No Router Between cluster and application server**</span></span>|<span data-ttu-id="c6eab-217">Если между отказоустойчивым кластером и сервером приложений нет маршрутизатора, то служба кластеров выполняет обработку отказа медленно для ресурсов, зависимых от сети.</span><span class="sxs-lookup"><span data-stu-id="c6eab-217">If no router exists between the failover cluster and the application server, the Cluster service fails over network-related resources slowly.</span></span> <span data-ttu-id="c6eab-218">В результате этого возникнут задержки при повторном соединении клиентов после отработки отказа группой доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-218">This delays client reconnections after an availability group fails over.</span></span> <span data-ttu-id="c6eab-219">При отсутствии маршрутизатора рекомендуется изучить специфические сценарии, рассмотренные в статье 2582281 базы знаний, и установить исправление, если оно применимо к конкретной среде.</span><span class="sxs-lookup"><span data-stu-id="c6eab-219">In the absence of a router, we recommend that you review the specific scenarios detailed in Knowledge Base article 2582281 and install the hotfix, if applicable to your environment.</span></span>|<span data-ttu-id="c6eab-220">KB 2582281.  [Медленная отработка отказа при отсутствии маршрутизатора между кластером и сервером приложений](https://support.microsoft.com/kb/2582281)</span><span class="sxs-lookup"><span data-stu-id="c6eab-220">KB 2582281:  [Slow failover operation if no router exists between the cluster and an application server](https://support.microsoft.com/kb/2582281)</span></span>|  
  
###  <a name="recommendations-for-computers-that-host-availability-replicas-windows-system"></a><a name="ComputerRecommendations"></a> <span data-ttu-id="c6eab-221">Рекомендации для компьютеров, на которых размещены реплики доступности (ОС Windows)</span><span class="sxs-lookup"><span data-stu-id="c6eab-221">Recommendations for Computers That Host Availability Replicas (Windows System)</span></span>  
  
-   <span data-ttu-id="c6eab-222">**Сопоставимые системы**.  Для одной группы доступности все реплики доступности должны работать в сопоставимых системах, способных выдержать примерно одинаковую рабочую нагрузку.</span><span class="sxs-lookup"><span data-stu-id="c6eab-222">**Comparable systems:**  For a given availability group, all the availability replicas should run on comparable systems that can handle identical workloads.</span></span>  
  
-   <span data-ttu-id="c6eab-223">**Выделенные сетевые адаптеры**.  Для оптимальной производительности следует использовать для [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] отдельный сетевой адаптер (сетевую карту).</span><span class="sxs-lookup"><span data-stu-id="c6eab-223">**Dedicated network adapters:**  For best performance, use a dedicated network adapter (network interface card) for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>  
  
-   <span data-ttu-id="c6eab-224">**Достаточно свободного места на диске**.  Каждый компьютер, на котором экземпляр сервера содержит реплику доступности, должен иметь достаточно свободного места на диске для всех баз данных в группе доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-224">**Sufficient disk space:**  Every computer on which a server instance hosts an availability replica must possess sufficient disk space for all the databases in the availability group.</span></span> <span data-ttu-id="c6eab-225">Помните, что по мере роста баз данных-источников так же будут расти и соответствующие базы данных-получатели.</span><span class="sxs-lookup"><span data-stu-id="c6eab-225">Keep in mind that as primary databases grow, their corresponding secondary databases grow the same amount.</span></span>  
  
###  <a name="permissions-windows-system"></a><a name="PermissionsWindows"></a> <span data-ttu-id="c6eab-226">Разрешения (ОС Windows)</span><span class="sxs-lookup"><span data-stu-id="c6eab-226">Permissions (Windows System)</span></span>  
 <span data-ttu-id="c6eab-227">Для администрирования кластера WSFC, пользователь должен быть администратором на каждом узле кластера.</span><span class="sxs-lookup"><span data-stu-id="c6eab-227">To administer a WSFC cluster, the user must be a system administrator on every cluster node.</span></span>  
  
 <span data-ttu-id="c6eab-228">Дополнительные сведения об учетной записи для администрирования кластера см. в [Приложении A. Требования к отказоустойчивому кластеру](https://technet.microsoft.com/library/dd197454\(WS.10\).aspx).</span><span class="sxs-lookup"><span data-stu-id="c6eab-228">For more information about the account for administering the cluster, see [Appendix A: Failover Cluster Requirements](https://technet.microsoft.com/library/dd197454\(WS.10\).aspx).</span></span>  
  
###  <a name="related-tasks-windows-system"></a><a name="RelatedTasksWindows"></a> <span data-ttu-id="c6eab-229">Связанные задачи (ОС Windows)</span><span class="sxs-lookup"><span data-stu-id="c6eab-229">Related Tasks (Windows System)</span></span>  
  
|<span data-ttu-id="c6eab-230">Задача</span><span class="sxs-lookup"><span data-stu-id="c6eab-230">Task</span></span>|<span data-ttu-id="c6eab-231">Ссылка</span><span class="sxs-lookup"><span data-stu-id="c6eab-231">Link</span></span>|  
|----------|----------|  
|<span data-ttu-id="c6eab-232">Установите значение HostRecordTTL.</span><span class="sxs-lookup"><span data-stu-id="c6eab-232">Set the HostRecordTTL value.</span></span>|[<span data-ttu-id="c6eab-233">Изменение параметра HostRecordTTL (с помощью Windows PowerShell)</span><span class="sxs-lookup"><span data-stu-id="c6eab-233">Change the HostRecordTTL (Using Windows PowerShell)</span></span>](#ChangeHostRecordTTLps)|  
  
####  <a name="change-the-hostrecordttl-using-windows-powershell"></a><a name="ChangeHostRecordTTLps"></a> <span data-ttu-id="c6eab-234">Изменение параметра HostRecordTTL (с помощью Windows PowerShell)</span><span class="sxs-lookup"><span data-stu-id="c6eab-234">Change the HostRecordTTL (Using Windows PowerShell)</span></span>  
  
1.  <span data-ttu-id="c6eab-235">Откройте окно Powershell с помощью варианта **Запуск от имени администратора**.</span><span class="sxs-lookup"><span data-stu-id="c6eab-235">Open PowerShell window via **Run as Administrator**.</span></span>  
  
2.  <span data-ttu-id="c6eab-236">Импортируйте модуль FailoverClusters.</span><span class="sxs-lookup"><span data-stu-id="c6eab-236">Import the FailoverClusters module.</span></span>  
  
3.  <span data-ttu-id="c6eab-237">С помощью командлета `Get-ClusterResource` найдите ресурс сетевого имени, затем с помощью командлета `Set-ClusterParameter` задайте значение `HostRecordTTL` следующим образом:</span><span class="sxs-lookup"><span data-stu-id="c6eab-237">Use the `Get-ClusterResource` cmdlet to find the Network Name resource, then use `Set-ClusterParameter` cmdlet to set the `HostRecordTTL` value, as follows:</span></span>  
  
     <span data-ttu-id="c6eab-238">Get-ClusterResource " *\<NetworkResourceName>* " | Set-ClusterParameter HostRecordTTL *\<TimeInSeconds>*</span><span class="sxs-lookup"><span data-stu-id="c6eab-238">Get-ClusterResource "*\<NetworkResourceName>*" | Set-ClusterParameter HostRecordTTL *\<TimeInSeconds>*</span></span>  
  
     <span data-ttu-id="c6eab-239">В следующем примере для PowerShell задается значение HostRecordTTL в 300 секунд для сетевого ресурса сетевого имени «`SQL Network Name (SQL35)`».</span><span class="sxs-lookup"><span data-stu-id="c6eab-239">The following PowerShell example sets the HostRecordTTL to 300 seconds for a Network Name resource named "`SQL Network Name (SQL35)`".</span></span>  
  
    ```powershell
    Import-Module FailoverClusters  
  
    $nameResource = "SQL Network Name (SQL35)"  
    Get-ClusterResource $nameResource | Set-ClusterParameter ClusterParameter HostRecordTTL 300  
    ```  
  
    > [!TIP]  
    >  <span data-ttu-id="c6eab-240">Каждый раз при открытии нового окна Powershell нужно импортировать модуль `FailoverClusters`.</span><span class="sxs-lookup"><span data-stu-id="c6eab-240">Every time you open a new PowerShell window, you need to import the `FailoverClusters` module.</span></span>  
  
##### <a name="related-content-powershell"></a><span data-ttu-id="c6eab-241">См. также (PowerShell)</span><span class="sxs-lookup"><span data-stu-id="c6eab-241">Related Content (PowerShell)</span></span>  
  
-   <span data-ttu-id="c6eab-242">[Кластеризация и высокая доступность](https://techcommunity.microsoft.com/t5/failover-clustering/bg-p/FailoverClustering) (блог группы отказоустойчивой кластеризации и балансировки сетевой нагрузки)</span><span class="sxs-lookup"><span data-stu-id="c6eab-242">[Clustering and High-Availability](https://techcommunity.microsoft.com/t5/failover-clustering/bg-p/FailoverClustering) (Failover Clustering and Network Load Balancing Team Blog)</span></span>  
  
-   <span data-ttu-id="c6eab-243">[Приступая к работе с Windows PowerShell в отказоустойчивом кластере](https://technet.microsoft.com/library/ee619762\(WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="c6eab-243">[Getting Started with Windows PowerShell on a Failover Cluster](https://technet.microsoft.com/library/ee619762\(WS.10\).aspx)</span></span>  
  
-   [<span data-ttu-id="c6eab-244">Команды ресурса кластера и соответствующие командлеты Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="c6eab-244">Cluster resource commands and equivalent Windows PowerShell cmdlets</span></span>](https://msdn.microsoft.com/library/ee619744.aspx#BKMK_resource)  
  
###  <a name="related-content-windows-system"></a><a name="RelatedContentWS"></a> <span data-ttu-id="c6eab-245">См. также (система Windows)</span><span class="sxs-lookup"><span data-stu-id="c6eab-245">Related Content (Windows System)</span></span>  
  
-   <span data-ttu-id="c6eab-246">[Настройка параметров DNS для многосайтового отказоустойчивого кластера](https://technet.microsoft.com/library/dd197562\(WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="c6eab-246">[Configure DNS settings in a Multi-Site Failover Cluster](https://technet.microsoft.com/library/dd197562\(WS.10\).aspx)</span></span>  
  
-   [<span data-ttu-id="c6eab-247">Регистрация DNS в ресурсе сетевого имени</span><span class="sxs-lookup"><span data-stu-id="c6eab-247">DNS Registration with Network Name Resource</span></span>](https://techcommunity.microsoft.com/t5/failover-clustering/dns-registration-with-the-network-name-resource/ba-p/371482)  
  
-   [<span data-ttu-id="c6eab-248">Отказоустойчивые многосайтовые кластеры Windows 2008 R2</span><span class="sxs-lookup"><span data-stu-id="c6eab-248">Windows 2008 R2 Failover Multi-Site Clustering</span></span>](https://kiruba4u.blogspot.com/2012/03/failover-clustering-in-windows-server.html)  
  
##  <a name="sql-server-instance-prerequisites-and-restrictions"></a><a name="ServerInstance"></a> <span data-ttu-id="c6eab-249">Предварительные условия и ограничения для экземпляров SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6eab-249">SQL Server Instance Prerequisites and Restrictions</span></span>  
 <span data-ttu-id="c6eab-250">Каждой группе доступности требуется набор партнеров по обеспечению отработки отказа, известных как *реплики доступности*, которые расположены в экземплярах [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c6eab-250">Each availability group requires a set of failover partners, known as *availability replicas*, which are hosted by instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="c6eab-251">Данный экземпляр сервера может быть *изолированным экземпляром* или [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]*экземпляром отказоустойчивого кластера* .</span><span class="sxs-lookup"><span data-stu-id="c6eab-251">A given server instance can be a *stand-alone instance* or a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]*failover cluster instance* (FCI).</span></span>  
  
 
  
###  <a name="checklist-prerequisites-server-instance"></a><a name="PrerequisitesSI"></a> <span data-ttu-id="c6eab-252">Контрольный список. Предварительные условия (экземпляр сервера)</span><span class="sxs-lookup"><span data-stu-id="c6eab-252">Checklist: Prerequisites (Server Instance)</span></span>  
  
||<span data-ttu-id="c6eab-253">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="c6eab-253">Prerequisite</span></span>|<span data-ttu-id="c6eab-254">Ссылки</span><span class="sxs-lookup"><span data-stu-id="c6eab-254">Links</span></span>|  
|-|------------------|-----------|  
|<span data-ttu-id="c6eab-255">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-255">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-256">Главный компьютер должен являться узлом отказоустойчивой кластеризации Windows Server (WSFC).</span><span class="sxs-lookup"><span data-stu-id="c6eab-256">The host computer must be a Windows Server Failover Clustering (WSFC) node.</span></span> <span data-ttu-id="c6eab-257">Экземпляры [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , на которых размещаются реплики доступности для данной группы доступности, должны размещаться на отдельных узлах одного WSFC-кластера.</span><span class="sxs-lookup"><span data-stu-id="c6eab-257">The instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that host availability replicas for a given availability group must reside on separate nodes of a single WSFC cluster.</span></span> <span data-ttu-id="c6eab-258">Единственное исключение состоит в том, что при переносе в другой кластер WSFC группа доступности может временно находится в двух кластерах.</span><span class="sxs-lookup"><span data-stu-id="c6eab-258">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>|[<span data-ttu-id="c6eab-259">Отказоустойчивая кластеризация Windows Server (WSFC) с SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6eab-259">Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server</span></span>](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md)<br /><br /> [<span data-ttu-id="c6eab-260">Отказоустойчивая кластеризация и группы доступности AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="c6eab-260">Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](failover-clustering-and-always-on-availability-groups-sql-server.md)|  
|<span data-ttu-id="c6eab-261">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-261">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-262">Если необходима группа доступности для работы с Kerberos:</span><span class="sxs-lookup"><span data-stu-id="c6eab-262">If you want an availability group to work with Kerberos:</span></span><br /><br /> <span data-ttu-id="c6eab-263">Все экземпляры сервера, на которых размещена реплика доступности для группы доступности, должны использовать одинаковые учетные записи службы SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c6eab-263">All server instances that host an availability replica for the availability group must use the same SQL Server service account.</span></span><br /><br /> <span data-ttu-id="c6eab-264">Администратору домена необходимо вручную зарегистрировать имя участника-службы (SPN) с помощью службы каталогов Active Directory на учетной записи службы SQL Server для виртуального сетевого имени (VNN) прослушивателя группы доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-264">The domain administrator needs to manually register a Service Principal Name (SPN) with Active Directory on the SQL Server service account for the virtual network name (VNN) of the availability group listener.</span></span> <span data-ttu-id="c6eab-265">Если имя участника-службы (SPN) зарегистрировано на учетной записи, отличной от учетной записи службы SQL Server, то проверку подлинности пройти не удастся.</span><span class="sxs-lookup"><span data-stu-id="c6eab-265">If the SPN is registered on an account other than the SQL Server service account, authentication will fail.</span></span><br /><br /> <span data-ttu-id="c6eab-266">**\*\* Важно! \*\*** При изменении учетной записи службы SQL Server администратору домена необходимо вручную повторно зарегистрировать имя субъекта-службы (SPN).</span><span class="sxs-lookup"><span data-stu-id="c6eab-266">**\*\* Important \*\*** If you change the SQL Server service account, the domain administrator will need to manually re-register the SPN.</span></span>|[<span data-ttu-id="c6eab-267">Регистрация имя участника-службы для соединений Kerberos</span><span class="sxs-lookup"><span data-stu-id="c6eab-267">Register a Service Principal Name for Kerberos Connections</span></span>](../../configure-windows/register-a-service-principal-name-for-kerberos-connections.md)<br /><br /> <span data-ttu-id="c6eab-268">**Краткое описание:**</span><span class="sxs-lookup"><span data-stu-id="c6eab-268">**Brief explanation:**</span></span><br /><br /> <span data-ttu-id="c6eab-269">Kerberos и имена участников-служб обеспечивают взаимную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-269">Kerberos and SPNs enforce mutual authentication.</span></span> <span data-ttu-id="c6eab-270">Имя участника-службы (SPN) сопоставляется с учетной записью Windows, которая запускает службы SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c6eab-270">The SPN maps to the Windows account that starts the SQL Server services.</span></span> <span data-ttu-id="c6eab-271">Если регистрация имени участника-службы (SPN) не была выполнена должным образом или завершилась неудачно, уровень безопасности Windows не может определить учетную запись, связанную с именем участника-службы, и проверка подлинности Kerberos не может использоваться.</span><span class="sxs-lookup"><span data-stu-id="c6eab-271">If the SPN is not registered correctly or if it fails, the Windows security layer cannot determine the account associated with the SPN, and Kerberos authentication cannot be used.</span></span><br /><br /> <span data-ttu-id="c6eab-272">Примечание. NTLM не предъявляет таких требований.</span><span class="sxs-lookup"><span data-stu-id="c6eab-272">Note: NTLM does not have this requirement.</span></span>|  
|<span data-ttu-id="c6eab-273">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-273">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-274">Если вы планируете использовать экземпляр отказоустойчивого кластера [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для размещения реплики доступности, убедитесь, что понимаете ограничения, связанные с использованием отказоустойчивых кластеров, и что требования для создания такого кластера удовлетворены.</span><span class="sxs-lookup"><span data-stu-id="c6eab-274">If you plan to use a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI) to host an availability replica, ensure that you understand the FCI restrictions and that the FCI requirements are met.</span></span>|<span data-ttu-id="c6eab-275">[Необходимые условия и требования, связанные с использованием экземпляра отказоустойчивого кластера SQL Server для размещения реплики доступности](#FciArLimitations) (далее в этом разделе)</span><span class="sxs-lookup"><span data-stu-id="c6eab-275">[Prerequisites and Requirements on Using a SQL Server Failover Cluster Instance (FCI) to Host an Availability Replica](#FciArLimitations) (later in this topic)</span></span>|  
|<span data-ttu-id="c6eab-276">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-276">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-277">На каждом экземпляре сервера должен быть установлен выпуск [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]Enterprise Edition.</span><span class="sxs-lookup"><span data-stu-id="c6eab-277">Each server instance must be running the Enterprise Edition of [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span>|[<span data-ttu-id="c6eab-278">Возможности, поддерживаемые различными выпусками SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="c6eab-278">Features Supported by the Editions of SQL Server 2014</span></span>](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)|  
|<span data-ttu-id="c6eab-279">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-279">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-280">Все экземпляры сервера, на которых размещены реплики доступности для одной группы доступности, должны использовать одинаковые параметры сортировки [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c6eab-280">All the server instances that host availability replicas for an availability group must use the same [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] collation.</span></span>|[<span data-ttu-id="c6eab-281">Задание или изменение параметров сортировки сервера</span><span class="sxs-lookup"><span data-stu-id="c6eab-281">Set or Change the Server Collation</span></span>](../../../relational-databases/collations/set-or-change-the-server-collation.md)|  
|<span data-ttu-id="c6eab-282">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-282">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-283">Необходимо включить функцию [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] на каждом экземпляре сервера, на котором будет размещена реплика доступности для группы доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-283">Enable the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature on each server instance that will host an availability replica for any availability group.</span></span> <span data-ttu-id="c6eab-284">На одном компьютере можно включить столько экземпляров серверов, поддерживающих [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , сколько поддерживает установка [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c6eab-284">On a given computer, you can enable as many server instances for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] as your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] installation supports.</span></span>|[<span data-ttu-id="c6eab-285">Включение и отключение групп доступности AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-285">Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](enable-and-disable-always-on-availability-groups-sql-server.md)<br /><br /> <span data-ttu-id="c6eab-286">Важно. при удалении и повторном создании кластера WSFC необходимо отключить и повторно включить функцию на каждом экземпляре сервера, который был включен для \*\* \* в исходном кластере WSFC. \* \* \* \*\* [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]</span><span class="sxs-lookup"><span data-stu-id="c6eab-286">**\*\* Important \*\*** If you delete and re-create a WSFC cluster, you must disable and re-enable the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature on each server instance that was enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] on the original WSFC cluster.</span></span>|  
|<span data-ttu-id="c6eab-287">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-287">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-288">Каждый экземпляр сервера должен иметь конечную точку зеркального отображения базы данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-288">Each server instance requires a database mirroring endpoint.</span></span> <span data-ttu-id="c6eab-289">Обратите внимание, что эта конечная точка совместно используется всеми репликами доступности и участниками зеркального отображения базы данных на этом экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="c6eab-289">Note that this endpoint is shared by all the availability replicas and database mirroring partners and witnesses on the server instance.</span></span><br /><br /> <span data-ttu-id="c6eab-290">Если экземпляр сервера, выбранный для размещения реплики доступности, работает под доменной учетной записью и еще не содержит конечной точки зеркального отображения базы данных, то [мастер создания группы доступности](use-the-availability-group-wizard-sql-server-management-studio.md) (или [мастер добавления реплики в группу доступности](use-the-add-replica-to-availability-group-wizard-sql-server-management-studio.md)) может создать конечную точку и предоставить учетной записи службы экземпляра сервера разрешение CONNECT, если этот экземпляр запускается с учетной записью службы домена.</span><span class="sxs-lookup"><span data-stu-id="c6eab-290">If a server instance that you select to host an availability replica is running under a domain user account and does not yet have a database mirroring endpoint, the [New Availability Group Wizard](use-the-availability-group-wizard-sql-server-management-studio.md) (or [Add Replica to Availability Group Wizard](use-the-add-replica-to-availability-group-wizard-sql-server-management-studio.md)) can create the endpoint and grant CONNECT permission to the server instance service account.</span></span> <span data-ttu-id="c6eab-291">Но если служба [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] запущена от имени встроенной учетной записи, такой как «Локальная система», «Локальная служба» или «Сетевая служба», или от имени учетной записи, не входящей в домен, то для проверки подлинности конечных точек необходимо пользоваться сертификатами, а мастер не сможет создать точку зеркального отображения базы данных на этом экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="c6eab-291">However, if the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service is running as a built-in account, such as Local System, Local Service, or Network Service, or a nondomain account, you must use certificates for endpoint authentication, and the wizard will be unable to create a database mirroring endpoint on the server instance.</span></span> <span data-ttu-id="c6eab-292">В этом случае рекомендуется создавать конечные точки зеркального отображения базы данных вручную до запуска мастера.</span><span class="sxs-lookup"><span data-stu-id="c6eab-292">In this case, we recommend that you create the database mirroring endpoints manually before you launch the wizard.</span></span><br /><br /> <span data-ttu-id="c6eab-293">**\*\* Примечание по безопасности \*\*** . Механизм безопасности транспорта для [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] такой же, как и при зеркальном отображении базы данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-293">**\*\* Security Note \*\*** Transport security for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is the same as for database mirroring.</span></span>|[<span data-ttu-id="c6eab-294">Конечная точка зеркального отображения базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-294">The Database Mirroring Endpoint &#40;SQL Server&#41;</span></span>](../../database-mirroring/the-database-mirroring-endpoint-sql-server.md)<br /><br /> [<span data-ttu-id="c6eab-295">Безопасность транспорта для зеркального отображения базы данных и группы доступности AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="c6eab-295">Transport Security for Database Mirroring and AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md)|  
|<span data-ttu-id="c6eab-296">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-296">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-297">Если в группу доступности будут добавляться любые базы данных, использующие FILESTREAM, убедитесь, что функция FILESTREAM включена на каждом экземпляре сервера, на котором планируется разместить реплику доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-297">If any databases that use FILESTREAM will be added to an availability group, ensure that FILESTREAM is enabled on every server instance that will host an availability replica for the availability group.</span></span>|[<span data-ttu-id="c6eab-298">Включение и настройка FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="c6eab-298">Enable and Configure FILESTREAM</span></span>](../../../relational-databases/blob/enable-and-configure-filestream.md)|  
|<span data-ttu-id="c6eab-299">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-299">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-300">Если в группу доступности будут добавляться любые автономные базы данных, то убедитесь, что параметру сервера `contained database authentication` присвоено значение `1` на каждом экземпляре, где планируется разместить реплику доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-300">If any contained databases will be added to an availability group, ensure that the `contained database authentication` server option is set to `1` on every server instance that will host an availability replica for the availability group.</span></span>|[<span data-ttu-id="c6eab-301">Параметр конфигурации сервера «проверка подлинности автономной базы данных»</span><span class="sxs-lookup"><span data-stu-id="c6eab-301">contained database authentication Server Configuration Option</span></span>](../../configure-windows/contained-database-authentication-server-configuration-option.md)<br /><br /> [<span data-ttu-id="c6eab-302">Параметры конфигурации сервера (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-302">Server Configuration Options &#40;SQL Server&#41;</span></span>](../../configure-windows/server-configuration-options-sql-server.md)|  
  
###  <a name="thread-usage-by-availability-groups"></a><a name="ThreadUsage"></a> <span data-ttu-id="c6eab-303">Использование потока группами доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-303">Thread Usage by Availability Groups</span></span>  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="c6eab-304">предъявляет к рабочим потокам следующие требования.</span><span class="sxs-lookup"><span data-stu-id="c6eab-304">has the following requirements for worker threads:</span></span>  
  
-   <span data-ttu-id="c6eab-305">На простаивающем экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)][!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] используется 0 потоков.</span><span class="sxs-lookup"><span data-stu-id="c6eab-305">On an idle instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] uses 0 threads.</span></span>  
  
-   <span data-ttu-id="c6eab-306">Максимальное число потоков, используемых для групп доступности, — это заданный настройками параметр максимального числа потоков сервера («`max worker threads`») минус 40.</span><span class="sxs-lookup"><span data-stu-id="c6eab-306">The maximum number of threads used by availability groups is the configured setting for the maximum number of server threads ('`max worker threads`') minus 40.</span></span>  
  
-   <span data-ttu-id="c6eab-307">Реплики доступности, размещенные на конкретном экземпляре сервера, совместно используют один пул потоков.</span><span class="sxs-lookup"><span data-stu-id="c6eab-307">The availability replicas hosted on a given server instance share a single thread pool.</span></span>  
  
     <span data-ttu-id="c6eab-308">Потоки совместно используются по требованию следующим образом.</span><span class="sxs-lookup"><span data-stu-id="c6eab-308">Threads are shared on an on-demand basis, as follows:</span></span>  
  
    -   <span data-ttu-id="c6eab-309">Обычно имеется 3–10 общих потоков, но это число может возрасти в зависимости от рабочей нагрузки первичной реплики.</span><span class="sxs-lookup"><span data-stu-id="c6eab-309">Typically, there are 3-10 shared threads, but this number can increase depending on the primary replica workload.</span></span>  
  
    -   <span data-ttu-id="c6eab-310">Если заданный поток в течение определенного периода времени простаивает, то он возвращается в общий пул потоков [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c6eab-310">If a given thread is idle for a while, it is released back into the general [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] thread pool.</span></span> <span data-ttu-id="c6eab-311">Обычно неактивный поток освобождается примерно через 15 секунд неактивности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-311">Normally, an inactive thread is released after ~15 seconds of inactivity.</span></span> <span data-ttu-id="c6eab-312">Однако в зависимости от последней активности бездействующий поток может сохраняться дольше.</span><span class="sxs-lookup"><span data-stu-id="c6eab-312">However, depending on the last activity, an idle thread might be retained longer.</span></span>  
  
-   <span data-ttu-id="c6eab-313">Кроме того, группы доступности используют неразделенные потоки следующим образом.</span><span class="sxs-lookup"><span data-stu-id="c6eab-313">In addition, availability groups use unshared threads, as follows:</span></span>  
  
    -   <span data-ttu-id="c6eab-314">Каждая первичная реплика использует по одному потоку для записи журнала в каждой базе данных-источнике.</span><span class="sxs-lookup"><span data-stu-id="c6eab-314">Each primary replica uses 1 Log Capture thread for each primary database.</span></span> <span data-ttu-id="c6eab-315">Кроме того, она использует по одному потоку для отправки журнала в каждой из баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="c6eab-315">In addition, it uses 1 Log Send thread for each secondary database.</span></span> <span data-ttu-id="c6eab-316">Потоки отправки журнала освобождаются примерно через 15 секунд неактивности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-316">Log send threads are released after ~15 seconds of inactivity.</span></span>  
  
    -   <span data-ttu-id="c6eab-317">Для каждой из баз данных-получателей используется один поток повтора в каждой из баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="c6eab-317">Each secondary replica uses 1 redo thread for each secondary database.</span></span> <span data-ttu-id="c6eab-318">Потоки повтора освобождаются примерно через 15 секунд неактивности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-318">Redo threads are released after ~15 seconds of inactivity.</span></span>  
  
    -   <span data-ttu-id="c6eab-319">Резервное копирование на вторичной реплике удерживает поток на первичной реплике на время операции резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c6eab-319">A backup on a secondary replica holds a thread on the primary replica for the duration of the backup operation.</span></span>  
  
 <span data-ttu-id="c6eab-320">Дополнительные сведения см. в разделе [Обучающая серия AlwaysOn — HADRON: использование рабочего пула для баз данных с поддержкой HADRON](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx) (блог инженеров CSS [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="c6eab-320">For more information, see [AlwaysON - HADRON Learning Series: Worker Pool Usage for HADRON Enabled Databases](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx) (a CSS [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Engineers Blog).</span></span>  
  
###  <a name="permissions-server-instance"></a><a name="PermissionsSI"></a> <span data-ttu-id="c6eab-321">Разрешения (экземпляр сервера)</span><span class="sxs-lookup"><span data-stu-id="c6eab-321">Permissions (Server Instance)</span></span>  
  
|<span data-ttu-id="c6eab-322">Задача</span><span class="sxs-lookup"><span data-stu-id="c6eab-322">Task</span></span>|<span data-ttu-id="c6eab-323">Необходимые разрешения</span><span class="sxs-lookup"><span data-stu-id="c6eab-323">Required Permissions</span></span>|  
|----------|--------------------------|  
|<span data-ttu-id="c6eab-324">Создание конечной точки зеркального отображения базы данных</span><span class="sxs-lookup"><span data-stu-id="c6eab-324">Creating the database mirroring endpoint</span></span>|<span data-ttu-id="c6eab-325">Требуется разрешение CREATE ENDPOINT или членство в предопределенной роли сервера **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="c6eab-325">Requires CREATE ENDPOINT permission, or membership in the **sysadmin** fixed server role.</span></span>  <span data-ttu-id="c6eab-326">Также требуется разрешение CONTROL ON ENDPOINT.</span><span class="sxs-lookup"><span data-stu-id="c6eab-326">Also requires CONTROL ON ENDPOINT permission.</span></span> <span data-ttu-id="c6eab-327">Дополнительные сведения см. в разделе [GRANT, предоставление разрешений на конечную точку (Transact-SQL)](/sql/t-sql/statements/grant-endpoint-permissions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c6eab-327">For more information, see [GRANT Endpoint Permissions &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-endpoint-permissions-transact-sql).</span></span>|  
|<span data-ttu-id="c6eab-328">Включение [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]</span><span class="sxs-lookup"><span data-stu-id="c6eab-328">Enabling [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]</span></span>|<span data-ttu-id="c6eab-329">Требуется членство в группе **Администратор** на локальном компьютере и полный контроль над кластером WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-329">Requires membership in the **Administrator** group on the local computer and full control on the WSFC cluster.</span></span>|  
  
###  <a name="related-tasks-server-instance"></a><a name="RelatedTasksSI"></a> <span data-ttu-id="c6eab-330">Связанные задачи (экземпляр сервера)</span><span class="sxs-lookup"><span data-stu-id="c6eab-330">Related Tasks (Server Instance)</span></span>  
  
|<span data-ttu-id="c6eab-331">Задача</span><span class="sxs-lookup"><span data-stu-id="c6eab-331">Task</span></span>|<span data-ttu-id="c6eab-332">Раздел</span><span class="sxs-lookup"><span data-stu-id="c6eab-332">Topic</span></span>|  
|----------|-----------|  
|<span data-ttu-id="c6eab-333">Определение наличия конечной точки зеркального отображения базы данных</span><span class="sxs-lookup"><span data-stu-id="c6eab-333">Determining whether database mirroring endpoint exists</span></span>|[<span data-ttu-id="c6eab-334">sys.database_mirroring_endpoints (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c6eab-334">sys.database_mirroring_endpoints &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql)|  
|<span data-ttu-id="c6eab-335">Создание конечной точки зеркального отображения базы данных (если она еще не существует)</span><span class="sxs-lookup"><span data-stu-id="c6eab-335">Creating the database mirroring endpoint (if it does not yet exist)</span></span>|[<span data-ttu-id="c6eab-336">Создание конечной точки зеркального отображения базы данных с проверкой подлинности Windows (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c6eab-336">Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;</span></span>](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md)<br /><br /> [<span data-ttu-id="c6eab-337">Использование сертификатов для конечной точки зеркального отображения базы данных (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c6eab-337">Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;</span></span>](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md)<br /><br /> [<span data-ttu-id="c6eab-338">Создание конечной точки зеркального отображения базы данных для группы доступности AlwaysOn &#40;SQL Server PowerShell&#41;</span><span class="sxs-lookup"><span data-stu-id="c6eab-338">Create a Database Mirroring Endpoint for AlwaysOn Availability Groups &#40;SQL Server PowerShell&#41;</span></span>](database-mirroring-always-on-availability-groups-powershell.md)|  
|<span data-ttu-id="c6eab-339">Включение функции «Группы доступности AlwaysOn»</span><span class="sxs-lookup"><span data-stu-id="c6eab-339">Enabling AlwaysOn Availability Groups</span></span>|[<span data-ttu-id="c6eab-340">Включение и отключение групп доступности AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-340">Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](enable-and-disable-always-on-availability-groups-sql-server.md)|  
  
###  <a name="related-content-server-instance"></a><a name="RelatedContentSI"></a> <span data-ttu-id="c6eab-341">См. также (экземпляр сервера)</span><span class="sxs-lookup"><span data-stu-id="c6eab-341">Related Content (Server Instance)</span></span>  
  
-   [<span data-ttu-id="c6eab-342">Обучающая серия AlwaysON — HADRON. использование пулов рабочих потоков для баз данных с HADRON</span><span class="sxs-lookup"><span data-stu-id="c6eab-342">AlwaysON - HADRON Learning Series: Worker Pool Usage for HADRON Enabled Databases</span></span>](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx)  
  
##  <a name="network-connectivity-recommendations"></a><a name="NetworkConnect"></a> <span data-ttu-id="c6eab-343">Рекомендации по сетевым возможностям подключения</span><span class="sxs-lookup"><span data-stu-id="c6eab-343">Network Connectivity Recommendations</span></span>  
 <span data-ttu-id="c6eab-344">Настоятельно рекомендуется использовать одни и те же сетевые соединения для обмена данными между членами кластера WSFC и репликами доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-344">We strongly recommend that you use the same network links for communications between WSFC cluster members and communications between availability replicas.</span></span>  <span data-ttu-id="c6eab-345">Использование отдельных сетевых соединений может привести к непредвиденному поведению в случае отказа даже некоторых из них.</span><span class="sxs-lookup"><span data-stu-id="c6eab-345">Using separate network links can cause unexpected behaviors if some of links fail (even intermittently).</span></span>  
  
 <span data-ttu-id="c6eab-346">Например, чтобы группа доступности поддерживала автоматический переход на другой ресурс, вторичная реплика, которая является участником обработки отказа, должна находиться в состоянии SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="c6eab-346">For example, for an availability group to support automatic failover, the secondary replica that is the automatic-failover partner must be in the SYNCHRONIZED state.</span></span> <span data-ttu-id="c6eab-347">В случае отказа (даже временного) сетевого соединения с этой вторичной репликой она переходит в состояние UNSYNCHRONIZED и не может начать повторную синхронизацию до тех пор, пока соединение не будет восстановлено.</span><span class="sxs-lookup"><span data-stu-id="c6eab-347">If the network link to this secondary replica fails (even intermittently), the replica enters the UNSYNCHRONIZED state and cannot begin to resynchronize until the link is restored.</span></span> <span data-ttu-id="c6eab-348">Если кластер WSFC запрашивает автоматический переход на другой ресурс, пока вторичная реплика не синхронизирована, то автоматический переход на другой ресурс не выполняется.</span><span class="sxs-lookup"><span data-stu-id="c6eab-348">If the WSFC cluster requests an automatic failover while the secondary replica is unsynchronized, automatic failover will not occur.</span></span>  
  
##  <a name="client-connectivity-support"></a><a name="ClientConnSupport"></a> <span data-ttu-id="c6eab-349">Поддержка возможности подключения клиента</span><span class="sxs-lookup"><span data-stu-id="c6eab-349">Client Connectivity Support</span></span>  
 <span data-ttu-id="c6eab-350">Сведения о [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] поддержке подключения клиентов см. в разделе [подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c6eab-350">For information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] support for client connectivity, see [AlwaysOn Client Connectivity (SQL Server)](always-on-client-connectivity-sql-server.md).</span></span>  
  
##  <a name="prerequisites-and-restrictions-for-using-a-sql-server-failover-cluster-instance-fci-to-host-an-availability-replica"></a><a name="FciArLimitations"></a> <span data-ttu-id="c6eab-351">Предварительные условия и ограничения, связанные с использованием экземпляра отказоустойчивого кластера SQL Server для размещения реплики доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-351">Prerequisites and Restrictions for Using a SQL Server Failover Cluster Instance (FCI) to Host an Availability Replica</span></span>  
 
  
###  <a name="restrictions-fcis"></a><a name="RestrictionsFCI"></a> <span data-ttu-id="c6eab-352">Ограничения (экземпляры отказоустойчивого кластера)</span><span class="sxs-lookup"><span data-stu-id="c6eab-352">Restrictions (FCIs)</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c6eab-353">Начиная с версии [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], экземпляры отказоустойчивого кластера AlwaysOn поддерживают кластерные общие тома (CSV) как в [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)], так и в [!INCLUDE[win8srv](../../../includes/win8srv-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c6eab-353">Beginning in [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], AlwaysOn Failover Cluster Instances supports Clustered Shared Volumes (CSV) in both [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] and [!INCLUDE[win8srv](../../../includes/win8srv-md.md)].</span></span> <span data-ttu-id="c6eab-354">Дополнительные сведения о CSV-файле см. в разделе [Основные сведения о кластерных общих томах в отказоустойчивом кластере](https://technet.microsoft.com/library/dd759255.aspx).</span><span class="sxs-lookup"><span data-stu-id="c6eab-354">For more information on CSV, see [Understanding Cluster Shared Volumes in a Failover Cluster](https://technet.microsoft.com/library/dd759255.aspx).</span></span>  
  
-   <span data-ttu-id="c6eab-355">**На узле кластера FCI может быть размещена только одна реплика для одной группы доступности.**  При добавлении в FCI реплики доступности узлы кластера WSFC, которые являются возможными владельцами FCI, не могут содержать другую реплику той же группы доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-355">**The cluster nodes of an FCI can host only one replica for a given availability group:**  If you add an availability replica on an FCI, the WSFC cluster nodes that are possible FCI owners cannot host another replica for the same availability group.</span></span>  
  
     <span data-ttu-id="c6eab-356">Более того, каждая реплика должна быть размещена на экземпляре SQL Server 2012, который находится на отдельном узле WSFC того же кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-356">Furthermore, every other replica must be hosted by an instance of SQL Server 2012 that resides on a different WSFC node in the same WSFC cluster.</span></span> <span data-ttu-id="c6eab-357">Единственное исключение состоит в том, что при переносе в другой кластер WSFC группа доступности может временно находится в двух кластерах.</span><span class="sxs-lookup"><span data-stu-id="c6eab-357">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>  
  
-   <span data-ttu-id="c6eab-358">**FCI не поддерживают автоматическую отработку отказа группами доступности**.  Экземпляры FCI не поддерживают автоматический переход на другой ресурс с учетом групп доступности, поэтому любая реплика доступности, размещенная в них, должна быть настроена для перехода на другой ресурс вручную.</span><span class="sxs-lookup"><span data-stu-id="c6eab-358">**FCIs do not support automatic failover by availability groups:**  FCIs do not support automatic failover by availability groups, so any availability replica that is hosted by an FCI can be configured for manual failover only.</span></span>  
  
-   <span data-ttu-id="c6eab-359">**Изменение сетевого имени отказоустойчивого кластера FCI**.  Если необходимо изменить сетевое имя экземпляра FCI, в котором размещена реплика доступности, то сначала необходимо удалить эту реплику из группы доступности, а затем вернуть ее обратно в эту же группу доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-359">**Changing FCI network name:**  If you need to change the network name of an FCI that hosts an availability replica, you will need to remove the replica from its availability group and then add the replica back into the availability group.</span></span> <span data-ttu-id="c6eab-360">Удалить основную реплику нельзя, поэтому при переименовании экземпляра отказоустойчивого кластера, на котором размещена основная реплика, необходимо выполнить отработку отказа на вторичную реплику, удалить из группы доступности основную реплику и добавить ее снова.</span><span class="sxs-lookup"><span data-stu-id="c6eab-360">You cannot remove the primary replica, so if you are renaming an FCI that is hosting the primary replica, you should fail over to a secondary replica and then remove the former primary replica and add it back.</span></span> <span data-ttu-id="c6eab-361">Обратите внимание, что переименование FCI может привести к изменению URL-адреса конечной точки зеркального отображения базы данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-361">Note that renaming an FCI might alter the URL of its database mirroring endpoint.</span></span> <span data-ttu-id="c6eab-362">При добавлении реплики убедитесь, что указываете URL-адрес текущей конечной точки.</span><span class="sxs-lookup"><span data-stu-id="c6eab-362">When you add the replica ensure that you specify the current endpoint URL.</span></span>  
  
###  <a name="checklist-prerequisites-fcis"></a><a name="PrerequisitesFCI"></a> <span data-ttu-id="c6eab-363">Контрольный список. Предварительные условия (FCI)</span><span class="sxs-lookup"><span data-stu-id="c6eab-363">Checklist: Prerequisites (FCIs)</span></span>  
  
||<span data-ttu-id="c6eab-364">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="c6eab-364">Prerequisite</span></span>|<span data-ttu-id="c6eab-365">Ссылка</span><span class="sxs-lookup"><span data-stu-id="c6eab-365">Link</span></span>|  
|-|------------------|----------|  
|<span data-ttu-id="c6eab-366">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-366">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-367">Перед использованием экземпляра отказоустойчивого кластера для размещения реплики доступности убедитесь, что администратор системы установил исправление для Windows Server 2008, описанное в статье базы знаний KB 976097.</span><span class="sxs-lookup"><span data-stu-id="c6eab-367">Before you use an FCI to host an availability replica, ensure that your system administrator has installed the Windows Server 2008 hotfix described in Knowledge Base article KB 976097.</span></span> <span data-ttu-id="c6eab-368">Это исправление включает оснастку консоли управления (MMC) отказоустойчивого кластера для поддержки асимметричных общих дисков хранилища, доступных только на некоторых узлах WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-368">This hotfix enables the Failover Cluster Management Microsoft Management Console (MMC) snap-in to support asymmetric storage-shared disks that are available on only some of the WSFC nodes.</span></span>|<span data-ttu-id="c6eab-369">Статья базы знаний 976097: [Исправление, предназначенное для добавления функции поддержки асимметричных систем хранения данных в оснастку MMC управления отказоустойчивым кластером для отказоустойчивых кластеров под управлением ОС Windows Server 2008 или Windows Server 2008 R2](https://support.microsoft.com/kb/976097)</span><span class="sxs-lookup"><span data-stu-id="c6eab-369">KB 976097:  [Hotfix to add support for asymmetric storages to the Failover Cluster Management MMC snap-in for a failover cluster that is running Windows Server 2008 or Windows Server 2008 R2](https://support.microsoft.com/kb/976097)</span></span>|  
|<span data-ttu-id="c6eab-370">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-370">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-371">Убедитесь, что каждый экземпляр отказоустойчивого кластера SQL Server обладает требуемым пространством хранения, как и в случае со стандартным экземпляром отказоустойчивого кластера SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c6eab-371">Ensure that each SQL Server failover cluster instance (FCI) possesses the required shared storage as per standard SQL Server failover cluster instance installation.</span></span>||  
  
###  <a name="related-tasks-fcis"></a><a name="RelatedTasksFCIs"></a> <span data-ttu-id="c6eab-372">Связанные задачи (FCI)</span><span class="sxs-lookup"><span data-stu-id="c6eab-372">Related Tasks (FCIs)</span></span>  
  
|<span data-ttu-id="c6eab-373">Задача</span><span class="sxs-lookup"><span data-stu-id="c6eab-373">Task</span></span>|<span data-ttu-id="c6eab-374">Раздел</span><span class="sxs-lookup"><span data-stu-id="c6eab-374">Topic</span></span>|  
|----------|-----------|  
|<span data-ttu-id="c6eab-375">Установка отказоустойчивого кластера SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6eab-375">Installing a SQL Server Failover Cluster</span></span>|[<span data-ttu-id="c6eab-376">Создание отказоустойчивого кластера SQL Server (программа установки)</span><span class="sxs-lookup"><span data-stu-id="c6eab-376">Create a New SQL Server Failover Cluster &#40;Setup&#41;</span></span>](../../../sql-server/failover-clusters/install/create-a-new-sql-server-failover-cluster-setup.md)|  
|<span data-ttu-id="c6eab-377">Обновление существующего отказоустойчивого кластера SQL Server на месте</span><span class="sxs-lookup"><span data-stu-id="c6eab-377">In-place upgrade of your existing SQL Server Failover Cluster</span></span>|[<span data-ttu-id="c6eab-378">Обновление экземпляра отказоустойчивого кластера SQL Server (программа установки)</span><span class="sxs-lookup"><span data-stu-id="c6eab-378">Upgrade a SQL Server Failover Cluster Instance &#40;Setup&#41;</span></span>](../../../sql-server/failover-clusters/windows/upgrade-a-sql-server-failover-cluster-instance-setup.md)|  
|<span data-ttu-id="c6eab-379">Обслуживание существующего отказоустойчивого кластера SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6eab-379">Maintaining your existing SQL Server Failover Cluster</span></span>|[<span data-ttu-id="c6eab-380">Добавление или удаление узлов отказоустойчивого кластера SQL Server (программа установки)</span><span class="sxs-lookup"><span data-stu-id="c6eab-380">Add or Remove Nodes in a SQL Server Failover Cluster &#40;Setup&#41;</span></span>](../../../sql-server/failover-clusters/install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md)|  
  
###  <a name="related-content-fcis"></a><a name="RelatedContentFCIs"></a> <span data-ttu-id="c6eab-381">См. также (FCI)</span><span class="sxs-lookup"><span data-stu-id="c6eab-381">Related Content (FCIs)</span></span>  
  
-   [<span data-ttu-id="c6eab-382">Отказоустойчивая кластеризация и группы доступности AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="c6eab-382">Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](failover-clustering-and-always-on-availability-groups-sql-server.md)  
  
-   [<span data-ttu-id="c6eab-383">Руководство по архитектуре AlwaysOn. Построение решения для обеспечения высокого уровня доступности и аварийного восстановления с помощью экземпляров отказоустойчивого кластера и групп доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-383">AlwaysOn Architecture Guide: Building a High Availability and Disaster Recovery Solution by Using Failover Cluster Instances and Availability Groups</span></span>](https://technet.microsoft.com/library/jj215886.aspx)  
  
##  <a name="availability-group-prerequisites-and-restrictions"></a><a name="PrerequisitesForAGs"></a> <span data-ttu-id="c6eab-384">Обязательные условия и ограничения для группы доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-384">Availability Group Prerequisites and Restrictions</span></span>  

  
###  <a name="restrictions-availability-groups"></a><a name="RestrictionsAG"></a> <span data-ttu-id="c6eab-385">Ограничения (группы доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-385">Restrictions (Availability Groups)</span></span>  
  
-   <span data-ttu-id="c6eab-386">**Реплики доступности должны размещаться на разных узлах одного кластера WSFC.**  Для каждой группы доступности реплики доступности должны находиться на разных экземплярах сервера, работающих на разных узлах одного и того же кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-386">**Availability replicas must be hosted by different nodes of one WSFC cluster:**  For a given availability group, availability replicas must be hosted by server instances running on different nodes of the same WSFC cluster.</span></span> <span data-ttu-id="c6eab-387">Единственное исключение состоит в том, что при переносе в другой кластер WSFC группа доступности может временно находится в двух кластерах.</span><span class="sxs-lookup"><span data-stu-id="c6eab-387">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c6eab-388">На каждой виртуальной машине на одном физическом компьютере может размещаться реплика доступности для одной и той же группы доступности, так как каждая виртуальная машина работает как отдельный компьютер.</span><span class="sxs-lookup"><span data-stu-id="c6eab-388">Virtual machines on the same physical computer can each host an availability replica for the same availability group because each virtual machine acts as a separate computer.</span></span>  
  
-   <span data-ttu-id="c6eab-389">**Уникальное имя группы доступности.**  Имя каждой группы доступности должно быть уникальным в пределах кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-389">**Unique availability group name:**  Each availability group name must be unique on the WSFC cluster.</span></span> <span data-ttu-id="c6eab-390">Максимальная длина имени группы доступности составляет 128 символов.</span><span class="sxs-lookup"><span data-stu-id="c6eab-390">The maximum length for an availability group name is 128 characters.</span></span>  
  
-   <span data-ttu-id="c6eab-391">**Реплики доступности**.  Каждая группа доступности поддерживает одну первичную реплику и до восьми вторичных реплик.</span><span class="sxs-lookup"><span data-stu-id="c6eab-391">**Availability replicas:**  Each availability group supports one primary replica and up to eight secondary replicas.</span></span> <span data-ttu-id="c6eab-392">Все реплики могут выполняться в режиме асинхронной фиксации или до трех из них могут работать в режиме синхронной фиксации (одна первичная реплика с двумя синхронными вторичными репликами).</span><span class="sxs-lookup"><span data-stu-id="c6eab-392">All of the replicas can run under asynchronous-commit mode, or up to three of them can run under synchronous-commit mode (one primary replica with two synchronous secondary replicas).</span></span>  
  
-   <span data-ttu-id="c6eab-393">**Максимальное количество групп доступности и баз данных доступности на компьютер**. Фактическое количество баз данных и групп доступности, которые можно разместить на компьютере (физической или виртуальной машине), зависит от оборудования и загрузки, но строгого ограничения не существует.</span><span class="sxs-lookup"><span data-stu-id="c6eab-393">**Maximum number of availability groups and availability databases per computer:** The actual number of databases and availability groups you can put on a computer (VM or physical) depends on the hardware and workload, but there is no enforced limit.</span></span> <span data-ttu-id="c6eab-394">В корпорации Майкрософт проводились интенсивные испытания 10 групп доступности и 100 баз данных на один физический компьютер.</span><span class="sxs-lookup"><span data-stu-id="c6eab-394">Microsoft has extensively tested with 10 AGs and 100 DBs per physical machine.</span></span> <span data-ttu-id="c6eab-395">К символам перегрузки систем могут относиться, помимо прочего, исчерпание ресурса рабочего потока, увеличенное время ответа для системных представлений и динамических административных представлений AlwaysOn и/или остановка дампов системы диспетчера.</span><span class="sxs-lookup"><span data-stu-id="c6eab-395">Signs of overloaded systems can include, but are not limited to, worker thread exhaustion, slow response times for AlwaysOn system views and DMVs, and/or stalled dispatcher system dumps.</span></span> <span data-ttu-id="c6eab-396">Обязательно проведите тщательное тестирование среды с рабочей нагрузкой, чтобы убедиться, что система в состоянии обрабатывать пиковую нагрузку в рамках соглашений об уровне обслуживания приложений.</span><span class="sxs-lookup"><span data-stu-id="c6eab-396">Please make sure to thoroughly test your environment with a production-like workload to ensure it can handle peak workload capacity within your application SLAs.</span></span> <span data-ttu-id="c6eab-397">При рассмотрении соглашений об уровне обслуживания обязательно проверяйте нагрузку в условиях сбоя, а также ожидаемое время ответа.</span><span class="sxs-lookup"><span data-stu-id="c6eab-397">When considering SLAs be sure to consider load under failure conditions as well as expected response times.</span></span>  
  
-   <span data-ttu-id="c6eab-398">**Не используйте диспетчер отказоустойчивости кластеров для управления группами доступности:**</span><span class="sxs-lookup"><span data-stu-id="c6eab-398">**Do not use the Failover Cluster Manager to manipulate availability groups:**</span></span>  
  
     <span data-ttu-id="c6eab-399">Пример:</span><span class="sxs-lookup"><span data-stu-id="c6eab-399">For example:</span></span>  
  
    -   <span data-ttu-id="c6eab-400">Не изменяйте свойства групп доступности, такие как список возможных владельцев.</span><span class="sxs-lookup"><span data-stu-id="c6eab-400">Do not change any availability group properties, such as the possible owners.</span></span>  
  
    -   <span data-ttu-id="c6eab-401">Не используйте диспетчер отказоустойчивости кластеров для переключения групп доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-401">Do not use the Failover Cluster Manager to fail over availability groups.</span></span> <span data-ttu-id="c6eab-402">Необходимо использовать [!INCLUDE[tsql](../../../includes/tsql-md.md)] или среду [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c6eab-402">You must use [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span>  
  
###  <a name="prerequisites-availability-groups"></a><a name="RequirementsAG"></a> <span data-ttu-id="c6eab-403">Предварительные условия (группы доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-403">Prerequisites (Availability Groups)</span></span>  
 <span data-ttu-id="c6eab-404">При создании или повторной настройке конфигурации групп доступности обязательно следуйте описанным ниже требованиям.</span><span class="sxs-lookup"><span data-stu-id="c6eab-404">When creating or reconfiguring an availability group configuration, ensure that you adhere to the following requirements.</span></span>  
  
||<span data-ttu-id="c6eab-405">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="c6eab-405">Prerequisite</span></span>|<span data-ttu-id="c6eab-406">Описание</span><span class="sxs-lookup"><span data-stu-id="c6eab-406">Description</span></span>|  
|-|------------------|-----------------|  
|<span data-ttu-id="c6eab-407">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-407">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-408">Если вы планируете использовать экземпляр отказоустойчивого кластера [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для размещения реплики доступности, убедитесь, что понимаете ограничения, связанные с использованием отказоустойчивых кластеров, и что требования для создания такого кластера удовлетворены.</span><span class="sxs-lookup"><span data-stu-id="c6eab-408">If you plan to use a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI) to host an availability replica, ensure that you understand the FCI restrictions and that the FCI requirements are met.</span></span>|<span data-ttu-id="c6eab-409">[Предварительные условия и ограничения, связанные с использованием экземпляра отказоустойчивого кластера SQL Server для размещения реплики доступности](#FciArLimitations) (ранее в этом разделе)</span><span class="sxs-lookup"><span data-stu-id="c6eab-409">[Prerequisites and Restrictions for Using a SQL Server Failover Cluster Instance (FCI) to Host an Availability Replica](#FciArLimitations) (earlier in this topic)</span></span>|  
  
###  <a name="security-availability-groups"></a><a name="SecurityAG"></a> <span data-ttu-id="c6eab-410">Безопасность (группы доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-410">Security (Availability Groups)</span></span>  
  
-   <span data-ttu-id="c6eab-411">Параметры безопасности наследуются от отказоустойчивой кластеризации WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-411">Security is inherited from the Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="c6eab-412">Кластер WSFC обеспечивает два уровня безопасности пользователей на уровне детализации всех API-интерфейсов кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-412">WSFC provides two levels of user security at granularity of entire WSFC cluster APIs:</span></span>  
  
    -   <span data-ttu-id="c6eab-413">Доступ только для чтения.</span><span class="sxs-lookup"><span data-stu-id="c6eab-413">Read-only access</span></span>  
  
    -   <span data-ttu-id="c6eab-414">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="c6eab-414">Full control</span></span>  
  
         [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="c6eab-415">должен обладать всеми возможностями управления, поэтому использование [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] в экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] дает ему полный контроль над кластером WSFC (через идентификатор безопасности службы).</span><span class="sxs-lookup"><span data-stu-id="c6eab-415">needs full control, and enabling [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] on an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] gives it full control of the WSFC cluster (through Service SID).</span></span>  
  
         <span data-ttu-id="c6eab-416">Нельзя напрямую повышать или снижать уровень безопасности для экземпляра сервера средствами диспетчера отказоустойчивого кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="c6eab-416">You cannot directly add or remove security for a server instance in the WSFC Failover Cluster Manager.</span></span> <span data-ttu-id="c6eab-417">Для управления сеансами безопасности WSFC следует использовать диспетчер конфигураций [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] или эквивалент WMI из [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c6eab-417">To manage WSFC security sessions, use the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager or the WMI equivalent from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="c6eab-418">Каждый экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] должен иметь разрешения для доступа к реестру, кластеру и т. д.</span><span class="sxs-lookup"><span data-stu-id="c6eab-418">Each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must have permissions to access the registry, cluster, and soforth.</span></span>  
  
-   <span data-ttu-id="c6eab-419">Для подключений между экземплярами сервера, на которых размещаются реплики доступности [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , рекомендуется использовать шифрование.</span><span class="sxs-lookup"><span data-stu-id="c6eab-419">We recommend that you use encryption for connections between server instances that host [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] availability replicas.</span></span>  
  
#### <a name="permissions-availability-groups"></a><span data-ttu-id="c6eab-420">Разрешения (группы доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-420">Permissions (Availability Groups)</span></span>  
  
|<span data-ttu-id="c6eab-421">Задача</span><span class="sxs-lookup"><span data-stu-id="c6eab-421">Task</span></span>|<span data-ttu-id="c6eab-422">Необходимые разрешения</span><span class="sxs-lookup"><span data-stu-id="c6eab-422">Required Permissions</span></span>|  
|----------|--------------------------|  
|<span data-ttu-id="c6eab-423">Создание группы доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-423">Creating an availability group</span></span>|<span data-ttu-id="c6eab-424">Требуется членство в фиксированной роли сервера **sysadmin** и одно из разрешений: CREATE AVAILABILITY GROUP, ALTER ANY AVAILABILITY GROUP или CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="c6eab-424">Requires membership in the **sysadmin** fixed server role and either CREATE AVAILABILITY GROUP server permission, ALTER ANY AVAILABILITY GROUP permission, or CONTROL SERVER permission.</span></span>|  
|<span data-ttu-id="c6eab-425">Изменение группы доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-425">Altering an  availability group</span></span>|<span data-ttu-id="c6eab-426">Необходимо разрешение ALTER AVAILABILITY GROUP для группы доступности, разрешение CONTROL AVAILABILITY GROUP, разрешение ALTER ANY AVAILABILITY GROUP или разрешение CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="c6eab-426">Requires ALTER AVAILABILITY GROUP permission on the availability group, CONTROL AVAILABILITY GROUP permission, ALTER ANY AVAILABILITY GROUP permission, or CONTROL SERVER permission.</span></span><br /><br /> <span data-ttu-id="c6eab-427">Кроме того, для присоединения базы данных к группе доступности требуется членство в предопределенной роли базы данных **db_owner** .</span><span class="sxs-lookup"><span data-stu-id="c6eab-427">In addition, joining a database to an availability group requires membership in the **db_owner** fixed database role.</span></span>|  
|<span data-ttu-id="c6eab-428">Удаление группы доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-428">Dropping/deleting an availability group</span></span>|<span data-ttu-id="c6eab-429">Необходимо разрешение ALTER AVAILABILITY GROUP для группы доступности, разрешение CONTROL AVAILABILITY GROUP, разрешение ALTER ANY AVAILABILITY GROUP или разрешение CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="c6eab-429">Requires ALTER AVAILABILITY GROUP permission on the availability group, CONTROL AVAILABILITY GROUP permission, ALTER ANY AVAILABILITY GROUP permission, or CONTROL SERVER permission.</span></span> <span data-ttu-id="c6eab-430">Для удаления группы доступности, которая не размещена в локальной реплике, необходимо разрешение CONTROL SERVER или разрешение CONTROL на эту группу доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-430">To drop an availability group that is not hosted on the local replica location you need CONTROL SERVER permission or CONTROL permission on that Availability Group.</span></span>|  
  
###  <a name="related-tasks-availability-groups"></a><a name="RelatedTasksAGs"></a> <span data-ttu-id="c6eab-431">Связанные задачи (группы доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-431">Related Tasks (Availability Groups)</span></span>  
  
|<span data-ttu-id="c6eab-432">Задача</span><span class="sxs-lookup"><span data-stu-id="c6eab-432">Task</span></span>|<span data-ttu-id="c6eab-433">Раздел</span><span class="sxs-lookup"><span data-stu-id="c6eab-433">Topic</span></span>|  
|----------|-----------|  
|<span data-ttu-id="c6eab-434">Создание группы доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-434">Creating an availability group</span></span>|[<span data-ttu-id="c6eab-435">Использование группы доступности (мастер создания группы доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-435">Use the Availability Group (New Availability Group Wizard)</span></span>](use-the-availability-group-wizard-sql-server-management-studio.md)<br /><br /> [<span data-ttu-id="c6eab-436">Создание группы доступности (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c6eab-436">Create an Availability Group (Transact-SQL)</span></span>](create-an-availability-group-transact-sql.md)<br /><br /> [<span data-ttu-id="c6eab-437">Создание группы доступности (SQL Server PowerShell)</span><span class="sxs-lookup"><span data-stu-id="c6eab-437">Create an Availability Group (SQL Server PowerShell)</span></span>](../../../powershell/sql-server-powershell.md)<br /><br /> [<span data-ttu-id="c6eab-438">Укажите URL-адрес конечной точки при добавлении или изменении реплики доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-438">Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;</span></span>](specify-endpoint-url-adding-or-modifying-availability-replica.md)|  
|<span data-ttu-id="c6eab-439">Изменение числа реплик доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-439">Modifying the number of availability replicas</span></span>|[<span data-ttu-id="c6eab-440">Добавление вторичной реплики к группе доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-440">Add a Secondary Replica to an Availability Group &#40;SQL Server&#41;</span></span>](add-a-secondary-replica-to-an-availability-group-sql-server.md)<br /><br /> [<span data-ttu-id="c6eab-441">Присоединение вторичной реплики к группе доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-441">Join a Secondary Replica to an Availability Group &#40;SQL Server&#41;</span></span>](join-a-secondary-replica-to-an-availability-group-sql-server.md)<br /><br /> [<span data-ttu-id="c6eab-442">Удаление вторичной реплики из группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-442">Remove a Secondary Replica from an Availability Group &#40;SQL Server&#41;</span></span>](remove-a-secondary-replica-from-an-availability-group-sql-server.md)|  
|<span data-ttu-id="c6eab-443">Создание прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-443">Creating an  availability group listener</span></span>|[<span data-ttu-id="c6eab-444">Создание или настройка прослушивателя группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-444">Create or Configure an Availability Group Listener &#40;SQL Server&#41;</span></span>](create-or-configure-an-availability-group-listener-sql-server.md)|  
|<span data-ttu-id="c6eab-445">Удаление группы доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-445">Dropping an  availability group</span></span>|[<span data-ttu-id="c6eab-446">Удаление группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-446">Remove an Availability Group &#40;SQL Server&#41;</span></span>](remove-an-availability-group-sql-server.md)|  
  
##  <a name="availability-database-prerequisites-and-restrictions"></a><a name="PrerequisitesForDbs"></a> <span data-ttu-id="c6eab-447">Обязательные условия и ограничения для базы данных доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-447">Availability Database Prerequisites and Restrictions</span></span>  
 <span data-ttu-id="c6eab-448">Для добавления в группу доступности база данных должна соответствовать следующим предварительным условиям и ограничениям.</span><span class="sxs-lookup"><span data-stu-id="c6eab-448">To be eligible to be added to an availability group, a database must meet the following prerequisites and restrictions.</span></span>  
  
 
  
###  <a name="checklist-requirements-availability-databases"></a><a name="RequirementsDb"></a> <span data-ttu-id="c6eab-449">Контрольный список. Требования (базы данных доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-449">Checklist: Requirements (Availability Databases)</span></span>  
 <span data-ttu-id="c6eab-450">Для добавления в группу доступности база данных должна соответствовать следующим требованиям.</span><span class="sxs-lookup"><span data-stu-id="c6eab-450">To be eligible to be added to an availability group, a database must:</span></span>  
  
||<span data-ttu-id="c6eab-451">Требования</span><span class="sxs-lookup"><span data-stu-id="c6eab-451">Requirements</span></span>|<span data-ttu-id="c6eab-452">Ссылка</span><span class="sxs-lookup"><span data-stu-id="c6eab-452">Link</span></span>|  
|-|------------------|----------|  
|<span data-ttu-id="c6eab-453">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-453">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-454">Быть пользовательской базой данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-454">Be a user database.</span></span> <span data-ttu-id="c6eab-455">Системные базы данных не могут принадлежать к группе доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-455">System databases cannot belong to an availability group.</span></span>||  
|<span data-ttu-id="c6eab-456">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-456">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-457">Находиться на экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , на котором создана группа доступности, и быть доступной для экземпляра сервера.</span><span class="sxs-lookup"><span data-stu-id="c6eab-457">Reside on the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] where you create the availability group and be accessible to the server instance.</span></span>||  
|<span data-ttu-id="c6eab-458">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-458">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-459">Быть базой, доступной для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="c6eab-459">Be a read-write database.</span></span> <span data-ttu-id="c6eab-460">Базы данных только для чтения не могут быть добавлены в группу доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-460">Read-only databases cannot be added to an availability group.</span></span>|<span data-ttu-id="c6eab-461">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**is_read_only** = 0)</span><span class="sxs-lookup"><span data-stu-id="c6eab-461">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**is_read_only** = 0)</span></span>|  
|<span data-ttu-id="c6eab-462">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-462">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-463">Быть многопользовательской базой данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-463">Be a multi-user database.</span></span>|<span data-ttu-id="c6eab-464">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**user_access** = 0)</span><span class="sxs-lookup"><span data-stu-id="c6eab-464">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**user_access** = 0)</span></span>|  
|<span data-ttu-id="c6eab-465">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-465">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-466">Не использовать параметр AUTO_CLOSE.</span><span class="sxs-lookup"><span data-stu-id="c6eab-466">Not use AUTO_CLOSE.</span></span>|<span data-ttu-id="c6eab-467">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**is_auto_close_on** = 0)</span><span class="sxs-lookup"><span data-stu-id="c6eab-467">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**is_auto_close_on** = 0)</span></span>|  
|<span data-ttu-id="c6eab-468">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-468">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-469">Используйте модель полного восстановления (также известную как режим полного восстановления).</span><span class="sxs-lookup"><span data-stu-id="c6eab-469">Use the full recovery model (also known as, full recovery mode).</span></span>|<span data-ttu-id="c6eab-470">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**recovery_model** = 1)</span><span class="sxs-lookup"><span data-stu-id="c6eab-470">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**recovery_model** = 1)</span></span>|  
|<span data-ttu-id="c6eab-471">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-471">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-472">Необходима по крайней мере одна полная резервная копия базы данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-472">Possess at least one full database backup.</span></span><br /><br /> <span data-ttu-id="c6eab-473">Примечание. После установки базы данных в режим полного восстановления потребуется полная резервная копия для включения цепочки журналов полного восстановления.</span><span class="sxs-lookup"><span data-stu-id="c6eab-473">Note: After setting a database to full recovery mode, a full backup is required to initiate the full-recovery log chain.</span></span>|[<span data-ttu-id="c6eab-474">Создание полной резервной копии базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-474">Create a Full Database Backup &#40;SQL Server&#41;</span></span>](../../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md)|  
|<span data-ttu-id="c6eab-475">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-475">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-476">Не принадлежать ни к одной другой группе доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-476">Not belong to any existing availability group.</span></span>|<span data-ttu-id="c6eab-477">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**group_database_id** = NULL)</span><span class="sxs-lookup"><span data-stu-id="c6eab-477">[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**group_database_id** = NULL)</span></span>|  
|<span data-ttu-id="c6eab-478">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-478">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-479">Не быть настроенной для зеркального отображения базы данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-479">Not be configured for database mirroring.</span></span>|<span data-ttu-id="c6eab-480">[sys.database_mirroring](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql) (если база данных не участвует в зеркальном отображении, все столбцы с префиксом "mirroring_" имеют значение NULL)</span><span class="sxs-lookup"><span data-stu-id="c6eab-480">[sys.database_mirroring](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql) (If the database does not participate in mirroring, all columns prefixed with "mirroring_" are NULL.)</span></span>|  
|<span data-ttu-id="c6eab-481">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-481">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-482">Перед добавлением в группу доступности базы данных, в которой используется FILESTREAM, следует убедиться, что FILESTREAM поддерживается на всех экземплярах серверов, на которых размещены или будут размещены реплики доступности для группы доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-482">Before adding a database that uses FILESTREAM to an availability group, ensure that FILESTREAM is enabled on every server instance that hosts or will host an availability replica for the availability group.</span></span>|[<span data-ttu-id="c6eab-483">Включение и настройка FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="c6eab-483">Enable and Configure FILESTREAM</span></span>](../../../relational-databases/blob/enable-and-configure-filestream.md)|  
|<span data-ttu-id="c6eab-484">![Флажок](../../media/checkboxemptycenterxtraspacetopandright.gif "Флажок")</span><span class="sxs-lookup"><span data-stu-id="c6eab-484">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="c6eab-485">Перед добавлением автономной базы данных в группу доступности, убедитесь, что параметру сервера `contained database authentication` присвоено значение `1` на каждом экземпляре, на котором размещена или будет размещена реплика доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-485">Before adding a contained database to an availability group, ensure that the `contained database authentication` server option is set to `1` on every server instance that hosts or will host an availability replica for the availability group.</span></span>|[<span data-ttu-id="c6eab-486">Параметр конфигурации сервера «проверка подлинности автономной базы данных»</span><span class="sxs-lookup"><span data-stu-id="c6eab-486">contained database authentication Server Configuration Option</span></span>](../../configure-windows/contained-database-authentication-server-configuration-option.md)<br /><br /> [<span data-ttu-id="c6eab-487">Параметры конфигурации сервера (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-487">Server Configuration Options &#40;SQL Server&#41;</span></span>](../../configure-windows/server-configuration-options-sql-server.md)|  
  
> [!NOTE]  
>  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="c6eab-488">работает с любым поддерживаемым уровнем совместимости базы данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-488">works with any supported database compatibility level.</span></span>  
  
###  <a name="restrictions-availability-databases"></a><a name="RestrictionsDb"></a> <span data-ttu-id="c6eab-489">Ограничения (базы данных доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-489">Restrictions (Availability Databases)</span></span>  
  
-   <span data-ttu-id="c6eab-490">Если путь к файлу (в том числе буква диска) базы данных-получателя отличается от пути в соответствующей базе данных-источнике, применимы следующие ограничения.</span><span class="sxs-lookup"><span data-stu-id="c6eab-490">If the file path (including the drive letter) of a secondary database differs from the path of the corresponding primary database, the following restrictions apply:</span></span>  
  
    -   <span data-ttu-id="c6eab-491">**[!INCLUDE[ssAoNewAgWiz](../../../includes/ssaonewagwiz-md.md)]/[!INCLUDE[ssAoAddDbWiz](../../../includes/ssaoadddbwiz-md.md)]:**  Параметр **Полная** не поддерживается (на странице [Выбор начальной синхронизации данных](select-initial-data-synchronization-page-always-on-availability-group-wizards.md)).</span><span class="sxs-lookup"><span data-stu-id="c6eab-491">**[!INCLUDE[ssAoNewAgWiz](../../../includes/ssaonewagwiz-md.md)]/[!INCLUDE[ssAoAddDbWiz](../../../includes/ssaoadddbwiz-md.md)]:**  The **Full** option is not supported (on the[Select Initial Data Synchronization Page](select-initial-data-synchronization-page-always-on-availability-group-wizards.md) page),</span></span>  
  
    -   <span data-ttu-id="c6eab-492">**RESTORE WITH MOVE**:  для создания базы данных-получателя файлы базы данных должны иметь атрибут RESTORED WITH MOVE в каждом экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], в котором размещена вторичная реплика.</span><span class="sxs-lookup"><span data-stu-id="c6eab-492">**RESTORE WITH MOVE:**  To create the secondary databases, the database files must be RESTORED WITH MOVE on each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that hosts a secondary replica.</span></span>  
  
    -   <span data-ttu-id="c6eab-493">**Воздействие на операции добавления файлов**.  Операция добавления файлов, выполняемая позднее в первичной реплике, может завершиться неудачей в базах данных-получателях.</span><span class="sxs-lookup"><span data-stu-id="c6eab-493">**Impact on add-file operations:**  A later add-file operation on the primary replica might fail on the secondary databases.</span></span> <span data-ttu-id="c6eab-494">Эта ошибка может вызвать приостановку работы баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="c6eab-494">This failure could cause the secondary databases to be suspended.</span></span> <span data-ttu-id="c6eab-495">Это, в свою очередь, вызовет переход дополнительных реплик в состояние NOT SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="c6eab-495">This, in turn, causes the secondary replicas to enter the NOT SYNCHRONIZING state.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="c6eab-496">Дополнительные сведения об отсутствии отклика на неудачную операцию добавления файла см. в разделе [Устранение неполадок с операцией добавления файла, давшей сбой (группы доступности AlwaysOn)](troubleshoot-a-failed-add-file-operation-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="c6eab-496">For information about responding to a failed ad-file operation, see [Troubleshoot a Failed Add-File Operation &#40;AlwaysOn Availability Groups&#41;](troubleshoot-a-failed-add-file-operation-always-on-availability-groups.md).</span></span>  
  
-   <span data-ttu-id="c6eab-497">Нельзя удалить базу данных, которая принадлежит какой-либо группе доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-497">You cannot drop a database that currently belongs to an availability group.</span></span>  
  
###  <a name="follow-up-for-tde-protected-databases"></a><a name="TDEdbs"></a> <span data-ttu-id="c6eab-498">Дальнейшие действия для баз данных, защищаемых прозрачным шифрованием</span><span class="sxs-lookup"><span data-stu-id="c6eab-498">Follow Up for TDE Protected Databases</span></span>  
 <span data-ttu-id="c6eab-499">Если используется прозрачное шифрование данных (TDE), то сертификат или асимметричный ключ службы для создания и расшифровки других ключей должен быть одинаков на всех экземплярах сервера, где размещены реплики группы доступности.</span><span class="sxs-lookup"><span data-stu-id="c6eab-499">If you use transparent data encryption (TDE), the certificate or asymmetric key for creating and decrypting other keys must be the same on every server instance that hosts an availability replica for the availability group.</span></span> <span data-ttu-id="c6eab-500">Дополнительные сведения см. в разделе [Перемещение базы данных, защищаемой прозрачным шифрованием, в другой экземпляр SQL Server](../../../relational-databases/security/encryption/move-a-tde-protected-database-to-another-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c6eab-500">For more information, see [Move a TDE Protected Database to Another SQL Server](../../../relational-databases/security/encryption/move-a-tde-protected-database-to-another-sql-server.md).</span></span>  
  
###  <a name="permissions-availability-databases"></a><a name="PermissionsDbs"></a> <span data-ttu-id="c6eab-501">Разрешения (базы данных доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-501">Permissions (Availability Databases)</span></span>  
 <span data-ttu-id="c6eab-502">Необходимо разрешение ALTER на базу данных.</span><span class="sxs-lookup"><span data-stu-id="c6eab-502">Requires ALTER permission on the database.</span></span>  
  
###  <a name="related-tasks-availability-databases"></a><a name="RelatedTasksADb"></a> <span data-ttu-id="c6eab-503">Связанные задачи (базы данных доступности)</span><span class="sxs-lookup"><span data-stu-id="c6eab-503">Related Tasks (Availability Databases)</span></span>  
  
|<span data-ttu-id="c6eab-504">Задача</span><span class="sxs-lookup"><span data-stu-id="c6eab-504">Task</span></span>|<span data-ttu-id="c6eab-505">Раздел</span><span class="sxs-lookup"><span data-stu-id="c6eab-505">Topic</span></span>|  
|----------|-----------|  
|<span data-ttu-id="c6eab-506">Подготовка базы данных-получателя (вручную)</span><span class="sxs-lookup"><span data-stu-id="c6eab-506">Preparing a secondary database (manually)</span></span>|[<span data-ttu-id="c6eab-507">Подготовка базы данных-получателя для присоединения к группе доступности вручную (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-507">Manually Prepare a Secondary Database for an Availability Group &#40;SQL Server&#41;</span></span>](manually-prepare-a-secondary-database-for-an-availability-group-sql-server.md)|  
|<span data-ttu-id="c6eab-508">Присоединение базы данных-получателя к группе доступности (вручную)</span><span class="sxs-lookup"><span data-stu-id="c6eab-508">Joining a secondary database to availability group (manually)</span></span>|[<span data-ttu-id="c6eab-509">Присоединение базы данных-получателя к группе доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-509">Join a Secondary Database to an Availability Group &#40;SQL Server&#41;</span></span>](join-a-secondary-database-to-an-availability-group-sql-server.md)|  
|<span data-ttu-id="c6eab-510">Изменение числа баз данных доступности</span><span class="sxs-lookup"><span data-stu-id="c6eab-510">Modifying the number of availability databases</span></span>|[<span data-ttu-id="c6eab-511">Добавление базы данных в группу доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-511">Add a Database to an Availability Group &#40;SQL Server&#41;</span></span>](availability-group-add-a-database.md)<br /><br /> [<span data-ttu-id="c6eab-512">Удаление базы данных-получателя из группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-512">Remove a Secondary Database from an Availability Group &#40;SQL Server&#41;</span></span>](remove-a-secondary-database-from-an-availability-group-sql-server.md)<br /><br /> [<span data-ttu-id="c6eab-513">Удаление базы данных-источника из группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-513">Remove a Primary Database from an Availability Group &#40;SQL Server&#41;</span></span>](remove-a-primary-database-from-an-availability-group-sql-server.md)|  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="c6eab-514">См. также</span><span class="sxs-lookup"><span data-stu-id="c6eab-514">Related Content</span></span>  
  
-   [<span data-ttu-id="c6eab-515">Руководство по решениям режима AlwaysOn в Microsoft SQL Server для обеспечения высокой доступности и аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="c6eab-515">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="c6eab-516">Блог группы разработчиков SQL Server AlwaysOn: официальный блог группы разработчиков SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="c6eab-516">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
-   [<span data-ttu-id="c6eab-517">Обучающая серия AlwaysON — HADRON. использование пулов рабочих потоков для баз данных с HADRON</span><span class="sxs-lookup"><span data-stu-id="c6eab-517">AlwaysON - HADRON Learning Series: Worker Pool Usage for HADRON Enabled Databases</span></span>](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx)  
  
## <a name="see-also"></a><span data-ttu-id="c6eab-518">См. также:</span><span class="sxs-lookup"><span data-stu-id="c6eab-518">See Also</span></span>  
 <span data-ttu-id="c6eab-519">[Общие сведения о группы доступности AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="c6eab-519">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="c6eab-520">[Отказоустойчивая кластеризация и группы доступности AlwaysOn &#40;SQL Server&#41;](failover-clustering-and-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="c6eab-520">[Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;](failover-clustering-and-always-on-availability-groups-sql-server.md) </span></span>  
 [<span data-ttu-id="c6eab-521">Подключение клиента AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c6eab-521">AlwaysOn Client Connectivity (SQL Server)</span></span>](always-on-client-connectivity-sql-server.md)  
  
  
