---
title: Создание или настройка прослушивателя группы доступности (SQL Server) | Документы Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
f1_keywords:
- sql12.swb.availabilitygroup.newaglistener.general.f1
helpviewer_keywords:
- Availability Groups [SQL Server], listeners
- Availability Groups [SQL Server], client connectivity
ms.assetid: 2bc294f6-2312-4b6b-9478-2fb8a656e645
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2c74e92286eab4bc1be8f3f538d83d86f056cf01
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87752348"
---
# <a name="create-or-configure-an-availability-group-listener-sql-server"></a><span data-ttu-id="6a7ea-102">Создание или настройка прослушивателя группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-102">Create or Configure an Availability Group Listener (SQL Server)</span></span>
  <span data-ttu-id="6a7ea-103">В этом разделе описывается создание или настройка одного *прослушивателя группы* доступности для группы доступности AlwaysOn с помощью среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] , [!INCLUDE[tsql](../../../includes/tsql-md.md)] или PowerShell в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-103">This topic describes how to create or configure a single *availability group listener* for an AlwaysOn availability group by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or PowerShell in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6a7ea-104">Для создания прослушивателя первой группы доступности настоятельно рекомендуется использовать [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]или Powershell [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-104">To create the first availability group listener of an availability group, we strongly recommend that you [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] PowerShell.</span></span> <span data-ttu-id="6a7ea-105">Старайтесь не создавать прослушиватель непосредственно в кластере WSFC, кроме случаев, когда необходимо, например, создать дополнительный прослушиватель.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-105">Avoid creating a listener directly in the WSFC cluster except when necessary, for example, to create an additional listener.</span></span>  
  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="6a7ea-106">Перед началом</span><span class="sxs-lookup"><span data-stu-id="6a7ea-106">Before You Begin</span></span>  
  
###  <a name="does-a-listener-exist-for-this-availability-group-already"></a><a name="DoesListenerExist"></a> <span data-ttu-id="6a7ea-107">Существует ли прослушиватель для этой группы доступности?</span><span class="sxs-lookup"><span data-stu-id="6a7ea-107">Does a Listener Exist for this Availability Group Already?</span></span>  
 <span data-ttu-id="6a7ea-108">**Определение наличия прослушивателя для группы доступности**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-108">**To determine whether a listener already exists for the availability group**</span></span>  
  
-   [<span data-ttu-id="6a7ea-109">Просмотр свойств прослушивателя группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-109">View Availability Group Listener Properties &#40;SQL Server&#41;</span></span>](view-availability-group-listener-properties-sql-server.md)  
  
> [!NOTE]  
>  <span data-ttu-id="6a7ea-110">Если прослушиватель уже существует и нужно создать дополнительный прослушиватель, см. подраздел [Создание дополнительного прослушивателя группы доступности (необязательно)](#CreateAdditionalListener)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-110">If a listener already exists and you want to create an additional listener, see [To Create An Additional Listener for an Availability Group (Optional)](#CreateAdditionalListener), later in this topic.</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="6a7ea-111">Ограничения</span><span class="sxs-lookup"><span data-stu-id="6a7ea-111">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="6a7ea-112">С помощью [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]вы можете создать только один прослушиватель для каждой группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-112">You can create only one listener per availability group through [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6a7ea-113">Обычно для каждой группы доступности требуется только один прослушиватель.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-113">Typically, each availability group requires only one listener.</span></span> <span data-ttu-id="6a7ea-114">Однако в некоторых сценариях клиента требуется несколько прослушивателей на одну группу доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-114">However, some customer scenarios require multiple listeners for one availability group.</span></span>   <span data-ttu-id="6a7ea-115">После создания прослушивателя посредством SQL Server для создания дополнительных прослушивателей можно использовать Windows PowerShell для отказоустойчивых кластеров или диспетчер кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-115">After creating a listener through SQL Server, you can use Windows PowerShell for failover clusters or the WSFC Failover Cluster Manager to create additional listeners.</span></span> <span data-ttu-id="6a7ea-116">Дополнительные сведения см. в подразделе [Создание дополнительного прослушивателя для группы доступности (необязательно)](#CreateAdditionalListener)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-116">For more information, see [To Create An Additional Listener for an Availability Group (Optional)](#CreateAdditionalListener), later in this topic.</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="6a7ea-117">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="6a7ea-117">Recommendations</span></span>  
 <span data-ttu-id="6a7ea-118">Для конфигураций с несколькими подсетями рекомендуется статический IP-адрес (но это не обязательно).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-118">Using a static IP address is recommended, although not required, for multiple subnet configurations.</span></span>  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="6a7ea-119">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="6a7ea-119">Prerequisites</span></span>  
  
-   <span data-ttu-id="6a7ea-120">Необходимо подключиться к экземпляру сервера, на котором размещена первичная реплика.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-120">You must be connected to the server instance that hosts the primary replica.</span></span>  
  
-   <span data-ttu-id="6a7ea-121">Если при настройке прослушивателя группы доступности для нескольких подсетей планируется использование статических IP-адресов, то необходимо получить статический IP-адрес каждой подсети, где размещена реплика доступности для группы доступности, для которой создается прослушиватель.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-121">If you are setting up an availability group listener across multiple subnets and plan to use static IP addresses, you need to get the static IP address of every subnet that hosts an availability replica for the availability group for which you are creating the listener.</span></span> <span data-ttu-id="6a7ea-122">Обычно статические IP-адреса можно запросить у сетевого администратора.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-122">Usually, you will need to ask your network administrators for the static IP addresses.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6a7ea-123">Перед созданием первого прослушивателя настоятельно рекомендуется прочитать раздел [Подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-123">Before you create your first listener, we strongly recommend that you read [AlwaysOn Client Connectivity &#40;SQL Server&#41;](always-on-client-connectivity-sql-server.md).</span></span>  
  
###  <a name="requirements-for-the-dns-name-of-an-availability-group-listener"></a><a name="DNSnameReqs"></a> <span data-ttu-id="6a7ea-124">Требования к имени DNS прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-124">Requirements for the DNS Name of an Availability Group Listener</span></span>  
 <span data-ttu-id="6a7ea-125">Для каждого прослушивателя группы доступности необходимо имя DNS-узла, уникальное в домене и в NetBIOS.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-125">Each availability group listener requires a DNS host name that is unique in the domain and in NetBIOS.</span></span> <span data-ttu-id="6a7ea-126">Имя DNS является значением типа string.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-126">The DNS name is a string value.</span></span> <span data-ttu-id="6a7ea-127">Это имя может содержать только буквы, цифры, дефисы (-) и знаки подчеркивания (_) в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-127">This name can contain only alphanumeric characters, dashes (-), and hyphens (_), in any order.</span></span> <span data-ttu-id="6a7ea-128">В именах узлов DNS учитывается регистр.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-128">DNS host names are case insensitive.</span></span> <span data-ttu-id="6a7ea-129">Максимальная длина составляет 63 символа, однако в среде [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]можно указать длину не более 15 символов.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-129">The maximum length is 63 characters, however, in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], the maximum length you can specify is 15 characters.</span></span>  
  
 <span data-ttu-id="6a7ea-130">Мы рекомендуем указывать строку, которая поддается толкованию.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-130">We recommend that you specify a meaningful string.</span></span> <span data-ttu-id="6a7ea-131">Например, для группы доступности с именем `AG1`понятным именем узла DNS будет `ag1-listener`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-131">For example, for an availability group named `AG1`, a meaningful DNS host name would be `ag1-listener`.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6a7ea-132">NetBIOS распознает только первые 15 символов в dns_name.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-132">NetBIOS recognizes only the first 15 chars in the dns_name.</span></span> <span data-ttu-id="6a7ea-133">При наличии двух кластеров WSFC, которые управляются одной службой Active Directory, и попытке создать в обоих кластерах прослушивателей группы доступности с именами, содержащими более 15 символов, и одинаковым префиксом из 15 символов возникнет ошибка, указывающая, что не удалось подключиться к ресурсу с именем виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-133">If you have two WSFC clusters that are controlled by the same Active Directory and you try to create availability group listeners in both of clusters using names with more than 15 characters and an identical 15 character prefix, you will get an error reporting that the Virtual Network Name resource could not be brought online.</span></span> <span data-ttu-id="6a7ea-134">Дополнительные сведения о правилах именования префиксов для имен DNS см. в разделе [Присвоение имен доменов](https://technet.microsoft.com/library/cc731265\(WS.10\).aspx).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-134">For information about prefix naming rules for DNS names, see [Assigning Domain Names](https://technet.microsoft.com/library/cc731265\(WS.10\).aspx).</span></span>  
  
###  <a name="windows-permissions"></a><a name="WinPermissions"></a> <span data-ttu-id="6a7ea-135">Разрешения Windows</span><span class="sxs-lookup"><span data-stu-id="6a7ea-135">Windows Permissions</span></span>  
  
|<span data-ttu-id="6a7ea-136">Разрешения</span><span class="sxs-lookup"><span data-stu-id="6a7ea-136">Permissions</span></span>|<span data-ttu-id="6a7ea-137">Ссылка</span><span class="sxs-lookup"><span data-stu-id="6a7ea-137">Link</span></span>|  
|-----------------|----------|  
|<span data-ttu-id="6a7ea-138">Объект имени кластера WSFC (CNO), на котором размещается группа доступности, должен иметь разрешение **Создание объектов компьютера** .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-138">The cluster object name (CNO) of WSFC cluster that is hosting the availability group must have **Create Computer objects** permission.</span></span><br /><br /> <span data-ttu-id="6a7ea-139">В Active Directory объект CNO по умолчанию не имеет явного разрешения **Создание объектов компьютера** и может создать 10 виртуальных объектов-компьютеров (VCO).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-139">In Active Directory, a CNO by default does not have **Create Computer objects** permission explicitly and can create 10 virtual computer objects (VCOs).</span></span> <span data-ttu-id="6a7ea-140">После того как сформированы 10 виртуальных объектов-компьютеров, создание дополнительных объектов VCO завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-140">After 10 VCOs are created, the creation of additional VCOs will fail.</span></span> <span data-ttu-id="6a7ea-141">Этого можно избежать, явно предоставив разрешение объекту CNO кластера WSFC.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-141">You can avoid this by granting the permission explicitly to the WSFC cluster's CNO.</span></span> <span data-ttu-id="6a7ea-142">Обратите внимание, что виртуальные объекты-компьютеры для удаленных групп доступности не удаляются автоматически в Active Directory и засчитываются в счет ограничения в 10 объектов VCO, если они не удалены вручную.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-142">Note that VCOs for availability groups that you have deleted are not automatically deleted in Active Directory and count against your 10 VCO default limit unless they are manually deleted.</span></span><br /><br /> <span data-ttu-id="6a7ea-143">Примечание. В некоторых организациях политика безопасности запрещает предоставлять разрешение **Создание объектов компьютера** отдельным учетным записям пользователей.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-143">Note: In some organizations, the security policy prohibits granting **Create Computer objects** permission to individual user accounts.</span></span>|<span data-ttu-id="6a7ea-144">*Действия по настройке учетной записи для лица, которое устанавливает кластер* в разделе [Пошаговое руководство по отказоустойчивому кластеру. Настройка учетных записей в Active Directory](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx#BKMK_steps_installer)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-144">*Steps for configuring the account for the person who installs the cluster* in [Failover Cluster Step-by-Step Guide: Configuring Accounts in Active Directory](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx#BKMK_steps_installer)</span></span><br /><br /> <span data-ttu-id="6a7ea-145">*Действия по предварительной настройке учетной записи имени кластера* в разделе [Пошаговое руководство по отказоустойчивому кластеру. Настройка учетных записей в Active Directory](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx#BKMK_steps_precreating)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-145">*Steps for prestaging the cluster name account* in [Failover Cluster Step-by-Step Guide: Configuring Accounts in Active Directory](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx#BKMK_steps_precreating)</span></span>|  
|<span data-ttu-id="6a7ea-146">Если политика организации требует предварительно настроить учетную запись компьютера для виртуального сетевого имени прослушивателя, потребуется членство в группе **Account Operator** или помощь администратора домена.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-146">If your organization requires that you prestage the computer account for a listener virtual network name, you will need membership in the **Account Operator** group or your domain administrator's assistance.</span></span><br /><br /> <span data-ttu-id="6a7ea-147">Совет. Как правило, проще всего не выполнять предварительную настройку учетной записи для виртуального сетевого имени прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-147">Tip: Generally, it is simplest not to prestage the computer account for a listener virtual network name.</span></span> <span data-ttu-id="6a7ea-148">Если это возможно, пусть учетная запись будет создана и настроена автоматически при запуске мастера высокого уровня доступности WSFC.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-148">If you can, let the account to be created and configured automatically when you run the WSFC High Availability wizard.</span></span>|<span data-ttu-id="6a7ea-149">*Шаги по предварительной настройке учетной записи для кластеризованной службы или приложения* в учебнике [Пошаговое руководство по отказоустойчивому кластеру. Настройка учетных записей в Active Directory](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx#BKMK_steps_precreating2)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-149">*Steps for prestaging an account for a clustered service or application* in [Failover Cluster Step-by-Step Guide: Configuring Accounts in Active Directory](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx#BKMK_steps_precreating2).</span></span>|  
  
###  <a name="sql-server-permissions"></a><a name="SqlPermissions"></a> <span data-ttu-id="6a7ea-150">Разрешения SQL Server</span><span class="sxs-lookup"><span data-stu-id="6a7ea-150">SQL Server Permissions</span></span>  
  
|<span data-ttu-id="6a7ea-151">Задача</span><span class="sxs-lookup"><span data-stu-id="6a7ea-151">Task</span></span>|<span data-ttu-id="6a7ea-152">Разрешения</span><span class="sxs-lookup"><span data-stu-id="6a7ea-152">Permissions</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="6a7ea-153">Создание прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-153">To create an availability group listener</span></span>|<span data-ttu-id="6a7ea-154">Требуется членство в фиксированной роли сервера **sysadmin** и одно из разрешений: CREATE AVAILABILITY GROUP, ALTER ANY AVAILABILITY GROUP или CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-154">Requires membership in the **sysadmin** fixed server role and either CREATE AVAILABILITY GROUP server permission, ALTER ANY AVAILABILITY GROUP permission, or CONTROL SERVER permission.</span></span>|  
|<span data-ttu-id="6a7ea-155">Изменение существующего прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-155">To modify an existing availability group listener</span></span>|<span data-ttu-id="6a7ea-156">Необходимо разрешение ALTER AVAILABILITY GROUP для группы доступности, разрешение CONTROL AVAILABILITY GROUP, разрешение ALTER ANY AVAILABILITY GROUP или разрешение CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-156">Requires ALTER AVAILABILITY GROUP permission on the availability group, CONTROL AVAILABILITY GROUP permission, ALTER ANY AVAILABILITY GROUP permission, or CONTROL SERVER permission.</span></span>|  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="6a7ea-157">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6a7ea-157">Using SQL Server Management Studio</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="6a7ea-158">[Мастер создания группы доступности](use-the-new-availability-group-dialog-box-sql-server-management-studio.md) поддерживает создание прослушивателя для новой группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-158">The [New Availability Group wizard](use-the-new-availability-group-dialog-box-sql-server-management-studio.md) supports creation of the listener for a new availability group.</span></span>  
  
 <span data-ttu-id="6a7ea-159">**Создание или настройка прослушивателя группы доступности**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-159">**To create or configure an availability group listener**</span></span>  
  
1.  <span data-ttu-id="6a7ea-160">В обозревателе объектов подключитесь к экземпляру сервера, на котором размещена первичная реплика группы доступности, и щелкните имя сервера, чтобы развернуть дерево сервера.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-160">In Object Explorer, connect to the server instance that hosts the primary replica of the availability group, and click the server name to expand the server tree.</span></span>  
  
2.  <span data-ttu-id="6a7ea-161">Разверните узел **Высокий уровень доступности AlwaysOn** и узел **Группы доступности** .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-161">Expand the **AlwaysOn High Availability** node and the **Availability Groups** node.</span></span>  
  
3.  <span data-ttu-id="6a7ea-162">Щелкните группу доступности, для которой нужно настроить прослушиватель, и выберите одну из следующих альтернатив.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-162">Click the availability group whose listener you want to configure, and choose one of the following alternatives:</span></span>  
  
    -   <span data-ttu-id="6a7ea-163">Чтобы создать прослушиватель, щелкните правой кнопкой мыши узел **Прослушиватели группы доступности** и выберите команду **Создать прослушиватель** .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-163">To create a listener, right-click the **Availability group Listeners** node, and select the **New Listener** command.</span></span> <span data-ttu-id="6a7ea-164">Откроется диалоговое окно **Создать прослушиватель группы доступности** .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-164">This opens the **New Availability Group Listener** dialog box.</span></span> <span data-ttu-id="6a7ea-165">Дополнительные сведения см. в подразделе [Добавление прослушивателя группы доступности (диалоговое окно)](#AddAgListenerDialog)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-165">For more information, see [Add Availability Group Listener (Dialog Box)](#AddAgListenerDialog), later in this topic.</span></span>  
  
    -   <span data-ttu-id="6a7ea-166">Чтобы изменить номер порта существующего прослушивателя, разверните узел **Прослушиватели группы доступности** , щелкните правой кнопкой мыши прослушиватель и выберите пункт **Свойства** .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-166">To change the port number of an existing listener, expand the **Availability group Listeners** node, right-click the listener, and select the **Properties** command.</span></span> <span data-ttu-id="6a7ea-167">Введите новый номер порта в поле **Порт** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-167">Enter the new port number into the **Port** field, and click **OK**.</span></span>  
  
###  <a name="new-availability-group-listener-dialog-box"></a><a name="AddAgListenerDialog"></a> <span data-ttu-id="6a7ea-168">Создание прослушивателя группы доступности (диалоговое окно)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-168">New Availability Group Listener (Dialog Box)</span></span>  
 <span data-ttu-id="6a7ea-169">**DNS-имя прослушивателя**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-169">**Listener DNS Name**</span></span>  
 <span data-ttu-id="6a7ea-170">Указывает имя узла DNS для прослушивателя группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-170">Specifies the DNS host name of the availability group listener.</span></span> <span data-ttu-id="6a7ea-171">Имя DNS является строкой и должно быть уникальным в домене и в NetBIOS.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-171">The DNS name is a string  must be unique in the domain and in NetBIOS.</span></span> <span data-ttu-id="6a7ea-172">Это имя может содержать только буквы, цифры, дефисы (-) и знаки подчеркивания (_) в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-172">This name can contain only alphanumeric characters, dashes (-), and hyphens (_), in any order.</span></span> <span data-ttu-id="6a7ea-173">В именах узлов DNS учитывается регистр.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-173">DNS host names are case insensitive.</span></span> <span data-ttu-id="6a7ea-174">Максимальная длина составляет 15 символов.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-174">The maximum length is 15 characters.</span></span>  
  
 <span data-ttu-id="6a7ea-175">Дополнительные сведения см. в подразделе [Требования к имени DNS прослушивателя группы доступности](#DNSnameReqs)выше в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-175">For more information, see [Requirements for the DNS Name of an Availability Group Listener](#DNSnameReqs), earlier in this topic.</span></span>  
  
 <span data-ttu-id="6a7ea-176">**порт**.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-176">**Port**</span></span>  
 <span data-ttu-id="6a7ea-177">TPC-порт, используемый этим прослушивателем.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-177">The TPC port used by this listener.</span></span>  
  
 <span data-ttu-id="6a7ea-178">**Сетевой режим**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-178">**Network Mode**</span></span>  
 <span data-ttu-id="6a7ea-179">Указывает TCP-протокол, используемый прослушивателем, один из:</span><span class="sxs-lookup"><span data-stu-id="6a7ea-179">Indicates the TCP protocol used by the listener, one of:</span></span>  
  
 <span data-ttu-id="6a7ea-180">**DHCP**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-180">**DHCP**</span></span>  
 <span data-ttu-id="6a7ea-181">Прослушиватель будет использовать динамический IP-адрес, назначенный сервером, на котором запущен DHCP-протокол.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-181">The listener will us a dynamic IP address that is assigned by a server running the Dynamic Host Configuration Protocol (DHCP).</span></span> <span data-ttu-id="6a7ea-182">Протокол DHCP ограничен одной подсетью.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-182">DHCP is limited to a single subnet.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6a7ea-183">Использовать протокол DHCP в производственной среде не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-183">We do not recommend DHCP in production environment.</span></span> <span data-ttu-id="6a7ea-184">Если во время простоя аренда IP-адреса протокола DHCP истечет, то на регистрацию нового сетевого IP-адреса протокола DHCP, связанного с именем DNS-прослушивателя, уйдет дополнительное время, что скажется на производительности клиента.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-184">If there is a down time and the DHCP IP lease expires, extra time is required to register the new DHCP network IP address that is associated with the listener DNS name and impact the client connectivity.</span></span> <span data-ttu-id="6a7ea-185">Однако протокол DHCP полезен при настройке среды разработки и проверки и позволяет проверить базовые функции групп доступности и их интеграцию с приложениями.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-185">However, DHCP is good for setting up your development and testing environment to verify basic functions of availability groups and for integration with your applications.</span></span>  
  
 <span data-ttu-id="6a7ea-186">**Статический IP-адрес**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-186">**Static IP**</span></span>  
 <span data-ttu-id="6a7ea-187">Прослушиватель будет использовать один или несколько статических IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-187">The listener will use one or more static IP addresses.</span></span> <span data-ttu-id="6a7ea-188">Дополнительные IP-адреса являются необязательными.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-188">Additional IP addresses are optional.</span></span> <span data-ttu-id="6a7ea-189">Чтобы создать прослушиватель группы доступности для нескольких подсетей, в конфигурации прослушивателя необходимо задать по одному статическому IP-адресу для каждой подсети.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-189">To create an availability group listener across multiple subnets, for each subnet you must specify a static IP address in the listener configuration.</span></span> <span data-ttu-id="6a7ea-190">Чтобы получить эти IP-адреса, свяжитесь с сетевым администратором.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-190">Contact your network administrator to get these static IP addresses.</span></span>  
  
 <span data-ttu-id="6a7ea-191">Если выбрать **Статический IP-адрес** , под полем **Сетевой режим** появится сетка подсети.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-191">If you select **Static IP** a subnet grid appears below the **Network Mode** field.</span></span> <span data-ttu-id="6a7ea-192">В этой сетке отображаются сведения о каждой подсети, к которой может получить доступ прослушиватель этой группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-192">This grid displays information about each subnet that can be accessed by this availability group listener.</span></span> <span data-ttu-id="6a7ea-193">Эта сетка остается пустой до тех пор, пока не будет добавлен статический IP-адрес путем нажатия кнопки **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-193">This grid is empty until you add a static IP address by clicking **Add**.</span></span>  
  
 <span data-ttu-id="6a7ea-194">Существуют следующие столбцы.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-194">The columns are as follows:</span></span>  
  
 <span data-ttu-id="6a7ea-195">**Подсеть**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-195">**Subnet**</span></span>  
 <span data-ttu-id="6a7ea-196">Отображает идентификатор каждой подсети, добавляемой в прослушиватель группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-196">Displays the identifier of each subnet that you add to the availability group listener.</span></span>  
  
 <span data-ttu-id="6a7ea-197">**IP-адрес**;</span><span class="sxs-lookup"><span data-stu-id="6a7ea-197">**IP Address**</span></span>  
 <span data-ttu-id="6a7ea-198">Отображает IP-адрес данной подсети.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-198">Displays the IP address of a given subnet.</span></span>  <span data-ttu-id="6a7ea-199">Для данной подсети статический IP-адрес может быть указан как IPv4 или IPv6.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-199">For a given subnet, the IP address is either an IPv4 address or an IPv6 address.</span></span>  
  
 <span data-ttu-id="6a7ea-200">**Добавление**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-200">**Add**</span></span>  
 <span data-ttu-id="6a7ea-201">Нажмите, чтобы добавить статический IP-адрес в выбранную подсеть или другую подсеть для этого прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-201">Click to add to add a static IP address to a selected subnet or to another subnet for this listener.</span></span> <span data-ttu-id="6a7ea-202">Откроется диалоговое окно **Добавление IP-адреса** .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-202">This opens the **Add IP Address** dialog box.</span></span> <span data-ttu-id="6a7ea-203">Дополнительные сведения см. в разделе справки [Диалоговое окно "Добавление IP-адреса" (SQL Server Management Studio)](add-ip-address-dialog-box-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-203">For more information, see the [Add IP Address Dialog Box &#40;SQL Server Management Studio&#41;](add-ip-address-dialog-box-sql-server-management-studio.md) help topic.</span></span>  
  
 <span data-ttu-id="6a7ea-204">**Удалить**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-204">**Remove**</span></span>  
 <span data-ttu-id="6a7ea-205">Нажмите, чтобы удалить выбранную подсеть из этого прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-205">Click to remove the selected subnet from this listener.</span></span>  
  
 <span data-ttu-id="6a7ea-206">**OK**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-206">**OK**</span></span>  
 <span data-ttu-id="6a7ea-207">Нажмите, чтобы создать указанный прослушиватель группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-207">Click to create the specified availability group listener.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="6a7ea-208">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6a7ea-208">Using Transact-SQL</span></span>  

### <a name="to-create-or-configure-an-availability-group-listener"></a><span data-ttu-id="6a7ea-209">Создание или настройка прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-209">To create or configure an availability group listener</span></span>
  
1.  <span data-ttu-id="6a7ea-210">Подключитесь к экземпляру сервера, на котором находится первичная реплика.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-210">Connect to the server instance that hosts the primary replica.</span></span>  
  
2.  <span data-ttu-id="6a7ea-211">Используйте параметр LISTENER в инструкции [CREATE AVAILABILITY GROUP](/sql/t-sql/statements/create-availability-group-transact-sql) или параметр ADD ISTENER для инструкции [ALTER AVAILABILITY GROUP](/sql/t-sql/statements/alter-availability-group-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="6a7ea-211">Use the LISTENER option of the [CREATE AVAILABILITY GROUP](/sql/t-sql/statements/create-availability-group-transact-sql) statement or the ADD LISTENER option of the [ALTER AVAILABILITY GROUP](/sql/t-sql/statements/alter-availability-group-transact-sql) statement.</span></span>  
  
     <span data-ttu-id="6a7ea-212">В следующем примере прослушиватель группы доступности добавляется в существующую группу доступности с именем `MyAg2`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-212">The following example adds an availability group listener to an existing availability group named `MyAg2`.</span></span> <span data-ttu-id="6a7ea-213">Для этого прослушивателя задается уникальное имя DNS — `MyAg2ListenerIvP6`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-213">A unique DNS name, `MyAg2ListenerIvP6`, is specified for this listener.</span></span> <span data-ttu-id="6a7ea-214">Две реплики находятся в разных подсетях, поэтому согласно рекомендации прослушиватель использует статические IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-214">The two replicas are on different subnets, so , as recommended, the listener uses static IP addresses.</span></span> <span data-ttu-id="6a7ea-215">Для каждой из двух реплик доступности предложение WITH IP указывает статический IP-адрес `2001:4898:f0:f00f::cf3c and 2001:4898:e0:f213::4ce2`, использующий формат IPv6.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-215">For each of the two availability replicas, the WITH IP clause specifies a static IP address, `2001:4898:f0:f00f::cf3c and 2001:4898:e0:f213::4ce2`, which use the IPv6 format.</span></span> <span data-ttu-id="6a7ea-216">В этом примере также указывается и используется необязательный параметр PORT, указывающий порт `60173` в качестве порта прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-216">This example also specifies uses the optional PORT argument to specify port `60173` as the listener port.</span></span>  
  
    ```sql
    ALTER AVAILABILITY GROUP MyAg2   
          ADD LISTENER 'MyAg2ListenerIvP6' ( WITH IP ( ('2001:db88:f0:f00f::cf3c'),('2001:4898:e0:f213::4ce2') ) , PORT = 60173 );   
    GO  
    ```  
  
##  <a name="using-powershell"></a><a name="PowerShellProcedure"></a> <span data-ttu-id="6a7ea-217">Использование PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a7ea-217">Using PowerShell</span></span>  

### <a name="to-create-or-configure-an-availability-group-listener"></a><span data-ttu-id="6a7ea-218">Создание или настройка прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-218">To create or configure an availability group listener</span></span> 
  
1.  <span data-ttu-id="6a7ea-219">Перейдите в каталог (`cd`) экземпляра сервера, на котором находится первичная реплика.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-219">Change directory (`cd`) to the server instance that hosts the primary replica.</span></span>  
  
2.  <span data-ttu-id="6a7ea-220">Чтобы создать или изменить прослушиватель группы доступности, используйте один из следующих командлетов:</span><span class="sxs-lookup"><span data-stu-id="6a7ea-220">To create or modify an availability group listener use one of the following cmdlets:</span></span>  
  
     `New-SqlAvailabilityGroupListener`  
     <span data-ttu-id="6a7ea-221">Создает прослушиватель группы доступности и привязывает его к существующей группе доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-221">Creates a new availability group listener and attaches it to an existing availability group.</span></span>  
  
     <span data-ttu-id="6a7ea-222">Например, следующая команда `New-SqlAvailabilityGroupListener` создает прослушиватель с именем `MyListener` для группы доступности `MyAg`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-222">For example, the following `New-SqlAvailabilityGroupListener` command creates an availability group listener named `MyListener` for the availability group `MyAg`.</span></span> <span data-ttu-id="6a7ea-223">Этот прослушиватель в качестве виртуального IP-адреса будет использовать адрес IPv4, переданный в параметре `-StaticIp`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-223">This listener will use the IPv4 address passed to the `-StaticIp` parameter as its virtual IP address.</span></span>  
  
    ```powershell
    New-SqlAvailabilityGroupListener -Name MyListener `
    -StaticIp '192.168.3.1/255.255.252.0' `
    -Path SQLSERVER:\Sql\Computer\Instance\AvailabilityGroups\MyAg
    ```  
  
     `Set-SqlAvailabilityGroupListener`  
     <span data-ttu-id="6a7ea-224">Изменяет порт существующего прослушивателя группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-224">Modifies the port setting on an existing availability group listener.</span></span>  
  
     <span data-ttu-id="6a7ea-225">Например, следующая команда `Set-SqlAvailabilityGroupListener` устанавливает для прослушивателя группы доступности с именем `MyListener` номер порта `1535`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-225">For example, the following `Set-SqlAvailabilityGroupListener` command sets the port number for the availability group listener named `MyListener` to `1535`.</span></span> <span data-ttu-id="6a7ea-226">Этот порт будет использоваться прослушивателем для прослушивания соединения.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-226">This port is used to listen for connections to the listener.</span></span>  
  
    ```powershell
    Set-SqlAvailabilityGroupListener -Port 1535 `
    -Path SQLSERVER:\Sql\PrimaryServer\InstanceName\AvailabilityGroups\MyAg\AGListeners\MyListener  
    ```  
  
     `Add-SqlAGListenerstaticIp`  
     <span data-ttu-id="6a7ea-227">Добавляет статический IP-адрес в конфигурацию существующего прослушивателя группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-227">Adds a static IP address to an existing availability group listener configuration.</span></span> <span data-ttu-id="6a7ea-228">IP-адрес может быть адресом IPv4 с подсетью или адресом IPv6.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-228">The IP address can be an IPv4 address with subnet, or an IPv6 address.</span></span>  
  
     <span data-ttu-id="6a7ea-229">Например, следующая команда `Add-SqlAGListenerstaticIp` добавляет статический адрес IPv4 в прослушиватель `MyListener` в группе доступности `MyAg`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-229">For example, the following `Add-SqlAGListenerstaticIp` command adds a static IPv4 address to the availability group listener `MyListener` on the availability group `MyAg`.</span></span> <span data-ttu-id="6a7ea-230">Этот адрес IPv6 выступает в роли виртуального IP-адреса прослушивателя в подсети `255.255.252.0`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-230">This IPv6 address serves as the virtual IP address of the listener on the subnet `255.255.252.0`.</span></span> <span data-ttu-id="6a7ea-231">Если группа доступности распространяется на несколько подсетей, нужно добавить статический IP-адрес для каждой подсети в прослушивателе.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-231">If the availability group spans multiple subnets, you should add a static IP address for each subnet to the listener.</span></span>  
  
    ```powershell
    $path = "SQLSERVER:\SQL\PrimaryServer\InstanceName\AvailabilityGroups\MyAg\AGListeners\ MyListener" `
    Add-SqlAGListenerstaticIp -Path $path `
    -StaticIp "2001:0db8:85a3:0000:0000:8a2e:0370:7334"  
    ```  
  
    > [!NOTE]  
    >  <span data-ttu-id="6a7ea-232">Чтобы просмотреть синтаксис командлета, используйте командлет **Get-Help** в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] среде PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-232">To view the syntax of a cmdlet, use the **Get-Help**  cmdlet in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] PowerShell environment.</span></span> <span data-ttu-id="6a7ea-233">Дополнительные сведения см. в разделе [Get Help SQL Server PowerShell](../../../powershell/sql-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-233">For more information, see [Get Help SQL Server PowerShell](../../../powershell/sql-server-powershell.md).</span></span>  
  
<span data-ttu-id="6a7ea-234">Сведения о настройке и использовании поставщика SQL Server PowerShell см. в разделе [поставщик SQL Server PowerShell](../../../powershell/sql-server-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-234">To set up and use the SQL Server PowerShell provider, see [SQL Server PowerShell Provider](../../../powershell/sql-server-powershell-provider.md).</span></span>
  
## <a name="troubleshooting"></a><span data-ttu-id="6a7ea-235">Диагностика</span><span class="sxs-lookup"><span data-stu-id="6a7ea-235">Troubleshooting</span></span>  
  
###  <a name="failure-to-create-an-availability-group-listener-because-of-active-directory-quotas"></a><a name="ADQuotas"></a><span data-ttu-id="6a7ea-236">Не удалось создать прослушиватель группы доступности из-за Active Directoryных квот</span><span class="sxs-lookup"><span data-stu-id="6a7ea-236">Failure to Create An Availability Group Listener Because of Active Directory Quotas</span></span>  
 <span data-ttu-id="6a7ea-237">Создание нового прослушивателя группы доступности может завершиться неудачей в случае превышения квоты Active Directory для учетной записи участвующего узла кластера.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-237">The creation of a new availability group listener may fail upon creation because you have reached an Active Directory quota for the participating cluster node machine account.</span></span>  <span data-ttu-id="6a7ea-238">Дополнительные сведения см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="6a7ea-238">For more information, see the following articles:</span></span>  
  
-   [<span data-ttu-id="6a7ea-239">HYPERLINK " https://support.microsoft.com/kb/307532 " как устранять неполадки с учетной записью службы кластеров при изменении объектов компьютеров</span><span class="sxs-lookup"><span data-stu-id="6a7ea-239">HYPERLINK "https://support.microsoft.com/kb/307532" How to Troubleshoot the Cluster Service Account When It Modifies Computer Objects</span></span>](https://support.microsoft.com/kb/307532)  
  
-   <span data-ttu-id="6a7ea-240">[ГИПЕРССЫЛКа " https://technet.microsoft.com/library/cc904295(WS.10).aspx " Active Directory квоты](https://technet.microsoft.com/library/cc904295\(WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-240">[HYPERLINK "https://technet.microsoft.com/library/cc904295(WS.10).aspx" Active Directory Quotas](https://technet.microsoft.com/library/cc904295\(WS.10\).aspx)</span></span>  
  
##  <a name="follow-up-after-creating-an-availability-group-listener"></a><a name="FollowUp"></a> <span data-ttu-id="6a7ea-241">Дальнейшие действия. Действия после создания прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-241">Follow-up: After Creating an Availability Group Listener</span></span>  
  
###  <a name="multisubnetfailover-keyword-and-associated-features"></a><a name="MultiSubnetFailover"></a><span data-ttu-id="6a7ea-242">Ключевое слово MultiSubnetFailover и связанные с ним функции</span><span class="sxs-lookup"><span data-stu-id="6a7ea-242">MultiSubnetFailover Keyword and Associated Features</span></span>  
 <span data-ttu-id="6a7ea-243">`MultiSubnetFailover` — это новое ключевое слово строки подключения, которое обеспечивает ускоренную отработку отказа для групп доступности AlwaysOn и экземпляров отказоустойчивых кластеров AlwaysOn в SQL Server 2012.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-243">`MultiSubnetFailover` is a new connection string keyword used to enable faster failover with AlwaysOn Availability Groups and AlwaysOn Failover Cluster Instances in SQL Server 2012.</span></span> <span data-ttu-id="6a7ea-244">Если в строке подключения задано условие `MultiSubnetFailover=True` , то включаются следующие три дополнительные функции.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-244">The following three sub-features are enabled when `MultiSubnetFailover=True` is set in connection string:</span></span>  
  
-   <span data-ttu-id="6a7ea-245">Ускоренная отработка отказа для нескольких подсетей с прослушивателем для группы доступности AlwaysOn или экземпляров отказоустойчивых кластеров.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-245">Faster multi-subnet failover to a multi-subnet listener for an AlwaysOn Availability Group or Failover Cluster Instances.</span></span>  
  
-   <span data-ttu-id="6a7ea-246">Ускоренная отработка отказа для одной подсети с прослушивателем для группы доступности AlwaysOn или экземпляров отказоустойчивых кластеров.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-246">Faster single subnet failover to a single subnet listener for an AlwaysOn Availability Group or Failover Cluster Instances.</span></span>  
  
    -   <span data-ttu-id="6a7ea-247">Эта функция используется при подключении к прослушивателю с одним IP-адресом в одной подсети.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-247">This feature is used when connecting to a listener that has a single IP in a single subnet.</span></span> <span data-ttu-id="6a7ea-248">В результате этого выполняется большее число попыток подключения по протоколу TCP, что дает возможность ускорить отработку отказа в одной подсети.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-248">This performs more aggressive TCP connection retries to speed up single subnet failovers.</span></span>  
  
-   <span data-ttu-id="6a7ea-249">Разрешение именованного экземпляра в экземпляр отказоустойчивого кластера группы доступности AlwaysOn в нескольких подсетях.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-249">Named instance resolution to a multi-subnet AlwaysOn Failover Cluster Instance.</span></span>  
  
    -   <span data-ttu-id="6a7ea-250">Эта функция необходима для добавления поддержки разрешения именованного экземпляра для экземпляров отказоустойчивых кластеров группы доступности AlwaysOn с конечными точками в нескольких подсетях.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-250">This is to add named instance resolution support for an AlwaysOn Failover Cluster Instances with multiple subnet endpoints.</span></span>  
  
 <span data-ttu-id="6a7ea-251">**MultiSubnetFailover=True не поддерживается платформой NET Framework 3.5 или OLEDB**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-251">**MultiSubnetFailover=True Not Supported by NET Framework 3.5 or OLEDB**</span></span>  
  
 <span data-ttu-id="6a7ea-252">**Вопрос.** Если у вашей группы доступности или экземпляра отказоустойчивого кластера есть имя прослушивателя (имя сети или точка доступа клиента в диспетчере кластеров WSFC) в зависимости от нескольких IP-адресов из разных подсетей и вы используете ADO.NET с .NET Framework 3.5 с пакетом обновления 1 (SP1) или SQL Native Client 11,0 OLEDB, потенциально 50% запросов на подключение клиента к прослушивателю группы доступности приведет к превышению времени ожидания подключения.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-252">**Issue:** If your Availability Group or Failover Cluster Instance has a listener name (known as the network name or Client Access Point in the WSFC Cluster Manager) depending on multiple IP addresses from different subnets, and you are using either ADO.NET with .NET Framework 3.5SP1 or SQL Native Client 11.0 OLEDB, potentially 50% of your client-connection requests to the availability group listener will hit a connection timeout.</span></span>  
  
 <span data-ttu-id="6a7ea-253">**Решения.** Рекомендуется выполнить одну из следующих задач.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-253">**Workarounds:** We recommend that you do one of the following tasks.</span></span>  
  
-   <span data-ttu-id="6a7ea-254">При отсутствии разрешения на работу с ресурсами кластера измените время ожидания соединения на 30 секунд (это означает 20 секунд ожидания TCP плюс 10-секундный буфер).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-254">If do not have the permission to manipulate cluster resources, change your connection timeout to 30 seconds (this value results in a 20-second TCP timeout period plus a 10-second buffer).</span></span>  
  
     <span data-ttu-id="6a7ea-255">**Преимущества**. В случае отработки отказа по нескольким подсетям обеспечивается быстрое восстановление клиента.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-255">**Pros**: If a cross-subnet failover occurs, client recovery time is short.</span></span>  
  
     <span data-ttu-id="6a7ea-256">**Недостатки**. Установление половины соединений клиентов потребует более 20 секунд.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-256">**Cons**: Half of the client connections will take more than 20 seconds</span></span>  
  
-   <span data-ttu-id="6a7ea-257">При наличии разрешений на работу с ресурсами кластера рекомендуется задать `RegisterAllProvidersIP=0`в качестве сетевого имени прослушивателя группы доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-257">If you have the permission to manipulate cluster resources, the more recommended approach is to set the network name of your availability group listener to `RegisterAllProvidersIP=0`.</span></span> <span data-ttu-id="6a7ea-258">Дополнительные сведения см. в подразделе "Установка значения RegisterAllProvidersIP" далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-258">For more information, see "RegisterAllProvidersIP Setting" later in this section.</span></span>  
  
     <span data-ttu-id="6a7ea-259">**Преимущества**. Не потребуется увеличивать значение времени ожидания соединения клиента.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-259">**Pros:** You do not need to increase your client-connection timeout value.</span></span>  
  
     <span data-ttu-id="6a7ea-260">**Против:** Если происходит отработка отказа между подсетями, время восстановления клиента может составлять не более 15 минут, в зависимости от `HostRecordTTL` настроек и расписания репликации межсайтовых DNS/AD.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-260">**Cons:** If a cross-subnet failover occurs, the client recovery time could be 15 minutes or longer, depending on your `HostRecordTTL` setting and the setting of your cross-site DNS/AD replication schedule.</span></span>  
  
###  <a name="registerallprovidersip-setting"></a><a name="RegisterAllProvidersIP"></a><span data-ttu-id="6a7ea-261">Параметр RegisterAllProvidersIP</span><span class="sxs-lookup"><span data-stu-id="6a7ea-261">RegisterAllProvidersIP Setting</span></span>  
 <span data-ttu-id="6a7ea-262">При создании прослушивателя группы доступности с помощью [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)] или Powershell точка доступа клиента в кластере WSFC создается со свойством `RegisterAllProvidersIP`, установленным в значение 1 (true).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-262">When you use [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or PowerShell to create an availability group listener, the Client Access Point is created in WSFC with the `RegisterAllProvidersIP` property set to 1 (true).</span></span> <span data-ttu-id="6a7ea-263">Действие этого значения свойства зависит от строки подключения клиента следующим образом.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-263">The effect of this property value depends on the client connection string, as follows:</span></span>  
  
-   <span data-ttu-id="6a7ea-264">Строки подключения, устанавливающие свойство `MultiSubnetFailover` в значение true.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-264">Connection strings that set `MultiSubnetFailover` to true</span></span>  
  
     [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="6a7ea-265">устанавливает свойство `RegisterAllProvidersIP` в значение 1, чтобы сократить время соединения после отработки отказа для клиентов, у которых в строке подключения указано, согласно рекомендациям, `MultiSubnetFailover = True`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-265">sets the  `RegisterAllProvidersIP` property to 1 in order to reduce re-connection time after a failover for clients whose client connection strings specify `MultiSubnetFailover = True`, as recommended.</span></span> <span data-ttu-id="6a7ea-266">Обратите внимание, что для использования функции нескольких подсетей в прослушивателе поставщик данных клиентов должен поддерживать ключевое слово `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-266">Note that to take advantage of the listener multi-subnet feature, your clients might require a data provider that supports the `MultiSubnetFailover` keyword.</span></span> <span data-ttu-id="6a7ea-267">Сведения о поддержке драйверов для отказоустойчивых кластеров с несколькими подсетями см. в разделе [Подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-267">For information about driver support for multi-subnet failover, see [AlwaysOn Client Connectivity &#40;SQL Server&#41;](always-on-client-connectivity-sql-server.md).</span></span>  
  
     <span data-ttu-id="6a7ea-268">Сведения о кластеризации с несколькими подсетями см. в разделе [Кластеры SQL Server с несколькими подсетями (SQL Server)](../../../sql-server/failover-clusters/windows/sql-server-multi-subnet-clustering-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-268">For information about multi-subnet clustering, see [SQL Server Multi-Subnet Clustering &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/sql-server-multi-subnet-clustering-sql-server.md).</span></span>  
  
    > [!TIP]  
    >  <span data-ttu-id="6a7ea-269">Если `RegisterAllProvidersIP = 1`, то при запуске мастера WSFC по проверке конфигурации в кластере WSFC мастер выдаст следующее сообщение об ошибке:</span><span class="sxs-lookup"><span data-stu-id="6a7ea-269">When `RegisterAllProvidersIP = 1`, if you run the WSFC Validate a Configuration Wizard on the WSFC cluster, the wizard generates the following warning message:</span></span>  
    >   
    >  <span data-ttu-id="6a7ea-270">"Свойству RegisterAllProvidersIP для сетевого имени "Name:<сетевое_имя>" присвоено значение 1. В текущей конфигурации кластера для этого свойства должно быть задано значение 0".</span><span class="sxs-lookup"><span data-stu-id="6a7ea-270">"The RegisterAllProviderIP property for network name 'Name:<network_name>' is set to 1 For the current cluster configuration this value should be set to 0."</span></span>  
    >   
    >  <span data-ttu-id="6a7ea-271">Не обращайте внимания на это сообщение.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-271">Please ignore this message.</span></span>  
  
-   <span data-ttu-id="6a7ea-272">Строки подключения, не задающие свойство `MultiSubnetFailover` в значение true.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-272">Connection strings that do not set `MultiSubnetFailover` to true</span></span>  
  
     <span data-ttu-id="6a7ea-273">Если выполняется условие `RegisterAllProvidersIP = 1`, то у любых клиентов, у которых строка подключения не содержит `MultiSubnetFailover = True`, будет возникать большая задержка в соединениях.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-273">When `RegisterAllProvidersIP = 1`, any clients whose connection strings do not use `MultiSubnetFailover = True`, will experience high latency connections.</span></span> <span data-ttu-id="6a7ea-274">Это происходит потому, что эти клиенты пытаются соединиться со всеми IP-адресами последовательно.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-274">This occurs because these clients attempt connections to all IPs sequentially.</span></span> <span data-ttu-id="6a7ea-275">Наоборот, если свойство `RegisterAllProvidersIP` изменено на 0, то IP-адрес включается в список клиентской точки доступа в кластере WSFC и уменьшает задержку для клиентов устаревших версий.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-275">In contrast, if `RegisterAllProvidersIP` is changed to 0, the active IP address is registered in the Client Access Point in the WSFC cluster, reducing latency for legacy clients.</span></span> <span data-ttu-id="6a7ea-276">Поэтому при наличии устаревших клиентов, которым необходимо подключаться к прослушивателю группы доступности и не может использовать `MultiSubnetFailover` свойство, рекомендуется изменить `RegisterAllProvidersIP` значение на 0.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-276">Therefore, if you have legacy clients that need to connect to an availability group listener and cannot use the `MultiSubnetFailover` property, we recommend that you change `RegisterAllProvidersIP` to 0.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6a7ea-277">При создании прослушивателя группы доступности через кластер WSFC (графический интерфейс диспетчера отказоустойчивого кластера) свойство `RegisterAllProvidersIP` будет иметь значение 0 (false) по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-277">When you create an availability group listener through the WSFC cluster (Failover Cluster Manager GUI), `RegisterAllProvidersIP` will be 0 (false) by default.</span></span>  
  
###  <a name="hostrecordttl-setting"></a><a name="HostRecordTTL"></a> <span data-ttu-id="6a7ea-278">Установка значения HostRecordTTL</span><span class="sxs-lookup"><span data-stu-id="6a7ea-278">HostRecordTTL Setting</span></span>  
 <span data-ttu-id="6a7ea-279">По умолчанию клиенты кэшируют DNS-записи кластера на 20 минут.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-279">By default, clients cache cluster DNS records for 20 minutes.</span></span>  <span data-ttu-id="6a7ea-280">Путем уменьшения `HostRecordTTL` (срок существования (TTL) для кэшированной записи) старые клиенты могут подключиться быстрее.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-280">By reducing `HostRecordTTL`, the Time to Live (TTL), for the cached record, legacy clients may reconnect more quickly.</span></span>  <span data-ttu-id="6a7ea-281">Однако уменьшение параметра `HostRecordTTL` также может привести к увеличению трафика к серверам DN.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-281">However, reducing the `HostRecordTTL` setting may also result in increased traffic to the DN servers.</span></span>  
  
###  <a name="sample-powershell-script-to-disable-registerallprovidersip-and-reduce-ttl"></a><a name="SampleScript"></a><span data-ttu-id="6a7ea-282">Пример скрипта PowerShell для отключения RegisterAllProvidersIP и сокращения срока жизни</span><span class="sxs-lookup"><span data-stu-id="6a7ea-282">Sample PowerShell Script to Disable RegisterAllProvidersIP and Reduce TTL</span></span>  
 <span data-ttu-id="6a7ea-283">В следующем примере показано, как настроить PowerShell и параметры кластера `RegisterAllProvidersIP` и `HostRecordTTL` для ресурса прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-283">The following PowerShell example demonstrates how to configure both the `RegisterAllProvidersIP` and `HostRecordTTL` cluster parameters for the listener resource.</span></span>  <span data-ttu-id="6a7ea-284">Запись DNS будет кэшироваться каждые 5 минут, а не 20 минут (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-284">The DNS record will be cached for 5 minutes rather than the default 20 minutes.</span></span>  <span data-ttu-id="6a7ea-285">Если изменить оба параметра кластера, можно сократить время подключения к нужному IP-адресу после перехода на старых клиентов, которые не могут использовать параметр `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-285">Modifying both cluster parameters may reduce the time to connect to the correct IP address after a failover for legacy clients that cannot use the `MultiSubnetFailover` parameter.</span></span>  <span data-ttu-id="6a7ea-286">Замените `yourListenerName` на имя изменяемого прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-286">Replace `yourListenerName` with the name of the listener that you are changing.</span></span>  
  
```powershell
Import-Module FailoverClusters  
Get-ClusterResource yourListenerName | Set-ClusterParameter RegisterAllProvidersIP 0
Get-ClusterResource yourListenerName|Set-ClusterParameter HostRecordTTL 300  
Stop-ClusterResource yourListenerName  
Start-ClusterResource yourAGResource  
```  
  
 <span data-ttu-id="6a7ea-287">Дополнительные сведения о времени восстановления при отработке отказа см. в разделе [Client Recovery Latency During Failover](../../../sql-server/failover-clusters/windows/sql-server-multi-subnet-clustering-sql-server.md#DNS).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-287">For more information about recovery times during failover, see [Client Recovery Latency During Failover](../../../sql-server/failover-clusters/windows/sql-server-multi-subnet-clustering-sql-server.md#DNS).</span></span>  
  
###  <a name="follow-up-recommendations"></a><a name="FollowUpRecommendations"></a> <span data-ttu-id="6a7ea-288">Рекомендуемые действия</span><span class="sxs-lookup"><span data-stu-id="6a7ea-288">Follow-up Recommendations</span></span>  
 <span data-ttu-id="6a7ea-289">Действия после создания прослушивателя группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-289">After you create an availability group listener:</span></span>  
  
-   <span data-ttu-id="6a7ea-290">Попросите сетевого администратора зарезервировать IP-адрес, который будет использоваться только этим прослушивателем.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-290">Ask your network administrator to reserve the listener's IP address for its exclusive use.</span></span>  
  
-   <span data-ttu-id="6a7ea-291">Передайте имя узла DNS прослушивателя разработчикам приложения для использования в строке подключения при запросе клиентских соединений к данной группе доступности.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-291">Give the listener's DNS host name to application developers to use in connection strings when requesting client connections to this availability group.</span></span>  
  
-   <span data-ttu-id="6a7ea-292">Рекомендуйте разработчикам добавить в строки подключения `MultiSubnetFailover = True`, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-292">Encourage developers to update client connection strings to specify `MultiSubnetFailover = True`, if possible.</span></span> <span data-ttu-id="6a7ea-293">Сведения о поддержке драйверов для отказоустойчивых кластеров с несколькими подсетями см. в разделе [Подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-293">For information about driver support for multi-subnet failover, see [AlwaysOn Client Connectivity &#40;SQL Server&#41;](always-on-client-connectivity-sql-server.md).</span></span>  
  
###  <a name="create-an-additional-listener-for-an-availability-group-optional"></a><a name="CreateAdditionalListener"></a> <span data-ttu-id="6a7ea-294">Создание дополнительного прослушивателя для группы доступности (необязательно)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-294">Create an Additional Listener for an Availability Group (Optional)</span></span>  
 <span data-ttu-id="6a7ea-295">После создания одного прослушивателя посредством SQL Server можно создать дополнительный прослушиватель следующим образом.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-295">After you create one listener through SQL Server, you can add an additional listener, as follows:</span></span>  
  
1.  <span data-ttu-id="6a7ea-296">Создайте прослушиватель, используя одно из следующих средств:</span><span class="sxs-lookup"><span data-stu-id="6a7ea-296">Create the listener using either of the following tools:</span></span>  
  
    -   <span data-ttu-id="6a7ea-297">**Использование диспетчера отказоустойчивого кластера WSFC.**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-297">**Using WSFC Failover Cluster Manager:**</span></span>  
  
        1.  <span data-ttu-id="6a7ea-298">Добавление точки доступа клиента и настройка IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-298">Add a client access point and configure the IP address.</span></span>  
  
        2.  <span data-ttu-id="6a7ea-299">Перевод прослушивателя в режим «в сети».</span><span class="sxs-lookup"><span data-stu-id="6a7ea-299">Bring the listener online.</span></span>  
  
        3.  <span data-ttu-id="6a7ea-300">Добавление зависимости в ресурс группы доступности WSFC.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-300">Add a dependency to the WSFC availability group resource.</span></span>  
  
         <span data-ttu-id="6a7ea-301">Дополнительные сведения о диалоговых окнах и вкладках диспетчера отказоустойчивости кластеров см. в разделе [Пользовательский интерфейс: оснастка "Диспетчер отказоустойчивости кластеров"](https://technet.microsoft.com/library/cc772502.aspx).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-301">For information about the dialog boxes and tabs of the Failover Cluster Manager, see [User Interface: The Failover Cluster Manager Snap-In](https://technet.microsoft.com/library/cc772502.aspx).</span></span>  
  
    -   <span data-ttu-id="6a7ea-302">**С помощью Windows PowerShell для отказоустойчивых кластеров.**</span><span class="sxs-lookup"><span data-stu-id="6a7ea-302">**Using Windows PowerShell for failover clusters:**</span></span>  
  
        1.  <span data-ttu-id="6a7ea-303">Используйте командлет [Add-ClusterResource](https://technet.microsoft.com/library/ee460983.aspx) , чтобы создать ресурсы сетевого имени и IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-303">Use [Add-ClusterResource](https://technet.microsoft.com/library/ee460983.aspx) to create a network name and the IP address resources.</span></span>  
  
        2.  <span data-ttu-id="6a7ea-304">Используйте командлет [Start-ClusterResource](https://technet.microsoft.com/library/ee461056.aspx) , чтобы запустить ресурс сетевого имени.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-304">Use [Start-ClusterResource](https://technet.microsoft.com/library/ee461056.aspx) to start the network name resource.</span></span>  
  
        3.  <span data-ttu-id="6a7ea-305">Используйте командлет [Add-ClusterResourceDependency](https://technet.microsoft.com/library/ee461014.aspx) , чтобы задать зависимость между сетевым именем и существующим ресурсом группы доступности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-305">Use [Add-ClusterResourceDependency](https://technet.microsoft.com/library/ee461014.aspx) to set the dependency between the network name and the existing SQL Server Availability Group resource.</span></span>  
  
         <span data-ttu-id="6a7ea-306">Сведения об использовании Windows PowerShell для отказоустойчивых кластеров см. в разделе [Общие сведения о командах диспетчера сервера](https://technet.microsoft.com/library/cc732757.aspx#BKMK_wps).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-306">For information about using Windows PowerShell for failover clusters, see [Overview of Server Manager Commands](https://technet.microsoft.com/library/cc732757.aspx#BKMK_wps).</span></span>  
  
2.  <span data-ttu-id="6a7ea-307">Запустите прослушивание [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в новом прослушивателе.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-307">Start [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] listening on the new listener.</span></span> <span data-ttu-id="6a7ea-308">После создания дополнительного прослушивателя подключитесь к экземпляру [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , на котором размещается первичная реплика группы доступности, и измените порт прослушивателя с помощью среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]или PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6a7ea-308">After creating the additional listener, connect to the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that hosts the primary replica of the availability group and use [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or PowerShell to modify the listener port.</span></span>  
  
 <span data-ttu-id="6a7ea-309">Дополнительные сведения см. в разделе [Способ создания нескольких прослушивателей для одной группы доступности](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/03/how-to-create-multiple-listeners-for-same-availability-group-goden-yao.aspx) (блог группы разработчиков SQL Server AlwaysOn).</span><span class="sxs-lookup"><span data-stu-id="6a7ea-309">For more information, see [How to create multiple listeners for same availability group](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/03/how-to-create-multiple-listeners-for-same-availability-group-goden-yao.aspx) (a SQL Server AlwaysOn team blog).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="6a7ea-310">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="6a7ea-310">Related Tasks</span></span>  
  
-   [<span data-ttu-id="6a7ea-311">Просмотр свойств прослушивателя группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-311">View Availability Group Listener Properties &#40;SQL Server&#41;</span></span>](view-availability-group-listener-properties-sql-server.md)  
  
-   [<span data-ttu-id="6a7ea-312">Удаление прослушивателя группы доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-312">Remove an Availability Group Listener &#40;SQL Server&#41;</span></span>](remove-an-availability-group-listener-sql-server.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="6a7ea-313">См. также</span><span class="sxs-lookup"><span data-stu-id="6a7ea-313">Related Content</span></span>  
  
-   [<span data-ttu-id="6a7ea-314">Способ создания нескольких прослушивателей для одной группы доступности</span><span class="sxs-lookup"><span data-stu-id="6a7ea-314">How to create multiple listeners for same availability group</span></span>](https://blogs.msdn.com/b/sqlalwayson/archive/2012/02/03/how-to-create-multiple-listeners-for-same-availability-group-goden-yao.aspx)  
  
-   [<span data-ttu-id="6a7ea-315">Блог группы SQL Server AlwaysOn: Официальный блог группы SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="6a7ea-315">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn team blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="6a7ea-316">См. также:</span><span class="sxs-lookup"><span data-stu-id="6a7ea-316">See Also</span></span>  
 <span data-ttu-id="6a7ea-317">[Общие сведения о группы доступности AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="6a7ea-317">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="6a7ea-318">[Прослушиватели групп доступности, возможность подключения клиентов и отработка отказа приложений (SQL Server)](../../listeners-client-connectivity-application-failover.md) </span><span class="sxs-lookup"><span data-stu-id="6a7ea-318">[Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span></span>  
 [<span data-ttu-id="6a7ea-319">Кластеры SQL Server с несколькими подсетями (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6a7ea-319">SQL Server Multi-Subnet Clustering &#40;SQL Server&#41;</span></span>](../../../sql-server/failover-clusters/windows/sql-server-multi-subnet-clustering-sql-server.md)  
