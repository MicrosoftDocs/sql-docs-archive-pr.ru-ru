---
title: Общие сведения о инструкциях Transact-SQL для группы доступности AlwaysOn (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], about
- Availability Groups [SQL Server], Transact-SQL statements
ms.assetid: 184d0a81-2259-4db9-9d0d-01aac0b502c8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: ff25fecf54cfdd1d9c03d1586f0272896542bfa7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750184"
---
# <a name="overview-of-transact-sql-statements-for-alwayson-availability-groups-sql-server"></a><span data-ttu-id="10661-102">Обзор сведений об инструкциях Transact-SQL для групп доступности AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="10661-102">Overview of Transact-SQL Statements for AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="10661-103">В этом разделе приведены общие сведения об инструкциях [!INCLUDE[tsql](../../../includes/tsql-md.md)] , которые поддерживают развертывание [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , а также создание и управление данной группой доступности, репликой доступности и базой данных доступности.</span><span class="sxs-lookup"><span data-stu-id="10661-103">This topic introduces the [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements that support deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] and creating and managing an given availability group, availability replica and availability database.</span></span>  
  
  
##  <a name="create-endpoint"></a><a name="CreateEndpoint"></a><span data-ttu-id="10661-104">СОЗДАТЬ КОНЕЧНУЮ ТОЧКУ</span><span class="sxs-lookup"><span data-stu-id="10661-104">CREATE ENDPOINT</span></span>  
 <span data-ttu-id="10661-105">[создать конечную точку... ДЛЯ DATABASE_MIRRORING](/sql/t-sql/statements/create-endpoint-transact-sql) создает конечную точку зеркального отображения базы данных, если она не существует на экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="10661-105">[CREATE ENDPOINT ... FOR DATABASE_MIRRORING](/sql/t-sql/statements/create-endpoint-transact-sql) creates a database mirroring endpoint, if none exists on the server instance.</span></span> <span data-ttu-id="10661-106">Для каждого экземпляра сервера, на котором намечено развертывание [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] или зеркального отображения базы данных, требуется конечная точка зеркального отображения базы данных.</span><span class="sxs-lookup"><span data-stu-id="10661-106">Every server instance on which you intend to deploy [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] or database mirroring requires a database mirroring endpoint.</span></span>  
  
 <span data-ttu-id="10661-107">Эта инструкция выполняется на экземпляре сервера, на котором создается конечная точка.</span><span class="sxs-lookup"><span data-stu-id="10661-107">Execute this statement on the server instance on which you are creating the endpoint.</span></span> <span data-ttu-id="10661-108">На каждом конкретном экземпляре сервера можно создать только одну конечную точку зеркального отображения базы данных.</span><span class="sxs-lookup"><span data-stu-id="10661-108">You can create only one database mirroring endpoint on a given server instance.</span></span> <span data-ttu-id="10661-109">Дополнительные сведения см. в разделе [Конечная точка зеркального отображения базы данных (SQL Server)](../../database-mirroring/the-database-mirroring-endpoint-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="10661-109">For more information, see [The Database Mirroring Endpoint &#40;SQL Server&#41;](../../database-mirroring/the-database-mirroring-endpoint-sql-server.md).</span></span>  
  
##  <a name="create-availability-group"></a><a name="CreateAG"></a><span data-ttu-id="10661-110">СОЗДАНИЕ ГРУППЫ ДОСТУПНОСТИ</span><span class="sxs-lookup"><span data-stu-id="10661-110">CREATE AVAILABILITY GROUP</span></span>  
 <span data-ttu-id="10661-111">[CREATE AVAILABILITY GROUP](/sql/t-sql/statements/create-availability-group-transact-sql) создает новую группу доступности и, при необходимости, прослушиватель группы доступности.</span><span class="sxs-lookup"><span data-stu-id="10661-111">[CREATE AVAILABILITY GROUP](/sql/t-sql/statements/create-availability-group-transact-sql) creates a new availability group and optionally an availability group listener.</span></span> <span data-ttu-id="10661-112">Как минимум необходимо указать экземпляр локального сервера, который станет начальной первичной репликой.</span><span class="sxs-lookup"><span data-stu-id="10661-112">Minimally, you must specify your local server instance, which will become the initial primary replica.</span></span> <span data-ttu-id="10661-113">Дополнительно можно указать до четырех вторичных реплик.</span><span class="sxs-lookup"><span data-stu-id="10661-113">Optionally, you can also specify up to four secondary replicas.</span></span>  
  
 <span data-ttu-id="10661-114">Выполните CREATE AVAILABILITY GROUP в экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], на котором должна размещаться начальная первичная реплика создаваемой группы доступности.</span><span class="sxs-lookup"><span data-stu-id="10661-114">Execute CREATE AVAILABILITY GROUP on the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that you want to host the initial primary replica of your new availability group.</span></span> <span data-ttu-id="10661-115">Этот экземпляр сервера должен находиться на узле отказоустойчивого кластера Windows Server (WSFC) (Дополнительные сведения см. в разделе [Предварительные требования, ограничения и рекомендации для группы доступности AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="10661-115">This server instance must reside on a node of a Windows Server Failover Cluster (WSFC) (for more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
##  <a name="alter-availability-group"></a><a name="AlterAG"></a><span data-ttu-id="10661-116">ALTER AVAILABILITY GROUP</span><span class="sxs-lookup"><span data-stu-id="10661-116">ALTER AVAILABILITY GROUP</span></span>  
 <span data-ttu-id="10661-117">[ALTER AVAILABILITY GROUP](/sql/t-sql/statements/alter-availability-group-transact-sql) поддерживает изменение существующей группы доступности или прослушивателя группы доступности для перехода на группу доступности.</span><span class="sxs-lookup"><span data-stu-id="10661-117">[ALTER AVAILABILITY GROUP](/sql/t-sql/statements/alter-availability-group-transact-sql) supports changing an existing availability group or availability group listener and for failing over an availability group.</span></span>  
  
 <span data-ttu-id="10661-118">Выполните ALTER AVAILABILITY GROUP в экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , на котором размещается текущая первичная реплика.</span><span class="sxs-lookup"><span data-stu-id="10661-118">Execute ALTER AVAILABILITY GROUP on the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that hosts the current primary replica.</span></span>  
  
##  <a name="alter-database--set-hadr-"></a><a name="AlterDb"></a><span data-ttu-id="10661-119">ИЗМЕНИТЬ БАЗУ ДАННЫХ... ЗАДАТЬ HADR...</span><span class="sxs-lookup"><span data-stu-id="10661-119">ALTER DATABASE ... SET HADR ...</span></span>  
 <span data-ttu-id="10661-120">Параметры предложения [SET HADR](/sql/t-sql/statements/alter-database-transact-sql-set-hadr) инструкции ALTER DATABASE позволяют присоединить базу данных-получателя к группе доступности соответствующей базы данных-источника, удалить присоединенную базу данных, отложить синхронизацию данных в присоединенной базе данных, а также возобновить синхронизацию данных.</span><span class="sxs-lookup"><span data-stu-id="10661-120">The options of the [SET HADR](/sql/t-sql/statements/alter-database-transact-sql-set-hadr) clause of the ALTER DATABASE statement enables you to join a secondary database to the availability group of the corresponding primary database, remove a joined database, and suspend data synchronization on a joined database, and resume data synchronization.</span></span>  
  
##  <a name="drop-availability-group"></a><a name="DropAG"></a><span data-ttu-id="10661-121">УДАЛИТЬ ГРУППУ ДОСТУПНОСТИ</span><span class="sxs-lookup"><span data-stu-id="10661-121">DROP AVAILABILITY GROUP</span></span>  
 <span data-ttu-id="10661-122">Инструкция[DROP AVAILABILITY GROUP](/sql/t-sql/statements/drop-availability-group-transact-sql) удаляет указанную группу доступности и все ее реплики.</span><span class="sxs-lookup"><span data-stu-id="10661-122">[DROP AVAILABILITY GROUP](/sql/t-sql/statements/drop-availability-group-transact-sql) removes a specified availability group and all of its replicas.</span></span> <span data-ttu-id="10661-123">Инструкция DROP AVAILABILITY GROUP может быть запущена с любого узла [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] в отказоустойчивом кластере WSFC.</span><span class="sxs-lookup"><span data-stu-id="10661-123">DROP AVAILABILITY GROUP can be run from any [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] node in the WSFC failover cluster.</span></span>  
  
##  <a name="restrictions-on-the-availability-group-transact-sql-statements"></a><a name="Restrictions"></a> <span data-ttu-id="10661-124">Ограничения на инструкции AVAILABILITY GROUP языка Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="10661-124">Restrictions on the AVAILABILITY GROUP Transact-SQL Statements</span></span>  
 <span data-ttu-id="10661-125">Инструкции CREATE AVAILABILITY GROUP, ALTER AVAILABILITY GROUP и DROP AVAILABILITY GROUP [!INCLUDE[tsql](../../../includes/tsql-md.md)] имеют следующие ограничения.</span><span class="sxs-lookup"><span data-stu-id="10661-125">The CREATE AVAILABILITY GROUP, ALTER AVAILABILITY GROUP, and DROP AVAILABILITY GROUP [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements have the following limitations:</span></span>  
  
-   <span data-ttu-id="10661-126">За исключением DROP AVAILABILITY GROUP, для выполнения этих инструкций требуется, чтобы была включена служба HADR на экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="10661-126">With the exception of DROP AVAILABILITY GROUP, executing these statements requires that the HADR service is enabled on the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="10661-127">Дополнительные сведения см. в разделе [Включение и отключение групп доступности AlwaysOn (SQL Server)](enable-and-disable-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="10661-127">For more information, see [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span></span>  
  
-   <span data-ttu-id="10661-128">Эти инструкции не могут выполняться в пределах транзакций или пакетов.</span><span class="sxs-lookup"><span data-stu-id="10661-128">These statements cannot be executed within transactions or batches.</span></span>  
  
-   <span data-ttu-id="10661-129">Несмотря на то, что эти инструкции предназначены для восстановления после сбоя, они не гарантируют выполнения отката всех изменений при сбое.</span><span class="sxs-lookup"><span data-stu-id="10661-129">Though they make a best effort to clean up after a failure, these statements do not guarantee that they will roll back all changes on failure.</span></span> <span data-ttu-id="10661-130">Однако системы должны быть способны четко выполнять обработку и пропуск частичных сбоев.</span><span class="sxs-lookup"><span data-stu-id="10661-130">However, systems should be able cleanly handle and then ignore partial failures.</span></span>  
  
-   <span data-ttu-id="10661-131">Эти инструкции не поддерживают выражения или переменные.</span><span class="sxs-lookup"><span data-stu-id="10661-131">These statements do not support expressions or variables.</span></span>  
  
-   <span data-ttu-id="10661-132">Если во время действия группы доступности или восстановления выполняется инструкция [!INCLUDE[tsql](../../../includes/tsql-md.md)] , эта инструкция возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="10661-132">If a [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement is executed while another availability group action or recovery is in process, the statement returns an error.</span></span> <span data-ttu-id="10661-133">В случае необходимости дождитесь завершения действия или восстановления, а затем повторно выполните инструкцию.</span><span class="sxs-lookup"><span data-stu-id="10661-133">Wait for the action or recovery to complete, and retry the statement, if necessary.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="10661-134">См. также:</span><span class="sxs-lookup"><span data-stu-id="10661-134">See Also</span></span>  
 [<span data-ttu-id="10661-135">Общие сведения о группы доступности AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="10661-135">Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](overview-of-always-on-availability-groups-sql-server.md)  
  
  
