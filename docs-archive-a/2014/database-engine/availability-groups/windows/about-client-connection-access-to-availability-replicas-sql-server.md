---
title: Сведения о доступе клиентского подключения к репликам доступности (SQL Server) | Документы Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], readable secondary replicas
- active secondary replicas [SQL Server], read-only access to
- Availability Groups [SQL Server], configuring
- Availability Groups [SQL Server], client connectivity
- Availability Groups [SQL Server], active secondary replicas
ms.assetid: 29027e46-43e4-4b45-b650-c4cdeacdf552
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 79e61f29957d90a429d8a0c66782ca7cf2e7bd4c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87733173"
---
# <a name="about-client-connection-access-to-availability-replicas-sql-server"></a><span data-ttu-id="25131-102">Сведения о доступе клиентского подключения к репликам доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="25131-102">About Client Connection Access to Availability Replicas (SQL Server)</span></span>
  <span data-ttu-id="25131-103">В группе доступности AlwaysOn можно настроить одну или несколько реплик доступности, подключения к которой могут выполняться в режиме только для чтения, когда они являются вторичными (то есть при работе в качестве вторичной реплики).</span><span class="sxs-lookup"><span data-stu-id="25131-103">In an AlwaysOn availability group, you can configure one or more availability replicas to allow read-only connections when running under the secondary role (that is, when running as a secondary replica).</span></span> <span data-ttu-id="25131-104">Каждую реплику доступности можно также настроить так, чтобы она разрешала или исключала соединения только для чтения во время работы под первичной ролью (т. е. во время работы в качестве первичной реплики).</span><span class="sxs-lookup"><span data-stu-id="25131-104">You can also configure each availability replica to allow or exclude read-only connections when running under the primary role (that is, when running as the primary replica).</span></span>  
  
 <span data-ttu-id="25131-105">Чтобы упростить клиентский доступ к базе данных-источнику или получателю в данной группе доступности, необходимо определить прослушиватель группы доступности.</span><span class="sxs-lookup"><span data-stu-id="25131-105">To facilitate client access to primary or secondary databases of a given availability group, you should define an availability group listener.</span></span> <span data-ttu-id="25131-106">По умолчанию новые соединения с прослушивателем группы доступности будут перенаправляться к первичной реплике.</span><span class="sxs-lookup"><span data-stu-id="25131-106">By default, the availability group listener directs incoming connections to the primary replica.</span></span> <span data-ttu-id="25131-107">Однако можно настроить группу доступности для поддержки маршрутизации только для чтения, которая позволяет своему прослушивателю переадресовывать запросы на соединения только для чтения на вторичную реплику только для чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-107">However, you can configure an availability group to support read-only routing, which enables its availability group listener to redirect the connection requests of read-intent applications to a readable secondary replica.</span></span> <span data-ttu-id="25131-108">Дополнительные сведения см. в статье [Настройка маршрутизации только для чтения в группе доступности (SQL Server)](configure-read-only-routing-for-an-availability-group-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="25131-108">For more information, see [Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md).</span></span>  
  
 <span data-ttu-id="25131-109">Во время отработки отказа вторичная реплика принимает первичную роль, а прежняя первичная реплика — вторичную роль.</span><span class="sxs-lookup"><span data-stu-id="25131-109">During a failover, a secondary replica transitions to the primary role and the former primary replica transitions to the secondary role.</span></span> <span data-ttu-id="25131-110">Во время процесса отработки отказа завершаются все клиентские соединения с первичной и вторичной репликами.</span><span class="sxs-lookup"><span data-stu-id="25131-110">During the failover process, all client connections to both the primary replica and secondary replicas are terminated.</span></span> <span data-ttu-id="25131-111">После отработки отказа, когда клиент выполняет повторное соединение с прослушивателем группы доступности, прослушиватель соединяет клиента с новой первичной репликой, кроме тех случаев, когда выполняется запрос на соединение только для чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-111">After the failover, when a client reconnects to the availability group listener, the listener reconnects the client to the new primary replica, except for a read-intent connect request.</span></span> <span data-ttu-id="25131-112">Если маршрутизация только для чтения настроена для клиента и для экземпляров сервера, на которых размещена первичная реплика и хотя бы одна вторичная реплика доступна только для чтения, то запросы на соединение только для чтения перенаправляются на вторичную реплику, которая поддерживает необходимый клиенту тип соединения и доступа.</span><span class="sxs-lookup"><span data-stu-id="25131-112">If read-only routing is configured on the client and on the server instances that hosts the new primary replica and on at least one readable secondary replica, read-intent connection requests are re-routed to a secondary replica that supports the type of connection access that the client requires.</span></span> <span data-ttu-id="25131-113">Чтобы обеспечить непрерывность работы клиента после отработки отказа, важно настроить доступ соединения как для вторичной, так и для первичной ролей каждой реплики доступности.</span><span class="sxs-lookup"><span data-stu-id="25131-113">To ensure a graceful client experience after a failover, it is important to configure connection access for both the secondary and primary roles of every availability replica.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="25131-114">Сведения о прослушивателе групп доступности, обрабатывающем запросы на клиентские подключения, см. в разделе [Прослушиватели групп доступности, возможность подключения клиентов и отработка отказа приложений (SQL Server)](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="25131-114">For information about the availability group listener, which handles client connection requests, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
 <span data-ttu-id="25131-115">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="25131-115">**In This Topic:**</span></span>  
  
-   [<span data-ttu-id="25131-116">Типы доступа к соединению, поддерживаемые вторичной ролью</span><span class="sxs-lookup"><span data-stu-id="25131-116">Types of Connection Access Supported by the Secondary Role</span></span>](#ConnectAccessForSecondary)  
  
-   [<span data-ttu-id="25131-117">Типы доступа к соединению, поддерживаемые первичной ролью</span><span class="sxs-lookup"><span data-stu-id="25131-117">Types of Connection Access Supported by the Primary Role</span></span>](#ConnectAccessForPrimary)  
  
-   [<span data-ttu-id="25131-118">Влияние конфигурации доступа подключения на подключение клиента</span><span class="sxs-lookup"><span data-stu-id="25131-118">How the Connection Access Configuration Affects Client Connectivity</span></span>](#HowConnectionAccessAffectsConnectivity)  
  
-   [<span data-ttu-id="25131-119">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="25131-119">Related Tasks</span></span>](#RelatedTasks)  
  
-   [<span data-ttu-id="25131-120">См. также</span><span class="sxs-lookup"><span data-stu-id="25131-120">Related Content</span></span>](#RelatedContent)  
  
##  <a name="types-of-connection-access-supported-by-the-secondary-role"></a><a name="ConnectAccessForSecondary"></a> <span data-ttu-id="25131-121">Типы доступа соединений, поддерживаемые вторичной ролью</span><span class="sxs-lookup"><span data-stu-id="25131-121">Types of Connection Access Supported by the Secondary Role</span></span>  
 <span data-ttu-id="25131-122">Вторичная роль поддерживает три альтернативных варианта клиентского соединения, а именно:</span><span class="sxs-lookup"><span data-stu-id="25131-122">The secondary role supports three alternatives for client connections, as follows:</span></span>  
  
 <span data-ttu-id="25131-123">Нет соединений</span><span class="sxs-lookup"><span data-stu-id="25131-123">No connections</span></span>  
 <span data-ttu-id="25131-124">Пользовательские соединения не разрешены.</span><span class="sxs-lookup"><span data-stu-id="25131-124">No user connections are allowed.</span></span> <span data-ttu-id="25131-125">Базы данных-получатели недоступны для доступа в режиме чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-125">Secondary databases are not available for read access.</span></span> <span data-ttu-id="25131-126">Это поведение по умолчанию во вторичной роли.</span><span class="sxs-lookup"><span data-stu-id="25131-126">This is the default behavior in the secondary role.</span></span>  
  
 <span data-ttu-id="25131-127">Соединение с намерением только чтения</span><span class="sxs-lookup"><span data-stu-id="25131-127">Only read-intent connections</span></span>  
 <span data-ttu-id="25131-128">Базы данных-получатели доступны только для подключений, для которых `Application Intent` свойство Connection имеет значение `ReadOnly` (*соединения с намерением чтения*).</span><span class="sxs-lookup"><span data-stu-id="25131-128">The secondary database(s) are available only for connection for which the `Application Intent` connection property is set to `ReadOnly` (*read-intent connections*).</span></span>  
  
 <span data-ttu-id="25131-129">Дополнительные сведения об этом свойстве соединения см. в разделе [Поддержка высокого уровня доступности и аварийного восстановления собственного клиента SQL Server](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="25131-129">For information about this connection property, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
 <span data-ttu-id="25131-130">разрешение любого подключения только для чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-130">Allow any read-only connection</span></span>  
 <span data-ttu-id="25131-131">Для всех баз данных-получателей разрешены соединения доступа только для чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-131">The secondary database(s) are all available for read access connections.</span></span> <span data-ttu-id="25131-132">Этот вариант разрешает соединения клиентам с более ранними версиями ПО.</span><span class="sxs-lookup"><span data-stu-id="25131-132">This option allows lower versioned clients to connect.</span></span>  
  
 <span data-ttu-id="25131-133">Дополнительные сведения см. в разделе [Настройка доступа только для чтения в реплике доступности (SQL Server)](configure-read-only-access-on-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="25131-133">For more information, see [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md).</span></span>  
  
##  <a name="types-of-connection-access-supported-by-the-primary-role"></a><a name="ConnectAccessForPrimary"></a> <span data-ttu-id="25131-134">Типы доступа соединений, поддерживаемые первичной ролью</span><span class="sxs-lookup"><span data-stu-id="25131-134">Types of Connection Access Supported by the Primary Role</span></span>  
 <span data-ttu-id="25131-135">Первичная роль поддерживает два альтернативных варианта клиентского соединения, а именно:</span><span class="sxs-lookup"><span data-stu-id="25131-135">The primary role supports two alternatives for client connections, as follows:</span></span>  
  
 <span data-ttu-id="25131-136">Разрешены все соединения</span><span class="sxs-lookup"><span data-stu-id="25131-136">All connections are allowed</span></span>  
 <span data-ttu-id="25131-137">К базам данных-источникам разрешено как соединение в режиме «чтение-запись», так и соединение в режиме «только чтение».</span><span class="sxs-lookup"><span data-stu-id="25131-137">Both read-write and read-only connections are allowed to primary databases.</span></span> <span data-ttu-id="25131-138">Это поведение по умолчанию для первичной роли.</span><span class="sxs-lookup"><span data-stu-id="25131-138">This is the default behavior for the primary role.</span></span>  
  
 <span data-ttu-id="25131-139">Разрешены только соединения в режиме «чтение-запись»</span><span class="sxs-lookup"><span data-stu-id="25131-139">Allow only read-write connections</span></span>  
 <span data-ttu-id="25131-140">Если `Application Intent` свойство Connection имеет значение **ReadWrite** или не задано, соединение разрешено.</span><span class="sxs-lookup"><span data-stu-id="25131-140">When the `Application Intent` connection property is set to **ReadWrite** or is not set, the connection is allowed.</span></span> <span data-ttu-id="25131-141">Соединения, для которых `Application Intent` задано ключевое слово строки подключения `ReadOnly` , не разрешены.</span><span class="sxs-lookup"><span data-stu-id="25131-141">Connections for which the `Application Intent` connection string keyword is set to `ReadOnly` are not allowed.</span></span> <span data-ttu-id="25131-142">Разрешая соединения только в режиме «чтение-запись», можно предотвратить случаи, когда клиенты по ошибке подключают к первичной реплике рабочую нагрузку с намерением чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-142">Allowing only read-write connections can help prevent your customers from connecting a read-intent work load to the primary replica by mistake.</span></span>  
  
 <span data-ttu-id="25131-143">Дополнительные сведения об этом свойстве соединения см. в разделе [Using Connection String Keywords with SQL Server Native Client](../../../relational-databases/native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="25131-143">For information about this connection property, see [Using Connection String Keywords with SQL Server Native Client](../../../relational-databases/native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="25131-144">Дополнительные сведения см. в разделе [Настройка доступа только для чтения в реплике доступности (SQL Server)](configure-read-only-access-on-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="25131-144">For more information, see [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md).</span></span>  
  
##  <a name="how-the-connection-access-configuration-affects-client-connectivity"></a><a name="HowConnectionAccessAffectsConnectivity"></a> <span data-ttu-id="25131-145">Влияние конфигурации доступа соединения на клиентское соединение</span><span class="sxs-lookup"><span data-stu-id="25131-145">How the Connection Access Configuration Affects Client Connectivity</span></span>  
 <span data-ttu-id="25131-146">Параметры доступа соединения реплики определяют, проходит или не проходит попытка соединения.</span><span class="sxs-lookup"><span data-stu-id="25131-146">The connection access settings of a replica determine whether a connection attempt fails or succeeds.</span></span> <span data-ttu-id="25131-147">В следующей таблице приведены сводные сведения о том, проходит или не проходит попытка соединения по каждому параметру доступа соединения.</span><span class="sxs-lookup"><span data-stu-id="25131-147">The following table summarizes whether a given connection attempt succeeds or fails for each the connection-access setting.</span></span>  
  
|<span data-ttu-id="25131-148">Роль реплики</span><span class="sxs-lookup"><span data-stu-id="25131-148">Replica Role</span></span>|<span data-ttu-id="25131-149">Поддержка доступа к соединению в реплике</span><span class="sxs-lookup"><span data-stu-id="25131-149">Connection Access Supported on Replica</span></span>|<span data-ttu-id="25131-150">Назначение соединения</span><span class="sxs-lookup"><span data-stu-id="25131-150">Connection Intent</span></span>|<span data-ttu-id="25131-151">Результат попытки подключения</span><span class="sxs-lookup"><span data-stu-id="25131-151">Connection-Attempt Result</span></span>|  
|------------------|--------------------------------------------|-----------------------|--------------------------------|  
|<span data-ttu-id="25131-152">Вторичная</span><span class="sxs-lookup"><span data-stu-id="25131-152">Secondary</span></span>|<span data-ttu-id="25131-153">Все</span><span class="sxs-lookup"><span data-stu-id="25131-153">All</span></span>|<span data-ttu-id="25131-154">С намерением только чтения, чтения-записи или назначение соединения не указано</span><span class="sxs-lookup"><span data-stu-id="25131-154">Read-intent, read-write, or no connection intent specified</span></span>|<span data-ttu-id="25131-155">Успешно</span><span class="sxs-lookup"><span data-stu-id="25131-155">Success</span></span>|  
|<span data-ttu-id="25131-156">Вторичная</span><span class="sxs-lookup"><span data-stu-id="25131-156">Secondary</span></span>|<span data-ttu-id="25131-157">Нет (поведение по умолчанию вторичной реплики).</span><span class="sxs-lookup"><span data-stu-id="25131-157">None (This is the default secondary behavior.)</span></span>|<span data-ttu-id="25131-158">С намерением только чтения, чтения-записи или назначение соединения не указано</span><span class="sxs-lookup"><span data-stu-id="25131-158">Read-intent, read-write, or no connection intent specified</span></span>|<span data-ttu-id="25131-159">Сбой</span><span class="sxs-lookup"><span data-stu-id="25131-159">Failure</span></span>|  
|<span data-ttu-id="25131-160">Вторичная</span><span class="sxs-lookup"><span data-stu-id="25131-160">Secondary</span></span>|<span data-ttu-id="25131-161">Назначение — только чтение</span><span class="sxs-lookup"><span data-stu-id="25131-161">Read-intent only</span></span>|<span data-ttu-id="25131-162">С намерением чтения</span><span class="sxs-lookup"><span data-stu-id="25131-162">Read-intent</span></span>|<span data-ttu-id="25131-163">Успешно</span><span class="sxs-lookup"><span data-stu-id="25131-163">Success</span></span>|  
|<span data-ttu-id="25131-164">Вторичная</span><span class="sxs-lookup"><span data-stu-id="25131-164">Secondary</span></span>|<span data-ttu-id="25131-165">Назначение — только чтение</span><span class="sxs-lookup"><span data-stu-id="25131-165">Read-intent only</span></span>|<span data-ttu-id="25131-166">С намерением чтения-записи или назначение соединения не указано</span><span class="sxs-lookup"><span data-stu-id="25131-166">Read-write or no connection intent specified</span></span>|<span data-ttu-id="25131-167">Сбой</span><span class="sxs-lookup"><span data-stu-id="25131-167">Failure</span></span>|  
|<span data-ttu-id="25131-168">Первичный</span><span class="sxs-lookup"><span data-stu-id="25131-168">Primary</span></span>|<span data-ttu-id="25131-169">Все (поведение по умолчанию первичной реплики).</span><span class="sxs-lookup"><span data-stu-id="25131-169">All (This is the default primary behavior.)</span></span>|<span data-ttu-id="25131-170">С намерением только чтения, чтения-записи или назначение соединения не указано</span><span class="sxs-lookup"><span data-stu-id="25131-170">Read-only, read-write, or no connection intent specified</span></span>|<span data-ttu-id="25131-171">Успешно</span><span class="sxs-lookup"><span data-stu-id="25131-171">Success</span></span>|  
|<span data-ttu-id="25131-172">Первичный</span><span class="sxs-lookup"><span data-stu-id="25131-172">Primary</span></span>|<span data-ttu-id="25131-173">Чтение и запись</span><span class="sxs-lookup"><span data-stu-id="25131-173">Read-write</span></span>|<span data-ttu-id="25131-174">Назначение — только чтение</span><span class="sxs-lookup"><span data-stu-id="25131-174">Read-intent only</span></span>|<span data-ttu-id="25131-175">Сбой</span><span class="sxs-lookup"><span data-stu-id="25131-175">Failure</span></span>|  
|<span data-ttu-id="25131-176">Первичный</span><span class="sxs-lookup"><span data-stu-id="25131-176">Primary</span></span>|<span data-ttu-id="25131-177">Чтение и запись</span><span class="sxs-lookup"><span data-stu-id="25131-177">Read-write</span></span>|<span data-ttu-id="25131-178">С намерением чтения-записи или назначение соединения не указано</span><span class="sxs-lookup"><span data-stu-id="25131-178">Read-write or no connection intent specified</span></span>|<span data-ttu-id="25131-179">Успешно</span><span class="sxs-lookup"><span data-stu-id="25131-179">Success</span></span>|  
  
 <span data-ttu-id="25131-180">Сведения о настройке группы доступности для приема клиентских подключений к ее репликам см. в разделе [Прослушиватели групп доступности, возможность подключения клиентов и отработка отказа приложений (SQL Server)](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="25131-180">For information about configuring an availability group to accept client connections to its replicas, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
### <a name="example-connection-access-configuration"></a><span data-ttu-id="25131-181">Пример конфигурации доступа соединения</span><span class="sxs-lookup"><span data-stu-id="25131-181">Example Connection-Access Configuration</span></span>  
 <span data-ttu-id="25131-182">В зависимости от различных конфигураций реплик доступности для доступа соединения, поддержка клиентских соединений может измениться после отработки отказа группой доступности.</span><span class="sxs-lookup"><span data-stu-id="25131-182">Depending on how different availability replicas are configured for connection access, support for client connections might change after an availability group fails over.</span></span> <span data-ttu-id="25131-183">Рассмотрим группу доступности, для которой отправка отчетов выполняется на удаленных вторичных репликах с асинхронной фиксацией.</span><span class="sxs-lookup"><span data-stu-id="25131-183">For example, consider an availability group for which reporting is performed on remote asynchronous-commit secondary replicas.</span></span> <span data-ttu-id="25131-184">Все приложения, работающие в режиме только для чтения, для базы данных в этой группе доступности устанавливают свое свойство соединения `Application Intent` в значение `ReadOnly`, после чего все соединения в режиме только для чтения становятся соединениями с намерением только чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-184">All of the read-only applications for the databases in this availability group set their `Application Intent` connection property to `ReadOnly`, so that all read-only connections are read-intent connections.</span></span>  
  
 <span data-ttu-id="25131-185">В примере этой группы доступности рассматриваются две реплики синхронной фиксации в главном вычислительном центре и две реплики асинхронной фиксации на дополнительном сайте.</span><span class="sxs-lookup"><span data-stu-id="25131-185">This example availability group possesses two synchronous-commit replicas at the main computing center and two asynchronous-commit replicas at a satellite site.</span></span> <span data-ttu-id="25131-186">Для первичной роли все реплики настраиваются на режим доступа «чтение-запись», что предотвращает соединения с намерением только чтения к первичной реплике во всех ситуациях.</span><span class="sxs-lookup"><span data-stu-id="25131-186">For the primary role, all the replicas are configured for read-write access, which prevents read-intent connections to the primary replica in all situations.</span></span> <span data-ttu-id="25131-187">Вторичная реплика с синхронной фиксацией использует конфигурацию доступа соединения по умолчанию (вариант «нет»), что приводит к отказу во всех клиентских соединениях под вторичной ролью.</span><span class="sxs-lookup"><span data-stu-id="25131-187">The synchronous commit secondary role uses the default connection-access configuration ("none"), which prevents all client connections under the secondary role.</span></span>  <span data-ttu-id="25131-188">И наоборот, реплики асинхронной фиксации настраиваются на разрешение соединений с намерением чтения под вторичной ролью.</span><span class="sxs-lookup"><span data-stu-id="25131-188">In contrast, the asynchronous commit replicas are configured to permit read-intent connections under the secondary role.</span></span> <span data-ttu-id="25131-189">В следующей таблице приведена сводка по конфигурации в этом примере.</span><span class="sxs-lookup"><span data-stu-id="25131-189">The following table summarize this example configuration:</span></span>  
  
|<span data-ttu-id="25131-190">Реплика</span><span class="sxs-lookup"><span data-stu-id="25131-190">Replica</span></span>|<span data-ttu-id="25131-191">Режим фиксации</span><span class="sxs-lookup"><span data-stu-id="25131-191">Commit Mode</span></span>|<span data-ttu-id="25131-192">Первоначальная роль</span><span class="sxs-lookup"><span data-stu-id="25131-192">Initial Role</span></span>|<span data-ttu-id="25131-193">Доступ соединения для вторичной роли</span><span class="sxs-lookup"><span data-stu-id="25131-193">Connection Access for Secondary Role</span></span>|<span data-ttu-id="25131-194">Доступ соединения для первичной роли</span><span class="sxs-lookup"><span data-stu-id="25131-194">Connection Access for Primary Role</span></span>|  
|-------------|-----------------|------------------|------------------------------------------|----------------------------------------|  
|<span data-ttu-id="25131-195">Реплика1</span><span class="sxs-lookup"><span data-stu-id="25131-195">Replica1</span></span>|<span data-ttu-id="25131-196">Синхронная</span><span class="sxs-lookup"><span data-stu-id="25131-196">Synchronous</span></span>|<span data-ttu-id="25131-197">Первичный</span><span class="sxs-lookup"><span data-stu-id="25131-197">Primary</span></span>|<span data-ttu-id="25131-198">None</span><span class="sxs-lookup"><span data-stu-id="25131-198">None</span></span>|<span data-ttu-id="25131-199">Чтение и запись</span><span class="sxs-lookup"><span data-stu-id="25131-199">Read-write</span></span>|  
|<span data-ttu-id="25131-200">Реплика2</span><span class="sxs-lookup"><span data-stu-id="25131-200">Replica2</span></span>|<span data-ttu-id="25131-201">Синхронная</span><span class="sxs-lookup"><span data-stu-id="25131-201">Synchronous</span></span>|<span data-ttu-id="25131-202">Вторичная</span><span class="sxs-lookup"><span data-stu-id="25131-202">Secondary</span></span>|<span data-ttu-id="25131-203">Нет</span><span class="sxs-lookup"><span data-stu-id="25131-203">None</span></span>|<span data-ttu-id="25131-204">Чтение и запись</span><span class="sxs-lookup"><span data-stu-id="25131-204">Read-write</span></span>|  
|<span data-ttu-id="25131-205">Реплика3</span><span class="sxs-lookup"><span data-stu-id="25131-205">Replica3</span></span>|<span data-ttu-id="25131-206">Асинхронная</span><span class="sxs-lookup"><span data-stu-id="25131-206">Asynchronous</span></span>|<span data-ttu-id="25131-207">Вторичная</span><span class="sxs-lookup"><span data-stu-id="25131-207">Secondary</span></span>|<span data-ttu-id="25131-208">С намерением только чтения</span><span class="sxs-lookup"><span data-stu-id="25131-208">Read-intentonly</span></span>|<span data-ttu-id="25131-209">Чтение и запись</span><span class="sxs-lookup"><span data-stu-id="25131-209">Read-write</span></span>|  
|<span data-ttu-id="25131-210">Реплика4</span><span class="sxs-lookup"><span data-stu-id="25131-210">Replica4</span></span>|<span data-ttu-id="25131-211">Асинхронный</span><span class="sxs-lookup"><span data-stu-id="25131-211">Asynchronous</span></span>|<span data-ttu-id="25131-212">Вторичная</span><span class="sxs-lookup"><span data-stu-id="25131-212">Secondary</span></span>|<span data-ttu-id="25131-213">Назначение — только чтение</span><span class="sxs-lookup"><span data-stu-id="25131-213">Read-intent only</span></span>|<span data-ttu-id="25131-214">Чтение и запись</span><span class="sxs-lookup"><span data-stu-id="25131-214">Read-write</span></span>|  
  
 <span data-ttu-id="25131-215">Как правило, в этом сценарии отработка отказа происходит только между репликами синхронной фиксации, а приложения, работающие в режиме с намерением только чтения, сразу после отработки отказа могут установить повторное соединение с одной из вторичных реплик асинхронной фиксации.</span><span class="sxs-lookup"><span data-stu-id="25131-215">Typically, in this example scenario, failovers occur only between the synchronous-commit replicas, and  immediately after the failover, read-intent applications are able to reconnect to one of the asynchronous-commit secondary replicas.</span></span> <span data-ttu-id="25131-216">Однако, когда авария происходит в главном вычислительном центре, будут потеряны обе реплики синхронной фиксации.</span><span class="sxs-lookup"><span data-stu-id="25131-216">However, when a disaster occurs at the main computing center both synchronous-commit replicas are lost.</span></span> <span data-ttu-id="25131-217">Администратор баз данных на дополнительном сайте должен выполнить принудительный переход на другой ресурс вручную на вторичную реплику асинхронной фиксации.</span><span class="sxs-lookup"><span data-stu-id="25131-217">The database administrator at the satellite site responds by performing a forced manual failover to an asynchronous-commit secondary replica.</span></span> <span data-ttu-id="25131-218">При принудительной отработке отказа базы данных-получатели на оставшейся вторичной реплике приостанавливаются и в результате становятся недоступными для рабочих нагрузок в режиме только чтения.</span><span class="sxs-lookup"><span data-stu-id="25131-218">The secondary databases on the remaining secondary replica are suspended by the forced failover, making them unavailable for read-only workloads.</span></span> <span data-ttu-id="25131-219">Новая первичная реплика, настроенная для соединений в режиме «чтение-запись», предотвращает обращения в режиме с намерением только чтения от конкурирующей рабочей нагрузки в режиме «чтение-запись».</span><span class="sxs-lookup"><span data-stu-id="25131-219">The new primary replica, which is configured for read-write connections, prevents the read-intent workload from competing with the read-write workload.</span></span> <span data-ttu-id="25131-220">Это означает, что пока администратор баз данных не возобновит базы данных-получатели на оставшейся вторичной реплике асинхронной фиксации, клиенты, работающие в режиме с намерением только чтения, не могут подключиться ни к одной реплике доступности.</span><span class="sxs-lookup"><span data-stu-id="25131-220">This means that until the database administrator resumes the secondary databases on the remaining asynchronous-commit secondary replica, read-intent clients cannot connect to any availability replica.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="25131-221">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="25131-221">Related Tasks</span></span>  
  
-   [<span data-ttu-id="25131-222">Настройка доступа только для чтения в реплике доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="25131-222">Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;</span></span>](configure-read-only-access-on-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="25131-223">Настройка маршрутизации только для чтения в группе доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="25131-223">Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;</span></span>](configure-read-only-routing-for-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="25131-224">Отслеживание групп доступности (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="25131-224">Monitor Availability Groups &#40;Transact-SQL&#41;</span></span>](monitor-availability-groups-transact-sql.md)  
  
-   [<span data-ttu-id="25131-225">Просмотр свойств реплики доступности (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="25131-225">View Availability Replica Properties &#40;SQL Server&#41;</span></span>](view-availability-replica-properties-sql-server.md)  
  
-   [<span data-ttu-id="25131-226">Использование диалогового окна "Создание группы доступности" (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="25131-226">Use the New Availability Group Dialog Box &#40;SQL Server Management Studio&#41;</span></span>](use-the-new-availability-group-dialog-box-sql-server-management-studio.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="25131-227">См. также</span><span class="sxs-lookup"><span data-stu-id="25131-227">Related Content</span></span>  
  
-   [<span data-ttu-id="25131-228">Руководство по решениям режима AlwaysOn в Microsoft SQL Server для обеспечения высокой доступности и аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="25131-228">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="25131-229">Блог группы разработчиков SQL Server AlwaysOn: официальный блог группы разработчиков SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="25131-229">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="25131-230">См. также:</span><span class="sxs-lookup"><span data-stu-id="25131-230">See Also</span></span>  
 <span data-ttu-id="25131-231">[Общие сведения о группы доступности AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="25131-231">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="25131-232">[Прослушиватели групп доступности, возможность подключения клиентов и отработка отказа приложений (SQL Server)](../../listeners-client-connectivity-application-failover.md) </span><span class="sxs-lookup"><span data-stu-id="25131-232">[Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span></span>  
 [<span data-ttu-id="25131-233">Статистика</span><span class="sxs-lookup"><span data-stu-id="25131-233">Statistics</span></span>](../../../relational-databases/statistics/statistics.md)  
  
  
