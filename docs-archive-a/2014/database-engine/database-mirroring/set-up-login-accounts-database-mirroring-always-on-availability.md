---
title: Настройка учетных записей входа для зеркального отображения базы данных или группы доступности AlwaysOn (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- database mirroring [SQL Server], deployment
- logins [SQL Server], database mirroring
ms.assetid: e9f5287b-1325-4cda-88a6-19eaaa52a652
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: d149016dabd0239bd76eadc8655b6752afd916d9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87733053"
---
# <a name="set-up-login-accounts-for-database-mirroring-or-alwayson-availability-groups-sql-server"></a><span data-ttu-id="3d503-102">Настройка учетных записей входа для зеркального отображения баз данных или групп доступности AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="3d503-102">Set Up Login Accounts for Database Mirroring or AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="3d503-103">Чтобы два экземпляра сервера могли подключиться к [конечным точкам зеркального отображения базы данных](the-database-mirroring-endpoint-sql-server.md) друг друга, именам входа каждого экземпляра требуется доступ к другому экземпляру.</span><span class="sxs-lookup"><span data-stu-id="3d503-103">For two server instances to connect to each other's [database mirroring endpoint](the-database-mirroring-endpoint-sql-server.md) point, the login account of each instance requires access to the other instance.</span></span> <span data-ttu-id="3d503-104">Кроме того, каждой учетной записи требуется разрешение на подключение к конечной точке зеркального отображения базы данных на другом экземпляре.</span><span class="sxs-lookup"><span data-stu-id="3d503-104">Also, each login account requires connect permission to the Database Mirroring endpoint of the other instance.</span></span>  
  
 <span data-ttu-id="3d503-105">Влияние этого требования зависит от того, выполняются ли экземпляры сервера под одной и той же учетной записью пользователя домена.</span><span class="sxs-lookup"><span data-stu-id="3d503-105">The impact of this requirement depends on whether the server instances run as the same domain user account:</span></span>  
  
-   <span data-ttu-id="3d503-106">Если экземпляры сервера запущены под одной и той же учетной записью домена, правильные имена входа автоматически существуют в обеих базах данных **master** .</span><span class="sxs-lookup"><span data-stu-id="3d503-106">If the server instances run as the same domain user account, the correct user logins exist automatically in both **master** databases.</span></span> <span data-ttu-id="3d503-107">Это упрощает настройку безопасности для зеркального отображения базы данных и групп доступности AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="3d503-107">This simplifies the security configuration for Database Mirroring and AlwaysOn Availability Groups.</span></span>  
  
-   <span data-ttu-id="3d503-108">Если экземпляры серверов запущены под разными учетными записями, то имена входа на экземпляре сервера, на котором расположен основной сервер или первичная реплика, необходимо вручную воспроизвести на экземпляре сервера, на котором размещен сервер зеркального отображения, или на всех экземплярах серверов, на которых размещены вторичные реплики.</span><span class="sxs-lookup"><span data-stu-id="3d503-108">If the server instances run as different user accounts, user logins on the server instance that hosts the principal server or primary replica must be manually reproduced on the server instance that hosts the mirror server or on every server instance that hosts a secondary replica.</span></span> <span data-ttu-id="3d503-109">Дополнительные сведения см. в подразделах [Создание имени входа для другой учетной записи](#CreateLogin) и [Предоставление разрешения на подключение](#GrantConnect)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="3d503-109">For more information, see [Create a Login for a Different Account](#CreateLogin) and [Grant Connect Permission](#GrantConnect), later in this topic.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="3d503-110">Для создания более безопасной среды рассмотрите возможность использования отдельных учетных записей домена для каждого экземпляра сервера.</span><span class="sxs-lookup"><span data-stu-id="3d503-110">To create a more secure environment, consider using separate domain accounts for each server instance.</span></span>  
  
##  <a name="create-a-login-for-a-different-account"></a><a name="CreateLogin"></a><span data-ttu-id="3d503-111">Создание имени входа для другой учетной записи</span><span class="sxs-lookup"><span data-stu-id="3d503-111">Create a Login for a Different Account</span></span>  
 <span data-ttu-id="3d503-112">Если два экземпляра сервера запущены под разными учетными записями, системный администратор должен использовать инструкцию CREATE LOGIN [!INCLUDE[tsql](../../includes/tsql-md.md)] для создания имени входа для учетной записи службы запуска удаленного экземпляра для каждого экземпляра сервера.</span><span class="sxs-lookup"><span data-stu-id="3d503-112">If two server instances run as different accounts, the system administrator must use the CREATE LOGIN [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to create a login for the startup service account of the remote instance for each server instance.</span></span> <span data-ttu-id="3d503-113">Дополнительные сведения см. в разделе [CREATE LOGIN (Transact-SQL)](/sql/t-sql/statements/create-login-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3d503-113">For more information, see [CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3d503-114">Если [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] запущен под учетной записью, не относящейся к домену, следует использовать сертификаты.</span><span class="sxs-lookup"><span data-stu-id="3d503-114">If you run [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] under a non-domain account, you must use certificates.</span></span> <span data-ttu-id="3d503-115">Дополнительные сведения см. в разделе [Использование сертификатов для конечной точки зеркального отображения базы данных (Transact-SQL)](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="3d503-115">For more information, see [Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span></span>  
  
 <span data-ttu-id="3d503-116">Например, для подключения экземпляра сервера sqlA, запущенного под именем loginA к экземпляру сервера sqlB, запущенному под именем loginB, необходимо, чтобы имя loginA существовало на сервере sqlB, а имя loginB — на сервере sqlA.</span><span class="sxs-lookup"><span data-stu-id="3d503-116">For example, for the server instance sqlA, which runs under loginA, to connect to the server instance sqlB, which runs under loginB, loginA must exist on sqlB, and loginB must exist on sqlA.</span></span> <span data-ttu-id="3d503-117">Кроме того, если в сеансе зеркального отображения базы данных участвует экземпляр следящего сервера (sqlC) и если все три экземпляра сервера запущены под разными учетными записями домена, то необходимо создать следующие учетные записи для зеркального отображения:</span><span class="sxs-lookup"><span data-stu-id="3d503-117">In addition, for a database mirroring session that includes a witness server instance (sqlC) and in which the three server instances run under different domain accounts, the following logins must be created:</span></span>  
  
|<span data-ttu-id="3d503-118">На экземпляре...</span><span class="sxs-lookup"><span data-stu-id="3d503-118">On instance...</span></span>|<span data-ttu-id="3d503-119">Необходимо создать имена входа и предоставить разрешение на соединение с...</span><span class="sxs-lookup"><span data-stu-id="3d503-119">Create logins for and grant connection permission to ...</span></span>|  
|--------------------|--------------------------------------------------------------|  
|<span data-ttu-id="3d503-120">sqlA</span><span class="sxs-lookup"><span data-stu-id="3d503-120">sqlA</span></span>|<span data-ttu-id="3d503-121">sqlB и sqlC</span><span class="sxs-lookup"><span data-stu-id="3d503-121">sqlB and sqlC</span></span>|  
|<span data-ttu-id="3d503-122">sqlB</span><span class="sxs-lookup"><span data-stu-id="3d503-122">sqlB</span></span>|<span data-ttu-id="3d503-123">sqlA и sqlC</span><span class="sxs-lookup"><span data-stu-id="3d503-123">sqlA and sqlC</span></span>|  
|<span data-ttu-id="3d503-124">sqlC</span><span class="sxs-lookup"><span data-stu-id="3d503-124">sqlC</span></span>|<span data-ttu-id="3d503-125">sqlA и sqlB</span><span class="sxs-lookup"><span data-stu-id="3d503-125">sqlA and sqlB</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="3d503-126">Можно подключиться, используя учетную запись сетевой службы, если вместо пользователя домена указать учетную запись компьютера.</span><span class="sxs-lookup"><span data-stu-id="3d503-126">It is possible to connect with the network service account by using the machine account instead of a domain user.</span></span> <span data-ttu-id="3d503-127">При использовании учетной записи компьютера ее необходимо добавить в качестве пользователя на другом экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="3d503-127">If the machine account is used, it must be added as a user on the other server instance.</span></span>  
  
##  <a name="grant-connect-permission"></a><a name="GrantConnect"></a><span data-ttu-id="3d503-128">Предоставление разрешения на подключение</span><span class="sxs-lookup"><span data-stu-id="3d503-128">Grant Connect Permission</span></span>  
 <span data-ttu-id="3d503-129">После создания имени входа на экземпляре сервера имени входа должно быть предоставлено разрешение на соединение с конечной точкой зеркального отображения базы данных на другом экземпляре.</span><span class="sxs-lookup"><span data-stu-id="3d503-129">Once a login has been created on a server instance, the login must be granted permission to connect to the database mirroring endpoint of the server instance.</span></span> <span data-ttu-id="3d503-130">Системный администратор предоставляет разрешение на подключение с помощью инструкции [!INCLUDE[tsql](../../includes/tsql-md.md)] GRANT.</span><span class="sxs-lookup"><span data-stu-id="3d503-130">The system administrator grants the connect permission using a GRANT [!INCLUDE[tsql](../../includes/tsql-md.md)] statement.</span></span> <span data-ttu-id="3d503-131">Дополнительные сведения см. в статье [GRANT (Transact-SQL)](/sql/t-sql/statements/grant-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3d503-131">For more information, see [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="3d503-132">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="3d503-132">Related Tasks</span></span>  
  
-   [<span data-ttu-id="3d503-133">Создание имени входа</span><span class="sxs-lookup"><span data-stu-id="3d503-133">Create a Login</span></span>](../../relational-databases/security/authentication-access/create-a-login.md)  
  
-   <span data-ttu-id="3d503-134">[Разрешите сетевой доступ к конечной точке зеркального отображения базы данных, используя проверку подлинности Windows &#40;SQL Server&#41;](../database-mirroring-allow-network-access-windows-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="3d503-134">[Allow Network Access to a Database Mirroring Endpoint Using Windows Authentication &#40;SQL Server&#41;](../database-mirroring-allow-network-access-windows-authentication.md).</span></span>  
  
-   [<span data-ttu-id="3d503-135">Использование сертификатов для конечной точки зеркального отображения базы данных (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="3d503-135">Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;</span></span>](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="3d503-136">См. также:</span><span class="sxs-lookup"><span data-stu-id="3d503-136">See Also</span></span>  
 <span data-ttu-id="3d503-137">[Конечная точка зеркального отображения базы данных (SQL Server)](the-database-mirroring-endpoint-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="3d503-137">[The Database Mirroring Endpoint &#40;SQL Server&#41;](the-database-mirroring-endpoint-sql-server.md) </span></span>  
 <span data-ttu-id="3d503-138">[Диагностика конфигурации зеркального отображения базы данных (SQL Server)](troubleshoot-database-mirroring-configuration-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="3d503-138">[Troubleshoot Database Mirroring Configuration &#40;SQL Server&#41;](troubleshoot-database-mirroring-configuration-sql-server.md) </span></span>  
 [<span data-ttu-id="3d503-139">Устранение неполадок SQL Server &#40;конфигурации группы доступности AlwaysOn&#41;</span><span class="sxs-lookup"><span data-stu-id="3d503-139">Troubleshoot AlwaysOn Availability Groups Configuration &#40;SQL Server&#41;</span></span>](../availability-groups/windows/troubleshoot-always-on-availability-groups-configuration-sql-server.md)  
  
  
