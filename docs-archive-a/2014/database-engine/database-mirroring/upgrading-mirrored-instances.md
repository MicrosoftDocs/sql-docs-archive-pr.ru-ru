---
title: Уменьшение времени простоя зеркальных баз данных при обновлении экземпляров сервера | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- upgrading SQL Server, rolling upgrade of mirrored databases
- database mirroring [SQL Server], upgrading system
- rolling upgrades [SQL Server]
ms.assetid: 0e73bd23-497d-42f1-9e81-8d5314bcd597
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 0a343e6b9e93aa1910c82f436f3a50daf00d57bc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87658400"
---
# <a name="minimize-downtime-for-mirrored-databases-when-upgrading-server-instances"></a><span data-ttu-id="73fd5-102">Снижение времени простоя зеркальных баз данных при обновлении экземпляров сервера</span><span class="sxs-lookup"><span data-stu-id="73fd5-102">Minimize Downtime for Mirrored Databases When Upgrading Server Instances</span></span>
  <span data-ttu-id="73fd5-103">При обновлении экземпляров сервера до [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] можно сократить время простоя для каждой зеркально отображаемой базы данных на отработку отказа вручную, выполнив последовательное обновление, которое называется последовательным *обновлением*.</span><span class="sxs-lookup"><span data-stu-id="73fd5-103">When upgrading server instances to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you can reduce downtime for each mirrored database to only a single manual failover by performing a sequential upgrade, known as a *rolling upgrade*.</span></span> <span data-ttu-id="73fd5-104">Последовательное обновление является многоэтапным процессом, который в самом простом случае заключается в обновлении экземпляра сервера, который выступает в роли зеркального сервера в сеансе зеркального отображения, и последующего перехода на зеркальную базу данных вручную, обновления сервера, бывшего основным, и возобновления зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-104">A rolling upgrade is a multi-stage process that in its simplest form involves upgrading the server instance that is currently acting as the mirror server in a mirroring session, then manually failing over the mirrored database, upgrading the former principal server, and resuming mirroring.</span></span> <span data-ttu-id="73fd5-105">Набор операций, фактически применяемый на практике, будет зависеть от режима работы, а также от количества и структуры сеансов зеркального отображения, активных в обновляемых экземплярах сервера.</span><span class="sxs-lookup"><span data-stu-id="73fd5-105">In practice, the exact process will depend on the operating mode and the number and layout of mirroring session running on the server instances that you are upgrading.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="73fd5-106">Сведения о выполнении последовательного обновления для установки пакета обновления или исправления см. в статье [Установка пакета обновления в системе с минимальным временем простоя для зеркальных баз данных](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-106">For information about performing a rolling upgrade to install a service pack or hotfix, see [Install a Service Pack on a System with Minimal Downtime for Mirrored Databases](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md).</span></span>  
  
 <span data-ttu-id="73fd5-107">**Рекомендуемые подготовительные действия (рекомендации)**</span><span class="sxs-lookup"><span data-stu-id="73fd5-107">**Recommended Preparation (Best Practices)**</span></span>  
  
 <span data-ttu-id="73fd5-108">Перед запуском последовательного обновления рекомендуется выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="73fd5-108">Before starting a rolling upgrade, we recommend that you:</span></span>  
  
1.  <span data-ttu-id="73fd5-109">Выполните пробную отработку отказа вручную по крайней мере в одном из сеансов зеркального отображения:</span><span class="sxs-lookup"><span data-stu-id="73fd5-109">Perform a practice manual failover on at least one of your mirroring sessions:</span></span>  
  
    -   [<span data-ttu-id="73fd5-110">Переключение сеанса зеркального отображения базы данных на другой ресурс вручную (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="73fd5-110">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
    -   <span data-ttu-id="73fd5-111">[Переключение сеанса зеркального отображения базы данных на другой ресурс вручную (язык Transact-SQL)](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-111">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73fd5-112">Дополнительные сведения об отработке отказа вручную см. в разделе [Переключение ролей во время сеанса зеркального отображения базы данных (SQL Server)](role-switching-during-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-112">For information about how manual failover works, see [Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="73fd5-113">Обеспечьте защиту данных.</span><span class="sxs-lookup"><span data-stu-id="73fd5-113">Protect your data:</span></span>  
  
    1.  <span data-ttu-id="73fd5-114">Создайте полную резервную копию каждой основной базы данных.</span><span class="sxs-lookup"><span data-stu-id="73fd5-114">Perform a full database backup on every principal database:</span></span>  
  
         <span data-ttu-id="73fd5-115">[Создание полной резервной копии базы данных (SQL Server)](../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md)</span><span class="sxs-lookup"><span data-stu-id="73fd5-115">[Create a Full Database Backup &#40;SQL Server&#41;](../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md).</span></span>  
  
    2.  <span data-ttu-id="73fd5-116">Выполните команду [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) в каждой основной базе данных.</span><span class="sxs-lookup"><span data-stu-id="73fd5-116">Run the [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) command on every principal database.</span></span>  
  
 <span data-ttu-id="73fd5-117">**Этапы последовательного обновления**</span><span class="sxs-lookup"><span data-stu-id="73fd5-117">**Stages of a Rolling Upgrade**</span></span>  
  
 <span data-ttu-id="73fd5-118">Конкретная последовательность действий в ходе последовательного обновления зависит от режима работы конфигурации зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-118">The specific steps of a rolling upgrade depend on the operating mode of the mirroring configuration.</span></span> <span data-ttu-id="73fd5-119">Однако основные этапы остаются одинаковыми.</span><span class="sxs-lookup"><span data-stu-id="73fd5-119">However, the basic stages are the same.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="73fd5-120">Сведения о режимах работы см. в разделе [Режимы работы зеркального отображения базы данных](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-120">For information about the operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="73fd5-121">Блок-схема на следующем рисунке показывает основные этапы последовательного обновления для каждого режима работы.</span><span class="sxs-lookup"><span data-stu-id="73fd5-121">The following illustration is a flowchart that shows the basic stages of a rolling upgrade for each operating mode.</span></span> <span data-ttu-id="73fd5-122">После рисунка описаны соответствующие процедуры.</span><span class="sxs-lookup"><span data-stu-id="73fd5-122">The corresponding procedures are described after the illustration.</span></span>  
  
 <span data-ttu-id="73fd5-123">![Блок-схема, показывающая шаги последовательного обновления](../media/dbm-rolling-upgrade.gif "Блок-схема, показывающая шаги последовательного обновления")</span><span class="sxs-lookup"><span data-stu-id="73fd5-123">![Flowchart showing steps of a rolling upgrade](../media/dbm-rolling-upgrade.gif "Flowchart showing steps of a rolling upgrade")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="73fd5-124">Экземпляр сервера может одновременно исполнять различные роли зеркального отображения (основной сервер, зеркальный сервер или следящий сервер) в параллельных сеансах зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-124">A server instance might be performing different mirroring roles (principal server, mirror server, or witness) in concurrent mirroring sessions.</span></span> <span data-ttu-id="73fd5-125">В этом случае придется соответствующим образом адаптировать процесс последовательного обновления.</span><span class="sxs-lookup"><span data-stu-id="73fd5-125">In this case, you will have to adapt the basic rolling upgrade process accordingly.</span></span> <span data-ttu-id="73fd5-126">Дополнительные сведения см. в статье [Переключение ролей во время сеанса зеркального отображения базы данных (SQL Server)](role-switching-during-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-126">For more information, see [Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span></span>  
  
### <a name="to-change-a-session-from-high-performance-mode-to-high-safety-mode"></a><span data-ttu-id="73fd5-127">Изменение режима сеанса с высокопроизводительного на режим высокой безопасности</span><span class="sxs-lookup"><span data-stu-id="73fd5-127">To change a session from high-performance mode to high-safety mode</span></span>  
  
1.  <span data-ttu-id="73fd5-128">Если сеанс зеркального отображения выполняется в высокопроизводительном режиме, перед выполнением последовательного обновления измените его на режим высокой безопасности без автоматической отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="73fd5-128">If a mirroring session is running in high-performance mode, before you perform a rolling upgrade, change the operating mode to high safety without automatic failover.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="73fd5-129">Если зеркальный сервер географически удален от основного, то последовательное обновление может оказаться неподходящим вариантом.</span><span class="sxs-lookup"><span data-stu-id="73fd5-129">If the mirror server is geographically distant from the principal server, a rolling upgrade might be inappropriate.</span></span>  
  
    -   <span data-ttu-id="73fd5-130">В [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: измените параметр **Режим работы** на **Высокая безопасность без автоматической отработки отказа (синхронный)** с помощью страницы [Зеркальное отображение](../../relational-databases/databases/database-properties-mirroring-page.md) диалогового окна **Свойства базы данных**.</span><span class="sxs-lookup"><span data-stu-id="73fd5-130">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: Change the **Operating mode** option to **High safety without automatic failover (synchronous)** by using the [Mirroring Page](../../relational-databases/databases/database-properties-mirroring-page.md) of the **Database Properties** dialog box.</span></span> <span data-ttu-id="73fd5-131">Дополнительные сведения о доступе к этой странице см. в разделе [Запуск мастер настройки безопасности зеркального отображения баз данных (среда SQL Server Management Studio)](start-the-configuring-database-mirroring-security-wizard.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-131">For information about how to access this page, see [Start the Configuring Database Mirroring Security Wizard &#40;SQL Server Management Studio&#41;](start-the-configuring-database-mirroring-security-wizard.md).</span></span>  
  
    -   <span data-ttu-id="73fd5-132">В [!INCLUDE[tsql](../../includes/tsql-md.md)]: установите безопасность транзакций как FULL.</span><span class="sxs-lookup"><span data-stu-id="73fd5-132">In [!INCLUDE[tsql](../../includes/tsql-md.md)]: Set transaction safety to FULL.</span></span> <span data-ttu-id="73fd5-133">Дополнительные сведения см. в разделе [Изменение безопасности транзакций в сеансах зеркального отображения базы данных (Transact-SQL)](change-transaction-safety-in-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-133">For more information, see [Change Transaction Safety in a Database Mirroring Session &#40;Transact-SQL&#41;](change-transaction-safety-in-a-database-mirroring-session-transact-sql.md)</span></span>  
  
### <a name="to-remove-a-witness-from-a-session"></a><span data-ttu-id="73fd5-134">Удаление следящего сервера из сеанса</span><span class="sxs-lookup"><span data-stu-id="73fd5-134">To remove a witness from a session</span></span>  
  
1.  <span data-ttu-id="73fd5-135">Если сеанс зеркального отображения включает следящий сервер, рекомендуется удалить его перед выполнением последовательного обновления.</span><span class="sxs-lookup"><span data-stu-id="73fd5-135">If a mirroring session involves a witness, we recommend that you remove the witness before you perform a rolling upgrade.</span></span> <span data-ttu-id="73fd5-136">В противном случае при обновлении экземпляра зеркального сервера доступность базы данных будет зависеть от следящего сервера, остающегося подключенным к экземпляру основного сервера.</span><span class="sxs-lookup"><span data-stu-id="73fd5-136">Otherwise, when the mirror server instance is being upgraded, database availability depends on the witness that remains connected to the principal server instance.</span></span> <span data-ttu-id="73fd5-137">После удаления следящего сервера его можно обновить в любой момент во время последовательного обновления, без дополнительного простоя базы данных.</span><span class="sxs-lookup"><span data-stu-id="73fd5-137">After you remove a witness, you can upgrade it at any time during the rolling upgrade process without risking database downtime.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73fd5-138">Дополнительные сведения см. в статье [Кворум. Как следящий сервер влияет на доступность базы данных &#40;зеркальное отображение базы данных&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="73fd5-138">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
    -   [<span data-ttu-id="73fd5-139">Удаление следящего сервера из сеанса зеркального отображения базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="73fd5-139">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
### <a name="to-perform-the-rolling-upgrade"></a><span data-ttu-id="73fd5-140">Выполнение последовательного обновления</span><span class="sxs-lookup"><span data-stu-id="73fd5-140">To perform the rolling upgrade</span></span>  
  
1.  <span data-ttu-id="73fd5-141">Чтобы свести к минимуму время простоя, необходимо выполнить следующие рекомендации. Начните пошаговое обновление с обновления участника зеркального отображения, который в настоящий момент является зеркальным сервером во всех сеансах зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-141">To minimize downtime, we recommend the following: Start the rolling upgrade by updating any mirroring partner that is currently the mirror server in all its mirroring sessions.</span></span> <span data-ttu-id="73fd5-142">На этом этапе, возможно, придется обновить несколько экземпляров сервера.</span><span class="sxs-lookup"><span data-stu-id="73fd5-142">You might have to update multiple server instances at this point.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73fd5-143">Следящий сервер можно обновить в любой момент пошагового обновления.</span><span class="sxs-lookup"><span data-stu-id="73fd5-143">A witness can be upgraded at any point in the rolling upgrade process.</span></span> <span data-ttu-id="73fd5-144">Например, если экземпляр сервера является зеркальным сервером в сеансе 1 и следящим сервером в сеансе 2, этот сервер можно обновить сразу.</span><span class="sxs-lookup"><span data-stu-id="73fd5-144">For example, if a server instance is a mirror server in Session 1 and is a witness in Session 2, you can upgrade the server instance now.</span></span>  
  
     <span data-ttu-id="73fd5-145">Экземпляр сервера, который следует обновлять в первую очередь, зависит от текущей конфигурации сеансов зеркального отображения следующим образом.</span><span class="sxs-lookup"><span data-stu-id="73fd5-145">The server instance to upgrade first depends on the current configuration of your mirroring sessions, as follows:</span></span>  
  
    -   <span data-ttu-id="73fd5-146">Если какой-либо экземпляр сервера уже является зеркальным сервером во всех сеансах зеркального отображения, обновите его до новой версии.</span><span class="sxs-lookup"><span data-stu-id="73fd5-146">If any server instance is already the mirror server in all its mirroring sessions, upgrade the server instance to the new version.</span></span>  
  
    -   <span data-ttu-id="73fd5-147">Если все экземпляры сервера в настоящий момент являются основным сервером в одном из сеансов зеркального отображения, выберите для обновления один экземпляр сервера.</span><span class="sxs-lookup"><span data-stu-id="73fd5-147">If all your server instances are currently the principal server in any mirroring sessions, select one server instance to upgrade first.</span></span> <span data-ttu-id="73fd5-148">Затем вручную переведите на другой ресурс каждую из его основных баз данных и обновите экземпляр сервера.</span><span class="sxs-lookup"><span data-stu-id="73fd5-148">Then, manually fail over each of its principal databases and upgrade that server instance.</span></span>  
  
     <span data-ttu-id="73fd5-149">После обновления экземпляр сервера автоматически подключится к сеансам зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-149">After being upgraded, a server instance automatically rejoins each of its mirroring sessions.</span></span>  
  
2.  <span data-ttu-id="73fd5-150">В каждом сеансе зеркального отображения, зеркальный сервер которого был обновлен, дождитесь окончания синхронизации сеанса.</span><span class="sxs-lookup"><span data-stu-id="73fd5-150">For each mirroring session whose mirror server instance has just been upgraded, wait for the session to synchronize.</span></span> <span data-ttu-id="73fd5-151">Затем подключитесь к экземпляру основного сервера и вручную переведите этот сеанс на другой ресурс.</span><span class="sxs-lookup"><span data-stu-id="73fd5-151">Then, connect to the principal server instance, and manually fail over the session.</span></span> <span data-ttu-id="73fd5-152">При отработки отказа обновленный сервер становится основным сервером для этого сеанса, а бывший основной сервер становится зеркальным.</span><span class="sxs-lookup"><span data-stu-id="73fd5-152">On failover, the upgraded server instance becomes the principal server for that session, and the former principal server becomes the mirror server.</span></span>  
  
     <span data-ttu-id="73fd5-153">Цель этого этапа — сделать другой экземпляр сервера зеркальным во всех сеансах зеркального отображения, в которых он участвует.</span><span class="sxs-lookup"><span data-stu-id="73fd5-153">The goal of this step is for another server instance to become the mirror server in every mirroring session in which it is a partner.</span></span>  
  
     <span data-ttu-id="73fd5-154">**Ограничения, возникающие после перехода на обновленную отработку отказа сервера.**</span><span class="sxs-lookup"><span data-stu-id="73fd5-154">**Restrictions after you failover to an upgraded server instance.**</span></span>  
  
     <span data-ttu-id="73fd5-155">После перехода с более ранней версии экземпляра сервера на экземпляр сервера [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] сеанс зеркального отображения базы данных приостанавливается.</span><span class="sxs-lookup"><span data-stu-id="73fd5-155">After failing over from an earlier server instance to a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance, the database session is suspended.</span></span> <span data-ttu-id="73fd5-156">Его нельзя возобновить, пока не будет обновлен другой участник.</span><span class="sxs-lookup"><span data-stu-id="73fd5-156">It cannot be resumed until the other partner has been upgraded.</span></span> <span data-ttu-id="73fd5-157">Однако основной сервер принимает подключения и разрешает доступ и изменение данных в основной базе данных.</span><span class="sxs-lookup"><span data-stu-id="73fd5-157">However, the principal server is still accepting connections and allowing data access and modifications on the principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73fd5-158">Для установки нового сеанса зеркального отображения требуется, чтобы на всех участниках работала одинаковая версия [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="73fd5-158">Establishing a new mirroring session requires that the server instances all be running the same version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
3.  <span data-ttu-id="73fd5-159">После отработки отказа рекомендуется выполнить команду [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) в базе данных сепринЦипал.</span><span class="sxs-lookup"><span data-stu-id="73fd5-159">After you fail over, we recommend that you run the [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) command on theprincipal database.</span></span>  
  
4.  <span data-ttu-id="73fd5-160">Обновите каждый экземпляр сервера, который в настоящий момент является зеркальным сервером во всех сеансах зеркального отображения, в которых он участвует.</span><span class="sxs-lookup"><span data-stu-id="73fd5-160">Upgrade each server instance that is now the mirror server in all mirroring sessions in which it is a partner.</span></span> <span data-ttu-id="73fd5-161">На этом этапе, возможно, придется обновить несколько серверов.</span><span class="sxs-lookup"><span data-stu-id="73fd5-161">You might have to update multiple servers at this point.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="73fd5-162">В сложной конфигурации зеркального отображения некоторые экземпляры сервера могут все еще исполнять роль основного сервера в одном или нескольких сеансах зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-162">In a complex mirroring configuration, some server instance might still be the original principal server in one or more mirroring sessions.</span></span> <span data-ttu-id="73fd5-163">Повторите шаги 2–4 для этих экземпляров серверов, пока не будут обновлены все вовлеченные в этот процесс экземпляры.</span><span class="sxs-lookup"><span data-stu-id="73fd5-163">Repeat steps 2-4 for those server instances until all instances involved are upgraded.</span></span>  
  
5.  <span data-ttu-id="73fd5-164">Возобновление сеанса зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-164">Resume the mirroring session.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73fd5-165">Автоматическая отработка отказа не будет работать, пока следящий сервер не будет обновлен и возвращен в сеанс зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-165">Automatic failover will not work until the witness has been upgraded and added back into the mirroring session.</span></span>  
  
6.  <span data-ttu-id="73fd5-166">Обновите все оставшиеся экземпляры сервера, являющиеся следящими во всех сеансах зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-166">Upgrade any remaining server instance that is the witness in all its mirroring sessions.</span></span> <span data-ttu-id="73fd5-167">После подключения обновленного следящего сервера к сеансу зеркального отображения становится возможным автоматическая отработка отказа.</span><span class="sxs-lookup"><span data-stu-id="73fd5-167">After an upgraded witness rejoins a mirroring session, automatic failover becomes possible again.</span></span> <span data-ttu-id="73fd5-168">На этом этапе, возможно, придется обновить несколько серверов.</span><span class="sxs-lookup"><span data-stu-id="73fd5-168">You might have to update multiple servers at this point.</span></span>  
  
### <a name="to-return-a-session-to-high-performance-mode"></a><span data-ttu-id="73fd5-169">Возвращение сеанса в высокопроизводительный режим</span><span class="sxs-lookup"><span data-stu-id="73fd5-169">To return a session to high-performance mode</span></span>  
  
1.  <span data-ttu-id="73fd5-170">При необходимости вернитесь в высокопроизводительный режим, используя один из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="73fd5-170">Optionally, return to high-performance mode by using one of the following methods:</span></span>  
  
    -   <span data-ttu-id="73fd5-171">В [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: измените параметр **Режим работы** на **Высокая производительность (асинхронный)** с помощью страницы [Зеркальное отображение](../../relational-databases/databases/database-properties-mirroring-page.md) диалогового окна **Свойства базы данных**.</span><span class="sxs-lookup"><span data-stu-id="73fd5-171">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: Change the **Operating mode** option to **High performance (asynchronous)** by using the [Mirroring Page](../../relational-databases/databases/database-properties-mirroring-page.md) of the **Database Properties** dialog box.</span></span>  
  
    -   <span data-ttu-id="73fd5-172">В [!INCLUDE[tsql](../../includes/tsql-md.md)]: с помощью команды [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) установите безопасность транзакций в значение OFF.</span><span class="sxs-lookup"><span data-stu-id="73fd5-172">In [!INCLUDE[tsql](../../includes/tsql-md.md)]: Use [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring)to set transaction safety to OFF.</span></span>  
  
### <a name="to-add-a-witness-back-into-a-mirroring-session"></a><span data-ttu-id="73fd5-173">Возвращение следящего сервера в сеанс зеркального отображения</span><span class="sxs-lookup"><span data-stu-id="73fd5-173">To add a witness back into a mirroring session</span></span>  
  
1.  <span data-ttu-id="73fd5-174">При необходимости в режиме высокой безопасности повторно соедините следящий сервер со всеми сеансами зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="73fd5-174">Optionally, in high-safety mode, reestablish the witness to each mirroring session.</span></span>  
  
     <span data-ttu-id="73fd5-175">**Возврат следящего сервера**</span><span class="sxs-lookup"><span data-stu-id="73fd5-175">**To return a witness**</span></span>  
  
    -   [<span data-ttu-id="73fd5-176">Добавление или замена следящего сервера зеркального отображения базы данных (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="73fd5-176">Add or Replace a Database Mirroring Witness &#40;SQL Server Management Studio&#41;</span></span>](add-or-replace-a-database-mirroring-witness-sql-server-management-studio.md)  
  
    -   [<span data-ttu-id="73fd5-177">Добавление следящего сервера для зеркального отображения базы данных с использованием проверки подлинности Windows (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="73fd5-177">Add a Database Mirroring Witness Using Windows Authentication &#40;Transact-SQL&#41;</span></span>](add-a-database-mirroring-witness-using-windows-authentication-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="73fd5-178">См. также:</span><span class="sxs-lookup"><span data-stu-id="73fd5-178">See Also</span></span>  
 <span data-ttu-id="73fd5-179">[Зеркальное отображение базы данных ALTER DATABASE (Transact-SQL)](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) </span><span class="sxs-lookup"><span data-stu-id="73fd5-179">[ALTER DATABASE Database Mirroring &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) </span></span>  
 <span data-ttu-id="73fd5-180">[BACKUP (Transact-SQL)](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="73fd5-180">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 <span data-ttu-id="73fd5-181">[Просмотр состояния зеркального отображения базы данных (среда SQL Server Management Studio)](view-the-state-of-a-mirrored-database-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="73fd5-181">[View the State of a Mirrored Database &#40;SQL Server Management Studio&#41;](view-the-state-of-a-mirrored-database-sql-server-management-studio.md) </span></span>  
 <span data-ttu-id="73fd5-182">[Зеркальное отображение базы данных (SQL Server)](database-mirroring-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="73fd5-182">[Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span></span>  
 <span data-ttu-id="73fd5-183">[Установка пакета обновления в системе с минимальным временем простоя для зеркальных баз данных](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md) </span><span class="sxs-lookup"><span data-stu-id="73fd5-183">[Install a Service Pack on a System with Minimal Downtime for Mirrored Databases](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md) </span></span>  
 <span data-ttu-id="73fd5-184">[Переключение ролей во время сеанса зеркального отображения базы данных (SQL Server)](role-switching-during-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="73fd5-184">[Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="73fd5-185">[Принудительный запуск службы в сеансе зеркального отображения базы данных (Transact-SQL)](force-service-in-a-database-mirroring-session-transact-sql.md) </span><span class="sxs-lookup"><span data-stu-id="73fd5-185">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md) </span></span>  
 <span data-ttu-id="73fd5-186">[Запуск монитора зеркального отображения баз данных (среда SQL Server Management Studio)](start-database-mirroring-monitor-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="73fd5-186">[Start Database Mirroring Monitor &#40;SQL Server Management Studio&#41;](start-database-mirroring-monitor-sql-server-management-studio.md) </span></span>  
 [<span data-ttu-id="73fd5-187">Режимы работы зеркального отображения базы данных</span><span class="sxs-lookup"><span data-stu-id="73fd5-187">Database Mirroring Operating Modes</span></span>](database-mirroring-operating-modes.md)  
  
  
