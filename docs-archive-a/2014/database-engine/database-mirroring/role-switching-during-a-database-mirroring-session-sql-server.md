---
title: Переключение ролей во время сеанса зеркального отображения базы данных (SQL Server) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
- mirroring partners [SQL Server]
- failover [SQL Server]
- failover partners [SQL Server]
- database mirroring [SQL Server], partners
- partners in database mirroring sessions [SQL Server]
- failover [SQL Server], database mirroring
- database mirroring [SQL Server], failover
ms.assetid: a782d60d-0373-4386-bd77-9ec192553700
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5e16adbad2106d623279edf9d443eae3755c7be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87733069"
---
# <a name="role-switching-during-a-database-mirroring-session-sql-server"></a><span data-ttu-id="8ca62-102">Переключение ролей во время сеанса зеркального отображения базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8ca62-102">Role Switching During a Database Mirroring Session (SQL Server)</span></span>
  <span data-ttu-id="8ca62-103">В контексте сеанса зеркального отображения базы данных роли основного и зеркального серверов обычно взаимозаменяемы посредством так называемого *переключения ролей*.</span><span class="sxs-lookup"><span data-stu-id="8ca62-103">Within the context of a database mirroring session, the principal and mirror roles are typically interchangeable in a process known as *role switching*.</span></span> <span data-ttu-id="8ca62-104">Во время переключения ролей зеркальный сервер играет роль *партнера по обеспечению отработки отказа* для основного сервера, принимая роль основного сервера и переводя свою копию базы данных в оперативное состояние в качестве новой основной базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-104">In role switching, the mirror server acts as the *failover partner* for the principal server, taking over the principal role, recovering its copy of the database and bringing it online as the new principal database.</span></span> <span data-ttu-id="8ca62-105">Когда бывший основной сервер входит в строй, он принимает роль зеркального, и его база данных становится новой зеркальной базой данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-105">The former principal server, when available, assumes the mirror role, and its database becomes the new mirror database.</span></span> <span data-ttu-id="8ca62-106">Возможно многократное переключение ролей либо в ответ на многочисленные ошибки, либо в целях администрирования.</span><span class="sxs-lookup"><span data-stu-id="8ca62-106">Potentially, the roles can switch back and forth either in response to multiple failures or for administrative purposes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8ca62-107">Подразумевается, что рабочие режимы зеркального отображения базы данных знакомы.</span><span class="sxs-lookup"><span data-stu-id="8ca62-107">This topic assumes that you are familiar with the database mirroring operating modes.</span></span> <span data-ttu-id="8ca62-108">Дополнительные сведения см. в статье [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-108">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="8ca62-109">На следующей иллюстрации показано, как два участника зеркального отображения, **участник А** и **участник Б**, обмениваются ролями основного сервера и зеркального сервера в течение ряда отработок отказов, осуществляемых как автоматически, так и вручную.</span><span class="sxs-lookup"><span data-stu-id="8ca62-109">The following illustration shows mirroring partners, **Partner_A** and **Partner_B**, switching the principal and mirror roles over a series of automatic or manual failovers.</span></span>  
  
 <span data-ttu-id="8ca62-110">![Участники дважды меняют роли](../media/dbm-roleswitching.gif "Участники дважды меняют роли")</span><span class="sxs-lookup"><span data-stu-id="8ca62-110">![Partners switching twice between roles](../media/dbm-roleswitching.gif "Partners switching twice between roles")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8ca62-111">Задания, работающие в бывшей основной базе данных после переключения ролей, должны быть созданы повторно в новой основной базе данных для работы с ней.</span><span class="sxs-lookup"><span data-stu-id="8ca62-111">After a role switch, jobs that ran on the former principal database must be recreated on the new principal server to run there.</span></span> <span data-ttu-id="8ca62-112">Дополнительные сведения см. в статье [Управление именами входа и заданиями после переключения ролей (SQL Server)](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-112">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="8ca62-113">Существует три вида переключения ролей: автоматический переход на другой ресурс, переход на другой ресурс вручную и вынужденное обслуживание (с возможной потерей данных).</span><span class="sxs-lookup"><span data-stu-id="8ca62-113">Three types of role switching exist: automatic failover, manual failover, and forced service (with possible data loss).</span></span> <span data-ttu-id="8ca62-114">Поддержка каждой из форм переключения ролей зависит от режима функционирования сеанса.</span><span class="sxs-lookup"><span data-stu-id="8ca62-114">Support for each form depends on the operating mode of the session.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8ca62-115">Сведения о режимах функционирования сеансов зеркального отображения см. в разделе [Режимы работы зеркального отображения базы данных](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-115">If you are unfamiliar with these operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="8ca62-116">**Отработка отказа вручную**</span><span class="sxs-lookup"><span data-stu-id="8ca62-116">**Manual failover**</span></span>  
  
     <span data-ttu-id="8ca62-117">Режим высокого уровня безопасности поддерживает отработку отказа вручную.</span><span class="sxs-lookup"><span data-stu-id="8ca62-117">High-safety mode supports manual failover.</span></span> <span data-ttu-id="8ca62-118">Если база данных синхронизирована, владелец базы данных может инициировать отработку отказа вручную.</span><span class="sxs-lookup"><span data-stu-id="8ca62-118">Whenever the database is synchronized, the database owner can initiate a manual failover.</span></span>  
  
     <span data-ttu-id="8ca62-119">Отработка отказа вручную используется в целях администрирования.</span><span class="sxs-lookup"><span data-stu-id="8ca62-119">Manual failover is provided for administrative purposes.</span></span> <span data-ttu-id="8ca62-120">Дополнительные сведения см. в подразделе [Переход на другой ресурс вручную](#ManualFailover)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="8ca62-120">For more information, see [Manual Failover](#ManualFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="8ca62-121">**Автоматическая отработка отказа**</span><span class="sxs-lookup"><span data-stu-id="8ca62-121">**Automatic failover**</span></span>  
  
     <span data-ttu-id="8ca62-122">В присутствии следящего сервера режим высокого уровня безопасности поддерживает автоматическую отработку отказа.</span><span class="sxs-lookup"><span data-stu-id="8ca62-122">In the presence of a witness, high-safety mode supports automatic failover.</span></span> <span data-ttu-id="8ca62-123">Автоматическая отработка отказа происходит только при потере связи с основным сервером, когда зеркальный и следящий серверы все еще связаны друг с другом, а база данных уже синхронизирована.</span><span class="sxs-lookup"><span data-stu-id="8ca62-123">Automatic failover occurs only on the loss of the principal server when the witness and mirror server are still connected to each other and the database is already synchronized.</span></span> <span data-ttu-id="8ca62-124">Дополнительные сведения см. в подразделе [Автоматический переход на другой ресурс](#AutomaticFailover)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="8ca62-124">For more information, see [Automatic Failover](#AutomaticFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="8ca62-125">**Принудительное обслуживание (с возможной потерей данных)**</span><span class="sxs-lookup"><span data-stu-id="8ca62-125">**Forced service (with possible data loss)**</span></span>  
  
     <span data-ttu-id="8ca62-126">Принудительное обслуживание поддерживается в режиме высокого уровня безопасности при отсутствии следящего сервера и в высокопроизводительном режиме.</span><span class="sxs-lookup"><span data-stu-id="8ca62-126">Forcing service is supported in high-safety mode when no witness is set and in high-performance mode.</span></span> <span data-ttu-id="8ca62-127">При потере связи с основным сервером владелец базы данных может принудительно сделать базу данных доступной, включив принудительное обслуживание зеркальным сервером (это может привести к потере данных).</span><span class="sxs-lookup"><span data-stu-id="8ca62-127">On the loss of the principal server, the database owner can make the database available by forcing service to the mirror server (with possible data loss).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8ca62-128">Рекомендуется установить свойство «WITNESS» в положение «OFF» в высокопроизводительном режиме.</span><span class="sxs-lookup"><span data-stu-id="8ca62-128">We recommend that the WITNESS property be set to OFF in high-performance mode.</span></span> <span data-ttu-id="8ca62-129">Иначе для перевода базы данных в режим «в сети» будет необходимо соединение зеркального сервера со следящим сервером.</span><span class="sxs-lookup"><span data-stu-id="8ca62-129">Otherwise, to bring the database online, the mirror server must connected to the witness.</span></span>  
  
     <span data-ttu-id="8ca62-130">Дополнительные сведения см. в подразделе [Принудительное обслуживание (с возможной потерей данных)](#ForcedService)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="8ca62-130">For more information, see [Forced Service (with Possible Data Loss)](#ForcedService), later in this topic.</span></span>  
  
 <span data-ttu-id="8ca62-131">Следующая таблица содержит сводные данные о поддержке различных способов отработки отказа для каждого из режимов функционирования.</span><span class="sxs-lookup"><span data-stu-id="8ca62-131">The following table summarizes which forms of failover are supported under each of the operating modes.</span></span>  
  
||<span data-ttu-id="8ca62-132">Высокопроизводительные</span><span class="sxs-lookup"><span data-stu-id="8ca62-132">High performance</span></span>|<span data-ttu-id="8ca62-133">Режим высокого уровня безопасности без следящего сервера</span><span class="sxs-lookup"><span data-stu-id="8ca62-133">High-safety mode without a witness</span></span>|<span data-ttu-id="8ca62-134">Режим высокого уровня безопасности в присутствии следящего сервера</span><span class="sxs-lookup"><span data-stu-id="8ca62-134">High-safety mode with a witness</span></span>|  
|-|----------------------|-----------------------------------------|--------------------------------------|  
|<span data-ttu-id="8ca62-135">автоматический переход на другой ресурс</span><span class="sxs-lookup"><span data-stu-id="8ca62-135">Automatic failover</span></span>|<span data-ttu-id="8ca62-136">Нет</span><span class="sxs-lookup"><span data-stu-id="8ca62-136">No</span></span>|<span data-ttu-id="8ca62-137">Нет</span><span class="sxs-lookup"><span data-stu-id="8ca62-137">No</span></span>|<span data-ttu-id="8ca62-138">Да</span><span class="sxs-lookup"><span data-stu-id="8ca62-138">Yes</span></span>|  
|<span data-ttu-id="8ca62-139">Переход на другой ресурс вручную</span><span class="sxs-lookup"><span data-stu-id="8ca62-139">Manual failover</span></span>|<span data-ttu-id="8ca62-140">Нет</span><span class="sxs-lookup"><span data-stu-id="8ca62-140">No</span></span>|<span data-ttu-id="8ca62-141">Да</span><span class="sxs-lookup"><span data-stu-id="8ca62-141">Yes</span></span>|<span data-ttu-id="8ca62-142">Да</span><span class="sxs-lookup"><span data-stu-id="8ca62-142">Yes</span></span>|  
|<span data-ttu-id="8ca62-143">Принудительное обслуживание</span><span class="sxs-lookup"><span data-stu-id="8ca62-143">Forced service</span></span>|<span data-ttu-id="8ca62-144">Да</span><span class="sxs-lookup"><span data-stu-id="8ca62-144">Yes</span></span>|<span data-ttu-id="8ca62-145">Да</span><span class="sxs-lookup"><span data-stu-id="8ca62-145">Yes</span></span>|<span data-ttu-id="8ca62-146">Нет</span><span class="sxs-lookup"><span data-stu-id="8ca62-146">No</span></span>|  
  
 <span data-ttu-id="8ca62-147">После переключения ролей определенные метаданные должны существовать на обоих участниках, чтобы гарантировать, что все пользователи базы данных смогут получить доступ к новой основной базе данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-147">After a role switch, certain metadata must exist on both partners to ensure that all of the database users can access the new principal database.</span></span> <span data-ttu-id="8ca62-148">Кроме того, задания резервирования должны быть созданы на новом основном сервере, чтобы гарантировать, что сохраняется возможность резервирования базы данных по регулярному расписанию.</span><span class="sxs-lookup"><span data-stu-id="8ca62-148">In addition, backup jobs must be created on the new principal server, to ensure that the database continues to be backed up on its regular schedule.</span></span> <span data-ttu-id="8ca62-149">Дополнительные сведения см. в статье [Управление именами входа и заданиями после переключения ролей (SQL Server)](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-149">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="8ca62-150">При переключении ролей время недоступности зеркального отображения базы данных зависит от типа переключения ролей и типа причины переключения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-150">During a role switch, the amount of time that database mirroring will be out of service depends on the type of role switching and on the cause.</span></span> <span data-ttu-id="8ca62-151">Дополнительные сведения см. в статье [Оценка прерывания обслуживания во время переключения ролей (зеркальное отображение базы данных)](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-151">For more information, see [Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span></span>  
  
##  <a name="manual-failover"></a><a name="ManualFailover"></a> <span data-ttu-id="8ca62-152">Manual Failover</span><span class="sxs-lookup"><span data-stu-id="8ca62-152">Manual Failover</span></span>  
 <span data-ttu-id="8ca62-153">При отработке отказа вручную клиенты отключаются от базы данных, а роли участников меняются на противоположные.</span><span class="sxs-lookup"><span data-stu-id="8ca62-153">Manual failover disconnects the clients from the database and reverses the roles of the partners.</span></span> <span data-ttu-id="8ca62-154">Отработка отказа вручную поддерживается только в режиме высокого уровня безопасности.</span><span class="sxs-lookup"><span data-stu-id="8ca62-154">Only high-safety mode supports manual failover.</span></span>  
  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="AvailabilityDuringUpgrades"></a> <span data-ttu-id="8ca62-155">Поддержка уровня доступности при обновлениях</span><span class="sxs-lookup"><span data-stu-id="8ca62-155">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="8ca62-156">Администратор базы данных может вручную произвести отработку отказа для обновления оборудования или программного обеспечения, не снижая уровня доступности.</span><span class="sxs-lookup"><span data-stu-id="8ca62-156">The database administrator can use manual failover for upgrading hardware or software without sacrificing availability.</span></span> <span data-ttu-id="8ca62-157">Если зеркальное отображение базы данных используется для обновления программного обеспечения, зеркальный сервер и (или) система уже должны получить эти обновления.</span><span class="sxs-lookup"><span data-stu-id="8ca62-157">To use database mirroring for software upgrades, the mirror server and/or system must have already received the upgrades.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8ca62-158">Зеркальное отображение базы данных должно быть способно выполнить последовательное обновление, однако это не гарантируется, поскольку последующие изменения не известны.</span><span class="sxs-lookup"><span data-stu-id="8ca62-158">Database mirroring should be able to do a rolling upgrade, but this is not guaranteed, because future changes are unknown.</span></span> <span data-ttu-id="8ca62-159">Дополнительные сведения см. в разделе [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-159">For more information, see [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span></span>  
  
 <span data-ttu-id="8ca62-160">Приведенный ниже рисунок иллюстрирует отработку отказа вручную для поддержки уровня доступности базы данных при обновлении экземпляра сервера базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-160">The following figure illustrates an instance of using manual failover to maintain database availability while you upgrade a database server instance.</span></span> <span data-ttu-id="8ca62-161">По завершении обновления администратор может вновь переключиться на первоначальный экземпляр сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-161">When the upgrade is completed, an administrator may optionally fail over back to the original server instance.</span></span> <span data-ttu-id="8ca62-162">Эта возможность полезна в том случае, если администратор хочет остановить сеанс зеркального отображения и использовать какой-нибудь другой зеркальный сервер.</span><span class="sxs-lookup"><span data-stu-id="8ca62-162">This is useful when the administrator wants to stop the mirroring session and use the mirror server elsewhere.</span></span> <span data-ttu-id="8ca62-163">При этом один экземпляр сервера может использоваться многократно, для обновления нескольких экземпляров сервера базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-163">In this way, a single server instance can be used repeatedly when updating a series of database server instances.</span></span>  
  
 <span data-ttu-id="8ca62-164">![Запланированный переход на другой ресурс вручную](../media/dbm-failovmanuplanned.gif "Запланированная отработка отказа вручную")</span><span class="sxs-lookup"><span data-stu-id="8ca62-164">![Planned manual failover](../media/dbm-failovmanuplanned.gif "Planned manual failover")</span></span>  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ConditionsForManualFo"></a> <span data-ttu-id="8ca62-165">Условия для отработки отказа вручную</span><span class="sxs-lookup"><span data-stu-id="8ca62-165">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="8ca62-166">Для отработки отказа вручную безопасность транзакций должна быть установлена в FULL (т. е. транзакция должна находиться в режиме высокой защиты).</span><span class="sxs-lookup"><span data-stu-id="8ca62-166">Manual failover requires transaction safety to be set to FULL (that is, high-safety mode).</span></span> <span data-ttu-id="8ca62-167">Если между участниками имеется соединение, а база данных синхронизирована, поддерживается отработка отказа вручную.</span><span class="sxs-lookup"><span data-stu-id="8ca62-167">When the partners are connected and the database is already synchronized, manual failover is supported.</span></span>  
  
###  <a name="how-manual-failover-works"></a><a name="HowManualFoWorks"></a> <span data-ttu-id="8ca62-168">Принципы работы отработки отказа вручную</span><span class="sxs-lookup"><span data-stu-id="8ca62-168">How Manual Failover Works</span></span>  
 <span data-ttu-id="8ca62-169">Отработка отказа вручную включает в себя следующие действия.</span><span class="sxs-lookup"><span data-stu-id="8ca62-169">Manual failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="8ca62-170">Основной сервер отключает клиентов от основной базы данных и отправляет заключительный фрагмент журнала транзакций на зеркальный сервер и, готовясь к переключению ролей зеркальных серверов, устанавливает основную базу данных в состояние SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="8ca62-170">The principal server disconnects clients from the principal database, sends the tail of the log to the mirror server, and, in preparation for switching to the mirror role, sets the mirroring state to SYNCHRONIZING.</span></span>  
  
2.  <span data-ttu-id="8ca62-171">Зеркальный сервер регистрирует номер LSN последней записи журнала, полученной от основного сервера, в качестве номера LSN отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="8ca62-171">The mirror server records the log sequence number (LSN) of the last log record received from the principal as the failover LSN.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8ca62-172">Чтобы выяснить этот номер, запросите столбец **mirroring_failover_lsn** из таблицы [sys.database_mirroring (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8ca62-172">To view this LSN, select the **mirroring_failover_lsn** column from [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span></span>  
  
3.  <span data-ttu-id="8ca62-173">Если в очереди повтора остался какой-либо журнал, то зеркальный сервер завершает накат зеркальной базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-173">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span> <span data-ttu-id="8ca62-174">Длительность выполнения зависит от скорости системы, текущей рабочей нагрузки и количества записей журнала в очереди повторного выполнения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-174">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the redo queue.</span></span> <span data-ttu-id="8ca62-175">Для синхронного режима работы время отработки отказа регулируется ограничением размера очереди повторного выполнения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-175">For a synchronous operating mode, the failover time can be regulated by limiting the size of the redo queue.</span></span> <span data-ttu-id="8ca62-176">Однако это может привести к замедлению работы основного сервера, ожидающего выполнения операций зеркальным сервером.</span><span class="sxs-lookup"><span data-stu-id="8ca62-176">However, this can cause the principal server to slow down to allow the mirror server to keep up.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8ca62-177">Чтобы узнать текущую длину очереди повторов, используйте счетчик **Очередь повторов** в объекте производительности зеркального отображения (дополнительные сведения см. в разделе [Наблюдение за зеркальным отображением базы данных (SQL Server)](database-mirroring-sql-server.md)).</span><span class="sxs-lookup"><span data-stu-id="8ca62-177">To learn the current size of the redo queue, use the **Redo Queue** performance counter in the database mirroring performance object (for more information, see [Monitoring Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span></span>  
  
4.  <span data-ttu-id="8ca62-178">Зеркальный сервер становится новым основным сервером, а бывший основной сервер становится новым зеркальным сервером.</span><span class="sxs-lookup"><span data-stu-id="8ca62-178">The mirror server becomes the new principal server, and the former principal server becomes the new mirror server.</span></span>  
  
5.  <span data-ttu-id="8ca62-179">Новый основной сервер выполняет откат всех незафиксированных транзакций и переводит свою копию базы данных в режим в сети в качестве основной базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-179">The new principal server rolls back any uncommitted transactions and brings its copy of the database online as the principal database.</span></span>  
  
6.  <span data-ttu-id="8ca62-180">Бывший основной сервер берет на себя роль зеркального сервера, а бывшая основная база данных становится зеркальной базой данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-180">The former principal takes on the mirror role, and the former principal database becomes the mirror database.</span></span> <span data-ttu-id="8ca62-181">Новый зеркальный сервер проводит быструю повторную синхронизацию новой зеркальной базы данных с новой основной базой данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-181">The new mirror server quickly resynchronizes the new mirror database with the new principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8ca62-182">Как только новый зеркальный сервер выполнил повторную синхронизацию баз данных, снова становится возможной отработка отказа, но уже в обратном направлении.</span><span class="sxs-lookup"><span data-stu-id="8ca62-182">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="8ca62-183">После отработки отказа клиенты должны повторно подключиться к текущей основной базе данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-183">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="8ca62-184">Дополнительные сведения см. в статье [Подключение клиентов к сеансу зеркального отображения базы данных (SQL Server)](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-184">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
 <span data-ttu-id="8ca62-185">**Инициация отработки отказа вручную**</span><span class="sxs-lookup"><span data-stu-id="8ca62-185">**To initiate manual failover**</span></span>  
  
-   [<span data-ttu-id="8ca62-186">Переключение сеанса зеркального отображения базы данных на другой ресурс вручную (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="8ca62-186">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
-   <span data-ttu-id="8ca62-187">[Переключение сеанса зеркального отображения базы данных на другой ресурс вручную (язык Transact-SQL)](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-187">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="8ca62-188">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="8ca62-188">Automatic Failover</span></span>  
 <span data-ttu-id="8ca62-189">Автоматическая отработка отказа поддерживается только в сеансах зеркального отображения базы данных, выполняющихся со следящим сервером в режиме высокой безопасности (*режим высокой безопасности с автоматической отработкой отказа*).</span><span class="sxs-lookup"><span data-stu-id="8ca62-189">Automatic failover is supported only in database mirroring sessions running with a witness in high-safety mode (*high-safety mode with automatic failover*).</span></span> <span data-ttu-id="8ca62-190">Если при работе в режиме высокой безопасности с автоматической отработкой отказа основная база данных становится недоступной, после синхронизации выполняется автоматическая отработка отказа.</span><span class="sxs-lookup"><span data-stu-id="8ca62-190">In high-safety mode with automatic failover, once the database is synchronized, if the principal database becomes unavailable, an automatic failover occurs.</span></span> <span data-ttu-id="8ca62-191">При автоматической отработке отказа зеркальный сервер берет на себя роль основного сервера данных и выводит свою копию базы данных в режим в сети как основную базу данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-191">An automatic failover causes the mirror server to take over the role of principal server and bring its copy of the database online as the principal database.</span></span> <span data-ttu-id="8ca62-192">Обязательная синхронизация базы данных предотвращает потерю данных во время отработки отказа, поскольку все транзакции, которые фиксируется в основной базе данных, фиксируются также в зеркальной базе данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-192">Requiring that the database be synchronized prevents data loss during failover, because every transaction committed on the principal database is also committed on the mirror database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8ca62-193">Для повышения надежности при автоматической отработке отказа зеркальная и основная базы данных должны находиться на разных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="8ca62-193">For automatic failover to improve reliability, the mirror and principal databases must reside on different computers.</span></span>  
  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="ConditionsForAutoFo"></a> <span data-ttu-id="8ca62-194">Необходимые условия для автоматического перехода на другой ресурс</span><span class="sxs-lookup"><span data-stu-id="8ca62-194">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="8ca62-195">Чтобы произвести автоматический переход на другой ресурс, необходимо выполнение следующих условий.</span><span class="sxs-lookup"><span data-stu-id="8ca62-195">Automatic failover requires the following conditions:</span></span>  
  
-   <span data-ttu-id="8ca62-196">Сеанс зеркального отображения базы данных должен выполняться в режиме высокой безопасности и при наличии следящего сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-196">The database mirroring session must be running in high-safety mode and must possess a witness.</span></span> <span data-ttu-id="8ca62-197">Дополнительные сведения см. в статье [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-197">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="8ca62-198">Зеркальная база данных должна быть синхронизирована.</span><span class="sxs-lookup"><span data-stu-id="8ca62-198">The mirror database must already be synchronized.</span></span> <span data-ttu-id="8ca62-199">Это обеспечивает гарантированную запись на диск всех данных журналов, отправляемых зеркальному серверу.</span><span class="sxs-lookup"><span data-stu-id="8ca62-199">This guarantees that all of the log sent to the mirror server has been written to disk.</span></span>  
  
-   <span data-ttu-id="8ca62-200">Основной сервер потерял соединение с остальной частью конфигурации зеркального отображения базы данных, в то время как зеркальная база данных и следящий сервер удерживают кворум.</span><span class="sxs-lookup"><span data-stu-id="8ca62-200">The principal server has lost communication with the rest of the database mirroring configuration, while the mirror and witness retain quorum.</span></span> <span data-ttu-id="8ca62-201">Однако если утрачивается связь со всеми экземплярами серверов, а позднее следящий и зеркальный серверы восстанавливают связь, автоматическая отработка отказа не выполняется.</span><span class="sxs-lookup"><span data-stu-id="8ca62-201">If all server instances lose communication, however, and the witness and the mirror server later regain communication, automatic failover does not occur.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8ca62-202">Дополнительные сведения см. в статье [Кворум. Как следящий сервер влияет на доступность базы данных &#40;зеркальное отображение базы данных&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-202">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
-   <span data-ttu-id="8ca62-203">Зеркальный сервер обнаружил потерю основного сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-203">The mirror server has detected the loss of the principal server.</span></span>  
  
     <span data-ttu-id="8ca62-204">Способ определения сбоя основного сервера зависит от того, связан ли этот сбой с оборудованием или программным обеспечением.</span><span class="sxs-lookup"><span data-stu-id="8ca62-204">How the mirror server detects a failure of the principal server depends on whether it is a hard or soft failure.</span></span> <span data-ttu-id="8ca62-205">Дополнительные сведения см. в статье [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-205">For more information, see [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="8ca62-206">Принцип работы автоматической отработки отказа</span><span class="sxs-lookup"><span data-stu-id="8ca62-206">How Automatic Failover Works</span></span>  
 <span data-ttu-id="8ca62-207">Если приведенные выше условия выполнены, автоматическая отработка отказа инициирует следующую последовательность действий.</span><span class="sxs-lookup"><span data-stu-id="8ca62-207">Under the preceding conditions, automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="8ca62-208">Если основной сервер все еще работает, он изменяет состояние основной базы данных на DISCONNECTED и отсоединяет от нее все клиентские приложения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-208">If the principal server is still running, it changes the state of the principal database to DISCONNECTED and disconnects all clients from the principal database.</span></span>  
  
2.  <span data-ttu-id="8ca62-209">Следящий и зеркальный серверы регистрируют недоступность основного сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-209">The witness and mirror servers register that the principal server is unavailable.</span></span>  
  
3.  <span data-ttu-id="8ca62-210">Если в очереди повтора остался какой-либо журнал, то зеркальный сервер завершает накат зеркальной базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-210">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8ca62-211">Длительность применения журнала зависит от скорости системы, текущего уровня загрузки и количества записей журнала в очереди на повтор.</span><span class="sxs-lookup"><span data-stu-id="8ca62-211">The amount of time required to apply the log depends on the speed of the system, the recent work load, and the amount of log in the redo queue.</span></span>  
  
4.  <span data-ttu-id="8ca62-212">Бывшая зеркальная база данных переводится в режим в сети как новая основная база данных, после чего как можно быстрее выполняется откат всех незафиксированных транзакций.</span><span class="sxs-lookup"><span data-stu-id="8ca62-212">The former mirror database moves online as the new principal database, and recovery cleans up all uncommitted transactions by rolling them back as quickly as possible.</span></span> <span data-ttu-id="8ca62-213">Блокировка изолирует эти транзакции.</span><span class="sxs-lookup"><span data-stu-id="8ca62-213">Locks isolate those transactions.</span></span>  
  
5.  <span data-ttu-id="8ca62-214">Когда бывший основной сервер снова присоединяется к сеансу, он определяет, что роль основного сервера перешла к его партнеру по обеспечению отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="8ca62-214">When the former principal server rejoins the session, it recognizes that its failover partner now owns the principal role.</span></span> <span data-ttu-id="8ca62-215">Следовательно, бывший основной сервер берет на себя роль зеркального и делает свою базу данных зеркальной базой данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-215">The former principal server takes on the role of mirror, making its database the mirror database.</span></span> <span data-ttu-id="8ca62-216">Затем новый зеркальный сервер как можно быстрее синхронизирует новую зеркальную базу данных с основной базой данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-216">The new mirror server synchronizes the new mirror database with the principal database as quickly as possible.</span></span> <span data-ttu-id="8ca62-217">Как только новый зеркальный сервер выполнил повторную синхронизацию баз данных, снова становится возможной отработка отказа, но уже в обратном направлении.</span><span class="sxs-lookup"><span data-stu-id="8ca62-217">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="8ca62-218">Автоматическая отработка отказа показана на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="8ca62-218">The following illustration shows a single instance of automatic failover.</span></span>  
  
 <span data-ttu-id="8ca62-219">![Автоматическая отработка отказа](../media/dbm-failovauto1round.gif "автоматический переход на другой ресурс")</span><span class="sxs-lookup"><span data-stu-id="8ca62-219">![Automatic failover](../media/dbm-failovauto1round.gif "Automatic failover")</span></span>  
  
 <span data-ttu-id="8ca62-220">Первоначально присоединены все три сервера (сеанс имеет полный кворум).</span><span class="sxs-lookup"><span data-stu-id="8ca62-220">Initially, all three servers are connected (the session has full quorum).</span></span> <span data-ttu-id="8ca62-221">**Участник А** — это основной сервер, а **участник Б** — зеркальный сервер.</span><span class="sxs-lookup"><span data-stu-id="8ca62-221">**Partner_A** is the principal server and **Partner_B** is the mirror server.</span></span> <span data-ttu-id="8ca62-222">**Участник_A** (или основная база данных на сервере **Участник_A**) становится недоступным.</span><span class="sxs-lookup"><span data-stu-id="8ca62-222">**Partner_A** (or the principal database on **Partner_A**) becomes unavailable.</span></span> <span data-ttu-id="8ca62-223">Когда как следящий сервер, так и **Участник_Б** узнают, что этот субъект больше недоступен, сеанс удерживает кворум.</span><span class="sxs-lookup"><span data-stu-id="8ca62-223">The witness and **Partner_B** both recognize that the principal is no longer available the session retains quorum.</span></span> <span data-ttu-id="8ca62-224">**Участник Б** становится основным сервером и создает свою копию базы данных, которая используется как новая основная база данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-224">**Partner_B** becomes the principal server and makes its copy of the database available as the new principal database.</span></span> <span data-ttu-id="8ca62-225">Рано или поздно **участник А** снова присоединяется к сеансу и обнаруживает, что теперь роль основного сервера выполняет **участник Б** .</span><span class="sxs-lookup"><span data-stu-id="8ca62-225">Eventually, **Partner_A** reconnects to the session and discovers that **Partner_B** now owns the principal role.</span></span> <span data-ttu-id="8ca62-226">Выяснив это,**участник А** берет на себя функции зеркального сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-226">**Partner_A** then takes on the mirror role.</span></span>  
  
 <span data-ttu-id="8ca62-227">После отработки отказа клиенты должны повторно подключиться к текущей основной базе данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-227">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="8ca62-228">Дополнительные сведения см. в статье [Подключение клиентов к сеансу зеркального отображения базы данных (SQL Server)](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-228">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8ca62-229">Транзакции, подготовленные с помощью координатора распределенных транзакций [!INCLUDE[msCoName](../../includes/msconame-md.md)] , но еще не зафиксированные на момент перехода на другой ресурс, считаются отмененными после перехода.</span><span class="sxs-lookup"><span data-stu-id="8ca62-229">Transactions that have been prepared using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator but are still not committed when a failover occurs, are considered aborted after the database has failed over.</span></span>  
  
###  <a name="to-disable-automatic-failover-sql-server-management-studio"></a><a name="DisableAutoSSMS"></a> <span data-ttu-id="8ca62-230">Отключение автоматического перехода на другой ресурс (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="8ca62-230">To Disable Automatic Failover (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="8ca62-231">Откройте страницу **Зеркальное отображение** окна "Свойства базы данных" и измените режим работы, выбрав один из следующих параметров:</span><span class="sxs-lookup"><span data-stu-id="8ca62-231">Open the **Database PropertiesMirroring** page, and change the operating mode by selecting one of the following options:</span></span>  
  
-   <span data-ttu-id="8ca62-232">**Высокий уровень безопасности без автоматического перехода на другой ресурс (синхронного)**</span><span class="sxs-lookup"><span data-stu-id="8ca62-232">**High safety without automatic failover (synchronous)**</span></span>  
  
     <span data-ttu-id="8ca62-233">В этом режиме база данных продолжает синхронизироваться, и остается возможным отработка отказа вручную.</span><span class="sxs-lookup"><span data-stu-id="8ca62-233">In this mode, the database continues to be synchronized, and manual failover remains possible.</span></span>  
  
-   <span data-ttu-id="8ca62-234">**Высокая производительность (асинхронный)**</span><span class="sxs-lookup"><span data-stu-id="8ca62-234">**High performance (asynchronous)**</span></span>  
  
     <span data-ttu-id="8ca62-235">В этом режиме зеркальная база данных может немного отставать от основной, и отработка отказа вручную невозможна.</span><span class="sxs-lookup"><span data-stu-id="8ca62-235">In this mode, the mirror database might lag somewhat behind the principal database, and manual failover is no longer possible.</span></span>  
  
### <a name="to-disable-automatic-failover-using-transact-sql"></a><span data-ttu-id="8ca62-236">Отключение автоматического перехода на другой ресурс (с помощью Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="8ca62-236">To Disable Automatic Failover (Using Transact-SQL)</span></span>  
 <span data-ttu-id="8ca62-237">Владелец базы данных может на любом этапе сеанса зеркального отображения базы данных заблокировать автоматическую отработку отказа, отключив следящий сервер.</span><span class="sxs-lookup"><span data-stu-id="8ca62-237">At any point in a database mirroring session, the database owner can disable automatic failover by turning off the witness.</span></span>  
  
 <span data-ttu-id="8ca62-238">**Отключение следящего сервера**</span><span class="sxs-lookup"><span data-stu-id="8ca62-238">**To turn off the witness**</span></span>  
  
-   [<span data-ttu-id="8ca62-239">Удаление следящего сервера из сеанса зеркального отображения базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8ca62-239">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
    > [!NOTE]  
    >  <span data-ttu-id="8ca62-240">Отключение следящего сервера при сохранении полной безопасности транзакций переводит сеанс в режим высокой безопасности без автоматической отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="8ca62-240">Turning off the witness while retaining full transaction safety puts the session into high-safety mode without automatic failover.</span></span>  
  
##  <a name="forced-service-with-possible-data-loss"></a><a name="ForcedService"></a> <span data-ttu-id="8ca62-241">Forced Service (with Possible Data Loss)</span><span class="sxs-lookup"><span data-stu-id="8ca62-241">Forced Service (with Possible Data Loss)</span></span>  
 <span data-ttu-id="8ca62-242">Зеркальное отображение базы данных предоставляет принудительное обслуживание (с возможной потерей данных) в качестве метода аварийного восстановления, позволяющего использовать зеркальный сервер в качестве сервера «горячего» резервирования.</span><span class="sxs-lookup"><span data-stu-id="8ca62-242">Database mirroring provides forcing service (with possible data loss) as a disaster recovery method to allow you to use a mirror server as a warm standby server.</span></span> <span data-ttu-id="8ca62-243">Принудительное обслуживание возможно только в том случае, если основной сервер не подключен к зеркальному во время сеанса зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-243">Forcing service is possible only if the principal server is disconnected from the mirror server in a mirroring session.</span></span> <span data-ttu-id="8ca62-244">Поскольку принудительное обслуживание может привести к потере данных, его следует использовать осторожно и только в случае необходимости.</span><span class="sxs-lookup"><span data-stu-id="8ca62-244">Because forcing service risks possible data loss, it should be used cautiously and sparingly.</span></span>  
  
 <span data-ttu-id="8ca62-245">Поддержка принудительного обслуживания зависит от режима работы и состояния сеанса.</span><span class="sxs-lookup"><span data-stu-id="8ca62-245">Support for forced service depends on the operating mode and the state of the session, as follows:</span></span>  
  
-   <span data-ttu-id="8ca62-246">Обычно режим высокой производительности поддерживает принудительное обслуживание в любой момент, когда основной сервер отключен.</span><span class="sxs-lookup"><span data-stu-id="8ca62-246">Typically, high-performance mode supports forcing service whenever the principal server is disconnected.</span></span> <span data-ttu-id="8ca62-247">При необходимости во время сеанса в режиме высокой производительности можно использовать следящий сервер.</span><span class="sxs-lookup"><span data-stu-id="8ca62-247">However, though unnecessary, a witness can exist for a high-performance mode session.</span></span> <span data-ttu-id="8ca62-248">В этом случае для принудительного обслуживания требуется, чтобы зеркальный и следящий серверы были подключены друг к другу.</span><span class="sxs-lookup"><span data-stu-id="8ca62-248">In this case, forcing service requires that the mirror server and witness are connected to each other.</span></span>  
  
-   <span data-ttu-id="8ca62-249">Режим высокой защиты с автоматической отработкой отказа поддерживает принудительное обслуживание в любой момент, когда основной сервер отключен.</span><span class="sxs-lookup"><span data-stu-id="8ca62-249">High-safety mode without automatic failover supports forcing service whenever the principal server is disconnected.</span></span>  
  
-   <span data-ttu-id="8ca62-250">Режим высокой защиты с автоматической отработкой отказа поддерживает принудительное обслуживание в любой момент, когда зеркальный и следящий серверы подключены друг к другу, и ни тот, ни другой не подключены к основному серверу (если только зеркальный сервер не занимался откатом зеркальной базы данных во время последнего подключения к основному серверу).</span><span class="sxs-lookup"><span data-stu-id="8ca62-250">High-safety mode with automatic failover supports forcing service whenever the mirror server and witness are connected to each other and neither is connected to the principal server (as long as the mirror server was not in the process of rolling back the mirror database when it was last connected to the principal).</span></span>  
  
 <span data-ttu-id="8ca62-251">Принудительное обслуживание рекомендуется применять, только когда требуется немедленное восстановление доступа к базе данных и допускается риск потери данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-251">We recommend forcing service only if you must restore service to the database immediately and are willing to risk losing data.</span></span> <span data-ttu-id="8ca62-252">Эффект принудительного обслуживания подобен удалению зеркального отображения, он отличается тем, что принудительное обслуживание способствует повторной синхронизации баз данных при возобновлении зеркального отображения с риском потери данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-252">The effect of forcing service is similar to removing mirroring, except that forcing service facilitates resynchronizing the databases when mirroring is resumed, at the risk of possible data loss.</span></span> <span data-ttu-id="8ca62-253">При принудительном обслуживании производится незаметная, «на ходу», передача роли основного участника зеркальной базе данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-253">Forcing service initiates a smooth transition of the principal role to the mirror database.</span></span> <span data-ttu-id="8ca62-254">Зеркальный сервер берет на себя роль основного сервера и немедленно предоставляет клиентам доступ к своей копии базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-254">The mirror server assumes the role of principal server and immediately serves its copy of the database to clients.</span></span> <span data-ttu-id="8ca62-255">Новая база данных работает без зеркального отображения (то есть остается не защищенной).</span><span class="sxs-lookup"><span data-stu-id="8ca62-255">The new principal database runs without a mirror (that is, it runs exposed).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8ca62-256">Если основной сервер был просто отключен от сеанса зеркального отображения базы данных и по-прежнему работает, некоторые клиенты могут продолжить обращаться к базе данных на исходном основном сервере.</span><span class="sxs-lookup"><span data-stu-id="8ca62-256">If the principal server was merely disconnected from the database mirroring session and is still running, some clients might continue to access the original principal database.</span></span> <span data-ttu-id="8ca62-257">Перед принудительным обслуживанием важно запретить клиентам доступ к исходному основному серверу.</span><span class="sxs-lookup"><span data-stu-id="8ca62-257">Before you force service, it is important to prevent clients from accessing the original principal server.</span></span> <span data-ttu-id="8ca62-258">В противном случае, после запуска принудительного обслуживания исходная и текущая базы данных могут обновляться независимо друг от друга.</span><span class="sxs-lookup"><span data-stu-id="8ca62-258">Otherwise, after service is forced, the original principal database and the current principal database could be updated independently of the other.</span></span>  
  
  
  
###  <a name="typical-case-of-forced-service"></a><a name="TypicalCaseFS"></a> <span data-ttu-id="8ca62-259">Типичные ситуации использования принудительного обслуживания</span><span class="sxs-lookup"><span data-stu-id="8ca62-259">Typical Case of Forced Service</span></span>  
 <span data-ttu-id="8ca62-260">Следующий рисунок демонстрирует типичную ситуацию применения принудительного обслуживания (с вероятностью потери данных).</span><span class="sxs-lookup"><span data-stu-id="8ca62-260">The following figure illustrates a typical case of forced service (with possible data loss).</span></span>  
  
 <span data-ttu-id="8ca62-261">![Вынужденное обслуживание с возможной потерей данных](../media/dbm-forced-service.gif "Вынужденное обслуживание с возможной потерей данных")</span><span class="sxs-lookup"><span data-stu-id="8ca62-261">![Forcing service with possible data loss](../media/dbm-forced-service.gif "Forcing service with possible data loss")</span></span>  
  
 <span data-ttu-id="8ca62-262">На рисунке демонстрируется ситуация, когда основной сервер **Участник А**становится недоступен зеркальному серверу **Участник Б**, что приводит к отключению зеркальной базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-262">In the figure, the original principal server, **Partner_A**, becomes unavailable to the mirror server, **Partner_B**, causing the mirror database to be disconnected.</span></span> <span data-ttu-id="8ca62-263">Убедившись в том, что сервер **Участник А** недоступен клиентам, администратор базы данных применяет принудительное обслуживание с возможной потерей данных на сервере **Участник Б**.</span><span class="sxs-lookup"><span data-stu-id="8ca62-263">After ensuring that **Partner_A** is not available to clients, the database administrator forces service, with possible data loss, on **Partner_B**.</span></span> <span data-ttu-id="8ca62-264">**Участник Б** становится основным сервером, а база данных остается *незащищенной* (то есть зеркальное отображение не применяется).</span><span class="sxs-lookup"><span data-stu-id="8ca62-264">**Partner_B** becomes the principal server and runs with the database *exposed* (that is, unmirrored).</span></span> <span data-ttu-id="8ca62-265">В этот момент клиенты могут переключиться на сервер **Участник Б**.</span><span class="sxs-lookup"><span data-stu-id="8ca62-265">At this point, clients can reconnect to **Partner_B**.</span></span>  
  
 <span data-ttu-id="8ca62-266">Когда сервер **Участник А** становится доступным, он восстанавливает подключение к новому основному серверу, присоединяется к сеансу и берет на себя роль зеркального сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-266">When **Partner_A** becomes available, it reconnects to the new principal server, rejoining the session and assuming the mirror role.</span></span> <span data-ttu-id="8ca62-267">Сеанс зеркального отображения немедленно приостанавливается, не осуществляя синхронизацию с новой зеркальной базой данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-267">The mirroring session is suspended immediately, without having synchronized the new mirror database.</span></span> <span data-ttu-id="8ca62-268">Приостановка сеанса позволяет администратору базы данных принять решение о его возобновлении или в экстремальных ситуациях удалить зеркальное отображение и попытаться спасти данные в базе данных бывшего основного сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-268">Suspending the session allows the database administrator to decide whether to resume the session or, in extreme cases, remove mirroring and attempt to salvage data from the former principal database.</span></span> <span data-ttu-id="8ca62-269">В этом случае администратор базы данных возобновляет зеркальное отображение.</span><span class="sxs-lookup"><span data-stu-id="8ca62-269">In this case, the database administrator chooses to resume mirroring.</span></span> <span data-ttu-id="8ca62-270">В этот момент сервер **Участник А** берет на себя роль зеркального сервера и выполняет откат бывшей основной базы данных до момента последней успешно синхронизированной транзакции; зафиксированные транзакции, которые не были записаны на диск зеркального сервера до принудительного обслуживания, будут потеряны.</span><span class="sxs-lookup"><span data-stu-id="8ca62-270">At that point, **Partner_A** takes over the role of mirror server and rolls back the former principal database to the point in time of the last successfully synchronized transaction; if any committed transactions were not written to disk on the mirror server before service was forced, they are lost.</span></span> <span data-ttu-id="8ca62-271">Затем сервер**Участник А** выполняет накат новой зеркальной базы данных, применяя любые изменения, которые произошли в новой основной базе данных, после того как зеркальный сервер стал играть роль основного.</span><span class="sxs-lookup"><span data-stu-id="8ca62-271">**Partner_A** then rolls forward the new mirror database by applying any changes made on the new principal database since the former mirror server became the new principal server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8ca62-272">В режиме высокой производительности следящий сервер не требуется, однако, если такой сервер настроен, принудительное обслуживание возможно только тогда, когда следящий сервер подключен к зеркальному.</span><span class="sxs-lookup"><span data-stu-id="8ca62-272">Although high-performance mode does not require a witness, if one is configured, forcing service is possible only if the witness is currently connected to the mirror server.</span></span>  
  
###  <a name="risks-of-forcing-service"></a><a name="FSrisks"></a> <span data-ttu-id="8ca62-273">Риск использования принудительного обслуживания</span><span class="sxs-lookup"><span data-stu-id="8ca62-273">Risks of Forcing Service</span></span>  
 <span data-ttu-id="8ca62-274">Важно понимать, что принудительное обслуживание может привести к потере данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-274">It is essential to understand that forcing service can cause data loss.</span></span> <span data-ttu-id="8ca62-275">Возможность потери данных обусловлена тем, что зеркальный сервер не может взаимодействовать с основным, и поэтому не может гарантировать синхронизацию двух баз данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-275">Data loss is possible because the mirror server cannot communicate with the principal server and, therefore, cannot guarantee that the two databases are synchronized.</span></span> <span data-ttu-id="8ca62-276">Кроме того, принудительное обслуживание создает новую вилку восстановления.</span><span class="sxs-lookup"><span data-stu-id="8ca62-276">Forcing service starts a new recovery fork.</span></span> <span data-ttu-id="8ca62-277">Поскольку исходная основная и зеркальная базы данных находятся на разных вилках восстановления, то каждая из них теперь содержит данные, которых нет в другой базе данных. Исходная основная база данных содержит все изменения, которые еще не были посланы из ее очереди на отправку прежней зеркальной базе данных (журнал неотправленного), а прежняя зеркальная база данных содержит все изменения, которые произошли после принудительного запуска службы.</span><span class="sxs-lookup"><span data-stu-id="8ca62-277">Because the original principal database and mirror database are on different recovery forks, each database now contains data that the other database does not: the original principal database contains whatever changes were not yet sent from its send queue to the former mirror database (the unsent log); the former mirror database contains whatever changes occur after service was forced.</span></span>  
  
 <span data-ttu-id="8ca62-278">Если принудительное обслуживание выполняется из-за выхода из строя основного сервера, вероятность потери данных зависит от того, были ли журналы транзакций отправлены зеркальному серверу перед сбоем.</span><span class="sxs-lookup"><span data-stu-id="8ca62-278">If service is forced because the principal server has failed, potential data loss is depends on whether any transaction logs were not sent to the mirror server before the failure.</span></span> <span data-ttu-id="8ca62-279">В режиме высокой защиты это возможно, пока зеркальная база данных остается синхронизованной.</span><span class="sxs-lookup"><span data-stu-id="8ca62-279">Under high-safety mode, this is possible only until the mirror database becomes synchronized.</span></span> <span data-ttu-id="8ca62-280">В режиме высокой производительности всегда возможно накопление журнала неотправленных изменений.</span><span class="sxs-lookup"><span data-stu-id="8ca62-280">Under the high-performance mode, accumulated unsent log is always a possibility.</span></span>  
  
 <span data-ttu-id="8ca62-281">Последствия принудительного обслуживания частично зависят от того, применяется ли во время сеанса следящий сервер.</span><span class="sxs-lookup"><span data-stu-id="8ca62-281">The implications of forcing service depend partly on whether the session has a witness:</span></span>  
  
-   <span data-ttu-id="8ca62-282">Если следящий сервер отсутствует, принудительное обслуживание выполняется, когда участники отключены друг от друга, например, когда сетевое соединение разорвано.</span><span class="sxs-lookup"><span data-stu-id="8ca62-282">In the absence of a witness, service can be forced if the partners become disconnected, for example, because their network connection is broken.</span></span> <span data-ttu-id="8ca62-283">Если исходный основной сервер по-прежнему работает, оба участника обретают роль основного сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-283">If the original principal server is still running, both partners own the principal role.</span></span> <span data-ttu-id="8ca62-284">Клиенты, подключившиеся к новому основному серверу, будут обращаться к текущей версии базы данных, а клиенты, подключившиеся к бывшему основному серверу — к исходной.</span><span class="sxs-lookup"><span data-stu-id="8ca62-284">Clients connecting to the new principal server will access the current version of the database, while clients connecting to the original principal server will access the original principal database.</span></span> <span data-ttu-id="8ca62-285">Данная ситуация увеличивает вероятность потери данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-285">This situation increases the potential for data loss.</span></span> <span data-ttu-id="8ca62-286">Если разрешить участникам восстановить соединение, исходный основной сервер возьмет на себя роль зеркального и переведет базу данных в состояние восстановления до приостановки зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-286">If the partners are allowed to reconnect, the original principal server assumes the mirror role and changes the status of its database to "recovering," before mirroring is suspended.</span></span> <span data-ttu-id="8ca62-287">Если возобновить сеанс, транзакции в бывшей основной базе данных, журнал которой находился в очереди отправки с момента разрыва связи, будут потеряны.</span><span class="sxs-lookup"><span data-stu-id="8ca62-287">If the session is resumed, transactions on the original principal database whose log was in the send queue as of the most recent disconnection are lost.</span></span> <span data-ttu-id="8ca62-288">Кроме того, будут потеряны все транзакции, которые произошли после принудительного обслуживания.</span><span class="sxs-lookup"><span data-stu-id="8ca62-288">In addition, any the transactions that occurred after service was forced are also lost.</span></span>  
  
-   <span data-ttu-id="8ca62-289">Если зеркальный сервер отсоединяется от основного и следящего сервера (при его применении), которые остаются подключенными друг к другу, основной сервер остается незащищенным.</span><span class="sxs-lookup"><span data-stu-id="8ca62-289">In the presence of a witness, if the mirror server is disconnected from both the principal server and the witness, as long as the latter two remain connected to each other, the principal runs exposed.</span></span> <span data-ttu-id="8ca62-290">Если основной сервер отключается от следящего, он прекращает обслуживание базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-290">If the principal server then becomes disconnected from the witness, it stops serving the database.</span></span> <span data-ttu-id="8ca62-291">Если впоследствии зеркальный сервер восстановит соединение со следящим сервером, принудительное обслуживание станет возможным.</span><span class="sxs-lookup"><span data-stu-id="8ca62-291">Thereafter, if the mirror server reconnects to the witness, forcing service becomes possible.</span></span> <span data-ttu-id="8ca62-292">При использовании принудительного обслуживания все изменения, которые произошли пока бывший основной сервер оставался незащищенным, будут потеряны, если он восстановит соединение.</span><span class="sxs-lookup"><span data-stu-id="8ca62-292">If service is forced, all the changes made while the original principal server was running exposed will be lost if the original principal server reconnects.</span></span>  
  
 <span data-ttu-id="8ca62-293">Дополнительные сведения см. в подразделе [Управление возможной потерей данных](#ManageDataLoss)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="8ca62-293">For more information, see [Managing the Potential Data Loss](#ManageDataLoss), later in this topic.</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ManageDataLoss"></a> <span data-ttu-id="8ca62-294">Управление возможной потерей данных</span><span class="sxs-lookup"><span data-stu-id="8ca62-294">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="8ca62-295">Как только бывший основной сервер становится доступным после принудительного обслуживания, можно попытаться избежать потери данных, предполагая, что база данных осталась неповрежденной.</span><span class="sxs-lookup"><span data-stu-id="8ca62-295">After service is forced, once the former principal server is available, assuming that its database is undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="8ca62-296">Доступные подходы управления возможной потерей данных зависит от того, смог ли бывший основной сервер восстановить соединение с остальными участниками и присоединиться к сеансу зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-296">The available approach for managing potential data loss depends on whether the original principal server has reconnected to its partner and rejoined the mirroring session.</span></span> <span data-ttu-id="8ca62-297">Если бывший основной сервер может обратиться к новому основному серверу, восстановление соединения произойдет автоматически и прозрачно.</span><span class="sxs-lookup"><span data-stu-id="8ca62-297">Assuming that the original principal server can access the new principal instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-principal-server-has-reconnected"></a><span data-ttu-id="8ca62-298">Исходный основной сервер смог восстановить соединение</span><span class="sxs-lookup"><span data-stu-id="8ca62-298">The Original Principal Server Has Reconnected</span></span>  
 <span data-ttu-id="8ca62-299">После сбоя бывший основной сервер обычно быстро восстанавливает соединение со своим партнером.</span><span class="sxs-lookup"><span data-stu-id="8ca62-299">Typically, after a failure, when the original principal server restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="8ca62-300">При восстановлении соединения он становится зеркальным сервером.</span><span class="sxs-lookup"><span data-stu-id="8ca62-300">On reconnecting, the original principal server becomes the mirror server.</span></span> <span data-ttu-id="8ca62-301">Его база данных становится зеркальной и переходит в состояние восстановления до приостановки сеанса.</span><span class="sxs-lookup"><span data-stu-id="8ca62-301">Its database becomes the mirror database and enters the recovering state before the session is suspended.</span></span> <span data-ttu-id="8ca62-302">Откат зеркальной базы данных выполнить нельзя до тех пор, пока зеркальное отображение не будет возобновлено.</span><span class="sxs-lookup"><span data-stu-id="8ca62-302">The mirror database will not be not rolled back unless you resume mirroring.</span></span>  
  
 <span data-ttu-id="8ca62-303">Тем не менее, восстанавливаемая база данных остается недоступной, поэтому можно исследовать ее и определить, какие данные будут потеряны, если возобновить зеркальное отображение.</span><span class="sxs-lookup"><span data-stu-id="8ca62-303">However, the recovering database is inaccessible; therefore, you cannot inspect it to evaluate what data would be lost if you were to resume mirroring.</span></span> <span data-ttu-id="8ca62-304">Таким образом, решение о возобновлении или удалении зеркального отображения зависит от того, допустима ли потеря данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-304">Therefore, the decision on whether to resume or remove mirroring depends on whether you are willing to accept any data loss at all.</span></span>  
  
-   <span data-ttu-id="8ca62-305">Если потеря данных недопустима, следует удалить зеркальное отображение, чтобы сохранить их.</span><span class="sxs-lookup"><span data-stu-id="8ca62-305">If losing any data would be unacceptable, you should remove mirroring to salvage them.</span></span>  
  
     <span data-ttu-id="8ca62-306">Удалив зеркальное отображение, администратор базы данных сможет восстановить исходную основную базу данных и попытаться восстановить данные, которые в противном случае были бы потеряны.</span><span class="sxs-lookup"><span data-stu-id="8ca62-306">Removing mirroring would allow the database administrator to recover the original principal database and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="8ca62-307">Тем не менее, когда бывшая зеркальная база данных перейдет в режим «в сети», участники будут содержать разные версии базы данных с одним именем.</span><span class="sxs-lookup"><span data-stu-id="8ca62-307">However, when the former mirror database comes online, the former partners will be serving divergent databases with the same name.</span></span> <span data-ttu-id="8ca62-308">Администратору базы данных придется сделать одну из баз данных недоступной для клиентов, чтобы избежать дальнейшей рассогласованности баз данных и проблем, связанных с отработкой отказа, на стороне клиентов.</span><span class="sxs-lookup"><span data-stu-id="8ca62-308">The database administrator needs to make one of the databases inaccessible to clients to avoid further divergence of the database and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="8ca62-309">Если потеря данных допустима, зеркальное отображение можно возобновить.</span><span class="sxs-lookup"><span data-stu-id="8ca62-309">If losing any data would be acceptable, you can resume mirroring.</span></span>  
  
     <span data-ttu-id="8ca62-310">Возобновление зеркального отображения приведет к откату новой зеркальной базы данных в качестве первого этапа синхронизации базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-310">Resuming mirroring causes the new mirror database to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="8ca62-311">Если очередь отправки содержала какие-либо записи журнала в момент выхода из строя сервера, соответствующие транзакции будут потеряны, даже если они были зафиксированы.</span><span class="sxs-lookup"><span data-stu-id="8ca62-311">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-principal-server-has-not-reconnected"></a><span data-ttu-id="8ca62-312">Исходный основной сервер не смог восстановить соединение</span><span class="sxs-lookup"><span data-stu-id="8ca62-312">The Original Principal Server Has Not Reconnected</span></span>  
 <span data-ttu-id="8ca62-313">Если существует возможность временно воспрепятствовать исходному основному серверу соединиться по сети с новым основным сервером, можно исследовать исходную основную базу данных и определить, какие данные будут потеряны при возобновлении зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-313">If you can temporarily prevent the original principal server from reconnecting over the network to the new principal server, you can inspect the original principal database to evaluate what data would be lost if mirroring were resumed.</span></span>  
  
-   <span data-ttu-id="8ca62-314">Если потенциальная потеря данных допустима</span><span class="sxs-lookup"><span data-stu-id="8ca62-314">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="8ca62-315">Разрешите исходному основному серверу соединиться с новым основным сервером.</span><span class="sxs-lookup"><span data-stu-id="8ca62-315">Allow the original principal server to reconnect to its partner.</span></span> <span data-ttu-id="8ca62-316">После восстановления соединения зеркальное отображение будет приостановлено.</span><span class="sxs-lookup"><span data-stu-id="8ca62-316">Reconnecting causes mirroring to be suspended.</span></span> <span data-ttu-id="8ca62-317">Чтобы продолжить зеркальное отображение, просто возобновите сеанс.</span><span class="sxs-lookup"><span data-stu-id="8ca62-317">To proceed with mirroring, simply resume the session.</span></span> <span data-ttu-id="8ca62-318">Бывший основной сервер возьмет на себя роль зеркального.</span><span class="sxs-lookup"><span data-stu-id="8ca62-318">The former principal server assumes the mirror role.</span></span> <span data-ttu-id="8ca62-319">Новый зеркальный сервер удалит данные, которые относятся к исходной вилке восстановления, потеряв все транзакции, которые не были переданы или получены бывшим зеркальным сервером.</span><span class="sxs-lookup"><span data-stu-id="8ca62-319">The new mirror server drops the original recovery fork, losing any transactions that were never sent to or received by the former mirror server.</span></span>  
  
-   <span data-ttu-id="8ca62-320">Потеря данных недопустима</span><span class="sxs-lookup"><span data-stu-id="8ca62-320">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="8ca62-321">Если исходная основная база данных содержит важные данные, которые будут потеряны при возобновлении сеанса, их можно сохранить, удалив зеркальное отображение.</span><span class="sxs-lookup"><span data-stu-id="8ca62-321">If the original principal database contains critical data that would be lost if you resumed the session, you can preserve the data on the original principal server by removing mirroring.</span></span> <span data-ttu-id="8ca62-322">В данный момент рекомендуется попытаться выполнить резервное копирование заключительного фрагмента журнала основного сервера.</span><span class="sxs-lookup"><span data-stu-id="8ca62-322">We recommend that you attempt to back up the tail of the principal's log at this point.</span></span> <span data-ttu-id="8ca62-323">Затем можно обновить текущую основную (бывшую зеркальную) базу данных, экспортировав данные, которые необходимо сохранить, из исходной основной базы данных и импортировав их в текущую основную базу данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-323">Then, you can update the current principal (the former mirror database) by exporting the data you want to salvage from the original principal database and importing it into the current principal database.</span></span> <span data-ttu-id="8ca62-324">При этом рекомендуется как можно скорее создать полную резервную копию обновленной базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-324">We recommend taking a full database backup of the updated database as quickly as possible.</span></span>  
  
     <span data-ttu-id="8ca62-325">Чтобы восстановить зеркальное отображение обновленной базы данных в качестве первоначальной основной базы данных, используйте эту резервную копию (и по крайней мере одну из последующих резервных копий журнала) для создания новой зеркальной базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ca62-325">To re-establish mirroring with the updated database as the initial principal database, use this backup (and least one subsequent log backup) to create a new mirror database.</span></span> <span data-ttu-id="8ca62-326">Необходимо применить все резервные копии журнала, созданные после удаления зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-326">Every log backup taken after mirroring was removed must be applied.</span></span> <span data-ttu-id="8ca62-327">Таким образом, рекомендуется отложить создание новых резервных копий журнала основной базы данных до запуска нового сеанса зеркального отображения.</span><span class="sxs-lookup"><span data-stu-id="8ca62-327">Therefore, we recommend delaying additional log backups of the principal database until the new mirroring session starts.</span></span>  
  
###  <a name="related-tasks-for-managing-a-forced-failover"></a><a name="RelatedTasksForFS"></a> <span data-ttu-id="8ca62-328">Связанные задачи для управления принудительной отработкой отказа</span><span class="sxs-lookup"><span data-stu-id="8ca62-328">Related Tasks For Managing a Forced Failover</span></span>  
 <span data-ttu-id="8ca62-329">**Принудительное обслуживание**</span><span class="sxs-lookup"><span data-stu-id="8ca62-329">**To force service**</span></span>  
  
-   <span data-ttu-id="8ca62-330">[Принудительный запуск службы в сеансе зеркального отображения базы данных (Transact-SQL)](force-service-in-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="8ca62-330">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span></span>  
  
 <span data-ttu-id="8ca62-331">**Возобновление зеркального отображения базы данных**</span><span class="sxs-lookup"><span data-stu-id="8ca62-331">**To resume database mirroring**</span></span>  
  
-   [<span data-ttu-id="8ca62-332">Приостановка или возобновление сеанса зеркального отображения базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8ca62-332">Pause or Resume a Database Mirroring Session &#40;SQL Server&#41;</span></span>](pause-or-resume-a-database-mirroring-session-sql-server.md)  
  
 <span data-ttu-id="8ca62-333">**Создание новой зеркальной базы данных**</span><span class="sxs-lookup"><span data-stu-id="8ca62-333">**To create a new mirror database**</span></span>  
  
 [<span data-ttu-id="8ca62-334">Подготовка зеркальной базы данных к зеркальному отображению (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8ca62-334">Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;</span></span>](prepare-a-mirror-database-for-mirroring-sql-server.md)  
  
 <span data-ttu-id="8ca62-335">**Запуск зеркального отображения базы данных**</span><span class="sxs-lookup"><span data-stu-id="8ca62-335">**To start up database mirroring**</span></span>  
  
-   [<span data-ttu-id="8ca62-336">Настройка зеркального отображения базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8ca62-336">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="8ca62-337">Создание сеанса зеркального отображения базы данных с использованием проверки подлинности Windows (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="8ca62-337">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="8ca62-338">См. также:</span><span class="sxs-lookup"><span data-stu-id="8ca62-338">See Also</span></span>  
 <span data-ttu-id="8ca62-339">[Оценка прерывания обслуживания во время переключения ролей (зеркальное отображение базы данных)](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="8ca62-339">[Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span></span>  
 <span data-ttu-id="8ca62-340">[Возможные неполадки при зеркальном отображении базы данных](possible-failures-during-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="8ca62-340">[Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md) </span></span>  
 <span data-ttu-id="8ca62-341">[Подключение клиентов к сеансу зеркального отображения базы данных (SQL Server)](connect-clients-to-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="8ca62-341">[Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="8ca62-342">[Database Mirroring Witness](database-mirroring-witness.md) </span><span class="sxs-lookup"><span data-stu-id="8ca62-342">[Database Mirroring Witness](database-mirroring-witness.md) </span></span>  
 <span data-ttu-id="8ca62-343">[Выполнение полного восстановления базы данных (модель полного восстановления)](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="8ca62-343">[Complete Database Restores &#40;Full Recovery Model&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="8ca62-344">[Режимы работы зеркального отображения базы данных](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="8ca62-344">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="8ca62-345">Состояния зеркального отображения (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8ca62-345">Mirroring States &#40;SQL Server&#41;</span></span>](mirroring-states-sql-server.md)  
  
  
