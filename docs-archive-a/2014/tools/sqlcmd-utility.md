---
title: Служебная программа sqlcmd | Документы Майкрософт
ms.custom: ''
ms.date: 11/29/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: tools-other
ms.topic: conceptual
helpviewer_keywords:
- statements [SQL Server], command prompt
- QUIT command
- Transact-SQL statements, command prompt
- EXIT command
- sqlcmd commands
- ED command
- sqlcmd utility
- command prompt utilities [SQL Server], sqlcmd
- '!! command'
- stored procedures [SQL Server], command prompt
- system stored procedures [SQL Server], command prompt
- sqlcmd utility, about sqlcmd utility
- scripts [SQL Server], command prompt
- RESET command
- GO command
ms.assetid: e1728707-5215-4c04-8320-e36f161b834a
author: stevestein
ms.author: sstein
ms.openlocfilehash: 9fbe5a3dcefb2218543e015dad71acfe79aea8e3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739017"
---
# <a name="sqlcmd-utility"></a>Служебная программа sqlcmd
  `sqlcmd`Программа позволяет вводить [!INCLUDE[tsql](../includes/tsql-md.md)] инструкции, системные процедуры и файлы скриптов из командной строки, в **редакторе запросов** в режиме SQLCMD, в файле скрипта Windows или на шаге задания операционной системы (Cmd.exe) [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] задания агента. Эта программа использует технологию ODBC для выполнения пакетов [!INCLUDE[tsql](../includes/tsql-md.md)].  
  
> [!IMPORTANT]  
>  [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)]использует [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SqlClient для выполнения в обычном и sqlcmd режиме в **редакторе запросов**. При вызове программы `sqlcmd` из командной строки `sqlcmd` использует драйвер ODBC. Так как могут применяться различные параметры по умолчанию, выполнение одного и того же запроса в среде [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)] в режиме SQLCMD и в программе `sqlcmd` может проходить по-разному.  
  
 В настоящее время в программе `sqlcmd` не требуется указывать пробел между параметром командной строки и значением. Но в будущих выпусках пробел между параметром командной строки и значением может потребоваться.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
   sqlcmd  
   -a  
   packet_size  
   -A (dedicated administrator connection)  
-b (terminate batch job if there is an error)  
-cbatch_terminator-C (trust the server certificate)  
-ddb_name-e (echo input)  
-E (use trusted connection)  
-fcodepage | i:codepage[,o:codepage] | o:codepage[,i:codepage]  
-hrows_per_header-Hworkstation_name-iinput_file-I (enable quoted identifiers)  
-k[1 | 2] (remove or replace control characters)  
-Kapplication_intent-llogin_timeout-L[c] (list servers, optional clean output)  
-merror_level-Mmultisubnet_failover-N (encrypt connection)  
-ooutput_file-p[1] (print statistics, optional colon format)  
-Ppassword-q "cmdline query"-Q "cmdline query" (and exit)  
-r[0 | 1] (msgs to stderr)  
-R (use client regional settings)  
-scol_separator-S [protocol:]server[\instance_name][,port]  
-tquery_timeout-u (unicode output file)  
-Ulogin_id-vvar = "value"-Verror_severity_level-wcolumn_width-W (remove trailing spaces)  
-x (disable variable substitution)  
-X[1] (disable commands, startup script, environment variables and optional exit)  
-yvariable_length_type_display_width-Yfixed_length_type_display_width-znew_password -Znew_password (and exit)  
  
-? (usage)  
```  
  
## <a name="command-line-options"></a>Параметры командной строки  
 **Параметры, связанные с именем для входа**  
  **-A**  
 Входит на [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] посредством выделенного административного соединения. Этот вид соединения предназначен для устранения неполадок на сервере. Параметр будет работать только с теми серверами, которые поддерживают выделенные административные соединения. Если соединение DAC недоступно, программа `sqlcmd` выдает сообщение об ошибке и завершает свою работу. Дополнительные сведения о DAC см. в статье [Диагностическое соединение для администраторов баз данных](../database-engine/configure-windows/diagnostic-connection-for-database-administrators.md).  
  
 **-C**  
 С помощью этого переключателя клиент настраивает неявное доверие к сертификату сервера без проверки. Этот параметр аналогичен параметру ADO.NET `TRUSTSERVERCERTIFICATE = true`.  
  
 **-d** _имя_базы данных_  
 Выдает `USE` инструкцию *db_name* при запуске `sqlcmd` . Этот параметр устанавливает переменную скрипта SQLCMDDBNAME программы `sqlcmd`. Она задает начальную базу данных. По умолчанию свойство default-database имени входа. Если база данных не существует, выдается сообщение об ошибке и программа `sqlcmd` завершает свою работу.  
  
 **-l** _время_ожидания_входа_  
 Задает время ожидания (в секундах) при подключении программы `sqlcmd` через драйвер ODBC при попытке соединения с сервером. Этот параметр устанавливает переменную скрипта SQLCMDLOGINTIMEOUT программы `sqlcmd`. По умолчанию время ожидания входа для программы `sqlcmd` составляет 8 секунд. Время ожидания входа должно быть числом в диапазоне от 0 до 65 534. Если указанное значение не является числом или выходит за пределы указанного диапазона, программа `sqlcmd` выдает сообщение об ошибке. Значение 0 задает неограниченное время ожидания.  
  
 **-E**  
 Использует для соединения с [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] вместо имени пользователя и пароля доверительное соединение. По умолчанию, если параметр -E не указан, программа `sqlcmd` использует доверительное соединение.  
  
 Параметр **-E** не использует имя пользователя и пароль, указанные в переменных среды, например SQLCMDPASSWORD. Если параметр **-E** используется в сочетании с параметром **-U** или **-P** , выдается сообщение об ошибке.  
  
 **-H** _имя_рабочей_станции_  
 Имя рабочей станции. Этот параметр устанавливает переменную скрипта SQLCMDWORKSTATION программы `sqlcmd`. Имя рабочей станции заносится в столбец **hostname** представления каталога **sys.processes** и может быть возвращено с помощью хранимой процедуры **sp_who**. Если этот параметр не указан, используется текущее имя компьютера. Это имя может использоваться для идентификации сеансов работы программы `sqlcmd`.  
  
 **-K** _намерение_приложения_  
 Объявляет тип рабочей нагрузки приложения при соединении с сервером. Единственным поддерживаемым в данное время значением является **ReadOnly**. Если параметр **-K** не указан, то программа sqlcmd не будет поддерживать возможность подключения к вторичной реплике в группе доступности AlwaysOn. Дополнительные сведения см. в разделе [Активные вторичные реплики, доступные для чтения](../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).  
  
 `-M`*multisubnet_failover*  
 Всегда указывайте параметр `-M` при соединении с прослушивателем группы доступности [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] или экземпляром отказоустойчивого кластера [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. `-M` обеспечивает более быстрое обнаружение активного (в данный момент) сервера и соединение с ним. Если параметр `-M` не указан, то режим `-M` отключен. Дополнительные сведения о см. в статьях [!INCLUDE[ssHADR](../includes/sshadr-md.md)] [прослушиватели групп доступности, подключение клиентов и отработка отказа приложений &#40;SQL Server&#41;](../database-engine/listeners-client-connectivity-application-failover.md), [Создание и настройка групп доступности &#40;SQL Server&#41;](../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [отказоустойчивая кластеризация и группы доступности AlwaysOn &#40;](../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md)SQL Server&#41;и [Активные вторичные реплики](../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) .  
  
 **-N**  
 С помощью этого переключателя клиент запрашивает шифрованное соединение.  
  
 **-P** _пароль_  
 Пароль, задаваемый пользователем. Пароли учитывают регистр. Если используется параметр-U и параметр **-P** не используется и не задана ПЕРЕМЕННАЯ среды SQLCMDPASSWORD, `sqlcmd` запрашивает у пользователя пароль. Если параметр **-P** используется в конце командной строки без пароля `sqlcmd` , используется пароль по умолчанию (null).  
  
> [!IMPORTANT]  
>  Не используйте пустые пароли. Выбирайте надежные пароли. Дополнительные сведения см. в разделе [Strong Passwords](../relational-databases/security/strong-passwords.md).  
  
 Запрос на ввод пароля выводится на консоль следующим образом: `Password:`.  
  
 Вводимые пользователем данные на экране не отображаются, то есть символы не выводятся и курсор остается на месте.  
  
 Переменная среды SQLCMDPASSWORD позволяет задать значение пароля по умолчанию для текущего сеанса. Таким образом, нет необходимости указывать пароль в пакетных файлах.  
  
 В следующем примере сначала из командной строки устанавливается переменная SQLCMDPASSWORD, а затем производится вызов программы `sqlcmd`. В командной строке введите:  
  
 `SET SQLCMDPASSWORD= p@a$$w0rd`  
  
> [!IMPORTANT]  
>  Пароль будет отображаться на мониторе компьютера.  
  
 В командной строке введите:  
  
 `sqlcmd`  
  
 Если обнаружено неверное сочетание имени пользователя и пароля, выдается сообщение об ошибке.  
  
> [!NOTE]  
>  Переменная среды OSQLPASSWORD была сохранена в целях обратной совместимости. Переменная среды SQLCMDPASSWORD имеет приоритет над переменной среды OSQLPASSWORD; Это означает, что `sqlcmd` и **osql** можно использовать рядом друг с другом без помех, и эти старые сценарии будут продолжать работать.  
  
 Если параметр **-P** указан одновременно с параметром **-E** , выдается сообщение об ошибке.  
  
 Если после параметра **-P** указано более одного аргумента, выдается сообщение об ошибке, и программа завершает работу.  
  
 **-S** [*протокол*:]*сервер*[ **\\** _instance_name_] [**,**_порт_]  
 Указывает экземпляр [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], к которому выполняется подключение. Устанавливает переменную скрипта SQLCMDSERVER программы `sqlcmd`.  
  
 Укажите значение *имя_сервера*, чтобы подключиться к экземпляру компонента [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] по умолчанию на этом сервере. Укажите *server_name* [ **\\** _instance_name_ ], чтобы подключиться к именованному экземпляру [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] на этом компьютере сервера. Если сервер не указан, программа `sqlcmd` выполняет подключение к экземпляру [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] по умолчанию на локальном компьютере. Этот параметр обязателен при запуске программы `sqlcmd` с удаленного компьютера в сети.  
  
 *протокол* может быть `tcp` (TCP/IP), `lpc` (общая память) или `np` (именованные каналы).  
  
 Если не указать *server_name* [ **\\** _instance_name_ ] при запуске `sqlcmd` , [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] проверяет и использует переменную среды SQLCMDSERVER.  
  
> [!NOTE]  
>  Переменная среды OSQLSERVER была сохранена в целях обратной совместимости. Переменная среды SQLCMDSERVER имеет приоритет над переменной среды OSQLSERVER; Это означает, что `sqlcmd` и **osql** можно использовать рядом друг с другом без помех, и эти старые сценарии будут продолжать работать.  
  
 **-U** _идентификатор_для_входа_  
 Идентификатор входа пользователя.  
  
> [!NOTE]  
>  В целях обратной совместимости доступна переменная среды OSQLUSER. Переменная среды SQLCMDUSER имеет больший приоритет, чем OSQLUSER. Это означает, что `sqlcmd` и **osql** можно использовать рядом друг с другом без помех. Кроме того, это означает, что существующие скрипты **osql** не перестанут работать.  
  
 Если не указан ни параметр **-U** , ни параметр **-P** , `sqlcmd` пытается подключиться с использованием [!INCLUDE[msCoName](../includes/msconame-md.md)] режима проверки подлинности Windows. При этом используется учетная запись пользователя Windows, который запустил программу `sqlcmd`.  
  
 Если параметры **-U** и **-E** (описаны ниже в этом разделе) указаны одновременно, выдается сообщение об ошибке. Если после параметра **-U** указано более одного аргумента, выдается сообщение об ошибке и программа завершает работу.  
  
 **-z** _новый_пароль_  
 Сменить пароль:  
  
 `sqlcmd -U someuser -P s0mep@ssword -z a_new_p@a$$w0rd`  
  
 **-z** _новый_пароль_  
 Измените пароль и выйти:  
  
 `sqlcmd -U someuser -P s0mep@ssword -Z a_new_p@a$$w0rd`  
  
 **Параметры ввода-вывода**  
  **-f**_кодовая_страница_ | **i:** _кодовая_страница_[ **,o:** _кодовая_страница_] | **o:** _кодовая_страница_[ **,i:** _кодовая_страница_]  
 Задает входные и выходные кодовые страницы. Номер кодовой страницы — это числовое значение, которое определяет установленную кодовую страницу Windows.  
  
 Правила преобразования кодовых страниц:  
  
-   Если кодовые страницы не заданы, программа `sqlcmd` использует текущую кодовую страницу как для входных, так и для выходных файлов. Для входного файла в Юникоде преобразование не требуется.  
  
-   Программа `sqlcmd` автоматически распознает входные файлы в Юникоде как с прямым, так и с обратным порядком следования байтов. Если задан параметр **-u** , выходные данные всегда будут в Юникоде с прямым порядком байтов.  
  
-   Если выходной файл не задан, то выходные данные будут иметь кодовую страницу консоли. Это обеспечивает правильное отображение данных на консоли.  
  
-   Предполагается, что все входные файлы имеют одинаковую кодовую страницу. Входные файлы в Юникоде и не в Юникоде можно обрабатывать вместе.  
  
 Чтобы проверить кодовую страницу Cmd.exe, введите в командной строке команду `chcp`.  
  
 **-i** _input_file_[**,**_input_file2_...]  
 Указывает файл, содержащий пакет инструкций или хранимых процедур SQL. Можно указать несколько файлов, которые будут считываться и обрабатываться в указанном порядке. Не разделяйте имена файлов пробелами. Программа `sqlcmd` сначала производит проверку наличия всех указанных файлов. Если хотя бы один из файлов не найден, программа `sqlcmd` завершит работу. Параметры -i и -Q/-q являются взаимоисключающими.  
  
 Примеры пути:  
  
 **-i** C: \\<имя файла\>  
  
 **-i** \\ \\<Server \> \\<общий файл $>\\<имя файла\>  
  
 **-i** "C: \ папка \\<имя файла \> "  
  
 Пути к файлам, содержащие пробелы, необходимо заключать в кавычки.  
  
 Этот параметр можно использовать несколько раз: **-i**_input_file_ **-i**_input_file._  
  
 **-o** _файл_ввода_  
 Указывает файл, в который поступают выходные данные программы `sqlcmd`.  
  
 Если указан параметр **-u** , *выходной_файл* сохраняется в Юникоде. Если указано недопустимое имя файла, программа `sqlcmd` выдает сообщение об ошибке и завершает работу. `sqlcmd`не поддерживает одновременную запись нескольких `sqlcmd` процессов в один и тот же файл. В этом случае выводимые в файл данные будут неверны или повреждены. Дополнительные сведения о форматах файлов см. в описании параметра **-f** . Если этот файл не существует, он будет создан. Файл от предыдущего сеанса работы программы `sqlcmd` с тем же именем будет перезаписан. Указанный здесь файл не является файлом **stdout** . Если указан файл **stdout** , этот файл не будет использоваться.  
  
 Примеры пути:  
  
 **-o** В. \\< имя файла>  
  
 **-o** \\ \\<Server \> \\<общий файл $>\\<имя файла\>  
  
 **-o "** Папка C: \ \\<имя файла \> "  
  
 Пути к файлам, содержащие пробелы, необходимо заключать в кавычки.  
  
 **-r**[**0** | **1**]  
 Перенаправляет вывод сообщений об ошибке на экран (**stderr**). Если параметр не указан или если указано значение **0**, происходит перенаправление только сообщений об ошибках с уровнем серьезности 11 и выше. Если указать **1**, то происходит перенаправление всех сообщений об ошибках (включая команду PRINT). Не имеет эффекта, если указан параметр -o. По умолчанию сообщения отправляются в **stdout**.  
  
 **-R**  
 Вызывает `sqlcmd` локализацию числовых столбцов, валюты, даты и времени, получаемых на [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] основе языкового стандарта клиента. По умолчанию эти столбцы отображаются с использованием региональных параметров сервера.  
  
 **-u**  
 Указывает, что *выходной_файл* хранится в Юникоде независимо от формата файла *входной_файл*.  
  
 **Параметры выполнения запросов**  
  **-e**  
 Выдает входные скрипты на стандартное устройство вывода (**stdout**).  
  
 **-I**  
 Устанавливает значение ON для параметра соединения SET QUOTED_IDENTIFIER. По умолчанию этот параметр имеет значение OFF. Дополнительные сведения см. в статье [SET QUOTED_IDENTIFIER (Transact-SQL)](/sql/t-sql/statements/set-quoted-identifier-transact-sql).  
  
 **-q"** _запрос_командной_строки_ **"**  
 Выполняет запрос при `sqlcmd` запуске, но не завершает работу `sqlcmd` после завершения выполнения запроса. Может быть выполнено несколько запросов, разделенных точкой с запятой. Заключайте запрос в кавычки, как показано в следующем примере.  
  
 В командной строке введите:  
  
 `sqlcmd -d AdventureWorks2012 -q "SELECT FirstName, LastName FROM Person.Person WHERE LastName LIKE 'Whi%';"`  
  
 `sqlcmd -d AdventureWorks2012 -q "SELECT TOP 5 FirstName FROM Person.Person;SELECT TOP 5 LastName FROM Person.Person;"`  
  
> [!IMPORTANT]  
>  Не используйте в запросе признак конца GO.  
  
 Если вместе с этим параметром указан параметр `-b`, программа `sqlcmd` завершает работу при возникновении ошибки. Параметр `-b` описан ранее в этом разделе.  
  
 **-Q "** _cmdline Query_ **"**  
 При запуске программы `sqlcmd` выполняет запрос и немедленно завершает работу `sqlcmd`. Может быть выполнено несколько запросов, разделенных точкой с запятой.  
  
 Заключайте запрос в кавычки, как показано в следующем примере.  
  
 В командной строке введите:  
  
 `sqlcmd -d AdventureWorks2012 -Q "SELECT FirstName, LastName FROM Person.Person WHERE LastName LIKE 'Whi%';"`  
  
 `sqlcmd -d AdventureWorks2012 -Q "SELECT TOP 5 FirstName FROM Person.Person;SELECT TOP 5 LastName FROM Person.Person;"`  
  
> [!IMPORTANT]  
>  Не используйте в запросе признак конца GO.  
  
 Если вместе с этим параметром указан параметр `-b`, программа `sqlcmd` завершает работу при возникновении ошибки. Параметр `-b` описан ранее в этом разделе.  
  
 **-t** _время_ожижания_запроса_  
 Указывает время ожидания (в секундах) перед выполнением команды (или инструкции SQL). Этот параметр задает `sqlcmd` переменную скрипта склкмдстаттимеаут. Если значение *время_ожидания* не указывается, то команда имеет неограниченное время ожидания. Значение *время_ожидания**запроса* должно быть числом в диапазоне от 1 до 65534. Если указанное значение не является числом или выходит за пределы указанного диапазона, программа `sqlcmd` выдает сообщение об ошибке.  
  
> [!NOTE]  
>  Фактическое время ожидания может отличаться от указанного значения *время_ожидания* на несколько секунд.  
  
 **-ввар =** _значение_[ **var =** _value_...]  
 Создает `sqlcmd` переменную скрипта, которую можно использовать в `sqlcmd` скрипте. Если значение содержит пробелы, заключите его в кавычки. Можно указать несколько значений **_var_** = **" *`values`* "** . Если в каком-либо из указанных значений обнаружена ошибка, программа `sqlcmd` выдает сообщение и завершает работу.  
  
 `sqlcmd -v MyVar1=something MyVar2="some thing"`  
  
 `sqlcmd -v MyVar1=something -v MyVar2="some thing"`  
  
 **-x**  
 Указывает, что программа `sqlcmd` не должна обрабатывать переменные скрипта. Это может отказаться полезным в случае, если в скрипте содержится много инструкций INSERT, которые могут содержать строки, имеющие тот же формат, что и обычные переменные, т. е. "$(*имя_переменной*)".  
  
 **Параметры форматирования**  
  **-h** _заголовки_  
 Указывает количество строк для печати между заголовками столбцов. По умолчанию заголовки печатаются один раз для каждого набора результатов запроса. Этот параметр устанавливает переменную скрипта SQLCMDHEADERS программы `sqlcmd`. Используйте значение **-1** для отмены печати заголовков. Любое недопустимое значение приводит к тому, что программа `sqlcmd` создает сообщение об ошибке и завершает свою работу.  
  
 **-k** [**1** | **2**]  
 Удаляет из выходных данных все управляющие символы, такие как символы табуляции и символы новой строки. Это сохраняет формат столбцов при возврате данных. При указании значения 1 управляющие символы заменяются одиночным пробелом. Если указано значение 2, все последовательные управляющие символы заменяются одиночным пробелом. Параметр **-k** аналогичен параметру **-k1**.  
  
 **-s** _символ-разделитель_столбцов_  
 Задает символ-разделитель столбцов. Значением по умолчанию является пробел. Этот параметр устанавливает переменную скрипта SQLCMDCOLSEP программы `sqlcmd`. Чтобы использовать символы, имеющие специальное значение для операционной системы, такие как амперсанд (&) или точка с запятой (;), заключайте этот символ в кавычки ("). Разделитель столбцов может быть любым 8-разрядным символом.  
  
 **-w** _ширина_столбца_  
 Задает ширину экрана для вывода. Этот параметр устанавливает переменную скрипта SQLCMDCOLWIDTH программы `sqlcmd`. Ширина столбца должна находиться в диапазоне от 8 до 65 536. Если указанное значение ширины столбца выходит за пределы указанного диапазона, программа `sqlcmd` выдает сообщение об ошибке. Ширина по умолчанию составляет 80 символов. Когда строка вывода превышает указанную ширину столбца, вывод переносится на следующую строку.  
  
 **-W**  
 Этот параметр удаляет конечные пробелы в столбце. При подготовке данных для экспорта в другое приложение указывайте этот параметр вместе с параметром **-s** . Не может указываться одновременно с параметром **-y** или **-Y** .  
  
 **-y** _изменяемая_ширина_отображения_  
 Этот параметр устанавливает переменную скрипта SQLCMDMAXVARTYPEWIDTH программы `sqlcmd`. Значение по умолчанию равно 256. Ограничивает число символов, возвращаемых для больших типов данных переменной длины:  
  
-   `varchar(max)`  
  
-   `nvarchar(max)`  
  
-   `varbinary(max)`  
  
-   `xml`  
  
-   `UDT (user-defined data types)`  
  
-   `text`  
  
-   `ntext`  
  
-   `image`  
  
> [!NOTE]  
>  Определяемые пользователем типы могут иметь фиксированную длину в зависимости от реализации. Если фиксированная длина определяемого пользователем типа короче, чем значение переменной *ширина_отображения*, то значение типа возвращается без изменений. Однако если длина превышает значение *ширина_отображения*, то производится усечение выходных данных.  
  
 
> [!IMPORTANT]  
>  Используйте параметр **-y 0** с особой осторожностью, поскольку при большом объеме возвращаемых данных может значительно снизиться производительность сервера и сети.  
  
 **-Y** _фиксированная_ширина_отображения_  
 Этот параметр устанавливает переменную скрипта SQLCMDMAXFIXEDTYPEWIDTH программы `sqlcmd`. Значение по умолчанию 0 (неограниченно). Ограничивает число символов, возвращаемых для следующих типов данных:  
  
-   `char(`*n* `)` , где 1<= n<= 8000  
  
-   `nchar(n`*n* `)` , где 1<= n<= 4000  
  
-   `varchar(n`*n* `)` , где 1<= n<= 8000  
  
-   `nvarchar(n`*n* `)` , где 1<= n<= 4000  
  
-   `varbinary(n`*n* `)` , где 1<= n<= 4000  
  
-   `variant`  
  
 **Параметры отчетов об ошибках**  
  `-b`  
 Указывает, что в случае ошибки программа `sqlcmd` завершает работу и возвращает значение DOS ERRORLEVEL. Значение, возвращаемое в переменную DOS ERRORLEVEL, равно **1** , если сообщение об ошибке [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] имеет степень серьезности выше 10. В противном случае возвращаемое значение равно **0**. Если параметр `-V` был указан вместе с параметром `-b`, программа `sqlcmd` не будет выдавать сообщение об ошибках, степень серьезности которых ниже значения, заданного параметром `-V`. Пакетные файлы командной строки могут быть использованы для проверки значения ERRORLEVEL и для обработки ошибки соответствующим образом. Программа `sqlcmd` не выдает сообщений об ошибках со степенью серьезности 10 (информационные сообщения).  
  
 Если скрипт программы `sqlcmd` содержит неверный комментарий, синтаксическую ошибку или обнаружено отсутствие переменной скрипта, то возвращается значение ERRORLEVEL, равное 1.  
  
 **-m** _уровень_ошибки_  
 Управляет сообщениями об ошибках, отправляемыми в **stdout**. Передаются сообщения со степенью серьезности, которая больше заданной или равна ей. Если это значение равно **-1**, передаются все сообщения, в том числе информационные. Пробелы между параметрами **-m** и **-1**не допускаются. Например, **-m-1** является допустимым, а **-m-1** — нет.  
  
 Этот параметр также задает переменную скрипта `sqlcmd` SQLCMDERRORLEVEL. По умолчанию ее значение равно 0.  
  
 `-V`*error_severity_level*  
 Управляет степенью серьезности, используемой для задания переменной ERRORLEVEL. Сообщения об ошибках со степенями серьезности, большими этого значения или равными ему, устанавливают переменную ERRORLEVEL. Значения меньше 0 сообщаются как 0. Пакетные файлы и CMD-файлы могут быть использованы для проверки значения переменной ERRORLEVEL.  
  
 **Прочие параметры**  
  **-a** _размер_пакета_  
 Запрашивает пакет другого размера. Этот параметр устанавливает переменную скрипта SQLCMDPACKETSIZE программы `sqlcmd`. Значение*размер_пакета* должно находиться в диапазоне от 512 до 32767. Значение по умолчанию = 4096. Увеличение размера пакета повышает производительность выполнения скриптов, содержащих большое количество инструкций SQL между командами GO. Можно запросить больший размер пакета. Однако в случае, если запрос будет запрещен, программа `sqlcmd` использует размер пакета по умолчанию для сервера.  
  
 **-c** _конец_пакета_  
 Задает признак конца пакета. По умолчанию команды завершаются и отправляются на [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] при вводе слова «GO» в отдельной строке. При сбросе признака конца пакета не используйте зарезервированные ключевые слова или символы [!INCLUDE[tsql](../includes/tsql-md.md)] , которые имеют специальное значение для операционной системы, даже если перед ними присутствует символ обратной косой черты.  
  
 **-L**[**c**]  
 Выводит список локально настроенных серверов и имена серверов, осуществляющих передачу данных в сети. Этот параметр не может использоваться в сочетании с другими параметрами. Максимальное число компьютеров серверов, которое можно указать, составляет 3 000. При усечении списка серверов в связи с нехваткой размера буфера выдается предупреждающее сообщение.  
  
> [!NOTE]  
>  Из-за особенностей передачи широковещательных сообщений по сети, программа `sqlcmd` не всегда своевременно получает ответ от всех серверов. Поэтому возвращаемый список серверов от вызова к вызову может различаться.  
  
 Если указан необязательный параметр **c** , выходные данные отображаются без заголовка Servers: Line, а каждая строка сервера отображается без начальных пробелов. Это называется «чистым выводом». Чистый выход улучшает производительность обработки языков скриптов.  
  
 **-p**[**1**]  
 Выводит на печать статистику производительности для каждого результирующего набора. Далее представлен пример формата для статистики производительности:  
  
 `Network packet size (bytes): n`  
  
 `x xact[s]:`  
  
 `Clock Time (ms.): total       t1  avg       t2 (t3 xacts per sec.)`  
  
 Где:  
  
 `x` = количество транзакций, обработанных [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].  
  
 `t1` = Общее время обработки всех транзакций.  
  
 `t2` = среднее время обработки одной транзакции.  
  
 `t3` = среднее количество транзакций, обрабатываемых в секунду.  
  
 Все значения времени приведены в миллисекундах.  
  
 Если указывается необязательный параметр **1** , статистика выводится в формате со столбцами, разделенными двоеточиями, и может быть легко импортирована в электронную таблицу или обработана скриптом.  
  
 Если необязательный параметр имеет любое значение, отличное от **1**, возникает ошибка и `sqlcmd` завершается.  
  
 `-X`[**1**]  
 Отключает команды, которые могут поставить под угрозу безопасность системы при выполнении программы `sqlcmd` из пакетного файла. Отключенные команды по-прежнему распознаются. Программа `sqlcmd` выдает предупреждающее сообщение и продолжает работу. Если указан необязательный параметр **1** , `sqlcmd` выдает сообщение об ошибке, а затем завершает работу. При использовании параметра `-X` происходит отключение следующих команд:  
  
-   **ED**  
  
-   **!!** _command_  
  
 Указание параметра `-X` блокирует передачу переменных среды программе `sqlcmd`. Он также препятствует выполнению скрипта запуска, указанного с помощью переменной скрипта SQLCMDINI. Дополнительные сведения о `sqlcmd` переменных скрипта см. [в разделе Использование sqlcmd с переменными скрипта](../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md).  
  
 **-?**  
 Отображает сводку по синтаксису параметров программы `sqlcmd`.  
  
## <a name="remarks"></a>Remarks  
 Параметры не обязательно должны указываться в том порядке, в котором они приведены в разделе описания синтаксиса.  
  
 Если возвращается несколько результатов, программа `sqlcmd` выводит между результирующими наборами в пакете пустую строку. Кроме того, сообщение " \<x> затронутые строки" не отображается, если оно не применяется к выполненной инструкции.  
  
 Для `sqlcmd` интерактивного использования введите `sqlcmd` в командной строке один или несколько параметров, описанных выше в этом разделе. Дополнительные сведения см. в статье [Использование программы sqlcmd](../relational-databases/scripting/sqlcmd-use-the-utility.md)  
  
> [!NOTE]  
>  Параметры **-L**, **-Q**, **-Z** или **-i** приводят `sqlcmd` к выходу после выполнения.  
  
 Суммарная длина командной строки программы `sqlcmd` в командной среде (Cmd.exe), включая все аргументы и расширение переменных, соответствует длине для программы Cmd.exe и определяется операционной системой.  
  
## <a name="variable-precedence-low-to-high"></a>Приоритет переменных (от низкого к высокому)  
  
1.  Переменные среды системного уровня.  
  
2.  Переменные среды пользовательского уровня.  
  
3.  Командная оболочка (**Set** X = Y), заданная в командной строке перед выполнением `sqlcmd` .  
  
4.  **sqlcmd-v** X=Y  
  
5.  **:Setvar** X Y  
  
> [!NOTE]  
>  Чтобы просмотреть переменные среды, на **панели управления**откройте компонент **Система**и перейдите на вкладку **Дополнительно** .  
  
## <a name="sqlcmd-scripting-variables"></a>Переменные скрипта sqlcmd  
  
|Переменная|Связанный параметр|Чтение-запись|По умолчанию|  
|--------------|--------------------|----------|-------------|  
|SQLCMDUSER|-U|R|""|  
|SQLCMDPASSWORD|-P|--|""|  
|SQLCMDSERVER|-S|R|"DefaultLocalInstance"|  
|SQLCMDWORKSTATION|-H|R|"ComputerName"|  
|SQLCMDDBNAME|-d|R|""|  
|SQLCMDLOGINTIMEOUT|-l|Чтение-запись|"8" (секунд)|  
|SQLCMDSTATTIMEOUT|-T|Чтение-запись|"0" = неограниченное время ожидания|  
|SQLCMDHEADERS|-H|Чтение-запись|"0"|  
|SQLCMDCOLSEP|-S|Чтение-запись|" "|  
|SQLCMDCOLWIDTH|-w|Чтение-запись|"0"|  
|SQLCMDPACKETSIZE|-a|R|"4096"|  
|SQLCMDERRORLEVEL|-M|Чтение-запись|0|  
|SQLCMDMAXVARTYPEWIDTH|-y|Чтение-запись|«256»|  
|SQLCMDMAXFIXEDTYPEWIDTH|-y|Чтение-запись|"0" = неограниченное время ожидания|  
|SQLCMDEDITOR||Чтение-запись|"edit.com"|  
|SQLCMDINI||R|""|  
  
 Переменные SQLCMDUSER, SQLCMDPASSWORD и SQLCMDSERVER устанавливаются при использовании команды **:Connect**  
  
 .  
  
 Пометка «Чтение» означает, что значение может быть задано только один раз в процессе инициализации программы.  
  
 Пометка "Чтение/запись" означает, что переменная может быть изменена командой **setvar** и все последующие команды будут использовать новое значение.  
  
## <a name="sqlcmd-commands"></a>Команды sqlcmd  
 В дополнение к инструкциям [!INCLUDE[tsql](../includes/tsql-md.md)] в программе `sqlcmd` доступны также следующие команды:  
  
|||  
|-|-|  
|**GO** [*число*]|**:List**|  
|[ **:** ] **RESET**|**:Error**|  
|[ **:** ] **ED**|**:Out**|  
|[**:**] **!!**|**:Perftrace**|  
|[ **:** ] **QUIT**|**:Connect**|  
|[ **:** ] **EXIT**|**:On Error**|  
|**:r**|**:Help**|  
|**:ServerList**|**:XML** [**ON** &#124; **OFF**]|  
|**:Setvar**|**:Listvar**|  
  
 При использовании команд программы `sqlcmd` следует учитывать следующие особенности.  
  
-   Все команды `sqlcmd`, за исключением GO, должны предваряться двоеточием (:).  
  
    > [!IMPORTANT]  
    >  Для поддержки обратной совместимости с существующими скриптами **osql** , некоторые команды будут распознаваться без двоеточия. На это указывают символы[**:**].  
  
-   Команды `sqlcmd` распознаются только в случае, если они введены в начале строки.  
  
-   Во всех командах `sqlcmd` регистр символов не учитывается.  
  
-   Каждая команда должна находиться на отдельной строке. За командой не должна следовать инструкция [!INCLUDE[tsql](../includes/tsql-md.md)] или другая команда.  
  
-   Команды выполняются немедленно. Они не помещаются в буфер выполнения, как инструкции [!INCLUDE[tsql](../includes/tsql-md.md)] .  
  
 **Команды изменения**  
  [ **:** ] **ED**  
 Производит запуск текстового редактора. Этот редактор может использоваться для изменения текущего пакета [!INCLUDE[tsql](../includes/tsql-md.md)] или последнего выполненного пакета. Для изменения последнего выполненного пакета необходимо ввести команду **ED** сразу после выполнения последнего пакета.  
  
 Текстовый редактор определяется переменной среды SQLCMDEDITOR. Редактором по умолчанию является «Edit». Чтобы изменить редактор, установите переменную среды SQLCMDEDITOR. Например, чтобы установить в качестве редактора Блокнот ( [!INCLUDE[msCoName](../includes/msconame-md.md)] ), в командной строке введите:  
  
 `SET SQLCMDEDITOR=notepad`  
  
 [ **:** ] **RESET**  
 Очистка кэша инструкций.  
  
 **:List**  
 Вывод содержимого кэша инструкций.  
  
 **Переменные**  
  **: Setvar** \<**var**> [ **"*`value`*"** ]  
 Определяет переменные скрипта `sqlcmd`. Переменные скрипта имеют следующий формат: `$(VARNAME)`.  
  
 Имена переменных не зависят от регистра символов.  
  
 Переменные скрипта могут быть установлены следующими способами.  
  
-   Неявно, с помощью параметра командной строки. Например, параметр **-l** задает `sqlcmd` переменную SQLCMDLOGINTIMEOUT.  
  
-   Явным образом, с помощью команды **:Setvar** .  
  
-   Путем установки переменной среды до запуска программы `sqlcmd`.  
  
> [!NOTE]  
>  Параметр `-X` предотвращает передачу переменных среды программе `sqlcmd`.  
  
 Если переменная, определенная с использованием **:Setvar** и переменной окружения, имеет одно и то же имя, переменная, определенная с помощью **:Setvar** имеет преимущество.  
  
 Имена переменных не должны содержать пробелы.  
  
 Имена переменных не могут иметь тот же формат, что и выражение переменной: $(переменная).  
  
 Если строковое значение переменной скрипта содержит пробелы, то заключите значение в кавычки. Если значение для переменной скрипта не указано, переменная скрипта удаляется.  
  
 **:Listvar**  
 Список переменных скрипта, заданных в настоящее время.  
  
> [!NOTE]  
>  Будут отображены только переменные скрипта, заданные параметром `sqlcmd` , и те, которые задаются с помощью команды **: setvar** .  
  
 **Команды вывода**  
  **:Error**   
 **_\<_** _filename_  **_>|_ STDERR | STDOUT**  
 Перенаправляет вывод всех сообщений об ошибках в файл, указываемый параметром *имя_файла*, в поток **stderr** или **stdout**. Команда **Error** может встречаться в скрипте несколько раз. По умолчанию вывод об ошибках направляется в **STDERR**.  
  
 *имя_файла*  
 Создает и открывает файл, который принимает выходные данные. Если файл уже существует, он будет усечен до 0 байт. Если файл недоступен по причине нехватки разрешений или по другим причинам, вывод перенаправляется не в него, а в последнее указанное назначение или в назначение по умолчанию.  
  
 **STDERR**  
 Перенаправляет вывод сообщений об ошибках в поток **stderr** . Если было выполнено перенаправление, то адресат, которому был перенаправлен поток, получит выход ошибок.  
  
 **STDOUT**  
 Перенаправляет выход ошибок в поток **stdout** . Если было выполнено перенаправление, то адресат, которому был перенаправлен поток, получит выход ошибок.  
  
 **: Out \<** _filename_ **> ** |  **Stderr** |  **Stdout**  
 Создает и переадресовывает все результаты запроса в файл, указываемый параметром *имя_файла*, в **stderr** или **stdout**. По умолчанию вывод направляется в **stdout**. Если файл уже существует, он будет усечен до 0 байт. Команда **Out** может встречаться в скрипте несколько раз.  
  
 **:P ерфтраце \<** _filename_ **> ** |  **Stderr** |  **Stdout**  
 Создает и переадресовывает все данные трассировки производительности в файл, указываемый параметром *имя_файла*, в **stderr** или **stdout**. По умолчанию вывод о трассировки производительности направляется в **stdout**. Если файл уже существует, он будет усечен до 0 байт. Команда **Perftrace** может встречаться в скрипте несколько раз.  
  
 **Команды контроля выполнения**  
  **: On Error**[ `exit`  |  `ignore` ]  
 Установка действия, выполняемого при возникновении ошибки во время исполнения скрипта или пакета.  
  
 Если используется параметр `exit`, программа `sqlcmd` завершает работу с возвратом значения соответствующей ошибки.  
  
 Если указан параметр `ignore`, ошибка пропускается параметром `sqlcmd` и продолжается выполнение пакета или скрипта. По умолчанию будет распечатано сообщение об ошибке.  
  
 [ **:** ] **QUIT**  
 Вызывает закрытие `sqlcmd`.  
  
 [**:**] **Exit**[ **( *`statement`* )** ]  
 Позволяет использовать результат выполнения инструкции SELECT в качестве возвращаемого значения программы `sqlcmd`. Если числовой, первый столбец последней строки результатов преобразуется в 4-байтовое целое число (long). В MS-DOS младший байт передается родительскому процессу или уровню ошибки операционной системы. В Windows 200x передается 4-байтовое целое число. Синтаксис:  
  
 `:EXIT(query)`  
  
 Пример:  
  
 `:EXIT(SELECT @@ROWCOUNT)`  
  
 Также можно включить параметр **EXIT** в пакетный файл. Например, в командной строке введите:  
  
 `sqlcmd -Q "EXIT(SELECT COUNT(*) FROM '%1')"`  
  
 `sqlcmd`Служебная программа отправляет на сервер все, что заключено в круглые скобки **()** . Если хранимая системная процедура выбирает набор и возвращает значение, то возвращается только выбранный набор. Инструкция EXIT **()** с пустыми круглыми скобками выполняет все, что предшествует ей в пакете, а затем завершается без возврата значения.  
  
 Если указан неверный запрос, программа `sqlcmd` завершит работу, не возвращая значения.  
  
 Список форматов инструкции EXIT:  
  
-   :EXIT  
  
 Не выполняет пакет, немедленно завершает работу и не возвращает значения.  
  
-   :EXIT( )  
  
 Выполняет пакет, завершает выполнение и не возвращает значения.  
  
-   :EXIT(query)  
  
 Выполняет пакет, включая запрос, возвращает результаты запроса и завершает работу.  
  
 Если в скрипте `sqlcmd` используется параметр RAISERROR, и при этом возникает состояние 127, программа `sqlcmd` завершает выполнение и возвращает клиенту идентификатор сообщения. Пример:  
  
 `RAISERROR(50001, 10, 127)`  
  
 Эта ошибка приведет к завершению скрипта `sqlcmd`, а клиенту будет возвращено сообщение с идентификатором 50001.  
  
 Возвращаемые значения от -1 до -99 зарезервированы [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Программа `sqlcmd` дополнительно определяет следующие коды возврата:  
  
|Возвращаемые значения|Описание|  
|-------------------|-----------------|  
|–100|Перед выбором возвращаемого значения произошла ошибка.|  
|–101|При выборе возвращаемого значения не найдены строки.|  
|–102|При выборе возвращаемого значения произошла ошибка преобразования.|  
  
 **GO** [*число*]  
 GO обозначает конец пакетного файла и исполнения любых кэшированных инструкций [!INCLUDE[tsql](../includes/tsql-md.md)] . При задании значения для параметра *count*кэшируемые инструкции будут выполняться указанное *count* раз в виде единого пакета.  
  
 **Прочие команды**  
  **: r\<** _filename_ **>**  
 Выполняет синтаксический анализ дополнительных [!INCLUDE[tsql](../includes/tsql-md.md)] инструкций и `sqlcmd` команд из файла, указанного **<*`filename`*>** в кэше инструкций.  
  
 Если файл содержит инструкции [!INCLUDE[tsql](../includes/tsql-md.md)] , за которыми не следует ключевое слово **GO**, необходимо ввести **GO** в строку, следующую за **:r**.  
  
> [!NOTE]  
>  **\<** _filename_ **>** считывается относительно каталога запуска, в котором выполнялся `sqlcmd` .  
  
 Файл будет считан и выполнен после обнаружения признака конца пакета. Можно указывать несколько команд **:r** . В файле могут содержаться любые команды программы `sqlcmd`, в том числе признак конца пакета **GO**.  
  
> [!NOTE]  
>  Число строк, отображаемых в интерактивном режиме, для каждой найденной команды **:r** будет увеличено на 1. Команда **:r** отображается в выводе команды list.  
  
 **:Serverlist**  
 Выводит список локально настроенных серверов и имена серверов, осуществляющих трансляцию данных в сети.  
  
 **: Connect** _server_name_[ **\\** _instance_name_] [-l *timeout*] [-U *user_name* [-P *пароль*]]  
 Соединяется с экземпляром [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Также закрывает текущее соединение.  
  
 Параметры времени ожидания:  
  
|||  
|-|-|  
|0|ждать бесконечно|  
|n>0|ждать в течение n секунд|  
  
 Переменная скрипта SQLCMDSERVER отображает текущее активное соединение.  
  
 Если не указан параметр *timeout* , то берется значение переменной SQLCMDLOGINTIMEOUT по умолчанию.  
  
 Если указано только *имя_пользователя* (в виде параметра или в виде переменной среды), у пользователя будет запрошен пароль. Однако этого не произойдет, если установлены переменные среды SQLCMDUSER или SQLCMDPASSWORD. Если ни параметры, ни переменные среды не введены, то для входа используется режим проверки подлинности Windows. Например, для подключения к экземпляру `instance1`сервера [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]с именем `myserver`с использованием встроенной безопасности следует ввести следующую команду:  
  
 `:connect myserver\instance1`  
  
 Для подключения к экземпляру `myserver` по умолчанию с использованием переменных скрипта следует ввести следующее выражение:  
  
 `:setvar myusername test`  
  
 `:setvar myservername myserver`  
  
 `:connect $(myservername) $(myusername)`  
  
 [**:**] **!!**\< *command*>  
 Исполнение команд операционной системы. Чтобы выполнить команду операционной системы, начните строку с двух восклицательных знаков ( **!!** ) и далее укажите команду операционной системы. Пример:  
  
 `:!! Dir`  
  
> [!NOTE]  
>  Команда выполняется на компьютере, где работает программа `sqlcmd`.  
  
 **:XML** [**ON** | **OFF**]  
 Дополнительные сведения см. в подразделе «Формат выходных XML-данных» далее в этом разделе.  
  
 **:Help**  
 Выводит список команд программы `sqlcmd` вместе с кратким описанием каждой из них.  
  
### <a name="sqlcmd-file-names"></a>Имена файлов sqlcmd  
 `sqlcmd`входные файлы можно указать с помощью параметра **-i** или команды **: r** . Выходные файлы можно указать параметром **-o** или командами **:Error**, **:Out** и **:Perftrace** . При работе с этими файлами следует придерживаться следующих правил.  
  
-   **: Error**, **: out** и **:P ерфтраце** должны использовать отдельные **<*`filename`*>** . Если используется то же значение **<*`filename`*>** , входные данные команд могут быть смешанными.  
  
-   Если входной файл, вызываемый из программы `sqlcmd` на локальном компьютере, расположен на удаленном сервере и путь к этому файлу содержит букву диска (например, «:out c:\OutputFile.txt»), то выходной файл будет создан на локальном компьютере, а не на удаленном сервере.  
  
-   К допустимым путям файлов относятся: C: \\ **<*`filename`*>** , \\ \\<Server \> \\<Share $>\\ **<*`filename`*>** и "c: \ Folder \\ **<*`file name`*>** ". Если путь содержит пробелы, его необходимо заключить в кавычки.  
  
-   Каждый новый сеанс работы программы `sqlcmd` перезаписывает существующие файлы с теми же именами.  
  
### <a name="informational-messages"></a>Информационные сообщения  
 Программа `sqlcmd` выводит все информационные сообщения, отправляемые сервером. В следующем примере после выполнения инструкций [!INCLUDE[tsql](../includes/tsql-md.md)] выводится информационное сообщение.  
  
 В командной строке введите следующее.  
  
 `sqlcmd`  
  
 `At the sqlcmd prompt type:`  
  
 `USE AdventureWorks2012;`  
  
 `GO`  
  
 При нажатии клавиши ВВОД выводится следующее информационное сообщение: Контекст базы данных изменен на AdventureWorks2012.  
  
### <a name="output-format-from-transact-sql-queries"></a>Формат вывода результатов выполнения запросов Transact-SQL  
 Вначале программа `sqlcmd` выводит заголовок, содержащий имена столбцов, перечисленных в списке выборки, которые разделяются символом, определенным в переменной SQLCMDCOLSEP. По умолчанию это пробел. Если имя столбца короче, чем ширина столбца, выходные данные дополняются пробелами до начала следующего столбца.  
  
 За этой строкой выводится строка-разделитель, которая представляет собой последовательность дефисов. Далее представлен пример вывода.  
  
 Запустите среду `sqlcmd`. Введите в командной строке: `sqlcmd`.  
  
 `USE AdventureWorks2012;`  
  
 `SELECT TOP (2) BusinessEntityID, FirstName, LastName`  
  
 `FROM Person.Person;`  
  
 `GO`  
  
 После нажатия клавиши ВВОД отобразится следующий результирующий набор.  
  
 `BusinessEntityID FirstName    LastName`  
  
 `---------------- ------------ ----------`  
  
 `285              Syed         Abbas`  
  
 `293              Catherine    Abel`  
  
 `(2 row(s) affected)`  
  
 Хотя столбец `BusinessEntityID` имеет ширину 4 символа, она была увеличена, чтобы вместить более длинное имя столбца. По умолчанию вывод заканчивается на 80 символе. Это можно изменить с помощью параметра **-w** , либо задав переменную скрипта SQLCMDCOLWIDTH.  
  
### <a name="xml-output-format"></a>Формат вывода XML  
 Выходные XML-данные, получаемые в результате выполнения предложения FOR XML, выводятся непрерывным потоком в неформатированном виде.  
  
 Если вы ожидаете вывод XML-данных, воспользуйтесь следующей командой: `:XML ON`.  
  
> [!NOTE]  
>  Программа `sqlcmd` выводит сообщения об ошибках в обычном формате. Обратите внимание, что сообщения об ошибках также выводятся в текстовый поток в формате XML. Если указать параметр `:XML ON`, программа `sqlcmd` не выводит информационные сообщения.  
  
 Чтобы отключить режим XML, введите следующую команду: `:XML OFF`.  
  
 Команда GO не должна указываться раньше команды XML OFF, поскольку последняя возвращает `sqlcmd` в режим вывода с построчным форматированием.  
  
 Не допускается смешивать XML-данные (потоковые) и данные набора строк. Если перед выполнением инструкции [!INCLUDE[tsql](../includes/tsql-md.md)] , которая выводит потоки XML-данных, не была введена команда XML ON, то вывод будет искажен. Если была выполнена команда XML ON, то нельзя выполнить инструкции [!INCLUDE[tsql](../includes/tsql-md.md)] , которые выводят обычные наборы строк.  
  
> [!NOTE]  
>  Команда **:XML** не поддерживает инструкцию SET STATISTICS XML.  
  
## <a name="sqlcmd-best-practices"></a>Рекомендации по использованию sqlcmd  
 Чтобы добиться максимальной безопасности и эффективности, придерживайтесь следующих правил.  
  
-   Используйте встроенную безопасность.  
  
-   В автоматических средах указывайте параметр `-X`.  
  
-   Обеспечьте защиту входных и выходных файлов при помощи соответствующих разрешений файловой системы NTFS.  
  
-   В целях повышения производительности выполняйте как можно больше работы в одном сеансе программы `sqlcmd`.  
  
-   Задайте значение времени ожидания для выполнения пакетов или запросов выше, чем ожидаемое время их выполнения.  
  
## <a name="see-also"></a>См. также:  
 [Запуск программы sqlcmd](../relational-databases/scripting/sqlcmd-start-the-utility.md)   
 [Выполнение файлов скрипта Transact-SQL с использованием программы sqlcmd](../relational-databases/scripting/sqlcmd-run-transact-sql-script-files.md)   
 [Использование программы sqlcmd](../relational-databases/scripting/sqlcmd-use-the-utility.md)   
 [Использование программы sqlcmd с переменными скрипта](../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md)   
 [Подключение к компоненту Database Engine при помощи программы sqlcmd](../relational-databases/scripting/sqlcmd-connect-to-the-database-engine.md)   
 [Изменение скриптов SQLCMD при помощи редактора запросов](../relational-databases/scripting/edit-sqlcmd-scripts-with-query-editor.md)   
 [Управление шагами задания](../ssms/agent/manage-job-steps.md)   
 [Create a CmdExec Job Step](../ssms/agent/create-a-cmdexec-job-step.md)  
  
  
