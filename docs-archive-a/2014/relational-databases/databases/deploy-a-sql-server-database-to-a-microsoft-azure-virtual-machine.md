---
title: Развертывание базы данных SQL Server на виртуальной машине Microsoft Azure | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
f1_keywords:
- sql12.swb.deploymentwizard.deploymentsettings.f1
- sql12.swb.deploymentwizard.progress.f1
- sql11.swb.usevmdialog.f1
- sql11.swb.deploymentwizard.f1
- sql12.swb.deploymentwizard.azuresignin.f1
- sql11.swb.deploymentwizard.summary.f1
- sql11.swb.deploymentwizard.azuresignin.f1
- sql12.swb.deploymentwizard.f1
- sql12.swb.sqlvmdialog.f1
- sql11.swb.newvmdialog.f1
- sql12.swb.deploymentwizard.results.f1
- sql11.swb.deploymentwizard.progress.f1
- sql12.swb.newvmdialog.f1
- sql12.swb.deploymentwizard.sourcesettings.f1
- sql12.swb.usevmdialog.f1
- sql11.swb.deploymentwizard.sourcesettings.f1
- sql11.swb.deploymentwizard.results.f1
- sql12.swb.deploymentwizard.summary.f1
- sql11.swb.deploymentwizard.deploymentsettings.f1
helpviewer_keywords:
- Deploy a database
- Deploy to Azure VM
- Migrate to Azure
- Azure virtual machine
- Migrate to Azure VM
- Migrate to the cloud
- SQL Server Management Studio
- SSMS
- Deploy database wizard
- Deploy a SQL Server database to Azure
- Azure VM
ms.assetid: 5e82e66a-262e-4d4f-aa89-39cb62696d06
author: stevestein
ms.author: sstein
ms.openlocfilehash: d48c06db038a775811cba6705fbaf1d97a960f6c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736386"
---
# <a name="deploy-a-sql-server-database-to-a-microsoft-azure-virtual-machine"></a>Развертывание базы данных SQL Server в виртуальной машине Microsoft Azure
  Используйте мастер **развертывания SQL Server базы данных в виртуальной машине Azure** , чтобы развернуть базу данных из экземпляра в [!INCLUDE[ssDE](../../includes/ssde-md.md)] на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] виртуальной машине Azure. Мастер использует операцию полного резервного копирования базы данных, поэтому он всегда копирует всю схему базы данных и данные из пользовательской базы данных SQL Server. Мастер также выполняет всю настройку ВМ Azure, поэтому дополнительные действия для задания параметров ВМ не требуются.  
  
 Нельзя использовать мастер для создания разностных резервных копий, поскольку он не перезаписывает существующую базу данных, имя которой совпадает с именем обрабатываемой базы данных. Чтобы заменить существующую базу данных на ВМ, сначала необходимо удалить существующую базу данных или изменить имя базы данных. В случае возникновения конфликта имен между базой данных, в отношении которой выполняется операция развертывания на лету, и существующей базой данных на виртуальной машине мастер предложит имя базы данных с добавлением определенных символов для развертываемой на лету базы данных, чтобы можно было завершить операцию.  
  
##  <a name="before-you-begin"></a><a name="before_you_begin"></a> Перед началом  
 Чтобы завершить этот мастер, необходима возможность предоставить следующие сведения и назначить следующие параметры конфигурации:  
  
-   Сведения о учетная запись Майкрософт, связанные с подпиской Azure.  
  
-   Ваш профиль публикации Azure.  
  
    > [!CAUTION]  
    >  SQL Server в настоящий момент поддерживает версию 2.0 профиля публикации. Для загрузки поддерживаемой версии профиля публикации см. раздел [Загрузка профиля публикации 2.0](https://go.microsoft.com/fwlink/?LinkId=396421).  
  
-   Сертификат управления, отправленный в подписку Azure.  
  
-   Сертификат управления, сохраненный в хранилище личных сертификатов на компьютере, где запущен мастер.  
  
-   Необходимо временное место хранения, доступное для компьютера, на котором размещается база данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Временное место хранения также должно быть доступным для компьютера, на котором запущен мастер.  
  
-   При развертывании базы данных на существующей виртуальной машине в экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] должно быть настроено прослушивание порта TCP/IP.  
  
-   Для виртуальной машины Azure или образа коллекции, который планируется использовать для создания виртуальной машины, необходимо настроить и запустить адаптер для облака SQL Server.  
  
-   Необходимо настроить открытую конечную точку для SQL Server адаптер для облака в шлюзе Azure с частным портом 11435.  
  
 Кроме того, если вы планируете развернуть базу данных на существующей виртуальной машине Azure, необходимо также предоставить следующие возможности.  
  
-   Имя DNS облачной службы, в которой размещается виртуальная машина.  
  
-   Учетные данные администратора для виртуальной машины.  
  
-   Учетные данные с правами доступа для выполнения оператора резервного копирования базы данных, которую планируется развернуть из исходного экземпляра служб [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 Дополнительные сведения о запуске SQL Server на виртуальных машинах Azure см. в статье [Подготовка к переходу на SQL Server на виртуальных машинах Azure](https://msdn.microsoft.com/library/dn133142.aspx).  
  
 На компьютерах, работающих под управлением операционных систем Windows Server, для запуска мастера необходимо использовать следующие параметры конфигурации.  
  
-   Отключите конфигурацию усиленной безопасности: выберите "Диспетчер серверов" > "Локальный сервер" и задайте для параметра "Конфигурация усиленной безопасности Internet Explorer" значение **ВЫКЛ**.  
  
-   Включите JavaScript: Internet Explorer > Свойства обозревателя > Безопасность > Уровень пользователя > Скрипты > Активные скрипты: **Включить**.  
  
###  <a name="limitations-and-restrictions"></a><a name="limitations"></a> Ограничения  
 Размер базы данных для этой операции не может превышать 1 ТБ.  
  
 Эта функция развертывания доступна в среде SQL Server Management Studio для [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].  
  
 Эта функция развертывания предназначена для использования только в отношении пользовательских баз данных. Развертывание системных баз данных не поддерживается.  
  
 Функция развертывания не поддерживает размещаемые службы, связанные с группой сходства. Например, учетные записи хранения, связанные с группой сходства, нельзя выбрать для использования на странице мастера **Параметры развертывания** .  
  
 Версия SQL Server в виртуальной машине должна быть такой же, что и исходная версия SQL Server, или более поздней. SQL Server версии базы данных, которые можно развернуть на виртуальной машине Azure с помощью этого мастера:  
  
-   SQL Server 2008  
  
-   SQL Server 2008 R2  
  
-   SQL Server 2012  
  
-   [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]  
  
 SQL Server версии базы данных, выполняющиеся в базе данных виртуальной машины Azure, можно развернуть в:  
  
-   SQL Server 2012  
  
-   [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]  
  
 В случае возникновения конфликта имен между базой данных, в отношении которой выполняется операция развертывания на лету, и существующей базой данных на виртуальной машине мастер предложит имя базы данных с добавлением определенных символов для развертываемой на лету базы данных, чтобы можно было завершить операцию.  
  
###  <a name="considerations-for-deploying-a-filestream-enabled-database-to-an-azure-vm"></a><a name="filestream"></a> Основные моменты при развертывании базы данных с поддержкой FILESTREAM на виртуальную машину SQL Azure  
 Обратите внимание на следующие правила и ограничения при развертывании баз данных с большими двоичными объектами, хранящихся в объектах FILESTREAM.  
  
-   Функция развертывания не может развернуть базу данных с поддержкой FILESTREAM на новой виртуальной машине. Если функция FILESTREAM отключена в виртуальной машине до запуска мастера, то операция восстановления базы данных завершится ошибкой, а операция мастера не будет завершена успешно. Для успешного развертывания базы данных, в которой используется FILESTREAM, перед запуском мастера включите FILESTREAM в экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на виртуальной машине основного приложения. Дополнительные сведения см. в разделе [FILESTREAM (SQL Server)](https://msdn.microsoft.com/library/gg471497.aspx).  
  
-   Если база данных использует функции OLTP в памяти, то можно развернуть базу данных в виртуальной машине Azure без каких-либо изменений в базе данных. Дополнительные сведения см. в разделе [In-Memory OLTP (оптимизация в памяти)](https://msdn.microsoft.com/library/dn133186\(SQL.120\).aspx).  
  
###  <a name="considerations-for-geographic-distribution-of-assets"></a><a name="geography"></a>Рекомендации по географическому распределению ресурсов  
 Обратите внимание, что следующие активы должны находиться в одной и той же географической области.  
  
-   Облачная служба  
  
-   Расположение виртуальной машины  
  
-   Служба хранения диска данных  
  
 Если приведенные выше активы не находятся в одном месте, мастер не сможет завершиться успешно.  
  
###  <a name="wizard-configuration-settings"></a><a name="configuration_settings"></a>Параметры конфигурации мастера  
 Используйте следующие параметры конфигурации для изменения настроек для развертывания базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на виртуальной машине Azure.  
  
-   **Путь по умолчанию к файлу конфигурации** : "%LOCALAPPDATA%\SQL Server\Deploy to SQL in WA VM\DeploymentSettings.xml".  
  
-   **Структура файла конфигурации**  
  
    -   \<DeploymentSettings>  
  
        -   <OtherSettings  
  
            -   TraceLevel = "Debug"\<!-- Logging level -->  
  
            -   BackupPath = " \\ \\ [имя сервера] \\ [том] \\ "\<!-- The last used path for backup. Used as default in the wizard. -->  
  
            -   CleanupDisabled = false/>\<!-- Wizard will not delete intermediate files and Azure objects (VM, CS, SA). -->  
  
        -   <PublishProfile\<!-- The last used publish profile information. -->  
  
            -   Certificate = "12A34B567890123ABCD4EF567A8"\<!-- The certificate for use in the wizard. -->  
  
            -   Subscription = "1a2b34c5-67d8-90ef-AB12-xxxxxxxxxxxxx"\<!-- The subscription for use in the wizard. -->  
  
            -   Name = "Моя подписка"\<!-- The name of the subscription. -->  
  
            -   Publisher="" />  
  
    -   \</DeploymentSettings>  
  
 **Значения файла конфигурации**  
  
###  <a name="permissions"></a><a name="permissions"></a> Permissions  
 Развертываемая база данных должна находиться в нормальном состоянии, база данных должна быть доступна для учетной записи пользователя, запустившего мастер, и учетная запись должна иметь разрешения для выполнения операции резервного копирования.  
  
##  <a name="using-the-deploy-database-to-azure-vm-wizard"></a><a name="launch_wizard"></a>Использование мастера развертывания базы данных в виртуальной машине Azure  
 **Для запуска мастера выполните следующие действия.**  
  
1.  Использование среды SQL Server Management Studio для подключения к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с базой данных, развертывание которой требуется выполнить.  
  
2.  В **обозревателе объектов**разверните имя экземпляра, затем узел **Databases** .  
  
3.  Щелкните правой кнопкой мыши базу данных, которую необходимо развернуть, выберите **задачи**, а затем — **развернуть базу данных на виртуальной машине Azure...**  
  

  
##  <a name="introduction-page"></a><a name="Introduction"></a> Вводная страница  
 На этой странице описывается мастер **развертывания SQL Server базы данных в виртуальной машине Azure** .  
  
 **Параметры**  
  
-   **Больше не показывать эту страницу.** Установите этот флажок, чтобы вводная страница больше не отображалась.  
  
-   **Следующая** — переход к странице **Параметры источника** .  
  
-   **Отмена** — отмена операции и закрытие мастера.  
  
-   **Справка** — запуск раздела справки MSDN для мастера.  
  
##  <a name="source-settings"></a><a name="Source_settings"></a>Параметры источника  
 Эта страница используется для подключения к экземпляру, на котором [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] размещена база данных, которую требуется развернуть на виртуальной машине Azure. Кроме того, необходимо указать временное расположение файлов, сохраняемых на локальном компьютере, прежде чем они будут переданы в Azure. Это может быть общая сетевая папка.  
  
 **Параметры**  
  
-   Нажмите кнопку **Подключить...** , а затем укажите сведения о подключении для экземпляра, на котором [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] размещена база данных для развертывания.  
  
-   Используйте раскрывающийся список **Выбор базы данных** , чтобы указать базу данных для развертывания.  
  
-   В поле **другие параметры** укажите общую папку, которая будет доступна службе виртуальной машины Azure.  
  
##  <a name="azure-sign-in"></a><a name="Azure_sign-in"></a>Вход в Azure  
 Эта страница используется для подключения к Azure и предоставления сертификата управления или сведений о профиле публикации.  
  
 **Параметры**  
  
-   **Сертификат управления** — используйте этот параметр, чтобы указать сертификат из локального хранилища сертификатов, который соответствует сертификату управления в Azure.  
  
-   **Профиль публикации** . Используйте этот параметр, если профиль публикации уже загружен на компьютер.  
  
-   **Вход** . Используйте этот параметр, чтобы войти в Azure с помощью учетная запись Майкрософт (например, Live ID или учетной записи Hotmail), чтобы создать и скачать новый сертификат управления. Обратите внимание, что количество сертификатов на одну подписку ограниченно.  
  
-   **Подписка** — выберите, введите или вставьте идентификатор подписки Azure, соответствующий сертификату управления из локального хранилища сертификатов или профиля публикации.  
  
##  <a name="deployment-settings-page"></a><a name="Deployment_settings"></a>Страница "Параметры развертывания"  
 На этой странице указываются целевой сервер и подробные сведения о новой базе данных.  
  
 **Параметры**  
  
-   **Виртуальная машина Azure** . Укажите сведения для виртуальной машины, на которой будет размещена база данных SQL Server:  
  
-   **Имя облачной службы** . Укажите имя службы, в которой РАЗМЕЩЕНа виртуальная машина. Чтобы создать новую облачную службу укажите для нее имя.  
  
-   **Имя виртуальной машины** — укажите имя виртуальной машины, на которой будет размещена база данных SQL Server. Чтобы создать виртуальную машину Azure, укажите имя для новой виртуальной машины.  
  
-   **Параметры** . с помощью кнопки "Параметры" Создайте виртуальную машину для размещения базы данных SQL Server. Если используется существующая виртуальная машина, предоставленные сведения будут использоваться для проверки подлинности учетных данных.  
  
-   **Учетная запись хранения** . Выберите учетную запись хранения из раскрывающегося списка. Для создания новой учетной записи хранения укажите для нее имя. Обратите внимание, что учетные записи хранения, связанные с группой сходства, не будут доступны в раскрывающемся списке.  
  
-   **Целевая база данных** — укажите сведения о целевой базе данных.  
  
-   **Соединение с сервером** — сведения о подключении для сервера.  
  
-   **База данных** — укажите или подтвердите имя новой базы данных. Если имя базы данных уже существует на целевом экземпляре SQL Server, измените имя базы данных.  
  
##  <a name="summary-page"></a><a name="Summary"></a> Страница «Сводка»  
 На этой странице можно просмотреть указанные параметры операции. Чтобы выполнить развертывание с заданными параметрами, нажмите кнопку **Готово**. Чтобы отменить операцию развертывания и выйти из мастера, нажмите кнопку **"Отмена"**.  
  
 Для развертывания сведений о базе данных в SQL Server базе данных на виртуальной машине Azure могут потребоваться ручные действия. Эти действия будут подробно описаны.  
  
##  <a name="results-page"></a><a name="Results"></a>Страница «результаты»  
 На этой странице отображаются сведения об успешности операции развертывания по результатам каждого действия. Для каждого действия, в котором обнаружена ошибка, предусмотрен индикатор в столбце **Результат** . Щелкните эту ссылку, чтобы просмотреть отчет об ошибках, относящихся к данному действию.  
  
 Чтобы завершить работу мастера, нажмите кнопку **Готово** .  
  
## <a name="see-also"></a>См. также:  
 [адаптер для облака для SQL Server](../../database-engine/cloud-adapter-for-sql-server.md)   
 [Управление жизненным циклом базы данных](../database-lifecycle-management.md)   
 [Экспорт приложения уровня данных](../data-tier-applications/export-a-data-tier-application.md)   
 [Импорт BACPAC-файла для создания новой пользовательской базы данных](../data-tier-applications/import-a-bacpac-file-to-create-a-new-user-database.md)   
 [Резервное копирование и восстановление базы данных SQL Azure](https://msdn.microsoft.com/library/azure/jj650016.aspx)   
 [Развертывание SQL Server на виртуальных машинах Azure](https://msdn.microsoft.com/library/dn133141.aspx)   
 [Подготовка к переходу на SQL Server в виртуальных машинах Azure](https://msdn.microsoft.com/library/dn133142.aspx)  
  
  
