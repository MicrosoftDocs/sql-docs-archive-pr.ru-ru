---
title: Автономные базы данных | Документация Майкрософт
ms.custom: ''
ms.date: 07/17/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- contained database
- database_uncontained_usage event
- partially contained database
- contained database, understanding
ms.assetid: 36af59d7-ce96-4a02-8598-ffdd78cdc948
author: stevestein
ms.author: sstein
ms.openlocfilehash: 3efd231a1aa4d2b348bcfe887bd05825fcd40c90
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87734141"
---
# <a name="contained-databases"></a><span data-ttu-id="9497b-102">Автономные базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-102">Contained Databases</span></span>
  <span data-ttu-id="9497b-103">*Автономная база данных* — это база данных, изолированная от других баз данных и от экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , на котором размещена эта база данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-103">A*contained database* is a database that is isolated from other databases and from the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that hosts the database.</span></span>  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="9497b-104">помогает пользователю изолировать свою базу данных от экземпляра четырьмя способами.</span><span class="sxs-lookup"><span data-stu-id="9497b-104">helps user to isolate their database from the instance in 4 ways.</span></span>  
  
-   <span data-ttu-id="9497b-105">Большая часть метаданных, описывающих базу данных, ведется в базе данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-105">Much of the metadata that describes a database is maintained in the database.</span></span> <span data-ttu-id="9497b-106">(В дополнение или вместо хранения метаданных в базе данных master.)</span><span class="sxs-lookup"><span data-stu-id="9497b-106">(In addition to, or instead of, maintaining metadata in the master database.)</span></span>  
  
-   <span data-ttu-id="9497b-107">Все метаданные определяются с использованием одних и тех же параметров сортировки.</span><span class="sxs-lookup"><span data-stu-id="9497b-107">All metadata are defined using the same collation.</span></span>  
  
-   <span data-ttu-id="9497b-108">База данных может выполнять проверку подлинности пользователей, что сокращает зависимость баз данных от имен входа экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9497b-108">User authentication can be performed by the database, reducing the databases dependency on the logins of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="9497b-109">Среда [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (динамические административные представления, XEvents и т. д.) предоставляет отчеты об автономности и может работать с ней.</span><span class="sxs-lookup"><span data-stu-id="9497b-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] environment (DMV's, XEvents, etc.) reports and can act upon containment information.</span></span>  
  
 <span data-ttu-id="9497b-110">Некоторые особенности частично автономных баз данных, например хранение метаданных в самой базе данных, относятся ко всем базам данных [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9497b-110">Some features of partially contained databases, such as storing metadata in the database, apply to all [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] databases.</span></span> <span data-ttu-id="9497b-111">Некоторые преимущества частично автономных баз данных, например проверка подлинности на уровне базы данных или сортировка каталогов, необходимо включить, чтобы воспользоваться ими.</span><span class="sxs-lookup"><span data-stu-id="9497b-111">Some benefits of partially contained databases, such as database level authentication and catalog collation, must be enabled before they are available.</span></span> <span data-ttu-id="9497b-112">Частичная автономность включается с помощью инструкций `CREATE DATABASE` и `ALTER DATABASE` или из среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9497b-112">Partial containment is enabled using the `CREATE DATABASE` and `ALTER DATABASE` statements or by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="9497b-113">Дополнительные сведения о включении частичной автономности базы данных см. в разделе [Migrate to a Partially Contained Database](migrate-to-a-partially-contained-database.md).</span><span class="sxs-lookup"><span data-stu-id="9497b-113">For more information about how to enable partial database containment, see [Migrate to a Partially Contained Database](migrate-to-a-partially-contained-database.md).</span></span>  
  
 <span data-ttu-id="9497b-114">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="9497b-114">This topic contains the following sections.</span></span>  
  
-   [<span data-ttu-id="9497b-115">Основные понятия частично автономных баз данных</span><span class="sxs-lookup"><span data-stu-id="9497b-115">Partially Contained Database Concepts</span></span>](#Concepts)  
  
-   [<span data-ttu-id="9497b-116">Вложения</span><span class="sxs-lookup"><span data-stu-id="9497b-116">Containment</span></span>](#containment)  
  
-   [<span data-ttu-id="9497b-117">Преимущества использования частично автономных баз данных</span><span class="sxs-lookup"><span data-stu-id="9497b-117">Benefits of using Partially Contained Databases</span></span>](#benefits)  
  
-   [<span data-ttu-id="9497b-118">Ограничения</span><span class="sxs-lookup"><span data-stu-id="9497b-118">Limitations</span></span>](#Limitations)  
  
-   [<span data-ttu-id="9497b-119">Определение включения базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-119">Identifying Database Containment</span></span>](#Identifying)  
  
##  <a name="partially-contained-database-concepts"></a><a name="Concepts"></a> <span data-ttu-id="9497b-120">Основные понятия частично автономных баз данных</span><span class="sxs-lookup"><span data-stu-id="9497b-120">Partially Contained Database Concepts</span></span>  
 <span data-ttu-id="9497b-121">Полностью автономная база данных содержит все параметры и метаданные, необходимые для определения базы данных, а ее конфигурация не зависит от экземпляра компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] , на котором устанавливается база данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-121">A fully contained database includes all the settings and metadata required to define the database and has no configuration dependencies on the instance of the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] where the database is installed.</span></span> <span data-ttu-id="9497b-122">В предыдущих версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]отделение базы данных от экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] было трудоемким и требовало детальных знаний о взаимосвязи между базой данных и экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9497b-122">In previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], separating a database from the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] could be time consuming and required detailed knowledge of the relationship between the database and the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9497b-123">Частично автономные базы данных упрощают отделение базы данных от экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и других баз данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-123">Partially contained databases make it easier to separate a database from the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and other databases.</span></span>  
  
 <span data-ttu-id="9497b-124">В автономной базе данных функции предоставляются с учетом автономности.</span><span class="sxs-lookup"><span data-stu-id="9497b-124">The contained database considers features with regard to containment.</span></span> <span data-ttu-id="9497b-125">Любая определяемая пользователем сущность, использующая только расположенные в базе данных функции, считается полностью автономной.</span><span class="sxs-lookup"><span data-stu-id="9497b-125">Any user-defined entity that relies only on functions that reside in the database is considered fully contained.</span></span> <span data-ttu-id="9497b-126">Любая определяемая пользователем сущность, использующая расположенные вне базы данных функции, считается неавтономной.</span><span class="sxs-lookup"><span data-stu-id="9497b-126">Any user-defined entity that relies on functions that reside outside the database is considered uncontained.</span></span> <span data-ttu-id="9497b-127">(Дополнительные сведения см. в подразделе [Автономность](#containment) далее в этом разделе.)</span><span class="sxs-lookup"><span data-stu-id="9497b-127">(For more information, see the [Containment](#containment) section later in this topic.)</span></span>  
  
 <span data-ttu-id="9497b-128">В модели автономной базы данных применяются следующие термины.</span><span class="sxs-lookup"><span data-stu-id="9497b-128">The following terms apply to the contained database model.</span></span>  
  
 <span data-ttu-id="9497b-129">Граница базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-129">Database boundary</span></span>  
 <span data-ttu-id="9497b-130">Граница между базой данных и экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9497b-130">The boundary between a database and the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9497b-131">Граница между базой данных и другими базами данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-131">The boundary between a database and other databases.</span></span>  
  
 <span data-ttu-id="9497b-132">Автономная</span><span class="sxs-lookup"><span data-stu-id="9497b-132">Contained</span></span>  
 <span data-ttu-id="9497b-133">Элемент, существующий полностью в пределах базы данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-133">An element that exists entirely in the database boundary.</span></span>  
  
 <span data-ttu-id="9497b-134">Неавтономная</span><span class="sxs-lookup"><span data-stu-id="9497b-134">Uncontained</span></span>  
 <span data-ttu-id="9497b-135">Элемент, пересекающий границы базы данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-135">An element that crosses the database boundary.</span></span>  
  
 <span data-ttu-id="9497b-136">Неавтономная база данных</span><span class="sxs-lookup"><span data-stu-id="9497b-136">Non-contained database</span></span>  
 <span data-ttu-id="9497b-137">База данных, параметр автономности которой имеет значение **NONE**.</span><span class="sxs-lookup"><span data-stu-id="9497b-137">A database that has containment set to **NONE**.</span></span> <span data-ttu-id="9497b-138">Все базы данных, имеющие версии, предшествующие [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] , являются неавтономными.</span><span class="sxs-lookup"><span data-stu-id="9497b-138">All databases in versions earlier than [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] are non-contained.</span></span> <span data-ttu-id="9497b-139">По умолчанию у всех баз данных в [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] и более поздних версий параметр автономности установлен в значение **NONE**.</span><span class="sxs-lookup"><span data-stu-id="9497b-139">By default, all [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] and later databases have a containment set to **NONE**.</span></span>  
  
 <span data-ttu-id="9497b-140">Частично автономная база данных</span><span class="sxs-lookup"><span data-stu-id="9497b-140">Partially contained database</span></span>  
 <span data-ttu-id="9497b-141">Частично автономной базой данных является автономная база данных, в которой допускается пересечение границы базы данных определенными функциями.</span><span class="sxs-lookup"><span data-stu-id="9497b-141">A partially contained database is a contained database that can allow some features that cross the database boundary.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="9497b-142">доступна возможность определения пересечения границы включения.</span><span class="sxs-lookup"><span data-stu-id="9497b-142">includes the ability to determine when the containment boundary is crossed.</span></span>  
  
 <span data-ttu-id="9497b-143">Автономный пользователь</span><span class="sxs-lookup"><span data-stu-id="9497b-143">Contained user</span></span>  
 <span data-ttu-id="9497b-144">Для автономных баз данных имеется два типа пользователей.</span><span class="sxs-lookup"><span data-stu-id="9497b-144">There are two types of users for contained databases.</span></span>  
  
-   <span data-ttu-id="9497b-145">**Пользователь автономной базы данных с паролем**</span><span class="sxs-lookup"><span data-stu-id="9497b-145">**Contained database user with password**</span></span>  
  
     <span data-ttu-id="9497b-146">Проверку подлинности пользователей автономной базы данных с паролями выполняет база данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-146">Contained database users with passwords are authenticated by the database.</span></span>  
  
-   <span data-ttu-id="9497b-147">**Участники Windows**</span><span class="sxs-lookup"><span data-stu-id="9497b-147">**Windows principals**</span></span>  
  
     <span data-ttu-id="9497b-148">Авторизованные пользователи Windows и члены авторизованных групп Windows могут подключаться непосредственно к базе данных, для них не требуется имя входа в базе данных **master** .</span><span class="sxs-lookup"><span data-stu-id="9497b-148">Authorized Windows users and members of authorized Windows groups can connect directly to the database and do not need logins in the **master** database.</span></span> <span data-ttu-id="9497b-149">База данных возлагает проверку подлинности на Windows.</span><span class="sxs-lookup"><span data-stu-id="9497b-149">The database trusts the authentication by Windows.</span></span>  
  
 <span data-ttu-id="9497b-150">Пользователям, использующим имена входа базы данных **master** , можно предоставить доступ к автономной базе данных, но это приведет к зависимости от экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9497b-150">Users based on logins in the **master** database can be granted access to a contained database, but that would create a dependency on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="9497b-151">Поэтому при создании пользователей на основе имен входа см. примечание для частично автономных баз данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-151">Therefore, creating users based on logins see comment for partially contained databases.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9497b-152">Включение частично автономных баз данных передает управление над доступом к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] владельцам базы данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-152">Enabling partially contained databases delegates control over access to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the owners of the database.</span></span> <span data-ttu-id="9497b-153">Дополнительные сведения см. в разделе [Security Best Practices with Contained Databases](security-best-practices-with-contained-databases.md).</span><span class="sxs-lookup"><span data-stu-id="9497b-153">For more information, see [Security Best Practices with Contained Databases](security-best-practices-with-contained-databases.md).</span></span>  
  
 <span data-ttu-id="9497b-154">Граница базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-154">Database Boundary</span></span>  
 <span data-ttu-id="9497b-155">Поскольку частично автономные базы данных отделяют функции базы данных от функций экземпляра, между этими элементами имеется явно определенная разграничительная линия, называемая *границей базы данных*.</span><span class="sxs-lookup"><span data-stu-id="9497b-155">Because partially contained databases separate the database functionality from those of the instance, there is a clearly defined line between these two elements called the *database boundary*.</span></span>  
  
 <span data-ttu-id="9497b-156">Внутри границы базы данных находится *модель базы данных*, в которой выполняется разработка баз данных и управление этими базами данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-156">Inside of the database boundary is the *database model*, where the databases are developed and managed.</span></span> <span data-ttu-id="9497b-157">Примерами сущностей, находящихся внутри модели базы данных, служат такие системные таблицы, как **sys.table**, пользователи автономной базы данных с паролями, а также пользовательские таблицы в текущей базе данных, ссылаемые по двухкомпонентному имени.</span><span class="sxs-lookup"><span data-stu-id="9497b-157">Examples of entities located inside of the database include, system tables like **sys.tables**, contained database users with passwords, and user tables in the current database referenced by a two-part name.</span></span>  
  
 <span data-ttu-id="9497b-158">Вне границы базы данных находится *модель управления*, хранящая функции и задачи управления на уровне экземпляра.</span><span class="sxs-lookup"><span data-stu-id="9497b-158">Outside of the database boundary is the *management model*, which pertains to instance-level functions and management.</span></span> <span data-ttu-id="9497b-159">Примерами сущностей, находящихся за границами базы данных, служат такие системные таблицы, как **sys.endpoints**, пользователи, сопоставленные с именами входа, а также пользовательские таблицы в другой базе данных, ссылаемые по трехкомпонентному имени.</span><span class="sxs-lookup"><span data-stu-id="9497b-159">Examples of entities located outside of the database boundary include, system tables like **sys.endpoints**, users mapped to logins, and user tables in another database referenced by a three-part-name.</span></span>  
  
##  <a name="containment"></a><a name="containment"></a> <span data-ttu-id="9497b-160">Автономность</span><span class="sxs-lookup"><span data-stu-id="9497b-160">Containment</span></span>  
 <span data-ttu-id="9497b-161">Пользовательские сущности, целиком расположенные в базе данных, считаются *автономными*.</span><span class="sxs-lookup"><span data-stu-id="9497b-161">User entities that reside entirely within the database are considered *contained*.</span></span> <span data-ttu-id="9497b-162">Любые пользовательские сущности, находящиеся вне базы данных или взаимодействующие с функциями вне базы данных, считаются *неавтономными*.</span><span class="sxs-lookup"><span data-stu-id="9497b-162">Any entities that reside outside of the database, or rely on interaction with functions outside of the database, are considered *uncontained*.</span></span>  
  
 <span data-ttu-id="9497b-163">Обычно пользовательские сущности подпадают в следующие категории включения.</span><span class="sxs-lookup"><span data-stu-id="9497b-163">In general, user entities fall into the following categories of containment:</span></span>  
  
-   <span data-ttu-id="9497b-164">Полностью автономные пользовательские сущности (которые никогда не пересекают границу базы данных), например sys.indexes.</span><span class="sxs-lookup"><span data-stu-id="9497b-164">Fully contained user entities (those that never cross the database boundary), for example sys.indexes.</span></span> <span data-ttu-id="9497b-165">Код, использующий эти функции или любые объекты, ссылающиеся только на эти сущности, является полностью автономным.</span><span class="sxs-lookup"><span data-stu-id="9497b-165">Any code that uses these features or any object that references only these entities is also fully contained.</span></span>  
  
-   <span data-ttu-id="9497b-166">Неавтономные пользовательские сущности (которые пересекают границу базы данных), например sys.server_principals или сам участник на уровне сервера (имя входа).</span><span class="sxs-lookup"><span data-stu-id="9497b-166">Uncontained user entities (those that cross the database boundary), for example sys.server_principals or a server principal (login) itself.</span></span> <span data-ttu-id="9497b-167">Код, использующий эти сущности или любые функции, ссылающиеся на эти сущности, является неавтономным.</span><span class="sxs-lookup"><span data-stu-id="9497b-167">Any code that uses these entities or any functions that references these entities are uncontained.</span></span>  
  
###  <a name="partially-contained-database"></a><a name="partial"></a> <span data-ttu-id="9497b-168">Partially Contained Database</span><span class="sxs-lookup"><span data-stu-id="9497b-168">Partially Contained Database</span></span>  
 <span data-ttu-id="9497b-169">Автономная база данных в настоящее время доступна только в частично автономном состоянии.</span><span class="sxs-lookup"><span data-stu-id="9497b-169">The contained database feature is currently available only in a partially contained state.</span></span> <span data-ttu-id="9497b-170">Частично автономной базой данных является автономная база данных, которая разрешает использование неавтономных функций.</span><span class="sxs-lookup"><span data-stu-id="9497b-170">A partially contained database is a contained database that allows the use of uncontained features.</span></span>  
  
 <span data-ttu-id="9497b-171">Чтобы получить сведения о неавтономных объектах и функциях, используйте представления [sys.dm_db_uncontained_entities](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-uncontained-entities-transact-sql) и [sys.sql_modules (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-sql-modules-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9497b-171">Use the [sys.dm_db_uncontained_entities](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-uncontained-entities-transact-sql) and [sys.sql_modules &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-sql-modules-transact-sql) view to return information about uncontained objects or features.</span></span> <span data-ttu-id="9497b-172">Определив состояние автономности элементов базы данных, вы можете узнать, какие объекты и функции необходимо заменить или изменить для обеспечения автономности.</span><span class="sxs-lookup"><span data-stu-id="9497b-172">By determining the containment status of the elements of your database, you can discover what objects or features must be replaced or altered to promote containment.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9497b-173">Поскольку некоторые объекты по умолчанию имеют параметр автономности **NONE**, это представление может возвращать ложные положительные результаты.</span><span class="sxs-lookup"><span data-stu-id="9497b-173">Because certain objects have a default containment setting of **NONE**, this view can return false positives.</span></span>  
  
 <span data-ttu-id="9497b-174">Поведение частично автономных баз данных резко отличается от поведения неавтономных баз данных в отношении параметров сортировки.</span><span class="sxs-lookup"><span data-stu-id="9497b-174">The behavior of partially contained databases differs most distinctly from that of non-contained databases with regard to collation.</span></span> <span data-ttu-id="9497b-175">Дополнительные сведения о проблемах, связанных с параметрами сортировки, см. в разделе [Contained Database Collations](contained-database-collations.md).</span><span class="sxs-lookup"><span data-stu-id="9497b-175">For more information about collation issues, see [Contained Database Collations](contained-database-collations.md).</span></span>  
  
##  <a name="benefits-of-using-partially-contained-databases"></a><a name="benefits"></a> <span data-ttu-id="9497b-176">Преимущества использования частично автономных баз данных</span><span class="sxs-lookup"><span data-stu-id="9497b-176">Benefits of using Partially Contained Databases</span></span>  
 <span data-ttu-id="9497b-177">Существуют связанные с неавтономными базами данных проблемы и трудности, которые можно разрешить путем использования частично автономной базы данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-177">There are issues and complications associated with the non-contained databases that can be resolved by using a partially contained database.</span></span>  
  
### <a name="database-movement"></a><span data-ttu-id="9497b-178">Перемещение базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-178">Database Movement</span></span>  
 <span data-ttu-id="9497b-179">Одна из проблем, возникающих при перемещении баз данных, заключается в том, что часть важной информации может быть недоступна при перемещении базы данных с одного экземпляра на другой.</span><span class="sxs-lookup"><span data-stu-id="9497b-179">One of the problems that occurs when moving databases, is that some important information can be unavailable when a database is moved from one instance to another.</span></span> <span data-ttu-id="9497b-180">Например, информация об именах входа хранится на экземпляре, а не в базе данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-180">For example, login information is stored within the instance instead of in the database.</span></span> <span data-ttu-id="9497b-181">При перемещении неавтономной базы данных с одного экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]на другой эта информация остается на первом экземпляре.</span><span class="sxs-lookup"><span data-stu-id="9497b-181">When you move a non-contained database from one instance to another instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], this information is left behind.</span></span> <span data-ttu-id="9497b-182">Необходимо определить, какая информация отсутствует, и перенести ее вместе с базой данных на новый экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9497b-182">You must identify the missing information and move it with your database to the new instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9497b-183">Этот процесс может быть сложным и занимать много времени.</span><span class="sxs-lookup"><span data-stu-id="9497b-183">This process can be difficult and time-consuming.</span></span>  
  
 <span data-ttu-id="9497b-184">В частично автономных базах данных важная информация может храниться в базе данных, в результате чего она останется в базе данных и после ее переноса.</span><span class="sxs-lookup"><span data-stu-id="9497b-184">The partially contained database can store important information in the database so the database still has the information after it is moved.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9497b-185">Частично автономный экземпляр базы данных может содержать документацию по используемым базой данных компонентам, которые нельзя отделить от экземпляра.</span><span class="sxs-lookup"><span data-stu-id="9497b-185">A partially contained database can provide documentation describing those features that are used by a database that cannot be separated from the instance.</span></span> <span data-ttu-id="9497b-186">Они включают список других взаимосвязанных баз данных, настройки системы, которые необходимы базе данных, но не могут быть автономными, и т. д.</span><span class="sxs-lookup"><span data-stu-id="9497b-186">This includes a list of other interrelated databases, system settings that the database requires but cannot be contained, and so on.</span></span>  
  
### <a name="benefit-of-contained-database-users-with-alwayson"></a><span data-ttu-id="9497b-187">Преимущества использования пользователей автономной базы данных в решениях AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="9497b-187">Benefit of Contained Database Users with AlwaysOn</span></span>  
 <span data-ttu-id="9497b-188">Уменьшая привязку к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], частично автономные базы данных могут быть полезны при отработке отказа, если используется [!INCLUDE[ssHADR](../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9497b-188">By reducing the ties to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], partially contained databases can be useful during failover when you use [!INCLUDE[ssHADR](../../includes/sshadr-md.md)].</span></span>  
  
 <span data-ttu-id="9497b-189">Создание автономных пользователей позволяет им напрямую подключаться к автономной базе данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-189">Creating contained users enables the user to connect directly to the contained database.</span></span> <span data-ttu-id="9497b-190">Это крайне важная функция в сценариях высокого уровня доступности и восстановления после аварии, например при использовании решения AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="9497b-190">This is a very significant feature in high availability and disaster recovery scenarios such as in an AlwaysOn solution.</span></span> <span data-ttu-id="9497b-191">Если пользователи являются автономными, то в случае отработки отказа они смогут подключиться к базе данных-получателю без создания имен входа на экземпляре, на котором она размещена.</span><span class="sxs-lookup"><span data-stu-id="9497b-191">If the users are contained users, in case of failover, people would be able to connect to the secondary without creating logins on the instance hosting the secondary.</span></span> <span data-ttu-id="9497b-192">Выгода обеспечивается немедленно.</span><span class="sxs-lookup"><span data-stu-id="9497b-192">This provides an immediate benefit.</span></span> <span data-ttu-id="9497b-193">Дополнительные сведения см. в разделе [Обзор групп доступности AlwaysOn (SQL Server)](../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md) и [Предварительные требования, ограничения и рекомендации для групп доступности AlwaysOn (SQL Server)](../../database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="9497b-193">For more information, see [Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md) and [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
### <a name="initial-database-development"></a><span data-ttu-id="9497b-194">Первоначальная разработка баз данных</span><span class="sxs-lookup"><span data-stu-id="9497b-194">Initial Database Development</span></span>  
 <span data-ttu-id="9497b-195">Поскольку разработчик может не знать, где будет развернута новая база данных, ограничение влияния разворачиваемой среды на базу данных уменьшает трудозатраты и сложности для разработчика.</span><span class="sxs-lookup"><span data-stu-id="9497b-195">Because a developer may not know where a new database will be deployed, limiting the deployed environmental impacts on the database lessens the work and concern for the developer.</span></span> <span data-ttu-id="9497b-196">В неавтономной модели разработчик должен учитывать возможное влияние среды на новую базу данных и программировать в соответствии с ним.</span><span class="sxs-lookup"><span data-stu-id="9497b-196">In the non-contained model, the developer must consider possible environmental impacts on the new database and program accordingly.</span></span> <span data-ttu-id="9497b-197">Однако при использовании частично автономных баз данных разработчики могут столкнуться с факторами, влияющими на базу данных на уровне экземпляра и связанными с этим проблемами.</span><span class="sxs-lookup"><span data-stu-id="9497b-197">However, by using partially contained databases, developers can detect instance-level impacts on the database and instance-level concerns for the developer.</span></span>  
  
### <a name="database-administration"></a><span data-ttu-id="9497b-198">Администрирование базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-198">Database Administration</span></span>  
 <span data-ttu-id="9497b-199">Поддержка параметров базы данных в самой базе данных, а не в базе данных master, позволяет каждому владельцу базы данных лучше управлять собственными базами данных, при этом владельцам не требуется предоставлять разрешение **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="9497b-199">Maintaining database settings in the database, instead of in the master database, lets each database owner have more control over their database, without giving the database owner **sysadmin** permission.</span></span>  
  
##  <a name="limitations"></a><a name="Limitations"></a> <span data-ttu-id="9497b-200">Ограничения</span><span class="sxs-lookup"><span data-stu-id="9497b-200">Limitations</span></span>  
 <span data-ttu-id="9497b-201">В частично автономных базах данных не допускаются следующие функции.</span><span class="sxs-lookup"><span data-stu-id="9497b-201">Partially contained databases do not allow the following features.</span></span>  
  
-   <span data-ttu-id="9497b-202">Частично автономные базы данных не могут использовать репликацию, систему отслеживания измененных данных или отслеживание изменений.</span><span class="sxs-lookup"><span data-stu-id="9497b-202">Partially contained databases cannot use replication, change data capture, or change tracking.</span></span>  
  
-   <span data-ttu-id="9497b-203">Нумерованные процедуры</span><span class="sxs-lookup"><span data-stu-id="9497b-203">Numbered procedures</span></span>  
  
-   <span data-ttu-id="9497b-204">Привязанные к схеме объекты, которые зависят от встроенных функций с изменениями параметров сортировки</span><span class="sxs-lookup"><span data-stu-id="9497b-204">Schema-bound objects that depend on built-in functions with collation changes</span></span>  
  
-   <span data-ttu-id="9497b-205">Изменение привязки в результате изменений параметров сортировки, включая ссылки на объекты, столбцы, символы или типы.</span><span class="sxs-lookup"><span data-stu-id="9497b-205">Binding change resulting from collation changes, including references to objects, columns, symbols, or types.</span></span>  
  
-   <span data-ttu-id="9497b-206">Репликация, система отслеживания измененных данных и отслеживание изменений.</span><span class="sxs-lookup"><span data-stu-id="9497b-206">Replication, change data capture, and change tracking.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="9497b-207">В данный момент разрешено использование временных хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="9497b-207">Temporary stored procedures are currently permitted.</span></span> <span data-ttu-id="9497b-208">Так как временные хранимые процедуры нарушают изоляцию, в будущих версиях автономной базы данных их поддержки не будет.</span><span class="sxs-lookup"><span data-stu-id="9497b-208">Because temporary stored procedures breach containment, they are not expected to be supported in future versions of contained database.</span></span>  
  
##  <a name="identifying-database-containment"></a><a name="Identifying"></a> <span data-ttu-id="9497b-209">Определение состояния включения базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-209">Identifying Database Containment</span></span>  
 <span data-ttu-id="9497b-210">Для определения состояния автономности базы данных можно использовать два средства.</span><span class="sxs-lookup"><span data-stu-id="9497b-210">There are two tools to help identify the containment status of the database.</span></span> <span data-ttu-id="9497b-211">Представление [sys.dm_db_uncontained_entities (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-uncontained-entities-transact-sql) показывает все потенциально неавтономные сущности в базе данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-211">The [sys.dm_db_uncontained_entities &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-uncontained-entities-transact-sql) is a view that shows all the potentially uncontained entities in the database.</span></span> <span data-ttu-id="9497b-212">Событие database_uncontained_usage происходит, если во время выполнения найдена любая фактическая неавтономная сущность.</span><span class="sxs-lookup"><span data-stu-id="9497b-212">The database_uncontained_usage event occurs when any actual uncontained entity is identified at run time.</span></span>  
  
### <a name="sysdm_db_uncontained_entities"></a><span data-ttu-id="9497b-213">sys.dm_db_uncontained_entities</span><span class="sxs-lookup"><span data-stu-id="9497b-213">sys.dm_db_uncontained_entities</span></span>  
 <span data-ttu-id="9497b-214">Это представление содержит все сущности базы данных, которые потенциально могут быть неавтономными, например пересекающие границу базы данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-214">This view shows any entities in the database that have the potential to be uncontained, such as those that cross-the database boundary.</span></span> <span data-ttu-id="9497b-215">К ним относятся пользовательские сущности, которые могут использовать объекты вне модели базы данных.</span><span class="sxs-lookup"><span data-stu-id="9497b-215">This includes those user entities that may use objects outside the database model.</span></span> <span data-ttu-id="9497b-216">Однако, так как включение некоторых сущностей (например, использующих динамический SQL) невозможно определить до времени выполнения, в представлении могут отображаться некоторые сущности, которые фактически не являются неавтономными.</span><span class="sxs-lookup"><span data-stu-id="9497b-216">However, because the containment of some entities (for example, those using dynamic SQL) cannot be determined until run time, the view may show some entities that are not actually uncontained.</span></span> <span data-ttu-id="9497b-217">Дополнительные сведения см. в разделе [sys.dm_db_uncontained_entities (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-uncontained-entities-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9497b-217">For more information, see [sys.dm_db_uncontained_entities &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-uncontained-entities-transact-sql).</span></span>  
  
### <a name="database_uncontained_usage-event"></a><span data-ttu-id="9497b-218">событие database_uncontained_usage</span><span class="sxs-lookup"><span data-stu-id="9497b-218">database_uncontained_usage event</span></span>  
 <span data-ttu-id="9497b-219">Это событие XEvent возникает, когда во время выполнения обнаруживается любая фактически неавтономная сущность.</span><span class="sxs-lookup"><span data-stu-id="9497b-219">This XEvent occurs whenever an uncontained entity is identified at run time.</span></span> <span data-ttu-id="9497b-220">Учитываются и сущности, формируемые в клиентском коде.</span><span class="sxs-lookup"><span data-stu-id="9497b-220">This includes entities originated in client code.</span></span> <span data-ttu-id="9497b-221">Это событие XEvent возникает только для фактически неавтономных сущностей.</span><span class="sxs-lookup"><span data-stu-id="9497b-221">This XEvent will occur only for actual uncontained entities.</span></span> <span data-ttu-id="9497b-222">Однако это событие происходит только во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="9497b-222">However, the event only occurs at run time.</span></span> <span data-ttu-id="9497b-223">Поэтому любые неавтономные пользовательские сущности, которые не будут запущены, не обнаруживаются данным событием Xevent.</span><span class="sxs-lookup"><span data-stu-id="9497b-223">Therefore, any uncontained user entities you have not run will not be identified by this XEvent</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="9497b-224">См. также</span><span class="sxs-lookup"><span data-stu-id="9497b-224">Related Content</span></span>  
 [<span data-ttu-id="9497b-225">Измененные функции (автономная база данных)</span><span class="sxs-lookup"><span data-stu-id="9497b-225">Modified Features &#40;Contained Database&#41;</span></span>](modified-features-contained-database.md)  
  
 [<span data-ttu-id="9497b-226">Параметры сортировки автономной базы данных</span><span class="sxs-lookup"><span data-stu-id="9497b-226">Contained Database Collations</span></span>](contained-database-collations.md)  
  
 [<span data-ttu-id="9497b-227">Рекомендации по обеспечению безопасности автономных баз данных</span><span class="sxs-lookup"><span data-stu-id="9497b-227">Security Best Practices with Contained Databases</span></span>](security-best-practices-with-contained-databases.md)  
  
 [<span data-ttu-id="9497b-228">Переход на частично автономную базу данных</span><span class="sxs-lookup"><span data-stu-id="9497b-228">Migrate to a Partially Contained Database</span></span>](migrate-to-a-partially-contained-database.md)  
  
  
