---
title: Присоединение и отсоединение базы данных (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- upgrading databases
- databases [SQL Server], detaching
- detach database [SQL Server]
- databases [SQL Server], attaching
- removing databases
- transaction logs [SQL Server], detaching
- databases [SQL Server], removing
- restoring [SQL Server], attached databases
- transaction logs [SQL Server], attaching
- differential backups, after detaching
- moving databases
- attach database [SQL Server]
- detaching databases [SQL Server]
- differential base [SQL Server]
- attaching databases [SQL Server]
- databases [SQL Server], moving
ms.assetid: d0de0639-bc54-464e-98b1-6af22a27eb86
author: stevestein
ms.author: sstein
ms.openlocfilehash: 54eeeec995e390b71ce8871b680c26138fc88783
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87658830"
---
# <a name="database-detach-and-attach-sql-server"></a><span data-ttu-id="19f2a-102">Присоединение и отсоединение базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="19f2a-102">Database Detach and Attach (SQL Server)</span></span>
  <span data-ttu-id="19f2a-103">Файлы данных и журналов транзакций базы данных можно отсоединить, а затем снова присоединить к тому же или другому экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="19f2a-103">The data and transaction log files of a database can be detached and then reattached to the same or another instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="19f2a-104">Отсоединение и присоединение базы данных полезно, если необходимо переместить базу данных на другой экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на том же компьютере либо перенести базу данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-104">Detaching and attaching a database is useful if you want to change the database to a different instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on the same computer or to move the database.</span></span>  
  
 <span data-ttu-id="19f2a-105">Формат хранения данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на диске в 64-разрядной и 32-разрядной средах одинаков.</span><span class="sxs-lookup"><span data-stu-id="19f2a-105">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on-disk storage format is the same in the 64-bit and 32-bit environments.</span></span> <span data-ttu-id="19f2a-106">Следовательно, присоединение работает и в 32-разрядной, и в 64-разрядной средах.</span><span class="sxs-lookup"><span data-stu-id="19f2a-106">Therefore, attach works across 32-bit and 64-bit environments.</span></span>  <span data-ttu-id="19f2a-107">База данных, отсоединенная от экземпляра сервера, работающего в одной среде, может быть присоединена к экземпляру сервера, работающему в другой среде.</span><span class="sxs-lookup"><span data-stu-id="19f2a-107">A database detached from a server instance running in one environment can be attached on a server instance that runs in another environment.</span></span>  
  
  
  
##  <a name="security"></a><a name="Security"></a> <span data-ttu-id="19f2a-108">безопасность</span><span class="sxs-lookup"><span data-stu-id="19f2a-108">Security</span></span>  
 <span data-ttu-id="19f2a-109">Разрешения на доступ к файлам устанавливаются во время выполнения определенных операций с базами данных, включая отсоединение и присоединение баз данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-109">File access permissions are set during a number of database operations, including detaching or attaching a database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="19f2a-110">Не рекомендуется подключать или восстанавливать базы данных, полученные из неизвестных или ненадежных источников.</span><span class="sxs-lookup"><span data-stu-id="19f2a-110">We recommend that you do not attach or restore databases from unknown or untrusted sources.</span></span> <span data-ttu-id="19f2a-111">В этих базах данных может содержаться вредоносный код, вызывающий выполнение непредусмотренных инструкций [!INCLUDE[tsql](../../includes/tsql-md.md)] или появление ошибок из-за изменения схемы или физической структуры базы данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-111">Such databases could contain malicious code that might execute unintended [!INCLUDE[tsql](../../includes/tsql-md.md)] code or cause errors by modifying the schema or the physical database structure.</span></span> <span data-ttu-id="19f2a-112">Перед тем как использовать базу данных, полученную из неизвестного или ненадежного источника, выполните на тестовом сервере инструкцию [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) для этой базы данных, а также изучите исходный код в базе данных, например хранимые процедуры и другой пользовательский код.</span><span class="sxs-lookup"><span data-stu-id="19f2a-112">Before you use a database from an unknown or untrusted source, run [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) on the database on a nonproduction server and also examine the code, such as stored procedures or other user-defined code, in the database.</span></span>  
  
##  <a name="detaching-a-database"></a><a name="DetachDb"></a> <span data-ttu-id="19f2a-113">Отсоединение базы данных</span><span class="sxs-lookup"><span data-stu-id="19f2a-113">Detaching a Database</span></span>  
 <span data-ttu-id="19f2a-114">Отсоединение базы данных означает удаление ее с экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , но сама база данных остается неповрежденной со всеми своими файлами данных и журналов транзакций.</span><span class="sxs-lookup"><span data-stu-id="19f2a-114">Detaching a database removes it from the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] but leaves the database intact within its data files and transaction log files.</span></span> <span data-ttu-id="19f2a-115">Эти файлы затем можно использовать для присоединения базы данных к любому экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], включая сервер, от которого она была отсоединена.</span><span class="sxs-lookup"><span data-stu-id="19f2a-115">These files can then be used to attach the database to any instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], including the server from which the database was detached.</span></span>  
  
 <span data-ttu-id="19f2a-116">Базу данных невозможно отсоединить в следующих случаях.</span><span class="sxs-lookup"><span data-stu-id="19f2a-116">You cannot detach a database if any of the following are true:</span></span>  
  
-   <span data-ttu-id="19f2a-117">База данных реплицируется и публикуется.</span><span class="sxs-lookup"><span data-stu-id="19f2a-117">The database is replicated and published.</span></span> <span data-ttu-id="19f2a-118">При репликации база данных должна быть снята с публикации.</span><span class="sxs-lookup"><span data-stu-id="19f2a-118">If replicated, the database must be unpublished.</span></span> <span data-ttu-id="19f2a-119">Перед тем как отсоединить базу данных, необходимо отключить публикацию, выполнив процедуру [sp_replicationdboption](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="19f2a-119">Before you can detach it, you must disable publishing by running [sp_replicationdboption](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="19f2a-120">Если невозможно использовать процедуру **sp_replicationdboption**, можно удалить репликацию, выполнив процедуру [sp_removedbreplication](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="19f2a-120">If you cannot use **sp_replicationdboption**, you can remove replication by running [sp_removedbreplication](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
-   <span data-ttu-id="19f2a-121">Имеется моментальный снимок базы данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-121">A database snapshot exists on the database.</span></span>  
  
     <span data-ttu-id="19f2a-122">Перед отсоединением базы данных необходимо удалить все моментальные снимки.</span><span class="sxs-lookup"><span data-stu-id="19f2a-122">Before you can detach the database, you must drop all of its snapshots.</span></span> <span data-ttu-id="19f2a-123">Дополнительные сведения см. в разделе [Удаление моментального снимка базы данных (Transact-SQL)](drop-a-database-snapshot-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="19f2a-123">For more information, see [Drop a Database Snapshot &#40;Transact-SQL&#41;](drop-a-database-snapshot-transact-sql.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="19f2a-124">Невозможно отсоединить или присоединить моментальный снимок базы данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-124">A database snapshot cannot be detached or attached.</span></span>  
  
-   <span data-ttu-id="19f2a-125">База данных находится в сеансе зеркального копирования.</span><span class="sxs-lookup"><span data-stu-id="19f2a-125">The database is being mirrored in a database mirroring session.</span></span>  
  
     <span data-ttu-id="19f2a-126">Отключить базу данных невозможно, пока этот сеанс не завершится.</span><span class="sxs-lookup"><span data-stu-id="19f2a-126">The database cannot be detached unless the session is terminated.</span></span> <span data-ttu-id="19f2a-127">Дополнительные сведения см. в разделе [Удаление зеркального отображения базы данных (SQL Server)](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="19f2a-127">For more information, see [Removing Database Mirroring &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span></span>  
  
-   <span data-ttu-id="19f2a-128">База данных помечена как подозрительная.</span><span class="sxs-lookup"><span data-stu-id="19f2a-128">The database is suspect.</span></span> <span data-ttu-id="19f2a-129">Подозрительную базу данных невозможно отсоединить. Для отсоединения ее необходимо перевести в аварийный режим.</span><span class="sxs-lookup"><span data-stu-id="19f2a-129">A suspect database cannot be detached; before you can detach it, you must put it into emergency mode.</span></span> <span data-ttu-id="19f2a-130">Дополнительные сведения о переводе базы данных в аварийный режим см. в разделе [ALTER DATABASE (Transact-SQL)](/sql/t-sql/statements/alter-database-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="19f2a-130">For more information about how to put a database into emergency mode, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
-   <span data-ttu-id="19f2a-131">База данных является системной базой данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-131">The database is a system database.</span></span>  
  
### <a name="backup-and-restore-and-detach"></a><span data-ttu-id="19f2a-132">Резервное копирование, восстановление и отсоединение</span><span class="sxs-lookup"><span data-stu-id="19f2a-132">Backup and Restore and Detach</span></span>  
 <span data-ttu-id="19f2a-133">Для разностных резервных копий отсоединение базы данных, доступной только для чтения, приводит к потере сведений о базовой копии для разностного копирования.</span><span class="sxs-lookup"><span data-stu-id="19f2a-133">Detaching a read-only database loses information about the differential bases of differential backups.</span></span> <span data-ttu-id="19f2a-134">Дополнительные сведения см. в разделе [Разностные резервные копии (SQL Server)](../backup-restore/differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="19f2a-134">For more information, see [Differential Backups &#40;SQL Server&#41;](../backup-restore/differential-backups-sql-server.md).</span></span>  
  
### <a name="responding-to-detach-errors"></a><span data-ttu-id="19f2a-135">Реакция на ошибки отсоединения</span><span class="sxs-lookup"><span data-stu-id="19f2a-135">Responding to Detach Errors</span></span>  
 <span data-ttu-id="19f2a-136">Ошибки, возникшие во время отсоединения базы данных, могут воспрепятствовать чистому закрытию базы данных и перестроению журнала транзакций.</span><span class="sxs-lookup"><span data-stu-id="19f2a-136">Errors produced while detaching a database can prevent the database from closing cleanly and the transaction log from being rebuilt.</span></span> <span data-ttu-id="19f2a-137">При получении сообщения об ошибке выполните следующие действие по исправлению.</span><span class="sxs-lookup"><span data-stu-id="19f2a-137">If you receive an error message, perform the following corrective actions:</span></span>  
  
1.  <span data-ttu-id="19f2a-138">Заново присоедините все файлы, связанные с базой данных, а не только первичный файл.</span><span class="sxs-lookup"><span data-stu-id="19f2a-138">Reattach all files associated with the database, not just the primary file.</span></span>  
  
2.  <span data-ttu-id="19f2a-139">Исправьте неполадку, ставшую причиной сообщения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="19f2a-139">Resolve the problem that caused the error message.</span></span>  
  
3.  <span data-ttu-id="19f2a-140">Отсоедините базу данных повторно.</span><span class="sxs-lookup"><span data-stu-id="19f2a-140">Detach the database again.</span></span>  
  
##  <a name="attaching-a-database"></a><a name="AttachDb"></a> <span data-ttu-id="19f2a-141">Присоединение базы данных</span><span class="sxs-lookup"><span data-stu-id="19f2a-141">Attaching a Database</span></span>  
 <span data-ttu-id="19f2a-142">Можно присоединить скопированную или отсоединенную базу данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="19f2a-142">You can attach a copied or detached [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="19f2a-143">При присоединении [!INCLUDE[ssVersion2005](../../includes/sscurrent-md.md)] экземпляра сервера файлы каталога присоединяются к их предыдущему расположению вместе с другими файлами базы данных, то же, что и в [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="19f2a-143">When you attach a [!INCLUDE[ssVersion2005](../../includes/sscurrent-md.md)] server instance, the catalog files are attached from their previous location along with the other database files, the same as in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="19f2a-144">Дополнительные сведения см. в разделе [Обновление полнотекстового поиска](../search/upgrade-full-text-search.md).</span><span class="sxs-lookup"><span data-stu-id="19f2a-144">For more information, see [Upgrade Full-Text Search](../search/upgrade-full-text-search.md).</span></span>  
  
 <span data-ttu-id="19f2a-145">При присоединении базы данных должны быть доступны все файлы данных (файлы MDF и NDF).</span><span class="sxs-lookup"><span data-stu-id="19f2a-145">When you attach a database, all data files (MDF and NDF files) must be available.</span></span> <span data-ttu-id="19f2a-146">Если у какого-либо файла данных путь отличается от того, каким он был при первом создании или последнем присоединении, необходимо указать текущий путь к файлу.</span><span class="sxs-lookup"><span data-stu-id="19f2a-146">If any data file has a different path from when the database was first created or last attached, you must specify the current path of the file.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="19f2a-147">Если присоединяемый первичный файл данных доступен только для чтения, компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] предполагает, что и база данных доступна только для чтения.</span><span class="sxs-lookup"><span data-stu-id="19f2a-147">If the primary data file being attached is read-only, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] assumes that the database is read-only.</span></span>  
  
 <span data-ttu-id="19f2a-148">Когда зашифрованная база данных впервые [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] подключается к экземпляру, владелец базы данных должен открыть главный ключ базы данных, выполнив следующую инструкцию: открыть расшифровку главного ключа по паролю = **" *`password`* "**.</span><span class="sxs-lookup"><span data-stu-id="19f2a-148">When an encrypted database is first attached to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the database owner must open the master key of the database by executing the following statement: OPEN MASTER KEY DECRYPTION BY PASSWORD = **'*`password`*'**.</span></span> <span data-ttu-id="19f2a-149">Рекомендуется включить автоматическую расшифровку главного ключа, выполнив следующую инструкцию: ALTER MASTER KEY ADD ENCRYPTION BY SERVICE MASTER KEY.</span><span class="sxs-lookup"><span data-stu-id="19f2a-149">We recommend that you enable automatic decryption of the master key by executing the following statement: ALTER MASTER KEY ADD ENCRYPTION BY SERVICE MASTER KEY.</span></span> <span data-ttu-id="19f2a-150">Дополнительные сведения см. в разделах [CREATE MASTER KEY (Transact-SQL)](/sql/t-sql/statements/create-master-key-transact-sql) и [ALTER MASTER KEY (Transact-SQL)](/sql/t-sql/statements/alter-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="19f2a-150">For more information, see [CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql) and [ALTER MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-master-key-transact-sql).</span></span>  
  
 <span data-ttu-id="19f2a-151">Требования для присоединения файлов журналов частично зависят от того, доступна база данных для записи и чтения или только для чтения.</span><span class="sxs-lookup"><span data-stu-id="19f2a-151">The requirement for attaching log files depends partly on whether the database is read-write or read-only, as follows:</span></span>  
  
-   <span data-ttu-id="19f2a-152">Для базы данных, доступной для записи и чтения, обычно можно присоединить файл журнала в новом расположении.</span><span class="sxs-lookup"><span data-stu-id="19f2a-152">For a read-write database, you can usually attach a log file in a new location.</span></span> <span data-ttu-id="19f2a-153">Однако в некоторых случаях для повторного соединения базы данных требуются файлы ее существующих журналов.</span><span class="sxs-lookup"><span data-stu-id="19f2a-153">However, in some cases, reattaching a database requires its existing log files.</span></span> <span data-ttu-id="19f2a-154">Поэтому всегда храните все отсоединенные файлы журналов, пока база данных не будет успешно присоединена без них.</span><span class="sxs-lookup"><span data-stu-id="19f2a-154">Therefore, it is important to always keep all the detached log files until the database has been successfully attached without them.</span></span>  
  
     <span data-ttu-id="19f2a-155">Если у базы данных, доступной для записи и чтения, только один файл журнала и для него не указано новое расположение, операция присоединения использует старое расположение файла.</span><span class="sxs-lookup"><span data-stu-id="19f2a-155">If a read-write database has a single log file and you do not specify a new location for the log file, the attach operation looks in the old location for the file.</span></span> <span data-ttu-id="19f2a-156">Если он найден, применяется старый файл журнала независимо от того, была ли база данных выключена чисто.</span><span class="sxs-lookup"><span data-stu-id="19f2a-156">If it is found, the old log file is used, regardless of whether the database was shut down cleanly.</span></span> <span data-ttu-id="19f2a-157">Однако если старый файл журнала не найден и база данных была выключена чисто и не имеет активной цепочки журналов, то операция присоединения пытается построить новый файл журнала для базы данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-157">However, if the old log file is not found and if the database was shut down cleanly and has no active log chain, the attach operation attempts to build a new log file for the database.</span></span>  
  
-   <span data-ttu-id="19f2a-158">Если присоединяемый первичный файл данных доступен только для чтения, то [!INCLUDE[ssDE](../../includes/ssnoversion-md.md)] не может обновить расположение журнала, хранящееся в первичном файле.</span><span class="sxs-lookup"><span data-stu-id="19f2a-158">If the primary data file being attached is read-only, the [!INCLUDE[ssDE](../../includes/ssnoversion-md.md)] cannot update the log location stored in the primary file.</span></span>  
  
  
  
###  <a name="metadata-changes-on-attaching-a-database"></a><a name="Metadata"></a> <span data-ttu-id="19f2a-159">Изменение метаданных при присоединении базы данных</span><span class="sxs-lookup"><span data-stu-id="19f2a-159">Metadata Changes on Attaching a Database</span></span>  
 <span data-ttu-id="19f2a-160">Если база данных, доступная только для чтения, отсоединяется, а затем снова присоединяется, то данные о текущей базовой копии для разностного копирования будут утеряны.</span><span class="sxs-lookup"><span data-stu-id="19f2a-160">When a read-only database is detached and then reattached, the backup information about the current differential base is lost.</span></span> <span data-ttu-id="19f2a-161">*Базовая копия для разностного копирования* — это последняя из полных резервных копий всех данных из базы данных или из подмножества файлов и файловых групп, содержащихся в базе данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-161">The *differential base* is the most recent full backup of all the data in the database or in a subset of the files or filegroups of the database.</span></span> <span data-ttu-id="19f2a-162">Без сведений о базовой резервной копии база данных **master** утрачивает синхронизацию с базой данных, доступной только для чтения, и дальнейшее создание разностных резервных копий может привести к непредвиденным результатам.</span><span class="sxs-lookup"><span data-stu-id="19f2a-162">Without the base-backup information, the **master** database becomes unsynchronized with the read-only database, so differential backups taken thereafter may provide unexpected results.</span></span> <span data-ttu-id="19f2a-163">Таким образом, если с базой данных, доступной только для чтения, используются разностные резервные копии, то после повторного присоединения базы данных необходимо установить новую базовую копию для разностного копирования, создав полную резервную копию.</span><span class="sxs-lookup"><span data-stu-id="19f2a-163">Therefore, if you are using differential backups with a read-only database, you should establish a new differential base by taking a full backup after you reattach the database.</span></span> <span data-ttu-id="19f2a-164">Сведения о разностных резервных копиях см. в разделе [Разностные резервные копии (SQL Server)](../backup-restore/differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="19f2a-164">For information about differential backups, see [Differential Backups &#40;SQL Server&#41;](../backup-restore/differential-backups-sql-server.md).</span></span>  
  
 <span data-ttu-id="19f2a-165">После присоединения происходит запуск базы данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-165">On attach, database startup occurs.</span></span> <span data-ttu-id="19f2a-166">Обычно присоединение базы данных переводит ее в то же состояние, в котором она находилась на момент отсоединения или копирования.</span><span class="sxs-lookup"><span data-stu-id="19f2a-166">Generally, attaching a database places it in the same state that it was in when it was detached or copied.</span></span> <span data-ttu-id="19f2a-167">Однако операции присоединения и отсоединения отключают создание межбазовых цепочек владения для этой базы данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-167">However, attach-and-detach operations both disable cross-database ownership chaining for the database.</span></span> <span data-ttu-id="19f2a-168">Сведения о том, как включить цепочки владения, см. в разделе [Параметр конфигурации сервера "cross db ownership chaining"](../../database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="19f2a-168">For information about how to enable chaining, see [cross db ownership chaining Server Configuration Option](../../database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option.md).</span></span> <span data-ttu-id="19f2a-169">Также TRUSTWORTHY устанавливается в OFF при каждом присоединении базы данных.</span><span class="sxs-lookup"><span data-stu-id="19f2a-169">Also, TRUSTWORTHY is set to OFF whenever the database is attached.</span></span> <span data-ttu-id="19f2a-170">Сведения о том, как установить параметр TRUSTWORTHY в значение ON, см. в разделе [ALTER DATABASE (Transact-SQL)](/sql/t-sql/statements/alter-database-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="19f2a-170">For information about how to set TRUSTWORTHY to ON, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
### <a name="backup-and-restore-and-attach"></a><span data-ttu-id="19f2a-171">Резервное копирование, восстановление и присоединение</span><span class="sxs-lookup"><span data-stu-id="19f2a-171">Backup and Restore and Attach</span></span>  
 <span data-ttu-id="19f2a-172">Подобно любой базе данных, которая полностью или частично вне сети, база данных с восстановлением файлов не может быть присоединена.</span><span class="sxs-lookup"><span data-stu-id="19f2a-172">Like any database that is fully or partially offline, a database with restoring files cannot be attached.</span></span> <span data-ttu-id="19f2a-173">Базу данных можно присоединить после остановки последовательности восстановления.</span><span class="sxs-lookup"><span data-stu-id="19f2a-173">If you stop the restore sequence, you can attach the database.</span></span> <span data-ttu-id="19f2a-174">Затем можно снова запустить последовательность восстановления.</span><span class="sxs-lookup"><span data-stu-id="19f2a-174">Then, you can restart the restore sequence.</span></span>  
  
###  <a name="attaching-a-database-to-another-server-instance"></a><a name="OtherServerInstance"></a> <span data-ttu-id="19f2a-175">Присоединение базы данных к другому экземпляру сервера</span><span class="sxs-lookup"><span data-stu-id="19f2a-175">Attaching a Database to Another Server Instance</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="19f2a-176">База данных, созданная в более поздней версии [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], не может быть присоединена в ранних версиях.</span><span class="sxs-lookup"><span data-stu-id="19f2a-176">A database created by a more recent version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cannot be attached in earlier versions.</span></span>  
  
 <span data-ttu-id="19f2a-177">При присоединении базы данных к другому экземпляру сервера для обеспечения ее согласованного функционирования для пользователей и приложений может понадобиться повторное создание некоторых или всех метаданных базы данных, например имен входа и задания, на другом экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="19f2a-177">When you attach a database onto another server instance, to provide a consistent experience to users and applications, you might have to re-create some or all of the metadata for the database, such as logins and jobs, on the other server instance.</span></span> <span data-ttu-id="19f2a-178">Дополнительные сведения см. в статье [Управление метаданными при обеспечении доступности базы данных на другом экземпляре сервера (SQL Server)](manage-metadata-when-making-a-database-available-on-another-server.md).</span><span class="sxs-lookup"><span data-stu-id="19f2a-178">For more information, see [Manage Metadata When Making a Database Available on Another Server Instance &#40;SQL Server&#41;](manage-metadata-when-making-a-database-available-on-another-server.md).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="19f2a-179">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="19f2a-179">Related Tasks</span></span>  
 <span data-ttu-id="19f2a-180">**Отсоединение базы данных**</span><span class="sxs-lookup"><span data-stu-id="19f2a-180">**To detach a database**</span></span>  
  
-   [<span data-ttu-id="19f2a-181">sp_detach_db (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="19f2a-181">sp_detach_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-detach-db-transact-sql)  
  
-   [<span data-ttu-id="19f2a-182">Отсоединение базы данных</span><span class="sxs-lookup"><span data-stu-id="19f2a-182">Detach a Database</span></span>](detach-a-database.md)  
  
 <span data-ttu-id="19f2a-183">**Присоединение базы данных**</span><span class="sxs-lookup"><span data-stu-id="19f2a-183">**To attach a database**</span></span>  
  
-   [<span data-ttu-id="19f2a-184">CREATE DATABASE (SQL Server Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="19f2a-184">CREATE DATABASE &#40;SQL Server Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-database-sql-server-transact-sql)  
  
-   [<span data-ttu-id="19f2a-185">Присоединение базы данных</span><span class="sxs-lookup"><span data-stu-id="19f2a-185">Attach a Database</span></span>](attach-a-database.md)  
  
-   [<span data-ttu-id="19f2a-186">sp_attach_db (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="19f2a-186">sp_attach_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql)  
  
-   [<span data-ttu-id="19f2a-187">sp_attach_single_file_db (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="19f2a-187">sp_attach_single_file_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-single-file-db-transact-sql)  
  
 <span data-ttu-id="19f2a-188">**Обновление базы данных при помощи операций отсоединения и присоединения**</span><span class="sxs-lookup"><span data-stu-id="19f2a-188">**To upgrade a database using detach and attach operations**</span></span>  
  
-   [<span data-ttu-id="19f2a-189">Обновление базы данных при помощи отсоединения и присоединения (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="19f2a-189">Upgrade a Database Using Detach and Attach &#40;Transact-SQL&#41;</span></span>](upgrade-a-database-using-detach-and-attach-transact-sql.md)  
  
 <span data-ttu-id="19f2a-190">**Перемещение базы данных при помощи операций отсоединения и присоединения**</span><span class="sxs-lookup"><span data-stu-id="19f2a-190">**To move a database using detach and attach operations**</span></span>  
  
-   [<span data-ttu-id="19f2a-191">Перенос базы данных путем отсоединения и присоединения (язык Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="19f2a-191">Move a Database Using Detach and Attach &#40;Transact-SQL&#41;</span></span>](move-a-database-using-detach-and-attach-transact-sql.md)  
  
 <span data-ttu-id="19f2a-192">**Удаление моментального снимка базы данных**</span><span class="sxs-lookup"><span data-stu-id="19f2a-192">**To delete a database snapshot**</span></span>  
  
-   [<span data-ttu-id="19f2a-193">Удаление моментального снимка базы данных (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="19f2a-193">Drop a Database Snapshot &#40;Transact-SQL&#41;</span></span>](drop-a-database-snapshot-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="19f2a-194">См. также:</span><span class="sxs-lookup"><span data-stu-id="19f2a-194">See Also</span></span>  
 [<span data-ttu-id="19f2a-195">Файлы и файловые группы базы данных</span><span class="sxs-lookup"><span data-stu-id="19f2a-195">Database Files and Filegroups</span></span>](database-files-and-filegroups.md)  
  
  
