---
title: SQLSetStmtAttr | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664181"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="103f0-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="103f0-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="103f0-103">Драйвер ODBC собственного клиента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не поддерживает смешанную (динамическую и с набором ключей) модель курсора.</span><span class="sxs-lookup"><span data-stu-id="103f0-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="103f0-104">Попытки установить размер набора ключей с помощью атрибута SQL_ATTR_KEYSET_SIZE завершатся неудачей, если задаваемое значение не равно 0.</span><span class="sxs-lookup"><span data-stu-id="103f0-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="103f0-105">Приложение задает SQL_ATTR_ROW_ARRAY_SIZE для всех инструкций, чтобы объявить число строк, возвращаемых при вызове функции **SQLFetch** или [SQLFetchScroll](sqlfetchscroll.md) .</span><span class="sxs-lookup"><span data-stu-id="103f0-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="103f0-106">Для инструкций, задающих серверный курсор, драйвер использует атрибут SQL_ATTR_ROW_ARRAY_SIZE, чтобы задать размер блока строк, которые создаются на сервере в ответ на запрос на выборку со стороны курсора.</span><span class="sxs-lookup"><span data-stu-id="103f0-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="103f0-107">В пределах размера блока динамического курсора членство в строке и порядок не меняются, если уровень изоляции транзакции достаточен для обеспечения повторяемого чтения фиксированных транзакций.</span><span class="sxs-lookup"><span data-stu-id="103f0-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="103f0-108">Вне блока, задаваемого этой величиной, курсор полностью динамичен.</span><span class="sxs-lookup"><span data-stu-id="103f0-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="103f0-109">Размер блока серверного курсора полностью динамичен и может быть изменен в любой момент в процессе обработки выборки.</span><span class="sxs-lookup"><span data-stu-id="103f0-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="103f0-110">Функция SQLSetStmtAttr и возвращающие табличные значения параметры</span><span class="sxs-lookup"><span data-stu-id="103f0-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="103f0-111">SQLSetStmtAttr можно использовать для установки SQL_SOPT_SS_PARAM_FOCUS в дескрипторе параметра приложения (APD) перед доступом к полям дескриптора для столбцов возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="103f0-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="103f0-112">Если предпринимается попытка задать SQL_SOPT_SS_PARAM_FOCUS порядковому номеру параметра, который не является возвращающим табличное значение параметром, SQLSetStmtAttr возвращает SQL_ERROR и запись диагностики, созданную с помощью SQLSTATE = HY024, и сообщение "Недопустимый атрибут value".</span><span class="sxs-lookup"><span data-stu-id="103f0-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="103f0-113">Если возвращается значение SQL_ERROR, то атрибут SQL_SOPT_SS_PARAM_FOCUS не меняется.</span><span class="sxs-lookup"><span data-stu-id="103f0-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="103f0-114">Установка атрибута SQL_SOPT_SS_PARAM_FOCUS в значение 0 восстанавливает доступ к записям дескриптора для параметров.</span><span class="sxs-lookup"><span data-stu-id="103f0-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="103f0-115">SQLSetStmtAttr также можно использовать для установки SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="103f0-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="103f0-116">Дополнительные сведения см. в подразделе «SQL_SOPT_SS_NAME_SCOPE» далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="103f0-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="103f0-117">Дополнительные сведения см. в разделе [метаданные возвращающего табличное значение параметра для подготовленных инструкций](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span><span class="sxs-lookup"><span data-stu-id="103f0-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="103f0-118">Дополнительные сведения о возвращающих табличное значение параметрах см. в разделе [возвращающие табличное значение параметры &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="103f0-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="103f0-119">Поддержка разреженных столбцов функцией SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="103f0-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="103f0-120">SQLSetStmtAttr можно использовать для установки SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="103f0-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="103f0-121">Дополнительные сведения см. в подразделе SQL_SOPT_SS_NAME_SCOPE далее в этом разделе. Дополнительные сведения о разреженных столбцах см. в разделе [Поддержка разреженных столбцов &#40;&#41;ODBC ](../native-client/odbc/sparse-columns-support-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="103f0-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="103f0-122">Атрибуты инструкции</span><span class="sxs-lookup"><span data-stu-id="103f0-122">Statement Attributes</span></span>  
 <span data-ttu-id="103f0-123">Драйвер ODBC для собственного клиента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] поддерживает следующие атрибуты инструкций, специфичные для драйвера.</span><span class="sxs-lookup"><span data-stu-id="103f0-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="103f0-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="103f0-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="103f0-125">Атрибут SQL_SOPT_SS_CURSOR указывает, будет ли драйвер использовать для курсоров специфичные для данного драйвера параметры настройки производительности.</span><span class="sxs-lookup"><span data-stu-id="103f0-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="103f0-126">[SQLGetData](sqlgetdata.md) не допускается, если заданы эти параметры.</span><span class="sxs-lookup"><span data-stu-id="103f0-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="103f0-127">Значение по умолчанию равно SQL_CO_OFF.</span><span class="sxs-lookup"><span data-stu-id="103f0-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="103f0-128">Значение аргумента *ValuePtr* имеет тип SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="103f0-129">Значение *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="103f0-129">*ValuePtr* value</span></span>|<span data-ttu-id="103f0-130">Описание</span><span class="sxs-lookup"><span data-stu-id="103f0-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="103f0-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="103f0-131">SQL_CO_OFF</span></span>|<span data-ttu-id="103f0-132">По умолчанию.</span><span class="sxs-lookup"><span data-stu-id="103f0-132">Default.</span></span> <span data-ttu-id="103f0-133">Отключает быстрые однопроходные курсоры, только для чтения и автовыборки, включает **SQLGetData** для однопроходных курсоров только для чтения.</span><span class="sxs-lookup"><span data-stu-id="103f0-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="103f0-134">Если атрибут SQL_SOPT_SS_CURSOR_OPTIONS имеет значение SQL_CO_OFF, тип курсора не изменится.</span><span class="sxs-lookup"><span data-stu-id="103f0-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="103f0-135">То есть быстрый однопроходный курсор останется быстрым однопроходным курсором.</span><span class="sxs-lookup"><span data-stu-id="103f0-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="103f0-136">Чтобы изменить тип курсора, приложение должно установить другой тип курсора с помощью `SQLSetStmtAttr` /SQL_ATTR_CURSOR_TYPE.</span><span class="sxs-lookup"><span data-stu-id="103f0-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="103f0-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="103f0-137">SQL_CO_FFO</span></span>|<span data-ttu-id="103f0-138">Включает быстрые однопроходные курсоры только для чтения, отключает **SQLGetData** на однопроходных курсорах только для чтения.</span><span class="sxs-lookup"><span data-stu-id="103f0-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="103f0-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="103f0-139">SQL_CO_AF</span></span>|<span data-ttu-id="103f0-140">Включает параметр автоматической выборки для курсора любого типа.</span><span class="sxs-lookup"><span data-stu-id="103f0-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="103f0-141">Если этот параметр задан для обработчика инструкции, **SQLExecute** или **SQLExecDirect** создаст неявный **SQLFetchScroll** (SQL_FIRST).</span><span class="sxs-lookup"><span data-stu-id="103f0-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="103f0-142">Курсор открыт, и первый набор строк возвращен за одно обращение к серверу.</span><span class="sxs-lookup"><span data-stu-id="103f0-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="103f0-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="103f0-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="103f0-144">Включает быстрые однопроходные курсоры с параметром автоматической выборки.</span><span class="sxs-lookup"><span data-stu-id="103f0-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="103f0-145">Эквивалентно одновременному заданию SQL_CO_AF и SQL_CO_FFO.</span><span class="sxs-lookup"><span data-stu-id="103f0-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="103f0-146">Если эти параметры заданы, сервер автоматически закрывает курсор, когда обнаруживает, что была получена последняя строка.</span><span class="sxs-lookup"><span data-stu-id="103f0-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="103f0-147">Приложение по-прежнему должно вызывать [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) или [SQLCloseCursor](sqlclosecursor.md), но драйверу не нужно отсылать уведомление о закрытии на сервер.</span><span class="sxs-lookup"><span data-stu-id="103f0-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="103f0-148">Если список выбора содержит столбец **Text**, **ntext**или **Image** , то однопроходный курсор преобразуется в динамический курсор, а **SQLGetData** — разрешено.</span><span class="sxs-lookup"><span data-stu-id="103f0-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="103f0-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="103f0-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="103f0-150">Атрибут SQL_SOPT_SS_DEFER_PREPARE определяет, была ли инструкция подготовлена немедленно или отложена до выполнения **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) или [SQLDescribeParam](sqldescribeparam.md) .</span><span class="sxs-lookup"><span data-stu-id="103f0-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="103f0-151">В [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 и более ранних версиях это свойство не учитывается (подготовка не откладывается).</span><span class="sxs-lookup"><span data-stu-id="103f0-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="103f0-152">Значение аргумента *ValuePtr* имеет тип SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="103f0-153">Значение *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="103f0-153">*ValuePtr* value</span></span>|<span data-ttu-id="103f0-154">Описание</span><span class="sxs-lookup"><span data-stu-id="103f0-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="103f0-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="103f0-155">SQL_DP_ON</span></span>|<span data-ttu-id="103f0-156">По умолчанию.</span><span class="sxs-lookup"><span data-stu-id="103f0-156">Default.</span></span> <span data-ttu-id="103f0-157">После вызова [функции SQLPrepare](https://go.microsoft.com/fwlink/?LinkId=59360)подготовка инструкции откладывается до вызова **SQLExecute** или выполнения операции метасвойства (**SQLDescribeCol** или **SQLDescribeParam**).</span><span class="sxs-lookup"><span data-stu-id="103f0-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="103f0-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="103f0-158">SQL_DP_OFF</span></span>|<span data-ttu-id="103f0-159">Инструкция подготовлена сразу после выполнения **SQLPrepare** .</span><span class="sxs-lookup"><span data-stu-id="103f0-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="103f0-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="103f0-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="103f0-161">Атрибут SQL_SOPT_SS_REGIONALIZE используется для задания преобразования данных на уровне инструкции.</span><span class="sxs-lookup"><span data-stu-id="103f0-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="103f0-162">Атрибут указывает драйверу, что следует использовать настройки локали на клиенте при преобразовании данных в денежном формате, формате даты и времени в символьные данные.</span><span class="sxs-lookup"><span data-stu-id="103f0-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="103f0-163">Преобразование проводится только из собственных типов данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в строки символов.</span><span class="sxs-lookup"><span data-stu-id="103f0-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="103f0-164">Значение аргумента *ValuePtr* имеет тип SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="103f0-165">Значение *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="103f0-165">*ValuePtr* value</span></span>|<span data-ttu-id="103f0-166">Описание</span><span class="sxs-lookup"><span data-stu-id="103f0-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="103f0-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="103f0-167">SQL_RE_OFF</span></span>|<span data-ttu-id="103f0-168">По умолчанию.</span><span class="sxs-lookup"><span data-stu-id="103f0-168">Default.</span></span> <span data-ttu-id="103f0-169">Драйвер ODBC не использует настройки локали на клиенте при преобразовании данных в денежном формате, формате даты и времени в строковые данные.</span><span class="sxs-lookup"><span data-stu-id="103f0-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="103f0-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="103f0-170">SQL_RE_ON</span></span>|<span data-ttu-id="103f0-171">Драйвер ODBC использует настройки локали на клиенте при преобразовании данных в денежном формате, формате даты и времени в символьные данные.</span><span class="sxs-lookup"><span data-stu-id="103f0-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="103f0-172">Региональные параметры преобразований применяются к типам данных валюты, чисел и даты-времени.</span><span class="sxs-lookup"><span data-stu-id="103f0-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="103f0-173">Параметры преобразований применяются только к выходным преобразованиям, когда значения валюты, числовые значения, значения даты или времени преобразуются в символьные строки.</span><span class="sxs-lookup"><span data-stu-id="103f0-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="103f0-174">Когда атрибут инструкции SQL_SOPT_SS_REGIONALIZE включен, драйвер использует настройки локали из реестра текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="103f0-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="103f0-175">Драйвер не учитывает языковой стандарт текущего потока, если приложение устанавливает его, например, путем вызова **сетсреадлокале**.</span><span class="sxs-lookup"><span data-stu-id="103f0-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="103f0-176">Изменение режима работы источника данных с региональными параметрами может привести к ошибке приложения.</span><span class="sxs-lookup"><span data-stu-id="103f0-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="103f0-177">Изменение этого значения может отрицательно повлиять на работу приложения, анализирующего строки даты и предполагающего, что строки даты будут выводиться в виде, определенном ODBC.</span><span class="sxs-lookup"><span data-stu-id="103f0-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="103f0-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="103f0-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="103f0-179">Атрибут SQL_SOPT_SS_TEXTPTR_LOGGING переключает ведение журнала операций над столбцами, содержащими **текстовые** или **графические** данные.</span><span class="sxs-lookup"><span data-stu-id="103f0-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="103f0-180">Значение аргумента *ValuePtr* имеет тип SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="103f0-181">Значение *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="103f0-181">*ValuePtr* value</span></span>|<span data-ttu-id="103f0-182">Описание</span><span class="sxs-lookup"><span data-stu-id="103f0-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="103f0-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="103f0-183">SQL_TL_OFF</span></span>|<span data-ttu-id="103f0-184">Отключает ведение журнала операций, выполняемых с данными типа **Text** и **Image** .</span><span class="sxs-lookup"><span data-stu-id="103f0-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="103f0-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="103f0-185">SQL_TL_ON</span></span>|<span data-ttu-id="103f0-186">По умолчанию.</span><span class="sxs-lookup"><span data-stu-id="103f0-186">Default.</span></span> <span data-ttu-id="103f0-187">Включает ведение журнала операций, выполняемых с данными типа **Text** и **Image** .</span><span class="sxs-lookup"><span data-stu-id="103f0-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="103f0-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="103f0-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="103f0-189">В результирующем наборе атрибут SQL_SOPT_SS_HIDDEN_COLUMNS предоставляет столбцы, скрытые в инструкции [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="103f0-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="103f0-190">По умолчанию драйвер не предоставляет доступ к этим столбцам.</span><span class="sxs-lookup"><span data-stu-id="103f0-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="103f0-191">Значение аргумента *ValuePtr* имеет тип SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="103f0-192">Значение *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="103f0-192">*ValuePtr* value</span></span>|<span data-ttu-id="103f0-193">Описание</span><span class="sxs-lookup"><span data-stu-id="103f0-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="103f0-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="103f0-194">SQL_HC_OFF</span></span>|<span data-ttu-id="103f0-195">По умолчанию.</span><span class="sxs-lookup"><span data-stu-id="103f0-195">Default.</span></span> <span data-ttu-id="103f0-196">Столбцы FOR BROWSE в результирующем наборе скрыты.</span><span class="sxs-lookup"><span data-stu-id="103f0-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="103f0-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="103f0-197">SQL_HC_ON</span></span>|<span data-ttu-id="103f0-198">Обеспечивает доступ к столбцам FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="103f0-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="103f0-199">Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="103f0-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="103f0-200">Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT возвращает текст сообщения в ответ на запрошенное уведомление о запросе.</span><span class="sxs-lookup"><span data-stu-id="103f0-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="103f0-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="103f0-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="103f0-202">Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS задает параметры для запроса уведомления о запросе.</span><span class="sxs-lookup"><span data-stu-id="103f0-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="103f0-203">Эти параметры заданы в строке с конструкцией `name=value`, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="103f0-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="103f0-204">За создание службы и считывание уведомлений из очереди отвечает приложение.</span><span class="sxs-lookup"><span data-stu-id="103f0-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="103f0-205">Строка параметров уведомлений запросов имеет следующий синтаксис.</span><span class="sxs-lookup"><span data-stu-id="103f0-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="103f0-206">Пример:</span><span class="sxs-lookup"><span data-stu-id="103f0-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="103f0-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="103f0-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="103f0-208">Атрибут SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT задает время в секундах, в течение которого уведомление о запросе будет активным.</span><span class="sxs-lookup"><span data-stu-id="103f0-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="103f0-209">Значение по умолчанию составляет 432 000 секунд (5 суток).</span><span class="sxs-lookup"><span data-stu-id="103f0-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="103f0-210">Значение аргумента *ValuePtr* имеет тип SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="103f0-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="103f0-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="103f0-212">Атрибут SQL_SOPT_SS_PARAM_FOCUS задает фокус для последующих вызовов SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec и SQLSetDescRec.</span><span class="sxs-lookup"><span data-stu-id="103f0-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="103f0-213">Атрибут SQL_SOPT_SS_PARAM_FOCUS принадлежит к типу SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="103f0-214">По умолчанию он имеет значение 0; это означает, что вызовы относятся к параметрам, соответствующим маркерам параметров в инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="103f0-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="103f0-215">Если задать для атрибута значение, равное порядковому номеру возвращающего табличное значение параметра, вызовы будут относиться к столбцам этого параметра.</span><span class="sxs-lookup"><span data-stu-id="103f0-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="103f0-216">Если для параметра задано значение, которое не является номером параметра с табличным значением, то эти вызовы возвращают ошибку IM020: "фокус параметра не ссылается на параметр, возвращающий табличное значение".</span><span class="sxs-lookup"><span data-stu-id="103f0-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="103f0-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="103f0-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="103f0-218">Атрибут SQL_SOPT_SS_NAME_SCOPE задает область действия имени для последующих вызовов функций работы с каталогами.</span><span class="sxs-lookup"><span data-stu-id="103f0-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="103f0-219">Результирующий набор, возвращаемый функцией SQLColumns, зависит от значения параметра SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="103f0-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="103f0-220">Атрибут SQL_SOPT_SS_NAME_SCOPE принадлежит к типу SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="103f0-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="103f0-221">Значение *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="103f0-221">*ValuePtr* value</span></span>|<span data-ttu-id="103f0-222">Описание</span><span class="sxs-lookup"><span data-stu-id="103f0-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="103f0-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="103f0-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="103f0-224">По умолчанию.</span><span class="sxs-lookup"><span data-stu-id="103f0-224">Default.</span></span><br /><br /> <span data-ttu-id="103f0-225">При использовании возвращающих табличное значение параметров этот атрибут указывает, что нужно возвратить метаданные реально существующих таблиц.</span><span class="sxs-lookup"><span data-stu-id="103f0-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="103f0-226">При использовании функции разреженных столбцов SQLColumns возвращает только столбцы, не являющиеся членами разреженного `column_set` .</span><span class="sxs-lookup"><span data-stu-id="103f0-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="103f0-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="103f0-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="103f0-228">Указывает, что приложению требуются метаданные для табличного типа, а не для реально существующих таблиц (функции работы с каталогами должны возвращать метаданные для табличных типов).</span><span class="sxs-lookup"><span data-stu-id="103f0-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="103f0-229">Затем приложение передает TYPE_NAME возвращающего табличное значение параметра в виде параметра *TableName* .</span><span class="sxs-lookup"><span data-stu-id="103f0-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="103f0-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="103f0-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="103f0-231">При использовании функции разреженных столбцов SQLColumns возвращает все столбцы независимо от `column_set` членства.</span><span class="sxs-lookup"><span data-stu-id="103f0-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="103f0-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="103f0-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="103f0-233">При использовании функции разреженных столбцов SQLColumns возвращает только те столбцы, которые являются элементами разреженного `column_set` .</span><span class="sxs-lookup"><span data-stu-id="103f0-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="103f0-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="103f0-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="103f0-235">Равен атрибуту SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="103f0-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="103f0-236">SS_TYPE_CATALOG_NAME и SS_TYPE_SCHEMA_NAME используются с параметрами *CatalogName* и *SchemaName* соответственно, чтобы найти каталог и схему для возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="103f0-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="103f0-237">Когда приложение закончит получать метаданные для возвращающего табличное значение параметра, оно должно вновь присвоить SQL_SOPT_SS_NAME_SCOPE значение по умолчанию SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="103f0-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="103f0-238">Если SQL_SOPT_SS_NAME_SCOPE имеет значение SQL_SS_NAME_SCOPE_TABLE, то запросы к связанным серверам завершаются ошибкой.</span><span class="sxs-lookup"><span data-stu-id="103f0-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="103f0-239">Вызовы SQLColumns или SQLPrimaryKeys с каталогом, содержащим серверный компонент, завершатся ошибкой.</span><span class="sxs-lookup"><span data-stu-id="103f0-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="103f0-240">При попытке задать для атрибута SQL_SOPT_SS_NAME_SCOPE недопустимое значение будет возвращено значение SQL_ERROR и создана диагностическая запись с параметром SQLSTATE HY024 и сообщением «Недопустимое значение атрибута».</span><span class="sxs-lookup"><span data-stu-id="103f0-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="103f0-241">Если функция каталога, отличная от then SQLTables, SQLColumns или SQLPrimaryKeys, вызывается, когда SQL_SOPT_SS_NAME_SCOPE имеет значение, отличное от SQL_SS_NAME_SCOPE_TABLE, возвращается SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="103f0-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="103f0-242">Создается диагностическая запись с параметром SQLSTATE HY010 и сообщением «Ошибочная последовательность функций (значение атрибута SQL_SOPT_SS_NAME_SCOPE не равно SQL_SS_NAME_SCOPE_TABLE)».</span><span class="sxs-lookup"><span data-stu-id="103f0-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="103f0-243">См. также:</span><span class="sxs-lookup"><span data-stu-id="103f0-243">See Also</span></span>  
 <span data-ttu-id="103f0-244">[Функция SQLGetStmtAttr](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="103f0-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="103f0-245">ODBC API Implementation Details</span><span class="sxs-lookup"><span data-stu-id="103f0-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
