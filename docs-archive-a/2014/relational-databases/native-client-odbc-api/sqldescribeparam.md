---
title: SQLDescribeParam | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLDescribeParam function
ms.assetid: 396e74b1-5d08-46dc-b404-2ef2003e4689
author: rothja
ms.author: jroth
ms.openlocfilehash: 05e14ccb0fadb4f1cf05f965c79cf8c05c71f93a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666012"
---
# <a name="sqldescribeparam"></a><span data-ttu-id="595c2-102">SQLDescribeParam</span><span class="sxs-lookup"><span data-stu-id="595c2-102">SQLDescribeParam</span></span>
  <span data-ttu-id="595c2-103">Чтобы описать параметры любой инструкции SQL, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] драйвер ODBC для собственного клиента создает и выполняет [!INCLUDE[tsql](../../includes/tsql-md.md)] инструкцию SELECT при вызове SQLDescribeParam для подготовленного обработчика инструкции ODBC.</span><span class="sxs-lookup"><span data-stu-id="595c2-103">To describe the parameters of any SQL statement, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver builds and executes a [!INCLUDE[tsql](../../includes/tsql-md.md)] SELECT statement when SQLDescribeParam is called on a prepared ODBC statement handle.</span></span> <span data-ttu-id="595c2-104">Метаданные результирующего набора определяют характеристики параметров в подготовленной инструкции.</span><span class="sxs-lookup"><span data-stu-id="595c2-104">The metadata of the result set determines the characteristics of the parameters in the prepared statement.</span></span> <span data-ttu-id="595c2-105">SQLDescribeParam может возвращать любой код ошибки, который может возвращать SQLExecute или SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="595c2-105">SQLDescribeParam can return any error code that SQLExecute or SQLExecDirect might return.</span></span>  
  
 <span data-ttu-id="595c2-106">Улучшения в ядре СУБД, начиная с, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] позволяют SQLDescribeParam получать более точные описания ожидаемых результатов.</span><span class="sxs-lookup"><span data-stu-id="595c2-106">Improvements in the database engine starting with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] allow SQLDescribeParam to obtain more accurate descriptions of the expected results.</span></span> <span data-ttu-id="595c2-107">Эти более точные результаты могут отличаться от значений, возвращаемых функцией SQLDescribeParam в предыдущих версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="595c2-107">These more accurate results may differ from the values returned by SQLDescribeParam in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="595c2-108">Дополнительные сведения см. в разделе [Обнаружение метаданных](../native-client/features/metadata-discovery.md).</span><span class="sxs-lookup"><span data-stu-id="595c2-108">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>  
  
 <span data-ttu-id="595c2-109">Кроме того [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] , в *параметерсизептр* теперь возвращается значение, которое соответствует определению размера (в символах) столбца или выражения соответствующего маркера параметра, как определено в [спецификации ODBC](https://go.microsoft.com/fwlink/?LinkId=207044).</span><span class="sxs-lookup"><span data-stu-id="595c2-109">Also new in [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], *ParameterSizePtr* now returns a value that aligns with the definition for the size, in characters, of the column or expression of the corresponding parameter marker as defined in the [ODBC specification](https://go.microsoft.com/fwlink/?LinkId=207044).</span></span> <span data-ttu-id="595c2-110">В предыдущих версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client *параметерсизептр* может быть соответствующим значением `SQL_DESC_OCTET_LENGTH` для типа или неопределенного значения размера столбца, переданного в SQLBindParameter для типа, значение, которое должно игнорироваться ( `SQL_INTEGER` например,).</span><span class="sxs-lookup"><span data-stu-id="595c2-110">In previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, *ParameterSizePtr* could be the corresponding value of `SQL_DESC_OCTET_LENGTH` for the type, or an irrelevant column size value that was supplied to SQLBindParameter for a type, the value of which should be ignored (`SQL_INTEGER`, for example).</span></span>  
  
 <span data-ttu-id="595c2-111">Драйвер не поддерживает вызов SQLDescribeParam в следующих ситуациях:</span><span class="sxs-lookup"><span data-stu-id="595c2-111">The driver does not support calling SQLDescribeParam in the following situations:</span></span>  
  
-   <span data-ttu-id="595c2-112">После SQLExecDirect для любых [!INCLUDE[tsql](../../includes/tsql-md.md)] инструкций UPDATE или DELETE, содержащих предложение FROM.</span><span class="sxs-lookup"><span data-stu-id="595c2-112">After SQLExecDirect for any [!INCLUDE[tsql](../../includes/tsql-md.md)] UPDATE or DELETE statements containing the FROM clause.</span></span>  
  
-   <span data-ttu-id="595c2-113">Для любой инструкции ODBC или [!INCLUDE[tsql](../../includes/tsql-md.md)], содержащей параметр в предложении HAVING, или сравниваемой с результатом функции SUM.</span><span class="sxs-lookup"><span data-stu-id="595c2-113">For any ODBC or [!INCLUDE[tsql](../../includes/tsql-md.md)] statement containing a parameter in a HAVING clause, or compared to the result of a SUM function.</span></span>  
  
-   <span data-ttu-id="595c2-114">Для любой инструкции ODBC или [!INCLUDE[tsql](../../includes/tsql-md.md)], зависящей от вложенного запроса, который содержит параметры.</span><span class="sxs-lookup"><span data-stu-id="595c2-114">For any ODBC or [!INCLUDE[tsql](../../includes/tsql-md.md)] statement depending on a subquery containing parameters.</span></span>  
  
-   <span data-ttu-id="595c2-115">Для инструкций ODBC SQL, содержащих маркеры параметров в обоих сравниваемых выражениях или содержащих предикат с квантором.</span><span class="sxs-lookup"><span data-stu-id="595c2-115">For ODBC SQL statements containing parameter markers in both expressions of a comparison, like, or quantified predicate.</span></span>  
  
-   <span data-ttu-id="595c2-116">Для любых запросов, в которых один из параметров является параметром функции.</span><span class="sxs-lookup"><span data-stu-id="595c2-116">For any queries where one of the parameters is a parameter to a function.</span></span>  
  
-   <span data-ttu-id="595c2-117">При наличии комментариев (/\* \* /) в [!INCLUDE[tsql](../../includes/tsql-md.md)] команде.</span><span class="sxs-lookup"><span data-stu-id="595c2-117">When there are comments (/\* \*/) in the [!INCLUDE[tsql](../../includes/tsql-md.md)] command.</span></span>  
  
 <span data-ttu-id="595c2-118">При обработке пакета [!INCLUDE[tsql](../../includes/tsql-md.md)] инструкций драйвер также не поддерживает вызов SQLDescribeParam для маркеров параметров в инструкциях после первой инструкции в пакете.</span><span class="sxs-lookup"><span data-stu-id="595c2-118">When processing a batch of [!INCLUDE[tsql](../../includes/tsql-md.md)] statements, the driver also does not support calling SQLDescribeParam for parameter markers in statements after the first statement in the batch.</span></span>  
  
 <span data-ttu-id="595c2-119">При описании параметров подготовленных хранимых процедур SQLDescribeParam использует системную хранимую процедуру [sp_sproc_columns](/sql/relational-databases/system-stored-procedures/sp-sproc-columns-transact-sql) для получения характеристик параметров.</span><span class="sxs-lookup"><span data-stu-id="595c2-119">When describing the parameters of prepared stored procedures, SQLDescribeParam uses the system stored procedure [sp_sproc_columns](/sql/relational-databases/system-stored-procedures/sp-sproc-columns-transact-sql) to retrieve parameter characteristics.</span></span> <span data-ttu-id="595c2-120">sp_sproc_columns может сообщать данные о хранимых процедурах в текущей пользовательской базе данных.</span><span class="sxs-lookup"><span data-stu-id="595c2-120">sp_sproc_columns can report data for stored procedures within the current user database.</span></span> <span data-ttu-id="595c2-121">Подготовка полного имени хранимой процедуры позволяет выполнять SQLDescribeParam между базами данных.</span><span class="sxs-lookup"><span data-stu-id="595c2-121">Preparing a fully qualified stored procedure name allows SQLDescribeParam to execute across databases.</span></span> <span data-ttu-id="595c2-122">Например, системная хранимая процедура [sp_who](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql) может быть подготовлена и выполнена в любой базе данных следующим образом:</span><span class="sxs-lookup"><span data-stu-id="595c2-122">For example, the system stored procedure [sp_who](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql) can be prepared and executed in any database as:</span></span>  
  
```  
SQLPrepare(hstmt, "{call sp_who(?)}", SQL_NTS);  
```  
  
 <span data-ttu-id="595c2-123">Выполнение SQLDescribeParam после успешной подготовки возвращает пустой набор строк при соединении с любой базой данных, но `master` .</span><span class="sxs-lookup"><span data-stu-id="595c2-123">Executing SQLDescribeParam after successful preparation returns an empty row set when connected to any database but `master`.</span></span> <span data-ttu-id="595c2-124">Тот же вызов, подготовленный следующим образом, приводит к тому, что SQLDescribeParam будет выполнен, независимо от текущей пользовательской базы данных:</span><span class="sxs-lookup"><span data-stu-id="595c2-124">The same call, prepared as follows, causes SQLDescribeParam to succeed regardless of the current user database:</span></span>  
  
```  
SQLPrepare(hstmt, "{call master..sp_who(?)}", SQL_NTS);  
```  
  
 <span data-ttu-id="595c2-125">Для типов данных больших значений значение, возвращаемое в *дататипептр* , SQL_VARCHAR, SQL_VARBINARY или SQL_NVARCHAR.</span><span class="sxs-lookup"><span data-stu-id="595c2-125">For large value data types, the value returned in *DataTypePtr* is SQL_VARCHAR, SQL_VARBINARY, or SQL_NVARCHAR.</span></span> <span data-ttu-id="595c2-126">Чтобы указать, что для параметра типа данных больших значений задано значение "unlimited", [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] драйвер ODBC для собственного клиента устанавливает *параметерсизептр* в значение 0.</span><span class="sxs-lookup"><span data-stu-id="595c2-126">To indicate that the size of the large value data type parameter is "unlimited," the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver sets *ParameterSizePtr* to 0.</span></span> <span data-ttu-id="595c2-127">Значения фактического размера возвращаются для стандартных параметров `varchar`.</span><span class="sxs-lookup"><span data-stu-id="595c2-127">Actual size values are returned for standard `varchar` parameters.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="595c2-128">Если параметр уже был привязан к максимальному размеру (для параметров типа SQL_VARCHAR, SQL_VARBINARY или SQL_WVARCHAR), возвращается привязанный размер параметра, а не «unlimited».</span><span class="sxs-lookup"><span data-stu-id="595c2-128">If the parameter has already been bound with a maximum size for the SQL_VARCHAR, SQL_VARBINARY, or SQL_WVARCHAR parameters, the bound size of the parameter is returned, not "unlimited."</span></span>  
  
 <span data-ttu-id="595c2-129">Чтобы привязать входной параметр размера «unlimited», необходимо использовать данные времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="595c2-129">To bind an "unlimited" size input parameter, data-at-execution must be used.</span></span> <span data-ttu-id="595c2-130">Невозможно привязать выходной параметр "неограниченный" размер (нет метода для потоковой передачи данных из выходного параметра, например [SQLGetData](sqlgetdata.md) для результирующих наборов).</span><span class="sxs-lookup"><span data-stu-id="595c2-130">It is not possible to bind an "unlimited" size output parameter (there is no method for streaming data from an output parameter, like [SQLGetData](sqlgetdata.md) does for result sets).</span></span>  
  
 <span data-ttu-id="595c2-131">Для выходных параметров буфер должен быть привязан, и, если значение слишком длинное, буфер заполняется, и возвращается сообщение SQL_SUCCESS_WITH_INFO с предупреждением «строковые данные; усечение справа».</span><span class="sxs-lookup"><span data-stu-id="595c2-131">For output parameters, a buffer must be bound and if the value is too large, the buffer is filled and a SQL_SUCCESS_WITH_INFO message and is returned along with the "string data; right truncation" warning.</span></span> <span data-ttu-id="595c2-132">Данные, которые были усечены, затем отбрасываются.</span><span class="sxs-lookup"><span data-stu-id="595c2-132">The data that was truncated is then discarded.</span></span>  
  
## <a name="sqldescribeparam-and-table-valued-parameters"></a><span data-ttu-id="595c2-133">Функция SQLDescribeParam и возвращающие табличные значения параметры</span><span class="sxs-lookup"><span data-stu-id="595c2-133">SQLDescribeParam and Table-Valued Parameters</span></span>  
 <span data-ttu-id="595c2-134">Приложение может получить сведения о возвращающем табличное значение параметре для подготовленной инструкции с помощью SQLDescribeParam.</span><span class="sxs-lookup"><span data-stu-id="595c2-134">An application can retrieve table-valued parameter information for a prepared statement with SQLDescribeParam.</span></span> <span data-ttu-id="595c2-135">Дополнительные сведения см. в разделе [метаданные возвращающего табличное значение параметра для подготовленных инструкций](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span><span class="sxs-lookup"><span data-stu-id="595c2-135">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="595c2-136">Дополнительные сведения о возвращающих табличные значения параметрах см. в разделе [возвращающие табличное значение параметры &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="595c2-136">For more information about table-valued parameters in general, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqldescribeparam-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="595c2-137">Поддержка в функции SQLDescribeParam улучшенных возможностей даты-времени</span><span class="sxs-lookup"><span data-stu-id="595c2-137">SQLDescribeParam Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="595c2-138">Для типов даты-времени возвращаются следующие значения.</span><span class="sxs-lookup"><span data-stu-id="595c2-138">The values returned for date/time types are as follows:</span></span>  
  
||<span data-ttu-id="595c2-139">*дататипептр*</span><span class="sxs-lookup"><span data-stu-id="595c2-139">*DataTypePtr*</span></span>|<span data-ttu-id="595c2-140">*параметерсизептр*</span><span class="sxs-lookup"><span data-stu-id="595c2-140">*ParameterSizePtr*</span></span>|<span data-ttu-id="595c2-141">*деЦималдигитсптр*</span><span class="sxs-lookup"><span data-stu-id="595c2-141">*DecimalDigitsPtr*</span></span>|  
|-|-------------------|------------------------|------------------------|  
|<span data-ttu-id="595c2-142">DATETIME</span><span class="sxs-lookup"><span data-stu-id="595c2-142">datetime</span></span>|<span data-ttu-id="595c2-143">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="595c2-143">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="595c2-144">23</span><span class="sxs-lookup"><span data-stu-id="595c2-144">23</span></span>|<span data-ttu-id="595c2-145">3</span><span class="sxs-lookup"><span data-stu-id="595c2-145">3</span></span>|  
|<span data-ttu-id="595c2-146">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="595c2-146">smalldatetime</span></span>|<span data-ttu-id="595c2-147">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="595c2-147">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="595c2-148">16</span><span class="sxs-lookup"><span data-stu-id="595c2-148">16</span></span>|<span data-ttu-id="595c2-149">0</span><span class="sxs-lookup"><span data-stu-id="595c2-149">0</span></span>|  
|<span data-ttu-id="595c2-150">Дата</span><span class="sxs-lookup"><span data-stu-id="595c2-150">date</span></span>|<span data-ttu-id="595c2-151">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="595c2-151">SQL_TYPE_DATE</span></span>|<span data-ttu-id="595c2-152">10</span><span class="sxs-lookup"><span data-stu-id="595c2-152">10</span></span>|<span data-ttu-id="595c2-153">0</span><span class="sxs-lookup"><span data-stu-id="595c2-153">0</span></span>|  
|<span data-ttu-id="595c2-154">time</span><span class="sxs-lookup"><span data-stu-id="595c2-154">time</span></span>|<span data-ttu-id="595c2-155">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="595c2-155">SQL_SS_TIME2</span></span>|<span data-ttu-id="595c2-156">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="595c2-156">8, 10..16</span></span>|<span data-ttu-id="595c2-157">0..7</span><span class="sxs-lookup"><span data-stu-id="595c2-157">0..7</span></span>|  
|<span data-ttu-id="595c2-158">datetime2</span><span class="sxs-lookup"><span data-stu-id="595c2-158">datetime2</span></span>|<span data-ttu-id="595c2-159">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="595c2-159">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="595c2-160">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="595c2-160">19, 21..27</span></span>|<span data-ttu-id="595c2-161">0..7</span><span class="sxs-lookup"><span data-stu-id="595c2-161">0..7</span></span>|  
|<span data-ttu-id="595c2-162">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="595c2-162">datetimeoffset</span></span>|<span data-ttu-id="595c2-163">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="595c2-163">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="595c2-164">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="595c2-164">26, 28..34</span></span>|<span data-ttu-id="595c2-165">0..7</span><span class="sxs-lookup"><span data-stu-id="595c2-165">0..7</span></span>|  
  
 <span data-ttu-id="595c2-166">Дополнительные сведения см. в разделе [улучшения даты и времени &#40;&#41;ODBC ](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="595c2-166">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="sqldescribeparam-support-for-large-clr-udts"></a><span data-ttu-id="595c2-167">Поддержка в функции SQLDescribeParam определяемых пользователем типов больших данных CLR</span><span class="sxs-lookup"><span data-stu-id="595c2-167">SQLDescribeParam Support for Large CLR UDTs</span></span>  
 <span data-ttu-id="595c2-168">Функция `SQLDescribeParam` поддерживает определяемые пользователем типы больших данных CLR.</span><span class="sxs-lookup"><span data-stu-id="595c2-168">`SQLDescribeParam` supports large CLR user-defined types (UDTs).</span></span> <span data-ttu-id="595c2-169">Дополнительные сведения см. в разделе [большие определяемые пользователем типы данных CLR &#40;&#41;ODBC ](../../relational-databases/native-client/odbc/large-clr-user-defined-types-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="595c2-169">For more information, see [Large CLR User-Defined Types &#40;ODBC&#41;](../../relational-databases/native-client/odbc/large-clr-user-defined-types-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="595c2-170">См. также:</span><span class="sxs-lookup"><span data-stu-id="595c2-170">See Also</span></span>  
 <span data-ttu-id="595c2-171">[Функция SQLDescribeParam](https://go.microsoft.com/fwlink/?LinkId=59339) </span><span class="sxs-lookup"><span data-stu-id="595c2-171">[SQLDescribeParam Function](https://go.microsoft.com/fwlink/?LinkId=59339) </span></span>  
 [<span data-ttu-id="595c2-172">ODBC API Implementation Details</span><span class="sxs-lookup"><span data-stu-id="595c2-172">ODBC API Implementation Details</span></span>](../../relational-databases/native-client-odbc-api/odbc-api-implementation-details.md)  
  
  
