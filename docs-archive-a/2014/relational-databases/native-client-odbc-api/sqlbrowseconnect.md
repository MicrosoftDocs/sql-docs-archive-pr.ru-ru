---
title: SQLBrowseConnect | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLBrowseConnect function
ms.assetid: 57faf388-c7ca-4696-9845-34e0a10cc5f7
author: rothja
ms.author: jroth
ms.openlocfilehash: ca203e02195d72683744aa8dd31d41a81c260ab4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750924"
---
# <a name="sqlbrowseconnect"></a><span data-ttu-id="1ee8d-102">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="1ee8d-102">SQLBrowseConnect</span></span>
  <span data-ttu-id="1ee8d-103">**SQLBrowseConnect** использует ключевые слова, которые можно классифицировать по трем уровням сведений о соединении.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-103">**SQLBrowseConnect** uses keywords that can be categorized into three levels of connection information.</span></span> <span data-ttu-id="1ee8d-104">Для каждого ключевого слова в следующей таблице указано, возвращается ли список допустимых значений и является ли ключевое слово необязательным.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-104">For each keyword, the following table indicates whether a list of valid values is returned and whether the keyword is optional.</span></span>  
  
## <a name="level-1"></a><span data-ttu-id="1ee8d-105">уровне 1</span><span class="sxs-lookup"><span data-stu-id="1ee8d-105">Level 1</span></span>  
  
|<span data-ttu-id="1ee8d-106">Ключевое слово</span><span class="sxs-lookup"><span data-stu-id="1ee8d-106">Keyword</span></span>|<span data-ttu-id="1ee8d-107">Возвращает список?</span><span class="sxs-lookup"><span data-stu-id="1ee8d-107">List returned?</span></span>|<span data-ttu-id="1ee8d-108">Является необязательным?</span><span class="sxs-lookup"><span data-stu-id="1ee8d-108">Optional?</span></span>|<span data-ttu-id="1ee8d-109">Описание</span><span class="sxs-lookup"><span data-stu-id="1ee8d-109">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="1ee8d-110">DSN</span><span class="sxs-lookup"><span data-stu-id="1ee8d-110">DSN</span></span>|<span data-ttu-id="1ee8d-111">Недоступно</span><span class="sxs-lookup"><span data-stu-id="1ee8d-111">N/A</span></span>|<span data-ttu-id="1ee8d-112">Нет</span><span class="sxs-lookup"><span data-stu-id="1ee8d-112">No</span></span>|<span data-ttu-id="1ee8d-113">Имя источника данных, возвращаемого функцией **SQLDataSources**.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-113">Name of the data source returned by **SQLDataSources**.</span></span> <span data-ttu-id="1ee8d-114">Ключевое слово DSN нельзя использовать, если используется ключевое слово DRIVER.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-114">The DSN keyword cannot be used if the DRIVER keyword is used.</span></span>|  
|<span data-ttu-id="1ee8d-115">DRIVER</span><span class="sxs-lookup"><span data-stu-id="1ee8d-115">DRIVER</span></span>|<span data-ttu-id="1ee8d-116">Недоступно</span><span class="sxs-lookup"><span data-stu-id="1ee8d-116">N/A</span></span>|<span data-ttu-id="1ee8d-117">Нет</span><span class="sxs-lookup"><span data-stu-id="1ee8d-117">No</span></span>|<span data-ttu-id="1ee8d-118">Microsoft??</span><span class="sxs-lookup"><span data-stu-id="1ee8d-118">Microsoft??</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="1ee8d-119">Имя драйвера ODBC для собственного клиента: { [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 11}.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-119">Native Client ODBC driver name is {[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 11}.</span></span> <span data-ttu-id="1ee8d-120">Ключевое слово DRIVER нельзя использовать, если используется ключевое слово DSN.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-120">The DRIVER keyword cannot be used if the DSN keyword is used.</span></span>|  
  
## <a name="level-2"></a><span data-ttu-id="1ee8d-121">Уровень 2</span><span class="sxs-lookup"><span data-stu-id="1ee8d-121">Level 2</span></span>  
  
|<span data-ttu-id="1ee8d-122">Ключевое слово</span><span class="sxs-lookup"><span data-stu-id="1ee8d-122">Keyword</span></span>|<span data-ttu-id="1ee8d-123">Возвращает список?</span><span class="sxs-lookup"><span data-stu-id="1ee8d-123">List returned?</span></span>|<span data-ttu-id="1ee8d-124">Является необязательным?</span><span class="sxs-lookup"><span data-stu-id="1ee8d-124">Optional?</span></span>|<span data-ttu-id="1ee8d-125">Описание</span><span class="sxs-lookup"><span data-stu-id="1ee8d-125">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="1ee8d-126">SERVER</span><span class="sxs-lookup"><span data-stu-id="1ee8d-126">SERVER</span></span>|<span data-ttu-id="1ee8d-127">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-127">Yes</span></span>|<span data-ttu-id="1ee8d-128">Нет</span><span class="sxs-lookup"><span data-stu-id="1ee8d-128">No</span></span>|<span data-ttu-id="1ee8d-129">Имя сервера источника данных в сети.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-129">Name of the server on the network on which the data source resides.</span></span> <span data-ttu-id="1ee8d-130">В качестве сервера можно ввести термин «(local)»; в этом случае можно использовать локальную копию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], даже если это не сетевая версия.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-130">The term "(local)" can be entered as the server, in which case a local copy of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be used, even when this is a non-networked version.</span></span>|  
|<span data-ttu-id="1ee8d-131">ИД пользователя</span><span class="sxs-lookup"><span data-stu-id="1ee8d-131">UID</span></span>|<span data-ttu-id="1ee8d-132">Нет</span><span class="sxs-lookup"><span data-stu-id="1ee8d-132">No</span></span>|<span data-ttu-id="1ee8d-133">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-133">Yes</span></span>|<span data-ttu-id="1ee8d-134">Идентификатор входа пользователя.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-134">User login ID.</span></span>|  
|<span data-ttu-id="1ee8d-135">PWD</span><span class="sxs-lookup"><span data-stu-id="1ee8d-135">PWD</span></span>|<span data-ttu-id="1ee8d-136">Нет</span><span class="sxs-lookup"><span data-stu-id="1ee8d-136">No</span></span>|<span data-ttu-id="1ee8d-137">Да (зависит от пользователя)</span><span class="sxs-lookup"><span data-stu-id="1ee8d-137">Yes (depends on the user)</span></span>|<span data-ttu-id="1ee8d-138">Определяемый пользователем пароль.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-138">User-specified password.</span></span>|  
|<span data-ttu-id="1ee8d-139">APP</span><span class="sxs-lookup"><span data-stu-id="1ee8d-139">APP</span></span>|<span data-ttu-id="1ee8d-140">Нет</span><span class="sxs-lookup"><span data-stu-id="1ee8d-140">No</span></span>|<span data-ttu-id="1ee8d-141">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-141">Yes</span></span>|<span data-ttu-id="1ee8d-142">Имя приложения, вызывающего **SQLBrowseConnect**.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-142">Name of the application calling **SQLBrowseConnect**.</span></span>|  
|<span data-ttu-id="1ee8d-143">WSID</span><span class="sxs-lookup"><span data-stu-id="1ee8d-143">WSID</span></span>|<span data-ttu-id="1ee8d-144">Нет</span><span class="sxs-lookup"><span data-stu-id="1ee8d-144">No</span></span>|<span data-ttu-id="1ee8d-145">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-145">Yes</span></span>|<span data-ttu-id="1ee8d-146">Идентификатор рабочей станции.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-146">Workstation ID.</span></span> <span data-ttu-id="1ee8d-147">Обычно это сетевое имя компьютера, на котором работает приложение.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-147">Typically, this is the network name of the computer on which the application runs.</span></span>|  
  
## <a name="level-3"></a><span data-ttu-id="1ee8d-148">Level 3</span><span class="sxs-lookup"><span data-stu-id="1ee8d-148">Level 3</span></span>  
  
|<span data-ttu-id="1ee8d-149">Ключевое слово</span><span class="sxs-lookup"><span data-stu-id="1ee8d-149">Keyword</span></span>|<span data-ttu-id="1ee8d-150">Возвращает список?</span><span class="sxs-lookup"><span data-stu-id="1ee8d-150">List returned?</span></span>|<span data-ttu-id="1ee8d-151">Является необязательным?</span><span class="sxs-lookup"><span data-stu-id="1ee8d-151">Optional?</span></span>|<span data-ttu-id="1ee8d-152">Описание</span><span class="sxs-lookup"><span data-stu-id="1ee8d-152">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="1ee8d-153">DATABASE</span><span class="sxs-lookup"><span data-stu-id="1ee8d-153">DATABASE</span></span>|<span data-ttu-id="1ee8d-154">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-154">Yes</span></span>|<span data-ttu-id="1ee8d-155">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-155">Yes</span></span>|<span data-ttu-id="1ee8d-156">Имя базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ee8d-156">Name of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span>|  
|<span data-ttu-id="1ee8d-157">ЯЗЫК</span><span class="sxs-lookup"><span data-stu-id="1ee8d-157">LANGUAGE</span></span>|<span data-ttu-id="1ee8d-158">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-158">Yes</span></span>|<span data-ttu-id="1ee8d-159">Да</span><span class="sxs-lookup"><span data-stu-id="1ee8d-159">Yes</span></span>|<span data-ttu-id="1ee8d-160">Национальный язык, используемый [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ee8d-160">National language used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
  
 <span data-ttu-id="1ee8d-161">**SQLBrowseConnect** игнорирует значения ключевых слов базы данных и языка, которые хранятся в определениях источников данных ODBC.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-161">**SQLBrowseConnect** ignores the values of the DATABASE and LANGUAGE keywords stored in the ODBC data source definitions.</span></span> <span data-ttu-id="1ee8d-162">Если база данных или язык, указанные в строке соединения, переданной в **SQLBrowseConnect** , являются недопустимыми, **SQLBrowseConnect** возвращает SQL_NEED_DATA и атрибуты подключения уровня 3.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-162">If the database or language specified in the connection string passed to **SQLBrowseConnect** is invalid, **SQLBrowseConnect** returns SQL_NEED_DATA and the level 3 connection attributes.</span></span>  
  
 <span data-ttu-id="1ee8d-163">Следующие атрибуты, которые устанавливаются путем вызова [SQLSetConnectAttr](sqlsetconnectattr.md), определяют результирующий набор, возвращаемый **SQLBrowseConnect**.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-163">The following attributes, which are set by calling [SQLSetConnectAttr](sqlsetconnectattr.md), determine the result set returned by **SQLBrowseConnect**.</span></span>  
  
|<span data-ttu-id="1ee8d-164">attribute</span><span class="sxs-lookup"><span data-stu-id="1ee8d-164">Attribute</span></span>|<span data-ttu-id="1ee8d-165">Описание</span><span class="sxs-lookup"><span data-stu-id="1ee8d-165">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="1ee8d-166">SQL_COPT_SS_BROWSE_CONNECT</span><span class="sxs-lookup"><span data-stu-id="1ee8d-166">SQL_COPT_SS_BROWSE_CONNECT</span></span>|<span data-ttu-id="1ee8d-167">Если задано значение SQL_MORE_INFO_YES, **SQLBrowseConnect** возвращает расширенную строку свойств сервера.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-167">If it is set to SQL_MORE_INFO_YES, **SQLBrowseConnect** returns an extended string of server properties.</span></span><br /><br /> <span data-ttu-id="1ee8d-168">Ниже приведен пример расширенной строки, возвращаемой функцией **SQLBrowseConnect**: ServerName\InstanceName; Кластеризованный: нет; Версия: 8.00.131</span><span class="sxs-lookup"><span data-stu-id="1ee8d-168">The following is an example of an extended string returned by **SQLBrowseConnect**:ServerName\InstanceName;Clustered:No;Version:8.00.131</span></span><br /><br /> <span data-ttu-id="1ee8d-169">В этой строке различные порции данных о сервере разделяются точками с запятой.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-169">In this string, semi-colons separate various pieces of information about the server.</span></span> <span data-ttu-id="1ee8d-170">Для разделения различных экземпляров сервера используйте запятые.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-170">Use commas to separate different server instances.</span></span>|  
|<span data-ttu-id="1ee8d-171">SQL_COPT_SS_BROWSE_SERVER</span><span class="sxs-lookup"><span data-stu-id="1ee8d-171">SQL_COPT_SS_BROWSE_SERVER</span></span>|<span data-ttu-id="1ee8d-172">Если указано имя сервера, **SQLBrowseConnect** возвратит сведения для указанного сервера.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-172">If a server name is specified, **SQLBrowseConnect** will return information for the server specified.</span></span> <span data-ttu-id="1ee8d-173">Если SQL_COPT_SS_BROWSE_SERVER имеет значение NULL, **SQLBrowseConnect** возвращает сведения обо всех серверах в домене.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-173">If SQL_COPT_SS_BROWSE_SERVER is set to NULL, **SQLBrowseConnect** returns information for all servers in the domain.</span></span><br /><br /> <span data-ttu-id="1ee8d-174">Из-за проблем в сети **SQLBrowseConnect** может не получить своевременный ответ от всех серверов.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-174">Due to network issues, **SQLBrowseConnect** might not receive a timely response from all servers.</span></span> <span data-ttu-id="1ee8d-175">Поэтому возвращаемый список серверов может отличаться от запроса к запросу.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-175">Therefore, the list of servers returned can vary for each request.</span></span>|  
|<span data-ttu-id="1ee8d-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span><span class="sxs-lookup"><span data-stu-id="1ee8d-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span></span>|<span data-ttu-id="1ee8d-177">Если атрибут SQL_COPT_SS_BROWSE_CACHE_DATA имеет значение SQL_CACHE_DATA_YES, то в случае, когда длина буфера недостаточна для размещения результата, можно получать данные фрагментами.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-177">When the SQL_COPT_SS_BROWSE_CACHE_DATA attribute is set to SQL_CACHE_DATA_YES, you can fetch data in chunks when the buffer length is not large enough to hold the result.</span></span> <span data-ttu-id="1ee8d-178">Эта длина указывается в аргументе BufferLength для SQLBrowseConnect.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-178">This length is specified in the BufferLength argument to SQLBrowseConnect.</span></span><br /><br /> <span data-ttu-id="1ee8d-179">Если доступны дополнительные данные, возвращается значение SQL_NEED_DATA.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-179">SQL_NEED_DATA is returned when more data is available.</span></span> <span data-ttu-id="1ee8d-180">Если нет неполученных данных, возвращается значение SQL_SUCCESS.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-180">SQL_SUCCESS is returned when there is no more data to retrieve.</span></span><br /><br /> <span data-ttu-id="1ee8d-181">По умолчанию задано значение SQL_CACHE_DATA_NO.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-181">The default is SQL_CACHE_DATA_NO.</span></span>|  
  
## <a name="sqlbrowseconnect-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="1ee8d-182">Поддержка высокого уровня доступности и аварийного восстановления SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="1ee8d-182">SQLBrowseConnect Support for High Availability, Disaster Recovery</span></span>  
 <span data-ttu-id="1ee8d-183">Дополнительные сведения об использовании **SQLBrowseConnect** для подключения к [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] кластеру см. в разделе [Поддержка высокой доступности и аварийного восстановления в SQL Server Native Client](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="1ee8d-183">For more information on using **SQLBrowseConnect** to connect to an [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] cluster, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
## <a name="sqlbrowseconnect-support-for-service-principal-names-spns"></a><span data-ttu-id="1ee8d-184">Поддержка функции SQLBrowseConnect для имен участников-служб</span><span class="sxs-lookup"><span data-stu-id="1ee8d-184">SQLBrowseConnect Support for Service Principal Names (SPNs)</span></span>  
 <span data-ttu-id="1ee8d-185">При открытии соединения собственный клиент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] задает SQL_COPT_SS_MUTUALLY_AUTHENTICATED и SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD метод проверки подлинности, используемый для открытия соединения.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-185">When a connection is opened, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client sets SQL_COPT_SS_MUTUALLY_AUTHENTICATED and SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD to the authentication method used to open the connection.</span></span>  
  
 <span data-ttu-id="1ee8d-186">Дополнительные сведения о SPN см. [в статье имена субъектов-служб &#40;имен участников-служб&#41; в клиентских подключениях &#40;&#41;ODBC ](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="1ee8d-186">For more information about SPNs, see [Service Principal Names &#40;SPNs&#41; in Client Connections &#40;ODBC&#41;](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md).</span></span>  
  
## <a name="change-history"></a><span data-ttu-id="1ee8d-187">Журнал изменений</span><span class="sxs-lookup"><span data-stu-id="1ee8d-187">Change History</span></span>  
  
|<span data-ttu-id="1ee8d-188">Обновленное содержимое</span><span class="sxs-lookup"><span data-stu-id="1ee8d-188">Updated content</span></span>|  
|---------------------|  
|<span data-ttu-id="1ee8d-189">Добавлена документация по SQL_COPT_SS_BROWSE_CACHE_DATA.</span><span class="sxs-lookup"><span data-stu-id="1ee8d-189">Documented SQL_COPT_SS_BROWSE_CACHE_DATA.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="1ee8d-190">См. также:</span><span class="sxs-lookup"><span data-stu-id="1ee8d-190">See Also</span></span>  
 <span data-ttu-id="1ee8d-191">[Функция SQLBrowseConnect](https://go.microsoft.com/fwlink/?LinkId=59329) </span><span class="sxs-lookup"><span data-stu-id="1ee8d-191">[SQLBrowseConnect Function](https://go.microsoft.com/fwlink/?LinkId=59329) </span></span>  
 [<span data-ttu-id="1ee8d-192">ODBC API Implementation Details</span><span class="sxs-lookup"><span data-stu-id="1ee8d-192">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
