---
title: Поддержка типов параметров OLE DB, возвращающих табличные значения (методы) | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (OLE DB), API support (methods)
ms.assetid: e3c2a450-8fd4-44cb-93d8-affe1b65c68e
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c7ca5946228ea05708984fb89ebc603061d983d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87657741"
---
# <a name="ole-db-table-valued-parameter-type-support-methods"></a><span data-ttu-id="e6403-102">Поддержка типов параметров OLE DB, возвращающих табличное значение (методы)</span><span class="sxs-lookup"><span data-stu-id="e6403-102">OLE DB Table-Valued Parameter Type Support (Methods)</span></span>
  <span data-ttu-id="e6403-103">Следующие стандартные методы OLE DB поддерживают возвращающие табличные значения параметры.</span><span class="sxs-lookup"><span data-stu-id="e6403-103">The following standard OLE DB methods support table-valued parameters:</span></span>  
  
|<span data-ttu-id="e6403-104">Метод</span><span class="sxs-lookup"><span data-stu-id="e6403-104">Method</span></span>|<span data-ttu-id="e6403-105">Поддержка возвращающих табличные значения параметров</span><span class="sxs-lookup"><span data-stu-id="e6403-105">Table-valued parameter support</span></span>|  
|------------|-------------------------------------|  
|<span data-ttu-id="e6403-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span><span class="sxs-lookup"><span data-stu-id="e6403-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span></span>|<span data-ttu-id="e6403-107">Используется при наличии сведений о типе возвращающего табличное значение параметра и необходимости создания экземпляра объекта набора строк возвращающего табличное значение параметра на основе сведений о типе.</span><span class="sxs-lookup"><span data-stu-id="e6403-107">Used when you know type information of table-valued parameter, and want to instantiate a table-valued parameter rowset object based on the type-information.</span></span><br /><br /> <span data-ttu-id="e6403-108">Дополнительные сведения вы найдете в разделе "Статический сценарий" статьи [о создании набора строк для возвращающего табличные значения параметра](table-valued-parameter-rowset-creation.md).</span><span class="sxs-lookup"><span data-stu-id="e6403-108">For more information, see "Static Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="e6403-109">IOpenRowset::OpenRowset</span><span class="sxs-lookup"><span data-stu-id="e6403-109">IOpenRowset::OpenRowset</span></span>|<span data-ttu-id="e6403-110">Используется при отсутствии сведений о типе возвращающего табличное значение параметра и необходимости создания экземпляра объекта набора строк возвращающего табличное значение параметра на основе метаданных, полученных от сервера.</span><span class="sxs-lookup"><span data-stu-id="e6403-110">Used when you do not know the type information of a table-valued parameter, and want to instantiate a table-valued parameter rowset object based on metadata information retrieved from the server.</span></span><br /><br /> <span data-ttu-id="e6403-111">Дополнительные сведения вы найдете в разделе "Динамический сценарий" статьи [о создании набора строк для возвращающего табличные значения параметра](table-valued-parameter-rowset-creation.md).</span><span class="sxs-lookup"><span data-stu-id="e6403-111">For more information, see "Dynamic Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="e6403-112">ISSCommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="e6403-112">ISSCommandWithParameters::SetParameterInfo</span></span>|<span data-ttu-id="e6403-113">Для указания возвращающего табличное значение параметра команды потребитель указывает тип параметра "table" или "DBTYPE_TABLE" в элементе *pwszName* структуры DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="e6403-113">To specify a table-valued parameter command parameter, the consumer specifies the type of the parameter as "table" or "DBTYPE_TABLE" in the *pwszName* member of DBPARAMBINDINFO structure.</span></span> <span data-ttu-id="e6403-114">*ulParamSize* имеет значение ~0.</span><span class="sxs-lookup"><span data-stu-id="e6403-114">The *ulParamSize* is set to ~0.</span></span> <span data-ttu-id="e6403-115">Дополнительные сведения см. в разделе "Спецификация возвращающих табличные значения параметров" статьи [о выполнении команд с возвращающим табличные значения параметром](executing-commands-containing-table-valued-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="e6403-115">For more information, see "Table-Valued Parameter Specification" in [Executing Commands Containing Table-Valued Parameters](executing-commands-containing-table-valued-parameters.md).</span></span>|  
|<span data-ttu-id="e6403-116">ISSCommandWithParameters::SetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="e6403-116">ISSCommandWithParameters::SetParameterProperties</span></span>|<span data-ttu-id="e6403-117">Задает свойства, определенные для возвращающих табличные значения параметров, например имя схемы, имя типа, порядок столбца и столбцы по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e6403-117">Sets properties specific to table-valued parameters, such as schema name, type name, column order, and default columns.</span></span><br /><br /> <span data-ttu-id="e6403-118">Потребитель указывает порядковый номер параметра в элементе *iOrdinal* структуры SSPARAMPROPS.</span><span class="sxs-lookup"><span data-stu-id="e6403-118">The consumer specifies the ordinal of the parameter in the *iOrdinal* of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="e6403-119">Запрошенный набор свойств — DBPROPSET_SQLSERVERPARAMETER.</span><span class="sxs-lookup"><span data-stu-id="e6403-119">The property set requested is DBPROPSET_SQLSERVERPARAMETER.</span></span>|  
|<span data-ttu-id="e6403-120">ISSCommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="e6403-120">ISSCommandWithParameters::GetParameterInfo</span></span>|<span data-ttu-id="e6403-121">Возвращает типы всех параметров в указанную команду.</span><span class="sxs-lookup"><span data-stu-id="e6403-121">Gets the types of all the parameters to a specified command.</span></span><br /><br /> <span data-ttu-id="e6403-122">Для возвращающих табличные значения параметров поле *wType* в структуре DBPARAMINFO будет иметь тип DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="e6403-122">For table-valued parameters, the *wType* field in DBPARAMINFO structure will have type DBTYPE_TABLE.</span></span> <span data-ttu-id="e6403-123">Для определения неизвестной длины поле *ulParamSize* будет установлено в значение ~0.</span><span class="sxs-lookup"><span data-stu-id="e6403-123">The *ulParamSize* field will be set to ~0 to indicate unknown length.</span></span>|  
|<span data-ttu-id="e6403-124">ISSCommandWithParameters::GetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="e6403-124">ISSCommandWithParameters::GetParameterProperties</span></span>|<span data-ttu-id="e6403-125">Возвращает дополнительные сведения о типе для параметров типа DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="e6403-125">Gets additional type information for parameters of the DBTYPE_TABLE type.</span></span><br /><br /> <span data-ttu-id="e6403-126">Потребитель указывает порядковый номер параметра в элементе *iOrdinal* структуры SSPARAMPROPS.</span><span class="sxs-lookup"><span data-stu-id="e6403-126">The consumer specifies the ordinal of the parameter in the *iOrdinal* member of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="e6403-127">Потребитель может запросить любое свойство из набора свойств DBPROPSET_SQLSERVERPARAMETER, которые перечислены в ISSCommandWithParameters::SetParameterProperties.</span><span class="sxs-lookup"><span data-stu-id="e6403-127">The consumer can request any of the properties in the DBPROPSET_SQLSERVERPARAMETER property set that are listed under ISSCommandWithParameters::SetParameterProperties.</span></span><br /><br /> <span data-ttu-id="e6403-128">Поскольку потребителю неизвестен тип возвращающего табличное значение параметра, поставщик должен установить правильные значения свойств SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME и SSPROP_PARAM_TYPE_CATALOGNAME.</span><span class="sxs-lookup"><span data-stu-id="e6403-128">Because the consumer does not know the table-valued parameter type, the provider must set the SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME, and SSPROP_PARAM_TYPE_CATALOGNAME to their correct values.</span></span> <span data-ttu-id="e6403-129">Оставшиеся свойства, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS и SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, сохранят значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e6403-129">The remaining properties, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS and SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, will have their default values.</span></span> <span data-ttu-id="e6403-130">После обнаружения потребителем имени типа возвращающего табличное значение параметра он использует метод IOpenRowset::OpenRowset для создания экземпляра этого параметра, указав имя его типа.</span><span class="sxs-lookup"><span data-stu-id="e6403-130">After the consumer has discovered the table-valued parameter type name, it uses IOpenRowset::OpenRowset to create an instance of this table-valued parameter, specifying the name of table-valued parameter type.</span></span> <span data-ttu-id="e6403-131">Дополнительные сведения см. в статье [Обнаружение типа возвращающего табличное значение параметра](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span><span class="sxs-lookup"><span data-stu-id="e6403-131">For more information, see [Table-Valued Parameter Type Discovery](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span></span>|  
|<span data-ttu-id="e6403-132">IRowsetInfo::GetProperties</span><span class="sxs-lookup"><span data-stu-id="e6403-132">IRowsetInfo::GetProperties</span></span>|<span data-ttu-id="e6403-133">Возвращает свойства набора строк возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="e6403-133">Gets table-valued parameter rowset properties.</span></span> <span data-ttu-id="e6403-134">Потребитель может использовать эти параметры для оптимальной установки привязок.</span><span class="sxs-lookup"><span data-stu-id="e6403-134">The consumer can use these properties to optimally set up bindings.</span></span>|  
|<span data-ttu-id="e6403-135">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="e6403-135">IColumnsRowset::GetColumnsRowset</span></span>|<span data-ttu-id="e6403-136">Получает метаданные о таблице [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e6403-136">Retrieves metadata information about a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="e6403-137">Для возвращающих табличные значения параметров этот же интерфейс предоставляет подробные метаданные о каждом столбце, например:</span><span class="sxs-lookup"><span data-stu-id="e6403-137">For table-valued parameters, this same interface provides detailed metadata information about each column, such as the following:</span></span><br /><br /> <span data-ttu-id="e6403-138">-DBCOLUMN_FLAGS указывает допустимость значения NULL через DBCOLUMNFLAGS_ISNULLABLE бит.</span><span class="sxs-lookup"><span data-stu-id="e6403-138">-   DBCOLUMN_FLAGS indicates nullability through the DBCOLUMNFLAGS_ISNULLABLE bit.</span></span><br /><span data-ttu-id="e6403-139">-DBCOLUMN_ISUNIQUE указывает, является ли столбец столбцом идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="e6403-139">-   DBCOLUMN_ISUNIQUE indicates whether the column is an identity column.</span></span><br /><span data-ttu-id="e6403-140">-DBCOLUMN_COMPUTEMODE указывает, является ли столбец вычисляемым.</span><span class="sxs-lookup"><span data-stu-id="e6403-140">-   DBCOLUMN_COMPUTEMODE indicates whether the column is computed.</span></span>|  
|<span data-ttu-id="e6403-141">IAccessor::CreateAccessor</span><span class="sxs-lookup"><span data-stu-id="e6403-141">IAccessor::CreateAccessor</span></span>|<span data-ttu-id="e6403-142">Для привязки объекта набора строк возвращающего табличное значение параметра создается метод доступа с элементом *wType*, установленным в значение DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="e6403-142">To bind a table-valued parameter rowset object to a command parameter, you create an accessor with its *wType* member set to DBTYPE_TABLE.</span></span> <span data-ttu-id="e6403-143">Структура DBOBJECT будет содержать IID_IRowset или любой другой допустимый интерфейс объекта набора строк в элементе *iid*.</span><span class="sxs-lookup"><span data-stu-id="e6403-143">The DBOBJECT structure will contain IID_IRowset or any other valid rowset object interface in the *iid* member.</span></span> <span data-ttu-id="e6403-144">Оставшиеся поля обрабатываются тем же способом, как и DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="e6403-144">The rest of the fields are treated similarly to DBTYPE_IUNKNOWN.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e6403-145">См. также:</span><span class="sxs-lookup"><span data-stu-id="e6403-145">See Also</span></span>  
 <span data-ttu-id="e6403-146">[Поддержка типа возвращающего табличное значение параметра OLE DB](ole-db-table-valued-parameter-type-support.md) </span><span class="sxs-lookup"><span data-stu-id="e6403-146">[OLE DB Table-Valued Parameter Type Support](ole-db-table-valued-parameter-type-support.md) </span></span>  
 <span data-ttu-id="e6403-147">[Создание набора строк возвращающего табличное значение параметра](table-valued-parameter-rowset-creation.md) </span><span class="sxs-lookup"><span data-stu-id="e6403-147">[Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md) </span></span>  
 [<span data-ttu-id="e6403-148">Использование возвращающих табличные значения параметров &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="e6403-148">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](table-valued-parameters-ole-db.md)  
  
  
