---
title: ISSAsynchStatus::GetStatus (OLE DB) | Документация Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- ISSAsynchStatus::GetStatus (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- GetStatus method
ms.assetid: 354b6ee4-b5a1-48f6-9403-da3bdc911067
author: rothja
ms.author: jroth
ms.openlocfilehash: 14c20ae5d9a5cd31139db74aeedabb2d017f6ce6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656384"
---
# <a name="issasynchstatusgetstatus-ole-db"></a><span data-ttu-id="9cc50-102">Функция ISSAsynchStatus::GetStatus (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="9cc50-102">ISSAsynchStatus::GetStatus (OLE DB)</span></span>
  <span data-ttu-id="9cc50-103">Возвращает состояние операции асинхронного выполнения.</span><span class="sxs-lookup"><span data-stu-id="9cc50-103">Returns the status of an asynchronously executing operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="9cc50-104">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="9cc50-104">Syntax</span></span>  
  
```  
  
HRESULT GetStatus(  
  HCHAPTER hChapter,  
  DBASYNCHOP eOperation,  
  DBCOUNTITEM *pulProgress,  
  DBCOUNTITEM *pulProgressMax,  
  DBASYNCHPHASE *peAsynchPhase,  
  LPOLESTR *ppwszStatusText);  
```  
  
## <a name="arguments"></a><span data-ttu-id="9cc50-105">Аргументы</span><span class="sxs-lookup"><span data-stu-id="9cc50-105">Arguments</span></span>  
 <span data-ttu-id="9cc50-106">*hChapter*[in]</span><span class="sxs-lookup"><span data-stu-id="9cc50-106">*hChapter*[in]</span></span>  
 <span data-ttu-id="9cc50-107">Дескриптор главы.</span><span class="sxs-lookup"><span data-stu-id="9cc50-107">The chapter handle.</span></span> <span data-ttu-id="9cc50-108">Если опрашиваемый объект не является объектом набора строк или операция не применяется к разделу, ему следует установить значение DB_NULL_HCHAPTER, которое не учитываются поставщиком.</span><span class="sxs-lookup"><span data-stu-id="9cc50-108">If the object being polled is not a rowset object or the operation does not apply to a chapter, this should be set to DB_NULL_HCHAPTER, which is ignored by the provider.</span></span>  
  
 <span data-ttu-id="9cc50-109">*eOperation*[in]</span><span class="sxs-lookup"><span data-stu-id="9cc50-109">*eOperation*[in]</span></span>  
 <span data-ttu-id="9cc50-110">Операция, для которой запрашивается асинхронное состояние.</span><span class="sxs-lookup"><span data-stu-id="9cc50-110">The operation for which the asynchronous status is being requested.</span></span> <span data-ttu-id="9cc50-111">Это должно быть следующее значение.</span><span class="sxs-lookup"><span data-stu-id="9cc50-111">This should be the following value:</span></span>  
  
 <span data-ttu-id="9cc50-112">DBASYNCHOP_OPEN — пользователь запрашивает сведения об асинхронном открытии или заполнении набора строк, или асинхронной инициализации объекта источника данных.</span><span class="sxs-lookup"><span data-stu-id="9cc50-112">DBASYNCHOP_OPEN-The consumer requests information about the asynchronous opening or population of a rowset or about the asynchronous initialization of a data source object.</span></span> <span data-ttu-id="9cc50-113">Если поставщик соответствует OLE DB 2.5 и поддерживает прямую привязку URL-адресов, то потребитель запрашивает сведения об асинхронной инициализации или заполнении объекта источника данных, набора строк, строки или потока.</span><span class="sxs-lookup"><span data-stu-id="9cc50-113">If the provider is an OLE DB 2.5-compliant provider that supports direct URL binding, the consumer requests information about the asynchronous initialization or population of a data source, rowset, row, or stream object.</span></span>  
  
 <span data-ttu-id="9cc50-114">*pulProgress*[out]</span><span class="sxs-lookup"><span data-stu-id="9cc50-114">*pulProgress*[out]</span></span>  
 <span data-ttu-id="9cc50-115">Указатель на буфер, в который будет возвращаться текущий ход выполнения асинхронной операции относительно ожидаемого максимума, указанного в параметре *pulProgressMax* .</span><span class="sxs-lookup"><span data-stu-id="9cc50-115">A pointer to memory in which to return the current progress of the asynchronous operation relative to the expected maximum indicated in the *pulProgressMax* parameter.</span></span> <span data-ttu-id="9cc50-116">Дополнительные сведения о значении параметра *pulProgress*см. в описании параметра *peAsynchPhase*.</span><span class="sxs-lookup"><span data-stu-id="9cc50-116">For more information about the meaning of *pulProgress*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="9cc50-117">Если *pulProgress* является указателем NULL, ход выполнения не возвращается.</span><span class="sxs-lookup"><span data-stu-id="9cc50-117">If *pulProgress* is a null pointer, no progress is returned.</span></span>  
  
 <span data-ttu-id="9cc50-118">*pulProgressMax*[out]</span><span class="sxs-lookup"><span data-stu-id="9cc50-118">*pulProgressMax*[out]</span></span>  
 <span data-ttu-id="9cc50-119">Указатель на буфер, в который будет возвращено ожидаемое максимальное значение параметра *pulProgress* .</span><span class="sxs-lookup"><span data-stu-id="9cc50-119">A pointer to memory in which to return the expected maximum value of the *pulProgress* parameter.</span></span> <span data-ttu-id="9cc50-120">С каждым вызовом этого метода это значение может изменяться.</span><span class="sxs-lookup"><span data-stu-id="9cc50-120">This value may change across calls to this method.</span></span> <span data-ttu-id="9cc50-121">Дополнительные сведения о значении параметра *pulProgressMax*см. в описании параметра *peAsynchPhase*.</span><span class="sxs-lookup"><span data-stu-id="9cc50-121">For more information about the meaning of *pulProgressMax*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="9cc50-122">Если *pulProgressMax* является указателем NULL, ожидаемое максимальное значение возвращено не будет.</span><span class="sxs-lookup"><span data-stu-id="9cc50-122">If *pulProgressMax* is a null pointer, no expected maximum value is returned.</span></span>  
  
 <span data-ttu-id="9cc50-123">*peAsynchPhase*[out]</span><span class="sxs-lookup"><span data-stu-id="9cc50-123">*peAsynchPhase*[out]</span></span>  
 <span data-ttu-id="9cc50-124">Указатель на буфер, в который будут возвращены дополнительные сведения о ходе выполнения асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="9cc50-124">A pointer to memory in which to return additional information regarding the progress of the asynchronous operation.</span></span> <span data-ttu-id="9cc50-125">Допустимые значения:</span><span class="sxs-lookup"><span data-stu-id="9cc50-125">Valid values include:</span></span>  
  
 <span data-ttu-id="9cc50-126">DBASYNCHPHASE_INITIALIZATION — объект находится в стадии инициализации.</span><span class="sxs-lookup"><span data-stu-id="9cc50-126">DBASYNCHPHASE_INITIALIZATION-The object is in an initialization phase.</span></span> <span data-ttu-id="9cc50-127">Аргументы *pulProgress* и *pulProgressMax* указывают примерный процент выполнения.</span><span class="sxs-lookup"><span data-stu-id="9cc50-127">The arguments *pulProgress* and *pulProgressMax* indicate an estimated ratio of completion.</span></span> <span data-ttu-id="9cc50-128">Объект еще полностью не материализован.</span><span class="sxs-lookup"><span data-stu-id="9cc50-128">The object is not yet fully materialized.</span></span> <span data-ttu-id="9cc50-129">Попытка вызова любых других интерфейсов может завершиться неудачей, а полный набор интерфейсов может быть недоступен для данного объекта.</span><span class="sxs-lookup"><span data-stu-id="9cc50-129">Attempting to call any other interfaces may fail, and the full set of interfaces may not be available on the object.</span></span> <span data-ttu-id="9cc50-130">Если асинхронная операция была результатом вызова метода **ICommand::Execute** для команды, которая обновляет, удаляет или вставляет строки, а также если значение параметра *cParamSets* больше 1, то параметры *pulProgress* и *pulProgressMax* могут указывать ход выполнения для единого набора параметров или для полного массива наборов параметров.</span><span class="sxs-lookup"><span data-stu-id="9cc50-130">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows and if *cParamSets* is greater than 1, *pulProgress* and *pulProgressMax* may indicate the progress for a single set of parameters or for the full array of parameter sets.</span></span>  
  
 <span data-ttu-id="9cc50-131">DBASYNCHPHASE_POPULATION — объект находится в стадии заполнения.</span><span class="sxs-lookup"><span data-stu-id="9cc50-131">DBASYNCHPHASE_POPULATION-The object is in a population phase.</span></span> <span data-ttu-id="9cc50-132">Несмотря на то что набор строк полностью инициализирован, а объекту доступен полный диапазон интерфейсов, в наборе строк могут быть дополнительные, еще не заполненные строки.</span><span class="sxs-lookup"><span data-stu-id="9cc50-132">Although the rowset is fully initialized and the full range of interfaces is available on the object, there may be additional rows not yet populated into the rowset.</span></span> <span data-ttu-id="9cc50-133">И хотя параметры *pulProgress* и *pulProgressMax* могут быть основаны на числе заполненных строк, обычно в их основе лежит время или действие, которое необходимо, чтобы заполнить набор строк.</span><span class="sxs-lookup"><span data-stu-id="9cc50-133">While *pulProgress* and *pulProgressMax* can be based on the number of rows populated, they are generally based on the time or effort required to populate the rowset.</span></span> <span data-ttu-id="9cc50-134">Поэтому вызывающий должен использовать эти сведения в качестве приблизительной оценки того, сколько времени может быть затрачено на выполнение процесса, а не в качестве эквивалента счетчика строк.</span><span class="sxs-lookup"><span data-stu-id="9cc50-134">A caller should therefore use this information as a rough estimate of how long the process might take, not the eventual row count.</span></span> <span data-ttu-id="9cc50-135">Эта стадия возвращается только во время заполнения набора строк. Она никогда не возвращается при инициализации объекта источника данных или выполнении команды, которая обновляет, удаляет или вставляет строки.</span><span class="sxs-lookup"><span data-stu-id="9cc50-135">This phase is returned only during population of a rowset; it is never returned in the initialization of a data source object or by the execution of a command that updates, deletes, or inserts rows.</span></span>  
  
 <span data-ttu-id="9cc50-136">DBASYNCHPHASE_COMPLETE — вся асинхронная обработка объекта завершена.</span><span class="sxs-lookup"><span data-stu-id="9cc50-136">DBASYNCHPHASE_COMPLETE-All asynchronous processing of the object has completed.</span></span> <span data-ttu-id="9cc50-137">Метод**ISSAsynchStatus::GetStatus** возвращает значение HRESULT, указывающее результат операции.</span><span class="sxs-lookup"><span data-stu-id="9cc50-137">**ISSAsynchStatus::GetStatus** returns an HRESULT indicating the outcome of the operation.</span></span> <span data-ttu-id="9cc50-138">Обычно возвращается значение HRESULT, которое было бы возвращено, если бы операция была вызвана синхронно.</span><span class="sxs-lookup"><span data-stu-id="9cc50-138">Typically, this will be the HRESULT that would have been returned had the operation been called synchronously.</span></span> <span data-ttu-id="9cc50-139">Если асинхронная операция была результатом вызова метода **ICommand::Execute** для команды, которая обновляет, удаляет и вставляет строки, параметры *pulProgress* и *pulProgressMax* равняются общему числу строк, затронутых этой командой.</span><span class="sxs-lookup"><span data-stu-id="9cc50-139">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* and *pulProgressMax* are equal to the total number of rows affected by the command.</span></span> <span data-ttu-id="9cc50-140">Если значение параметра *cParamSets* больше 1, то это общее число строк, затронутых всеми наборами параметров, указанных в этом выполнении.</span><span class="sxs-lookup"><span data-stu-id="9cc50-140">If *cParamSets* is greater than 1, this is the total number of rows affected by all of the sets of parameters specified in the execution.</span></span> <span data-ttu-id="9cc50-141">Если *peAsynchPhase* является указателем NULL, код состояния возвращен не будет.</span><span class="sxs-lookup"><span data-stu-id="9cc50-141">If *peAsynchPhase* is a null pointer, no status code is returned.</span></span>  
  
 <span data-ttu-id="9cc50-142">DBASYNCHPHASE_CANCELED — асинхронная обработка объекта была прервана.</span><span class="sxs-lookup"><span data-stu-id="9cc50-142">DBASYNCHPHASE_CANCELED-Asynchronous processing of the object was aborted.</span></span> <span data-ttu-id="9cc50-143">Метод**ISSAsynchStatus::GetStatus** возвращает значение DB_E_CANCELED.</span><span class="sxs-lookup"><span data-stu-id="9cc50-143">**ISSAsynchStatus::GetStatus** returns DB_E_CANCELED.</span></span> <span data-ttu-id="9cc50-144">Если асинхронная операция была результатом вызова метода **ICommand::Execute** для команды, которая обновляет, удаляет и вставляет строки, параметр *pulProgress* равняется общему числу строк для всех наборов параметров, затронутых этой командой до ее отмены.</span><span class="sxs-lookup"><span data-stu-id="9cc50-144">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* is equal to the total number of rows, for all parameter sets, affected by the command prior to cancellation.</span></span>  
  
 <span data-ttu-id="9cc50-145">*ppwszStatusText*[in/out]</span><span class="sxs-lookup"><span data-stu-id="9cc50-145">*ppwszStatusText*[in/out]</span></span>  
 <span data-ttu-id="9cc50-146">Указатель на буфер, содержащий дополнительные сведения об операции.</span><span class="sxs-lookup"><span data-stu-id="9cc50-146">A pointer to memory containing additional information about the operation.</span></span> <span data-ttu-id="9cc50-147">Поставщик может использовать это значение, чтобы отличать разные элементы операции, например разные ресурсы, к которым осуществляется доступ.</span><span class="sxs-lookup"><span data-stu-id="9cc50-147">A provider may use this value to distinguish between different elements of an operation-for example, different resources being accessed.</span></span> <span data-ttu-id="9cc50-148">Эта строка локализуется в соответствии со свойством DBPROP_INIT_LCID объекта источника данных.</span><span class="sxs-lookup"><span data-stu-id="9cc50-148">This string is localized according to the DBPROP_INIT_LCID property on the data source object.</span></span>  
  
 <span data-ttu-id="9cc50-149">Если на входе значение параметра *ppwszStatusText* не равно NULL, поставщик возвращает состояние, ассоциированное с конкретным элементом, указанным параметром *ppwszStatusText*.</span><span class="sxs-lookup"><span data-stu-id="9cc50-149">If *ppwszStatusText* is non-null on input, the provider returns status associated with the particular element identified by *ppwszStatusText*.</span></span> <span data-ttu-id="9cc50-150">Если параметр *ppwszStatusText* не указывает элемент параметра *eOperation*, поставщик возвращает S_OK с параметрами *pulProgress* и *pulProgressMax* , которым задано такое же значение.</span><span class="sxs-lookup"><span data-stu-id="9cc50-150">If *ppwszStatusText* does not indicate an element of *eOperation*, the provider returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="9cc50-151">Если поставщик не различает элементы по текстовому идентификатору, то он устанавливает параметру *ppwszStatusText* значение NULL и возвращает сведения об операции в целом; в противном случае, если значение параметра *ppwszStatusText* на входе не равно NULL, поставщик не изменяет параметр *ppwszStatusText* .</span><span class="sxs-lookup"><span data-stu-id="9cc50-151">If the provider does not distinguish between elements based on a textual identifier, it sets *ppwszStatusText* to NULL and returns information about the operation as a whole; otherwise, if *ppwszStatusText* is non-null on input, the provider leaves *ppwszStatusText* untouched.</span></span>  
  
 <span data-ttu-id="9cc50-152">Если значение параметра *ppwszStatusText* на входе равно NULL, то поставщик устанавливает параметру *ppwszStatusText* значение, указывающее больший объем сведений об операции, либо значение NULL, если такие сведения недоступны или если метод **ISSAsynchStatus::GetStatus** возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="9cc50-152">If *ppwszStatusText* is null on input, the provider sets *ppwszStatusText* to a value indicating more information about the operation, or to NULL if no such information is available or if **ISSAsynchStatus::GetStatus** returns an error.</span></span> <span data-ttu-id="9cc50-153">Когда значение параметра *ppwszStatusText* на входе равно NULL, поставщик выделяет память для строки состояния и возвращает адрес этой памяти.</span><span class="sxs-lookup"><span data-stu-id="9cc50-153">When *ppwszStatusText* is null on input, the provider allocates memory for the status string and returns the address to this memory.</span></span> <span data-ttu-id="9cc50-154">Поставщик высвобождает эту память с помощью метода **IMalloc::Free** , когда ему больше не нужна данная строка.</span><span class="sxs-lookup"><span data-stu-id="9cc50-154">The consumer releases this memory with **IMalloc::Free** when it no longer needs the string.</span></span>  
  
 <span data-ttu-id="9cc50-155">Если значение параметра *ppwszStatusText* на входе равно NULL, строка состояния не возвращается, а поставщик возвращает сведения о любом элементе операции либо об операции в целом.</span><span class="sxs-lookup"><span data-stu-id="9cc50-155">If *ppwszStatusText* is NULL on input, no status string is returned and the provider returns information about any element of the operation or about the operation in general.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="9cc50-156">Значения кода возврата</span><span class="sxs-lookup"><span data-stu-id="9cc50-156">Return Code Values</span></span>  
 <span data-ttu-id="9cc50-157">S_OK</span><span class="sxs-lookup"><span data-stu-id="9cc50-157">S_OK</span></span>  
 <span data-ttu-id="9cc50-158">Метод возвратился успешно.</span><span class="sxs-lookup"><span data-stu-id="9cc50-158">The method returned successfully.</span></span>  
  
-   <span data-ttu-id="9cc50-159">Если значение параметра *peAsynchPhase* равно DBASYNCHPHASE_INITIALIZATION, объект еще не полностью инициализирован. Попытка вызвать любые другие интерфейсы может закончиться неудачей; кроме того, для данного объекта полный набор интерфейсов может быть недоступным.</span><span class="sxs-lookup"><span data-stu-id="9cc50-159">If *peAsynchPhase* is equal to DBASYNCHPHASE_INITIALIZATION, the object is not yet fully initialized; attempting to call any other interfaces might fail, and the full set of interfaces might not be available on the object.</span></span>  
  
-   <span data-ttu-id="9cc50-160">Если значение параметра *peAsynchPhase* равно DBASYNCHPHASE_POPULATION, значит набор строк полностью инициализирован, а объекту доступен полный диапазон интерфейсов. Однако в наборе строк могут быть дополнительные, еще не заполненные строки.</span><span class="sxs-lookup"><span data-stu-id="9cc50-160">If *peAsynchPhase* is equal to DBASYNCHPHASE_POPULATION, the rowset is fully initialized and the full range of interfaces is available on the object; however, there might be additional rows not yet populated into the rowset.</span></span>  
  
-   <span data-ttu-id="9cc50-161">Если значение параметра *peAsynchPhase* равно DBASYNCHPHASE_COMPLETE, значит вся асинхронная обработка объекта завершена.</span><span class="sxs-lookup"><span data-stu-id="9cc50-161">If *peAsynchPhase* is equal to DBASYNCHPHASE_COMPLETE, all asynchronous processing of the object has completed.</span></span> <span data-ttu-id="9cc50-162">Объект полностью инициализирован и заполнен.</span><span class="sxs-lookup"><span data-stu-id="9cc50-162">The object is fully initialized and populated.</span></span>  
  
 <span data-ttu-id="9cc50-163">DB_E_CANCELED</span><span class="sxs-lookup"><span data-stu-id="9cc50-163">DB_E_CANCELED</span></span>  
 <span data-ttu-id="9cc50-164">Асинхронная обработка была отменена во время заполнения набора строк.</span><span class="sxs-lookup"><span data-stu-id="9cc50-164">Asynchronous processing was canceled during rowset population.</span></span> <span data-ttu-id="9cc50-165">Заполнение останавливается, но уже заполненные строки в самом наборе строк остаются действительными.</span><span class="sxs-lookup"><span data-stu-id="9cc50-165">Population stops, but the rowset remains valid for the rows already populated.</span></span>  
  
 <span data-ttu-id="9cc50-166">Асинхронная обработка была отменена во время инициализации объекта источника данных.</span><span class="sxs-lookup"><span data-stu-id="9cc50-166">Asynchronous processing was canceled during data source object initialization.</span></span> <span data-ttu-id="9cc50-167">Объект источника данных находится в неинициализированном состоянии.</span><span class="sxs-lookup"><span data-stu-id="9cc50-167">The data source object is in an uninitialized state.</span></span>  
  
 <span data-ttu-id="9cc50-168">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="9cc50-168">E_INVALIDARG</span></span>  
 <span data-ttu-id="9cc50-169">Параметр *hChapter* является неверным.</span><span class="sxs-lookup"><span data-stu-id="9cc50-169">The *hChapter* parameter is incorrect.</span></span>  
  
 <span data-ttu-id="9cc50-170">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="9cc50-170">E_UNEXPECTED</span></span>  
 <span data-ttu-id="9cc50-171">Метод**ISSAsynchStatus::GetStatus** был вызван для объекта источника данных, а метод **IDBInitialize::Initialize** — не был.</span><span class="sxs-lookup"><span data-stu-id="9cc50-171">**ISSAsynchStatus::GetStatus** was called on a data source object, and **IDBInitialize::Initialize** has not been called on the data source object.</span></span>  
  
 <span data-ttu-id="9cc50-172">Метод**ISSAsynchStatus::GetStatus** был вызван для набора строк, затем был вызван метод **ITransaction::Commit** или **ITransaction::Abилиt** , а объект находится в состоянии зомби.</span><span class="sxs-lookup"><span data-stu-id="9cc50-172">**ISSAsynchStatus::GetStatus** was called on a rowset, **ITransaction::Commit** or **ITransaction::Abort** was called, and the object is in a zombie state.</span></span>  
  
 <span data-ttu-id="9cc50-173">Метод**ISSAsynchStatus::GetStatus** был вызван для набора строк, который был асинхронно отменен на стадии его инициализации.</span><span class="sxs-lookup"><span data-stu-id="9cc50-173">**ISSAsynchStatus::GetStatus** was called on a rowset that was asynchronously canceled in its initialization phase.</span></span> <span data-ttu-id="9cc50-174">Набор строк находится в состоянии зомби.</span><span class="sxs-lookup"><span data-stu-id="9cc50-174">The rowset is in a zombie state.</span></span>  
  
 <span data-ttu-id="9cc50-175">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="9cc50-175">E_FAIL</span></span>  
 <span data-ttu-id="9cc50-176">Произошла ошибка, зависящая от поставщика.</span><span class="sxs-lookup"><span data-stu-id="9cc50-176">A provider-specific error occurred.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="9cc50-177">Remarks</span><span class="sxs-lookup"><span data-stu-id="9cc50-177">Remarks</span></span>  
 <span data-ttu-id="9cc50-178">Метод **ISSAsynchStatus::GetStatus** ведет себя точно так, как ожидает метод **IDBAsynchStatus::GetStatus**: если инициализация объекта источника данных прервана, возвращается E_UNEXPECTED, а не DB_E_CANCELED (хотя метод [ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) возвратит DB_E_CANCELED).</span><span class="sxs-lookup"><span data-stu-id="9cc50-178">The **ISSAsynchStatus::GetStatus** method behaves exactly as the **IDBAsynchStatus::GetStatus** method except that if initialization of a data source object is aborted, E_UNEXPECTED is returned rather than DB_E_CANCELED (although [ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) will return DB_E_CANCELED).</span></span> <span data-ttu-id="9cc50-179">Происходит это потому, что после прерывания объект источника данных не остается в обычном состоянии зомби. Делается этого для того, чтобы можно было попытаться выполнить последующие операции инициализации.</span><span class="sxs-lookup"><span data-stu-id="9cc50-179">This is because the data source object is not left in the usual zombie state following an abort, in order that further initialization operations may be attempted.</span></span>  
  
 <span data-ttu-id="9cc50-180">Если набор строк инициализируется или заполняется асинхронно, он должен поддерживать этот метод.</span><span class="sxs-lookup"><span data-stu-id="9cc50-180">If the rowset is initialized or populated asynchronously, it must support this method.</span></span>  
  
 <span data-ttu-id="9cc50-181">Помимо указанных возвращаемых значений метод **ISSAsynchStatus::GetStatus** может возвращать любой HRESULT, который был бы возвращен методом, инициировавшим асинхронную операцию, с указанием успешного или неуспешного завершения операции.</span><span class="sxs-lookup"><span data-stu-id="9cc50-181">In addition to the return values listed, **ISSAsynchStatus::GetStatus** can return any HRESULT that would have been returned by the method that initiated the asynchronous operation, indicating the success or failure of the operation.</span></span>  
  
 <span data-ttu-id="9cc50-182">Некоторые асинхронные операции могут быть не в состоянии возвращать какие-либо состояния, кроме «завершена» и «не завершена».</span><span class="sxs-lookup"><span data-stu-id="9cc50-182">Some asynchronous operations might not be able to return any states other than "finished" and "not finished".</span></span> <span data-ttu-id="9cc50-183">Они должны задавать параметру *pulProgressMax* значение 1, указывая, что их оценка основана на гранулярности «все или ничего», то есть их ответ будет либо 0/1, либо 1/1.</span><span class="sxs-lookup"><span data-stu-id="9cc50-183">They should set *pulProgressMax* to a value of 1, indicating the all-or-nothing granularity of their estimate, so their answers would be either 0/1 or 1/1.</span></span>  
  
 <span data-ttu-id="9cc50-184">Поставщик может изменить параметр *pulProgressMax* при последующих вызовах и даже возвратить меньшее соотношение, чем раньше, если это отражает улучшение оценки степени выполнения задачи.</span><span class="sxs-lookup"><span data-stu-id="9cc50-184">A provider may change *pulProgressMax* in successive calls and even return a smaller ratio than previously, if this reflects an improving estimate of the degree of completion of the task.</span></span>  
  
 <span data-ttu-id="9cc50-185">Поставщик не обязан гарантировать более высокую точность, но ему рекомендуется стремиться к ней в тех случаях, когда возможно рассчитать разумные оценки завершения.</span><span class="sxs-lookup"><span data-stu-id="9cc50-185">The provider is not obliged to guarantee any further accuracy but is encouraged to do so in cases where reasonable estimates of completion are possible.</span></span> <span data-ttu-id="9cc50-186">Такие действия повышают качество пользовательского интерфейса, поскольку основным вариантом применения этой функции является информирования пользователя о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="9cc50-186">Such efforts will improve user-interface quality because the main use of this function is likely to be to give progress feedback to the user.</span></span> <span data-ttu-id="9cc50-187">Пользователи будут довольны повышением качества обратной связи по невидимой и долгосрочной задаче.</span><span class="sxs-lookup"><span data-stu-id="9cc50-187">User satisfaction increases with the quality of feedback on an invisible, long-running task.</span></span>  
  
 <span data-ttu-id="9cc50-188">В случае вызова метода **ISSAsynchStatus::GetStatus** для инициализированного объекта источника данных или заполненного набора строк, либо передачи значения для параметра *eOperation* , отличного от DBASYNCHOP_OPEN, возвращается S_OK с параметрами *pulProgress* и *pulProgressMax* , которым установлено такое же значение.</span><span class="sxs-lookup"><span data-stu-id="9cc50-188">Calling **ISSAsynchStatus::GetStatus** on an initialized data source object or a populated rowset, or passing a value for *eOperation* other than DBASYNCHOP_OPEN, returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="9cc50-189">Если метод **ISSAsynchStatus::GetStatus** вызывается для объекта, созданного в результате выполнения команды, которая обновляет, удаляет или уставляет строки, оба параметра *pulProgress* и *pulProgressMax* указывают общее число строк, затронутых при выполнении этой команды.</span><span class="sxs-lookup"><span data-stu-id="9cc50-189">If **ISSAsynchStatus::GetStatus** is called on an object created from the execution of a command that updates, deletes, or inserts rows, both *pulProgress* and *pulProgressMax* indicate the total number of rows affected by the command.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9cc50-190">См. также:</span><span class="sxs-lookup"><span data-stu-id="9cc50-190">See Also</span></span>  
 <span data-ttu-id="9cc50-191">[Выполнение асинхронных операций](../native-client/features/performing-asynchronous-operations.md) </span><span class="sxs-lookup"><span data-stu-id="9cc50-191">[Performing Asynchronous Operations](../native-client/features/performing-asynchronous-operations.md) </span></span>  
 [<span data-ttu-id="9cc50-192">ISSAsynchStatus (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="9cc50-192">ISSAsynchStatus &#40;OLE DB&#41;</span></span>](issasynchstatus-ole-db.md)  
  
  
