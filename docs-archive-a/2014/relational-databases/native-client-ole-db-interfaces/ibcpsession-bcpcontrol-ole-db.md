---
title: IBCPSession::BCPControl (OLE DB) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPControl (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPControl method
ms.assetid: d58f3fe1-45e3-4e46-8e9c-000971829d99
author: rothja
ms.author: jroth
ms.openlocfilehash: a3de4d0a942d29f18752374b4020fbfd19aa15ec
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739818"
---
# <a name="ibcpsessionbcpcontrol-ole-db"></a><span data-ttu-id="d1c16-102">Метод IBCPSession::BCPControl (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="d1c16-102">IBCPSession::BCPControl (OLE DB)</span></span>
  <span data-ttu-id="d1c16-103">Задает параметры для операции массового копирования.</span><span class="sxs-lookup"><span data-stu-id="d1c16-103">Sets the options for a bulk-copy operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="d1c16-104">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="d1c16-104">Syntax</span></span>  
  
```  
  
HRESULT BCPControl(   
inteOption,  
void *iValue);  
```  
  
## <a name="remarks"></a><span data-ttu-id="d1c16-105">Remarks</span><span class="sxs-lookup"><span data-stu-id="d1c16-105">Remarks</span></span>  
 <span data-ttu-id="d1c16-106">Метод **BCPControl** задает различные параметры управления для операций массового копирования, в том числе количество ошибок, допустимых перед отменой массового копирования, номера первой и последней строк, копируемых из файла данных, и размер пакетов.</span><span class="sxs-lookup"><span data-stu-id="d1c16-106">The **BCPControl** method sets various control parameters for bulk-copy operations including the number of errors allowed before canceling a bulk copy, the numbers of the first and last rows to copy from a data file, and the batch size.</span></span>  
  
 <span data-ttu-id="d1c16-107">Этот метод также применяется, чтобы указать на использование инструкции SELECT при массовом копировании данных из [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d1c16-107">This method is also used to specify the SELECT statement to use when bulk copying data out from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d1c16-108">Можно задать `eOption` для аргумента значение BCP_OPTION_HINTS и `iValue` аргумент, чтобы иметь указатель на строку расширенных символов, содержащую инструкцию SELECT.</span><span class="sxs-lookup"><span data-stu-id="d1c16-108">You can set the `eOption` argument to BCP_OPTION_HINTS and `iValue` argument to have a pointer to a wide character string containing the SELECT statement.</span></span>  
  
 <span data-ttu-id="d1c16-109">Возможные значения параметра *eOption* .</span><span class="sxs-lookup"><span data-stu-id="d1c16-109">Possible values for *eOption* are:</span></span>  
  
|<span data-ttu-id="d1c16-110">Параметр</span><span class="sxs-lookup"><span data-stu-id="d1c16-110">Option</span></span>|<span data-ttu-id="d1c16-111">Описание</span><span class="sxs-lookup"><span data-stu-id="d1c16-111">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="d1c16-112">BCP_OPTION_ABORT</span><span class="sxs-lookup"><span data-stu-id="d1c16-112">BCP_OPTION_ABORT</span></span>|<span data-ttu-id="d1c16-113">Останавливает текущую операцию массового копирования.</span><span class="sxs-lookup"><span data-stu-id="d1c16-113">Stops a bulk-copy operation that is already in progress.</span></span> <span data-ttu-id="d1c16-114">Можно вызвать метод **BCPControl** с аргументом *eOption* , имеющим значение BCP_OPTION_ABORT, из другого потока, чтобы остановить текущую операцию массового копирования.</span><span class="sxs-lookup"><span data-stu-id="d1c16-114">You can call the **BCPControl** method with an *eOption* argument of BCP_OPTION_ABORT from another thread to stop a running bulk-copy operation.</span></span> <span data-ttu-id="d1c16-115">Аргумент *iValue* не учитывается.</span><span class="sxs-lookup"><span data-stu-id="d1c16-115">The *iValue* argument is ignored.</span></span>|  
|<span data-ttu-id="d1c16-116">BCP_OPTION_BATCH</span><span class="sxs-lookup"><span data-stu-id="d1c16-116">BCP_OPTION_BATCH</span></span>|<span data-ttu-id="d1c16-117">Количество строк на пакет.</span><span class="sxs-lookup"><span data-stu-id="d1c16-117">The number of rows per batch.</span></span> <span data-ttu-id="d1c16-118">Значение по умолчанию равно 0. Оно обозначает все строки в таблице при извлечении данных или все строки в файле пользовательских данных при копировании данных в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d1c16-118">The default is 0, which indicates all rows in a table when data is being extracted, or all rows in the user data file when data is being copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d1c16-119">При значении меньше 1 параметр BCP_OPTION_BATCH принимает значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d1c16-119">A value less than 1 resets BCP_OPTION_BATCH to the default.</span></span>|  
|<span data-ttu-id="d1c16-120">BCP_OPTION_DELAYREADFMT</span><span class="sxs-lookup"><span data-stu-id="d1c16-120">BCP_OPTION_DELAYREADFMT</span></span>|<span data-ttu-id="d1c16-121">Логическое значение. Если ему задано значение true, то [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) будет читаться при выполнении.</span><span class="sxs-lookup"><span data-stu-id="d1c16-121">A Boolean, if set to true, will cause [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) to read at execution.</span></span> <span data-ttu-id="d1c16-122">Если имеет значение false (по умолчанию), IBCPSession::BCPReadFmt немедленно считывает файл форматирования.</span><span class="sxs-lookup"><span data-stu-id="d1c16-122">If false (the default), IBCPSession::BCPReadFmt will immediately read the format file.</span></span> <span data-ttu-id="d1c16-123">Если `BCP_OPTION_DELAYREADFMT` имеет значение true и вызывается IBCPSession:: BCPColumns или IBCPSession:: BCPColFmt, возникнет ошибка последовательности.</span><span class="sxs-lookup"><span data-stu-id="d1c16-123">A sequence error will occur if `BCP_OPTION_DELAYREADFMT` is true and you call IBCPSession::BCPColumns or IBCPSession::BCPColFmt.</span></span><br /><br /> <span data-ttu-id="d1c16-124">Также ошибка последовательности возникнет при вызове `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` после вызова `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` и IBCPSession::BCPWriteFmt.</span><span class="sxs-lookup"><span data-stu-id="d1c16-124">A sequence error will also occur if you call `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` after calling `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` and IBCPSession::BCPWriteFmt.</span></span><br /><br /> <span data-ttu-id="d1c16-125">Дополнительные сведения см. в разделе [Обнаружение метаданных](../native-client/features/metadata-discovery.md).</span><span class="sxs-lookup"><span data-stu-id="d1c16-125">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>|  
|<span data-ttu-id="d1c16-126">BCP_OPTION_FILECP</span><span class="sxs-lookup"><span data-stu-id="d1c16-126">BCP_OPTION_FILECP</span></span>|<span data-ttu-id="d1c16-127">Аргумент *iValue* содержит номер кодовой страницы для файла данных.</span><span class="sxs-lookup"><span data-stu-id="d1c16-127">The *iValue* argument contains the number of the code page for the data file.</span></span> <span data-ttu-id="d1c16-128">Можно указать номер кодовой страницы, такой как 1252 или 850, или одно из следующих значений.</span><span class="sxs-lookup"><span data-stu-id="d1c16-128">You can specify the number of the code page, such as 1252 or 850, or one of the following values:</span></span><br /><br /> <span data-ttu-id="d1c16-129">-BCP_FILECP_ACP: данные в файле находятся в Microsoft Windows??</span><span class="sxs-lookup"><span data-stu-id="d1c16-129">-   BCP_FILECP_ACP: data in the file is in the Microsoft Windows??</span></span> <span data-ttu-id="d1c16-130">Кодовая страница клиента.</span><span class="sxs-lookup"><span data-stu-id="d1c16-130">code page of the client.</span></span><br /><span data-ttu-id="d1c16-131">-BCP_FILECP_OEMCP: данные в файле находятся в кодовой странице OEM клиента (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="d1c16-131">-   BCP_FILECP_OEMCP: data in the file is in the OEM code page of the client (default).</span></span><br /><span data-ttu-id="d1c16-132">-BCP_FILECP_RAW: данные в файле находятся на кодовой странице [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d1c16-132">-   BCP_FILECP_RAW: data in the file is in the code page of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
|<span data-ttu-id="d1c16-133">BCP_OPTION_FILEFMT</span><span class="sxs-lookup"><span data-stu-id="d1c16-133">BCP_OPTION_FILEFMT</span></span>|<span data-ttu-id="d1c16-134">Номер версии для формата файла данных.</span><span class="sxs-lookup"><span data-stu-id="d1c16-134">The version number of the data file format.</span></span> <span data-ttu-id="d1c16-135">Может иметь значение 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] или [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]) или 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="d1c16-135">This can be 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]), or 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].</span></span> <span data-ttu-id="d1c16-136">120 используется по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d1c16-136">120 is the default.</span></span> <span data-ttu-id="d1c16-137">Это может оказаться полезным при экспорте или импорте данных в форматах, которые поддерживались прежними версиями сервера.</span><span class="sxs-lookup"><span data-stu-id="d1c16-137">This is useful for exporting and importing data in formats that were supported by earlier version of the server.</span></span>  <span data-ttu-id="d1c16-138">Например, чтобы импортировать данные, полученные из текстового столбца на сервере [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] , в столбец типа **varchar(max)** на сервере [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или более поздней версии, следует указать значение 80.</span><span class="sxs-lookup"><span data-stu-id="d1c16-138">For example, to import data obtained from a text column in a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server into a **varchar(max)** column in a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later server, you should specify 80.</span></span> <span data-ttu-id="d1c16-139">Аналогично при указании значения 80 при экспорте данных из столбца **varchar(max)** данные столбца сохраняются точно так же, как сохраняются текстовые столбцы в формате [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)], и их можно будет импортировать в текстовый столбец сервера [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d1c16-139">Similarly, if you specify 80 while exporting data from a **varchar(max)** column, it will be saved just like text columns are saved in the [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] format, and can be imported into a text column of a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server.</span></span>|  
|<span data-ttu-id="d1c16-140">BCP_OPTION_FIRST</span><span class="sxs-lookup"><span data-stu-id="d1c16-140">BCP_OPTION_FIRST</span></span>|<span data-ttu-id="d1c16-141">Первая строка данных копируемого файла или таблицы.</span><span class="sxs-lookup"><span data-stu-id="d1c16-141">The first row of data of the file or table to copy.</span></span> <span data-ttu-id="d1c16-142">Значение по умолчанию равно 1. Если задать для этого параметра значение меньше 1, то будет установлено значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d1c16-142">The default is 1; a value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="d1c16-143">BCP_OPTION_FIRSTEX</span><span class="sxs-lookup"><span data-stu-id="d1c16-143">BCP_OPTION_FIRSTEX</span></span>|<span data-ttu-id="d1c16-144">В операциях bcp out задает первую строку таблицы базы данных для копирования в файл данных.</span><span class="sxs-lookup"><span data-stu-id="d1c16-144">For BCP out operations, specifies the first row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="d1c16-145">В операциях bcp in задает первую строку файла данных для копирования в таблицу базы данных.</span><span class="sxs-lookup"><span data-stu-id="d1c16-145">For BCP in operations, specifies the first row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="d1c16-146">Параметр *iValue* должен представлять адрес 64-разрядного целого числа со знаком, содержащего значение.</span><span class="sxs-lookup"><span data-stu-id="d1c16-146">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="d1c16-147">Максимальное значение, которое можно передать в BCPFIRSTEX, составляет 2^63-1.</span><span class="sxs-lookup"><span data-stu-id="d1c16-147">The maximum value that can be passed to BCPFIRSTEX 2^63-1.</span></span>|  
|<span data-ttu-id="d1c16-148">BCP_OPTION_FMTXML</span><span class="sxs-lookup"><span data-stu-id="d1c16-148">BCP_OPTION_FMTXML</span></span>|<span data-ttu-id="d1c16-149">Используется, чтобы указать, что созданный файл форматирования должен быть в формате XML.</span><span class="sxs-lookup"><span data-stu-id="d1c16-149">Used to specify that the format file generated should be in an XML format.</span></span> <span data-ttu-id="d1c16-150">Отключен по умолчанию, и по умолчанию файлы форматирования сохраняются как текстовые файлы.</span><span class="sxs-lookup"><span data-stu-id="d1c16-150">It is off by default and by default the format files are saved as text files.</span></span> <span data-ttu-id="d1c16-151">XML-файл форматирования обеспечивает более высокую гибкость, но связан с некоторыми дополнительными ограничениями.</span><span class="sxs-lookup"><span data-stu-id="d1c16-151">The XML format file provides greater flexibility but with some added constraints.</span></span> <span data-ttu-id="d1c16-152">Например, нельзя указать для поля одновременно префикс и признак конца, что было возможно в старых файлах форматирования.</span><span class="sxs-lookup"><span data-stu-id="d1c16-152">For example, you can not specify the prefix and terminator for a field simultaneously which is possible in older format files.</span></span> <span data-ttu-id="d1c16-153">**Примечание.**  XML-файлы форматирования поддерживаются только при [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] установке средств вместе с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] собственным клиентом.</span><span class="sxs-lookup"><span data-stu-id="d1c16-153">**Note:**  XML format files are only supported when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tools are installed along with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>|  
|<span data-ttu-id="d1c16-154">BCP_OPTION_HINTS</span><span class="sxs-lookup"><span data-stu-id="d1c16-154">BCP_OPTION_HINTS</span></span>|<span data-ttu-id="d1c16-155">Аргумент *iValue* содержит указатель на расширенный символ.</span><span class="sxs-lookup"><span data-stu-id="d1c16-155">The *iValue* argument contains a wide character string pointer.</span></span> <span data-ttu-id="d1c16-156">Адресуемая строка задает подсказки для обработки массового копирования [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или инструкцию [!INCLUDE[tsql](../../includes/tsql-md.md)] , которая возвращает результирующий набор.</span><span class="sxs-lookup"><span data-stu-id="d1c16-156">The string addressed specifies either [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-copy processing hints or a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that returns a result set.</span></span> <span data-ttu-id="d1c16-157">Если указана инструкция [!INCLUDE[tsql](../../includes/tsql-md.md)] , которая возвращает более одного результирующего набора, все результирующие наборы после первого не учитываются.</span><span class="sxs-lookup"><span data-stu-id="d1c16-157">If a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement is specified that returns more than one result set, all result sets after the first are ignored.</span></span>|  
|<span data-ttu-id="d1c16-158">BCP_OPTION_KEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="d1c16-158">BCP_OPTION_KEEPIDENTITY</span></span>|<span data-ttu-id="d1c16-159">Если аргумент *iValue* имеет значение TRUE, этот параметр указывает, что методы массового копирования вставляют значения данных, предоставленные для столбцов [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], определенных с ограничением IDENTITY.</span><span class="sxs-lookup"><span data-stu-id="d1c16-159">When the *iValue* argument is set to TRUE, this option specifies that the bulk copy methods insert data values supplied for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] columns defined with an identity constraint.</span></span> <span data-ttu-id="d1c16-160">Входной файл должен содержать значения для столбцов идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="d1c16-160">The input file must supply values for the identity columns.</span></span> <span data-ttu-id="d1c16-161">Если эти значения не заданы, то для вставляемых строк создаются новые значения идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="d1c16-161">If this is not set, new identity values are generated for the inserted rows.</span></span> <span data-ttu-id="d1c16-162">Данные в файле, предназначенные для столбцов идентификаторов, не учитываются.</span><span class="sxs-lookup"><span data-stu-id="d1c16-162">Any data present in the file for the identity columns is ignored.</span></span>|  
|<span data-ttu-id="d1c16-163">BCP_OPTION_KEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="d1c16-163">BCP_OPTION_KEEPNULLS</span></span>|<span data-ttu-id="d1c16-164">Указывает, будут ли пустые значения данных в файле преобразовываться в значения NULL в таблице [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d1c16-164">Specifies whether empty data values in the file will be converted to NULL values in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="d1c16-165">Если аргумент *iValue* имеет значение TRUE, пустые значения в таблице [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] преобразуются в NULL.</span><span class="sxs-lookup"><span data-stu-id="d1c16-165">When the *iValue* argument is set to TRUE, empty values will be converted to NULL in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="d1c16-166">По умолчанию пустые значения преобразовываются в значения по умолчанию для столбца в таблице [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , если значение по умолчанию существует.</span><span class="sxs-lookup"><span data-stu-id="d1c16-166">The default is for empty values to be converted to a default value for the column in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table if a default exists.</span></span>|  
|<span data-ttu-id="d1c16-167">BCP_OPTION_LAST</span><span class="sxs-lookup"><span data-stu-id="d1c16-167">BCP_OPTION_LAST</span></span>|<span data-ttu-id="d1c16-168">Последняя копируемая строка.</span><span class="sxs-lookup"><span data-stu-id="d1c16-168">The last row to copy.</span></span> <span data-ttu-id="d1c16-169">По умолчанию копируются все строки.</span><span class="sxs-lookup"><span data-stu-id="d1c16-169">The default is to copy all rows.</span></span> <span data-ttu-id="d1c16-170">При значении менее 1 этот параметр сбрасывается в значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d1c16-170">A value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="d1c16-171">BCP_OPTION_LASTEX</span><span class="sxs-lookup"><span data-stu-id="d1c16-171">BCP_OPTION_LASTEX</span></span>|<span data-ttu-id="d1c16-172">В операциях bcp out задает последнюю строку таблицы базы данных для копирования в файл данных.</span><span class="sxs-lookup"><span data-stu-id="d1c16-172">For BCP out operations, specifies the last row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="d1c16-173">В операциях bcp in задает последнюю строку файла данных для копирования в таблицу базы данных.</span><span class="sxs-lookup"><span data-stu-id="d1c16-173">For BCP in operations, specifies the last row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="d1c16-174">Параметр *iValue* должен представлять адрес 64-разрядного целого числа со знаком, содержащего значение.</span><span class="sxs-lookup"><span data-stu-id="d1c16-174">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="d1c16-175">Максимальное значение, передаваемое в BCPLASTEX, составляет 2^63-1.</span><span class="sxs-lookup"><span data-stu-id="d1c16-175">The maximum value that can be passed to BCPLASTEX is 2^63-1.</span></span>|  
|<span data-ttu-id="d1c16-176">BCP_OPTION_MAXERRS</span><span class="sxs-lookup"><span data-stu-id="d1c16-176">BCP_OPTION_MAXERRS</span></span>|<span data-ttu-id="d1c16-177">Число ошибок, при достижении которого операция массового копирования завершается неудачей.</span><span class="sxs-lookup"><span data-stu-id="d1c16-177">The number of errors allowed before the bulk copy operation fails.</span></span> <span data-ttu-id="d1c16-178">Значение по умолчанию равно 10.</span><span class="sxs-lookup"><span data-stu-id="d1c16-178">The default is 10.</span></span> <span data-ttu-id="d1c16-179">При значении менее 1 этот параметр сбрасывается в значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d1c16-179">A value less than 1 resets this option to its default.</span></span> <span data-ttu-id="d1c16-180">В операции массового копирования допускается не более 65 535 ошибок.</span><span class="sxs-lookup"><span data-stu-id="d1c16-180">Bulk copy imposes a maximum of 65,535 errors.</span></span> <span data-ttu-id="d1c16-181">Если выполнить попытку установить этот параметр в значение, превышающее 65 535, будет установлено значение 65 535.</span><span class="sxs-lookup"><span data-stu-id="d1c16-181">An attempt to set this option to a value larger than 65,535 results in the option being set to 65,535.</span></span>|  
|<span data-ttu-id="d1c16-182">BCP_OPTION_ROWCOUNT</span><span class="sxs-lookup"><span data-stu-id="d1c16-182">BCP_OPTION_ROWCOUNT</span></span>|<span data-ttu-id="d1c16-183">Возвращает число строк, на которые распространяется действие текущей (или последней) операции bcp.</span><span class="sxs-lookup"><span data-stu-id="d1c16-183">Returns the number of rows affected by the current (or last) BCP operation.</span></span>|  
|<span data-ttu-id="d1c16-184">BCP_OPTION_TEXTFILE</span><span class="sxs-lookup"><span data-stu-id="d1c16-184">BCP_OPTION_TEXTFILE</span></span>|<span data-ttu-id="d1c16-185">Файл данных является не двоичным, а текстовым файлом.</span><span class="sxs-lookup"><span data-stu-id="d1c16-185">The data file is not a binary file, but is a text file.</span></span> <span data-ttu-id="d1c16-186">BCP обнаруживает, представлен ли текстовый файл в формате Юникод или нет, проверяя отметку байтов Юникод в первых двух байтах файла данных.</span><span class="sxs-lookup"><span data-stu-id="d1c16-186">BCP does the detection whether the text file is Unicode or not by checking the Unicode byte marker in the first 2 bytes of the data file.</span></span>|  
|<span data-ttu-id="d1c16-187">BCP_OPTION_UNICODEFILE</span><span class="sxs-lookup"><span data-stu-id="d1c16-187">BCP_OPTION_UNICODEFILE</span></span>|<span data-ttu-id="d1c16-188">Если установлено значение TRUE, этот параметр указывает, что входной файл представлен в формате Юникода.</span><span class="sxs-lookup"><span data-stu-id="d1c16-188">When set to TRUE, this option specifies that the input file is a Unicode file format.</span></span>|  
  
## <a name="arguments"></a><span data-ttu-id="d1c16-189">Аргументы</span><span class="sxs-lookup"><span data-stu-id="d1c16-189">Arguments</span></span>  
 <span data-ttu-id="d1c16-190">*eOption*[in]</span><span class="sxs-lookup"><span data-stu-id="d1c16-190">*eOption*[in]</span></span>  
 <span data-ttu-id="d1c16-191">Задает один из параметров, перечисленных в таблице выше.</span><span class="sxs-lookup"><span data-stu-id="d1c16-191">Set to one of the options listed in the remarks section above.</span></span>  
  
 <span data-ttu-id="d1c16-192">*iValue*[in]</span><span class="sxs-lookup"><span data-stu-id="d1c16-192">*iValue*[in]</span></span>  
 <span data-ttu-id="d1c16-193">Значение для указанного аргумента *eOption*.</span><span class="sxs-lookup"><span data-stu-id="d1c16-193">The value for the specified *eOption*.</span></span> <span data-ttu-id="d1c16-194">Аргумент *iValue* является целым значением, приведенным к указателю void, чтобы обеспечить расширение в будущем до 64-разрядных значений.</span><span class="sxs-lookup"><span data-stu-id="d1c16-194">The *iValue* argument is an integer value cast to a void pointer to allow for future expansion to 64 bit values.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="d1c16-195">Значения кода возврата</span><span class="sxs-lookup"><span data-stu-id="d1c16-195">Return Code Values</span></span>  
 <span data-ttu-id="d1c16-196">S_OK</span><span class="sxs-lookup"><span data-stu-id="d1c16-196">S_OK</span></span>  
 <span data-ttu-id="d1c16-197">Метод выполнен успешно.</span><span class="sxs-lookup"><span data-stu-id="d1c16-197">The method succeeded.</span></span>  
  
 <span data-ttu-id="d1c16-198">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="d1c16-198">E_FAIL</span></span>  
 <span data-ttu-id="d1c16-199">Произошла ошибка, связанная с поставщиком. Подробные сведения можно получить при помощи интерфейса [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="d1c16-199">A provider-specific error occurred; for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="d1c16-200">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="d1c16-200">E_UNEXPECTED</span></span>  
 <span data-ttu-id="d1c16-201">Непредвиденный вызов метода.</span><span class="sxs-lookup"><span data-stu-id="d1c16-201">The call to the method was unexpected.</span></span> <span data-ttu-id="d1c16-202">Например, перед вызовом этой функции не был вызван метод [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="d1c16-202">For example, the [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) method was not called before calling this function.</span></span>  
  
 <span data-ttu-id="d1c16-203">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="d1c16-203">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="d1c16-204">Недостаточно памяти.</span><span class="sxs-lookup"><span data-stu-id="d1c16-204">Out-of-memory error.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d1c16-205">См. также:</span><span class="sxs-lookup"><span data-stu-id="d1c16-205">See Also</span></span>  
 <span data-ttu-id="d1c16-206">[IBCPSession (OLE DB)](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="d1c16-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="d1c16-207">Выполнение операций массового копирования</span><span class="sxs-lookup"><span data-stu-id="d1c16-207">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  
