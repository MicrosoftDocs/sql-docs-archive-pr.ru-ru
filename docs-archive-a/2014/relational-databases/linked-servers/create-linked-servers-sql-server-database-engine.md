---
title: Создание связанных серверов (компонент SQL Server Database Engine) | Документация Майкрософт
ms.custom: ''
ms.date: 11/20/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
f1_keywords:
- sql12.swb.linkedserver.properties.general.f1
- sql12.swb.linkedserver.properties.security.f1
- sql12.swb.linkedserver.properties.provider.f1
- sql12.swb.linkedserver.properties.options.f1
helpviewer_keywords:
- linked servers [SQL Server], creating
ms.assetid: 3228065d-de8f-4ece-a9b1-e06d3dca9310
author: stevestein
ms.author: sstein
ms.openlocfilehash: 6b28468db1024a9789364e5b6e5c115cba71fa9f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87730674"
---
# <a name="create-linked-servers-sql-server-database-engine"></a><span data-ttu-id="61507-102">Создание связанных серверов (компонент SQL Server Database Engine)</span><span class="sxs-lookup"><span data-stu-id="61507-102">Create Linked Servers (SQL Server Database Engine)</span></span>
  <span data-ttu-id="61507-103">В этом разделе описано, как создать связанный сервер и производить доступ к данным из другого экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61507-103">This topic shows how to create a linked server and access data from another [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="61507-104">Путем создания связанного сервера вы можете работать с данными из нескольких источников.</span><span class="sxs-lookup"><span data-stu-id="61507-104">By creating a linked server,  you can work with data from multiple sources.</span></span> <span data-ttu-id="61507-105">Связанный сервер не обязательно должен быть другим экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], хотя такой вариант часто встречается.</span><span class="sxs-lookup"><span data-stu-id="61507-105">The linked server does not have to be another instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but that is a common scenario.</span></span>  
  
##  <a name="background"></a><a name="Background"></a> <span data-ttu-id="61507-106">Историческая справка</span><span class="sxs-lookup"><span data-stu-id="61507-106">Background</span></span>  
 <span data-ttu-id="61507-107">Связанные серверы позволяют выполнять распределенные разнородные запросы к источникам данных OLE DB.</span><span class="sxs-lookup"><span data-stu-id="61507-107">A linked server allows for access to distributed, heterogeneous queries against OLE DB data sources.</span></span> <span data-ttu-id="61507-108">После создания связанного сервера можно выполнять распределенные запросы к этому серверу, причем в запросах могут соединять таблицы из нескольких источников данных.</span><span class="sxs-lookup"><span data-stu-id="61507-108">After a linked server is created, distributed queries can be run against this server, and queries can join tables from more than one data source.</span></span> <span data-ttu-id="61507-109">Если связанный сервер определен в качестве экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], на нем могут выполняться удаленные хранимые процедуры.</span><span class="sxs-lookup"><span data-stu-id="61507-109">If the linked server is defined as an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], remote stored procedures can be executed.</span></span>  
  
 <span data-ttu-id="61507-110">Возможности связанного сервера и необходимые аргументы могут сильно различаться.</span><span class="sxs-lookup"><span data-stu-id="61507-110">The capabilities and required arguments of the linked server can vary significantly.</span></span> <span data-ttu-id="61507-111">В примерах из этого раздела представлены типичные ситуации, но описаны не все параметры.</span><span class="sxs-lookup"><span data-stu-id="61507-111">The examples in this topic provide a typical example but all options are not described.</span></span> <span data-ttu-id="61507-112">Дополнительные сведения см. в статье [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="61507-112">For more information, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
##  <a name="security"></a><a name="Security"></a> <span data-ttu-id="61507-113">безопасность</span><span class="sxs-lookup"><span data-stu-id="61507-113">Security</span></span>  
  
### <a name="permissions"></a><span data-ttu-id="61507-114">Разрешения</span><span class="sxs-lookup"><span data-stu-id="61507-114">Permissions</span></span>  
 <span data-ttu-id="61507-115">При использовании [!INCLUDE[tsql](../../includes/tsql-md.md)] инструкций требуется `ALTER ANY LINKED SERVER` разрешение на сервере или членство в предопределенной роли сервера **setupadmin** .</span><span class="sxs-lookup"><span data-stu-id="61507-115">When using [!INCLUDE[tsql](../../includes/tsql-md.md)] statements, requires `ALTER ANY LINKED SERVER` permission on the server or membership in the **setupadmin** fixed server role.</span></span> <span data-ttu-id="61507-116">При использовании [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] требуется `CONTROL SERVER` разрешение или членство в предопределенной роли сервера **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="61507-116">When using [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] requires `CONTROL SERVER` permission or membership in the **sysadmin** fixed server role.</span></span>  
  
##  <a name="how-to-create-a-linked-server"></a><a name="Procedures"></a> <span data-ttu-id="61507-117">Создание связанного сервера</span><span class="sxs-lookup"><span data-stu-id="61507-117">How to Create a Linked Server</span></span>  
 <span data-ttu-id="61507-118">Можно использовать следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="61507-118">You can use any of the following:</span></span>  
  
-   [<span data-ttu-id="61507-119">Среда SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="61507-119">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
-   [<span data-ttu-id="61507-120">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="61507-120">Transact-SQL</span></span>](#TsqlProcedure)  
  
###  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="61507-121">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="61507-121">Using SQL Server Management Studio</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-sql-server-management-studio"></a><span data-ttu-id="61507-122">Создание связанного сервера для другого экземпляра SQL Server в среде SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="61507-122">To create a linked server to another instance of SQL Server Using SQL Server Management Studio</span></span>  
  
1.  <span data-ttu-id="61507-123">В среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]откройте обозреватель объектов, разверните узел **Объекты сервера**, щелкните правой кнопкой мыши узел **Связанные серверы**и выберите команду **Создать связанный сервер**.</span><span class="sxs-lookup"><span data-stu-id="61507-123">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], open Object Explorer, expand **Server Objects**, right-click **Linked Servers**, and then click **New Linked Server**.</span></span>  
  
2.  <span data-ttu-id="61507-124">На странице **Общие** в поле **Связанный сервер** введите имя экземпляра **SQL Server** , с которым связывается область.</span><span class="sxs-lookup"><span data-stu-id="61507-124">On the **General** page, in the **Linked server** box, type the name of the instance of **SQL Server** that you area linking to.</span></span>  
  
     <span data-ttu-id="61507-125">**SQL Server**</span><span class="sxs-lookup"><span data-stu-id="61507-125">**SQL Server**</span></span>  
     <span data-ttu-id="61507-126">Идентификация связанного сервера как экземпляра [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61507-126">Identify the linked server as an instance of [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="61507-127">При использовании этого метода определения связанного сервера [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] имя, указанное в поле **Связанный сервер** , должно быть сетевым именем этого сервера.</span><span class="sxs-lookup"><span data-stu-id="61507-127">If you use this method of defining a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] linked server, the name specified in **Linked server** must be the network name of the server.</span></span> <span data-ttu-id="61507-128">Кроме того, все таблицы, полученные от сервера, будут получены из базы данных, по умолчанию определенной для имени входа на связанный сервер.</span><span class="sxs-lookup"><span data-stu-id="61507-128">Also, any tables retrieved from the server are from the default database defined for the login on the linked server.</span></span>  
  
     <span data-ttu-id="61507-129">**Другой источник данных**</span><span class="sxs-lookup"><span data-stu-id="61507-129">**Other data source**</span></span>  
     <span data-ttu-id="61507-130">Укажите тип сервера OLE DB, отличный от [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61507-130">Specify an OLE DB server type other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="61507-131">Включение этой функции активирует дополнительные параметры, расположенные под ней.</span><span class="sxs-lookup"><span data-stu-id="61507-131">Clicking this option activates the options below it.</span></span>  
  
     <span data-ttu-id="61507-132">**Поставщик**</span><span class="sxs-lookup"><span data-stu-id="61507-132">**Provider**</span></span>  
     <span data-ttu-id="61507-133">Выберите источник данных OLE DB в окне списка.</span><span class="sxs-lookup"><span data-stu-id="61507-133">Select an OLE DB data source from the list box.</span></span> <span data-ttu-id="61507-134">Поставщик OLE DB зарегистрирован в реестре с данным идентификатором PROGID.</span><span class="sxs-lookup"><span data-stu-id="61507-134">The OLE DB provider is registered with the given PROGID in the registry.</span></span>  
  
     <span data-ttu-id="61507-135">**Название продукта**</span><span class="sxs-lookup"><span data-stu-id="61507-135">**Product name**</span></span>  
     <span data-ttu-id="61507-136">Введите название продукта для источника данных OLE DB, который добавляется в качестве связанного сервера.</span><span class="sxs-lookup"><span data-stu-id="61507-136">Type the product name of the OLE DB data source to add as a linked server.</span></span>  
  
     <span data-ttu-id="61507-137">**Источник данных**</span><span class="sxs-lookup"><span data-stu-id="61507-137">**Data source**</span></span>  
     <span data-ttu-id="61507-138">Введите имя источника данных согласно интерпретации поставщика OLE DB.</span><span class="sxs-lookup"><span data-stu-id="61507-138">Type the name of the data source as interpreted by the OLE DB provider.</span></span> <span data-ttu-id="61507-139">При соединении с экземпляром служб [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]указывается имя экземпляра.</span><span class="sxs-lookup"><span data-stu-id="61507-139">If you are connecting to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], provide the instance name.</span></span>  
  
     <span data-ttu-id="61507-140">**Строка поставщика**</span><span class="sxs-lookup"><span data-stu-id="61507-140">**Provider string**</span></span>  
     <span data-ttu-id="61507-141">Введите уникальный программный идентификатор (PROGID) поставщика OLE DB, соответствующий источнику данных.</span><span class="sxs-lookup"><span data-stu-id="61507-141">Type the unique programmatic identifier (PROGID) of the OLE DB provider that corresponds to the data source.</span></span> <span data-ttu-id="61507-142">Примеры допустимых строк поставщиков см. в статье [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="61507-142">For examples of valid provider strings, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
     <span data-ttu-id="61507-143">**Местоположение**</span><span class="sxs-lookup"><span data-stu-id="61507-143">**Location**</span></span>  
     <span data-ttu-id="61507-144">Введите местонахождение базы данных, понятное поставщику OLE DB.</span><span class="sxs-lookup"><span data-stu-id="61507-144">Type the location of the database as interpreted by the OLE DB provider.</span></span>  
  
     <span data-ttu-id="61507-145">**Каталог**</span><span class="sxs-lookup"><span data-stu-id="61507-145">**Catalog**</span></span>  
     <span data-ttu-id="61507-146">Введите имя каталога, который следует использовать при соединении с поставщиком OLE DB.</span><span class="sxs-lookup"><span data-stu-id="61507-146">Type the name of the catalog to use when making a connection to the OLE DB provider.</span></span>  
  
     <span data-ttu-id="61507-147">Чтобы проверить возможность соединения со связанным сервером, щелкните его в обозревателе объектов правой кнопкой мыши и выберите команду **Проверить соединение**.</span><span class="sxs-lookup"><span data-stu-id="61507-147">To test the ability to connect to a linked server, in Object Explorer, right-click the linked server and then click **Test Connection**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="61507-148">Если экземпляр **SQL Server** является экземпляром по умолчанию, то введите имя компьютера, на котором размещается экземпляр **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="61507-148">If the instance of **SQL Server** is the default instance, enter the name of the computer that hosts the instance of **SQL Server**.</span></span> <span data-ttu-id="61507-149">Если экземпляр **SQL Server** является именованным, введите имя компьютера и имя экземпляра, например **Accounting\SQLExpress**.</span><span class="sxs-lookup"><span data-stu-id="61507-149">If the **SQL Server** is a named instance, enter the name of the computer and the name of the instance, such as **Accounting\SQLExpress**.</span></span>  
  
3.  <span data-ttu-id="61507-150">В области **Тип сервера** выберите **SQL Server**, чтобы показать, что связанный сервер является экземпляром **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="61507-150">In the **Server type** area, select **SQL Server** to indicate that the linked server is another instance of **SQL Server**.</span></span>  
  
4.  <span data-ttu-id="61507-151">На странице **Безопасность** укажите контекст безопасности, который будет использоваться при подключении исходного экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] к связанному серверу.</span><span class="sxs-lookup"><span data-stu-id="61507-151">On the **Security** page, specify the security context that will be used when the original [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connects to the linked server.</span></span> <span data-ttu-id="61507-152">В среде с доменами, где пользователи соединяются с помощью имен входа доменов, лучшим вариантом часто оказывается **Выполнять с использованием текущего контекста безопасности имени входа**.</span><span class="sxs-lookup"><span data-stu-id="61507-152">In a domain environment where users are connecting by using their domain logins, selecting **Be made using the login's current security context** is often the best choice.</span></span> <span data-ttu-id="61507-153">Если пользователи соединяются с исходным экземпляром **SQL Server** по имени входа **SQL Server** , то лучшим вариантом часто оказывается **С использованием этого контекста безопасности**с последующим указанием необходимых учетных данных для проверки подлинности на связанном сервере.</span><span class="sxs-lookup"><span data-stu-id="61507-153">When users connect to the original **SQL Server** by using a **SQL Server** login, the best choice is often to select **By using this security context**, and then providing the necessary credentials to authenticate at the linked server.</span></span>  
  
     <span data-ttu-id="61507-154">**Локальное имя входа**</span><span class="sxs-lookup"><span data-stu-id="61507-154">**Local login**</span></span>  
     <span data-ttu-id="61507-155">Указывает локальное имя входа, с помощью которого может осуществляться соединение со связанным сервером.</span><span class="sxs-lookup"><span data-stu-id="61507-155">Specify the local login that can connect to the linked server.</span></span> <span data-ttu-id="61507-156">Локальное имя входа может представлять собой либо имя входа с использованием проверки подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , либо имя входа с проверкой подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="61507-156">The local login can be either a login using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication or a Windows Authentication login.</span></span> <span data-ttu-id="61507-157">Используйте этот список для разрешения соединений только определенным именам входа или для разрешения некоторым именам входа подключаться в качестве другого имени входа.</span><span class="sxs-lookup"><span data-stu-id="61507-157">Use this list to restrict the connection to specific logins, or to allow some logins to connect as a different login.</span></span>  
  
     <span data-ttu-id="61507-158">**Impersonate**</span><span class="sxs-lookup"><span data-stu-id="61507-158">**Impersonate**</span></span>  
     <span data-ttu-id="61507-159">Передает имя пользователя и пароль из локального имени входа на связанный сервер.</span><span class="sxs-lookup"><span data-stu-id="61507-159">Pass the username and password from the local login to the linked server.</span></span> <span data-ttu-id="61507-160">Для проверки подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на удаленном сервере должны существовать учетные данные входа с тем же самым именем и паролем.</span><span class="sxs-lookup"><span data-stu-id="61507-160">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, a login with the exact same name and password must exist on the remote server.</span></span> <span data-ttu-id="61507-161">Для имен входа Windows имя входа должно быть допустимым на связанном сервере.</span><span class="sxs-lookup"><span data-stu-id="61507-161">For Windows logins, the login must be a valid login on the linked server.</span></span>  
  
     <span data-ttu-id="61507-162">Чтобы использовать олицетворение, конфигурация должна соответствовать требованиям, предъявляемым к делегированию.</span><span class="sxs-lookup"><span data-stu-id="61507-162">To use impersonation, the configuration must meet the requirement for delegation.</span></span>  
  
     <span data-ttu-id="61507-163">**Удаленный пользователь**</span><span class="sxs-lookup"><span data-stu-id="61507-163">**Remote User**</span></span>  
     <span data-ttu-id="61507-164">Сопоставьте удаленного пользователя c пользователями, не определенными в **локальном имени входа**.</span><span class="sxs-lookup"><span data-stu-id="61507-164">Use the remote user to map users not defined in **Local login**.</span></span> <span data-ttu-id="61507-165">**Удаленный пользователь** на удаленном сервере должен представлять собой имя входа для проверки подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61507-165">The **Remote User** must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
     <span data-ttu-id="61507-166">**Пароль для удаленного входа**</span><span class="sxs-lookup"><span data-stu-id="61507-166">**Remote Password**</span></span>  
     <span data-ttu-id="61507-167">Указывает пароль удаленного пользователя.</span><span class="sxs-lookup"><span data-stu-id="61507-167">Specify the password of the Remote User.</span></span>  
  
     <span data-ttu-id="61507-168">**Добавление**</span><span class="sxs-lookup"><span data-stu-id="61507-168">**Add**</span></span>  
     <span data-ttu-id="61507-169">Добавляет новое локальное имя входа.</span><span class="sxs-lookup"><span data-stu-id="61507-169">Add a new local login.</span></span>  
  
     <span data-ttu-id="61507-170">**Удалить**</span><span class="sxs-lookup"><span data-stu-id="61507-170">**Remove**</span></span>  
     <span data-ttu-id="61507-171">Удаляет существующее локальное имя входа.</span><span class="sxs-lookup"><span data-stu-id="61507-171">Remove an existing local login.</span></span>  
  
     <span data-ttu-id="61507-172">**Не выполнять**</span><span class="sxs-lookup"><span data-stu-id="61507-172">**Not be made**</span></span>  
     <span data-ttu-id="61507-173">Указывает, что для имен входа, не определенных в списке, соединение невозможно.</span><span class="sxs-lookup"><span data-stu-id="61507-173">Specify that a connection will not be made for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="61507-174">**Выполняется без использования контекста безопасности**</span><span class="sxs-lookup"><span data-stu-id="61507-174">**Be made without using a security context**</span></span>  
     <span data-ttu-id="61507-175">Указывает, что для имен входа, не определенных в списке, соединение будет выполняться без использования контекста безопасности.</span><span class="sxs-lookup"><span data-stu-id="61507-175">Specify that a connection will be made without using a security context for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="61507-176">**Выполняется с использованием текущего контекста безопасности имени входа**</span><span class="sxs-lookup"><span data-stu-id="61507-176">**Be made using the login's current security context**</span></span>  
     <span data-ttu-id="61507-177">Указывает, что для имен входа, не определенных в списке, соединение будет выполняться с использованием текущего контекста безопасности имени входа.</span><span class="sxs-lookup"><span data-stu-id="61507-177">Specify that a connection will be made using the current security context of the login for logins not defined in the list.</span></span> <span data-ttu-id="61507-178">При наличии соединения с локальным сервером с использованием проверки подлинности Windows для подключения к удаленному серверу будут использоваться учетные данные Windows.</span><span class="sxs-lookup"><span data-stu-id="61507-178">If connected to the local server using Windows Authentication, your windows credentials will be used to connect to the remote server.</span></span> <span data-ttu-id="61507-179">При наличии соединения с локальным сервером с использованием проверки подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для подключения к удаленному серверу будут использоваться имя входа и пароль.</span><span class="sxs-lookup"><span data-stu-id="61507-179">If connected to the local server using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, login name and password will be used to connect to the remote server.</span></span> <span data-ttu-id="61507-180">В этом случае на удаленном сервере должны существовать учетные данные входа с теми же именем и паролем.</span><span class="sxs-lookup"><span data-stu-id="61507-180">In this case a login with the exact same name and password must exist on the remote server.</span></span>  
  
     <span data-ttu-id="61507-181">**Выполнять с использованием данного контекста безопасности**</span><span class="sxs-lookup"><span data-stu-id="61507-181">**Be made using this security context**</span></span>  
     <span data-ttu-id="61507-182">Указывает, что для имен входа, не определенных в списке, соединение будет выполняться при помощи имени входа и пароля, заданных в полях **Удаленный вход** и **С паролем** .</span><span class="sxs-lookup"><span data-stu-id="61507-182">Specify that a connection will be made using the login and password specified in the **Remote login** and **With password** boxes for logins not defined in the list.</span></span> <span data-ttu-id="61507-183">Удаленное имя входа на удаленном сервере должно представлять собой имя входа для проверки подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61507-183">The remote login must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
5.  <span data-ttu-id="61507-184">Для просмотра и установки параметров сервера можно также открыть страницу **Параметры сервера**  .</span><span class="sxs-lookup"><span data-stu-id="61507-184">Optionally, to view or specify server options, click the **Server Options**  page.</span></span>  
  
     <span data-ttu-id="61507-185">**Совместимые параметры сортировки**</span><span class="sxs-lookup"><span data-stu-id="61507-185">**Collation Compatible**</span></span>  
     <span data-ttu-id="61507-186">Влияет на выполнение распределенных запросов на связанных серверах.</span><span class="sxs-lookup"><span data-stu-id="61507-186">Affects Distributed Query execution against linked servers.</span></span> <span data-ttu-id="61507-187">Если этот параметр установлен в значение true, то [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] предполагает, что все символы в связанном сервере совместимы с локальным сервером в зависимости от набора символов и параметров сортировки (или порядка сортировки).</span><span class="sxs-lookup"><span data-stu-id="61507-187">If this option is set to true, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] assumes that all characters in the linked server are compatible with the local server, with regard to character set and collation sequence (or sort order).</span></span> <span data-ttu-id="61507-188">Это позволяет [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] отправлять поставщику сравнения по символьным столбцам.</span><span class="sxs-lookup"><span data-stu-id="61507-188">This enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to send comparisons on character columns to the provider.</span></span> <span data-ttu-id="61507-189">Если этот параметр не задан, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] всегда выполняет сравнения по символьным столбцам локально.</span><span class="sxs-lookup"><span data-stu-id="61507-189">If this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] always evaluates comparisons on character columns locally.</span></span>  
  
     <span data-ttu-id="61507-190">Этот параметр необходимо задать только в том случае, если источник данных, соответствующий связанному серверу, имеет тот же набор символов и тот же порядок сортировки, что и локальный сервер.</span><span class="sxs-lookup"><span data-stu-id="61507-190">This option should be set only if it is certain that the data source corresponding to the linked server has the same character set and sort order as the local server.</span></span>  
  
     <span data-ttu-id="61507-191">**Доступ к данным**</span><span class="sxs-lookup"><span data-stu-id="61507-191">**Data Access**</span></span>  
     <span data-ttu-id="61507-192">Разрешает и запрещает доступ распределенных запросов к связанному серверу.</span><span class="sxs-lookup"><span data-stu-id="61507-192">Enables and disables a linked server for distributed query access.</span></span>  
  
     <span data-ttu-id="61507-193">**RPC**</span><span class="sxs-lookup"><span data-stu-id="61507-193">**RPC**</span></span>  
     <span data-ttu-id="61507-194">Включает RPC с определенного сервера.</span><span class="sxs-lookup"><span data-stu-id="61507-194">Enables RPC from the specified server.</span></span>  
  
     <span data-ttu-id="61507-195">**RPC Out**</span><span class="sxs-lookup"><span data-stu-id="61507-195">**RPC Out**</span></span>  
     <span data-ttu-id="61507-196">Включает RPC на определенный сервер.</span><span class="sxs-lookup"><span data-stu-id="61507-196">Enables RPC to the specified server.</span></span>  
  
     <span data-ttu-id="61507-197">**Использовать параметры сортировки удаленного сервера**</span><span class="sxs-lookup"><span data-stu-id="61507-197">**Use Remote Collation**</span></span>  
     <span data-ttu-id="61507-198">Определяет, будут ли использоваться параметры сортировки удаленного столбца или локального сервера.</span><span class="sxs-lookup"><span data-stu-id="61507-198">Determines whether the collation of a remote column or of a local server will be used.</span></span>  
  
     <span data-ttu-id="61507-199">Если значение равно true, в источниках данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] используются параметры сортировки удаленных столбцов, а в не-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] источниках данных — режим, заданный в имени параметров сортировки.</span><span class="sxs-lookup"><span data-stu-id="61507-199">If true, the collation of remote columns is used for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources, and the collation specified in collation name is used for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources.</span></span>  
  
     <span data-ttu-id="61507-200">Если значение равно false, при распределенных запросах всегда будут использоваться установленные по умолчанию параметры сортировки на локальном сервере, в то время как имя параметров сортировки и параметры сортировки удаленных столбцов будут пропускаться.</span><span class="sxs-lookup"><span data-stu-id="61507-200">If false, distributed queries will always use the default collation of the local server, while collation name and the collation of remote columns are ignored.</span></span> <span data-ttu-id="61507-201">Значение по умолчанию – false.</span><span class="sxs-lookup"><span data-stu-id="61507-201">The default is false.</span></span>  
  
     <span data-ttu-id="61507-202">**Имя параметров сортировки**</span><span class="sxs-lookup"><span data-stu-id="61507-202">**Collation Name**</span></span>  
     <span data-ttu-id="61507-203">Позволяет задать имя параметров сортировки, используемое удаленным источником данных, если значение параметра «Использовать параметры сортировки удаленного сервера» равно true, а источник данных не является источником данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61507-203">Specifies the name of the collation used by the remote data source if use remote collation is true and the data source is not a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data source.</span></span> <span data-ttu-id="61507-204">Этот имя должно быть одним из параметров сортировки, поддерживаемых [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61507-204">The name must be one of the collations supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
     <span data-ttu-id="61507-205">Этот параметр используется при доступе к источнику данных OLE DB, отличному от [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], параметры сортировки которого совпадают с одним из параметров сортировки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61507-205">Use this option when accessing an OLE DB data source other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but whose collation matches one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="61507-206">Связанный сервер должен поддерживать использование единых параметров сортировки для всех столбцов на этом сервере.</span><span class="sxs-lookup"><span data-stu-id="61507-206">The linked server must support a single collation to be used for all columns in that server.</span></span> <span data-ttu-id="61507-207">Не задавайте этот параметр, если связанный сервер поддерживает несколько параметров сортировки для одного источника данных, или если невозможно определить, соответствуют ли параметры сортировки связанного сервера одному из параметров сортировки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61507-207">Do not set this option if the linked server supports multiple collations within a single data source, or if the linked server's collation cannot be determined to match one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="61507-208">**Время ожидания подключения**</span><span class="sxs-lookup"><span data-stu-id="61507-208">**Connection Timeout**</span></span>  
     <span data-ttu-id="61507-209">Значение времени ожидания соединения со связанным сервером.</span><span class="sxs-lookup"><span data-stu-id="61507-209">Time-out value in seconds for connecting to a linked server.</span></span>  
  
     <span data-ttu-id="61507-210">Если значение равно 0, используется значение, заданное через **sp_configure** по умолчанию, — [remote login timeout](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="61507-210">If 0, use the **sp_configure** default [remote login timeout](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="61507-211">**Время ожидания запроса**</span><span class="sxs-lookup"><span data-stu-id="61507-211">**Query Timeout**</span></span>  
     <span data-ttu-id="61507-212">Значение времени ожидания для запросов к связанному серверу, в секундах.</span><span class="sxs-lookup"><span data-stu-id="61507-212">Time-out value in seconds for queries against a linked server.</span></span>  
  
     <span data-ttu-id="61507-213">Если значение равно 0, используется значение, заданное через **sp_configure** по умолчанию, — [remote query timeout](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="61507-213">If 0, use the **sp_configure** default [remote query timeout](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="61507-214">**Разрешить продвижение распределенных транзакций**</span><span class="sxs-lookup"><span data-stu-id="61507-214">**Enable Promotion of Distributed Transactions**</span></span>  
     <span data-ttu-id="61507-215">Используйте этот параметр, чтобы защитить действия процедуры между серверами посредством транзакции координатора распределенных транзакций (Майкрософт) ( [!INCLUDE[msCoName](../../../includes/msconame-md.md)] DTC).</span><span class="sxs-lookup"><span data-stu-id="61507-215">Use this option to protect the actions of a server-to-server procedure through a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator (MS DTC) transaction.</span></span> <span data-ttu-id="61507-216">Если этот параметр имеет значение TRUE, то вызов удаленной хранимой процедуры приводит к запуску распределенной транзакции и прикрепляет к выполнению транзакции MS DTC.</span><span class="sxs-lookup"><span data-stu-id="61507-216">When this option is TRUE, calling a remote stored procedure starts a distributed transaction and enlists the transaction with MS DTC.</span></span> <span data-ttu-id="61507-217">Дополнительные сведения см. в статье [sp_serveroption (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="61507-217">For more information, see [sp_serveroption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span></span>  
  
6.  <span data-ttu-id="61507-218">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="61507-218">Click **OK**.</span></span>  
  
##### <a name="to-view-the-provider-options"></a><span data-ttu-id="61507-219">Просмотр параметров поставщика</span><span class="sxs-lookup"><span data-stu-id="61507-219">To view the provider options</span></span>  
  
-   <span data-ttu-id="61507-220">Чтобы просмотреть доступные параметры поставщика, откройте страницы **Параметры поставщиков** .</span><span class="sxs-lookup"><span data-stu-id="61507-220">To view the options that the provider makes available, click the **Providers Options** page.</span></span>  
  
     <span data-ttu-id="61507-221">У всех поставщиков нет общего набора доступных параметров.</span><span class="sxs-lookup"><span data-stu-id="61507-221">All providers do not have the same options available.</span></span> <span data-ttu-id="61507-222">Например, некоторые типы данных могут быть индексированы, а некоторые нет.</span><span class="sxs-lookup"><span data-stu-id="61507-222">For example, some types of data have indexes available and some might not.</span></span> <span data-ttu-id="61507-223">Используйте это диалоговое окно, чтобы ознакомить службы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с возможностями поставщика.</span><span class="sxs-lookup"><span data-stu-id="61507-223">Use this dialog box to help [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] understand the capabilities of the provider.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="61507-224">устанавливает несколько общих поставщиков данных, однако при изменении продукта, поставляющего данные, поставщик, установленный с помощью [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , может не поддерживать все новейшие функции.</span><span class="sxs-lookup"><span data-stu-id="61507-224">installs some common data providers, however when the product providing the data changes, the provider installed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might not support all the newest features.</span></span> <span data-ttu-id="61507-225">Лучшим источником сведений о возможностях продукта, поставляющего данные, является документация по продукту.</span><span class="sxs-lookup"><span data-stu-id="61507-225">The best source of information about the capabilities of the product providing the data is the documentation for that product.</span></span>  
  
     <span data-ttu-id="61507-226">**Динамический параметр**</span><span class="sxs-lookup"><span data-stu-id="61507-226">**Dynamic parameter**</span></span>  
     <span data-ttu-id="61507-227">Указывает, что поставщик разрешает использовать синтаксис маркеров параметров «?» для параметризованных запросов.</span><span class="sxs-lookup"><span data-stu-id="61507-227">Indicates that the provider allows '?' parameter marker syntax for parameterized queries.</span></span> <span data-ttu-id="61507-228">Установите этот параметр только в том случае, если поставщик поддерживает интерфейс **ICommandWithParameters** и символ «?» в качестве маркера параметров.</span><span class="sxs-lookup"><span data-stu-id="61507-228">Set this option only if the provider supports the **ICommandWithParameters** interface and supports a '?' as the parameter marker.</span></span> <span data-ttu-id="61507-229">Установка этого параметра позволяет [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] выполнять параметризованные запросы к поставщику.</span><span class="sxs-lookup"><span data-stu-id="61507-229">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute parameterized queries against the provider.</span></span> <span data-ttu-id="61507-230">Возможность выполнять параметризованные запросы к поставщику может повысить производительность некоторых запросов.</span><span class="sxs-lookup"><span data-stu-id="61507-230">The ability to execute parameterized queries against the provider can result in better performance for certain queries.</span></span>  
  
     <span data-ttu-id="61507-231">**Вложенные запросы**</span><span class="sxs-lookup"><span data-stu-id="61507-231">**Nested queries**</span></span>  
     <span data-ttu-id="61507-232">Указывает, что поставщик разрешает вложенные инструкции  `SELECT` в предложении FROM.</span><span class="sxs-lookup"><span data-stu-id="61507-232">Indicates that the provider allows nested  `SELECT` statements in the FROM clause.</span></span> <span data-ttu-id="61507-233">Установка этого параметра позволяет [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] делегировать поставщику определенные запросы, требующие вложенных инструкций SELECT в предложении FROM.</span><span class="sxs-lookup"><span data-stu-id="61507-233">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to delegate certain queries to the provider that require nesting SELECT statements in the FROM clause.</span></span>  
  
     <span data-ttu-id="61507-234">**Только нулевой уровень**</span><span class="sxs-lookup"><span data-stu-id="61507-234">**Level zero only**</span></span>  
     <span data-ttu-id="61507-235">Для поставщика вызываются только интерфейсы OLE DB уровня 0.</span><span class="sxs-lookup"><span data-stu-id="61507-235">Only level 0 OLE DB interfaces are invoked against the provider.</span></span>  
  
     <span data-ttu-id="61507-236">**Допускать в ходе процесса**</span><span class="sxs-lookup"><span data-stu-id="61507-236">**Allow inprocess**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="61507-237">разрешает создание экземпляра поставщика в виде внутрипроцессного сервера.</span><span class="sxs-lookup"><span data-stu-id="61507-237">allows the provider to be instantiated as an in-process server.</span></span> <span data-ttu-id="61507-238">Если этот параметр не установлен, поведением по умолчанию является создание экземпляра поставщика вне процесса [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61507-238">When this option is not set, the default behavior is to instantiate the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="61507-239">Создание экземпляра поставщика вне процесса [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] защищает процесс [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] от ошибок в поставщике.</span><span class="sxs-lookup"><span data-stu-id="61507-239">Instantiating the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process protects the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process from errors in the provider.</span></span> <span data-ttu-id="61507-240">Если экземпляр поставщика создается вне процесса [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], обновления или вставки, ссылающиеся на длинные столбцы (`text`, `ntext` или `image`), не разрешаются.</span><span class="sxs-lookup"><span data-stu-id="61507-240">When the provider is instantiated outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process, updates or inserts referencing long columns (`text`, `ntext`, or `image`) are not allowed.</span></span>  
  
     <span data-ttu-id="61507-241">**Обновления без использования транзакций**</span><span class="sxs-lookup"><span data-stu-id="61507-241">**Non transacted updates**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="61507-242">разрешает обновления, даже если недоступен интерфейс **ITransactionLocal** .</span><span class="sxs-lookup"><span data-stu-id="61507-242">allows updates, even if **ITransactionLocal** is not available.</span></span> <span data-ttu-id="61507-243">Если этот параметр включен, обновления поставщика необратимы, поскольку этот поставщик не поддерживает транзакции.</span><span class="sxs-lookup"><span data-stu-id="61507-243">If this option is enabled, updates against the provider are not recoverable, because the provider does not support transactions.</span></span>  
  
     <span data-ttu-id="61507-244">**Индекс в качестве пути доступа**</span><span class="sxs-lookup"><span data-stu-id="61507-244">**Index as access path**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="61507-245">пытается использовать индексы поставщика для выборки данных.</span><span class="sxs-lookup"><span data-stu-id="61507-245">attempts to use indexes of the provider to fetch data.</span></span> <span data-ttu-id="61507-246">По умолчанию индексы используются только для метаданных и никогда не открываются.</span><span class="sxs-lookup"><span data-stu-id="61507-246">By default, indexes are used only for metadata and are never opened</span></span>  
  
     <span data-ttu-id="61507-247">**Запретить нерегламентированный доступ**</span><span class="sxs-lookup"><span data-stu-id="61507-247">**Disallow ad hoc access**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="61507-248">не разрешает нерегламентированный доступ с помощью функций OPENROWSET и OPENDATASOURCE к поставщику OLE DB.</span><span class="sxs-lookup"><span data-stu-id="61507-248">does not allow ad hoc access through the OPENROWSET and OPENDATASOURCE functions against the OLE DB provider.</span></span> <span data-ttu-id="61507-249">Если этот параметр не задан, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] также не разрешает нерегламентированный доступ.</span><span class="sxs-lookup"><span data-stu-id="61507-249">When this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] also does not allow ad hoc access.</span></span>  
  
     <span data-ttu-id="61507-250">**Поддерживает оператор Like.**</span><span class="sxs-lookup"><span data-stu-id="61507-250">**Supports 'Like' operator**</span></span>  
     <span data-ttu-id="61507-251">Указывает, что поставщик поддерживает запросы с использованием ключевого слова LIKE.</span><span class="sxs-lookup"><span data-stu-id="61507-251">Indicates that the provider supports queries using the LIKE key word.</span></span>  
  
###  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="61507-252">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="61507-252">Using Transact-SQL</span></span>  
 <span data-ttu-id="61507-253">Чтобы создать связанный сервер с помощью [!INCLUDE[tsql](../../includes/tsql-md.md)], используйте инструкции [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)[CREATE LOGIN (Transact-SQL)](/sql/t-sql/statements/create-login-transact-sql) и [sp_addlinkedsrvlogin (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="61507-253">To create a linked server by using [!INCLUDE[tsql](../../includes/tsql-md.md)], use the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) and [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql) statements.</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-transact-sql"></a><span data-ttu-id="61507-254">Создание связанного сервера для другого экземпляра SQL Server с помощью Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="61507-254">To create a linked server to another instance of SQL Server using Transact-SQL</span></span>  
  
1.  <span data-ttu-id="61507-255">В редакторе запросов введите следующую команду [!INCLUDE[tsql](../../includes/tsql-md.md)] , чтобы установить связь с экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с именем `SRVR002\ACCTG`:</span><span class="sxs-lookup"><span data-stu-id="61507-255">In Query Editor, enter the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command to link to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] named `SRVR002\ACCTG`:</span></span>  
  
    ```sql  
    USE [master]  
    GO  
    EXEC master.dbo.sp_addlinkedserver   
        @server = N'SRVR002\ACCTG',   
        @srvproduct=N'SQL Server' ;  
    GO  
  
    ```  
  
2.  <span data-ttu-id="61507-256">Выполните следующий код, чтобы настроить связанный сервер для использования учетных данных домена для имени входа, которое использует связанный сервер.</span><span class="sxs-lookup"><span data-stu-id="61507-256">Execute the following code to configure the linked server to use the domain credentials of the login that is using the linked server.</span></span>  
  
    ```sql  
    EXEC master.dbo.sp_addlinkedsrvlogin   
        @rmtsrvname = N'SRVR002\ACCTG',   
        @locallogin = NULL ,   
        @useself = N'True' ;  
    GO  
  
    ```  
  
##  <a name="follow-up-steps-to-take-after-you-create-a-linked-server"></a><a name="FollowUp"></a><span data-ttu-id="61507-257">Дальнейшие действия. шаги, выполняемые после создания связанного сервера</span><span class="sxs-lookup"><span data-stu-id="61507-257">Follow Up: Steps to take after you create a linked server</span></span>  
  
#### <a name="to-test-the-linked-server"></a><span data-ttu-id="61507-258">Проверка связанного сервера</span><span class="sxs-lookup"><span data-stu-id="61507-258">To test the linked server</span></span>  
  
-   <span data-ttu-id="61507-259">Выполните следующий код, чтобы проверить соединение со связанным сервером.</span><span class="sxs-lookup"><span data-stu-id="61507-259">Execute the following code to test the connection to the linked server.</span></span> <span data-ttu-id="61507-260">Этот пример возвращает имена баз данных на связанном сервере.</span><span class="sxs-lookup"><span data-stu-id="61507-260">This example the returns the names of the databases on the linked server.</span></span>  
  
    ```sql  
    SELECT name FROM [SRVR002\ACCTG].master.sys.databases ;  
    GO  
  
    ```  
  
#### <a name="writing-a-query-that-joins-tables-from-a-linked-server"></a><span data-ttu-id="61507-261">Создание запроса, соединяющего таблицы со связанного сервера</span><span class="sxs-lookup"><span data-stu-id="61507-261">Writing a query that joins tables from a linked server</span></span>  
  
-   <span data-ttu-id="61507-262">Для ссылки на объект, расположенный на связанном сервере, используйте четырехкомпонентные имена.</span><span class="sxs-lookup"><span data-stu-id="61507-262">Use four-part names to refer to an object on a linked server.</span></span> <span data-ttu-id="61507-263">Выполните следующий код, чтобы получить список всех имен входа на локальном сервере и соответствующих имен входа на связанном сервере.</span><span class="sxs-lookup"><span data-stu-id="61507-263">Execute the following code to return a list of all logins on the local server and their matching logins on the linked server.</span></span>  
  
    ```sql  
    SELECT local.name AS LocalLogins, linked.name AS LinkedLogins  
    FROM master.sys.server_principals AS local  
    LEFT JOIN [SRVR002\ACCTG].master.sys.server_principals AS linked  
        ON local.name = linked.name ;  
    GO  
    ```  
  
     <span data-ttu-id="61507-264">Если для имени входа связанного сервера возвращается значение NULL, это значит, что имя входа не существует на связанном сервере.</span><span class="sxs-lookup"><span data-stu-id="61507-264">When NULL is returned for the linked server login it indicates that the login does not exist on the linked server.</span></span> <span data-ttu-id="61507-265">Такие имена входа не смогут использовать связанный сервер, если на нем не настроена передача другого контекста безопасности и он не принимает анонимные подключения.</span><span class="sxs-lookup"><span data-stu-id="61507-265">These logins will not be able to use the linked server unless the linked server is configured to pass a different security context or the linked server accepts anonymous connections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="61507-266">См. также:</span><span class="sxs-lookup"><span data-stu-id="61507-266">See Also</span></span>  
 <span data-ttu-id="61507-267">[Связанные серверы (компонент Database Engine)](linked-servers-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="61507-267">[Linked Servers &#40;Database Engine&#41;](linked-servers-database-engine.md) </span></span>  
 <span data-ttu-id="61507-268">[sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="61507-268">[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span></span>  
 [<span data-ttu-id="61507-269">sp_serveroption (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="61507-269">sp_serveroption &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql)  
  
  
