---
title: Связанные серверы (ядро СУБД) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB, linked servers
- OLE DB provider, linked servers
- server management [SQL Server], linked servers
- linked servers [SQL Server]
- distributed queries [SQL Server], linked servers
- servers [SQL Server], linked
- remote servers [SQL Server], linked servers
- linked servers [SQL Server], about linked servers
ms.assetid: 6ef578bf-8da7-46e0-88b5-e310fc908bb0
author: stevestein
ms.author: sstein
ms.openlocfilehash: 4a1de70882cdeb87ccc0ae42aa23a9b6c8b3248e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655150"
---
# <a name="linked-servers-database-engine"></a><span data-ttu-id="c1a0f-102">Связанные серверы (компонент Database Engine)</span><span class="sxs-lookup"><span data-stu-id="c1a0f-102">Linked Servers (Database Engine)</span></span>
  <span data-ttu-id="c1a0f-103">Настройте связанный сервер, чтобы включить [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] для выполнения команд в источниках данных OLE DB вне экземпляра [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c1a0f-103">Configure a linked server to enable the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to execute commands against OLE DB data sources outside of the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="c1a0f-104">Обычно связанные серверы настроены на включение компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] для выполнения инструкции [!INCLUDE[tsql](../../includes/tsql-md.md)] , включающей таблицы в другом экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]или другом продукте для работы с базами данных, например Oracle.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-104">Typically linked servers are configured to enable the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to execute a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that includes tables in another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], or another database product such as Oracle.</span></span> <span data-ttu-id="c1a0f-105">В качестве связанных серверов можно настроить источники данных OLE DB многих типов, в том числе [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access и Excel.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-105">Many types OLE DB data sources can be configured as linked servers, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access and Excel.</span></span> <span data-ttu-id="c1a0f-106">Концепция связанных серверов имеет следующие преимущества.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-106">Linked servers offer the following advantages:</span></span>

-   <span data-ttu-id="c1a0f-107">Возможность доступа к данным за пределами [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c1a0f-107">The ability to access data from outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

-   <span data-ttu-id="c1a0f-108">Возможность осуществлять распределенные запросы, обновления, команды и транзакции на разнородных источниках данных по всему предприятию.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-108">The ability to issue distributed queries, updates, commands, and transactions on heterogeneous data sources across the enterprise.</span></span>

-   <span data-ttu-id="c1a0f-109">Возможность единообразной адресации разных источников данных.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-109">The ability to address diverse data sources similarly.</span></span>

 <span data-ttu-id="c1a0f-110">Можно настроить связанный сервер, используя инструкцию [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] или [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="c1a0f-110">You can configure a linked server by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or by using the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) statement.</span></span> <span data-ttu-id="c1a0f-111">Поставщики OLE DB существенно различаются по типу и количеству необходимых параметров.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-111">OLE DB providers vary greatly in the type and number of parameters required.</span></span> <span data-ttu-id="c1a0f-112">Например, некоторые поставщики требуют предоставления контекста безопасности для соединения с помощью [sp_addlinkedsrvlogin (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c1a0f-112">For example some providers require you to provide a security context for the connection using [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span></span> <span data-ttu-id="c1a0f-113">Некоторые поставщики OLE DB разрешают использовать [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для обновления данных в источнике данных OLE DB.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-113">Some OLE DB providers allow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to update data on the OLE DB source.</span></span> <span data-ttu-id="c1a0f-114">Другие предоставляют доступ к данным только для чтения.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-114">Others provide only read-only data access.</span></span> <span data-ttu-id="c1a0f-115">Для информации о каждом поставщике OLE DB обратитесь к документации об этом поставщике OLE DB.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-115">For information about each OLE DB provider, consult documentation for that OLE DB provider.</span></span>

## <a name="linked-server-components"></a><span data-ttu-id="c1a0f-116">Компоненты связанных серверов</span><span class="sxs-lookup"><span data-stu-id="c1a0f-116">Linked Server Components</span></span>
 <span data-ttu-id="c1a0f-117">Определение связанного сервера задает следующие объекты.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-117">A linked server definition specifies the following objects:</span></span>

-   <span data-ttu-id="c1a0f-118">Поставщик OLE DB</span><span class="sxs-lookup"><span data-stu-id="c1a0f-118">An OLE DB provider</span></span>

-   <span data-ttu-id="c1a0f-119">Источник данных OLE DB</span><span class="sxs-lookup"><span data-stu-id="c1a0f-119">An OLE DB data source</span></span>

 <span data-ttu-id="c1a0f-120">*Поставщиком OLE DB* является динамическая библиотека, осуществляющая управление и взаимодействие с определенными источниками данных.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-120">An *OLE DB provider* is a DLL that manages and interacts with a specific data source.</span></span> <span data-ttu-id="c1a0f-121">*Источник данных OLE DB* определяет конкретную базу данных, доступ к которой выполняется через интерфейс OLE DB.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-121">An *OLE DB data source* identifies the specific database that can be accessed through OLE DB.</span></span> <span data-ttu-id="c1a0f-122">Хотя источники данных, запросы к которым выполняются с помощью определений связанных серверов, являются обычными базами данных, существуют поставщики OLE DB для разнообразных файлов и форматов файлов.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-122">Although data sources queried through linked server definitions are ordinarily databases, OLE DB providers exist for a variety of files and file formats.</span></span> <span data-ttu-id="c1a0f-123">Сюда входят текстовые файлы, данные электронных таблиц и результаты поиска полнотекстового содержимого.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-123">These include text files, spreadsheet data, and the results of full-text content searches.</span></span>

 <span data-ttu-id="c1a0f-124">[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Поставщик OLE DB собственного клиента (ProgID: SQLNCLI11) является официальным поставщиком OLE DB для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c1a0f-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider (PROGID: SQLNCLI11) is the official OLE DB provider for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

> [!NOTE]
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="c1a0f-125">предназначены для работы с поставщиком OLE DB, реализующим необходимые интерфейсы OLE DB.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-125">distributed queries are designed to work with any OLE DB provider that implements the required OLE DB interfaces.</span></span> <span data-ttu-id="c1a0f-126">Однако работа [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] проверялась только с поставщиком Native Client OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и некоторыми другими поставщиками.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-126">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has been tested against only the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider and certain other providers.</span></span>

## <a name="linked-server-details"></a><span data-ttu-id="c1a0f-127">Подробности настройки связанных серверов</span><span class="sxs-lookup"><span data-stu-id="c1a0f-127">Linked Server Details</span></span>
 <span data-ttu-id="c1a0f-128">На следующей иллюстрации показаны основы настройки связанных серверов.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-128">The following illustration shows the basics of a linked server configuration.</span></span>

 <span data-ttu-id="c1a0f-129">![Уровень клиента, уровень сервера и уровень сервера баз данных](../../database-engine/media/lsvr.gif "Уровень клиента, уровень сервера и уровень сервера баз данных")</span><span class="sxs-lookup"><span data-stu-id="c1a0f-129">![Client tier, server tier, and database server tier](../../database-engine/media/lsvr.gif "Client tier, server tier, and database server tier")</span></span>

 <span data-ttu-id="c1a0f-130">Обычно связанные серверы используются для обработки распределенных запросов.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-130">Typically, linked servers are used to handle distributed queries.</span></span> <span data-ttu-id="c1a0f-131">Если клиентское приложение выполняет распределенный запрос через связанный сервер, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] проводит синтаксический анализ команды и передает запросы поставщику OLE DB.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-131">When a client application executes a distributed query through a linked server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] parses the command and sends requests to OLE DB.</span></span> <span data-ttu-id="c1a0f-132">Запрос на набор строк может быть в форме выполнения запроса к поставщику или в форме открытия базовой таблицы из поставщика.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-132">The rowset request may be in the form of executing a query against the provider or opening a base table from the provider.</span></span>

 <span data-ttu-id="c1a0f-133">Чтобы источник данных мог вернуть данные при помощи связанного сервера, поставщик OLE DB (динамическая библиотека) для этого источника данных должен присутствовать на том же сервере, что и экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c1a0f-133">For a data source to return data through a linked server, the OLE DB provider (DLL) for that data source must be present on the same server as the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="c1a0f-134">При использовании поставщика OLE DB стороннего разработчика учетная запись, под которой выполняется служба сервера [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , должна иметь разрешения на чтение и выполнение для каталога и всех его подкаталогов, в котором установлен поставщик.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-134">When a third-party OLE DB provider is used, the account under which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service runs must have read and execute permissions for the directory, and all subdirectories, in which the provider is installed.</span></span>

## <a name="managing-providers"></a><span data-ttu-id="c1a0f-135">Управление поставщиками</span><span class="sxs-lookup"><span data-stu-id="c1a0f-135">Managing Providers</span></span>
 <span data-ttu-id="c1a0f-136">Имеется набор параметров, определяющих, как [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] загружает и использует поставщики OLE DB, заданные в реестре.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-136">There is a set of options that control how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] loads and uses OLE DB providers that are specified in the registry.</span></span>

## <a name="managing-linked-server-definitions"></a><span data-ttu-id="c1a0f-137">Управление определениями связанных серверов</span><span class="sxs-lookup"><span data-stu-id="c1a0f-137">Managing Linked Server Definitions</span></span>
 <span data-ttu-id="c1a0f-138">При установке связанного сервера зарегистрируйте параметры соединения и источника данных при помощи [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c1a0f-138">When you are setting up a linked server, register the connection information and data source information with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="c1a0f-139">После регистрации к этому источнику данных можно обращаться по одному логическому имени.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-139">After registered, that data source can be referred to with a single logical name.</span></span>

 <span data-ttu-id="c1a0f-140">Для управления определениями связанного сервера можно использовать хранимые процедуры и представления каталога.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-140">You can use stored procedures and catalog views to manage linked server definitions:</span></span>

-   <span data-ttu-id="c1a0f-141">Создайте определение связанного сервера, выполнив процедуру **sp_addlinkedserver**.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-141">Create a linked server definition by running **sp_addlinkedserver**.</span></span>

-   <span data-ttu-id="c1a0f-142">Просмотрите сведения о связанных серверах, определенных в конкретном экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , выполнив запрос к представлениям системного каталога **sys.servers** .</span><span class="sxs-lookup"><span data-stu-id="c1a0f-142">View information about the linked servers defined in a specific instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by running a query against the **sys.servers** system catalog views.</span></span>

-   <span data-ttu-id="c1a0f-143">Удалите определение связанного сервера, выполнив процедуру **sp_dropserver**.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-143">Delete a linked server definition by running **sp_dropserver**.</span></span> <span data-ttu-id="c1a0f-144">Эта хранимая процедура может также использоваться для удаления удаленного сервера.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-144">You can also use this stored procedure to remove a remote server.</span></span>

 <span data-ttu-id="c1a0f-145">Определять связанные серверы можно также в среде [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c1a0f-145">You can also define linked servers by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="c1a0f-146">В обозревателе объектов щелкните правой кнопкой мыши **Объекты сервера**, выберите **Создать**и выберите **Связанный сервер**.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-146">In the Object Explorer, right-click **Server Objects**, select **New**, and select **Linked Server**.</span></span> <span data-ttu-id="c1a0f-147">Определение связанного сервера можно удалить, щелкнув правой кнопкой мыши имя связанного сервера и выбрав **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-147">You can delete a linked server definition by right-clicking the linked server name and selecting **Delete**.</span></span>

 <span data-ttu-id="c1a0f-148">При выполнении распределенного запроса к связанному серверу необходимо указать полное, состоящее из четырех частей имя таблицы для каждого источника данных, к которому выполняется запрос.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-148">When you execute a distributed query against a linked server, include a fully qualified, four-part table name for each data source to query.</span></span> <span data-ttu-id="c1a0f-149">Это имя состоит из четырех частей в формате _linked_server_name. catalog_**. _`schema`_ .** _object_name_.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-149">This four-part name should be in the form _linked_server_name.catalog_**._`schema`_.**_object_name_.</span></span>

> [!NOTE]
>  <span data-ttu-id="c1a0f-150">Связанные серверы могут быть определены таким образом, чтобы указывать на сервер, на котором они определены (обратная связь).</span><span class="sxs-lookup"><span data-stu-id="c1a0f-150">Linked servers can be defined to point back (loop back) to the server on which they are defined.</span></span> <span data-ttu-id="c1a0f-151">Серверы с обратной связью наиболее полезны для тестирования приложения, в котором используются распределенные запросы в односерверной сети.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-151">Loopback servers are most useful when testing an application that uses distributed queries on a single server network.</span></span> <span data-ttu-id="c1a0f-152">Серверы, связанные с помощью петлевого адреса, предназначены для тестирования и не поддерживаются во многих операциях, таких как распределенные транзакции.</span><span class="sxs-lookup"><span data-stu-id="c1a0f-152">Loopback linked servers are intended for testing and are not supported for many operations, such as distributed transactions.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="c1a0f-153">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="c1a0f-153">Related Tasks</span></span>
 [<span data-ttu-id="c1a0f-154">Создание связанных серверов &#40;компонент SQL Server Database Engine&#41;</span><span class="sxs-lookup"><span data-stu-id="c1a0f-154">Create Linked Servers &#40;SQL Server Database Engine&#41;</span></span>](create-linked-servers-sql-server-database-engine.md)

 [<span data-ttu-id="c1a0f-155">sp_addlinkedserver (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c1a0f-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)

 [<span data-ttu-id="c1a0f-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="c1a0f-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql)

 [<span data-ttu-id="c1a0f-157">sp_dropserver (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c1a0f-157">sp_dropserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-dropserver-transact-sql)

## <a name="related-content"></a><span data-ttu-id="c1a0f-158">См. также</span><span class="sxs-lookup"><span data-stu-id="c1a0f-158">Related Content</span></span>
 [<span data-ttu-id="c1a0f-159">sys.servers (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c1a0f-159">sys.servers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-servers-transact-sql)

 [<span data-ttu-id="c1a0f-160">sp_linkedservers (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c1a0f-160">sp_linkedservers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-linkedservers-transact-sql)


