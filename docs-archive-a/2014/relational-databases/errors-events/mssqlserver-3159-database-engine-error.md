---
title: MSSQLSERVER_3159 | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- 3159 (Database Engine error)
ms.assetid: c93c1003-0e3a-40aa-9873-44a0f5b8b57e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 6b469842b2aab15980c72ea01e46270c55ef29e5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664244"
---
# <a name="mssqlserver_3159"></a>MSSQLSERVER_3159
    
## <a name="details"></a>Сведения  
  
|||  
|-|-|  
|Название продукта|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]|  
|Идентификатор события|3159|  
|Источник события|MSSQLSERVER|  
|Компонент|SQLEngine|  
|Символическое имя|LDDB_LOGNOTBACKEDUP|  
|Текст сообщения|Не удалось создать резервную копию заключительного фрагмента журнала базы данных «%s». Если журнал содержит работу, потеря которой нежелательна, создайте резервную копию с помощью инструкции BACKUP LOG WITH NORECOVERY. Чтобы просто перезаписать содержимое журнала, используются предложения WITH REPLACE или WITH STOPAT с инструкцией RESTORE.|  
  
## <a name="explanation"></a>Объяснение  
 В большинстве случаев при использовании модели восстановления с неполным протоколированием или полной модели в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] необходимо создать резервную копию заключительного фрагмента журнала, чтобы захватить записи журнала, резервной копии которых еще нет. Резервная копия журнала, созданная для заключительного фрагмента журнала непосредственно перед операцией восстановления, называется резервной копией заключительного фрагмента журнала.  
  
 При восстановлении базы данных в состояние на момент сбоя резервная копия заключительного фрагмента журнала является наименее важной в плане восстановления. Если резервную копию заключительного фрагмента журнала создать невозможно, то базу данных можно восстановить только до конца последней резервной копии, созданной до сбоя.  
  
 Обычно в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] перед восстановлением резервной копии базы данных необходимо создавать резервную копию заключительного фрагмента журнала. Резервная копия заключительного фрагмента журнала предотвращает потерю работы и поддерживает целостность цепочки журналов. Однако резервная копия заключительного фрагмента журнала требуется не для всех сценариев восстановления. Резервная копия заключительного фрагмента журнала не нужна, если точка восстановления содержится в более ранней резервной копии журнала или если выполняется перемещение или замещение (перезапись) базы данных, когда не нужно восстанавливать ее на определенный момент времени после последней резервной копии. Кроме того, если файлы журналов повреждены и невозможно создать резервную копию заключительного фрагмента журнала, то восстанавливать базу данных следует без использования резервной копии заключительного фрагмента журнала. Будут потеряны любые транзакции, зафиксированные после создания последней резервной копии журнала. Дополнительные сведения см. ниже в подразделе «Восстановление без использования резервной копии заключительного фрагмента журнала».  
  
> [!CAUTION]  
>  Параметр REPLACE следует использовать редко и очень аккуратно.  
  
## <a name="user-action"></a>Действие пользователя  
 Создайте резервную копию заключительного фрагмента журнала и повторите операцию восстановления.  
  
 Если не удается создать резервную копию заключительного фрагмента журнала, то следует использовать предложения WITH STOPAT или WITH REPLACE с инструкцией RESTORE.  
  
## <a name="see-also"></a>См. также:  
 [Восстановление базы данных SQL Server до определенного момента времени (модель полного восстановления)](../backup-restore/restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md)   
 [Создайте резервную копию журнала транзакций, если база данных повреждена &#40;SQL Server&#41;](../backup-restore/back-up-the-transaction-log-when-the-database-is-damaged-sql-server.md)   
 [Создание резервной копии журнала транзакций (SQL Server)](../backup-restore/back-up-a-transaction-log-sql-server.md)   
 [Резервные копии заключительного фрагмента журнала (SQL Server)](../backup-restore/tail-log-backups-sql-server.md)  
  
  
