---
title: MSSQLSERVER_17832 | Документация Майкрософт
ms.custom: ''
ms.date: 12/29/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- 17828 (Database Engine error)
- maxtokensize
- 17832 (Database Engine error)
- login packet (bad)
ms.assetid: bd56ffe4-0855-4ada-8aca-251fbc6ff2ce
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: dba214e2cce04ff2583e12ae7cee9b54373390a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729542"
---
# <a name="mssqlserver_17832"></a>MSSQLSERVER_17832
    
## <a name="details"></a>Сведения  
  
|||  
|-|-|  
|Название продукта|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]|  
|Идентификатор события|17832|  
|Источник события|MSSQLSERVER|  
|Компонент|SQLEngine|  
|Символическое имя|SRV_BAD_LOGIN_PKT|  
|Текст сообщения|Неправильная структура пакета входа, используемого для установления соединения. Соединение закрыто. Свяжитесь с поставщиком клиентской библиотеки.%.*ls|  
  
## <a name="explanation"></a>Объяснение  
 Компьютер [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не смог обработать пакет входа клиента. Причиной может быть неверно созданный пакет или повреждение пакета в процессе передачи. Неполадка также может быть вызвана конфигурацией компьютера [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Указанный IP-адрес является адресом клиентского компьютера.  
  
### <a name="more-information"></a>Дополнительные сведения  
 При использовании проверки подлинности Windows в среде Kerberos клиент получает билет Kerberos, в котором содержится сертификат атрибута прав доступа (PAC). Сертификат PAC содержит различные типы авторизации данных, в том числе группы, членом которых является пользователь, права пользователя и политики, применяемые к пользователю. Когда клиент получает билет Kerberos, сведения сертификата PAC используются для формирования токена доступа пользователя. Клиент представляет токен компьютеру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] как часть пакета входа.  
  
 Если токен был неверно сформирован или поврежден при передаче, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не может выдать дополнительные сведения о неполадке.  
  
 Если пользователь является членом нескольких групп или имеет несколько политик, размер токена может стать слишком большим, что делает невозможным его просмотр. Если размер токена становится больше, чем значение **MaxTokenSize**, установленное на компьютере сервера, клиент при попытке установить соединение получает сообщение об "общей сетевой ошибке", а также может возвращаться ошибка 17832. Эта неполадка может затронуть лишь некоторых пользователей, которым соответствует несколько групп и политик. Если проблема заключается в значении **MaxTokenSize** на компьютере сервера, ошибка 17832 в журнале ошибок [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] будет сопровождаться ошибкой с состоянием 9. Дополнительные сведения о Kerberos и параметре **MaxTokenSize** см. в описании [KB327825](https://support.microsoft.com/kb/327825).  
  
## <a name="user-action"></a>Действие пользователя  
 Чтобы устранить эту проблему, увеличьте значение **MaxTokenSize** на компьютере сервера, чтобы оно было достаточным для самого большого токена любого пользователя в организации. Чтобы выяснить нужный размер токена для вашей организации, можно использовать программу **Tokensz**.   
  
> [!CAUTION]  
>  [!INCLUDE[ssNoteRegistry](../../includes/ssnoteregistry-md.md)]  
  
 **Изменение MaxTokenSize на компьютере сервера**  
  
1.  В меню **Пуск** выберите команду **Выполнить**.  
  
2.  Введите `regedit` , а затем нажмите кнопку **ОК**. (Если появится диалоговое окно **Контроль учетных записей**, нажмите в нем кнопку **Продолжить**).  
  
3.  Перейдите к разделу **HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\Kerberos\Parameters**.  
  
4.  Если параметр **MaxTokenSize** отсутствует, щелкните правой кнопкой мыши **Параметры**, выберите пункт **Создать**, а затем формат значения **DWORD (32 бита)** . Присвойте новому параметру реестра имя **MaxTokenSize**.  
  
5.  Щелкните правой кнопкой мыши параметр **MaxTokenSize** и выберите команду **Изменить**.  
  
6.  В текстовом поле **Значение** введите нужное значение для **MaxTokenSize**.  
  
    > [!NOTE]  
    >  Шестнадцатеричное значение ffff (десятичное значение 65535) — максимальный рекомендуемый размер токена. Использование этого значения, вероятно, разрешит проблему, но может оказать негативное влияние на производительность всего компьютера. Мы рекомендуем вычислить и установить такое значение **MaxTokenSize**, которого будет достаточно для самого большого токена любого пользователя в вашей организации.  
  
7.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
8.  Закройте **редактор реестра**.  
  
9. Перезагрузите компьютер.  
  
  
