---
title: Преобразования из SQL в C | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], SQL to C
ms.assetid: 059431e2-a65c-4587-ba4a-9929a1611e96
author: rothja
ms.author: jroth
ms.openlocfilehash: 0cc1fe6049824217a12a291b7006599a4a3a7319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666549"
---
# <a name="conversions-from-sql-to-c"></a><span data-ttu-id="33f4e-102">Преобразования из SQL в C</span><span class="sxs-lookup"><span data-stu-id="33f4e-102">Conversions from SQL to C</span></span>
  <span data-ttu-id="33f4e-103">В следующей таблице приводится список вопросов, которые следует учитывать при преобразовании типов даты-времени [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в типы языка C.</span><span class="sxs-lookup"><span data-stu-id="33f4e-103">The following table lists issues to consider when you convert from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types to C types.</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="33f4e-104">Преобразования</span><span class="sxs-lookup"><span data-stu-id="33f4e-104">Conversions</span></span>  
  
||||||||||  
|-|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="33f4e-105">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="33f4e-105">SQL_C_DATE</span></span>|<span data-ttu-id="33f4e-106">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="33f4e-106">SQL_C_TIME</span></span>|<span data-ttu-id="33f4e-107">SQL_C_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="33f4e-107">SQL_C_TIMESTAMP</span></span>|<span data-ttu-id="33f4e-108">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="33f4e-108">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="33f4e-109">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="33f4e-109">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="33f4e-110">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="33f4e-110">SQL_C_BINARY</span></span>|<span data-ttu-id="33f4e-111">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="33f4e-111">SQL_C_CHAR</span></span>|<span data-ttu-id="33f4e-112">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="33f4e-112">SQL_C_WCHAR</span></span>|  
|<span data-ttu-id="33f4e-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="33f4e-113">SQL_CHAR</span></span>|<span data-ttu-id="33f4e-114">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="33f4e-114">2,3,4,5</span></span>|<span data-ttu-id="33f4e-115">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="33f4e-115">2,3,6,7,8</span></span>|<span data-ttu-id="33f4e-116">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="33f4e-116">2,3,9,10,11</span></span>|<span data-ttu-id="33f4e-117">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="33f4e-117">2,3,6,7</span></span>|<span data-ttu-id="33f4e-118">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="33f4e-118">2,3,9,10,11</span></span>|<span data-ttu-id="33f4e-119">1</span><span class="sxs-lookup"><span data-stu-id="33f4e-119">1</span></span>|<span data-ttu-id="33f4e-120">1</span><span class="sxs-lookup"><span data-stu-id="33f4e-120">1</span></span>|<span data-ttu-id="33f4e-121">1</span><span class="sxs-lookup"><span data-stu-id="33f4e-121">1</span></span>|  
|<span data-ttu-id="33f4e-122">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="33f4e-122">SQL_WCHAR</span></span>|<span data-ttu-id="33f4e-123">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="33f4e-123">2,3,4,5</span></span>|<span data-ttu-id="33f4e-124">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="33f4e-124">2,3,6,7,8</span></span>|<span data-ttu-id="33f4e-125">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="33f4e-125">2,3,9,10,11</span></span>|<span data-ttu-id="33f4e-126">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="33f4e-126">2,3,6,7</span></span>|<span data-ttu-id="33f4e-127">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="33f4e-127">2,3,9,10,11</span></span>|<span data-ttu-id="33f4e-128">1</span><span class="sxs-lookup"><span data-stu-id="33f4e-128">1</span></span>|<span data-ttu-id="33f4e-129">1</span><span class="sxs-lookup"><span data-stu-id="33f4e-129">1</span></span>|<span data-ttu-id="33f4e-130">1</span><span class="sxs-lookup"><span data-stu-id="33f4e-130">1</span></span>|  
|<span data-ttu-id="33f4e-131">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="33f4e-131">SQL_TYPE_DATE</span></span>|<span data-ttu-id="33f4e-132">ОК</span><span class="sxs-lookup"><span data-stu-id="33f4e-132">OK</span></span>|<span data-ttu-id="33f4e-133">12</span><span class="sxs-lookup"><span data-stu-id="33f4e-133">12</span></span>|<span data-ttu-id="33f4e-134">13</span><span class="sxs-lookup"><span data-stu-id="33f4e-134">13</span></span>|<span data-ttu-id="33f4e-135">12</span><span class="sxs-lookup"><span data-stu-id="33f4e-135">12</span></span>|<span data-ttu-id="33f4e-136">13, 23</span><span class="sxs-lookup"><span data-stu-id="33f4e-136">13,23</span></span>|<span data-ttu-id="33f4e-137">14</span><span class="sxs-lookup"><span data-stu-id="33f4e-137">14</span></span>|<span data-ttu-id="33f4e-138">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-138">16</span></span>|<span data-ttu-id="33f4e-139">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-139">16</span></span>|  
|<span data-ttu-id="33f4e-140">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="33f4e-140">SQL_SS_TIME2</span></span>|<span data-ttu-id="33f4e-141">12</span><span class="sxs-lookup"><span data-stu-id="33f4e-141">12</span></span>|<span data-ttu-id="33f4e-142">8</span><span class="sxs-lookup"><span data-stu-id="33f4e-142">8</span></span>|<span data-ttu-id="33f4e-143">15</span><span class="sxs-lookup"><span data-stu-id="33f4e-143">15</span></span>|<span data-ttu-id="33f4e-144">ОК</span><span class="sxs-lookup"><span data-stu-id="33f4e-144">OK</span></span>|<span data-ttu-id="33f4e-145">10, 23</span><span class="sxs-lookup"><span data-stu-id="33f4e-145">10,23</span></span>|<span data-ttu-id="33f4e-146">17</span><span class="sxs-lookup"><span data-stu-id="33f4e-146">17</span></span>|<span data-ttu-id="33f4e-147">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-147">16</span></span>|<span data-ttu-id="33f4e-148">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-148">16</span></span>|  
|<span data-ttu-id="33f4e-149">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="33f4e-149">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="33f4e-150">18</span><span class="sxs-lookup"><span data-stu-id="33f4e-150">18</span></span>|<span data-ttu-id="33f4e-151">7, 8</span><span class="sxs-lookup"><span data-stu-id="33f4e-151">7,8</span></span>|<span data-ttu-id="33f4e-152">ОК</span><span class="sxs-lookup"><span data-stu-id="33f4e-152">OK</span></span>|<span data-ttu-id="33f4e-153">7</span><span class="sxs-lookup"><span data-stu-id="33f4e-153">7</span></span>|<span data-ttu-id="33f4e-154">23</span><span class="sxs-lookup"><span data-stu-id="33f4e-154">23</span></span>|<span data-ttu-id="33f4e-155">19</span><span class="sxs-lookup"><span data-stu-id="33f4e-155">19</span></span>|<span data-ttu-id="33f4e-156">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-156">16</span></span>|<span data-ttu-id="33f4e-157">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-157">16</span></span>|  
|<span data-ttu-id="33f4e-158">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="33f4e-158">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="33f4e-159">18, 22</span><span class="sxs-lookup"><span data-stu-id="33f4e-159">18,22</span></span>|<span data-ttu-id="33f4e-160">7, 8, 20</span><span class="sxs-lookup"><span data-stu-id="33f4e-160">7,8,20</span></span>|<span data-ttu-id="33f4e-161">20</span><span class="sxs-lookup"><span data-stu-id="33f4e-161">20</span></span>|<span data-ttu-id="33f4e-162">7, 20</span><span class="sxs-lookup"><span data-stu-id="33f4e-162">7,20</span></span>|<span data-ttu-id="33f4e-163">ОК</span><span class="sxs-lookup"><span data-stu-id="33f4e-163">OK</span></span>|<span data-ttu-id="33f4e-164">21</span><span class="sxs-lookup"><span data-stu-id="33f4e-164">21</span></span>|<span data-ttu-id="33f4e-165">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-165">16</span></span>|<span data-ttu-id="33f4e-166">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-166">16</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="33f4e-167">Расшифровка символов</span><span class="sxs-lookup"><span data-stu-id="33f4e-167">Key to Symbols</span></span>  
  
|<span data-ttu-id="33f4e-168">Символ</span><span class="sxs-lookup"><span data-stu-id="33f4e-168">Symbol</span></span>|<span data-ttu-id="33f4e-169">Значение</span><span class="sxs-lookup"><span data-stu-id="33f4e-169">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="33f4e-170">ОК</span><span class="sxs-lookup"><span data-stu-id="33f4e-170">OK</span></span>|<span data-ttu-id="33f4e-171">Проблемы преобразования отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="33f4e-171">No conversion issues.</span></span>|  
|<span data-ttu-id="33f4e-172">1</span><span class="sxs-lookup"><span data-stu-id="33f4e-172">1</span></span>|<span data-ttu-id="33f4e-173">Применяются правила, использовавшиеся до [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="33f4e-173">Rules prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] apply.</span></span>|  
|<span data-ttu-id="33f4e-174">2</span><span class="sxs-lookup"><span data-stu-id="33f4e-174">2</span></span>|<span data-ttu-id="33f4e-175">Начальные и конечные пробелы пропускаются.</span><span class="sxs-lookup"><span data-stu-id="33f4e-175">Leading and trailing spaces are ignored.</span></span>|  
|<span data-ttu-id="33f4e-176">3</span><span class="sxs-lookup"><span data-stu-id="33f4e-176">3</span></span>|<span data-ttu-id="33f4e-177">Выполняется синтаксический анализ строки, при котором из нее извлекается дата, время, часовой пояс или смещение часового пояса, при этом допускается точность задания долей секунды до 9 десятичных знаков.</span><span class="sxs-lookup"><span data-stu-id="33f4e-177">The string is parsed into a date, time, timezone, or timezoneoffset, and allows up to 9 digits for fractional seconds.</span></span> <span data-ttu-id="33f4e-178">Если при анализе обнаруживается смещение часового пояса, то время преобразуется к часовому поясу клиента.</span><span class="sxs-lookup"><span data-stu-id="33f4e-178">If a timezoneoffset is parsed, the time is converted to the client timezone.</span></span> <span data-ttu-id="33f4e-179">Если во время этого преобразования возникает ошибка, создается диагностическая запись с кодом SQLSTATE 22018 и сообщением «Переполнение поля даты и времени».</span><span class="sxs-lookup"><span data-stu-id="33f4e-179">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22018 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="33f4e-180">4</span><span class="sxs-lookup"><span data-stu-id="33f4e-180">4</span></span>|<span data-ttu-id="33f4e-181">Если значение не является действительной датой, отметкой времени или значением timestampoffset, то формируется диагностическая запись с ошибкой SQLSTATE 22018 и сообщением «Недопустимое символьное значение для спецификации приведения».</span><span class="sxs-lookup"><span data-stu-id="33f4e-181">If the value is not a valid date, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="33f4e-182">5</span><span class="sxs-lookup"><span data-stu-id="33f4e-182">5</span></span>|<span data-ttu-id="33f4e-183">Если значение времени не равно нулю, то создается запись диагностики с кодом SQLSTATE 01S07 и сообщением «Частичное усечение».</span><span class="sxs-lookup"><span data-stu-id="33f4e-183">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="33f4e-184">6</span><span class="sxs-lookup"><span data-stu-id="33f4e-184">6</span></span>|<span data-ttu-id="33f4e-185">Если значение не является действительным значением времени, отметкой времени или значением timestampoffset, то формируется диагностическая запись с ошибкой SQLSTATE 22018 и сообщением «Недопустимое символьное значение для спецификации приведения».</span><span class="sxs-lookup"><span data-stu-id="33f4e-185">If the value is not a valid time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="33f4e-186">7</span><span class="sxs-lookup"><span data-stu-id="33f4e-186">7</span></span>|<span data-ttu-id="33f4e-187">Компонент даты не учитывается.</span><span class="sxs-lookup"><span data-stu-id="33f4e-187">The date component is ignored.</span></span>|  
|<span data-ttu-id="33f4e-188">8</span><span class="sxs-lookup"><span data-stu-id="33f4e-188">8</span></span>|<span data-ttu-id="33f4e-189">Если значение долей секунды не равно нулю, то создается диагностическая запись с кодом SQLSTATE 01S07 и сообщением «Частичное усечение».</span><span class="sxs-lookup"><span data-stu-id="33f4e-189">If the fractional seconds are non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="33f4e-190">9</span><span class="sxs-lookup"><span data-stu-id="33f4e-190">9</span></span>|<span data-ttu-id="33f4e-191">Если значение не является действительным значением даты, времени, отметкой времени или значением timestampoffset, то формируется диагностическая запись с ошибкой SQLSTATE 22018 и сообщением «Недопустимое символьное значение для спецификации приведения».</span><span class="sxs-lookup"><span data-stu-id="33f4e-191">If the value is not a valid date, time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="33f4e-192">10</span><span class="sxs-lookup"><span data-stu-id="33f4e-192">10</span></span>|<span data-ttu-id="33f4e-193">Если значение является действительным значением времени, то компонент даты принимает значение текущей даты на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="33f4e-193">If the value is a valid time, the date component is set to current client date.</span></span>|  
|<span data-ttu-id="33f4e-194">11</span><span class="sxs-lookup"><span data-stu-id="33f4e-194">11</span></span>|<span data-ttu-id="33f4e-195">Если значение является действительным значением даты, то для времени устанавливается значение, равное нулю.</span><span class="sxs-lookup"><span data-stu-id="33f4e-195">If the value is a valid date, the time is set to zero.</span></span>|  
|<span data-ttu-id="33f4e-196">12</span><span class="sxs-lookup"><span data-stu-id="33f4e-196">12</span></span>|<span data-ttu-id="33f4e-197">Создается запись диагностики с кодом SQLSTATE 07006 и сообщением «Нарушение атрибута ограниченного типа данных».</span><span class="sxs-lookup"><span data-stu-id="33f4e-197">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="33f4e-198">13</span><span class="sxs-lookup"><span data-stu-id="33f4e-198">13</span></span>|<span data-ttu-id="33f4e-199">Время установлено в нуль.</span><span class="sxs-lookup"><span data-stu-id="33f4e-199">The time is set to zero.</span></span>|  
|<span data-ttu-id="33f4e-200">14</span><span class="sxs-lookup"><span data-stu-id="33f4e-200">14</span></span>|<span data-ttu-id="33f4e-201">Если буфер недостаточно велик для значения SQL_DATE_STRUCT, то формируется диагностическая запись с ошибкой SQLSTATE 22003 и сообщением «Численное значение вне допустимого диапазона».</span><span class="sxs-lookup"><span data-stu-id="33f4e-201">If the buffer is not large enough to accommodate a SQL_DATE_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="33f4e-202">15</span><span class="sxs-lookup"><span data-stu-id="33f4e-202">15</span></span>|<span data-ttu-id="33f4e-203">Дата устанавливается равной текущей дате на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="33f4e-203">The date is set to the current client date.</span></span>|  
|<span data-ttu-id="33f4e-204">16</span><span class="sxs-lookup"><span data-stu-id="33f4e-204">16</span></span>|<span data-ttu-id="33f4e-205">Если буфер недостаточно велик для преобразованного строкового значения, но не помещается только дробное значение секунд, то происходит усечение долей секунд и формируется диагностическая запись с ошибкой SQLSTATE 01004 и сообщением «Строковые данные, усечение справа».</span><span class="sxs-lookup"><span data-stu-id="33f4e-205">If the buffer is not large enough to accommodate the converted string value but only fractional seconds, truncation occurs and a diagnostic record is generated with SQLSTATE 01004 and the message "String data, right truncated".</span></span> <span data-ttu-id="33f4e-206">Если буфер недостаточно велик для помещения строкового значения без усечения компонентов даты, времени или смещения, то формируется диагностическая запись с ошибкой SQLSTATE 22003 и сообщением «Численное значение вне допустимого диапазона».</span><span class="sxs-lookup"><span data-stu-id="33f4e-206">If the buffer is not large enough to accommodate the string value without truncation of date, time, or offset components, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span> <span data-ttu-id="33f4e-207">Учтите, что для значений типа timestampoffset и значений даты невозможна ошибка SQLSTATE 01004, поскольку крайняя правая часть преобразованной строки не содержит долей секунды.</span><span class="sxs-lookup"><span data-stu-id="33f4e-207">Note that for date and timestampoffset, SQLSTATE 01004 is not possible because the rightmost part of the converted string does not contain fractional seconds.</span></span> <span data-ttu-id="33f4e-208">Поэтому при любом усечении неизбежна потеря данных.</span><span class="sxs-lookup"><span data-stu-id="33f4e-208">Therefore, any truncation causes data loss.</span></span>|  
|<span data-ttu-id="33f4e-209">17</span><span class="sxs-lookup"><span data-stu-id="33f4e-209">17</span></span>|<span data-ttu-id="33f4e-210">Если буфер недостаточно велик для значения SQL_SS_TIME2_STRUCT, то формируется диагностическая запись с ошибкой SQLSTATE 22003 и сообщением «Численное значение вне допустимого диапазона».</span><span class="sxs-lookup"><span data-stu-id="33f4e-210">If the buffer is not large enough to accommodate a SQL_SS_TIME2_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="33f4e-211">18</span><span class="sxs-lookup"><span data-stu-id="33f4e-211">18</span></span>|<span data-ttu-id="33f4e-212">Если значение времени не равно нулю, то создается запись диагностики с кодом SQLSTATE 01S07 и сообщением «Частичное усечение».</span><span class="sxs-lookup"><span data-stu-id="33f4e-212">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="33f4e-213">19</span><span class="sxs-lookup"><span data-stu-id="33f4e-213">19</span></span>|<span data-ttu-id="33f4e-214">Если серверный тип — datetime или smalldatetime, то значение соответствует формату потока табличных данных и будет 4-байтовым значением для smalldatetime или 8-байтовым для datetime.</span><span class="sxs-lookup"><span data-stu-id="33f4e-214">If the server type is datetime or smalldatetime, the value corresponds to the TDS wire format and will be a 4-byte value for smalldatetime and an 8-byte value for datetime.</span></span><br /><br /> <span data-ttu-id="33f4e-215">Если типом данных на стороне сервера является datetime2, то значение возвращается в виде SQL_TIMESTAMP_STRUCT.</span><span class="sxs-lookup"><span data-stu-id="33f4e-215">If the server type is datetime2, the value is returned as a SQL_TIMESTAMP_STRUCT.</span></span> <span data-ttu-id="33f4e-216">Если буфер недостаточно велик для возвращенного значения, то формируется диагностическая запись с ошибкой SQLSTATE 22003 и сообщением «Численное значение вне допустимого диапазона».</span><span class="sxs-lookup"><span data-stu-id="33f4e-216">If the buffer is not large enough to accommodate the returned value, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="33f4e-217">20</span><span class="sxs-lookup"><span data-stu-id="33f4e-217">20</span></span>|<span data-ttu-id="33f4e-218">Время приводится к часовому поясу клиента.</span><span class="sxs-lookup"><span data-stu-id="33f4e-218">The time is converted to the client timezone.</span></span> <span data-ttu-id="33f4e-219">Если во время этого преобразования возникла ошибка, создается запись диагностики с кодом SQLSTATE 22008 и сообщением «Переполнение поля datetime».</span><span class="sxs-lookup"><span data-stu-id="33f4e-219">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="33f4e-220">21</span><span class="sxs-lookup"><span data-stu-id="33f4e-220">21</span></span>|<span data-ttu-id="33f4e-221">Если буфер недостаточно велик для значения SQL_SS_TIMESTAMPOFFSET_STRUCT, то значение возвращается в виде SQL_SS_TIMESTAMPOFFSET_STRUCT.</span><span class="sxs-lookup"><span data-stu-id="33f4e-221">If the buffer is large enough to accommodate a SQL_SS_TIMESTAMPOFFSET_STRUCT, the value is returned as a SQL_SS_TIMESTAMPOFFSET_STRUCT.</span></span> <span data-ttu-id="33f4e-222">В противном случае формируется диагностическая запись с ошибкой SQLSTATE 22003 и сообщением «Численное значение вне допустимого диапазона».</span><span class="sxs-lookup"><span data-stu-id="33f4e-222">Otherwise, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="33f4e-223">22</span><span class="sxs-lookup"><span data-stu-id="33f4e-223">22</span></span>|<span data-ttu-id="33f4e-224">Это значение приводится к часовому поясу клиента до извлечения даты.</span><span class="sxs-lookup"><span data-stu-id="33f4e-224">The value is converted to the client timezone before the date is extracted.</span></span> <span data-ttu-id="33f4e-225">Тем самым обеспечивается согласованность с другими преобразованиями с типами timestampoffset.</span><span class="sxs-lookup"><span data-stu-id="33f4e-225">This provides consistency with other conversions with timestampoffset types.</span></span> <span data-ttu-id="33f4e-226">Если во время этого преобразования возникла ошибка, создается запись диагностики с кодом SQLSTATE 22008 и сообщением «Переполнение поля datetime».</span><span class="sxs-lookup"><span data-stu-id="33f4e-226">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="33f4e-227">В результате может быть получена дата, отличающаяся от значения, получаемого простым усечением.</span><span class="sxs-lookup"><span data-stu-id="33f4e-227">This might result in a date that differs from the value obtained by simple truncation.</span></span>|  
  
 <span data-ttu-id="33f4e-228">Таблица в этом разделе описывает преобразования между типами, возвращаемыми клиенту, и типами в привязке.</span><span class="sxs-lookup"><span data-stu-id="33f4e-228">The table in this topic describes conversions between the type returned to the client and the type in the binding.</span></span> <span data-ttu-id="33f4e-229">Для выходных параметров, если тип сервера, указанный в SQLBindParameter, не совпадает с фактическим типом на сервере, на сервере будет выполнено неявное преобразование, и тип, возвращаемый клиенту, будет соответствовать типу, указанному с помощью SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="33f4e-229">For output parameters, if the server type specified in SQLBindParameter does not match the actual type on the server, an implicit conversion will be performed by the server and the type returned to the client will match the type specified through SQLBindParameter.</span></span> <span data-ttu-id="33f4e-230">Это может привести к непредвиденным результатам преобразования, если правила преобразования сервера отличаются от правил, перечисленных в предыдущей таблице.</span><span class="sxs-lookup"><span data-stu-id="33f4e-230">This can lead to unexpected conversion results when the server's conversion rules are different from those listed in the preceding table.</span></span> <span data-ttu-id="33f4e-231">Например, если необходима дата по умолчанию, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] использует не текущую дату, а 01.01.1900.</span><span class="sxs-lookup"><span data-stu-id="33f4e-231">For example, when a default date must be provided, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses 1900-1-1, rather than the current date.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="33f4e-232">См. также:</span><span class="sxs-lookup"><span data-stu-id="33f4e-232">See Also</span></span>  
 [<span data-ttu-id="33f4e-233">Улучшения даты и времени &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="33f4e-233">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
