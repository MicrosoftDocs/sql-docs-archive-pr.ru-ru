---
title: Сравнение хранилища таблиц на диске с хранилищем таблиц, оптимизированных для памяти | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: eacf443c-001a-445f-ad1c-5f5a45eca6f4
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: 47cf84427b2f4f26a29f732575530b384d9c4fc9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87749908"
---
# <a name="comparing-disk-based-table-storage-to-memory-optimized-table-storage"></a><span data-ttu-id="d246a-102">Сравнение хранилища таблиц на диске с хранилищем таблиц оптимизированным для памяти</span><span class="sxs-lookup"><span data-stu-id="d246a-102">Comparing Disk-Based Table Storage to Memory-Optimized Table Storage</span></span>
  
  
|<span data-ttu-id="d246a-103">Категории</span><span class="sxs-lookup"><span data-stu-id="d246a-103">Categories</span></span>|<span data-ttu-id="d246a-104">Дисковая таблица</span><span class="sxs-lookup"><span data-stu-id="d246a-104">Disk-based Table</span></span>|<span data-ttu-id="d246a-105">Долговечная, оптимизированная для памяти таблица</span><span class="sxs-lookup"><span data-stu-id="d246a-105">Durable Memory-Optimized Table</span></span>|  
|----------------|-----------------------|-------------------------------------|  
|<span data-ttu-id="d246a-106">DDL</span><span class="sxs-lookup"><span data-stu-id="d246a-106">DDL</span></span>|<span data-ttu-id="d246a-107">Сведения о метаданных хранятся в системных таблицах в первичной файловой группе базы данных и доступны через представления каталога.</span><span class="sxs-lookup"><span data-stu-id="d246a-107">Metadata information is stored in system tables in the primary filegroup of the database and is accessible through catalog views.</span></span>|<span data-ttu-id="d246a-108">Сведения о метаданных хранятся в системных таблицах в первичной файловой группе базы данных и доступны через представления каталога.</span><span class="sxs-lookup"><span data-stu-id="d246a-108">Metadata information is stored in system tables in the primary filegroup of the database and is accessible through catalog views.</span></span>|  
|<span data-ttu-id="d246a-109">Структура</span><span class="sxs-lookup"><span data-stu-id="d246a-109">Structure</span></span>|<span data-ttu-id="d246a-110">Строки хранятся в страницах размером 8 КБ.</span><span class="sxs-lookup"><span data-stu-id="d246a-110">Rows are stored in 8K pages.</span></span> <span data-ttu-id="d246a-111">Страница содержит только строки из одной таблицы.</span><span class="sxs-lookup"><span data-stu-id="d246a-111">A page stores only rows from the same table.</span></span>|<span data-ttu-id="d246a-112">Строки хранятся в виде отдельных строк.</span><span class="sxs-lookup"><span data-stu-id="d246a-112">Rows are stored as individual rows.</span></span> <span data-ttu-id="d246a-113">Структура страницы не существует.</span><span class="sxs-lookup"><span data-stu-id="d246a-113">There is no page structure.</span></span> <span data-ttu-id="d246a-114">Две последовательные строки в файле данных могут принадлежать к различным, оптимизированным для памяти таблицам.</span><span class="sxs-lookup"><span data-stu-id="d246a-114">Two consecutive rows in a data file can belong to different memory-optimized tables.</span></span>|  
|<span data-ttu-id="d246a-115">Индексы</span><span class="sxs-lookup"><span data-stu-id="d246a-115">Indexes</span></span>|<span data-ttu-id="d246a-116">Индексы хранятся в структуре страницы наподобие строк данных.</span><span class="sxs-lookup"><span data-stu-id="d246a-116">Indexes are stored in a page structure similar to data rows.</span></span>|<span data-ttu-id="d246a-117">Сохраняется только определение индекса (не строки индекса).</span><span class="sxs-lookup"><span data-stu-id="d246a-117">Only the index definition is persisted (not index rows).</span></span> <span data-ttu-id="d246a-118">Индексы сохраняются в памяти и создаются повторно, когда оптимизированная для памяти таблица загружается в память при перезапуске базы данных.</span><span class="sxs-lookup"><span data-stu-id="d246a-118">Indexes are maintained in-memory and are regenerated when the memory-optimized table is loaded into memory as part of restarting a database.</span></span> <span data-ttu-id="d246a-119">Так как строки индекса не сохраняются, то для изменений индекса журнал не ведется.</span><span class="sxs-lookup"><span data-stu-id="d246a-119">Since index rows are not persisted, no logging is done for index changes.</span></span>|  
|<span data-ttu-id="d246a-120">Операция DML</span><span class="sxs-lookup"><span data-stu-id="d246a-120">DML operation</span></span>|<span data-ttu-id="d246a-121">Сначала нужно найти страницу и загрузить ее буферный пул.</span><span class="sxs-lookup"><span data-stu-id="d246a-121">The first step is to find the page and then load it into buffer-pool.</span></span><br /><br /> <span data-ttu-id="d246a-122">Вставить</span><span class="sxs-lookup"><span data-stu-id="d246a-122">Insert</span></span><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="d246a-123">вставляет строки на страницу с учетом порядка страниц для кластеризованного индекса.</span><span class="sxs-lookup"><span data-stu-id="d246a-123">inserts the row on the page accounting for row ordering in case of clustered index.</span></span><br /><br /> <span data-ttu-id="d246a-124">DELETE</span><span class="sxs-lookup"><span data-stu-id="d246a-124">Delete</span></span><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="d246a-125">определяет строки, которые нужно удалить, на странице и отмечает их как удаленные.</span><span class="sxs-lookup"><span data-stu-id="d246a-125">locates the row to be deleted on the page and marks it deleted.</span></span><br /><br /> <span data-ttu-id="d246a-126">Update</span><span class="sxs-lookup"><span data-stu-id="d246a-126">Update</span></span><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="d246a-127">находит строки на странице.</span><span class="sxs-lookup"><span data-stu-id="d246a-127">locates the row on the page.</span></span> <span data-ttu-id="d246a-128">Обновление для неключевых столбцов выполняется на месте.</span><span class="sxs-lookup"><span data-stu-id="d246a-128">The update is done in-place for non-key columns.</span></span> <span data-ttu-id="d246a-129">Обновление ключевого столбца выполняется с помощью операции удаления и вставки.</span><span class="sxs-lookup"><span data-stu-id="d246a-129">Key-column update is done by a delete and insert operation.</span></span><br /><br /> <span data-ttu-id="d246a-130">После завершения операции DML измененные страницы записываются на диск при фиксации политики буферного пула, контрольной точки или транзакции для операций с минимальным уровнем ведения журнала.</span><span class="sxs-lookup"><span data-stu-id="d246a-130">After the DML operation completes, the affected pages are flushed to disk as part of buffer pool policy, checkpoint or transaction commit for minimally-logged operations.</span></span> <span data-ttu-id="d246a-131">И операции чтения, и операции записи на страницах приводят к ненужным операциям ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="d246a-131">Both read/write operations on pages leads to unnecessary I/O.</span></span>|<span data-ttu-id="d246a-132">Поскольку данные оптимизированных для памяти таблиц находятся в памяти, операции DML осуществляются непосредственно в памяти.</span><span class="sxs-lookup"><span data-stu-id="d246a-132">For memory-optimized tables, since the data resides in memory, the DML operations are done directly in memory.</span></span> <span data-ttu-id="d246a-133">Существует фоновый поток, который считывает записи журнала для оптимизированных для памяти таблиц и сохраняет их в файлы данных и разностные файлы.</span><span class="sxs-lookup"><span data-stu-id="d246a-133">There is a background thread that reads the log records for memory-optimized tables and persist them into data and delta files.</span></span> <span data-ttu-id="d246a-134">При обновлении создается новая версия строки.</span><span class="sxs-lookup"><span data-stu-id="d246a-134">An update generates a new row version.</span></span> <span data-ttu-id="d246a-135">Но обновление записывается в журнал как операция удаления с последующей вставкой.</span><span class="sxs-lookup"><span data-stu-id="d246a-135">But an update is logged as a delete followed by an insert.</span></span>|  
|<span data-ttu-id="d246a-136">Фрагментация данных</span><span class="sxs-lookup"><span data-stu-id="d246a-136">Data Fragmentation</span></span>|<span data-ttu-id="d246a-137">Фрагменты обработки данных, из-за которых появляются частично заполненные страницы и логически последовательные страницы, которые располагаются на диске непоследовательно.</span><span class="sxs-lookup"><span data-stu-id="d246a-137">Data manipulation fragments data leading to partially filled pages and logically consecutive pages that are not contiguous on disk.</span></span> <span data-ttu-id="d246a-138">Это уменьшает скорость доступа к данным и может потребовать дефрагментации данных.</span><span class="sxs-lookup"><span data-stu-id="d246a-138">This degrades data access performance and requires you to defragment data.</span></span>|<span data-ttu-id="d246a-139">Оптимизированные для памяти данные не хранятся в страницах, поэтому фрагментации данных нет.</span><span class="sxs-lookup"><span data-stu-id="d246a-139">Memory-optimized data is not stored in pages so there is no data fragmentation.</span></span> <span data-ttu-id="d246a-140">Но при обновлении и удалении строк файлы данных и разностные файлы требуется сжимать.</span><span class="sxs-lookup"><span data-stu-id="d246a-140">However, as rows are updated and deleted, the data and delta files need to be compacted.</span></span> <span data-ttu-id="d246a-141">Этим занимается потоковый поток MERGE в соответствии с политикой слияния.</span><span class="sxs-lookup"><span data-stu-id="d246a-141">This is done by a background MERGE thread based on a merge policy.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="d246a-142">См. также:</span><span class="sxs-lookup"><span data-stu-id="d246a-142">See Also</span></span>  
 [<span data-ttu-id="d246a-143">Создание и управление хранилищем для оптимизированных для памяти объектов</span><span class="sxs-lookup"><span data-stu-id="d246a-143">Creating and Managing Storage for Memory-Optimized Objects</span></span>](creating-and-managing-storage-for-memory-optimized-objects.md)  
  
  
