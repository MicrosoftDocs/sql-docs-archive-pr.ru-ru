---
title: OPENXML (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: conceptual
helpviewer_keywords:
- ColPattern [XML in SQL Server]
- OPENXML statement, about OPENXML statement
- writing XML, OPENXML statement
- OPENXML statement, querying XML
- attribute-centric mapping
- SELECT statement [SQL Server], OPENXML keyword
- column patterns [XML in SQL Server]
- row patterns [XML in SQL Server]
- rowpattern [XML in SQL Server]
- queries [XML in SQL Server], OPENXML statement
- XML [SQL Server], OPENXML statement
- element-centric mapping [SQL Server]
ms.assetid: 060126fc-ed0f-478f-830a-08e418d410dc
author: rothja
ms.author: jroth
ms.openlocfilehash: 1849029e6654fcd629499cceeff9957e5389370f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87751943"
---
# <a name="openxml-sql-server"></a><span data-ttu-id="08e5b-102">Инструкция OPENXML (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="08e5b-102">OPENXML (SQL Server)</span></span>
  <span data-ttu-id="08e5b-103">Ключевое слово OPENXML языка [!INCLUDE[tsql](../../includes/tsql-md.md)] предоставляет набор строк по XML-документам в памяти, подобный таблице или представлению.</span><span class="sxs-lookup"><span data-stu-id="08e5b-103">OPENXML, a [!INCLUDE[tsql](../../includes/tsql-md.md)] keyword, provides a rowset over in-memory XML documents that is similar to a table or a view.</span></span> <span data-ttu-id="08e5b-104">OPENXML позволяет получить доступ к XML-данным так, как если бы это был реляционный набор строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-104">OPENXML allows access to XML data as though it is a relational rowset.</span></span> <span data-ttu-id="08e5b-105">Это делается при помощи представления внутреннего отображения XML-документа в виде набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-105">It does this by providing a rowset view of the internal representation of an XML document.</span></span> <span data-ttu-id="08e5b-106">Записи в наборе строк могут храниться в таблицах базы данных.</span><span class="sxs-lookup"><span data-stu-id="08e5b-106">The records in the rowset can be stored in database tables.</span></span>

 <span data-ttu-id="08e5b-107">OPENXML может использоваться в инструкциях SELECT и SELECT INTO в любых позициях, где в качестве источника могут присутствовать поставщики наборов строк, представления или функция OPENROWSET.</span><span class="sxs-lookup"><span data-stu-id="08e5b-107">OPENXML can be used in SELECT and SELECT INTO statements wherever rowset providers, a view, or OPENROWSET can appear as the source.</span></span> <span data-ttu-id="08e5b-108">Дополнительные сведения о синтаксисе инструкции OPENXML см. в разделе [OPENXML (Transact-SQL)](/sql/t-sql/functions/openxml-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="08e5b-108">For information about the syntax of OPENXML, see [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql).</span></span>

 <span data-ttu-id="08e5b-109">Для создания запросов к XML-документу с помощью OPENXML необходимо сначала вызвать метод `sp_xml_preparedocument` .</span><span class="sxs-lookup"><span data-stu-id="08e5b-109">To write queries against an XML document by using OPENXML, you must first call `sp_xml_preparedocument`.</span></span> <span data-ttu-id="08e5b-110">Таким образом производится синтаксический анализ XML-документа и возвращается дескриптор для проанализированного документа, готового к использованию.</span><span class="sxs-lookup"><span data-stu-id="08e5b-110">This parses the XML document and returns a handle to the parsed document that is ready for consumption.</span></span> <span data-ttu-id="08e5b-111">Проанализированный документ является представлением дерева объектной модели документа (DOM) различных узлов в XML-документе.</span><span class="sxs-lookup"><span data-stu-id="08e5b-111">The parsed document is a document object model (DOM) tree representation of various nodes in the XML document.</span></span> <span data-ttu-id="08e5b-112">Дескриптор документа передается OPENXML.</span><span class="sxs-lookup"><span data-stu-id="08e5b-112">The document handle is passed to OPENXML.</span></span> <span data-ttu-id="08e5b-113">Затем инструкция OPENXML выдает представление документа в виде набора строк, основываясь на переданных ей аргументах.</span><span class="sxs-lookup"><span data-stu-id="08e5b-113">OPENXML then provides a rowset view of the document, based on the parameters passed to it.</span></span>

> [!NOTE]
>  <span data-ttu-id="08e5b-114">`sp_xml_preparedocument`использует версию средства синтаксического анализа MSXML, обновленную SQL, Msxmlsql.dll.</span><span class="sxs-lookup"><span data-stu-id="08e5b-114">`sp_xml_preparedocument` uses a SQL-updated version of the MSXML parser, Msxmlsql.dll.</span></span> <span data-ttu-id="08e5b-115">Эта версия средства синтаксического анализа MSXML разработана для поддержки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и остается обратно совместимой с версией MSXML 2.6.</span><span class="sxs-lookup"><span data-stu-id="08e5b-115">This version of the MSXML parser was designed to support [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and remain backward compatible with MSXML version 2.6.</span></span>

 <span data-ttu-id="08e5b-116">Внутреннее представление XML-документа должно быть удалено из памяти посредством вызова системной хранимой процедуры **sp_xml_removedocument** для освобождения памяти.</span><span class="sxs-lookup"><span data-stu-id="08e5b-116">The internal representation of an XML document must be removed from memory by calling the **sp_xml_removedocument** system stored procedure to free the memory.</span></span>

 <span data-ttu-id="08e5b-117">На следующей иллюстрации показан этот процесс.</span><span class="sxs-lookup"><span data-stu-id="08e5b-117">The following illustration shows the process.</span></span>

 <span data-ttu-id="08e5b-118">![Синтаксический анализ XML с помощью OPENXML](../../database-engine/media/xmlsp.gif "Синтаксический анализ XML с помощью OPENXML")</span><span class="sxs-lookup"><span data-stu-id="08e5b-118">![Parsing XML with OPENXML](../../database-engine/media/xmlsp.gif "Parsing XML with OPENXML")</span></span>

 <span data-ttu-id="08e5b-119">Обратите внимание на то, что для понимания OPENXML необходимо иметь общее представление о запросах XPath и XML.</span><span class="sxs-lookup"><span data-stu-id="08e5b-119">Note that to understand OPENXML, familiarity with XPath queries and an understanding of XML is required.</span></span> <span data-ttu-id="08e5b-120">Дополнительные сведения о поддержке XPath в SQL Server см. в разделе [Использование запросов XPath в SQLXML 4.0](../sqlxml-annotated-xsd-schemas-xpath-queries/using-xpath-queries-in-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="08e5b-120">For more information about XPath support in SQL Server, see [Using XPath Queries in SQLXML 4.0](../sqlxml-annotated-xsd-schemas-xpath-queries/using-xpath-queries-in-sqlxml-4-0.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="08e5b-121">OpenXML позволяет параметризовать шаблоны XPath столбцов и строк как переменные.</span><span class="sxs-lookup"><span data-stu-id="08e5b-121">OpenXML allows the row and column XPath patterns to be parameterized as variables.</span></span> <span data-ttu-id="08e5b-122">Такая параметризация может привести к включению выражений XPath, если разработчик допускает демонстрацию параметризации внешним пользователям (например, если аргументы предоставляются через вызываемую извне хранимую процедуру).</span><span class="sxs-lookup"><span data-stu-id="08e5b-122">Such parameterization could lead to XPath expression injections, if the programmer exposes the parameterization to outside users (for example, if the parameters are provided via an externally called stored procedure).</span></span> <span data-ttu-id="08e5b-123">Чтобы избежать подобных потенциально опасных ситуаций, рекомендуется никогда не допускать демонстрации аргументов XPath внешним вызывающим программам.</span><span class="sxs-lookup"><span data-stu-id="08e5b-123">To avoid such potential security issues, it is recommended that XPath parameters should never be exposed to external callers.</span></span>

## <a name="example"></a><span data-ttu-id="08e5b-124">Пример</span><span class="sxs-lookup"><span data-stu-id="08e5b-124">Example</span></span>
 <span data-ttu-id="08e5b-125">В следующем примере показано применение процедуры `OPENXML` в инструкции `INSERT` и инструкции `SELECT` .</span><span class="sxs-lookup"><span data-stu-id="08e5b-125">The following example shows the use of `OPENXML` in an `INSERT` statement and a `SELECT` statement.</span></span> <span data-ttu-id="08e5b-126">Образец XML-документа содержит элементы `<Customers>` и `<Orders>` .</span><span class="sxs-lookup"><span data-stu-id="08e5b-126">The sample XML document contains `<Customers>` and `<Orders>` elements.</span></span>

 <span data-ttu-id="08e5b-127">Сначала вызывается хранимая процедура `sp_xml_preparedocument` для проведения синтаксического анализа XML-документа.</span><span class="sxs-lookup"><span data-stu-id="08e5b-127">First, the `sp_xml_preparedocument` stored procedure parses the XML document.</span></span> <span data-ttu-id="08e5b-128">Проанализированный документ является древовидным представлением узлов (элементов, атрибутов, текста и комментариев) в XML-документе.</span><span class="sxs-lookup"><span data-stu-id="08e5b-128">The parsed document is a tree representation of the nodes (elements, attributes, text, and comments) in the XML document.</span></span> <span data-ttu-id="08e5b-129">`OPENXML` ссылается на этот проанализированный XML-документ и выдает представление всех частей этого XML-документа в виде набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-129">`OPENXML` then refers to this parsed XML document and provides a rowset view of all or parts of this XML document.</span></span> <span data-ttu-id="08e5b-130">Инструкция `INSERT` , использующая функцию `OPENXML` , может вставлять данные из такого набора строк в таблицу базы данных.</span><span class="sxs-lookup"><span data-stu-id="08e5b-130">An `INSERT` statement using `OPENXML` can insert data from such a rowset into a database table.</span></span> <span data-ttu-id="08e5b-131">Можно вызывать функцию `OPENXML` несколько раз, получая и обрабатывая представление в виде набора строк различных частей XML-документа. Например, их можно вставить в различные таблицы.</span><span class="sxs-lookup"><span data-stu-id="08e5b-131">Several `OPENXML` calls can be used to provide a rowset view of various parts of the XML document and process them, for example, by inserting them into different tables.</span></span> <span data-ttu-id="08e5b-132">Данный процесс также называют разделение XML-данных по таблицам.</span><span class="sxs-lookup"><span data-stu-id="08e5b-132">This process is also referred to as shredding XML into tables.</span></span>

 <span data-ttu-id="08e5b-133">В следующем примере XML-документ разрезается таким образом, что элементы `<Customers>` сохраняются в таблице `Customers` , а элементы `<Orders>` сохраняются в таблице `Orders` с помощью двух инструкций `INSERT` .</span><span class="sxs-lookup"><span data-stu-id="08e5b-133">In the following example, an XML document is shredded in a way that `<Customers>` elements are stored in the `Customers` table and `<Orders>` elements are stored in the `Orders` table by using two `INSERT` statements.</span></span> <span data-ttu-id="08e5b-134">Этот пример также демонстрирует инструкцию `SELECT` , использующую функцию `OPENXML` , которая получает элементы `CustomerID` и `OrderDate` из XML-документа.</span><span class="sxs-lookup"><span data-stu-id="08e5b-134">The example also shows a `SELECT` statement with `OPENXML` that retrieves `CustomerID` and `OrderDate` from the XML document.</span></span> <span data-ttu-id="08e5b-135">Последним шагом обработки является повторный вызов процедуры `sp_xml_removedocument`.</span><span class="sxs-lookup"><span data-stu-id="08e5b-135">The last step in the process is to call `sp_xml_removedocument`.</span></span> <span data-ttu-id="08e5b-136">Это позволяет освободить память, выделенную для внутреннего древовидного представления XML, создаваемого в фазе синтаксического анализа.</span><span class="sxs-lookup"><span data-stu-id="08e5b-136">This is done in order to release the memory allocated to contain the internal XML tree representation that was created during the parse phase.</span></span>

```
-- Create tables for later population using OPENXML.
CREATE TABLE Customers (CustomerID varchar(20) primary key,
                ContactName varchar(20), 
                CompanyName varchar(20));
GO
CREATE TABLE Orders( CustomerID varchar(20), OrderDate datetime);
GO
DECLARE @docHandle int;
DECLARE @xmlDocument nvarchar(max); -- or xml type
SET @xmlDocument = N'<ROOT>
<Customers CustomerID="XYZAA" ContactName="Joe" CompanyName="Company1">
<Orders CustomerID="XYZAA" OrderDate="2000-08-25T00:00:00"/>
<Orders CustomerID="XYZAA" OrderDate="2000-10-03T00:00:00"/>
</Customers>
<Customers CustomerID="XYZBB" ContactName="Steve"
CompanyName="Company2">No Orders yet!
</Customers>
</ROOT>';
EXEC sp_xml_preparedocument @docHandle OUTPUT, @xmlDocument;
-- Use OPENXML to provide rowset consisting of customer data.
INSERT Customers 
SELECT * 
FROM OPENXML(@docHandle, N'/ROOT/Customers') 
  WITH Customers;
-- Use OPENXML to provide rowset consisting of order data.
INSERT Orders 
SELECT * 
FROM OPENXML(@docHandle, N'//Orders') 
  WITH Orders;
-- Using OPENXML in a SELECT statement.
SELECT * FROM OPENXML(@docHandle, N'/ROOT/Customers/Orders') WITH (CustomerID nchar(5) '../@CustomerID', OrderDate datetime);
-- Remove the internal representation of the XML document.
EXEC sp_xml_removedocument @docHandle; 
```

 <span data-ttu-id="08e5b-137">На следующем рисунке показано XML-дерево, полученное в результате анализа предыдущего XML-документа и созданное с помощью хранимой процедуры sp_xml_preparedocument.</span><span class="sxs-lookup"><span data-stu-id="08e5b-137">The following illustration shows the parsed XML tree of the previous XML document that was created by using sp_xml_preparedocument.</span></span>

 <span data-ttu-id="08e5b-138">![Проанализированное дерево XML](../../database-engine/media/xmlparsedtree.gif "Проанализированное дерево XML")</span><span class="sxs-lookup"><span data-stu-id="08e5b-138">![Parsed XML tree](../../database-engine/media/xmlparsedtree.gif "Parsed XML tree")</span></span>

## <a name="openxml-parameters"></a><span data-ttu-id="08e5b-139">Параметры OPENXML</span><span class="sxs-lookup"><span data-stu-id="08e5b-139">OPENXML Parameters</span></span>
 <span data-ttu-id="08e5b-140">К числу аргументов OPENXML относятся:</span><span class="sxs-lookup"><span data-stu-id="08e5b-140">The parameters to OPENXML include the following:</span></span>

-   <span data-ttu-id="08e5b-141">дескриптор XML-документа (*idoc*);</span><span class="sxs-lookup"><span data-stu-id="08e5b-141">An XML document handle (*idoc*)</span></span>

-   <span data-ttu-id="08e5b-142">выражение XPath для идентификации узлов, которые должны быть сопоставлены со строками (*rowpattern*);</span><span class="sxs-lookup"><span data-stu-id="08e5b-142">An XPath expression to identify the nodes to be mapped to rows (*rowpattern*)</span></span>

-   <span data-ttu-id="08e5b-143">описание набора строк, который должен быть создан;</span><span class="sxs-lookup"><span data-stu-id="08e5b-143">A description of the rowset to be generated</span></span>

-   <span data-ttu-id="08e5b-144">сопоставление столбцов набора строк и узлов XML;</span><span class="sxs-lookup"><span data-stu-id="08e5b-144">Mapping between the rowset columns and the XML nodes</span></span>

### <a name="xml-document-handle-idoc"></a><span data-ttu-id="08e5b-145">Обработка XML-документа (idoc)</span><span class="sxs-lookup"><span data-stu-id="08e5b-145">XML Document Handle (idoc)</span></span>
 <span data-ttu-id="08e5b-146">Этот маркер документа возвращается `sp_xml_preparedocument` хранимой процедурой.</span><span class="sxs-lookup"><span data-stu-id="08e5b-146">The document handle is returned by the `sp_xml_preparedocument` stored procedure.</span></span>

### <a name="xpath-expression-to-identify-the-nodes-to-be-processed-rowpattern"></a><span data-ttu-id="08e5b-147">Выражение XPath для распознавания узлов, подлежащих обработке (rowpattern)</span><span class="sxs-lookup"><span data-stu-id="08e5b-147">XPath Expression to Identify the Nodes to Be Processed (rowpattern)</span></span>
 <span data-ttu-id="08e5b-148">Выражение XPath, указанное аргументом *rowpattern* , распознает набор узлов в XML-документе.</span><span class="sxs-lookup"><span data-stu-id="08e5b-148">The XPath expression specified as *rowpattern* identifies a set of nodes in the XML document.</span></span> <span data-ttu-id="08e5b-149">Каждый узел, распознанный *rowpattern* , соотносится с отдельной строкой в наборе строк, созданном OPENXML.</span><span class="sxs-lookup"><span data-stu-id="08e5b-149">Each node that is identified by *rowpattern* corresponds to a single row in the rowset that is generated by OPENXML.</span></span>

 <span data-ttu-id="08e5b-150">Узлами, распознанными выражением XPath, могут быть любые узлы XML в XML-документе.</span><span class="sxs-lookup"><span data-stu-id="08e5b-150">The nodes identified by the XPath expression can be any XML node in the XML document.</span></span> <span data-ttu-id="08e5b-151">Если *rowpattern* распознает набор элементов в XML-документе, в наборе строк выделяется по одной строке для каждого распознанного узла.</span><span class="sxs-lookup"><span data-stu-id="08e5b-151">If *rowpattern* identifies a set of elements in the XML document, there is one row in the rowset for each element node identified.</span></span> <span data-ttu-id="08e5b-152">Например, если *rowpattern* приводит к атрибуту, создается строка для каждого узла атрибута, выбранного *rowpattern*.</span><span class="sxs-lookup"><span data-stu-id="08e5b-152">For example, if *rowpattern* ends in an attribute, a row is created for each attribute node selected by *rowpattern*.</span></span>

### <a name="description-of-the-rowset-to-be-generated"></a><span data-ttu-id="08e5b-153">Описание набора строк, который должен быть сформирован</span><span class="sxs-lookup"><span data-stu-id="08e5b-153">Description of the Rowset to Be Generated</span></span>
 <span data-ttu-id="08e5b-154">Схема набора строк используется OPENXML для создания результирующего набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-154">A rowset schema is used by OPENXML to generate the resulting rowset.</span></span> <span data-ttu-id="08e5b-155">Можно использовать нижеследующие параметры при указании схемы набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-155">You can use the following options when specifying a rowset schema.</span></span>

#### <a name="using-the-edge-table-format"></a><span data-ttu-id="08e5b-156">Использование формата краевой таблицы</span><span class="sxs-lookup"><span data-stu-id="08e5b-156">Using the Edge Table Format</span></span>
 <span data-ttu-id="08e5b-157">Для указания схемы набора строк следует использовать формат краевой таблицы.</span><span class="sxs-lookup"><span data-stu-id="08e5b-157">You should use the edge table format to specify a rowset schema.</span></span> <span data-ttu-id="08e5b-158">Не используйте предложение WITH.</span><span class="sxs-lookup"><span data-stu-id="08e5b-158">Do not use the WITH clause.</span></span>

 <span data-ttu-id="08e5b-159">При этом OPENXML возвращает набор строк в формате краевой таблицы.</span><span class="sxs-lookup"><span data-stu-id="08e5b-159">When you do this, OPENXML returns a rowset in the edge table format.</span></span> <span data-ttu-id="08e5b-160">Ее так называют потому, что каждый край проанализированного XML-документа сопоставляется со строкой в наборе строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-160">This is referred to as an edge table, because every edge in the parsed XML document tree maps to a row in the rowset.</span></span>

 <span data-ttu-id="08e5b-161">Краевые таблицы представляют внутри отдельной таблицы подробную структуру XML-документа.</span><span class="sxs-lookup"><span data-stu-id="08e5b-161">Edge tables represent within a single table the fine-grained XML document structure.</span></span> <span data-ttu-id="08e5b-162">Структура включает в себя имена элементов и атрибутов, иерархию документа, пространства имен и инструкции по обработке.</span><span class="sxs-lookup"><span data-stu-id="08e5b-162">This structure includes the element and attribute names, the document hierarchy, the namespaces, and the processing instructions.</span></span> <span data-ttu-id="08e5b-163">Формат краевой таблицы позволяет получать дополнительные сведения, не отображаемые в метасвойствах.</span><span class="sxs-lookup"><span data-stu-id="08e5b-163">The edge table format allows you to obtain additional information that is not exposed through the metaproperties.</span></span> <span data-ttu-id="08e5b-164">Дополнительные сведения о метасвойствах см. в разделе [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span><span class="sxs-lookup"><span data-stu-id="08e5b-164">For more information about metaproperties, see [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span></span>

 <span data-ttu-id="08e5b-165">Дополнительные сведения, предоставляемые краевой таблицей, позволяют сохранять и запрашивать тип данных элемента и атрибута, тип узла, а также сохранять и запрашивать сведения о структуре XML-документа.</span><span class="sxs-lookup"><span data-stu-id="08e5b-165">The additional information provided by an edge table allows you to store and query the data type of an element and attribute, and the node type, and also store and query information about the XML document structure.</span></span> <span data-ttu-id="08e5b-166">С учетом этих дополнительных сведений может стать возможным построение собственной системы управления XML-документами.</span><span class="sxs-lookup"><span data-stu-id="08e5b-166">With this additional information, it may also be possible to build your own XML document management system.</span></span>

 <span data-ttu-id="08e5b-167">Используя краевую таблицу, можно писать хранимые процедуры, которые рассматривают XML-документы как входные данные большого двоичного объекта (BLOB), создают краевую таблицу, а затем извлекают и анализируют документ на более детальном уровне.</span><span class="sxs-lookup"><span data-stu-id="08e5b-167">By using an edge table, you can write stored procedures that take XML documents as binary large object (BLOB) input, produce the edge table, and then extract and analyze the document on a more detailed level.</span></span> <span data-ttu-id="08e5b-168">Этот детальный уровень может включать в себя выявление иерархии документа, имен элементов и атрибутов, пространств имен и инструкций по обработке.</span><span class="sxs-lookup"><span data-stu-id="08e5b-168">This detailed level could include finding the document hierarchy, the element and attribute names, the namespaces, and the processing instructions.</span></span>

 <span data-ttu-id="08e5b-169">Краевая таблица также может служить форматом хранения для XML-документов, если сопоставление с другими реляционными форматами нелогично, и поле ntext не обеспечивает достаточными структурными данными.</span><span class="sxs-lookup"><span data-stu-id="08e5b-169">The edge table also can serve as a storage format for XML documents when mapping to other relational formats is not logical and an ntext field is not providing enough structural information.</span></span>

 <span data-ttu-id="08e5b-170">В ситуациях, когда возможно использование синтаксического анализатора XML для исследования XML-документа, можно вместо этого применить краевую таблицу, чтобы получить те же сведения.</span><span class="sxs-lookup"><span data-stu-id="08e5b-170">In situations where you can use an XML parser to examine an XML document, you can use an edge table instead to obtain the same information.</span></span>

 <span data-ttu-id="08e5b-171">В следующей таблице описывается структура краевой таблицы.</span><span class="sxs-lookup"><span data-stu-id="08e5b-171">The following table describes the structure of the edge table.</span></span>

|<span data-ttu-id="08e5b-172">Имя столбца</span><span class="sxs-lookup"><span data-stu-id="08e5b-172">Column name</span></span>|<span data-ttu-id="08e5b-173">Тип данных</span><span class="sxs-lookup"><span data-stu-id="08e5b-173">Data type</span></span>|<span data-ttu-id="08e5b-174">Описание</span><span class="sxs-lookup"><span data-stu-id="08e5b-174">Description</span></span>|
|-----------------|---------------|-----------------|
|<span data-ttu-id="08e5b-175">**идентификатор**</span><span class="sxs-lookup"><span data-stu-id="08e5b-175">**id**</span></span>|<span data-ttu-id="08e5b-176">**bigint**</span><span class="sxs-lookup"><span data-stu-id="08e5b-176">**bigint**</span></span>|<span data-ttu-id="08e5b-177">Уникальный идентификатор узла документов.</span><span class="sxs-lookup"><span data-stu-id="08e5b-177">Is the unique ID of the document node.</span></span><br /><br /> <span data-ttu-id="08e5b-178">Корневой элемент имеет значение идентификатора, равное 0.</span><span class="sxs-lookup"><span data-stu-id="08e5b-178">The root element has an ID value of 0.</span></span> <span data-ttu-id="08e5b-179">Отрицательные значения идентификаторов зарезервированы.</span><span class="sxs-lookup"><span data-stu-id="08e5b-179">The negative ID values are reserved.</span></span>|
|<span data-ttu-id="08e5b-180">**parentid**</span><span class="sxs-lookup"><span data-stu-id="08e5b-180">**parentid**</span></span>|<span data-ttu-id="08e5b-181">**bigint**</span><span class="sxs-lookup"><span data-stu-id="08e5b-181">**bigint**</span></span>|<span data-ttu-id="08e5b-182">Идентифицирует родителя узла.</span><span class="sxs-lookup"><span data-stu-id="08e5b-182">Identifies the parent of the node.</span></span> <span data-ttu-id="08e5b-183">Родительский узел, определенный этим идентификатором, необязательно является родительским элементом.</span><span class="sxs-lookup"><span data-stu-id="08e5b-183">The parent identified by this ID is not necessarily the parent element.</span></span> <span data-ttu-id="08e5b-184">Однако это зависит от типа узла, родительский узел которого определен этим идентификатором.</span><span class="sxs-lookup"><span data-stu-id="08e5b-184">However, this depends on the NodeType of the node whose parent is identified by this ID.</span></span> <span data-ttu-id="08e5b-185">Например, если узел является текстовым, его родительский узел может быть узлом атрибута.</span><span class="sxs-lookup"><span data-stu-id="08e5b-185">For example, if the node is a text node, its parent may be an attribute node.</span></span><br /><br /> <span data-ttu-id="08e5b-186">Если узел находится на верхнем уровне XML-документа, то его столбец **ParentID** принимает значение NULL.</span><span class="sxs-lookup"><span data-stu-id="08e5b-186">If the node is at the top level in the XML document, its **ParentID** is NULL.</span></span>|
|<span data-ttu-id="08e5b-187">**node type**</span><span class="sxs-lookup"><span data-stu-id="08e5b-187">**node type**</span></span>|<span data-ttu-id="08e5b-188">**int**</span><span class="sxs-lookup"><span data-stu-id="08e5b-188">**int**</span></span>|<span data-ttu-id="08e5b-189">Определяет тип узла и является целым числом, соответствующим нумерации типов узла объектной модели XML (DOM).</span><span class="sxs-lookup"><span data-stu-id="08e5b-189">Identifies the node type and is an integer that corresponds to the XML object model (DOM) node type numbering.</span></span><br /><br /> <span data-ttu-id="08e5b-190">Ниже приведены значения, которые могут быть представлены в этом столбце для указания типа узла.</span><span class="sxs-lookup"><span data-stu-id="08e5b-190">Following are the values that can appear in this column to indicate the node type:</span></span><br /><br /> <span data-ttu-id="08e5b-191">**1** = Узел элемента</span><span class="sxs-lookup"><span data-stu-id="08e5b-191">**1** = Element node</span></span><br /><br /> <span data-ttu-id="08e5b-192">**2** = Узел атрибута</span><span class="sxs-lookup"><span data-stu-id="08e5b-192">**2** = Attribute node</span></span><br /><br /> <span data-ttu-id="08e5b-193">**3** = Узел текста</span><span class="sxs-lookup"><span data-stu-id="08e5b-193">**3** = Text node</span></span><br /><br /> <span data-ttu-id="08e5b-194">**4** = Узел раздела CDATA</span><span class="sxs-lookup"><span data-stu-id="08e5b-194">**4** = CDATA section node</span></span><br /><br /> <span data-ttu-id="08e5b-195">**5** = Узел ссылки на сущность</span><span class="sxs-lookup"><span data-stu-id="08e5b-195">**5** = Entity reference node</span></span><br /><br /> <span data-ttu-id="08e5b-196">**6** = Узел сущности</span><span class="sxs-lookup"><span data-stu-id="08e5b-196">**6** = Entity node</span></span><br /><br /> <span data-ttu-id="08e5b-197">**7** = Узел инструкции по обработке</span><span class="sxs-lookup"><span data-stu-id="08e5b-197">**7** = Processing instruction node</span></span><br /><br /> <span data-ttu-id="08e5b-198">**8** = Узел комментария</span><span class="sxs-lookup"><span data-stu-id="08e5b-198">**8** = Comment node</span></span><br /><br /> <span data-ttu-id="08e5b-199">**9** = Узел документа</span><span class="sxs-lookup"><span data-stu-id="08e5b-199">**9** = Document node</span></span><br /><br /> <span data-ttu-id="08e5b-200">**10** = Узел типа документа</span><span class="sxs-lookup"><span data-stu-id="08e5b-200">**10** = Document Type node</span></span><br /><br /> <span data-ttu-id="08e5b-201">**11** = Узел фрагмента документа</span><span class="sxs-lookup"><span data-stu-id="08e5b-201">**11** = Document Fragment node</span></span><br /><br /> <span data-ttu-id="08e5b-202">**12** = Узел нотации</span><span class="sxs-lookup"><span data-stu-id="08e5b-202">**12** = Notation node</span></span><br /><br /> <span data-ttu-id="08e5b-203">Дополнительные сведения см. в разделе «Свойство nodeType» в пакете Microsoft XML (MSXML) SDK.</span><span class="sxs-lookup"><span data-stu-id="08e5b-203">For more information, see the "nodeType Property" topic in the Microsoft XML (MSXML) SDK.</span></span>|
|<span data-ttu-id="08e5b-204">**localname**</span><span class="sxs-lookup"><span data-stu-id="08e5b-204">**localname**</span></span>|<span data-ttu-id="08e5b-205">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="08e5b-205">**nvarchar(max)**</span></span>|<span data-ttu-id="08e5b-206">Задает локальное имя элемента или атрибута.</span><span class="sxs-lookup"><span data-stu-id="08e5b-206">Gives the local name of the element or attribute.</span></span> <span data-ttu-id="08e5b-207">Принимает значение NULL, если у объекта DOM нет имени.</span><span class="sxs-lookup"><span data-stu-id="08e5b-207">Is NULL if the DOM object does not have a name.</span></span>|
|<span data-ttu-id="08e5b-208">**prefix**</span><span class="sxs-lookup"><span data-stu-id="08e5b-208">**prefix**</span></span>|<span data-ttu-id="08e5b-209">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="08e5b-209">**nvarchar(max)**</span></span>|<span data-ttu-id="08e5b-210">Префикс пространства имен для имени узла.</span><span class="sxs-lookup"><span data-stu-id="08e5b-210">Is the namespace prefix of the node name.</span></span>|
|<span data-ttu-id="08e5b-211">**namespaceuri**</span><span class="sxs-lookup"><span data-stu-id="08e5b-211">**namespaceuri**</span></span>|<span data-ttu-id="08e5b-212">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="08e5b-212">**nvarchar(max)**</span></span>|<span data-ttu-id="08e5b-213">URI пространства имен для имени узла.</span><span class="sxs-lookup"><span data-stu-id="08e5b-213">Is the namespace URI of the node.</span></span> <span data-ttu-id="08e5b-214">Если значение равно NULL, пространство имен отсутствует.</span><span class="sxs-lookup"><span data-stu-id="08e5b-214">If the value is NULL, no namespace is present.</span></span>|
|<span data-ttu-id="08e5b-215">**datatype**</span><span class="sxs-lookup"><span data-stu-id="08e5b-215">**datatype**</span></span>|<span data-ttu-id="08e5b-216">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="08e5b-216">**nvarchar(max)**</span></span>|<span data-ttu-id="08e5b-217">Действительный тип данных строки элемента или атрибута; в ином случае имеет значение NULL.</span><span class="sxs-lookup"><span data-stu-id="08e5b-217">Is the actual data type of the element or attribute row and is otherwise NULL.</span></span> <span data-ttu-id="08e5b-218">Тип данных вычисляется на основе встроенного DTD или встроенной схемы</span><span class="sxs-lookup"><span data-stu-id="08e5b-218">The data type is inferred from the inline DTD or from the inline schema.</span></span>|
|<span data-ttu-id="08e5b-219">**prev**</span><span class="sxs-lookup"><span data-stu-id="08e5b-219">**prev**</span></span>|<span data-ttu-id="08e5b-220">**bigint**</span><span class="sxs-lookup"><span data-stu-id="08e5b-220">**bigint**</span></span>|<span data-ttu-id="08e5b-221">Идентификатор XML предыдущего элемента этого же уровня.</span><span class="sxs-lookup"><span data-stu-id="08e5b-221">Is the XML ID of the previous sibling element.</span></span> <span data-ttu-id="08e5b-222">Принимает значение NULL, если нет прямого предыдущего одноуровневого элемента.</span><span class="sxs-lookup"><span data-stu-id="08e5b-222">Is NULL if there is no direct previous sibling.</span></span>|
|<span data-ttu-id="08e5b-223">**text**</span><span class="sxs-lookup"><span data-stu-id="08e5b-223">**text**</span></span>|<span data-ttu-id="08e5b-224">**ntext**</span><span class="sxs-lookup"><span data-stu-id="08e5b-224">**ntext**</span></span>|<span data-ttu-id="08e5b-225">Содержит значение атрибута или содержимое элемента в виде текста.</span><span class="sxs-lookup"><span data-stu-id="08e5b-225">Contains the attribute value or the element content in text form.</span></span> <span data-ttu-id="08e5b-226">Либо принимает значение NULL, если для записи в краевой таблице не требуется значение.</span><span class="sxs-lookup"><span data-stu-id="08e5b-226">Or is NULL, if the edge table entry does not need a value.</span></span>|

#### <a name="using-the-with-clause-to-specify-an-existing-table"></a><span data-ttu-id="08e5b-227">Использование предложения WITH для указания существующей таблицы</span><span class="sxs-lookup"><span data-stu-id="08e5b-227">Using the WITH Clause to Specify an Existing Table</span></span>
 <span data-ttu-id="08e5b-228">Можно использовать предложение WITH, чтобы указать имя существующей таблицы.</span><span class="sxs-lookup"><span data-stu-id="08e5b-228">You can use the WITH clause to specify the name of an existing table.</span></span> <span data-ttu-id="08e5b-229">Чтобы сделать это, просто укажите имя существующей таблицы, схема которой может быть использована OPENXML для создания набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-229">To do this, just specify an existing table name whose schema can be used by OPENXML to generate the rowset.</span></span>

#### <a name="using-the-with-clause-to-specify-a-schema"></a><span data-ttu-id="08e5b-230">Использование предложения WITH для указания схемы</span><span class="sxs-lookup"><span data-stu-id="08e5b-230">Using the WITH Clause to Specify a Schema</span></span>
 <span data-ttu-id="08e5b-231">Можно использовать предложение WITH, чтобы указать полную схему.</span><span class="sxs-lookup"><span data-stu-id="08e5b-231">You can use the WITH Clause to specify a complete schema.</span></span> <span data-ttu-id="08e5b-232">При указании схемы набора строк указываются имена столбцов, их типы данных и их сопоставление с XML-документом.</span><span class="sxs-lookup"><span data-stu-id="08e5b-232">In specifying the rowset schema, you specify the column names, their data types, and their mapping to the XML document.</span></span>

 <span data-ttu-id="08e5b-233">Можно указать шаблон столбца, применив аргумент ColPattern в SchemaDeclaration.</span><span class="sxs-lookup"><span data-stu-id="08e5b-233">You can specify the column pattern by using the ColPattern parameter in the SchemaDeclaration.</span></span> <span data-ttu-id="08e5b-234">Указанный шаблон столбца используется для сопоставления столбца набора строк с узлом XML, определенным rowpattern, а также используется для определения типа сопоставления.</span><span class="sxs-lookup"><span data-stu-id="08e5b-234">The specified column pattern is used to map a rowset column to the XML node that is identified by rowpattern and is also used to determine the type of mapping.</span></span>

 <span data-ttu-id="08e5b-235">Если аргумент ColPattern не указан для столбца, столбец набора строк сопоставляется с узлом XML с тем же именем, основываясь на сопоставлении, указанном посредством аргумента *flags* .</span><span class="sxs-lookup"><span data-stu-id="08e5b-235">If ColPattern is not specified for a column, the rowset column maps to the XML node with the same name, based on the mapping specified by the *flags* parameter.</span></span> <span data-ttu-id="08e5b-236">Однако если аргумент ColPattern задан как часть указания схемы в предложении WITH, он переопределяет сопоставление, указанное аргументом *flags* .</span><span class="sxs-lookup"><span data-stu-id="08e5b-236">However, if ColPattern is specified as part of the schema specification in the WITH clause, it overwrites the mapping that is specified in the *flags* parameter.</span></span>

### <a name="mapping-between-the-rowset-columns-and-the-xml-nodes"></a><span data-ttu-id="08e5b-237">сопоставление столбцов набора строк и узлов XML;</span><span class="sxs-lookup"><span data-stu-id="08e5b-237">Mapping Between the Rowset Columns and the XML Nodes</span></span>
 <span data-ttu-id="08e5b-238">В инструкции OPENXML можно при необходимости указать тип сопоставления, например атрибутивное или элементное, между столбцами набора строк и узлами XML, определенными посредством *rowpattern*.</span><span class="sxs-lookup"><span data-stu-id="08e5b-238">In the OPENXML statement, you can optionally specify the type of mapping, such as attribute-centric or element-centric, between the rowset columns and the XML nodes that are identified by the *rowpattern*.</span></span> <span data-ttu-id="08e5b-239">Эти данные используются в преобразовании между узлами XML и столбцами набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-239">This information is used in the transformation between the XML nodes and the rowset columns.</span></span>

 <span data-ttu-id="08e5b-240">Сопоставление может быть указано двумя способами, в том числе и обоими сразу:</span><span class="sxs-lookup"><span data-stu-id="08e5b-240">You can specify the mapping in two ways, and you can also specify both:</span></span>

-   <span data-ttu-id="08e5b-241">Используя аргумент *flags*</span><span class="sxs-lookup"><span data-stu-id="08e5b-241">By using the *flags* parameter</span></span>

     <span data-ttu-id="08e5b-242">Указание сопоставления посредством аргумента *flags* предполагает соответствие имен, в котором узлы XML сопоставляются с соответствующими столбцами набора строк, имеющими то же имя.</span><span class="sxs-lookup"><span data-stu-id="08e5b-242">The mapping that is specified by the *flags* parameter assumes name correspondence in which the XML nodes map to the corresponding rowset columns with same name.</span></span>

-   <span data-ttu-id="08e5b-243">Используя аргумент *ColPattern*</span><span class="sxs-lookup"><span data-stu-id="08e5b-243">By using the *ColPattern* parameter</span></span>

     <span data-ttu-id="08e5b-244">*ColPattern*, выражение XPath, указывается как часть *SchemaDeclaration* в предложении WITH.</span><span class="sxs-lookup"><span data-stu-id="08e5b-244">*ColPattern*, an XPath expression, is specified as part of *SchemaDeclaration* in the WITH clause.</span></span> <span data-ttu-id="08e5b-245">Сопоставлением, указанным в *ColPattern* , перекрывается сопоставление, указанное аргументом *flags* .</span><span class="sxs-lookup"><span data-stu-id="08e5b-245">The mapping specified in *ColPattern* overwrites the mapping specified by the *flags* parameter.</span></span>

     <span data-ttu-id="08e5b-246">*ColPattern* можно использовать для указания типа сопоставления, такого как атрибутивный или элементный, который переопределяет или расширяет сопоставление по умолчанию, указанное аргументом *flags*.</span><span class="sxs-lookup"><span data-stu-id="08e5b-246">*ColPattern* can be used to specify the type of mapping, such as attribute-centric or element-centric, that overwrites or enhances the default mapping indicated by the *flags*.</span></span>

     <span data-ttu-id="08e5b-247">*ColPattern* указывается в следующих ситуациях:</span><span class="sxs-lookup"><span data-stu-id="08e5b-247">*ColPattern* is specified under the following circumstances:</span></span>

    -   <span data-ttu-id="08e5b-248">Имя столбца в наборе строк отличается от имени атрибута или элемента, с которым оно сопоставлено.</span><span class="sxs-lookup"><span data-stu-id="08e5b-248">The column name in the rowset is different from the element or attribute name to which it is mapped.</span></span> <span data-ttu-id="08e5b-249">В этом случае *ColPattern* используется для определения имени элемента или атрибута в формате XML, с которым сопоставлен столбец набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-249">In this case, *ColPattern* is used to identify the XML element and attribute name to which the rowset column maps.</span></span>

    -   <span data-ttu-id="08e5b-250">Необходимо сопоставить атрибут метасвойства со столбцом.</span><span class="sxs-lookup"><span data-stu-id="08e5b-250">You want to map a metaproperty attribute to the column.</span></span> <span data-ttu-id="08e5b-251">В этом случае *ColPattern* используется для определения метасвойства, с которым сопоставлен столбец набора строк.</span><span class="sxs-lookup"><span data-stu-id="08e5b-251">In this case, *ColPattern* is used to identify the metaproperty to which the rowset column maps.</span></span> <span data-ttu-id="08e5b-252">Дополнительные сведения о том, как использовать метасвойства, см. в разделе [Определение метасвойств в инструкции OPENXML](../xml/specify-metaproperties-in-openxml.md).</span><span class="sxs-lookup"><span data-stu-id="08e5b-252">For more information about how to use metaproperties, see [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span></span>

 <span data-ttu-id="08e5b-253">Оба аргумента: и *flags* , и *ColPattern* , являются необязательными.</span><span class="sxs-lookup"><span data-stu-id="08e5b-253">Both the *flags* and *ColPattern* parameters are optional.</span></span> <span data-ttu-id="08e5b-254">Если сопоставление не указано, предполагается использование атрибутивного сопоставления,</span><span class="sxs-lookup"><span data-stu-id="08e5b-254">If no mapping is specified, attribute-centric mapping is assumed.</span></span> <span data-ttu-id="08e5b-255">которое является значением по умолчанию для параметра *flags* .</span><span class="sxs-lookup"><span data-stu-id="08e5b-255">Attribute-centric mapping is the default value of the *flags* parameter.</span></span>

#### <a name="attribute-centric-mapping"></a><span data-ttu-id="08e5b-256">атрибутивное сопоставление</span><span class="sxs-lookup"><span data-stu-id="08e5b-256">Attribute-centric Mapping</span></span>
 <span data-ttu-id="08e5b-257">При присвоении параметру *flags* в OPENXML значения 1 (XML_ATTRIBUTES) указывается **атрибутивное** сопоставление.</span><span class="sxs-lookup"><span data-stu-id="08e5b-257">Setting the *flags* parameter in OPENXML to 1 (XML_ATTRIBUTES) specifies **attribute-centric** mapping.</span></span> <span data-ttu-id="08e5b-258">Если аргумент *flags* содержит XML_ ATTRIBUTES, демонстрируемый набор строк предоставляет или потребляет строки, где каждый элемент XML представлен в виде строки.</span><span class="sxs-lookup"><span data-stu-id="08e5b-258">If *flags* contains XML_ ATTRIBUTES, the exposed rowset provides or consumes rows where each XML element is represented as a row.</span></span> <span data-ttu-id="08e5b-259">XML-атрибуты сопоставляются с атрибутами, определенными в SchemaDeclaration или предоставленными Tablename в предложении WITH, на основе соответствия имен.</span><span class="sxs-lookup"><span data-stu-id="08e5b-259">The XML attributes are mapped to the attributes that are defined in the SchemaDeclaration or that are provided by the Tablename of the WITH clause, based on name correspondence.</span></span> <span data-ttu-id="08e5b-260">Соответствие имен означает, что атрибуты XML, имеющие определенное имя, хранятся в столбце набора строк с тем же именем.</span><span class="sxs-lookup"><span data-stu-id="08e5b-260">Name correspondence means that the XML attributes of a particular name are stored in a column in the rowset with the same name.</span></span>

 <span data-ttu-id="08e5b-261">Если имя столбца отличается от имени атрибута, с которым оно сопоставлено, должен быть указан аргумент *ColPattern* .</span><span class="sxs-lookup"><span data-stu-id="08e5b-261">If the column name is different from the attribute name that it maps to, *ColPattern* must be specified.</span></span>

 <span data-ttu-id="08e5b-262">Если XML-атрибут имеет квалификатор пространства имен, имя столбца в наборе строк должно также иметь квалификатор.</span><span class="sxs-lookup"><span data-stu-id="08e5b-262">If the XML attribute has a namespace qualifier, the column name in the rowset must also have the qualifier.</span></span>

#### <a name="element-centric-mapping"></a><span data-ttu-id="08e5b-263">Сопоставление, ориентированное на элементы</span><span class="sxs-lookup"><span data-stu-id="08e5b-263">Element-centric Mapping</span></span>
 <span data-ttu-id="08e5b-264">При присвоении параметру *flags* в OPENXML значения 2 (XML_ELEMENTS) указывается **элементное** сопоставление.</span><span class="sxs-lookup"><span data-stu-id="08e5b-264">Setting the *flags* parameter in OPENXML to 2 (XML_ELEMENTS) specifies **element-centric** mapping.</span></span> <span data-ttu-id="08e5b-265">Оно подобно **атрибутивному** сопоставлению, за исключением следующих отличий:</span><span class="sxs-lookup"><span data-stu-id="08e5b-265">It is similar to **attribute-centric** mapping, except for the following differences:</span></span>

-   <span data-ttu-id="08e5b-266">Соответствие имен в примере сопоставления: при сопоставлении столбца с элементом XML с тем же именем выбираются простые подэлементы, если не указан шаблон на уровне столбца.</span><span class="sxs-lookup"><span data-stu-id="08e5b-266">The name correspondence of the mapping example, a column mapping to an XML element with the same name chooses the noncomplex subelements, unless a column-level pattern is specified.</span></span> <span data-ttu-id="08e5b-267">В процессе получения, если подэлемент является составным, поскольку содержит дополнительные подэлементы, столбцу присваивается значение NULL.</span><span class="sxs-lookup"><span data-stu-id="08e5b-267">In the retrieval process, if the subelement is complex because it contains additional subelements, the column is set to NULL.</span></span> <span data-ttu-id="08e5b-268">При этом значения атрибутов подэлементов пропускаются.</span><span class="sxs-lookup"><span data-stu-id="08e5b-268">Attribute values of the subelements are then ignored.</span></span>

-   <span data-ttu-id="08e5b-269">В случае с несколькими подэлементами, имеющими одно и то же имя, возвращается первый узел.</span><span class="sxs-lookup"><span data-stu-id="08e5b-269">For multiple subelements that have the same name, the first node is returned.</span></span>

## <a name="see-also"></a><span data-ttu-id="08e5b-270">См. также:</span><span class="sxs-lookup"><span data-stu-id="08e5b-270">See Also</span></span>
 <span data-ttu-id="08e5b-271">[sp_xml_preparedocument &#40;Transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-preparedocument-transact-sql) [sp_xml_removedocument &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-removedocument-transact-sql) [OPENXML &#40;Transact-](/sql/t-sql/functions/openxml-transact-sql) SQL&#41;[XML Data](../xml/xml-data-sql-server.md) &#40;SQL Server</span><span class="sxs-lookup"><span data-stu-id="08e5b-271">[sp_xml_preparedocument &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-preparedocument-transact-sql) [sp_xml_removedocument &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-removedocument-transact-sql) [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql) [XML Data &#40;SQL Server&#41;](../xml/xml-data-sql-server.md)</span></span>


