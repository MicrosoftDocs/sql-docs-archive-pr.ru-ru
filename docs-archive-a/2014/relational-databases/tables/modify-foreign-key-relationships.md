---
title: Изменение связей по внешнему ключу | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
f1_keywords:
- vdtsql.chm:65538
- vdt.ppg.relationships
helpviewer_keywords:
- foreign keys [SQL Server], modifying
- modifying foreign keys
ms.assetid: 0c9ca80d-d79b-44c4-a21e-0fce39c398ec
author: stevestein
ms.author: sstein
ms.openlocfilehash: ba9010b0d634a174dd35391c870d5003aa78efa1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655554"
---
# <a name="modify-foreign-key-relationships"></a>Изменение связей по внешнему ключу
  Изменить сторону внешнего ключа связи в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] можно с помощью [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../includes/tsql-md.md)]. При изменении внешнего ключа таблицы изменяются столбцы, связанные со столбцами таблицы первичного ключа.  
  
 **В этом разделе**  
  
-   **Перед началом работы**  
  
     [Ограничения](#Restrictions)  
  
     [Безопасность](#Security)  
  
-   **Изменение внешнего ключа с использованием следующих средств:**  
  
     [Среда SQL Server Management Studio](#SSMSProcedure)  
  
     [Transact-SQL](#TsqlProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> Перед началом  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> Ограничения  
 Тип данных и размер нового внешнего ключевого столбца должны соответствовать типу данных и размеру связанного с ним первичного ключевого столбца со следующими исключениями.  
  
-   Столбец типа `char` или `sysname` можно связать со столбцом типа `varchar`.  
  
-   Столбец типа `binary` можно связать со столбцом типа `varbinary`.  
  
-   Псевдоним типа данных можно связать со своим базовым типом.  
  
###  <a name="security"></a><a name="Security"></a> безопасность  
  
####  <a name="permissions"></a><a name="Permissions"></a> Permissions  
 Требуется разрешение ALTER на таблицу.  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> Использование среды SQL Server Management Studio  
  
#### <a name="to-modify-a-foreign-key"></a>Изменение внешнего ключа  
  
1.  Разверните в **обозревателе объектов**таблицу с внешним ключом, а затем разверните **Ключи**.  
  
2.  Щелкните правой кнопкой мыши внешний ключ, который нужно изменить, и выберите пункт **Изменить**.  
  
3.  В диалоговом окне **Связи внешних ключей** можно внести следующие изменения.  
  
     **Выбранные связи**  
     Выводит список существующих связей. Выберите связь, чтобы ее свойства отобразились в сетке справа. Если этот список пуст, то для этой таблицы не было определено ни одной связи.  
  
     **Добавление**  
     Создает новую связь. **Спецификации таблиц и столбцов** должны быть заданы, иначе связь будет недопустима.  
  
     **Удаление**  
     Удаляет связь, выбранную в списке **Выбранные связи** . Чтобы отменить добавление связи, удалите эту связь, нажав данную кнопку.  
  
     **Общая категория**  
     Разверните, чтобы увидеть категории **Проверить существующие данные при создании или повторном включении** и **Спецификации таблиц и столбцов**.  
  
     **Check Existing Data on Creation or Re-Enabling**  
     Проверяет все существующие данные в таблице перед созданием или возобновлением ограничения относительно этого ограничения.  
  
     **Категория спецификации таблиц и столбцов**  
     Разверните, чтобы увидеть, какие столбцы, из каких таблиц действуют как внешний и первичный (или уникальный) ключ в данной связи. Для изменения или задания этих значений нажмите кнопку с многоточием ( **...** ) справа от поля свойства.  
  
     **Базовая таблица внешнего ключа**  
     Показывает, какая таблица содержит столбец, действующий как внешний ключ в выбранной связи.  
  
     **Внешние ключевые столбцы**  
     Показывает, какой столбец действует как внешний ключ в выбранной связи.  
  
     **Базовая таблица первичного или уникального ключа**  
     Показывает, какая таблица содержит столбец, действующий как первичный (или уникальный) ключ в выбранной связи.  
  
     **Первичные или уникальные ключевые столбцы**  
     Показывает, какой столбец действует как первичный (или уникальный) ключ в выбранной связи.  
  
     **Категория «Идентификатор»**  
     Разверните, чтобы увидеть поля свойств **Имя** и **Описание**.  
  
     **Название**  
     Показывает имя связи. Если создается новая связь, ей присваивается имя по умолчанию в зависимости от таблицы, отображаемой в активном окне в **Конструкторе таблиц**. Имя можно изменить в любой момент.  
  
     **Описание**  
     Описывает связь. Чтобы ввести более подробное описание, щелкните **Описание** и нажмите кнопку с многоточием **(...)** справа от поля свойства. При этом появится большее поле для записи текста.  
  
     **Категория конструктора таблиц**  
     Разверните, чтобы увидеть данные для категорий **Проверка существующих данных при создании и возобновлении** и **Включить использование для репликации**.  
  
     **Принудительное применение для репликации**  
     Показывает, использовать ли данное ограничение, когда агент репликации выполняет в таблице вставку, изменение или удаление.  
  
     **Принудительное использование ограничения внешнего ключа**  
     Укажите, допустимы ли изменения данных столбцов связи, если при этом нарушится целостность связи внешнего ключа. Выберите **Да** , если нужно запретить такие изменения, и **Нет** , если нужно разрешить их.  
  
     **Категория спецификаций INSERT и UPDATE**  
     Разверните, чтобы увидеть сведения о **Правиле удаления** и **Правиле обновления** связи.  
  
     **Правиле удаления**  
     Укажите, что произойдет при попытке пользователя удалить строку с данными, участвующую в связи внешнего ключа:  
  
    -   **Нет действий.** Сообщение об ошибке информирует пользователя, что удаление недопустимо, и инструкция DELETE откатывается.  
  
    -   **Каскад.** Удаляет все строки, содержащие данные, участвующие в связи внешнего ключа. Не следует использовать параметр CASCADE, если таблица будет включена в публикацию слиянием, в которой используются логические записи.  
  
    -   **Присвоить NULL** . Задает значение, равное NULL, если все внешние ключевые столбцы в таблице могут содержать значения NULL.  
  
    -   **Присвоить значение по умолчанию** . Задает значение по умолчанию, определенное для данного столбца, если все внешние ключевые столбцы в таблице имеют значения по умолчанию.  
  
     **Правиле обновления**  
     Укажите, что произойдет при попытке пользователя обновить строку с данными, участвующую в связи внешнего ключа.  
  
    -   **Нет действий.** Сообщение об ошибке информирует пользователя, что обновление недопустимо, и инструкция UPDATE откатывается.  
  
    -   **Каскад.** Обновляет все строки, содержащие данные, участвующие в связи внешнего ключа. Не следует использовать параметр CASCADE, если таблица будет включена в публикацию слиянием, в которой используются логические записи.  
  
    -   **Присвоить NULL** . Задает значение, равное NULL, если все внешние ключевые столбцы в таблице могут содержать значения NULL.  
  
    -   **Присвоить значение по умолчанию.** Задает значение по умолчанию, определенное для данного столбца, если все внешние ключевые столбцы в таблице имеют значения по умолчанию.  
  
4.  В меню **Файл** выберите пункт **Сохранить**_table name_.  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> Использование Transact-SQL  
 **Изменение внешнего ключа**  
  
 Чтобы изменить ограничение FOREIGN KEY с помощью Transact-SQL, сначала необходимо удалить существующее ограничение FOREIGN KEY, а затем повторно создать его с новым определением. Дополнительные сведения см. в разделах [Delete Foreign Key Relationships](delete-foreign-key-relationships.md) и [Create Foreign Key Relationships](create-foreign-key-relationships.md).  
  
###  <a name="TsqlExample"></a>  
