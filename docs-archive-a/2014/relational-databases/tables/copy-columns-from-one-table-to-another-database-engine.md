---
title: Копирование столбцов из одной таблицы в другую (ядро СУБД) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- copying columns
- columns [SQL Server], copying
ms.assetid: 5f5e70dc-69f9-44b8-bc48-b5d51ac20d77
author: stevestein
ms.author: sstein
ms.openlocfilehash: 37b98bf0910cbbb4c2a1d7fe01f11d52703ec88c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669364"
---
# <a name="copy-columns-from-one-table-to-another-database-engine"></a>Копирование столбцов из одной таблицы в другую (компонент Database Engine)
  В этом разделе описывается копирование столбцов из одной таблицы в другую, когда копируется либо только определение столбца, либо определение и данные из [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../includes/tsql-md.md)].  
  
 **В этом разделе**  
  
-   **Перед началом работы**  
  
     [Ограничения](#Restrictions)  
  
     [Безопасность](#Security)  
  
-   **Копирование столбцов с помощью**  
  
     [Среда SQL Server Management Studio](#SSMSProcedure)  
  
     [Transact-SQL](#TsqlProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> Перед началом  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> Ограничения  
 При копировании из одной базы данных в другую столбца, имеющего псевдоним типа данных, исходный тип данных в целевой базе данных может оказаться недоступным. В этом случае столбцу будет назначен ближайший подходящий базовый тип данных, доступный в целевой базе данных.  
  
###  <a name="security"></a><a name="Security"></a> безопасность  
  
####  <a name="permissions"></a><a name="Permissions"></a> Permissions  
 Требуется разрешение ALTER на таблицу.  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> Использование среды SQL Server Management Studio  
  
#### <a name="to-copy-column-definitions-from-one-table-to-another"></a>Копирование определения столбца из одной таблицы в другую  
  
1.  Щелкнув правой кнопкой мыши, откройте таблицу со столбцами, предназначенными к копированию, и таблицу, в которую необходимо выполнить копирование, затем нажмите кнопку **Разработка**.  
  
2.  Выберите вкладку исходной таблицы и выделите нужные столбцы.  
  
3.  В меню **Правка** выберите **Копировать**.  
  
4.  Выберите вкладку таблицы, в которую требуется скопировать столбцы.  
  
5.  Выделите столбец, после которого нужно поместить вставляемые столбцы, и в меню **Правка** выберите **Вставить**.  
  
#### <a name="to-copy-data-from-one-table-to-another"></a>Копирование данных из одной таблицы в другую  
  
1.  Следуйте приведенным выше инструкциям для копирования определения столбцов.  
  
    > [!NOTE]  
    >  Прежде чем скопировать данные из одной таблицы в другую, убедитесь, что типы данных целевых столбцов совместимы с типами данных исходных.  
  
2.  В обозревателе объектов щелкните правой кнопкой мыши папку **Представления** и выберите в контекстном меню пункт **Создать представление**.  
  
3.  В меню **Конструктор запросов** выберите пункт **Тип изменения**, а затем пункт **Вставить результаты**.  
  
4.  В диалоговом окне **Выберите целевую таблицу для инструкции Insert Results** выберите таблицу, куда необходимо скопировать данные, и нажмите кнопку **ОК**.  
  
     При копировании строк внутри таблицы в качестве целевой таблицы нужно указать исходную.  
  
    > [!NOTE]  
    >  **Конструктор запросов** не может определить заранее, какие таблицы и представления доступны для обновления. Поэтому в диалоговом окне **Выберите целевую таблицу для инструкции Insert Results** приведен список всех таблиц и представлений, доступных этому подключению к данным, даже тех, копирование строк в которые будет невозможно.  
  
5.  Щелкните правой кнопкой мыши панель диаграммы и в контекстном меню выберите пункт **Добавить таблицу в диаграмму**.  
  
6.  В диалоговом окне **Добавить таблицу** выберите таблицы, из которых требуется скопировать данные, нажмите сначала кнопку **Добавить**, а затем кнопку **Закрыть**.  
  
     Таблицы появляются на панели диаграммы в сокращенной форме.  
  
7.  В таблицах отметьте столбцы, данные из которых необходимо скопировать.  
  
8.  На панели критериев в столбце **Присоединение** для каждого целевого столбца выберите столбец, из которого должны быть скопированы данные.  
  
9. Укажите строки, которые необходимо скопировать, заданием условий поиска на панели критериев. Подробные сведения см. в разделе [Указание условий поиска (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/visual-database-tools.md).  
  
     Если условия поиска не заданы, в целевую таблицу будут скопированы все строки исходной таблицы.  
  
10. Если необходимо скопировать сводные данные, укажите параметры **Group By** . Подробные сведения см. в разделе [Получение суммарных или статистических значений для всех строк в таблице (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/summarize-or-aggregate-values-for-all-rows-in-a-table-visual-database-tools.md).  
  
11. Для запуска запроса нажмите кнопку **Выполнить SQL** .  
  
     При выполнении запроса по вставке результатов результаты не отображаются на панели [Результаты](../../ssms/visual-db-tools/results-pane-visual-database-tools.md). Вместо этого появляется сообщение о количестве скопированных строк.  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> Использование Transact-SQL  
  
#### <a name="to-copy-column-definitions-from-one-table-to-another"></a>Копирование определения столбца из одной таблицы в другую  
  
1.  Нельзя копировать отдельные столбцы из одной таблицы в другую (существующую) с использованием инструкций Transact-SQL. Однако можно создать новую таблицу в файловой группе по умолчанию и вставить в нее результирующие строки из запроса с помощью инструкции SELECT INTO. Дополнительные сведения см. в разделе [Предложение INTO (Transact-SQL)](/sql/t-sql/queries/select-into-clause-transact-sql).  
  
#### <a name="to-copy-data-from-one-table-to-another"></a>Копирование данных из одной таблицы в другую  
  
1.  В **обозревателе объектов**подключитесь к экземпляру компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)].  
  
2.  На стандартной панели выберите пункт **Создать запрос**.  
  
3.  Скопируйте следующий пример в окно запроса и нажмите кнопку **Выполнить**.  
  
    ```  
    USE AdventureWorks2012;  
    GO  
    CREATE TABLE dbo.EmployeeSales  
    ( BusinessEntityID   varchar(11) NOT NULL,  
      SalesYTD money NOT NULL  
    );  
    GO  
    INSERT INTO dbo.EmployeeSales  
        SELECT BusinessEntityID, SalesYTD   
        FROM Sales.SalesPerson;  
    GO  
    ```  
  
  
