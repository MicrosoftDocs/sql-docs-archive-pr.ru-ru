---
title: Поля дескриптора для составных столбцов возвращающего табличное значение параметра | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields for constituent columns
ms.assetid: 944b3968-fd47-4847-98d6-b87e8ef2acdc
author: rothja
ms.author: jroth
ms.openlocfilehash: 7474a4a80309f6ce9754fefabfd0080c89f803b3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667078"
---
# <a name="descriptor-fields-for-table-valued-parameter-constituent-columns"></a><span data-ttu-id="0ebb3-102">Поля дескриптора для столбцов, содержащих параметры, возвращающие табличные значения</span><span class="sxs-lookup"><span data-stu-id="0ebb3-102">Descriptor Fields for Table-Valued Parameter Constituent Columns</span></span>
  <span data-ttu-id="0ebb3-103">Поля дескриптора возвращающего табличное значение параметра, описанные в этом разделе, управляются с помощью [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) и [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) с дескриптором для дескриптора параметра реализации (IPD).</span><span class="sxs-lookup"><span data-stu-id="0ebb3-103">The table-valued parameter descriptor fields described in this section are manipulated by using [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) and [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) with the handle for the implementation parameter descriptor (IPD).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="0ebb3-104">Remarks</span><span class="sxs-lookup"><span data-stu-id="0ebb3-104">Remarks</span></span>  
 <span data-ttu-id="0ebb3-105">SQL_DESC_AUTO_UNIQUE_VALUE используется для параметров, возвращающих табличные значения, и других компонентов.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-105">SQL_DESC_AUTO_UNIQUE_VALUE is used for table-valued parameters as well as other features.</span></span>  
  
|<span data-ttu-id="0ebb3-106">Имя атрибута</span><span class="sxs-lookup"><span data-stu-id="0ebb3-106">Attribute name</span></span>|<span data-ttu-id="0ebb3-107">Type</span><span class="sxs-lookup"><span data-stu-id="0ebb3-107">Type</span></span>|<span data-ttu-id="0ebb3-108">Описание</span><span class="sxs-lookup"><span data-stu-id="0ebb3-108">Description</span></span>|  
|--------------------|----------|-----------------|  
|<span data-ttu-id="0ebb3-109">SQL_DESC_AUTO_UNIQUE_VALUE</span><span class="sxs-lookup"><span data-stu-id="0ebb3-109">SQL_DESC_AUTO_UNIQUE_VALUE</span></span>|<span data-ttu-id="0ebb3-110">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="0ebb3-110">SQLINTEGER</span></span>|<span data-ttu-id="0ebb3-111">SQL_TRUE указывает, что этот столбец является столбцом идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-111">SQL_TRUE indicates that this column is an identity column.</span></span><br /><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="0ebb3-112">может использовать эти сведения для оптимизации производительности, но не обязательно устанавливать их для столбцов идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-112">can use this information to optimize performance, but applications are not required to set it for identity columns.</span></span>|  
  
 <span data-ttu-id="0ebb3-113">Следующие атрибуты добавляются к параметрам всех типов в дескрипторе параметра приложения (APD) и дескрипторе параметра реализации (IPD).</span><span class="sxs-lookup"><span data-stu-id="0ebb3-113">The following attributes are added to all parameter types in the application parameter descriptor (APD) and implementation parameter descriptor (IPD):</span></span>  
  
|<span data-ttu-id="0ebb3-114">Имя атрибута</span><span class="sxs-lookup"><span data-stu-id="0ebb3-114">Attribute name</span></span>|<span data-ttu-id="0ebb3-115">Type</span><span class="sxs-lookup"><span data-stu-id="0ebb3-115">Type</span></span>|<span data-ttu-id="0ebb3-116">Описание</span><span class="sxs-lookup"><span data-stu-id="0ebb3-116">Description</span></span>|  
|--------------------|----------|-----------------|  
|<span data-ttu-id="0ebb3-117">SQL_CA_SS_COLUMN_COMPUTED</span><span class="sxs-lookup"><span data-stu-id="0ebb3-117">SQL_CA_SS_COLUMN_COMPUTED</span></span>|<span data-ttu-id="0ebb3-118">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="0ebb3-118">SQLSMALLINT</span></span>|<span data-ttu-id="0ebb3-119">SQL_TRUE указывает, что этот столбец является вычисляемым.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-119">SQL_TRUE indicates that this column is computed.</span></span><br /><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="0ebb3-120">может использовать эту информацию для оптимизации производительности, но приложения не обязательно устанавливать их для вычислений столбцов.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-120">can use this information to optimize performance, but applications are not required to set it for computed columns.</span></span><br /><br /> <span data-ttu-id="0ebb3-121">Этот атрибут пропускается в случае привязок, не являющихся столбцами параметров, возвращающих табличные значения.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-121">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span>|  
|<span data-ttu-id="0ebb3-122">SQL_CA_SS_COLUMN_IN_UNIQUE_KEY</span><span class="sxs-lookup"><span data-stu-id="0ebb3-122">SQL_CA_SS_COLUMN_IN_UNIQUE_KEY</span></span>|<span data-ttu-id="0ebb3-123">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="0ebb3-123">SQLSMALLINT</span></span>|<span data-ttu-id="0ebb3-124">SQL_TRUE указывает, что столбец возвращающих табличное значение параметров является частью уникального ключа.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-124">SQL_TRUE indicates that a table-valued parameter column participates in a unique key.</span></span> <span data-ttu-id="0ebb3-125">Это может повысить производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-125">This can result in better query performance.</span></span> <span data-ttu-id="0ebb3-126">Этот атрибут пропускается в случае привязок, не являющихся столбцами параметров, возвращающих табличные значения.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-126">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span>|  
|<span data-ttu-id="0ebb3-127">SQL_CA_SS_COLUMN_SORT_ORDER</span><span class="sxs-lookup"><span data-stu-id="0ebb3-127">SQL_CA_SS_COLUMN_SORT_ORDER</span></span>|<span data-ttu-id="0ebb3-128">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="0ebb3-128">SQLSMALLINT</span></span>|<span data-ttu-id="0ebb3-129">Указывает порядок сортировки столбца возвращающих табличное значение параметров.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-129">Indicates the sort order of a table-valued parameter column.</span></span> <span data-ttu-id="0ebb3-130">Это может повысить производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-130">This can result in better query performance.</span></span> <span data-ttu-id="0ebb3-131">Этот атрибут пропускается в случае привязок, не являющихся столбцами параметров, возвращающих табличные значения.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-131">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span> <span data-ttu-id="0ebb3-132">Возможные значения.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-132">The possible values are the following:</span></span><br /><br /> <span data-ttu-id="0ebb3-133">— SQL_SS_ASCENDING_ORDER</span><span class="sxs-lookup"><span data-stu-id="0ebb3-133">-   SQL_SS_ASCENDING_ORDER</span></span><br /><span data-ttu-id="0ebb3-134">— SQL_SS_DESCENDING_ORDER</span><span class="sxs-lookup"><span data-stu-id="0ebb3-134">-   SQL_SS_DESCENDING_ORDER</span></span><br /><span data-ttu-id="0ebb3-135">— SQL_SS_ORDER_UNSPECIFIED</span><span class="sxs-lookup"><span data-stu-id="0ebb3-135">-   SQL_SS_ORDER_UNSPECIFIED</span></span><br /><br /> <span data-ttu-id="0ebb3-136">Для значений, отличных от SQL_SS_ASCENDING_ORDER и SQL_SS_DESCENDING_ORDER, будет выдана ошибка с кодом SQLSTATE HY024 и сообщением «Недопустимое значение атрибута», а дальнейшая обработка произведена таким же образом, как и для значения SQL_SS_ORDER_UNSPECIFIED, которое является значением по умолчанию этого атрибута.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-136">Values other than SQL_SS_ASCENDING_ORDER and SQL_SS_DESCENDING_ORDER generate an error with SQLSTATE HY024 and message 'Invalid attribute value' and are treated as SQL_SS_ORDER_UNSPECIFIED, which is the default value for this attribute.</span></span>|  
|<span data-ttu-id="0ebb3-137">SQL_CA_SS_COLUMN_SORT_ORDINAL</span><span class="sxs-lookup"><span data-stu-id="0ebb3-137">SQL_CA_SS_COLUMN_SORT_ORDINAL</span></span>|<span data-ttu-id="0ebb3-138">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="0ebb3-138">SQLSMALLINT</span></span>|<span data-ttu-id="0ebb3-139">Указывает порядковый номер столбца параметра, возвращающего табличное значение, в наборе столбцов, которые определяют сквозной порядковый номер для параметра, возвращающего табличное значение.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-139">Indicates the ordinal of a table-valued parameter column in the set of columns that define the overall ordering for a table-valued parameter.</span></span> <span data-ttu-id="0ebb3-140">Это может повысить производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-140">This can result in better query performance.</span></span> <span data-ttu-id="0ebb3-141">Этот атрибут пропускается в случае привязок, не являющихся столбцами параметров, возвращающих табличные значения.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-141">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span> <span data-ttu-id="0ebb3-142">Порядковые номера сортировки начинаются с 1.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-142">Sort ordinals start at 1.</span></span> <span data-ttu-id="0ebb3-143">Значение 0 (устанавливаемое по умолчанию) указывает, что столбец параметра, возвращающего табличное значение, не упорядочен.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-143">A value of 0, the default, indicates that a table-valued parameter column does not have column ordering.</span></span>|  
|<span data-ttu-id="0ebb3-144">SQL_CA_SS_COLUMN_HAS_DEFAULT_VALUE</span><span class="sxs-lookup"><span data-stu-id="0ebb3-144">SQL_CA_SS_COLUMN_HAS_DEFAULT_VALUE</span></span>|<span data-ttu-id="0ebb3-145">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="0ebb3-145">SQLSMALLINT</span></span>|<span data-ttu-id="0ebb3-146">Указывает, будут ли все строки параметра, возвращающего табличное значение, иметь значение по умолчанию для этого столбца.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-146">Indicates whether all rows in the table-valued parameter will have the default value for this column.</span></span> <span data-ttu-id="0ebb3-147">Для параметров, возвращающих табличное значение, значение по умолчанию не может выбираться построчно.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-147">For table-valued parameters, it is not possible to select the default value on a row-by-row basis.</span></span> <span data-ttu-id="0ebb3-148">Значение SQL_FALSE указывает на то, что строки будут иметь значения отличные от значений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-148">A value of SQL_FALSE indicates that rows will have non-default values.</span></span> <span data-ttu-id="0ebb3-149">Это значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-149">This is the default.</span></span> <span data-ttu-id="0ebb3-150">Значение SQL_TRUE указывает, что этот столбец будет иметь значения по умолчанию для всех строк.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-150">A value of SQL_TRUE indicates that this column will have default values for all rows.</span></span><br /><br /> <span data-ttu-id="0ebb3-151">Если установлено значение SQL_TRUE, то данные не будут отправляться на сервер.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-151">If set to SQL_TRUE, no data will be sent to the server.</span></span><br /><br /> <span data-ttu-id="0ebb3-152">Это поле также используется со столбцами идентификаторов или вычисляемых столбцов, если их обработка на сервере не требуется.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-152">This field can also be used with identity or computed columns if the column values are not required for server processing.</span></span>|  
  
 <span data-ttu-id="0ebb3-153">Эти атрибуты доступны только для столбцов возвращающих табличные значения параметров.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-153">These attributes are only valid for table-valued parameter columns.</span></span> <span data-ttu-id="0ebb3-154">Для других параметров они не учитываются.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-154">They are ignored for other parameters.</span></span>  
  
 <span data-ttu-id="0ebb3-155">Если для столбца, возвращающего табличное значение параметра, установлен атрибут SQL_CA_SS_COL_HAS_DEFAULT_VALUE, то SQL_DESC_DATA_PTR для этого столбца должен быть равен null.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-155">If SQL_CA_SS_COL_HAS_DEFAULT_VALUE is set for a table-valued parameter column, SQL_DESC_DATA_PTR for that column must be a null pointer.</span></span> <span data-ttu-id="0ebb3-156">В противном случае SQLExecute или SQLExecDirect возвратит SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-156">Otherwise, SQLExecute or SQLExecDirect will return SQL_ERROR.</span></span> <span data-ttu-id="0ebb3-157">Будет создана диагностическая запись с параметром SQLSTATE = 07S01 и сообщением "Недопустимое использование параметра по умолчанию для параметра \<p> , столбца \<c> ", где \<p> — это порядковый номер параметра, а \<c> — порядковый номер столбца.</span><span class="sxs-lookup"><span data-stu-id="0ebb3-157">A diagnostic record will be generated with SQLSTATE=07S01 and the message "Invalid use of default parameter for parameter \<p>, column \<c>", where \<p> is the parameter ordinal and \<c> is the column ordinal.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0ebb3-158">См. также:</span><span class="sxs-lookup"><span data-stu-id="0ebb3-158">See Also</span></span>  
 [<span data-ttu-id="0ebb3-159">Возвращающие табличное значение параметры &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="0ebb3-159">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
