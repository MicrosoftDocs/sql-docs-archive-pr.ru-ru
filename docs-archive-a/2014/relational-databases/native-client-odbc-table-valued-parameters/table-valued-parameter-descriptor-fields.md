---
title: Поля дескриптора возвращающего табличное значение параметра | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87730638"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="f7b20-102">Поля дескрипторов возвращающего табличное значение параметра</span><span class="sxs-lookup"><span data-stu-id="f7b20-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="f7b20-103">Поддержка возвращающих табличное значение параметров включает новые поля в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-дескрипторах параметра ODBC-приложения и дескрипторах параметра реализации.</span><span class="sxs-lookup"><span data-stu-id="f7b20-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="f7b20-104">Remarks</span><span class="sxs-lookup"><span data-stu-id="f7b20-104">Remarks</span></span>  
  
|<span data-ttu-id="f7b20-105">Имя</span><span class="sxs-lookup"><span data-stu-id="f7b20-105">Name</span></span>|<span data-ttu-id="f7b20-106">Расположение</span><span class="sxs-lookup"><span data-stu-id="f7b20-106">Location</span></span>|<span data-ttu-id="f7b20-107">Тип</span><span class="sxs-lookup"><span data-stu-id="f7b20-107">Type</span></span>|<span data-ttu-id="f7b20-108">Описание</span><span class="sxs-lookup"><span data-stu-id="f7b20-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="f7b20-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="f7b20-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="f7b20-110">IPD</span><span class="sxs-lookup"><span data-stu-id="f7b20-110">IPD</span></span>|<span data-ttu-id="f7b20-111">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="f7b20-111">SQLTCHAR\*</span></span>|<span data-ttu-id="f7b20-112">Имя серверного типа возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="f7b20-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="f7b20-113">Если в вызове SQLBindParameter указано имя типа возвращающего табличное значение параметра, оно всегда должно быть указано в Юникоде даже в приложениях, созданных как приложения ANSI.</span><span class="sxs-lookup"><span data-stu-id="f7b20-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="f7b20-114">Значение, используемое для параметра *StrLen_or_IndPtr* , должно быть либо SQL_NTS, либо строковой длины имени, умноженной на sizeof (WChar).</span><span class="sxs-lookup"><span data-stu-id="f7b20-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="f7b20-115">Если имя типа возвращающего табличное значение параметра указывается через SQLSetDescField, его можно указать с помощью литерала, который соответствует способу построения приложения.</span><span class="sxs-lookup"><span data-stu-id="f7b20-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="f7b20-116">Диспетчер драйвера ODBC выполнит все необходимые преобразования данных в Юникод.</span><span class="sxs-lookup"><span data-stu-id="f7b20-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="f7b20-117">SQL_CA_SS_TYPE_CATALOG_NAME (только для чтения)</span><span class="sxs-lookup"><span data-stu-id="f7b20-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="f7b20-118">IPD</span><span class="sxs-lookup"><span data-stu-id="f7b20-118">IPD</span></span>|<span data-ttu-id="f7b20-119">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="f7b20-119">SQLTCHAR\*</span></span>|<span data-ttu-id="f7b20-120">Каталог, в котором определен тип.</span><span class="sxs-lookup"><span data-stu-id="f7b20-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="f7b20-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="f7b20-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="f7b20-122">IPD</span><span class="sxs-lookup"><span data-stu-id="f7b20-122">IPD</span></span>|<span data-ttu-id="f7b20-123">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="f7b20-123">SQLTCHAR\*</span></span>|<span data-ttu-id="f7b20-124">Схема, в которой определен тип.</span><span class="sxs-lookup"><span data-stu-id="f7b20-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="f7b20-125">Приложения не должны устанавливать SQL_CA_SS_TYPE_CATALOG_NAME для возвращающих табличное значение параметров.</span><span class="sxs-lookup"><span data-stu-id="f7b20-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="f7b20-126">Иначе будет возвращена ошибка SQL_ERROR и зарегистрирована диагностическая запись с SQLSTATE = HY091 и сообщением «Недопустимый идентификатор поля дескриптора».</span><span class="sxs-lookup"><span data-stu-id="f7b20-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="f7b20-127">Если фокус параметра установлен на возвращающий табличное значение параметр, то к возвращающим табличное значение параметрам применяются следующие атрибуты инструкций и поля заголовка дескриптора:</span><span class="sxs-lookup"><span data-stu-id="f7b20-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="f7b20-128">Имя</span><span class="sxs-lookup"><span data-stu-id="f7b20-128">Name</span></span>|<span data-ttu-id="f7b20-129">Расположение</span><span class="sxs-lookup"><span data-stu-id="f7b20-129">Location</span></span>|<span data-ttu-id="f7b20-130">Тип</span><span class="sxs-lookup"><span data-stu-id="f7b20-130">Type</span></span>|<span data-ttu-id="f7b20-131">Описание</span><span class="sxs-lookup"><span data-stu-id="f7b20-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="f7b20-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="f7b20-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="f7b20-133">(эквивалентен SQL_DESC_ARRAY_SIZE в дескрипторе параметра приложения)</span><span class="sxs-lookup"><span data-stu-id="f7b20-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="f7b20-134">APD</span><span class="sxs-lookup"><span data-stu-id="f7b20-134">APD</span></span>|<span data-ttu-id="f7b20-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="f7b20-135">SQLUINTEGER</span></span>|<span data-ttu-id="f7b20-136">Размер массива для массивов буфера для возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="f7b20-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="f7b20-137">Это максимальное количество строк, которое может быть размещено в буферах, или размер буферов в строках. Возвращающий табличное значение параметр может иметь больше или меньше строк, чем помещается в буфер.</span><span class="sxs-lookup"><span data-stu-id="f7b20-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="f7b20-138">Значение по умолчанию: 1.</span><span class="sxs-lookup"><span data-stu-id="f7b20-138">Default is 1.</span></span> <span data-ttu-id="f7b20-139">**Примечание.**  Если для SQL_SOPT_SS_PARAM_FOCUS задано значение по умолчанию 0, SQL_ATTR_PARAMSET_SIZE ссылается на инструкцию и указывает количество наборов параметров.</span><span class="sxs-lookup"><span data-stu-id="f7b20-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="f7b20-140">Если для SQL_SOPT_SS_PARAM_FOCUS задан порядковый номер возвращающего табличное значение параметра, то он ссылается на возвращающий табличное значение параметр и указывает число строк для набора параметров для возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="f7b20-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="f7b20-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="f7b20-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="f7b20-142">APD</span><span class="sxs-lookup"><span data-stu-id="f7b20-142">APD</span></span>|<span data-ttu-id="f7b20-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="f7b20-143">SQLINTEGER</span></span>|<span data-ttu-id="f7b20-144">По умолчанию имеет значение SQL_PARAM_BIND_BY_COLUMN.</span><span class="sxs-lookup"><span data-stu-id="f7b20-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="f7b20-145">Чтобы выбрать привязку на уровне строки, это поле имеет значение длины структуры или экземпляра буфера, который будет привязан к набору строк возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="f7b20-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="f7b20-146">Эта длина должна включать пробел для всех связанных столбцов и все заполнения структуры или буфера.</span><span class="sxs-lookup"><span data-stu-id="f7b20-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="f7b20-147">Это гарантирует, что если адрес связанного столбца увеличивается на указанную длину, результат будет указывать на начало того же столбца в следующей строке.</span><span class="sxs-lookup"><span data-stu-id="f7b20-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="f7b20-148">При использовании оператора `sizeof` в ANSI C, такое поведение гарантируется.</span><span class="sxs-lookup"><span data-stu-id="f7b20-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="f7b20-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="f7b20-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="f7b20-150">APD</span><span class="sxs-lookup"><span data-stu-id="f7b20-150">APD</span></span>|<span data-ttu-id="f7b20-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="f7b20-151">SQLINTEGER\*</span></span>|<span data-ttu-id="f7b20-152">Значение по умолчанию — указатель NULL.</span><span class="sxs-lookup"><span data-stu-id="f7b20-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="f7b20-153">Если это поле имеет значение, отличное от NULL, драйвер разыменовывает указатель, добавляет разыменованное значение к каждому из отложенных полей в записи дескриптора (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR и SQL_DESC_OCTET_LENGTH_PTR), и использует новые значения указателя, чтобы получить значения данных.</span><span class="sxs-lookup"><span data-stu-id="f7b20-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="f7b20-154">Эти поля допустимы только для возвращающих табличное значение параметров и не учитываются для всех остальных типов данных.</span><span class="sxs-lookup"><span data-stu-id="f7b20-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="f7b20-155">Поле SQL_CA_SS_TYPE_NAME не является обязательным для вызовов хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="f7b20-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="f7b20-156">Оно должно быть указано для инструкций SQL, не являющихся вызовами процедур, чтобы разрешить серверу определять тип возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="f7b20-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="f7b20-157">Если необходимо имя типа и тип таблицы для возвращающего табличное значение параметра определяется в схеме, отличной от этой хранимой процедуры, то значение SQL_CA_SS_TYPE_SCHEMA_NAME должно быть задано в дескрипторе параметра реализации.</span><span class="sxs-lookup"><span data-stu-id="f7b20-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="f7b20-158">Иначе сервер не сможет определить тип возвращающего табличное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="f7b20-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="f7b20-159">Это приведет к ошибке при вызове SQLExecute или SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="f7b20-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="f7b20-160">Ошибка будет иметь статус SQLSTATE= 07006 и сообщение «Нарушение атрибута ограниченного типа данных».</span><span class="sxs-lookup"><span data-stu-id="f7b20-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="f7b20-161">Столбцы возвращающего табличное значение параметра могут использовать привязки на уровне столбца или строки.</span><span class="sxs-lookup"><span data-stu-id="f7b20-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="f7b20-162">По умолчанию используется привязка на уровне столбца.</span><span class="sxs-lookup"><span data-stu-id="f7b20-162">The default is column-wise binding.</span></span> <span data-ttu-id="f7b20-163">Установив параметр SQL_ATTR_PARAM_BIND_TYPE и SQL_ATTR_ PARAM_BIND_OFFSET_PTR, можно указать привязку на уровне строки.</span><span class="sxs-lookup"><span data-stu-id="f7b20-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="f7b20-164">Это аналогично привязке на уровне строки столбцов и параметров.</span><span class="sxs-lookup"><span data-stu-id="f7b20-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="f7b20-165">Атрибуты SQL_CA_SS_TYPE_CATALOG_NAME и SQL_CA_SS_TYPE_SCHEMA_NAME могут также использоваться для получения каталога и схемы, связанных с параметрами определяемых пользователем типов данных CLR.</span><span class="sxs-lookup"><span data-stu-id="f7b20-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="f7b20-166">Это альтернатива для существующих атрибутов схемы каталога, зависящих от типа, для этих типов.</span><span class="sxs-lookup"><span data-stu-id="f7b20-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7b20-167">См. также:</span><span class="sxs-lookup"><span data-stu-id="f7b20-167">See Also</span></span>  
 [<span data-ttu-id="f7b20-168">Возвращающие табличное значение параметры &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="f7b20-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
