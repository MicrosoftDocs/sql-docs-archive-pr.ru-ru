---
title: Параметр SORT_IN_TEMPDB для индексов | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- SORT_IN_TEMPDB option
- disk space [SQL Server], indexes
- space [SQL Server], indexes
- tempdb database [SQL Server], indexes
- indexes [SQL Server], tempdb database
- index creation [SQL Server], tempdb database
ms.assetid: 754a003f-fe51-4d10-975a-f6b8c04ebd35
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 8feccc5b1d29617193f481569e10648c6ed77242
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739935"
---
# <a name="sort_in_tempdb-option-for-indexes"></a><span data-ttu-id="09e42-102">Параметр SORT_IN_TEMPDB для индексов</span><span class="sxs-lookup"><span data-stu-id="09e42-102">SORT_IN_TEMPDB Option For Indexes</span></span>
  <span data-ttu-id="09e42-103">При создании или перестроении индекса можно установить параметр SORT_IN_TEMPDB в значение ON, чтобы компонент [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] использовал базу данных **tempdb** для хранения промежуточных результатов сортировки, которые применяются для построения индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-103">When you create or rebuild an index, by setting the SORT_IN_TEMPDB option to ON you can direct the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to use **tempdb** to store the intermediate sort results that are used to build the index.</span></span> <span data-ttu-id="09e42-104">Данный параметр увеличивает место на диске, временно занимаемое при построении индекса, но с его помощью можно сократить время, необходимое для создания или перестроения индекса, когда **tempdb** находится в наборе дисков, отличном от набора, используемого для размещения пользовательской базы данных.</span><span class="sxs-lookup"><span data-stu-id="09e42-104">Although this option increases the amount of temporary disk space that is used to create an index, the option could reduce the time that is required to create or rebuild an index when **tempdb** is on a set of disks different from that of the user database.</span></span> <span data-ttu-id="09e42-105">Дополнительные сведения о параметре **tempdb**см. в разделе [Настройка параметра конфигурации сервера index create memory](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="09e42-105">For more information about **tempdb**, see [Configure the index create memory Server Configuration Option](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md).</span></span>  
  
## <a name="phases-of-index-building"></a><span data-ttu-id="09e42-106">Фазы построения индекса</span><span class="sxs-lookup"><span data-stu-id="09e42-106">Phases of Index Building</span></span>  
 <span data-ttu-id="09e42-107">Процесс построения индекса компонентой [!INCLUDE[ssDE](../../includes/ssde-md.md)] состоит из следующих фаз.</span><span class="sxs-lookup"><span data-stu-id="09e42-107">As the [!INCLUDE[ssDE](../../includes/ssde-md.md)] builds an index, it goes through the following phases:</span></span>  
  
-   <span data-ttu-id="09e42-108">Сначала компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] просматривает страницы данных базовой таблицы, чтобы получить значение ключа, и строит конечную строку индекса для каждой строки данных.</span><span class="sxs-lookup"><span data-stu-id="09e42-108">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] first scans the data pages of the base table to retrieve key values and builds an index leaf row for each data row.</span></span> <span data-ttu-id="09e42-109">Когда внутренние буферы сортировки заполняются конечными элементами индекса, эти элементы сортируются и записываются на диск как промежуточный проход сортировки.</span><span class="sxs-lookup"><span data-stu-id="09e42-109">When the internal sort buffers have been filled with leaf index entries, the entries are sorted and written to disk as an intermediate sort run.</span></span> <span data-ttu-id="09e42-110">Затем компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] возобновляет просмотр страниц данных, пока буфер сортировки не заполнится вновь.</span><span class="sxs-lookup"><span data-stu-id="09e42-110">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] then resumes the data page scan until the sort buffers are again filled.</span></span> <span data-ttu-id="09e42-111">Процедура просмотра нескольких страниц данных с последующей сортировкой и записью результатов сортировки продолжается до тех пор, пока не будут обработаны все строки базовой таблицы.</span><span class="sxs-lookup"><span data-stu-id="09e42-111">This pattern of scanning multiple data pages followed by sorting and writing a sort run continues until all the rows of the base table have been processed.</span></span>  
  
     <span data-ttu-id="09e42-112">В кластеризованном индексе конечные строки являются строками данных таблицы, поэтому промежуточная сортировка содержит все строки.</span><span class="sxs-lookup"><span data-stu-id="09e42-112">In a clustered index, the leaf rows of the index are the data rows of the table; therefore, the intermediate sort runs contain all the data rows.</span></span> <span data-ttu-id="09e42-113">В некластеризованном индексе конечные строки могут содержать неключевые столбцы, но в целом они меньше, чем кластеризованный индекс.</span><span class="sxs-lookup"><span data-stu-id="09e42-113">In a nonclustered index, the leaf rows may contain nonkey columns, but are generally smaller than a clustered index.</span></span> <span data-ttu-id="09e42-114">Если ключи индекса большие или в индекс входят несколько неключевых столбцов, то операция некластеризованной сортировки может быть большей.</span><span class="sxs-lookup"><span data-stu-id="09e42-114">If the index keys are large, or there are several nonkey columns included in the index, a nonclustered sort run can be large.</span></span> <span data-ttu-id="09e42-115">Дополнительные сведения о неключевых столбцах см. в разделе [Create Indexes with Included Columns](create-indexes-with-included-columns.md).</span><span class="sxs-lookup"><span data-stu-id="09e42-115">For more information about including nonkey columns, see [Create Indexes with Included Columns](create-indexes-with-included-columns.md).</span></span>  
  
-   <span data-ttu-id="09e42-116">Компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] объединяет отсортированные потоки конечных строк индекса в единый отсортированный поток.</span><span class="sxs-lookup"><span data-stu-id="09e42-116">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] merges the sorted runs of index leaf rows into a single, sorted stream.</span></span> <span data-ttu-id="09e42-117">Компонент объединенной сортировки компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] начинает с первой страницы каждой операции сортировки, отыскивает самый нижний ключ во всех страницах и передает эту конечную строку компоненту создания индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-117">The sort merge component of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts with the first page of each sort run, finds the lowest key in all the pages, and passes that leaf row to the index create component.</span></span> <span data-ttu-id="09e42-118">Затем обрабатывается следующий индекс снизу, потом следующий и т. д.</span><span class="sxs-lookup"><span data-stu-id="09e42-118">The next lowest key is processed, and then the next, and so on.</span></span> <span data-ttu-id="09e42-119">Когда последняя конечная строка индекса извлекается из страницы операции сортировки, процесс переходит к следующей странице этой операции сортировки.</span><span class="sxs-lookup"><span data-stu-id="09e42-119">When the last leaf index row is extracted from a sort run page, the process shifts to the next page from that sort run.</span></span> <span data-ttu-id="09e42-120">Когда все страницы в операции сортировки обработаны, кластер страниц освобождается.</span><span class="sxs-lookup"><span data-stu-id="09e42-120">When all the pages in a sort run extent have been processed, the extent is freed.</span></span> <span data-ttu-id="09e42-121">Когда каждая конечная строка индекса пересылается в компонент создания индекса, она включается в конечную страницу индекса в буфере.</span><span class="sxs-lookup"><span data-stu-id="09e42-121">As each leaf index row is passed to the index create component, it is included in a leaf index page in the buffer.</span></span> <span data-ttu-id="09e42-122">Каждая конечная страница записывается по мере заполнения.</span><span class="sxs-lookup"><span data-stu-id="09e42-122">Each leaf page is written as it is filled.</span></span> <span data-ttu-id="09e42-123">По мере записи конечных страниц компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] также строит верхние уровни индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-123">As leaf pages are written, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] also builds the upper levels of the index.</span></span> <span data-ttu-id="09e42-124">Каждая страница индекса верхнего уровня записывается по мере заполнения.</span><span class="sxs-lookup"><span data-stu-id="09e42-124">Each upper level index page is written when it is filled.</span></span>  
  
## <a name="sort_in_tempdb-option"></a><span data-ttu-id="09e42-125">SORT_IN_TEMPDB, параметр</span><span class="sxs-lookup"><span data-stu-id="09e42-125">SORT_IN_TEMPDB Option</span></span>  
 <span data-ttu-id="09e42-126">Если параметр SORT_IN_TEMPDB имеет значение OFF, устанавливаемое по умолчанию, то операции сортировки хранятся в целевой файловой группе.</span><span class="sxs-lookup"><span data-stu-id="09e42-126">When SORT_IN_TEMPDB is set to OFF, the default, the sort runs are stored in the destination filegroup.</span></span> <span data-ttu-id="09e42-127">Во время первой фазы создания индекса чередующиеся операции чтения страниц базовой таблицы и записи операций сортировки перемещают головки чтения и записи диска из одной области диска в другую.</span><span class="sxs-lookup"><span data-stu-id="09e42-127">During the first phase of creating the index, the alternating reads of the base table pages and writes of the sort runs move the disk read/write heads from one area of the disk to another.</span></span> <span data-ttu-id="09e42-128">Головки находятся в области страницы данных, когда просматриваются страницы данных.</span><span class="sxs-lookup"><span data-stu-id="09e42-128">The heads are in the data page area as the data pages are scanned.</span></span> <span data-ttu-id="09e42-129">Они перемещаются в область свободного пространства, когда буферы сортировки заполняются и текущая операция сортировки записывается на диск, а затем перемещаются назад в область страницы данных при возобновлении просмотра табличной страницы.</span><span class="sxs-lookup"><span data-stu-id="09e42-129">They move to an area of free space when the sort buffers fill and the current sort run has to be written to disk, and then move back to the data page area as the table page scan is resumed.</span></span> <span data-ttu-id="09e42-130">Скорость головки на чтение-запись больше во второй фазе.</span><span class="sxs-lookup"><span data-stu-id="09e42-130">The read/write head movement is greater in the second phase.</span></span> <span data-ttu-id="09e42-131">На этом этапе процесса сортировки, как правило, чередуются операции чтения из каждой области сортировки.</span><span class="sxs-lookup"><span data-stu-id="09e42-131">At that time the sort process is typically alternating reads from each sort run area.</span></span> <span data-ttu-id="09e42-132">Как операции сортировки, так и новые страницы индекса строятся в целевой файловой группе.</span><span class="sxs-lookup"><span data-stu-id="09e42-132">Both the sort runs and the new index pages are built in the destination filegroup.</span></span> <span data-ttu-id="09e42-133">Это значит, что компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] одновременно распределяет операции чтения по операциям сортировки, при этом приходится периодически переходить к экстентам индекса для записи новых страниц индекса по мере их заполнения.</span><span class="sxs-lookup"><span data-stu-id="09e42-133">This means that at the same time the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is spreading reads across the sort runs, it has to periodically jump to the index extents to write new index pages as they are filled.</span></span>  
  
 <span data-ttu-id="09e42-134">Если параметр SORT_IN_TEMPDB имеет значение ON и база данных **tempdb** размещена на ином наборе дисков, нежели целевая файловая группа, то чтение страниц данных в первой фазе выполняется не с того диска, на который производится запись в рабочую область сортировки **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="09e42-134">If the SORT_IN_TEMPDB option is set to ON and **tempdb** is on a separate set of disks from the destination filegroup, during the first phase, the reads of the data pages occur on a different disk from the writes to the sort work area in **tempdb**.</span></span> <span data-ttu-id="09e42-135">Это значит, что считывание ключей данных с диска проводится в более последовательной манере, и операции записи на диск **tempdb** также в основном последовательные, как и операции записи при построении окончательного индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-135">This means the disk reads of the data keys generally continue more serially across the disk, and the writes to the **tempdb** disk also are generally serial, as do the writes to build the final index.</span></span> <span data-ttu-id="09e42-136">Даже если другие пользователи используют базу данных и обращаются по раздельным дисковым адресам, общая последовательность операций чтения и записи будет более эффективной, если задан параметр SORT_IN_TEMPDB.</span><span class="sxs-lookup"><span data-stu-id="09e42-136">Even if other users are using the database and accessing separate disk addresses, the overall pattern of reads and writes are more efficient when SORT_IN_TEMPDB is specified than when it is not.</span></span>  
  
 <span data-ttu-id="09e42-137">Благодаря параметру SORT_IN_TEMPDB может быть повышена непрерывность экстентов индекса, особенно если параллельно не обрабатывается операция CREATE INDEX.</span><span class="sxs-lookup"><span data-stu-id="09e42-137">The SORT_IN_TEMPDB option may improve the contiguity of index extents, especially if the CREATE INDEX operation is not being processed in parallel.</span></span> <span data-ttu-id="09e42-138">Экстенты рабочей области сортировки освобождаются довольно беспорядочно относительно их местоположения в базе данных.</span><span class="sxs-lookup"><span data-stu-id="09e42-138">The sort work area extents are freed on a somewhat random basis with regard to their location in the database.</span></span> <span data-ttu-id="09e42-139">Если рабочие области сортировки содержатся в целевой файловой группе, то по мере освобождения экстентов сортировки они могут быть задействованы по запросу для хранения структуры индекса в процессе ее построения.</span><span class="sxs-lookup"><span data-stu-id="09e42-139">If the sort work areas are contained in the destination filegroup, as the sort work extents are freed, they can be acquired by the requests for extents to hold the index structure as it is built.</span></span> <span data-ttu-id="09e42-140">Это может привести к некоторому разупорядочению местонахождений экстентов индексов.</span><span class="sxs-lookup"><span data-stu-id="09e42-140">This can randomize the locations of the index extents to a degree.</span></span> <span data-ttu-id="09e42-141">Если экстенты сортировки хранятся в **tempdb**раздельно, то последовательность их освобождения не влияет на расположение экстентов индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-141">If the sort extents are held separately in **tempdb**, the sequence in which they are freed has no effect on the location of the index extents.</span></span> <span data-ttu-id="09e42-142">Кроме того, если промежуточные операции сортировки хранятся в **tempdb** вместо целевой файловой группы, то в целевой файловой группе имеется больше доступного пространства.</span><span class="sxs-lookup"><span data-stu-id="09e42-142">Also, when the intermediate sort runs are stored in **tempdb** instead of the destination filegroup, there is more space available in the destination filegroup.</span></span> <span data-ttu-id="09e42-143">В результате увеличивается вероятность того, что экстенты индекса будут последовательными.</span><span class="sxs-lookup"><span data-stu-id="09e42-143">This increases the chances that index extents will be contiguous.</span></span>  
  
 <span data-ttu-id="09e42-144">Параметр SORT_IN_TEMPDB влияет только на текущую инструкцию.</span><span class="sxs-lookup"><span data-stu-id="09e42-144">The SORT_IN_TEMPDB option affects only the current statement.</span></span> <span data-ttu-id="09e42-145">В метаданных не отмечается, был ли индекс сортирован в **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="09e42-145">No metadata records that the index was or was not sorted in **tempdb**.</span></span> <span data-ttu-id="09e42-146">Например, если создается некластеризованный индекс с использованием параметра SORT_IN_TEMPDB, а позднее создается кластеризованный индекс без указания этого параметра, то компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] не использует параметр при повторном создании некластеризованного индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-146">For example, if you create a nonclustered index using the SORT_IN_TEMPDB option, and at a later time create a clustered index without specifying the option, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] does not use the option when it re-creates the nonclustered index.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="09e42-147">Если выполнение сортировки не требуется или если сортировка может быть выполнена в памяти, параметр SORT_IN_TEMPDB пропускается.</span><span class="sxs-lookup"><span data-stu-id="09e42-147">If a sort operation is not required or if the sort can be performed in memory, the SORT_IN_TEMPDB option is ignored.</span></span>  
  
## <a name="disk-space-requirements"></a><span data-ttu-id="09e42-148">Требования к месту на диске</span><span class="sxs-lookup"><span data-stu-id="09e42-148">Disk Space Requirements</span></span>  
 <span data-ttu-id="09e42-149">При установке параметра SORT_IN_TEMPDB в значение ON требуется достаточно свободного места на диске в базе данных **tempdb** , чтобы хранить запуски промежуточной сортировки, и достаточно места на диске в целевой файловой группе, чтобы хранить новый индекс.</span><span class="sxs-lookup"><span data-stu-id="09e42-149">When you set the SORT_IN_TEMPDB option to ON, you must have sufficient free disk space available in **tempdb** to hold the intermediate sort runs, and enough free disk space in the destination filegroup to hold the new index.</span></span> <span data-ttu-id="09e42-150">Выполнить инструкцию CREATE INDEX не удается, если свободное пространство недостаточно и по какой-то причине база данных не может автоматически задействовать дополнительное пространство, например нет места на диске или режим автоматического расширения отключен.</span><span class="sxs-lookup"><span data-stu-id="09e42-150">The CREATE INDEX statement fails if there is insufficient free space and there is some reason the databases cannot autogrow to acquire more space, such as no space on the disk or autogrow is set to off.</span></span>  
  
 <span data-ttu-id="09e42-151">Если параметр SORT_IN_TEMPDB имеет значение OFF, то размер свободного места на диске для целевой файловой группы должен быть примерно равным размеру окончательного индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-151">If SORT_IN_TEMPDB is set to OFF, the available free disk space in the destination filegroup must be roughly the size of the final index.</span></span> <span data-ttu-id="09e42-152">Во время первой фазы строятся операции сортировки, которым требуется примерно такое же пространство, как и окончательному индексу.</span><span class="sxs-lookup"><span data-stu-id="09e42-152">During the first phase, the sort runs are built and require about the same amount of space as the final index.</span></span> <span data-ttu-id="09e42-153">Во время второй фазы каждый экстент сортировки освобождается после обработки.</span><span class="sxs-lookup"><span data-stu-id="09e42-153">During the second phase, each sort run extent is freed after it has been processed.</span></span> <span data-ttu-id="09e42-154">Это значит, что экстенты сортировки освобождаются примерно с такой же частотой, с которой экстенты задействуются для хранения страниц окончательного индекса; поэтому общие требования к пространству незначительно превышают размера окончательного индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-154">This means that sort run extents are freed at about the same rate at which extents are acquired to hold the final index pages; therefore, the overall space requirements do not greatly exceed the size of the final index.</span></span> <span data-ttu-id="09e42-155">Побочным эффектом того, что размер свободного пространства очень близок к размеру окончательного индекса, является то, что компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] , как правило, очень быстро повторно использует освобождаемые экстенты сортировки.</span><span class="sxs-lookup"><span data-stu-id="09e42-155">One side effect of this is that if the amount of free space is very close to the size of the final index, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] will generally reuse the sort run extents very quickly after they are freed.</span></span> <span data-ttu-id="09e42-156">Поскольку кластеры страниц сортировки освобождаются в произвольной манере, в результате увеличивается прерывистость экстентов индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-156">Because the sort run extents are freed in a somewhat random manner, this reduces the continuity of the index extents in this scenario.</span></span> <span data-ttu-id="09e42-157">Если значение параметра SORT_IN_TEMPDB равно OFF, то непрерывность экстентов индекса повышается при наличии свободного пространства для целевой файловой группы, которое можно выделить для экстентов индекса из непрерывного пула, а не из вновь освобожденных экстентов сортировки.</span><span class="sxs-lookup"><span data-stu-id="09e42-157">If SORT_IN_TEMPDB is set to OFF, the continuity of the index extents is improved if there is sufficient free space available in the destination filegroup that the index extents can be allocated from a contiguous pool instead of from the freshly deallocated sort run extents.</span></span>  
  
 <span data-ttu-id="09e42-158">При создании некластеризованного индекса необходимо иметь доступное свободное пространство:</span><span class="sxs-lookup"><span data-stu-id="09e42-158">When you create a nonclustered index, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="09e42-159">Если параметр SORT_IN_TEMPDB имеет значение ON, то в **tempdb** необходимо иметь свободное пространство, достаточное для хранения результатов операций сортировки, и свободное пространство в целевой файловой группе, достаточное для хранения структуры окончательного индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-159">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs, and sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="09e42-160">Результаты операций сортировки содержат конечные строки индекса;</span><span class="sxs-lookup"><span data-stu-id="09e42-160">The sort runs contain the leaf rows of the index.</span></span>  
  
-   <span data-ttu-id="09e42-161">если параметр SORT_IN_TEMPDB имеет значение OFF, то свободное пространство целевой файловой группы должно быть достаточным для сохранения структуры окончательного индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-161">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final index structure.</span></span> <span data-ttu-id="09e42-162">При наличии большего объема свободного пространства может быть повышена степень непрерывности кластера страниц индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-162">The continuity of the index extends may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="09e42-163">При создании кластеризованного индекса таблицы, которая не имеет некластеризованных индексов, необходимо иметь свободное пространство:</span><span class="sxs-lookup"><span data-stu-id="09e42-163">When you create a clustered index on a table that does not have nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="09e42-164">Если параметр SORT_IN_TEMPDB имеет значение ON, то в **tempdb** должно быть достаточно свободного пространства для хранения результатов операций сортировки.</span><span class="sxs-lookup"><span data-stu-id="09e42-164">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs.</span></span> <span data-ttu-id="09e42-165">К ним относятся строки данных таблицы.</span><span class="sxs-lookup"><span data-stu-id="09e42-165">These include the data rows of the table.</span></span> <span data-ttu-id="09e42-166">Необходимо свободное место на диске в целевой файловой группе, для хранения структуры окончательного индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-166">There must be sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="09e42-167">К ней относятся строки данных таблицы и сбалансированное дерево индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-167">This includes the data rows of the table and the index B-tree.</span></span> <span data-ttu-id="09e42-168">Иногда приходится корректировать оценку с учетом таких факторов, как большой размер ключа или коэффициент заполнения с низким значением;</span><span class="sxs-lookup"><span data-stu-id="09e42-168">You may have to adjust the estimate for factors such as having a large key size or a fill factor with a low value.</span></span>  
  
-   <span data-ttu-id="09e42-169">если параметр SORT_IN_TEMPDB имеет значение OFF, с целью сохранения окончательной таблицы должно быть свободное пространство для целевой файловой группы.</span><span class="sxs-lookup"><span data-stu-id="09e42-169">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="09e42-170">Это включает структуру индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-170">This includes the index structure.</span></span> <span data-ttu-id="09e42-171">При наличии большего объема свободного пространства может быть повышена степень непрерывности экстента таблицы и индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-171">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="09e42-172">При создании кластеризованного индекса таблицы, которая имеет некластеризованные индексы, необходимо иметь свободное пространство:</span><span class="sxs-lookup"><span data-stu-id="09e42-172">When you create a clustered index on a table that has nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="09e42-173">Если параметр SORT_IN_TEMPDB имеет значение ON, то свободное пространство **tempdb** должно быть достаточным для хранения коллекции операций сортировки для самого большого, обычно кластеризованного, индекса, а свободное пространство в целевой файловой группе должно быть достаточным для хранения окончательных структур всех индексов.</span><span class="sxs-lookup"><span data-stu-id="09e42-173">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the collection of sort runs for the largest index, typically the clustered index, and sufficient free space in the destination filegroup to store the final structures of all the indexes.</span></span> <span data-ttu-id="09e42-174">Это включает кластеризованный индекс, который содержит строки данных таблицы;</span><span class="sxs-lookup"><span data-stu-id="09e42-174">This includes the clustered index that contains the data rows of the table.</span></span>  
  
-   <span data-ttu-id="09e42-175">если параметр SORT_IN_TEMPDB имеет значение OFF, с целью сохранения окончательной таблицы должно быть свободное пространство для целевой файловой группы.</span><span class="sxs-lookup"><span data-stu-id="09e42-175">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="09e42-176">Это включает структуры всех индексов.</span><span class="sxs-lookup"><span data-stu-id="09e42-176">This includes the structures of all the indexes.</span></span> <span data-ttu-id="09e42-177">При наличии большего объема свободного пространства может быть повышена степень непрерывности экстента таблицы и индекса.</span><span class="sxs-lookup"><span data-stu-id="09e42-177">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="09e42-178">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="09e42-178">Related Tasks</span></span>  
 [<span data-ttu-id="09e42-179">CREATE INDEX &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="09e42-179">CREATE INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-index-transact-sql)  
  
 [<span data-ttu-id="09e42-180">Реорганизация и перестроение индексов</span><span class="sxs-lookup"><span data-stu-id="09e42-180">Reorganize and Rebuild Indexes</span></span>](indexes.md)  
  
## <a name="related-content"></a><span data-ttu-id="09e42-181">См. также</span><span class="sxs-lookup"><span data-stu-id="09e42-181">Related Content</span></span>  
 [<span data-ttu-id="09e42-182">ALTER INDEX (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="09e42-182">ALTER INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-index-transact-sql)  
  
 [<span data-ttu-id="09e42-183">Настройка параметра конфигурации сервера index create memory</span><span class="sxs-lookup"><span data-stu-id="09e42-183">Configure the index create memory Server Configuration Option</span></span>](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md)  
  
 [<span data-ttu-id="09e42-184">Disk Space Requirements for Index DDL Operations</span><span class="sxs-lookup"><span data-stu-id="09e42-184">Disk Space Requirements for Index DDL Operations</span></span>](disk-space-requirements-for-index-ddl-operations.md)  
  
  
