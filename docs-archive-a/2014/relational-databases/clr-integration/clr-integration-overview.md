---
title: Общие сведения об интеграции со средой CLR | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- common language runtime [SQL Server], about CLR integration
- extended stored procedures [SQL Server], vs. managed code
- objects [CLR integration]
- Transact-SQL vs. managed code
- managed code [SQL Server], vs. Transact-SQL
- managed code [SQL Server], vs. extended stored procedures
- execution at client vs. execution at server [CLR integration]
ms.assetid: 5aa176da-3652-4afa-a742-4c40c77ce5c3
author: rothja
ms.author: jroth
ms.openlocfilehash: ab7bb50109fa6b0a313da24f0e6164350a6160e3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87735318"
---
# <a name="overview-of-clr-integration"></a><span data-ttu-id="852f6-102">Общие сведения об интеграции со средой CLR</span><span class="sxs-lookup"><span data-stu-id="852f6-102">Overview of CLR Integration</span></span>
  <span data-ttu-id="852f6-103">Среда CLR является сердцем платформы Microsoft .NET Framework и предоставляет среду выполнения для всего кода .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="852f6-103">The common language runtime (CLR) is the heart of the Microsoft .NET Framework and provides the execution environment for all .NET Framework code.</span></span> <span data-ttu-id="852f6-104">Код, выполняемый в среде CLR, называется управляемым кодом.</span><span class="sxs-lookup"><span data-stu-id="852f6-104">Code that runs within the CLR is referred to as managed code.</span></span> <span data-ttu-id="852f6-105">Среда CLR предоставляет различные функции и услуги, требуемые для выполнения программы, включая JIT-компиляцию, распределение и управление памятью, соблюдение безопасности типов, обработку исключений, управление потоками и безопасность.</span><span class="sxs-lookup"><span data-stu-id="852f6-105">The CLR provides various functions and services required for program execution, including just-in-time (JIT) compilation, allocating and managing memory, enforcing type safety, exception handling, thread management, and security.</span></span>  <span data-ttu-id="852f6-106">Дополнительные сведения см. в пакете .NET Framework SDK.</span><span class="sxs-lookup"><span data-stu-id="852f6-106">See the .NET Framework SDK for more information.</span></span>  
  
 <span data-ttu-id="852f6-107">Если среда CLR размещается в Microsoft SQL Server (что принято называть интеграцией со средой CLR), то появляется возможность разрабатывать в управляемом коде хранимые процедуры, триггеры, определяемые пользователем функции, определяемые пользователем типы и определяемые пользователем статистические функции.</span><span class="sxs-lookup"><span data-stu-id="852f6-107">With the CLR hosted in Microsoft SQL Server (called CLR integration), you can author stored procedures, triggers, user-defined functions, user-defined types, and user-defined aggregates in managed code.</span></span> <span data-ttu-id="852f6-108">Из-за того, что управляемый код перед выполнением производит компиляцию в машинный код, можно достичь значительного увеличения производительности в некоторых сценариях.</span><span class="sxs-lookup"><span data-stu-id="852f6-108">Because managed code compiles to native code prior to execution, you can achieve significant performance increases in some scenarios.</span></span>  
  
 <span data-ttu-id="852f6-109">В управляемом коде используется управление доступом для кода (CAS) для предотвращения выполнения сборками определенных операций.</span><span class="sxs-lookup"><span data-stu-id="852f6-109">Managed code uses Code Access Security (CAS) to prevent assemblies from performing certain operations.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="852f6-110">использует CAS для обеспечения безопасности управляемого кода и для предотвращения нарушений безопасности операционной системы или сервера баз данных.</span><span class="sxs-lookup"><span data-stu-id="852f6-110">uses CAS to help secure the managed code and prevent compromise of the operating system or database server.</span></span>  
  
## <a name="advantages-of-clr-integration"></a><span data-ttu-id="852f6-111">Преимущества интеграции со средой CLR</span><span class="sxs-lookup"><span data-stu-id="852f6-111">Advantages of CLR Integration</span></span>  
 <span data-ttu-id="852f6-112">Язык [!INCLUDE[tsql](../../../includes/tsql-md.md)] специально разработан для обеспечения прямого доступа к данным и управления данными в базе данных.</span><span class="sxs-lookup"><span data-stu-id="852f6-112">[!INCLUDE[tsql](../../../includes/tsql-md.md)] is specifically designed for direct data access and manipulation in the database.</span></span> <span data-ttu-id="852f6-113">Поскольку [!INCLUDE[tsql](../../../includes/tsql-md.md)] предназначен в первую очередь для обеспечения доступа к данным и управления ими, он не является полноценным языком программирования.</span><span class="sxs-lookup"><span data-stu-id="852f6-113">While [!INCLUDE[tsql](../../../includes/tsql-md.md)] excels at data access and management, it is not a full-fledged programming language.</span></span> <span data-ttu-id="852f6-114">Например, [!INCLUDE[tsql](../../../includes/tsql-md.md)] не поддерживает массивы, коллекции, циклы for-each, сдвиг битов и классы.</span><span class="sxs-lookup"><span data-stu-id="852f6-114">For example, [!INCLUDE[tsql](../../../includes/tsql-md.md)] does not support arrays, collections, for-each loops, bit shifting, or classes.</span></span> <span data-ttu-id="852f6-115">Безусловно, некоторые из этих конструкций можно моделировать в [!INCLUDE[tsql](../../../includes/tsql-md.md)], но в управляемом коде обеспечивается их встроенная поддержка.</span><span class="sxs-lookup"><span data-stu-id="852f6-115">While some of these constructs can be simulated in [!INCLUDE[tsql](../../../includes/tsql-md.md)], managed code has integrated support for these constructs.</span></span> <span data-ttu-id="852f6-116">В зависимости от сценария эти средства могут стать убедительной причиной для внедрения в управляемый код определенных функциональных возможностей поддержки базы данных.</span><span class="sxs-lookup"><span data-stu-id="852f6-116">Depending on the scenario, these features can provide a compelling reason to implement certain database functionality in managed code.</span></span>  
  
 <span data-ttu-id="852f6-117">Microsoft Visual Basic .NET и Microsoft Visual C# предлагают объектно-ориентированные возможности, например инкапсуляцию, наследование и полиморфизм.</span><span class="sxs-lookup"><span data-stu-id="852f6-117">Microsoft Visual Basic .NET and Microsoft Visual C# offer object-oriented capabilities such as encapsulation, inheritance, and polymorphism.</span></span> <span data-ttu-id="852f6-118">Связанный код теперь можно легко организовать в классы и пространства имен.</span><span class="sxs-lookup"><span data-stu-id="852f6-118">Related code can now be easily organized into classes and namespaces.</span></span> <span data-ttu-id="852f6-119">При работе с большими объемами серверного кода это позволяет упростить организацию и сохранение кода.</span><span class="sxs-lookup"><span data-stu-id="852f6-119">When you are working with large amounts of server code, this allows you to more easily organize and maintain your code.</span></span>  
  
 <span data-ttu-id="852f6-120">Управляемый код подходит для реализации вычислений и сложной логики выполнения больше, чем [!INCLUDE[tsql](../../../includes/tsql-md.md)], и обеспечивает расширенную поддержку многих сложных задач, включая обработку строк и регулярных выражений.</span><span class="sxs-lookup"><span data-stu-id="852f6-120">Managed code is better suited than [!INCLUDE[tsql](../../../includes/tsql-md.md)] for calculations and complicated execution logic, and features extensive support for many complex tasks, including string handling and regular expressions.</span></span> <span data-ttu-id="852f6-121">С помощью функциональных возможностей, содержащихся в библиотеке .NET Framework, обеспечивается доступ к тысячам предварительно построенных классов и подпрограмм.</span><span class="sxs-lookup"><span data-stu-id="852f6-121">With the functionality found in the .NET Framework Library, you have access to thousands of pre-built classes and routines.</span></span> <span data-ttu-id="852f6-122">К ним можно легко получить доступ из любой хранимой процедуры, триггера или определяемой пользователем функции.</span><span class="sxs-lookup"><span data-stu-id="852f6-122">These can be easily accessed from any stored procedure, trigger or user defined function.</span></span> <span data-ttu-id="852f6-123">Базовая библиотека классов (BCL) включает классы, обеспечивающие функциональные возможности управления строками, выполнения сложных математических операций, доступа к файлам, шифрования и т. д.</span><span class="sxs-lookup"><span data-stu-id="852f6-123">The Base Class Library (BCL) includes classes that provide functionality for string manipulation, advanced math operations, file access, cryptography, and more.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="852f6-124">Хотя многие из этих классов могут быть использованы из кода CLR в SQL Server, те из них, которые не подходят для использования на сервере (например, классы для работы с окнами), недоступны.</span><span class="sxs-lookup"><span data-stu-id="852f6-124">While many of these classes are available for use from within CLR code in SQL Server, those that are not appropriate for server-side use (for example, windowing classes), are not available.</span></span> <span data-ttu-id="852f6-125">Дополнительные сведения см. в разделе [supported .NET Framework librarys](database-objects/supported-net-framework-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="852f6-125">For more information, see [Supported .NET Framework Libraries](database-objects/supported-net-framework-libraries.md).</span></span>  
  
 <span data-ttu-id="852f6-126">Одним из преимуществ управляемого кода является безопасность типов, или гарантия того, что код обращается к типам только точно определенным, разрешенным способом.</span><span class="sxs-lookup"><span data-stu-id="852f6-126">One of the benefits of managed code is type safety, or the assurance that code accesses types only in well-defined, permissible ways.</span></span> <span data-ttu-id="852f6-127">Перед выполнением управляемого кода среда CLR проверяет код на безопасность.</span><span class="sxs-lookup"><span data-stu-id="852f6-127">Before managed code is executed, the CLR verifies that the code is safe.</span></span> <span data-ttu-id="852f6-128">Например, код проверяется для обеспечения того, что из памяти не будут считываться данные, если они не были предварительно записаны в нее.</span><span class="sxs-lookup"><span data-stu-id="852f6-128">For example, the code is checked to ensure that no memory is read that has not previously been written.</span></span> <span data-ttu-id="852f6-129">Среда CLR также гарантирует, что код не использует неуправляемую память.</span><span class="sxs-lookup"><span data-stu-id="852f6-129">The CLR can also help ensure that code does not manipulate unmanaged memory.</span></span>  
  
 <span data-ttu-id="852f6-130">Интеграция со средой CLR позволяет улучшить производительность.</span><span class="sxs-lookup"><span data-stu-id="852f6-130">CLR integration offers the potential for improved performance.</span></span> <span data-ttu-id="852f6-131">Дополнительные сведения см. в разделе [производительность интеграции со средой CLR](clr-integration-architecture-performance.md).</span><span class="sxs-lookup"><span data-stu-id="852f6-131">For information, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="choosing-between-transact-sql-and-managed-code"></a><span data-ttu-id="852f6-132">Выбор между Transact-SQL и управляемым кодом</span><span class="sxs-lookup"><span data-stu-id="852f6-132">Choosing Between Transact-SQL and Managed Code</span></span>  
 <span data-ttu-id="852f6-133">При записи хранимых процедур, триггеров и определяемых пользователем функций следует принять решение, использовать традиционный язык [!INCLUDE[tsql](../../../includes/tsql-md.md)] или язык платформы .NET Framework, например Visual Basic .NET или Visual C#.</span><span class="sxs-lookup"><span data-stu-id="852f6-133">When writing stored procedures, triggers, and user-defined functions, one decision you must make is whether to use traditional [!INCLUDE[tsql](../../../includes/tsql-md.md)], or a .NET Framework language such as Visual Basic .NET or Visual C#.</span></span> <span data-ttu-id="852f6-134">Используйте [!INCLUDE[tsql](../../../includes/tsql-md.md)] в тех случаях, когда код в основном выполняет доступ к данным с минимумом или совсем без процедурной логики.</span><span class="sxs-lookup"><span data-stu-id="852f6-134">Use [!INCLUDE[tsql](../../../includes/tsql-md.md)] when the code will mostly perform data access with little or no procedural logic.</span></span> <span data-ttu-id="852f6-135">Управляемый код следует использовать для функций и процедур, интенсивно использующих ЦП, содержащих сложную логику, или при необходимости использования библиотеки BCL платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="852f6-135">Use managed code for CPU-intensive functions and procedures that feature complex logic, or when you want to make use of the BCL of the .NET Framework.</span></span>  
  
### <a name="choosing-between-execution-in-the-server-and-execution-in-the-client"></a><span data-ttu-id="852f6-136">Выбор между выполнением на сервере и выполнением на клиенте</span><span class="sxs-lookup"><span data-stu-id="852f6-136">Choosing Between Execution in the Server and Execution in the Client</span></span>  
 <span data-ttu-id="852f6-137">Другим фактором при принятии решения о выборе между [!INCLUDE[tsql](../../../includes/tsql-md.md)] или управляемым кодом является требуемое расположение кода на серверном или на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="852f6-137">Another factor in your decision about whether to use [!INCLUDE[tsql](../../../includes/tsql-md.md)] or managed code is where you would like your code to reside, the server computer or the client computer.</span></span> <span data-ttu-id="852f6-138">Код [!INCLUDE[tsql](../../../includes/tsql-md.md)], как и управляемый код, можно выполнять на сервере.</span><span class="sxs-lookup"><span data-stu-id="852f6-138">Both [!INCLUDE[tsql](../../../includes/tsql-md.md)] and managed code can be run on the server.</span></span> <span data-ttu-id="852f6-139">Это позволяет упростить доступ к данным из кода и воспользоваться ресурсами обработки, имеющимися на сервере.</span><span class="sxs-lookup"><span data-stu-id="852f6-139">This places code and data close together, and allows you to take advantage of the processing power of the server.</span></span> <span data-ttu-id="852f6-140">С другой стороны, иногда приходится отказываться от размещения на сервере базы данных таких задач, которые интенсивно используют процессор.</span><span class="sxs-lookup"><span data-stu-id="852f6-140">On the other hand, you may wish to avoid placing processor intensive tasks on your database server.</span></span> <span data-ttu-id="852f6-141">Современные клиентские компьютеры чаще всего являются очень мощными, поэтому может возникнуть необходимость воспользоваться их ресурсами обработки, разместив на клиенте максимально возможный объем кода.</span><span class="sxs-lookup"><span data-stu-id="852f6-141">Most client computers today are very powerful, and you may wish to take advantage of this processing power by placing as much code as possible on the client.</span></span> <span data-ttu-id="852f6-142">Управляемый код может выполняться на клиентском компьютере, а [!INCLUDE[tsql](../../../includes/tsql-md.md)] — нет.</span><span class="sxs-lookup"><span data-stu-id="852f6-142">Managed code can run on a client computer, while [!INCLUDE[tsql](../../../includes/tsql-md.md)] cannot.</span></span>  
  
## <a name="choosing-between-extended-stored-procedures-and-managed-code"></a><span data-ttu-id="852f6-143">Выбор между расширенными хранимыми процедурами и управляемым кодом</span><span class="sxs-lookup"><span data-stu-id="852f6-143">Choosing Between Extended Stored Procedures and Managed Code</span></span>  
 <span data-ttu-id="852f6-144">Расширенные хранимые процедуры позволяют реализовать возможности, недоступные в хранимых процедурах [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="852f6-144">Extended stored procedures can be built to perform functionality not possible with [!INCLUDE[tsql](../../../includes/tsql-md.md)] stored procedures.</span></span> <span data-ttu-id="852f6-145">Однако расширенные хранимые процедуры могут нарушить целостность процесса [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], а управляемый код, проверенный на строгую типизацию, — нет.</span><span class="sxs-lookup"><span data-stu-id="852f6-145">Extended stored procedures can, however, compromise the integrity of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] process, while managed code that is verified to be type-safe cannot.</span></span> <span data-ttu-id="852f6-146">Далее, управление памятью, планирование потоков и волокон, а также службы Synchronization Services более тесно интегрированы между управляемым кодом среды CLR и [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="852f6-146">Further, memory management, scheduling of threads and fibers, and synchronization services are more deeply integrated between the managed code of the CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="852f6-147">Интеграция со средой CLR обеспечивает более защищенный по сравнению с расширенными хранимыми процедурами способ создания хранимых процедур при необходимости выполнения задач, недоступных для [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="852f6-147">With CLR integration, you have a more secure way than extended stored procedures to write the stored procedures you need to perform tasks not possible in [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="852f6-148">Дополнительные сведения об интеграции со средой CLR и расширенных хранимых процедурах см. в статье [производительность интеграции со средой CLR](clr-integration-architecture-performance.md).</span><span class="sxs-lookup"><span data-stu-id="852f6-148">For more information about CLR integration and extended stored procedures, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="852f6-149">См. также:</span><span class="sxs-lookup"><span data-stu-id="852f6-149">See Also</span></span>  
 <span data-ttu-id="852f6-150">[Установка .NET Framework](https://technet.microsoft.com/library/ms166014\(v=SQL.105\).aspx) </span><span class="sxs-lookup"><span data-stu-id="852f6-150">[Installing the .NET Framework](https://technet.microsoft.com/library/ms166014\(v=SQL.105\).aspx) </span></span>  
 <span data-ttu-id="852f6-151">[Архитектура интеграции со средой CLR](../../database-engine/dev-guide/architecture-of-clr-integration.md) </span><span class="sxs-lookup"><span data-stu-id="852f6-151">[Architecture of CLR Integration](../../database-engine/dev-guide/architecture-of-clr-integration.md) </span></span>  
 <span data-ttu-id="852f6-152">[Доступ к данным из объектов базы данных CLR](data-access/data-access-from-clr-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="852f6-152">[Data Access from CLR Database Objects](data-access/data-access-from-clr-database-objects.md) </span></span>  
 [<span data-ttu-id="852f6-153">Приступая к работе с интеграцией со средой CLR</span><span class="sxs-lookup"><span data-stu-id="852f6-153">Getting Started with CLR Integration</span></span>](database-objects/getting-started-with-clr-integration.md)  
  
  
