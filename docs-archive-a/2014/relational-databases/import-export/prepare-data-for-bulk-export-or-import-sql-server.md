---
title: Подготовка данных к массовому экспорту или импорту (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: data-movement
ms.topic: conceptual
helpviewer_keywords:
- bulk importing [SQL Server], planning
- bulk importing [SQL Server], from a CSV file
- data formats [SQL Server], planning operations
- CSV files [SQL Server]
- quoted fields in CSV files [SQL Server]
ms.assetid: 783fd581-2e5f-496b-b79c-d4de1e09ea30
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 4f2780a4eadfc27ed2db15881d676965fca81e35
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738435"
---
# <a name="prepare-data-for-bulk-export-or-import-sql-server"></a><span data-ttu-id="43280-102">Подготовка данных к массовому экспорту или импорту (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="43280-102">Prepare Data for Bulk Export or Import (SQL Server)</span></span>
  <span data-ttu-id="43280-103">В этом разделе рассматриваются факторы, которые следует учитывать при планировании операций массового экспорта, и требования для операций массового импорта.</span><span class="sxs-lookup"><span data-stu-id="43280-103">This section discusses the considerations involved in planning for bulk-export operations and the requirements for bulk-import operations.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="43280-104">Если вы не уверены в том, как следует форматировать файл данных для массового импорта, то для экспорта данных из таблицы в файл данных можно использовать программу **bcp** .</span><span class="sxs-lookup"><span data-stu-id="43280-104">If you are uncertain about how to format a data file for bulk importing, you can use the **bcp** utility to export data from the table into a data file.</span></span> <span data-ttu-id="43280-105">Форматирование каждого поля данных в этом файле соответствует необходимому формату для массового импорта данных в соответствующий столбец таблицы.</span><span class="sxs-lookup"><span data-stu-id="43280-105">The formatting of each data field in this file shows the formatting required to bulk import data into the corresponding table column.</span></span> <span data-ttu-id="43280-106">Используйте то же самое форматирование для полей своего файла данных.</span><span class="sxs-lookup"><span data-stu-id="43280-106">Use the same data formatting for fields of your data file.</span></span>  
  
## <a name="data-file-format-considerations-for-bulk-export"></a><span data-ttu-id="43280-107">Замечания по формату файлов данных для массового экспорта</span><span class="sxs-lookup"><span data-stu-id="43280-107">Data-File Format Considerations for Bulk Export</span></span>  
 <span data-ttu-id="43280-108">Прежде чем выполнить операцию массового экспорта с помощью команды **bcp** , примите во внимание следующее.</span><span class="sxs-lookup"><span data-stu-id="43280-108">Before you perform a bulk-export operation by using the **bcp** command, consider the following:</span></span>  
  
-   <span data-ttu-id="43280-109">При экспорте данных в файл команда **bcp** автоматически создает файл данных, используя указанное имя файла.</span><span class="sxs-lookup"><span data-stu-id="43280-109">When data is exported to a file, the **bcp** command creates the data file automatically by using the specified file name.</span></span> <span data-ttu-id="43280-110">Если это имя файла уже используется, то в процессе массового копирования в файл данных существующее содержимое файла перезаписывается.</span><span class="sxs-lookup"><span data-stu-id="43280-110">If that file name is already in use, the data that is being bulk copied to the data file overwrites the existing contents of the file.</span></span>  
  
-   <span data-ttu-id="43280-111">Для массового экспорта из таблицы или представления в файл данных необходимо разрешение SELECT в таблице или представлении, над которым производится операция массового копирования.</span><span class="sxs-lookup"><span data-stu-id="43280-111">Bulk export from a table or view to a data file requires SELECT permission on the table or view that is being bulk copied.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="43280-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может использовать параллельный просмотр для получения данных.</span><span class="sxs-lookup"><span data-stu-id="43280-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can use parallel scans to retrieve data.</span></span> <span data-ttu-id="43280-113">Поэтому обычно не гарантируется определенный порядок размещения в файле данных строк таблицы, над которыми была выполнена операция массового экспорта из экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="43280-113">Therefore, the table rows that are bulk exported in from an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are not ordinarily guaranteed to be in any specific order in the data file.</span></span> <span data-ttu-id="43280-114">Чтобы строки таблицы для массового экспорта размещались в файле данных в определенном порядке, примените параметр **queryout** для массового экспорта из запроса и укажите предложение ORDER BY.</span><span class="sxs-lookup"><span data-stu-id="43280-114">To make sure that bulk-exported table rows appear in a specific order in the data file, use the **queryout** option to bulk export from a query, and specify an ORDER BY clause.</span></span>  
  
## <a name="data-file-format-requirements-for-bulk-import"></a><span data-ttu-id="43280-115">Требования к формату файлов данных для массового импорта</span><span class="sxs-lookup"><span data-stu-id="43280-115">Data-File Format Requirements for Bulk Import</span></span>  
 <span data-ttu-id="43280-116">Файл, из которого необходимо импортировать данные, должен отвечать следующим основным требованиям.</span><span class="sxs-lookup"><span data-stu-id="43280-116">To import data from a data file, the file must meet the following basic requirements:</span></span>  
  
-   <span data-ttu-id="43280-117">Данные должны быть представлены в формате строк и столбцов.</span><span class="sxs-lookup"><span data-stu-id="43280-117">The data must be in row and column format.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="43280-118">Структура файла данных необязательно должна быть идентична структуре таблицы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , так как столбцы можно пропускать и переупорядочивать в процессе массового импорта.</span><span class="sxs-lookup"><span data-stu-id="43280-118">The structure of the data file does not need to be identical to the structure of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table because columns can be skipped or reordered during the bulk-import process.</span></span>  
  
-   <span data-ttu-id="43280-119">Данные в файле данных должны быть в поддерживаемом формате, например символьном или исходном.</span><span class="sxs-lookup"><span data-stu-id="43280-119">The data in the data file must be in a supported format such as character or native format.</span></span>  
  
-   <span data-ttu-id="43280-120">Данные могут быть в символьном или исходном двоичном формате, включая Юникод.</span><span class="sxs-lookup"><span data-stu-id="43280-120">The data can be in character or native binary format including Unicode.</span></span>  
  
-   <span data-ttu-id="43280-121">Для импорта данных с использованием команды **bcp**, инструкции BULK INSERT или инструкции INSERT… SELECT \* FROM OPENROWSET(BULK...), целевая таблица должна уже существовать.</span><span class="sxs-lookup"><span data-stu-id="43280-121">To import data by using a **bcp** command, BULK INSERT statement, or INSERT ... SELECT \* FROM OPENROWSET(BULK...) statement, the destination table must already exist.</span></span>  
  
-   <span data-ttu-id="43280-122">Каждое поле в файле данных должно быть совместимо с соответствующим столбцом в целевой таблице.</span><span class="sxs-lookup"><span data-stu-id="43280-122">Each field in the data file must be compatible with the corresponding column in the target table.</span></span> <span data-ttu-id="43280-123">Например, поле типа `int` нельзя загрузить в столбец типа `datetime`.</span><span class="sxs-lookup"><span data-stu-id="43280-123">For example, an `int` field cannot be loaded into a `datetime` column.</span></span> <span data-ttu-id="43280-124">Дополнительные сведения см. в статьях [Форматы данных для массового экспорта или импорта (SQL Server)](data-formats-for-bulk-import-or-bulk-export-sql-server.md) и [Указание форматов данных для совместимости с помощью программы bcp (SQL Server)](specify-data-formats-for-compatibility-when-using-bcp-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="43280-124">For more information, see [Data Formats for Bulk Import or Bulk Export &#40;SQL Server&#41;](data-formats-for-bulk-import-or-bulk-export-sql-server.md) and [Specify Data Formats for Compatibility when Using bcp &#40;SQL Server&#41;](specify-data-formats-for-compatibility-when-using-bcp-sql-server.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="43280-125">Указать для импорта из файла данных не весь файл, а подмножество строк можно с помощью команды **bcp** с параметром **-F** *первая_строка* и параметром **-L** *последняя_строка*.</span><span class="sxs-lookup"><span data-stu-id="43280-125">To specify a subset of rows to import from a data file rather than the entire file, you can use a **bcp** command with the **-F** *first_row* switch and/or **-L** *last_row* switch.</span></span> <span data-ttu-id="43280-126">Дополнительные сведения см. в разделе [bcp Utility](../../tools/bcp-utility.md).</span><span class="sxs-lookup"><span data-stu-id="43280-126">For more information, see [bcp Utility](../../tools/bcp-utility.md).</span></span>  
  
-   <span data-ttu-id="43280-127">Чтобы импортировать данные из файлов данных фиксированной длины или с полями фиксированной длины, следует использовать файл форматирования.</span><span class="sxs-lookup"><span data-stu-id="43280-127">To import data from data files with fixed-length or fixed-width fields, you must use a format file.</span></span> <span data-ttu-id="43280-128">Дополнительные сведения см. в разделе [XML-файлы форматирования (SQL Server)](xml-format-files-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="43280-128">For more information, see [XML Format Files &#40;SQL Server&#41;](xml-format-files-sql-server.md).</span></span>  
  
-   <span data-ttu-id="43280-129">CSV-Файлы с разделителями-запятыми не поддерживаются в операциях массового импорта [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="43280-129">Comma-separated value (CSV) files are not supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-import operations.</span></span> <span data-ttu-id="43280-130">Однако в некоторых случаях CSV-файл можно использовать в качестве файла данных для массового импорта данных в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="43280-130">However, in some cases, a CSV file can be used as the data file for a bulk import of data into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="43280-131">Обратите внимание, что признаком конца поля CSV-файла не обязательно должна быть запятая.</span><span class="sxs-lookup"><span data-stu-id="43280-131">Note that the field terminator of a CSV file does not have to be a comma.</span></span> <span data-ttu-id="43280-132">CSV-файл, который можно использовать в качестве файла данных для массового импорта, должен соответствовать следующим условиям.</span><span class="sxs-lookup"><span data-stu-id="43280-132">To be usable as a data file for bulk import, a CSV file must comply with the following restrictions:</span></span>  
  
    -   <span data-ttu-id="43280-133">Поля данных не должны содержать признак конца поля.</span><span class="sxs-lookup"><span data-stu-id="43280-133">Data fields never contain the field terminator.</span></span>  
  
    -   <span data-ttu-id="43280-134">Или никакие, или все значения в полях данных должны заключаться в кавычки ("").</span><span class="sxs-lookup"><span data-stu-id="43280-134">Either none or all of the values in a data field are enclosed in quotation marks ("").</span></span>  
  
     <span data-ttu-id="43280-135">Чтобы выполнить массовый импорт данных из файла [!INCLUDE[msCoName](../../includes/msconame-md.md)] FoxPro, таблицы Visual FoxPro (DBF) или листа [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] (XLS), данные необходимо преобразовать в CSV-файл, который соответствует описанным ранее ограничениям.</span><span class="sxs-lookup"><span data-stu-id="43280-135">To bulk import data from a [!INCLUDE[msCoName](../../includes/msconame-md.md)] FoxPro or Visual FoxPro table (.dbf) file or a [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] worksheet (.xls) file, you would need to convert the data into a CSV file that complies to the preceding restrictions.</span></span> <span data-ttu-id="43280-136">Этот файл обычно имеет расширение CSV.</span><span class="sxs-lookup"><span data-stu-id="43280-136">The file extension will typically be .csv.</span></span> <span data-ttu-id="43280-137">Затем его можно использовать как файл данных в операции массового импорта [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="43280-137">You can then use the .csv file as a data file in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-import operation.</span></span>  
  
     <span data-ttu-id="43280-138">На 32-разрядных системах возможно импортировать данные CSV в таблицу [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] без оптимизации массового импорта с помощью параметра [OPENROWSET](/sql/t-sql/functions/openrowset-transact-sql) с поставщиком OLE DB для Jet.</span><span class="sxs-lookup"><span data-stu-id="43280-138">On 32-bit systems, it is possible to import CSV data into a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table without bulk-import optimizations by using [OPENROWSET](/sql/t-sql/functions/openrowset-transact-sql) with the OLE DB Provider for Jet.</span></span> <span data-ttu-id="43280-139">Поставщик Jet обрабатывает текстовые файлы как таблицы со схемой, определенной в файле schema.ini, который расположен в том же каталоге, что и источник данных.</span><span class="sxs-lookup"><span data-stu-id="43280-139">Jet treats text files as tables, with the schema defined by a schema.ini file that is located in the same directory as the data source.</span></span>  <span data-ttu-id="43280-140">Для CSV-данных одним из параметров в файле schema.ini будет «FORMAT=CSVDelimited».</span><span class="sxs-lookup"><span data-stu-id="43280-140">For a CSV data, one of the parameters in the schema.ini file would be "FORMAT=CSVDelimited".</span></span> <span data-ttu-id="43280-141">Чтобы использовать такое решение, нужно представлять принципы работы поставщика Jet Test IISAMm: знать синтаксис строки соединения, правила использования schema.ini, параметры реестра и т. д.</span><span class="sxs-lookup"><span data-stu-id="43280-141">To use this solution, you would need to understand how the Jet Test IISAMm operations-its connection string syntax, schema.ini usage, registry setting options, and so on).</span></span>  <span data-ttu-id="43280-142">Лучшими источниками для получения таких сведений служат справка Microsoft Access и статьи базы знаний.</span><span class="sxs-lookup"><span data-stu-id="43280-142">The best sources of this information are Microsoft Access Help and Knowledge Base (KB) articles.</span></span> <span data-ttu-id="43280-143">Дополнительные сведения см. в разделах [Инициализация драйвера текстового источника данных](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/initializing-the-text-data-source-driver), [Как использовать распределенный запрос SQL Server 7.0 со связанным сервером для защищенных баз данных Access](https://go.microsoft.com/fwlink/?LinkId=128504), [Как использовать поставщик Jet OLE DB 4.0 для подключения к базам данных ISAM](https://go.microsoft.com/fwlink/?LinkId=128505) (на английском языке) и [Как открыть текстовые файлы с разделителями с помощью драйвера Text IIsam поставщика Jet](https://go.microsoft.com/fwlink/?LinkId=128501) (на английском языке).</span><span class="sxs-lookup"><span data-stu-id="43280-143">For more information, see [Initializing the Text Data Source Driver](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/initializing-the-text-data-source-driver), [How To Use a SQL Server 7.0 Distributed Query with a Linked Server to Secured Access Databases](https://go.microsoft.com/fwlink/?LinkId=128504), [HOW TO: Use Jet OLE DB Provider 4.0 to Connect to ISAM Databases](https://go.microsoft.com/fwlink/?LinkId=128505), and [How To Open Delimited Text Files Using the Jet Provider's Text IIsam](https://go.microsoft.com/fwlink/?LinkId=128501).</span></span>  
  
 <span data-ttu-id="43280-144">Кроме того, для массового импорта данных из файла данных в таблицу необходимо следующее.</span><span class="sxs-lookup"><span data-stu-id="43280-144">In addition, the bulk import of data from a data file into a table requires the following:</span></span>  
  
-   <span data-ttu-id="43280-145">Пользователи должны иметь разрешения INSERT и SELECT в таблице.</span><span class="sxs-lookup"><span data-stu-id="43280-145">Users must have INSERT and SELECT permissions on the table.</span></span> <span data-ttu-id="43280-146">Пользователи также должны иметь разрешение ALTER TABLE в случае использования параметров, требующих операций DDL, например отмены ограничений.</span><span class="sxs-lookup"><span data-stu-id="43280-146">Users also need ALTER TABLE permission when they use options that require data definition language (DDL) operations, such as disabling constraints.</span></span>  
  
-   <span data-ttu-id="43280-147">При массовом импорте данных с использованием инструкций BULK INSERT или INSERT ... SELECT \* FROM OPENROWSET(BULK...), файл данных должен быть доступен для операций чтения из профиля безопасности процесса [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (если пользователь регистрируется с именем входа [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]) или из процедуры входа [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows, выполняемой с делегированными полномочиями безопасности.</span><span class="sxs-lookup"><span data-stu-id="43280-147">When you bulk import data by using BULK INSERT or INSERT ... SELECT \* FROM OPENROWSET(BULK...), the data file must be accessible for read operations by either the security profile of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process (if the user logs in using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provided login) or by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows login that is used under delegated security.</span></span> <span data-ttu-id="43280-148">В дополнение пользователь должен иметь разрешение ADMINISTER BULK OPERATIONS для чтения файла.</span><span class="sxs-lookup"><span data-stu-id="43280-148">Additionally, the user must have ADMINISTER BULK OPERATIONS permission to read the file.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="43280-149">Массовый импорт в секционированное представление не поддерживается, и попытки массового импорта данных в секционированное представление завершаются неудачно.</span><span class="sxs-lookup"><span data-stu-id="43280-149">Bulk importing into a partitioned view is unsupported, and attempts to bulk import data into a partitioned view fail.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="43280-150">Внешние ресурсы</span><span class="sxs-lookup"><span data-stu-id="43280-150">External Resources</span></span>  
 [<span data-ttu-id="43280-151">Импорт данных из Excel в SQL Server</span><span class="sxs-lookup"><span data-stu-id="43280-151">How to import data from Excel to SQL Server</span></span>](https://support.microsoft.com/kb/321686)  
  
## <a name="change-history"></a><span data-ttu-id="43280-152">Журнал изменений</span><span class="sxs-lookup"><span data-stu-id="43280-152">Change History</span></span>  
  
|<span data-ttu-id="43280-153">Обновленное содержимое</span><span class="sxs-lookup"><span data-stu-id="43280-153">Updated content</span></span>|  
|---------------------|  
|<span data-ttu-id="43280-154">Добавлены сведения об использовании поставщика OLE DB для Jet при импорте данных с разделителями-запятыми.</span><span class="sxs-lookup"><span data-stu-id="43280-154">Added information about using the OLE DB Provider for Jet to import CSV data.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="43280-155">См. также:</span><span class="sxs-lookup"><span data-stu-id="43280-155">See Also</span></span>  
 <span data-ttu-id="43280-156">[bcp Utility](../../tools/bcp-utility.md) </span><span class="sxs-lookup"><span data-stu-id="43280-156">[bcp Utility](../../tools/bcp-utility.md) </span></span>  
 <span data-ttu-id="43280-157">[BULK INSERT (Transact-SQL)](/sql/t-sql/statements/bulk-insert-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="43280-157">[BULK INSERT &#40;Transact-SQL&#41;](/sql/t-sql/statements/bulk-insert-transact-sql) </span></span>  
 <span data-ttu-id="43280-158">[Типы данных (Transact-SQL)](/sql/t-sql/data-types/data-types-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="43280-158">[Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) </span></span>  
 <span data-ttu-id="43280-159">[Использование символьного формата для импорта и экспорта данных (SQL Server)](use-character-format-to-import-or-export-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="43280-159">[Use Character Format to Import or Export Data &#40;SQL Server&#41;](use-character-format-to-import-or-export-data-sql-server.md) </span></span>  
 [<span data-ttu-id="43280-160">Использование собственного формата для импорта и экспорта данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="43280-160">Use Native Format to Import or Export Data &#40;SQL Server&#41;</span></span>](use-native-format-to-import-or-export-data-sql-server.md)  
  
  
