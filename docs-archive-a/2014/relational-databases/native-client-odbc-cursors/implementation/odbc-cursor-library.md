---
title: Библиотека курсоров ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87657781"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="789de-102">Библиотека курсоров ODBC</span><span class="sxs-lookup"><span data-stu-id="789de-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="789de-103">Некоторые драйверы ODBC поддерживают только параметры курсора по умолчанию. Эти драйверы также не поддерживают позиционированные операции с курсорами, такие как **SQLSetPos**.</span><span class="sxs-lookup"><span data-stu-id="789de-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="789de-104">Библиотека курсоров ODBC — компонент доступа к данным MDAC, используемый для реализации блочных или статических курсоров на драйвере, который обычно не поддерживает их.</span><span class="sxs-lookup"><span data-stu-id="789de-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="789de-105">Библиотека курсоров также реализует позиционированные инструкции UPDATE и DELETE и **SQLSetPos** для создаваемых курсоров.</span><span class="sxs-lookup"><span data-stu-id="789de-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="789de-106">Библиотека курсоров ODBC реализована как уровень между диспетчером драйверов ODBC и драйвером ODBC.</span><span class="sxs-lookup"><span data-stu-id="789de-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="789de-107">Если библиотека курсоров ODBC загружена, диспетчер драйверов ODBC направляет все относящиеся к курсору команды в библиотеку курсоров, а не драйвер.</span><span class="sxs-lookup"><span data-stu-id="789de-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="789de-108">Библиотека курсоров реализует курсор путем выборки целого результирующего набора из базового драйвера и кэширования результирующего набора на клиенте.</span><span class="sxs-lookup"><span data-stu-id="789de-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="789de-109">При использовании библиотеки курсоров ODBC приложение ограничено функциональностью курсора для библиотеки курсоров; любая дополнительная функциональность базового драйвера недоступна для приложения.</span><span class="sxs-lookup"><span data-stu-id="789de-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="789de-110">Нет необходимости использовать библиотеку курсоров ODBC с драйвером ODBC для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], так как сам драйвер обеспечивает более широкую функциональность курсора, чем библиотека курсоров ODBC.</span><span class="sxs-lookup"><span data-stu-id="789de-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="789de-111">Единственная причина использования библиотеки курсоров ODBC с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвером ODBC для собственного клиента заключается в том, что драйвер реализует поддержку курсора через серверные курсоры, а серверные курсоры не поддерживают все инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="789de-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="789de-112">Всегда, когда необходимо иметь статический курсор с хранимыми процедурами, пакетами или инструкциями SQL, содержащими предложение COMPUTE, COMPUTE BY, FOR BROWSE или INTO, используйте библиотеку курсоров ODBC.</span><span class="sxs-lookup"><span data-stu-id="789de-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="789de-113">Однако при использовании библиотеки курсоров необходима осмотрительность, так как кэширование всего результирующего набора на клиенте может потребовать большого объема памяти и снизить производительность.</span><span class="sxs-lookup"><span data-stu-id="789de-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="789de-114">Приложение вызывает библиотеку курсоров в отдельном соединении с помощью [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) , чтобы задать атрибут подключения SQL_ATTR_ODBC_CURSORS перед подключением к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="789de-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="789de-115">SQL_ATTR_ODBC_CURSORS устанавливается в одно из трех значений:</span><span class="sxs-lookup"><span data-stu-id="789de-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="789de-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="789de-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="789de-117">Если этот параметр установлен с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвером ODBC для собственного клиента, Библиотека курсоров ODBC переопределяет [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] поддержку собственного курсора собственного клиента ODBC Driver.</span><span class="sxs-lookup"><span data-stu-id="789de-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="789de-118">Только типы курсора, поддерживаемые библиотекой курсоров, могут быть использованы для соединения; серверные курсоры не могут быть использованы.</span><span class="sxs-lookup"><span data-stu-id="789de-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="789de-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="789de-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="789de-120">Если этот параметр задан, для соединения можно использовать все функции поддержки курсоров, встроенные в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвер ODBC собственного клиента.</span><span class="sxs-lookup"><span data-stu-id="789de-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="789de-121">Библиотека курсоров ODBC не может быть использована.</span><span class="sxs-lookup"><span data-stu-id="789de-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="789de-122">Все курсоры реализованы как серверные курсоры.</span><span class="sxs-lookup"><span data-stu-id="789de-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="789de-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="789de-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="789de-124">Если этот параметр задан, то при использовании с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвером ODBC для собственного клиента результат будет таким же, как и SQL_CUR_USE_DRIVER.</span><span class="sxs-lookup"><span data-stu-id="789de-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="789de-125">Во время подключения диспетчер драйверов ODBC проверяет, поддерживает ли подключенный драйвер ODBC параметр SQL_FETCH_PRIOR [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span><span class="sxs-lookup"><span data-stu-id="789de-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="789de-126">Если драйвер не поддерживает параметр, диспетчер драйверов ODBC загружает библиотеку курсоров ODBC.</span><span class="sxs-lookup"><span data-stu-id="789de-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="789de-127">Если драйвер поддерживает параметр, диспетчер драйверов ODBC не загружает библиотеку курсоров ODBC и приложение использует собственную поддержку драйвера.</span><span class="sxs-lookup"><span data-stu-id="789de-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="789de-128">Так как [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвер ODBC для собственного клиента поддерживает SQL_FETCH_PRIOR, диспетчер драйверов ODBC не загружает библиотеку курсоров ODBC.</span><span class="sxs-lookup"><span data-stu-id="789de-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="789de-129">Библиотека курсоров ODBC позволяет приложениям использовать несколько активных инструкций для соединения, а также прокручиваемые, обновляемые курсоры.</span><span class="sxs-lookup"><span data-stu-id="789de-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="789de-130">Библиотека курсоров должна быть загружена для поддержки этой функциональности.</span><span class="sxs-lookup"><span data-stu-id="789de-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="789de-131">Используйте [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) для указания способа использования библиотеки курсоров и [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) для указания типа курсора, параллелизма и размера набора строк.</span><span class="sxs-lookup"><span data-stu-id="789de-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="789de-132">См. также:</span><span class="sxs-lookup"><span data-stu-id="789de-132">See Also</span></span>  
 [<span data-ttu-id="789de-133">Способы реализации курсоров</span><span class="sxs-lookup"><span data-stu-id="789de-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
