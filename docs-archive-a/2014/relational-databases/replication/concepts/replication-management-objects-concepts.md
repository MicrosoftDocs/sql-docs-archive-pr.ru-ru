---
title: Основные понятия объектов RMO | Документация Майкрософт
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: reference
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- replication [SQL Server], RMO
- programming interfaces [SQL Server replication]
- replication [SQL Server], how-to topics
- RMO [SQL Server]
- Replication Management Objects
- programming [SQL Server replication], RMO
ms.assetid: 37476d50-fb47-49e3-9504-3b163ac381d8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 0dc41416e0fb585db376c6b72f28f7c30cfff052
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664138"
---
# <a name="replication-management-objects-concepts"></a><span data-ttu-id="7c6ed-102">Replication Management Objects Concepts</span><span class="sxs-lookup"><span data-stu-id="7c6ed-102">Replication Management Objects Concepts</span></span>
  <span data-ttu-id="7c6ed-103">Объекты RMO представляют собой сборку управляемого кода, которая инкапсулирует функциональные средства репликации для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7c6ed-103">Replication Management Objects (RMO) is a managed code assembly that encapsulates replication functionalities for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="7c6ed-104">Объекты RMO реализованы в пространстве имен <xref:Microsoft.SqlServer.Replication>.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-104">RMO is implemented by the <xref:Microsoft.SqlServer.Replication> namespace.</span></span>  
  
 <span data-ttu-id="7c6ed-105">Следующие разделы описывают использование объектов RMO для программного управления задачами репликации.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-105">The topics in the following sections describe how you can use RMO to programmatically control replication tasks:</span></span>  
  
 [<span data-ttu-id="7c6ed-106">Настройка распространения</span><span class="sxs-lookup"><span data-stu-id="7c6ed-106">Configure Distribution</span></span>](../configure-distribution.md)  
 <span data-ttu-id="7c6ed-107">В подразделах этого раздела показано, как использовать объекты RMO для настройки публикации и распределения.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-107">Topics in this section show how to use RMO to configure publishing and distribution.</span></span>  
  
 [<span data-ttu-id="7c6ed-108">Create a Publication</span><span class="sxs-lookup"><span data-stu-id="7c6ed-108">Create a Publication</span></span>](../publish/create-a-publication.md)  
 <span data-ttu-id="7c6ed-109">В подразделах этого раздела показано, как использовать объекты RMO для создания, удаления и изменения публикаций и статей.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-109">Topics in this section show how to use RMO to create, delete, and modify publications and articles.</span></span>  
  
 [<span data-ttu-id="7c6ed-110">Подписка на публикации</span><span class="sxs-lookup"><span data-stu-id="7c6ed-110">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
 <span data-ttu-id="7c6ed-111">В подразделах этого раздела показано, как использовать объекты RMO для создания, удаления и изменения подписок.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-111">Topics in this section show how to use RMO to create, delete, and modify subscriptions.</span></span>  
  
 <span data-ttu-id="7c6ed-112">[Secure a Replication Topology](../security/view-and-modify-replication-security-settings.md) (Защита топологии репликации)</span><span class="sxs-lookup"><span data-stu-id="7c6ed-112">[Secure a Replication Topology](../security/view-and-modify-replication-security-settings.md)</span></span>  
 <span data-ttu-id="7c6ed-113">В подразделах этого раздела показано, как использовать объекты RMO для просмотра и изменения параметров безопасности.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-113">Topics in this section show how to use RMO to view and modify security settings.</span></span>  
  
 <span data-ttu-id="7c6ed-114">[Synchronize Subscriptions (Replication)](../synchronize-data.md) (Синхронизация подписок (репликация))</span><span class="sxs-lookup"><span data-stu-id="7c6ed-114">[Synchronize Subscriptions &#40;Replication&#41;](../synchronize-data.md)</span></span>  
 <span data-ttu-id="7c6ed-115">В подразделах этого раздела показано, как синхронизировать подписки.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-115">Topics in this section show how to synchronize subscriptions.</span></span>  
  
 [<span data-ttu-id="7c6ed-116">Наблюдение за репликацией</span><span class="sxs-lookup"><span data-stu-id="7c6ed-116">Monitoring Replication</span></span>](../monitoring-replication.md)  
 <span data-ttu-id="7c6ed-117">В подразделах этого раздела показано, как программным путем осуществлять наблюдение за топологией репликации.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-117">Topics in this section show how to programmatically monitor a replication topology.</span></span>  
  
## <a name="introduction-to-rmo-programming"></a><span data-ttu-id="7c6ed-118">Введение в программирование объектов RMO</span><span class="sxs-lookup"><span data-stu-id="7c6ed-118">Introduction to RMO Programming</span></span>  
 <span data-ttu-id="7c6ed-119">Объекты RMO предназначены для программирования всех аспектов репликации [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7c6ed-119">RMO is designed for programming all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="7c6ed-120">Пространством имен объекта RMO является <xref:Microsoft.SqlServer.Replication>, а для его реализации применяется библиотека Microsoft.SqlServer.Rmo.dll, представляющая собой сборку [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-120">The RMO namespace is <xref:Microsoft.SqlServer.Replication>, and it is implemented by the Microsoft.SqlServer.Rmo.dll, which is a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework assembly.</span></span> <span data-ttu-id="7c6ed-121">Сборка Microsoft.SqlServer.Replication.dll, которая также принадлежит пространству имен <xref:Microsoft.SqlServer.Replication>, реализует интерфейс управляемого кода для программирования различных агентов репликации (агента моментальных снимков, агента распространителя и агента слияния).</span><span class="sxs-lookup"><span data-stu-id="7c6ed-121">The Microsoft.SqlServer.Replication.dll assembly, which also belongs to the <xref:Microsoft.SqlServer.Replication> namespace, implements a managed code interface for programming the various replication agents (Snapshot Agent, Distribution Agent, and Merge Agent).</span></span> <span data-ttu-id="7c6ed-122">Доступ к ее классам может быть получен из объектов RMO для синхронизации подписок.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-122">Its classes can be accessed from RMO to synchronize subscriptions.</span></span> <span data-ttu-id="7c6ed-123">Классы в пространстве имен <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>, реализованном с помощью сборки Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, используются для создания пользовательской бизнес-логики для репликации слиянием.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-123">Classes in the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace, implemented by the Microsoft.SqlServer.Replication.BusinessLogicSupport.dll assembly, are used to create custom business logic for merge replication.</span></span> <span data-ttu-id="7c6ed-124">Эта сборка является независимой от объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-124">This assembly is independent from RMO.</span></span>  
  
## <a name="deploying-applications-based-on-rmo"></a><span data-ttu-id="7c6ed-125">Развертывание приложений на основе объектов RMO</span><span class="sxs-lookup"><span data-stu-id="7c6ed-125">Deploying Applications Based on RMO</span></span>  
 <span data-ttu-id="7c6ed-126">Функционирование объектов RMO зависит от компонентов репликации и компонентов обмена данными с клиентом, которые включены во все версии [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], кроме SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-126">RMO depends on the replication components and client connectivity components that are included with all versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] except SQL Server Compact.</span></span> <span data-ttu-id="7c6ed-127">Чтобы иметь возможность развернуть приложение на основе объектов RMO, необходимо установить на компьютере, предназначенном для эксплуатации приложения, версию [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], которая включает компоненты репликации и компоненты обмена данными с клиентом.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-127">To deploy an application based on RMO, you must install a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that includes replication components and client connectivity components on the computer on which the application will run.</span></span>  
  
## <a name="getting-started-with-rmo"></a><span data-ttu-id="7c6ed-128">Приступая к работе с объектами RMO</span><span class="sxs-lookup"><span data-stu-id="7c6ed-128">Getting Started with RMO</span></span>  
 <span data-ttu-id="7c6ed-129">В настоящем разделе приведено описание того, как создать простой проект объекта RMO с использованием [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-129">This section describes how to start a simple RMO project using [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span></span>  
  
#### <a name="to-create-a-new-microsoft-visual-c-project"></a><span data-ttu-id="7c6ed-130">Создание нового проекта Microsoft Visual C#</span><span class="sxs-lookup"><span data-stu-id="7c6ed-130">To create a new Microsoft Visual C# project</span></span>  
  
1.  <span data-ttu-id="7c6ed-131">Запустите среду Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-131">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="7c6ed-132">В меню **Файл** выберите пункт **Создать проект**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-132">On the **File** menu, click **NewProject.**</span></span> <span data-ttu-id="7c6ed-133">Откроется диалоговое окно **Создание проекта** .</span><span class="sxs-lookup"><span data-stu-id="7c6ed-133">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="7c6ed-134">В диалоговом окне **Типы проектов** выберите **Проекты Visual C#** .</span><span class="sxs-lookup"><span data-stu-id="7c6ed-134">In the **Project Types** dialog box, select **Visual C# Projects**.</span></span> <span data-ttu-id="7c6ed-135">На панели **Шаблоны** выберите пункт **Приложение Windows**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-135">In the **Templates** pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="7c6ed-136">В поле **Имя** введите имя нового приложения (необязательно).</span><span class="sxs-lookup"><span data-stu-id="7c6ed-136">(Optional) In **Name**, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="7c6ed-137">Нажмите кнопку **ОК**, чтобы загрузить шаблон Visual C# Windows.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-137">Click **OK** to load the Visual C# Windows template.</span></span>  
  
6.  <span data-ttu-id="7c6ed-138">В меню **Проект** выберите пункт **Добавить ссылку**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-138">On the **Project** menu, select **Add Reference** item.</span></span> <span data-ttu-id="7c6ed-139">Откроется диалоговое окно **Добавление ссылки**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-139">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="7c6ed-140">Выберите следующие сборки из списка на вкладке **.NET**, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-140">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="7c6ed-141">Microsoft.SqlServer.Replication .NET Programming Interface</span><span class="sxs-lookup"><span data-stu-id="7c6ed-141">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="7c6ed-142">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="7c6ed-142">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="7c6ed-143">Библиотека агента репликации</span><span class="sxs-lookup"><span data-stu-id="7c6ed-143">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7c6ed-144">Чтобы выбрать несколько файлов, удерживайте клавишу CTRL.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-144">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="7c6ed-145">(Необязательно) Повторите шаг 6.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-145">(Optional) Repeat step 6.</span></span> <span data-ttu-id="7c6ed-146">Щелкните вкладку \*\*Обзор[!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)], перейдите в каталог \*\*COM, выберите файл Microsoft.SqlServer.Replication.BusinessLogicSupport.dll и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-146">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="7c6ed-147">В меню **Вид** выберите пункт **Код**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-147">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="7c6ed-148">В коде перед инструкцией пространства имен введите следующие инструкции `using` для определения типов в пространстве имен RMO:</span><span class="sxs-lookup"><span data-stu-id="7c6ed-148">In the code, before the namespace statement, type the following `using` statements to qualify the types in the RMO namespaces:</span></span>  
  
    ```  
    // These namespaces are required.  
    using Microsoft.SqlServer.Replication;  
    using Microsoft.SqlServer.Management.Common;  
    // This namespace is only used when creating custom business  
    // logic for merge replication.  
    using Microsoft.SqlServer.Replication.BusinessLogicSupport;   
    ```  
  
#### <a name="to-create-a-new-microsoft-visual-basic-net-project"></a><span data-ttu-id="7c6ed-149">Создание нового проекта Microsoft Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="7c6ed-149">To create a new Microsoft Visual Basic .NET project</span></span>  
  
1.  <span data-ttu-id="7c6ed-150">Запустите среду Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-150">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="7c6ed-151">В меню **Файл** выберите пункт **Создать проект**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-151">On the **File** menu, select **New Project**.</span></span> <span data-ttu-id="7c6ed-152">Откроется диалоговое окно **Создание проекта** .</span><span class="sxs-lookup"><span data-stu-id="7c6ed-152">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="7c6ed-153">На панели типов проекта выберите **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-153">In the Project Types pane, select **Visual Basic**.</span></span> <span data-ttu-id="7c6ed-154">На панели "Шаблоны" выберите пункт **Приложение Windows**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-154">In the Templates pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="7c6ed-155">(Необязательно.) В поле **Имя** введите имя нового приложения.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-155">(Optional) In the **Name** box, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="7c6ed-156">Нажмите кнопку **ОК**, чтобы загрузить шаблон Visual Basic Windows.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-156">Click **OK** to load the Visual Basic Windows template.</span></span>  
  
6.  <span data-ttu-id="7c6ed-157">В меню **Проект** выберите пункт **Добавить ссылку**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-157">On the **Project** menu, select **Add Reference**.</span></span> <span data-ttu-id="7c6ed-158">Откроется диалоговое окно **Добавление ссылки**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-158">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="7c6ed-159">Выберите следующие сборки из списка на вкладке **.NET**, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-159">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="7c6ed-160">Microsoft.SqlServer.Replication .NET Programming Interface</span><span class="sxs-lookup"><span data-stu-id="7c6ed-160">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="7c6ed-161">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="7c6ed-161">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="7c6ed-162">Библиотека агента репликации</span><span class="sxs-lookup"><span data-stu-id="7c6ed-162">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7c6ed-163">Чтобы выбрать несколько файлов, удерживайте клавишу CTRL.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-163">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="7c6ed-164">(Необязательно) Повторите шаг 6.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-164">(Optional) Repeat step 6.</span></span> <span data-ttu-id="7c6ed-165">Щелкните вкладку \*\*Обзор[!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)], перейдите в каталог \*\*COM, выберите файл Microsoft.SqlServer.Replication.BusinessLogicSupport.dll и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-165">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="7c6ed-166">В меню **Вид** выберите пункт **Код**.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-166">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="7c6ed-167">В коде перед декларациями введите следующие инструкции `Imports` для определения типов в пространстве имен RMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-167">In the code, before any declarations, type the following `Imports` statements to qualify the types in the RMO namespaces.</span></span>  
  
    ```  
    ' These namespaces are required.  
    Imports Microsoft.SqlServer.Replication  
    Imports Microsoft.SqlServer.Management.Common  
    ' This namespace is only used when creating custom business  
    ' logic for merge replication.  
    Imports Microsoft.SqlServer.Replication.BusinessLogicSupport   
    ```  
  
## <a name="connecting-to-a-replication-server"></a><span data-ttu-id="7c6ed-168">Соединение с сервером репликации</span><span class="sxs-lookup"><span data-stu-id="7c6ed-168">Connecting to a Replication Server</span></span>  
 <span data-ttu-id="7c6ed-169">Для программных объектов RMO требуется, чтобы соединение с экземпляром [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] было выполнено с использованием экземпляра класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-169">RMO programming objects require that a connection to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is made by using an instance of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span> <span data-ttu-id="7c6ed-170">Это соединение с сервером выполняется независимо от каких-либо программных объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-170">This connection to the server is made independently of any RMO programming objects.</span></span> <span data-ttu-id="7c6ed-171">После этого соединение передается объекту RMO либо во время создания экземпляра, либо в результате присваивания свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> объекту.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-171">It is then passed to the RMO object either during instance creation or by assignment to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the object.</span></span> <span data-ttu-id="7c6ed-172">Это позволяет создать экземпляр объекта программирования RMO независимо от объекта соединения и разделить задачи их управления. Один объект соединения можно использовать с несколькими объектами программирования RMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-172">In this manner, an RMO programming object and the connection object instances can be created and managed separately, and a single connection object can be reused with multiple RMO programming objects.</span></span> <span data-ttu-id="7c6ed-173">Для соединений с сервером репликации действуют следующие правила.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-173">The following rules apply for connections to a replication server:</span></span>  
  
-   <span data-ttu-id="7c6ed-174">Все свойства соединения определяются применительно к данному конкретному объекту <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-174">All properties for the connection are defined for a given <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="7c6ed-175">Соединение с каждым экземпляром [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] должно иметь свой собственный объект <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-175">A connection to each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must have its own <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="7c6ed-176">Объект <xref:Microsoft.SqlServer.Management.Common.ServerConnection> назначается свойству <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> программного объекта RMO, создаваемого или применяемого для доступа на сервере.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-176">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object is assigned to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the RMO programming object being created or accessed on the server.</span></span>  
  
-   <span data-ttu-id="7c6ed-177">Метод <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> открывает соединение с сервером.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-177">The <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> method opens the connection to the server.</span></span> <span data-ttu-id="7c6ed-178">Этот метод должен быть вызван перед вызовом любых методов любых программных объектов RMO, использующих соединение, которые получают доступ к серверу.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-178">This method must be called before calling any methods that access the server on any RMO programming objects using the connection.</span></span>  
  
-   <span data-ttu-id="7c6ed-179">В объектах RMO и управляющих объектах [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (объектах SMO) используется класс <xref:Microsoft.SqlServer.Management.Common.ServerConnection> для создания соединений с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], поэтому одно и то же соединение может использоваться и объектами RMO, и объектами SMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-179">Because RMO and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO) both use the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class for connections to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the same connection can be used by both RMO and SMO objects.</span></span> <span data-ttu-id="7c6ed-180">Дополнительные сведения см. в статье [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md) (Соединение с экземпляром SQL Server).</span><span class="sxs-lookup"><span data-stu-id="7c6ed-180">For more information, see [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span></span>  
  
-   <span data-ttu-id="7c6ed-181">Все данные проверки подлинности, необходимые для установления соединения и входа на сервер, передаются в объекте <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-181">All authentication information to make the connection and successfully log on to the server is supplied in the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="7c6ed-182">По умолчанию используется проверка подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-182">Windows Authentication is the default.</span></span> <span data-ttu-id="7c6ed-183">Чтобы можно было использовать проверку подлинности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], в качестве <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> должно быть задано значение `false`, а свойствам <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> и <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> должны быть присвоены допустимое имя входа и пароль [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7c6ed-183">To use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> must be set to `false` and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> must be set to a valid [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logon and password.</span></span> <span data-ttu-id="7c6ed-184">Учетные данные безопасности должны всегда храниться и обрабатываться с учетом требований безопасности и при любой возможности предоставляться только во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-184">Security credentials must always be stored and handled securely, and supplied at run-time whenever possible.</span></span>  
  
-   <span data-ttu-id="7c6ed-185">Для многопоточных приложений в каждом потоке должен использоваться отдельный объект <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-185">For multithreaded applications, a separate <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object should be used in each thread.</span></span>  
  
 <span data-ttu-id="7c6ed-186">Вызовите метод <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> объекта <xref:Microsoft.SqlServer.Management.Common.ServerConnection>, чтобы закрыть активные соединения сервера, используемые объектами RMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-186">Call the <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> method on the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object to close active server connections used by RMO objects.</span></span>  
  
## <a name="setting-rmo-properties"></a><span data-ttu-id="7c6ed-187">Задание свойств объектов RMO</span><span class="sxs-lookup"><span data-stu-id="7c6ed-187">Setting RMO Properties</span></span>  
 <span data-ttu-id="7c6ed-188">Свойства программных объектов RMO представляют свойства этих объектов репликации на сервере.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-188">The properties of RMO programming objects represent the properties of these replication objects at the server.</span></span> <span data-ttu-id="7c6ed-189">При создании новых объектов репликации на сервере для определения этих объектов используются свойства объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-189">When creating new replication objects at the server, RMO properties are used to define these objects.</span></span> <span data-ttu-id="7c6ed-190">Для существующих объектов все свойства объектов RMO представляют свойства существующего объекта, подлежащие изменению только в части тех свойств, которым требуется установка или запись значения.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-190">For existing objects, the RMO properties represent the existing object's properties, which can be modified only for properties that are writable or settable.</span></span> <span data-ttu-id="7c6ed-191">Свойства могут быть заданы для новых объектов или существующих объектов.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-191">Properties can be set on new objects or existing objects.</span></span>  
  
### <a name="setting-properties-for-new-replication-objects"></a><span data-ttu-id="7c6ed-192">Задание свойств для новых объектов репликации</span><span class="sxs-lookup"><span data-stu-id="7c6ed-192">Setting Properties for New Replication Objects</span></span>  
 <span data-ttu-id="7c6ed-193">При создании новых объектов репликации на сервере необходимо указывать все обязательные свойства перед вызовом метода `Create` объекта.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-193">When creating a new replication object at the server, you must specify all required properties before calling the `Create` method of the object.</span></span> <span data-ttu-id="7c6ed-194">Дополнительные сведения о задании свойств для нового объекта репликации см. в статье [Настройка публикации и распространения](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="7c6ed-194">For more information about setting properties for a new replication object, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
### <a name="setting-properties-for-existing-replication-objects"></a><span data-ttu-id="7c6ed-195">Задание свойств для существующих объектов репликации</span><span class="sxs-lookup"><span data-stu-id="7c6ed-195">Setting Properties for Existing Replication Objects</span></span>  
 <span data-ttu-id="7c6ed-196">Применительно к объектам репликации, существующим на сервере (в зависимости от объекта), объекты RMO могут поддерживать возможность изменения некоторых или всех свойств.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-196">For replication objects that exist at the server, depending on the object, RMO might support the ability to change some or all of its properties.</span></span> <span data-ttu-id="7c6ed-197">Могут быть изменены только свойства, предназначенные для записи или доступные для задания.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-197">Only writable or settable properties can be changed.</span></span> <span data-ttu-id="7c6ed-198">Прежде чем появится возможность изменить свойства, необходимо вызвать метод `Load` или <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A>, чтобы получить текущие значения свойств с сервера.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-198">Before properties can be changed, either the `Load` or the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method must be called to get the current properties from the server.</span></span> <span data-ttu-id="7c6ed-199">Вызов этих методов становится указанием на то, что существующий объект подлежит изменению.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-199">Calling these methods indicates that an existing object is being modified.</span></span>  
  
 <span data-ttu-id="7c6ed-200">По умолчанию при изменении свойства объекта в технологии RMO осуществляется фиксация этих изменений на сервере с учетом используемого режима выполнения <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-200">By default, when changing object properties, RMO commits these changes to the server based on the execution mode of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> being used.</span></span> <span data-ttu-id="7c6ed-201">Метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> может применяться для проверки того, существует ли объект на сервере, перед осуществлением попытки получения или изменения его свойств.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-201">The <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> method can be used to verify that an object exists at the server before attempting to retrieve or change its properties.</span></span> <span data-ttu-id="7c6ed-202">Дополнительные сведения о свойствах объекта репликации см. в статье [Просмотр и изменение свойств издателя и распространителя](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="7c6ed-202">For more information about changing the properties of a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7c6ed-203">Если доступ к одному и тому же объекту репликации на сервере осуществляется несколькими клиентами RMO или несколькими экземплярами одного из программных объектов RMO, то может быть вызван метод `Refresh` объекта RMO для обновления свойств с учетом текущего состояния объекта на сервере.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-203">When multiple RMO clients or multiple instances of an RMO programming object are accessing the same replication object at the server, the `Refresh` method of the RMO object can be called to update the properties based on the current state of the object at the server.</span></span>  
  
### <a name="caching-property-changes"></a><span data-ttu-id="7c6ed-204">Кэширование изменений свойств</span><span class="sxs-lookup"><span data-stu-id="7c6ed-204">Caching Property Changes</span></span>  
 <span data-ttu-id="7c6ed-205">Если свойство <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> имеет значение <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql>, то происходит перехват всех инструкций [!INCLUDE[tsql](../../../includes/tsql-md.md)], выработанных объектами RMO, чтобы эти инструкции можно было выполнить вручную в одном пакете с использованием одного из методов выполнения.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-205">When the <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> property is set to <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> all [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements generated by RMO are captured so that they can be executed manually in a single batch by using one of the execution methods.</span></span> <span data-ttu-id="7c6ed-206">Технология RMO позволяет кэшировать изменения свойств и фиксировать их вместе в одном пакете с использованием метода <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> объекта.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-206">RMO lets you cache property changes and commit them together in a single batch by using the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method of the object.</span></span> <span data-ttu-id="7c6ed-207">Чтобы обеспечить кэширование изменений свойств, необходимо задать свойству <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> объекта значение `true`.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-207">To cache property changes, the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> property of the object must be set to `true`.</span></span> <span data-ttu-id="7c6ed-208">При кэшировании изменений свойств в технологии RMO объект <xref:Microsoft.SqlServer.Management.Common.ServerConnection> по-прежнему управляет тем, когда происходит передача изменений на сервер.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-208">When caching property changes in RMO, the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object still controls when changes are sent to the server.</span></span> <span data-ttu-id="7c6ed-209">Дополнительные сведения о кэшировании изменений свойств объекта репликации см. в статье [Просмотр и изменение свойств издателя и распространителя](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="7c6ed-209">For more information about caching property changes for a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7c6ed-210">Безусловно, класс <xref:Microsoft.SqlServer.Management.Common.ServerConnection> поддерживает объявление явных транзакций при задании свойств, но такие транзакции могут препятствовать выполнению внутренних транзакций и вырабатывать непредвиденные результаты, поэтому не должны использоваться с объектами RMO.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-210">Although the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class supports declaring explicit transactions when setting properties, such transactions may interfere with internal replication transactions, can produce unanticipated results, and should not be used with RMO.</span></span>  
  
## <a name="example"></a><span data-ttu-id="7c6ed-211">Пример</span><span class="sxs-lookup"><span data-stu-id="7c6ed-211">Example</span></span>  
 <span data-ttu-id="7c6ed-212">В этом примере демонстрируется кэширование изменений свойств.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-212">This example demonstrates the caching of property changes.</span></span> <span data-ttu-id="7c6ed-213">Изменения, внесенные в атрибуты публикации транзакций, кэшируются до тех пор, пока не происходит их явная отправка на сервер.</span><span class="sxs-lookup"><span data-stu-id="7c6ed-213">Changes made to the attributes of a transactional publication are cached until they are explicitly sent to the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeTranPub_cached](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_ChangeTranPub_cached)]  
  
## <a name="see-also"></a><span data-ttu-id="7c6ed-214">См. также:</span><span class="sxs-lookup"><span data-stu-id="7c6ed-214">See Also</span></span>  
 <span data-ttu-id="7c6ed-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="7c6ed-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="7c6ed-216">Основные понятия программирования репликации</span><span class="sxs-lookup"><span data-stu-id="7c6ed-216">Replication Programming Concepts</span></span>](replication-programming-concepts.md)  
  
  
