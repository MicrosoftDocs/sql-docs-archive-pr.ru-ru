---
title: Наблюдение за репликацией программным образом | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- sp_replmonitorhelppublisher
- sp_replmonitorhelpmergesessiondetail
- monitoring performance [SQL Server replication], publication status
- sp_replmonitorhelpmergesession
- sp_replmonitorhelppublicationthresholds
- monitoring performance [SQL Server replication], subscription status
- monitoring performance [SQL Server replication], Transact-SQL programming
- sp_replmonitorsubscriptionpendingcmds
- sp_replmonitorchangepublicationthreshold
- transactional replication, monitoring
- sp_replmonitorhelppublication
- sp_replmonitorhelpsubscription
- monitoring performance [SQL Server replication], thresholds and warnings
- merge replication monitoring [SQL Server replication]
- snapshot replication [SQL Server], monitoring
ms.assetid: e8bf8850-8da5-4a4f-a399-64232b4e476d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e11f73bf9538fb5ba84f4575631489ef852802c1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750736"
---
# <a name="programmatically-monitor-replication"></a><span data-ttu-id="f10d2-102">Наблюдение за репликацией программным образом</span><span class="sxs-lookup"><span data-stu-id="f10d2-102">Programmatically Monitor Replication</span></span>
  <span data-ttu-id="f10d2-103">Монитор репликации — это графическое средство, позволяющее осуществлять мониторинг топологии репликации.</span><span class="sxs-lookup"><span data-stu-id="f10d2-103">Replication Monitor is a graphical tool that allows you to monitor a replication topology.</span></span> <span data-ttu-id="f10d2-104">К данным мониторинга можно обращаться программным путем с помощью хранимых процедур репликации [!INCLUDE[tsql](../../../includes/tsql-md.md)] или объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="f10d2-104">You can access the same monitoring data programmatically by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] replication stored procedures or replication management objects (RMO).</span></span> <span data-ttu-id="f10d2-105">Эти объекты позволяют программировать следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="f10d2-105">These objects enable you to program the following tasks:</span></span>  
  
-   <span data-ttu-id="f10d2-106">Наблюдение за состоянием издателей, публикаций и подписок.</span><span class="sxs-lookup"><span data-stu-id="f10d2-106">Monitor the state of Publishers, publications, and subscriptions.</span></span>  
  
-   <span data-ttu-id="f10d2-107">Мониторинг сеансов агентов слияния на одном или нескольких подписчиках.</span><span class="sxs-lookup"><span data-stu-id="f10d2-107">Monitor Merge Agent sessions at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="f10d2-108">Мониторинг команд транзакций, ожидающих выполнения на одном или нескольких подписчиках.</span><span class="sxs-lookup"><span data-stu-id="f10d2-108">Monitor transactional commands waiting to be applied at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="f10d2-109">Установка пороговых показателей, определяющих, когда необходимо вмешательство в публикацию.</span><span class="sxs-lookup"><span data-stu-id="f10d2-109">Define the threshold metrics that determine when a publication requires intervention.</span></span>  
  
-   <span data-ttu-id="f10d2-110">Мониторинг состояния трассировочных токенов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-110">Monitor the status of tracer tokens.</span></span>  
  
 <span data-ttu-id="f10d2-111">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="f10d2-111">**In this topic:**</span></span>  
  
 [<span data-ttu-id="f10d2-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="f10d2-112">Transact-SQL</span></span>](#Tsql)  
  
 [<span data-ttu-id="f10d2-113">объекты RMO;</span><span class="sxs-lookup"><span data-stu-id="f10d2-113">Replication Management Objects (RMO)</span></span>](#RMO)  
  
##  <a name="transact-sql"></a><a name="Tsql"></a> <span data-ttu-id="f10d2-114">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="f10d2-114">Transact-SQL</span></span>  
  
#### <a name="to-monitor-publishers-publications-and-subscriptions-from-the-distributor"></a><span data-ttu-id="f10d2-115">Мониторинг издателей, публикаций и подписок с распространителя</span><span class="sxs-lookup"><span data-stu-id="f10d2-115">To monitor Publishers, publications, and subscriptions from the Distributor</span></span>  
  
1.  <span data-ttu-id="f10d2-116">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-116">At the Distributor on the distribution database, execute [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span></span> <span data-ttu-id="f10d2-117">Будут возвращены данные мониторинга всех издателей, использующих этот распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-117">This returns monitoring information for all Publishers using this Distributor.</span></span> <span data-ttu-id="f10d2-118">Чтобы ограничить результирующий набор одним издателем, укажите **@publisher** .</span><span class="sxs-lookup"><span data-stu-id="f10d2-118">To limit the result set to a single Publisher, specify **@publisher**.</span></span>  
  
2.  <span data-ttu-id="f10d2-119">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-119">At the Distributor on the distribution database, execute [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span></span> <span data-ttu-id="f10d2-120">Будут возвращены данные мониторинга для всех публикаций, использующих этот распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-120">This returns monitoring information for all publications using this Distributor.</span></span> <span data-ttu-id="f10d2-121">Чтобы ограничить результирующий набор одним издателем, публикацией или опубликованной базой данных, укажите **@publisher** , **@publication** или **@publisher_db** соответственно.</span><span class="sxs-lookup"><span data-stu-id="f10d2-121">To limit the result set to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
3.  <span data-ttu-id="f10d2-122">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-122">At the Distributor on the distribution database, execute [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span></span> <span data-ttu-id="f10d2-123">Будут возвращены данные мониторинга для всех подписок, использующих этот распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-123">This returns monitoring information for all subscriptions using this Distributor.</span></span> <span data-ttu-id="f10d2-124">Чтобы ограничить результирующий набор подписками, принадлежащими одному издателю, публикации или опубликованной базе данных, укажите **@publisher** , **@publication** или **@publisher_db** соответственно.</span><span class="sxs-lookup"><span data-stu-id="f10d2-124">To limit the result set to subscriptions belonging to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-transactional-commands-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="f10d2-125">Мониторинг команд транзакций, ожидающих выполнения на подписчике</span><span class="sxs-lookup"><span data-stu-id="f10d2-125">To monitor transactional commands waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="f10d2-126">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-126">At the Distributor on the distribution database, execute [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span></span> <span data-ttu-id="f10d2-127">Будут возвращены данные мониторинга по всем ждущим командам для всех подписок, использующих этот распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-127">This returns monitoring information for all commands pending for all subscriptions using this Distributor.</span></span> <span data-ttu-id="f10d2-128">Чтобы ограничить результирующий набор команд, ожидающих выполнения для подписок, принадлежащих одному издателю, подписчику, публикации или опубликованной базе данных, укажите **@publisher** , **@subscriber** , **@publication** или **@publisher_db** соответственно.</span><span class="sxs-lookup"><span data-stu-id="f10d2-128">To limit the result set to commands pending for subscriptions belonging to a single Publisher, Subscriber, publication, or published database, specify **@publisher**, **@subscriber**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-changes-waiting-to-be-uploaded-or-downloaded"></a><span data-ttu-id="f10d2-129">Мониторинг изменений слияния, ожидающих загрузки или выгрузки</span><span class="sxs-lookup"><span data-stu-id="f10d2-129">To monitor merge changes waiting to be uploaded or downloaded</span></span>  
  
1.  <span data-ttu-id="f10d2-130">В базе данных публикации на издателе выполните процедуру [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-130">At the Publisher on the publication database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="f10d2-131">Это возвращает результирующий набор с информацией об изменениях, ожидающих репликации на серверы-подписчики.</span><span class="sxs-lookup"><span data-stu-id="f10d2-131">This returns a result set showing information on changes that are waiting to be replicated to Subscribers.</span></span> <span data-ttu-id="f10d2-132">Чтобы ограничить результирующий набор изменениями, относящимися к одной публикации или статье, укажите **@publication** или **@article** соответственно.</span><span class="sxs-lookup"><span data-stu-id="f10d2-132">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
2.  <span data-ttu-id="f10d2-133">В базе данных подписки на подписчике выполните процедуру [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-133">At a Subscriber on the subscription database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="f10d2-134">Это возвращает результирующий набор с информацией об изменениях, ожидающих репликации на сервер-издатель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-134">This returns a result set showing information on changes that are waiting to be replicated to the Publisher.</span></span> <span data-ttu-id="f10d2-135">Чтобы ограничить результирующий набор изменениями, относящимися к одной публикации или статье, укажите **@publication** или **@article** соответственно.</span><span class="sxs-lookup"><span data-stu-id="f10d2-135">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions"></a><span data-ttu-id="f10d2-136">Мониторинг сеансов агента слияния</span><span class="sxs-lookup"><span data-stu-id="f10d2-136">To monitor Merge Agent sessions</span></span>  
  
1.  <span data-ttu-id="f10d2-137">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-137">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="f10d2-138">Это возвращает данные мониторинга, включая **Session_id**, по всем сеансам агента слияния для всех подписок, использующих этот распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-138">This returns monitoring information, including **Session_id**, on all Merge Agent sessions for all subscriptions using this Distributor.</span></span> <span data-ttu-id="f10d2-139">Еще один способ получить **Session_id** — это запросить системную таблицу [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="f10d2-139">You can also obtain **Session_id** by querying the [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) system table.</span></span>  
  
2.  <span data-ttu-id="f10d2-140">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-140">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="f10d2-141">В параметре **Session_id** укажите полученное на шаге 1 значение **@session_id**.</span><span class="sxs-lookup"><span data-stu-id="f10d2-141">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="f10d2-142">Будут выданы подробные сведения о сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-142">This displays detailed monitor information about the session.</span></span>  
  
3.  <span data-ttu-id="f10d2-143">Повторите шаг 2 для всех интересующих сеансов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-143">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions-for-pull-subscriptions-from-the-subscriber"></a><span data-ttu-id="f10d2-144">Мониторинг сеансов агента слияния для подписок по запросу с подписчика</span><span class="sxs-lookup"><span data-stu-id="f10d2-144">To monitor Merge Agent sessions for pull subscriptions from the Subscriber</span></span>  
  
1.  <span data-ttu-id="f10d2-145">В базе данных подписки на подписчике выполните процедуру [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-145">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="f10d2-146">Для данной подписки укажите **@publisher** , **@publication** и имя базы данных публикации для **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="f10d2-146">For a given subscription, specify **@publisher**, **@publication**, and the name of the publication database for **@publisher_db**.</span></span> <span data-ttu-id="f10d2-147">Будут возвращены сведения о последних пяти сеансах агента слияния для этой подписки.</span><span class="sxs-lookup"><span data-stu-id="f10d2-147">This returns monitoring information for the last five Merge Agent sessions for this subscription.</span></span> <span data-ttu-id="f10d2-148">Запомните значение **Session_id** для сеансов, представляющих интерес в результирующем наборе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-148">Note the value of **Session_id** for sessions of interest in the result set.</span></span>  
  
2.  <span data-ttu-id="f10d2-149">В базе данных подписки на подписчике выполните процедуру [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-149">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="f10d2-150">В параметре **Session_id** укажите полученное на шаге 1 значение **@session_id**.</span><span class="sxs-lookup"><span data-stu-id="f10d2-150">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="f10d2-151">Будут возвращены подробные данные мониторинга сеанса.</span><span class="sxs-lookup"><span data-stu-id="f10d2-151">This displays detailed monitoring information about the session.</span></span>  
  
3.  <span data-ttu-id="f10d2-152">Повторите шаг 2 для всех интересующих сеансов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-152">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-view-and-modify-the-monitor-threshold-metrics-for-a-publication"></a><span data-ttu-id="f10d2-153">Получение и изменение пороговых метрик мониторинга для публикации</span><span class="sxs-lookup"><span data-stu-id="f10d2-153">To view and modify the monitor threshold metrics for a publication</span></span>  
  
1.  <span data-ttu-id="f10d2-154">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-154">At the Distributor on the distribution database, execute [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span></span> <span data-ttu-id="f10d2-155">Будут возвращены пороговые значения мониторинга для всех публикаций, использующих этот распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-155">This returns the monitoring thresholds set for all publications using this Distributor.</span></span> <span data-ttu-id="f10d2-156">Чтобы ограничить результирующий набор мониторингом порогов для публикаций, принадлежащих одному издателю или опубликованной базе данных, или одной публикации, укажите **@publisher** , **@publisher_db** или **@publication** соответственно.</span><span class="sxs-lookup"><span data-stu-id="f10d2-156">To limit the result set to monitor thresholds to publications belonging to a single Publisher or published database or to a single publication, specify **@publisher**, **@publisher_db**, or **@publication**, respectively.</span></span> <span data-ttu-id="f10d2-157">Запомните значение **Metric_id** для всех порогов, которые требуется изменить.</span><span class="sxs-lookup"><span data-stu-id="f10d2-157">Note the value of **Metric_id** for any thresholds that must be changed.</span></span> <span data-ttu-id="f10d2-158">Дополнительные сведения см. в статье [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="f10d2-158">For more information, see [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="f10d2-159">В базе данных распространителя на распространителе выполните процедуру [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f10d2-159">At the Distributor on the distribution database, execute [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span></span> <span data-ttu-id="f10d2-160">Если требуется, укажите следующие значения.</span><span class="sxs-lookup"><span data-stu-id="f10d2-160">Specify the following as needed:</span></span>  
  
    -   <span data-ttu-id="f10d2-161">Значение **Metric_id** , полученное в шаге 1, в параметре **@metric_id**.</span><span class="sxs-lookup"><span data-stu-id="f10d2-161">The **Metric_id** value obtained in step 1 for **@metric_id**.</span></span>  
  
    -   <span data-ttu-id="f10d2-162">Новое значение порогового метрики монитора для **@value** .</span><span class="sxs-lookup"><span data-stu-id="f10d2-162">A new value for the monitor threshold metric for **@value**.</span></span>  
  
    -   <span data-ttu-id="f10d2-163">Значение **1** в параметре **@shouldalert** , чтобы при достижении порога записывалось в журнал предупреждение, или **0** , если предупреждение не требуется.</span><span class="sxs-lookup"><span data-stu-id="f10d2-163">A value of **1** for **@shouldalert** for an alert to be logged when this threshold is reached, or a value of **0** if an alert is not needed.</span></span>  
  
    -   <span data-ttu-id="f10d2-164">Значение **1** в параметре **@mode** , чтобы включить мониторинг пороговой метрики, или **2** , чтобы выключить его.</span><span class="sxs-lookup"><span data-stu-id="f10d2-164">A value of **1** for **@mode** to enable the monitor threshold metric or a value of **2** to disable it.</span></span>  
  
##  <a name="replication-management-objects-rmo"></a><a name="RMO"></a> <span data-ttu-id="f10d2-165">объекты RMO;</span><span class="sxs-lookup"><span data-stu-id="f10d2-165">Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-monitor-a-subscription-to-a-merge-publication-at-the-subscriber"></a><span data-ttu-id="f10d2-166">Мониторинг подписки на публикацию слиянием на подписчике</span><span class="sxs-lookup"><span data-stu-id="f10d2-166">To monitor a subscription to a merge publication at the Subscriber</span></span>  
  
1.  <span data-ttu-id="f10d2-167">Создайте соединение с подписчиком с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-167">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="f10d2-168">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> и задайте свойства <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> для подписки, а затем задайте свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> для <xref:Microsoft.SqlServer.Management.Common.ServerConnection> , созданного в шаге 1.</span><span class="sxs-lookup"><span data-stu-id="f10d2-168">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> class, and set the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> properties for the subscription, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="f10d2-169">Чтобы получить сведения о сеансах агента слияния для данной подписки, вызовите один из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-169">Call one of the following methods to return information on Merge Agent sessions for this subscription:</span></span>  
  
    -   <span data-ttu-id="f10d2-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> — возвращает массив объектов <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> со сведениями о последних пяти сеансах агента слияния.</span><span class="sxs-lookup"><span data-stu-id="f10d2-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on up to the last five Merge Agent sessions.</span></span> <span data-ttu-id="f10d2-171">Запомните значения <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> для всех необходимых сеансов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-171">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="f10d2-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> — возвращает массив объектов <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> со сведениями о сеансах агента слияния за количество часов, указанное в параметре *hours* (до пяти последних сеансов).</span><span class="sxs-lookup"><span data-stu-id="f10d2-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on Merge Agent sessions that have occurred during the past number of hours passed in as the *hours* parameter (up to the last five sessions).</span></span> <span data-ttu-id="f10d2-173">Запомните значения <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> для всех необходимых сеансов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-173">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="f10d2-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> — возвращает объект <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> с информацией о последнем сеансе агента слияния.</span><span class="sxs-lookup"><span data-stu-id="f10d2-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - returns a <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="f10d2-175">Запомните значение <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> для этого сеанса.</span><span class="sxs-lookup"><span data-stu-id="f10d2-175">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for this session.</span></span>  
  
    -   <span data-ttu-id="f10d2-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями о последних сеансах агента слияния (до пяти сеансов по одному в каждой строке).</span><span class="sxs-lookup"><span data-stu-id="f10d2-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - returns a <xref:System.Data.DataSet> object with information on up to the last five Merge Agent sessions, one in each row.</span></span> <span data-ttu-id="f10d2-177">Запишите значение столбца **Session_id** для каждого сеанса, представляющего интерес.</span><span class="sxs-lookup"><span data-stu-id="f10d2-177">Note the value of the **Session_id** column for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="f10d2-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> — возвращает объект <xref:System.Data.DataRow> с информацией о последнем сеансе агента слияния.</span><span class="sxs-lookup"><span data-stu-id="f10d2-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - returns a <xref:System.Data.DataRow> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="f10d2-179">Запишите значение столбца **Session_id** для каждого сеанса, представляющего интерес.</span><span class="sxs-lookup"><span data-stu-id="f10d2-179">Note the value of the **Session_id** column for this session.</span></span>  
  
4.  <span data-ttu-id="f10d2-180">Вызовите <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> , чтобы обновить данные для объекта <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> , передаваемого в качестве параметра *mss,* или вызовите <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> , чтобы обновить данные для объекта <xref:System.Data.DataRow> , передаваемого в качестве параметра *drRefresh*.</span><span class="sxs-lookup"><span data-stu-id="f10d2-180">(Optional) Call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data for the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object passed as *mss,* or call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data in the <xref:System.Data.DataRow> object passed as *drRefresh*.</span></span>  
  
5.  <span data-ttu-id="f10d2-181">С помощью идентификатора сеанса, полученного в шаге 3, вызовите один из следующих методов для получения сведений об отдельном сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-181">Using the session ID obtained in step 3, call one of the following methods to return information on the details of a particular session:</span></span>  
  
    -   <span data-ttu-id="f10d2-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A>— Возвращает массив <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> объектов для заданного *SessionID*.</span><span class="sxs-lookup"><span data-stu-id="f10d2-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objects for the supplied *sessionID*.</span></span>  
  
    -   <span data-ttu-id="f10d2-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A>— Возвращает <xref:System.Data.DataSet> объект со сведениями для указанного *SessionID*.</span><span class="sxs-lookup"><span data-stu-id="f10d2-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A> - returns a <xref:System.Data.DataSet> object with information for the specified *sessionID*.</span></span>  
  
#### <a name="to-monitor-replication-properties-for-all-publications-at-a-distributor"></a><span data-ttu-id="f10d2-184">Мониторинг свойств репликации для всех публикаций на распространителе</span><span class="sxs-lookup"><span data-stu-id="f10d2-184">To monitor replication properties for all publications at a Distributor</span></span>  
  
1.  <span data-ttu-id="f10d2-185">Создайте соединение с распространителем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-185">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="f10d2-186">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.ReplicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="f10d2-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="f10d2-187">Укажите для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> в качестве значения соединение <xref:Microsoft.SqlServer.Management.Common.ServerConnection> , созданное в шаге 1.</span><span class="sxs-lookup"><span data-stu-id="f10d2-187">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
4.  <span data-ttu-id="f10d2-188">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
5.  <span data-ttu-id="f10d2-189">Выполните один или несколько следующих методов для получения сведений о репликации по всем издателям, использующим данный распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-189">Execute one or more of the following methods to return replication information for all Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех агентах распространителя на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Distribution Agents at this Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об ошибках, которые хранятся на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains information about errors stored at the Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех агентах чтения журнала на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Log Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех агентах слияния на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Merge Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех остальных агентах репликации на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all other replication agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех издателях на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Publishers at this Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> — возвращает объект <xref:System.Data.DataSet> со списком издателей, использующих данный распространитель.</span><span class="sxs-lookup"><span data-stu-id="f10d2-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - returns a <xref:System.Data.DataSet> object that returns the Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех агентах чтения очереди на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Queue Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об указанном агенте чтения очереди и сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Queue Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="f10d2-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями сеанса об указанном агенте чтения очереди.</span><span class="sxs-lookup"><span data-stu-id="f10d2-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Queue Reader Agent.</span></span>  
  
    -   <span data-ttu-id="f10d2-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех агентах моментальных снимков на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Snapshot Agents at the Distributor.</span></span>  
  
#### <a name="to-monitor-publication-properties-for-a-specific-publisher-at-the-distributor"></a><span data-ttu-id="f10d2-201">Мониторинг свойств публикации для указанного издателя на распространителе</span><span class="sxs-lookup"><span data-stu-id="f10d2-201">To monitor publication properties for a specific Publisher at the Distributor</span></span>  
  
1.  <span data-ttu-id="f10d2-202">Создайте соединение с распространителем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-202">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="f10d2-203">Получите объект <xref:Microsoft.SqlServer.Replication.PublisherMonitor> одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-203">Get a <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="f10d2-204">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.PublisherMonitor>.</span><span class="sxs-lookup"><span data-stu-id="f10d2-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor> class.</span></span> <span data-ttu-id="f10d2-205">Задайте для издателя свойство <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> , а также установите созданное на шаге 1 соединение <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> в качестве значения для свойства <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-205">Set the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> property for the Publisher, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="f10d2-206">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-206">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="f10d2-207">Если этот метод возвращает значение `false`, это означает, что было неправильно задано имя издателя или такой публикации не существует.</span><span class="sxs-lookup"><span data-stu-id="f10d2-207">If this method returns `false`, either the Publisher name was defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="f10d2-208">Из коллекции <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> , доступ к которой был получен с помощью свойства <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> существующего объекта <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-208">From the <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> object.</span></span>  
  
3.  <span data-ttu-id="f10d2-209">Выполните один или несколько следующих методов, чтобы получить сведения о репликации по всем публикациям, принадлежащим данному издателю.</span><span class="sxs-lookup"><span data-stu-id="f10d2-209">Execute one or more of the following methods to return replication information for all publications that belong to this Publisher.</span></span>  
  
    -   <span data-ttu-id="f10d2-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об указанном агенте распространителя и сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Distribution Agent and session.</span></span>  
  
    -   <span data-ttu-id="f10d2-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об указанном агенте распространителя.</span><span class="sxs-lookup"><span data-stu-id="f10d2-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Distribution Agent.</span></span>  
  
    -   <span data-ttu-id="f10d2-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> — возвращает объект <xref:System.Data.DataSet> с информацией журнала ошибок об указанной ошибке.</span><span class="sxs-lookup"><span data-stu-id="f10d2-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error record information about the specified error.</span></span>  
  
    -   <span data-ttu-id="f10d2-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об указанном агенте чтения журнала и сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details for the specified Log Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="f10d2-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями сеанса по указанному агенту чтения журнала.</span><span class="sxs-lookup"><span data-stu-id="f10d2-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Log Reader Agent.</span></span>  
  
    -   <span data-ttu-id="f10d2-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об указанном агенте слияния и сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="f10d2-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об указанном агенте слияния и сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - returns a <xref:System.Data.DataSet> object that contains additional details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="f10d2-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями сеанса об указанном агенте слияния.</span><span class="sxs-lookup"><span data-stu-id="f10d2-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="f10d2-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> — возвращает объект <xref:System.Data.DataSet> с дополнительными сведениями сеанса об указанном агенте слияния.</span><span class="sxs-lookup"><span data-stu-id="f10d2-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="f10d2-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех публикациях на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - returns a <xref:System.Data.DataSet> object that contains information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> — возвращает объект <xref:System.Data.DataSet> с дополнительными сведениями обо всех публикациях на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="f10d2-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об указанном агенте моментальных снимков и сеансе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Snapshot Agent and session.</span></span>  
  
    -   <span data-ttu-id="f10d2-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями сеанса об указанном агенте моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="f10d2-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Snapshot Agent.</span></span>  
  
    -   <span data-ttu-id="f10d2-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех подписках на публикации на данном распространителе.</span><span class="sxs-lookup"><span data-stu-id="f10d2-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about all subscriptions to publications at this Distributor.</span></span>  
  
#### <a name="to-monitor-properties-for-a-specific-publication-at-the-distributor"></a><span data-ttu-id="f10d2-224">Мониторинг свойств указанной публикации на распространителе</span><span class="sxs-lookup"><span data-stu-id="f10d2-224">To monitor properties for a specific publication at the Distributor</span></span>  
  
1.  <span data-ttu-id="f10d2-225">Создайте соединение с распространителем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-225">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="f10d2-226">Получите объект <xref:Microsoft.SqlServer.Replication.PublicationMonitor> одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-226">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="f10d2-227">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="f10d2-227">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="f10d2-228">Задайте для публикации свойства <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>и <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> , а также установите созданное на шаге 1 соединение <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> в качестве значения для свойства <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-228">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="f10d2-229">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="f10d2-230">Если этот метод возвращает `false`, то либо свойства публикации были определены неверно, либо публикация не существует.</span><span class="sxs-lookup"><span data-stu-id="f10d2-230">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="f10d2-231">Из коллекции <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> , доступ к которой был получен с помощью свойства <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> существующего объекта <xref:Microsoft.SqlServer.Replication.PublisherMonitor> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-231">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="f10d2-232">Выполните один или несколько следующих методов для получения сведений о данной публикации.</span><span class="sxs-lookup"><span data-stu-id="f10d2-232">Execute one or more of the following methods to return information about this publication.</span></span>  
  
    -   <span data-ttu-id="f10d2-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> — возвращает объект <xref:System.Data.DataSet> с информацией журнала ошибок об указанной ошибке.</span><span class="sxs-lookup"><span data-stu-id="f10d2-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error records about the specified error.</span></span>  
  
    -   <span data-ttu-id="f10d2-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об агенте чтения журнала для данной публикации.</span><span class="sxs-lookup"><span data-stu-id="f10d2-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Log Reader Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="f10d2-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> — возвращает объект <xref:System.Data.DataSet> с информацией по мониторингу пороговых значений, заданных для этой публикации.</span><span class="sxs-lookup"><span data-stu-id="f10d2-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - returns a <xref:System.Data.DataSet> object that contains information about the monitor warning thresholds set for this publication.</span></span>  
  
    -   <span data-ttu-id="f10d2-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об агенте чтения очереди, используемом данной публикацией.</span><span class="sxs-lookup"><span data-stu-id="f10d2-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Queue Reader Agent used by this publication.</span></span>  
  
    -   <span data-ttu-id="f10d2-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями об агенте моментальных снимков для данной публикации.</span><span class="sxs-lookup"><span data-stu-id="f10d2-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Snapshot Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="f10d2-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех подписках на эту публикацию.</span><span class="sxs-lookup"><span data-stu-id="f10d2-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about subscriptions to this publication.</span></span>  
  
    -   <span data-ttu-id="f10d2-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> — возвращает объект <xref:System.Data.DataSet> с дополнительными сведениями обо всех подписках на данную публикацию в зависимости от параметра <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span><span class="sxs-lookup"><span data-stu-id="f10d2-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about subscriptions to this publication based on the supplied <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span></span>  
  
    -   <span data-ttu-id="f10d2-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> — возвращает объект <xref:System.Data.DataSet> с данными задержки для указанного трассировочного токена.</span><span class="sxs-lookup"><span data-stu-id="f10d2-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - returns a <xref:System.Data.DataSet> object that contains latency information for the specified tracer token.</span></span>  
  
    -   <span data-ttu-id="f10d2-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> — возвращает объект <xref:System.Data.DataSet> со сведениями обо всех трассировочных токенах, вставленных в данную публикацию.</span><span class="sxs-lookup"><span data-stu-id="f10d2-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - returns a <xref:System.Data.DataSet> object that contains information about all tracer tokens inserted into this publication.</span></span>  
  
#### <a name="to-monitor-transactional-commands-that-are-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="f10d2-242">Мониторинг команд транзакций, ожидающих выполнения на подписчике</span><span class="sxs-lookup"><span data-stu-id="f10d2-242">To monitor transactional commands that are waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="f10d2-243">Создайте соединение с распространителем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-243">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="f10d2-244">Получите объект <xref:Microsoft.SqlServer.Replication.PublicationMonitor> одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-244">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="f10d2-245">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="f10d2-245">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="f10d2-246">Задайте для публикации свойства <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>и <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> , а также установите созданное на шаге 1 соединение <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> в качестве значения для свойства <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-246">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="f10d2-247">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-247">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="f10d2-248">Если этот метод возвращает `false`, то либо свойства публикации были определены неверно, либо публикация не существует.</span><span class="sxs-lookup"><span data-stu-id="f10d2-248">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="f10d2-249">Из коллекции <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> , доступ к которой был получен с помощью свойства <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> существующего объекта <xref:Microsoft.SqlServer.Replication.PublisherMonitor> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-249">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="f10d2-250">Выполните метод <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> , который возвращает объект <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-250">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> method, which returns a <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object.</span></span>  
  
4.  <span data-ttu-id="f10d2-251">Используйте свойства этого объекта <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> для определения примерного количества команд, ожидающих выполнения, и необходимого времени для завершения их доставки.</span><span class="sxs-lookup"><span data-stu-id="f10d2-251">Use the properties of this <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object to determine the estimated number of pending commands and the length of time it will take to complete the delivery of these commands.</span></span>  
  
#### <a name="to-set-the-monitor-warning-thresholds-for-a-publication"></a><span data-ttu-id="f10d2-252">Мониторинг пороговых значений предупреждений для публикации</span><span class="sxs-lookup"><span data-stu-id="f10d2-252">To set the monitor warning thresholds for a publication</span></span>  
  
1.  <span data-ttu-id="f10d2-253">Создайте соединение с распространителем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-253">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="f10d2-254">Получите объект <xref:Microsoft.SqlServer.Replication.PublicationMonitor> одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="f10d2-254">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="f10d2-255">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="f10d2-255">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="f10d2-256">Задайте для публикации свойства <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>и <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> , а также установите созданное на шаге 1 соединение <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> в качестве значения для свойства <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-256">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="f10d2-257">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-257">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="f10d2-258">Если этот метод возвращает `false`, то либо свойства публикации были определены неверно, либо публикация не существует.</span><span class="sxs-lookup"><span data-stu-id="f10d2-258">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="f10d2-259">Из коллекции <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> , доступ к которой был получен с помощью свойства <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> существующего объекта <xref:Microsoft.SqlServer.Replication.PublisherMonitor> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-259">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="f10d2-260">Вызовите метод <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-260">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> method.</span></span> <span data-ttu-id="f10d2-261">Запомните текущие пороговые значения в возвращаемом списке <xref:System.Collections.ArrayList> объектов <xref:Microsoft.SqlServer.Replication.MonitorThreshold> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-261">Note the current threshold settings in the returned <xref:System.Collections.ArrayList> of <xref:Microsoft.SqlServer.Replication.MonitorThreshold> objects.</span></span>  
  
4.  <span data-ttu-id="f10d2-262">Вызовите метод <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> .</span><span class="sxs-lookup"><span data-stu-id="f10d2-262">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> method.</span></span> <span data-ttu-id="f10d2-263">Передайте следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="f10d2-263">Pass the following parameters:</span></span>  
  
    -   <span data-ttu-id="f10d2-264">*metricID* — это значение <xref:System.Int32> , представляющее пороговую метрику из следующей таблицы.</span><span class="sxs-lookup"><span data-stu-id="f10d2-264">*metricID* - an <xref:System.Int32> value that represents the monitoring threshold metric from the following table:</span></span>  
  
        |<span data-ttu-id="f10d2-265">Значение</span><span class="sxs-lookup"><span data-stu-id="f10d2-265">Value</span></span>|<span data-ttu-id="f10d2-266">Описание</span><span class="sxs-lookup"><span data-stu-id="f10d2-266">Description</span></span>|  
        |-----------|-----------------|  
        |<span data-ttu-id="f10d2-267">1</span><span class="sxs-lookup"><span data-stu-id="f10d2-267">1</span></span>|<span data-ttu-id="f10d2-268">`expiration` следит за приближающимся истечением срока подписки на публикации транзакций.</span><span class="sxs-lookup"><span data-stu-id="f10d2-268">`expiration` - monitors for imminent expiration of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="f10d2-269">2</span><span class="sxs-lookup"><span data-stu-id="f10d2-269">2</span></span>|<span data-ttu-id="f10d2-270">`latency` следит за производительностью подписки на публикации транзакций.</span><span class="sxs-lookup"><span data-stu-id="f10d2-270">`latency` - monitors for the performance of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="f10d2-271">4</span><span class="sxs-lookup"><span data-stu-id="f10d2-271">4</span></span>|<span data-ttu-id="f10d2-272">`mergeexpiration` следит за приближающимся истечением срока подписки на публикации слиянием.</span><span class="sxs-lookup"><span data-stu-id="f10d2-272">`mergeexpiration` - monitors for imminent expiration of subscriptions to merge publications.</span></span>|  
        |<span data-ttu-id="f10d2-273">5</span><span class="sxs-lookup"><span data-stu-id="f10d2-273">5</span></span>|<span data-ttu-id="f10d2-274">`mergeslowrunduration` — следит за продолжительностью синхронизаций слиянием через соединения с низкой пропускной способностью (коммутируемые).</span><span class="sxs-lookup"><span data-stu-id="f10d2-274">`mergeslowrunduration` - monitors the duration of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
        |<span data-ttu-id="f10d2-275">6</span><span class="sxs-lookup"><span data-stu-id="f10d2-275">6</span></span>|<span data-ttu-id="f10d2-276">`mergefastrunduration` следит за длительностью синхронизации слиянием через соединения с высокой пропускной способностью (локальная сеть).</span><span class="sxs-lookup"><span data-stu-id="f10d2-276">`mergefastrunduration` - monitors the duration of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="f10d2-277">7</span><span class="sxs-lookup"><span data-stu-id="f10d2-277">7</span></span>|<span data-ttu-id="f10d2-278">`mergefastrunspeed` — следит за частотой синхронизаций слиянием через соединения с высокой пропускной способностью (локальная сеть).</span><span class="sxs-lookup"><span data-stu-id="f10d2-278">`mergefastrunspeed` - monitors the synchronization rate of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="f10d2-279">8</span><span class="sxs-lookup"><span data-stu-id="f10d2-279">8</span></span>|<span data-ttu-id="f10d2-280">`mergeslowrunspeed` — следит за частотой синхронизаций слиянием через соединения с низкой пропускной способностью (коммутируемые).</span><span class="sxs-lookup"><span data-stu-id="f10d2-280">`mergeslowrunspeed` - monitors the synchronization rate of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
  
    -   <span data-ttu-id="f10d2-281">*enable* - <xref:System.Boolean> , которое указывает, включен ли этот показатель для данной публикации.</span><span class="sxs-lookup"><span data-stu-id="f10d2-281">*enable* - <xref:System.Boolean> value that indicates whether the metric is enabled for the publication.</span></span>  
  
    -   <span data-ttu-id="f10d2-282">*thresholdValue* — целое значение, определяющее порог.</span><span class="sxs-lookup"><span data-stu-id="f10d2-282">*thresholdValue* - integer value that sets the threshold.</span></span>  
  
    -   <span data-ttu-id="f10d2-283">*shouldAlert* — целочисленное значение, которое указывает, должен ли порог вызывать предупреждение.</span><span class="sxs-lookup"><span data-stu-id="f10d2-283">*shouldAlert* - integer that indicates whether this threshold should generate an alert.</span></span>  
  
  
