---
title: Администрирование агента репликации | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Snapshot Agent, administering
- Log Reader Agent, administering
- Queue Reader Agent, administering
- shared agents [SQL Server replication]
- Merge Agent, administering
- Distribution Agent, administering
- agents [SQL Server replication], administering
- replication cleanup jobs [SQL Server]
- administering replication, agents
- replication [SQL Server], administering
- independent agents [SQL Server replication]
ms.assetid: f27186b8-b1b2-4da0-8b2b-91f632c2ab7e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 99cf9be6b31310e5ae0ebac3c096851ac4f63452
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87657673"
---
# <a name="replication-agent-administration"></a><span data-ttu-id="c3f29-102">Администрирование агента репликации</span><span class="sxs-lookup"><span data-stu-id="c3f29-102">Replication Agent Administration</span></span>
  <span data-ttu-id="c3f29-103">Агенты репликации выполняют многие задачи, связанные с репликацией, включая создание копий схемы и данных, обнаружение обновлений на издателе или подписчике и распространение изменений между серверами.</span><span class="sxs-lookup"><span data-stu-id="c3f29-103">Replication agents carry out many of the tasks associated with replication, including creating copies of schema and data, detecting updates at the Publisher or Subscriber, and propagating changes between servers.</span></span> <span data-ttu-id="c3f29-104">По умолчанию агенты репликации выполняются в рамках отдельных шагов задания агента [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c3f29-104">By default, replication agents run under [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job steps.</span></span> <span data-ttu-id="c3f29-105">Агенты являются обычными исполняемыми приложениями, поэтому их можно вызывать непосредственно из командной строки или пакетных скриптов.</span><span class="sxs-lookup"><span data-stu-id="c3f29-105">The agents are simply executables, so they can also be called directly from the command line and from batch scripts.</span></span> <span data-ttu-id="c3f29-106">Каждый агент репликации поддерживает набор параметров исполнения, используемых для управления его работой. Эти параметры задаются в профиле агента или в командной строке.</span><span class="sxs-lookup"><span data-stu-id="c3f29-106">Each replication agent supports a set of run-time parameters used to control how it runs; these parameters are specified in an agent profile or on the command line.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="c3f29-107">Служба агента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] по умолчанию отключается при установке [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , если только во время установки не будет явно выбран режим автоматического запуска.</span><span class="sxs-lookup"><span data-stu-id="c3f29-107">By default, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent service is disabled when [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is installed unless you explicitly choose to autostart the service during installation.</span></span>  
  
 <span data-ttu-id="c3f29-108">Файлы агента репликации находятся в папке [!INCLUDE[ssInstallPathVar](../../../includes/ssinstallpathvar-md.md)]\COM.</span><span class="sxs-lookup"><span data-stu-id="c3f29-108">Replication agent files are located under [!INCLUDE[ssInstallPathVar](../../../includes/ssinstallpathvar-md.md)]\COM.</span></span> <span data-ttu-id="c3f29-109">В следующей таблице перечислены имена исполняемых объектов и файлов.</span><span class="sxs-lookup"><span data-stu-id="c3f29-109">The following table lists the replication executable names and file names.</span></span> <span data-ttu-id="c3f29-110">Щелкните ссылку для соответствующего агента, чтобы просмотреть информацию о его параметрах.</span><span class="sxs-lookup"><span data-stu-id="c3f29-110">Click the link for an agent to view its parameter reference.</span></span>  
  
|<span data-ttu-id="c3f29-111">Исполняемый объект агента</span><span class="sxs-lookup"><span data-stu-id="c3f29-111">Agent Executable</span></span>|<span data-ttu-id="c3f29-112">Имя файла</span><span class="sxs-lookup"><span data-stu-id="c3f29-112">File Name</span></span>|  
|----------------------|---------------|  
|[<span data-ttu-id="c3f29-113">Replication Snapshot Agent</span><span class="sxs-lookup"><span data-stu-id="c3f29-113">Replication Snapshot Agent</span></span>](replication-snapshot-agent.md)|<span data-ttu-id="c3f29-114">snapshot.exe</span><span class="sxs-lookup"><span data-stu-id="c3f29-114">snapshot.exe</span></span>|  
|[<span data-ttu-id="c3f29-115">Replication Distribution Agent</span><span class="sxs-lookup"><span data-stu-id="c3f29-115">Replication Distribution Agent</span></span>](replication-distribution-agent.md)|<span data-ttu-id="c3f29-116">distrib.exe</span><span class="sxs-lookup"><span data-stu-id="c3f29-116">distrib.exe</span></span>|  
|[<span data-ttu-id="c3f29-117">Агент чтения журнала репликации</span><span class="sxs-lookup"><span data-stu-id="c3f29-117">Replication Log Reader Agent</span></span>](replication-log-reader-agent.md)|<span data-ttu-id="c3f29-118">logread.exe</span><span class="sxs-lookup"><span data-stu-id="c3f29-118">logread.exe</span></span>|  
|[<span data-ttu-id="c3f29-119">Replication Queue Reader Agent</span><span class="sxs-lookup"><span data-stu-id="c3f29-119">Replication Queue Reader Agent</span></span>](replication-queue-reader-agent.md)|<span data-ttu-id="c3f29-120">qrdrsvc.exe</span><span class="sxs-lookup"><span data-stu-id="c3f29-120">qrdrsvc.exe</span></span>|  
|[<span data-ttu-id="c3f29-121">Replication Merge Agent</span><span class="sxs-lookup"><span data-stu-id="c3f29-121">Replication Merge Agent</span></span>](replication-merge-agent.md)|<span data-ttu-id="c3f29-122">replmerg.exe</span><span class="sxs-lookup"><span data-stu-id="c3f29-122">replmerg.exe</span></span>|  
  
 <span data-ttu-id="c3f29-123">Кроме агентов репликации, для репликации существует ряд заданий, выполняющих обслуживание по расписанию и по требованию.</span><span class="sxs-lookup"><span data-stu-id="c3f29-123">In addition to replication agents, replication has a number of jobs that perform scheduled and on-demand maintenance.</span></span>  
  
 <span data-ttu-id="c3f29-124">**Запуск агентов и задания обслуживания**</span><span class="sxs-lookup"><span data-stu-id="c3f29-124">**To run agents and maintenance jobs**</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]<span data-ttu-id="c3f29-125">и монитор репликации: [Запуск и завершение работы агента репликации &#40;SQL Server Management Studio&#41;](start-and-stop-a-replication-agent-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="c3f29-125">and Replication Monitor: [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](start-and-stop-a-replication-agent-sql-server-management-studio.md).</span></span>  
  
-   <span data-ttu-id="c3f29-126">Программирование репликации: [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md)</span><span class="sxs-lookup"><span data-stu-id="c3f29-126">Replication programming: [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md)</span></span>  
  
## <a name="agent-profiles"></a><span data-ttu-id="c3f29-127">Профили агентов</span><span class="sxs-lookup"><span data-stu-id="c3f29-127">Agent Profiles</span></span>  
 <span data-ttu-id="c3f29-128">При настройке репликации на распространителе устанавливается набор профилей агентов.</span><span class="sxs-lookup"><span data-stu-id="c3f29-128">When replication is configured, a set of agent profiles is installed on the Distributor.</span></span> <span data-ttu-id="c3f29-129">Профиль агента содержит набор параметров, используемых при каждом запуске агента: каждый агент регистрируется на распространителе во время запуска и запрашивает параметры в своем профиле.</span><span class="sxs-lookup"><span data-stu-id="c3f29-129">An agent profile contains a set of parameters that are used each time an agent runs: each agent logs in to the Distributor during its startup process and queries for the parameters in its profile.</span></span> <span data-ttu-id="c3f29-130">Служба репликации предоставляет каждому агенту профиль по умолчанию и набор дополнительных предопределенных профилей для агента чтения журнала, агента распространителя и агента слияния.</span><span class="sxs-lookup"><span data-stu-id="c3f29-130">Replication provides a default profile for each agent and additional predefined profiles for the Log Reader Agent, Distribution Agent, and Merge Agent.</span></span> <span data-ttu-id="c3f29-131">Кроме предоставляемых профилей можно создать профили в соответствии с требованиями приложений.</span><span class="sxs-lookup"><span data-stu-id="c3f29-131">In addition to the profiles provided, you can create profiles suited to your application requirements.</span></span> <span data-ttu-id="c3f29-132">Дополнительные сведения см. в статье [Replication Agent Profiles](replication-agent-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="c3f29-132">For more information, see [Replication Agent Profiles](replication-agent-profiles.md).</span></span>  
  
 <span data-ttu-id="c3f29-133">Дополнительные сведения о прямом указании параметров командной строки см. в статье [Основные понятия исполняемых файлов агента репликации](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="c3f29-133">For information about specifying command line parameters directly, see [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
## <a name="monitoring-replication-agents"></a><span data-ttu-id="c3f29-134">Наблюдение за агентами репликации</span><span class="sxs-lookup"><span data-stu-id="c3f29-134">Monitoring Replication Agents</span></span>  
 <span data-ttu-id="c3f29-135">Монитор репликации позволяет просматривать сведения и выполнять задачи, связанные с каждым из агентов репликации.</span><span class="sxs-lookup"><span data-stu-id="c3f29-135">Replication Monitor allows you to view information and perform tasks associated with each replication agent.</span></span> <span data-ttu-id="c3f29-136">В приведенном ниже списке перечислены все агенты, для которых существуют вкладки в мониторе репликации, а также дается ссылка на раздел, где описывается порядок доступа к этим вкладкам.</span><span class="sxs-lookup"><span data-stu-id="c3f29-136">The following list includes each agent, the tabs in the Replication Monitor on which it can be found, and a link to a topic that explains how to access these tabs:</span></span>  
  
-   <span data-ttu-id="c3f29-137">С публикациями в мониторе репликации связаны следующие агенты.</span><span class="sxs-lookup"><span data-stu-id="c3f29-137">The following agents are associated with publications in Replication Monitor:</span></span>  
  
    -   <span data-ttu-id="c3f29-138">агент моментальных снимков</span><span class="sxs-lookup"><span data-stu-id="c3f29-138">Snapshot Agent</span></span>  
  
    -   <span data-ttu-id="c3f29-139">Агент чтения журнала.</span><span class="sxs-lookup"><span data-stu-id="c3f29-139">Log Reader Agent</span></span>  
  
    -   <span data-ttu-id="c3f29-140">Агент чтения очереди.</span><span class="sxs-lookup"><span data-stu-id="c3f29-140">Queue Reader Agent</span></span>  
  
     <span data-ttu-id="c3f29-141">Доступ к сведениям и задачам, связанным с этими агентами, осуществляется на вкладке **агенты** . Дополнительные сведения см. в разделе [Просмотр сведений и выполнение задач с помощью монитора репликации](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="c3f29-141">Access information and tasks associated with these agents through the **Agents** tab. For more information, see [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
-   <span data-ttu-id="c3f29-142">С подписками в мониторе репликации связаны следующие агенты:</span><span class="sxs-lookup"><span data-stu-id="c3f29-142">The following agents are associated with subscriptions in Replication Monitor:</span></span>  
  
    -   <span data-ttu-id="c3f29-143">Агент распространителя</span><span class="sxs-lookup"><span data-stu-id="c3f29-143">Distribution Agent</span></span>  
  
    -   <span data-ttu-id="c3f29-144">Агент слияния.</span><span class="sxs-lookup"><span data-stu-id="c3f29-144">Merge Agent</span></span>  
  
     <span data-ttu-id="c3f29-145">Получить доступ к сведениям и задачам, связанным с этими агентами, можно на следующих вкладках: **Список наблюдения за подписками** (доступна для каждого издателя) или вкладка **Все подписки** (доступна для каждой публикации).</span><span class="sxs-lookup"><span data-stu-id="c3f29-145">Access information and tasks associated with these agents through the following tabs: **Subscription Watch List** (available for each Publisher) or the **All Subscriptions** tab (available for each publication).</span></span> <span data-ttu-id="c3f29-146">Дополнительные сведения см. в статье [Просмотр сведений и выполнение задач с помощью монитора репликации](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="c3f29-146">For more information, see [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
## <a name="independent-and-shared-agents"></a><span data-ttu-id="c3f29-147">Независимые и общие агенты</span><span class="sxs-lookup"><span data-stu-id="c3f29-147">Independent and Shared Agents</span></span>  
 <span data-ttu-id="c3f29-148">Независимым является агент, обслуживающий одну подписку.</span><span class="sxs-lookup"><span data-stu-id="c3f29-148">An independent agent is an agent that services one subscription.</span></span> <span data-ttu-id="c3f29-149">Общий агент обслуживает несколько подписок. Если подпискам, обслуживаемым одним и тем же общим агентом, требуется синхронизация, они по умолчанию ожидают в очереди, пока общий агент обслуживает их по одной.</span><span class="sxs-lookup"><span data-stu-id="c3f29-149">A shared agent services multiple subscriptions; if multiple subscriptions using the same shared agent need to synchronize, by default they wait in a queue, and the shared agent services them one at a time.</span></span> <span data-ttu-id="c3f29-150">При использовании независимых агентов снижается задержка, поскольку агент находится в состоянии готовности в любой момент, когда требуется синхронизация подписки.</span><span class="sxs-lookup"><span data-stu-id="c3f29-150">Latency is reduced when using independent agents because the agent is ready whenever the subscription needs to be synchronized.</span></span> <span data-ttu-id="c3f29-151">В репликациях слиянием всегда используются независимые агенты, в репликациях транзакций независимые агенты используются по умолчанию для публикаций, созданных с помощью мастера создания публикаций (в предыдущих версиях [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]в репликациях транзакций по умолчанию использовались общие агенты).</span><span class="sxs-lookup"><span data-stu-id="c3f29-151">Merge replication always uses independent agents, and transactional replication uses independent agents by default for publications created in the New Publication Wizard (in previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], transactional replication used shared agents by default).</span></span>  
  
## <a name="replication-maintenance-jobs"></a><span data-ttu-id="c3f29-152">Задания обслуживания репликации</span><span class="sxs-lookup"><span data-stu-id="c3f29-152">Replication Maintenance Jobs</span></span>  
 <span data-ttu-id="c3f29-153">Следующие задания используются службой репликаций для выполнения обслуживания по расписанию или обслуживания по требованию.</span><span class="sxs-lookup"><span data-stu-id="c3f29-153">Replication uses the following jobs to perform scheduled and on-demand maintenance.</span></span>  
  
|<span data-ttu-id="c3f29-154">Очистка задания</span><span class="sxs-lookup"><span data-stu-id="c3f29-154">Clean up job</span></span>|<span data-ttu-id="c3f29-155">Описание</span><span class="sxs-lookup"><span data-stu-id="c3f29-155">Description</span></span>|<span data-ttu-id="c3f29-156">Расписание по умолчанию</span><span class="sxs-lookup"><span data-stu-id="c3f29-156">Default schedule</span></span>|  
|------------------|-----------------|----------------------|  
|<span data-ttu-id="c3f29-157">Очистка журнала агента: Distribution</span><span class="sxs-lookup"><span data-stu-id="c3f29-157">Agent History Clean Up: Distribution</span></span>|<span data-ttu-id="c3f29-158">Удаляется журнал агента репликации из базы данных распространителя.</span><span class="sxs-lookup"><span data-stu-id="c3f29-158">Removes replication agent history from the distribution database.</span></span>|<span data-ttu-id="c3f29-159">Запускается каждые десять минут</span><span class="sxs-lookup"><span data-stu-id="c3f29-159">Runs every ten minutes</span></span>|  
|<span data-ttu-id="c3f29-160">Очистка распространения: Distribution</span><span class="sxs-lookup"><span data-stu-id="c3f29-160">Distribution Clean Up: Distribution</span></span>|<span data-ttu-id="c3f29-161">Удаляются реплицированные транзакции из базы данных распространителя.</span><span class="sxs-lookup"><span data-stu-id="c3f29-161">Removes replicated transactions from the distribution database.</span></span> <span data-ttu-id="c3f29-162">Деактивируются подписки, которые не были синхронизированы в течение максимального срока хранения распространения.</span><span class="sxs-lookup"><span data-stu-id="c3f29-162">Deactivates subscriptions that have not been synchronized within the maximum distribution retention period.</span></span>|<span data-ttu-id="c3f29-163">Запускается каждые десять минут</span><span class="sxs-lookup"><span data-stu-id="c3f29-163">Runs every ten minutes</span></span>|  
|<span data-ttu-id="c3f29-164">Очистка истекшей подписки</span><span class="sxs-lookup"><span data-stu-id="c3f29-164">Expired Subscription Clean Up</span></span>|<span data-ttu-id="c3f29-165">Обнаруживаются и удаляются подписки с истекшим сроком из баз данных публикации.</span><span class="sxs-lookup"><span data-stu-id="c3f29-165">Detects and removes expired subscriptions from publication databases.</span></span>|<span data-ttu-id="c3f29-166">Запускается каждый день в 1:00.</span><span class="sxs-lookup"><span data-stu-id="c3f29-166">Runs every day at 1:00 A.M.</span></span>|  
|<span data-ttu-id="c3f29-167">Повторная инициализация подписок, имеющих сбои при выполнении проверки данных</span><span class="sxs-lookup"><span data-stu-id="c3f29-167">Reinitialize Subscriptions Having Data Validation Failures</span></span>|<span data-ttu-id="c3f29-168">Обнаруживаются все подписки со сбоями при выполнении проверки данных, и они помечаются для повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="c3f29-168">Detects all subscriptions that have data validation failures and marks them for reinitialization.</span></span> <span data-ttu-id="c3f29-169">При следующем запуске агента слияния или агента распространителя к подписчикам применяется новый моментальный снимок.</span><span class="sxs-lookup"><span data-stu-id="c3f29-169">The next time the Merge Agent or Distribution Agent runs, a new snapshot will be applied at the Subscribers.</span></span>|<span data-ttu-id="c3f29-170">Нет расписания по умолчанию (по умолчанию отключено).</span><span class="sxs-lookup"><span data-stu-id="c3f29-170">No default schedule (not enabled by default).</span></span>|  
|<span data-ttu-id="c3f29-171">Проверка агентов репликации</span><span class="sxs-lookup"><span data-stu-id="c3f29-171">Replication Agents Checkup</span></span>|<span data-ttu-id="c3f29-172">Обнаруживаются агенты репликации, которые не регистрируют свои действия в журнале.</span><span class="sxs-lookup"><span data-stu-id="c3f29-172">Detects replication agents that are not actively logging history.</span></span> <span data-ttu-id="c3f29-173">В журнале событий [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows делается запись, если при выполнении шага задания происходит сбой.</span><span class="sxs-lookup"><span data-stu-id="c3f29-173">It writes to the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows event log if a job step fails.</span></span>|<span data-ttu-id="c3f29-174">Запускается каждые десять минут.</span><span class="sxs-lookup"><span data-stu-id="c3f29-174">Runs every ten minutes.</span></span>|  
|<span data-ttu-id="c3f29-175">Обновитель наблюдения репликации для распространения</span><span class="sxs-lookup"><span data-stu-id="c3f29-175">Replication monitoring refresher for distribution</span></span>|<span data-ttu-id="c3f29-176">Обновляет кэшированные запросы, используемые монитором репликации.</span><span class="sxs-lookup"><span data-stu-id="c3f29-176">Refreshes cached queries used by Replication Monitor..</span></span>|<span data-ttu-id="c3f29-177">Выполняется постоянно.</span><span class="sxs-lookup"><span data-stu-id="c3f29-177">Runs continuously.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c3f29-178">См. также:</span><span class="sxs-lookup"><span data-stu-id="c3f29-178">See Also</span></span>  
 [<span data-ttu-id="c3f29-179">Наблюдение за репликацией</span><span class="sxs-lookup"><span data-stu-id="c3f29-179">Monitoring Replication</span></span>](../monitoring-replication.md)  
  
  
