---
title: Параметризованные фильтры строк | Документация Майкрософт
ms.custom: ''
ms.date: 06/02/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], dynamic filters
- merge replication [SQL Server replication], dynamic filters
- parameterized filters [SQL Server replication]
- filters [SQL Server replication], dynamic
- merge replication parameterized filters [SQL Server replication]
- publications [SQL Server replication], parameterized filters
- parameterized filters [SQL Server replication], about parameterized filters
- filters [SQL Server replication], parameterized
- dynamic filters [SQL Server replication]
ms.assetid: b48a6825-068f-47c8-afdc-c83540da4639
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: a293d5dfc6bfbdf66afb680f0604117e2cc02b2d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655084"
---
# <a name="parameterized-row-filters"></a><span data-ttu-id="da1d0-102">Parameterized Row Filters</span><span class="sxs-lookup"><span data-stu-id="da1d0-102">Parameterized Row Filters</span></span>
  <span data-ttu-id="da1d0-103">Параметризованные фильтры строк (в предыдущих версиях [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]они назывались динамическими фильтрами) позволяют отсылать разным подписчикам разные секции данных, что исключает необходимость создания множества публикаций.</span><span class="sxs-lookup"><span data-stu-id="da1d0-103">Parameterized row filters allow different partitions of data to be sent to different Subscribers without requiring multiple publications to be created (parameterized filters were referred to as dynamic filters in previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]).</span></span> <span data-ttu-id="da1d0-104">Секция — это подмножество строк таблицы; в зависимости от настроек, выбранных при создании параметризованного фильтра строк, каждая строка в опубликованной таблице может принадлежать только одной секции (что порождает неперекрывающиеся секции) или двум и более секциям (что порождает перекрывающиеся секции).</span><span class="sxs-lookup"><span data-stu-id="da1d0-104">A partition is a subset of the rows in a table; depending on the settings chosen when creating a parameterized row filter, each row in a published table can belong to one partition only (which produces nonoverlapping partitions) or to two or more partitions (which produces overlapping partitions).</span></span>  
  
 <span data-ttu-id="da1d0-105">Неперекрывающиеся секции могут использоваться подписками совместно или могут быть ограничены так, что только одна подписка получит данную секцию.</span><span class="sxs-lookup"><span data-stu-id="da1d0-105">Nonoverlapping partitions can be shared among subscriptions or they can be restricted so that only one subscription receives a given partition.</span></span> <span data-ttu-id="da1d0-106">Параметры управления поведением секции описаны в подразделе «Использование подходящих параметров фильтрации» далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="da1d0-106">The settings that control partition behavior are described in "Using the Appropriate Filtering Options" later in this topic.</span></span> <span data-ttu-id="da1d0-107">Используя эти настройки, можно управлять параметризованной фильтрацией в соответствии с требованиями производительности и приложения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-107">Using these settings you can tailor parameterized filtering according to application and performance requirements.</span></span> <span data-ttu-id="da1d0-108">Как правило, перекрывающиеся секции предоставляют большую гибкость, а неперекрывающиеся секции, реплицируемые в одну подписку, — более высокую производительность.</span><span class="sxs-lookup"><span data-stu-id="da1d0-108">In general, overlapping partitions allow for greater flexibility, and nonoverlapping partitions replicated to a single subscription provide better performance.</span></span>  
  
 <span data-ttu-id="da1d0-109">Параметризованные фильтры применяются к одиночной таблице и обычно комбинируются с фильтрами соединения для распространения фильтрования на связанные таблицы.</span><span class="sxs-lookup"><span data-stu-id="da1d0-109">Parameterized filters are used on a single table and are typically combined with join filters to extend filtering to related tables.</span></span> <span data-ttu-id="da1d0-110">Дополнительные сведения см. в статье [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-110">For more information, see [Join Filters](join-filters.md).</span></span>  
  
 <span data-ttu-id="da1d0-111">Чтобы задать или изменить параметризованный фильтр строк, см. раздел [Определение и изменение параметризованного фильтра строк для статьи публикации слиянием](../publish/define-and-modify-a-parameterized-row-filter-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-111">To define or modify a parameterized row filter, see [Define and Modify a Parameterized Row Filter for a Merge Article](../publish/define-and-modify-a-parameterized-row-filter-for-a-merge-article.md).</span></span>  
  
## <a name="how-parameterized-filters-work"></a><span data-ttu-id="da1d0-112">Как работают параметризованные фильтры</span><span class="sxs-lookup"><span data-stu-id="da1d0-112">How Parameterized Filters Work</span></span>  
 <span data-ttu-id="da1d0-113">Параметризованный фильтр строк использует предложение WHERE, чтобы выбрать нужные для публикации данные.</span><span class="sxs-lookup"><span data-stu-id="da1d0-113">A parameterized row filter uses a WHERE clause to select the appropriate data to be published.</span></span> <span data-ttu-id="da1d0-114">Вместо того чтобы задавать буквенное значение в предложении (как для статического фильтра строк), вы указываете одну или обе системные функции: SUSER_SNAME() и HOST_NAME().</span><span class="sxs-lookup"><span data-stu-id="da1d0-114">Rather than specifying a literal value in the clause (as you do with a static row filter), you specify one or both of the following system functions: SUSER_SNAME() and HOST_NAME().</span></span> <span data-ttu-id="da1d0-115">Можно использовать и пользовательские функции, но они должны содержать в своем теле SUSER_SNAME() или HOST_NAME() либо вычислять одну из этих системных функций (например, `MyUDF(SUSER_SNAME()`).</span><span class="sxs-lookup"><span data-stu-id="da1d0-115">User-defined functions can also be used, but they must include SUSER_SNAME() or HOST_NAME() in the body of the function, or evaluate one of these system functions (such as `MyUDF(SUSER_SNAME()`).</span></span> <span data-ttu-id="da1d0-116">Если пользовательская функция содержит в своем теле SUSER_SNAME() или HOST_NAME(), функции невозможно передать параметры.</span><span class="sxs-lookup"><span data-stu-id="da1d0-116">If a user-defined function includes SUSER_SNAME() or HOST_NAME() in the body of the function, you cannot pass parameters to the function.</span></span>  
  
 <span data-ttu-id="da1d0-117">Системные функции SUSER_SNAME() и HOST_NAME() не характерны для репликации слиянием, но они используются репликацией слиянием для параметризованной фильтрации.</span><span class="sxs-lookup"><span data-stu-id="da1d0-117">The system functions SUSER_SNAME() and HOST_NAME() are not specific to merge replication, but they are used by merge replication for parameterized filtering:</span></span>  
  
-   <span data-ttu-id="da1d0-118">Функция SUSER_SNAME() возвращает сведения об именах входа для соединений с экземпляром [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da1d0-118">SUSER_SNAME() returns login information for connections made to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="da1d0-119">При использовании в параметризованном фильтре функция возвращает имя входа, используемое агентом слияния для подключения к издателю (имя входа указывается, когда создается подписка).</span><span class="sxs-lookup"><span data-stu-id="da1d0-119">When used in a parameterized filter, it returns the login used by the Merge Agent to connect to the Publisher (you specify a login when you create a subscription).</span></span>  
  
-   <span data-ttu-id="da1d0-120">HOST_NAME() возвращает имя компьютера, подключающегося к экземпляру [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da1d0-120">HOST_NAME() returns the name of the computer that is connecting to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="da1d0-121">По умолчанию при использовании в параметризованном фильтре она возвращает имя компьютера, на котором запущен агент слияния.</span><span class="sxs-lookup"><span data-stu-id="da1d0-121">When used in a parameterized filter, by default it returns the name of the computer on which the Merge Agent is running.</span></span> <span data-ttu-id="da1d0-122">Для подписки по запросу это имя подписчика; для принудительной подписки это имя распространителя.</span><span class="sxs-lookup"><span data-stu-id="da1d0-122">For pull subscriptions it is the name of the Subscriber; for push subscriptions it is the name of the Distributor.</span></span>  
  
     <span data-ttu-id="da1d0-123">Можно также переопределить эту функцию с помощью значения, отличного от имени подписчика и распространителя.</span><span class="sxs-lookup"><span data-stu-id="da1d0-123">It is also possible to override this function with a value other than the name of the Subscriber or Distributor.</span></span> <span data-ttu-id="da1d0-124">Обычно приложения переопределяют данную функцию на более осмысленные значения, например имя или идентификатор менеджера по продажам.</span><span class="sxs-lookup"><span data-stu-id="da1d0-124">Typically applications override this function with more meaningful values, such as a salesperson name or salesperson ID.</span></span> <span data-ttu-id="da1d0-125">Дополнительные сведения см. в подразделе «Переопределение значения HOST_NAME()» далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="da1d0-125">For more information, see the section "Overriding the HOST_NAME() Value" in this topic.</span></span>  
  
 <span data-ttu-id="da1d0-126">Возвращаемое системной функцией значение сравнивается со столбцом, указываемым в фильтруемой таблице, и соответствующие данные загружаются на подписчик.</span><span class="sxs-lookup"><span data-stu-id="da1d0-126">The value returned by the system function is compared to a column you specify in the table you are filtering, and the appropriate data is downloaded to the Subscriber.</span></span> <span data-ttu-id="da1d0-127">Сравнение производится при инициализации подписки (поэтому в исходном моментальном снимке содержатся только подходящие данные) и при каждой синхронизации подписки.</span><span class="sxs-lookup"><span data-stu-id="da1d0-127">This comparison is made when the subscription is initialized (so only the appropriate data is contained in the initial snapshot) and every time the subscription is synchronized.</span></span> <span data-ttu-id="da1d0-128">По умолчанию, если изменение на издателе приводит к перемещению строки из секции, строка удаляется на подписчике (это поведение управляется с помощью **@allow_partition_realignment** параметра [Sp_addmergepublication &#40;TRANSACT-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="da1d0-128">By default, if a change at the Publisher results in a row being moved out of a partition, the row is deleted at the Subscriber (this behavior is controlled using the **@allow_partition_realignment** parameter of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql)).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="da1d0-129">Когда для параметризованных фильтров производится сравнение, всегда используется порядок следования базы данных.</span><span class="sxs-lookup"><span data-stu-id="da1d0-129">When comparisons are made for parameterized filters, the database collation is always used.</span></span> <span data-ttu-id="da1d0-130">Например, если порядок следования в базе данных не зависит от регистра символов, а порядок следования в таблице или столбце зависит от регистра символов, то сравнение не будет зависеть от регистра символов.</span><span class="sxs-lookup"><span data-stu-id="da1d0-130">For example, if the database collation is case insensitive, but the table or column collation is case sensitive, the comparison will be case insensitive.</span></span>  
  
### <a name="filtering-with-suser_sname"></a><span data-ttu-id="da1d0-131">Фильтрация с помощью SUSER_SNAME()</span><span class="sxs-lookup"><span data-stu-id="da1d0-131">Filtering with SUSER_SNAME()</span></span>  
 <span data-ttu-id="da1d0-132">Рассмотрим **таблицу Employee** в образце базы данных [!INCLUDE[ssSampleDBCoShort](../../../includes/sssampledbcoshort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="da1d0-132">Consider the **Employee Table** in the [!INCLUDE[ssSampleDBCoShort](../../../includes/sssampledbcoshort-md.md)] sample database.</span></span> <span data-ttu-id="da1d0-133">Эта таблица содержит столбец **LoginID**, содержащий имя входа каждого сотрудника в формате*Домен\ИмяВхода*.</span><span class="sxs-lookup"><span data-stu-id="da1d0-133">This table includes the column **LoginID**, which contains the login for each employee in the form '*domain\login*'.</span></span> <span data-ttu-id="da1d0-134">Чтобы отфильтровать эту таблицу таким образом, чтобы сотрудникам были доступны только относящиеся к ним данные, укажите следующее предложение фильтрации:</span><span class="sxs-lookup"><span data-stu-id="da1d0-134">To filter this table so that employees receive only the data related to them, specify a filter clause of:</span></span>  
  
```  
LoginID = SUSER_SNAME()  
```  
  
 <span data-ttu-id="da1d0-135">Например, для одного из сотрудников значение равно adventure-works\john5.</span><span class="sxs-lookup"><span data-stu-id="da1d0-135">For example, the value for one of the employees is 'adventure-works\john5'.</span></span> <span data-ttu-id="da1d0-136">Когда агент слияния подключается к издателю, он использует имя входа, указываемое при создании подписки (в данном случает adventure-works\john5).</span><span class="sxs-lookup"><span data-stu-id="da1d0-136">When the Merge Agent connects to the Publisher, it uses the login you specified when creating the subscription (in this case 'adventure-works\john5').</span></span> <span data-ttu-id="da1d0-137">Затем агент слияния сравнивает значение, возвращаемое SUSER_SNAME(), со значениями в таблице и загружает только ту строку, которая содержит в столбце **LoginID** значение adventure-works\john5.</span><span class="sxs-lookup"><span data-stu-id="da1d0-137">The Merge Agent then compares the value returned by SUSER_SNAME() to the values in the table and downloads only the row that contains a value of 'adventure-works\john5' in the **LoginID** column.</span></span>  
  
### <a name="filtering-with-host_name"></a><span data-ttu-id="da1d0-138">Фильтрация с помощью HOST_NAME()</span><span class="sxs-lookup"><span data-stu-id="da1d0-138">Filtering with HOST_NAME()</span></span>  
 <span data-ttu-id="da1d0-139">Рассмотрим таблицу **HumanResources.Employee** .</span><span class="sxs-lookup"><span data-stu-id="da1d0-139">Consider the **HumanResources.Employee** table.</span></span> <span data-ttu-id="da1d0-140">Предположим, в этой таблице столбец **ComputerName** содержит имя компьютера каждого из сотрудников в формате*Имя_Тип*.</span><span class="sxs-lookup"><span data-stu-id="da1d0-140">Suppose this table contained a column such as **ComputerName** with the name of each employee's computer in the form '*name_computertype*'.</span></span> <span data-ttu-id="da1d0-141">Чтобы отфильтровать эту таблицу таким образом, чтобы сотрудникам были доступны только относящиеся к ним данные, укажите следующее предложение фильтрации:</span><span class="sxs-lookup"><span data-stu-id="da1d0-141">To filter this table so that employees receive only the data related to them, specify a filter clause of:</span></span>  
  
```  
ComputerName = HOST_NAME()  
```  
  
 <span data-ttu-id="da1d0-142">Например, для одного из работников значение равно john5_laptop.</span><span class="sxs-lookup"><span data-stu-id="da1d0-142">For example, the value for one of the employees could be 'john5_laptop'.</span></span> <span data-ttu-id="da1d0-143">Когда агент слияния подключается к издателю, он сравнивает значение, возвращаемое HOST_NAME(), со значениями в таблице, и загружает только ту строку, которая содержит в столбце **ComputerName** значение john5_laptop.</span><span class="sxs-lookup"><span data-stu-id="da1d0-143">When the Merge Agent connects to the Publisher, it compares the value returned by HOST_NAME() to the values in the table and downloads only the row that contains a value of 'john5_laptop' in the **ComputerName** column.</span></span>  
  
 <span data-ttu-id="da1d0-144">В фильтре можно также комбинировать функции.</span><span class="sxs-lookup"><span data-stu-id="da1d0-144">It is also possible to combine the functions in a filter.</span></span> <span data-ttu-id="da1d0-145">Например, если бы требовалось обеспечить, чтобы сотрудник получал данные только при вводе на компьютере своего имени входа, могло бы использоваться следующее предложение фильтра:</span><span class="sxs-lookup"><span data-stu-id="da1d0-145">For example, if you wanted to ensure that an employee received data only if they used their login on their computer, the filter clause could be:</span></span>  
  
```  
LoginID = SUSER_SNAME() AND ComputerName = HOST_NAME()  
```  
  
 <span data-ttu-id="da1d0-146">Если значение HOST_NAME() не переопределяется, фильтрация с помощью HOST_NAME() используется обычно только с подписками по запросу.</span><span class="sxs-lookup"><span data-stu-id="da1d0-146">Unless you are overriding the HOST_NAME() value, filtering with HOST_NAME() is typically used only with pull subscriptions.</span></span> <span data-ttu-id="da1d0-147">Значение, возвращаемое функцией — это имя компьютера, на котором выполняется агент слияния.</span><span class="sxs-lookup"><span data-stu-id="da1d0-147">The value returned by the function is the name of the computer on which the Merge Agent is running.</span></span> <span data-ttu-id="da1d0-148">Для подписок по запросу значение отличается для каждой подписки, а для принудительных подписок значения одинаковы (все агенты слияния запускаются на распространителе для принудительных подписок).</span><span class="sxs-lookup"><span data-stu-id="da1d0-148">For pull subscriptions, the value is different for each subscription, but for push subscriptions, the value is the same (all Merge Agents run at the Distributor for push subscriptions).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="da1d0-149">Значение функции HOST_NAME() может быть переопределено, поэтому фильтры, содержащие HOST_NAME(), нельзя использовать для управления доступом к секциям данных.</span><span class="sxs-lookup"><span data-stu-id="da1d0-149">The value for the HOST_NAME() function can be overridden; therefore it is not possible to use filters that include HOST_NAME() to control access to partitions of data.</span></span> <span data-ttu-id="da1d0-150">Для управления доступом к секциям данных используйте функции SUSER_SNAME(), SUSER_SNAME() вместе с HOST_NAME() или статические строковые фильтры.</span><span class="sxs-lookup"><span data-stu-id="da1d0-150">To control access to partitions of data, use SUSER_SNAME(), SUSER_SNAME() in combination with HOST_NAME(), or use static row filters.</span></span>  
  
#### <a name="overriding-the-host_name-value"></a><span data-ttu-id="da1d0-151">Переопределение значения HOST_NAME()</span><span class="sxs-lookup"><span data-stu-id="da1d0-151">Overriding the HOST_NAME() Value</span></span>  
 <span data-ttu-id="da1d0-152">Как упоминалось ранее, по умолчанию HOST_NAME() возвращает имя компьютера, подключающегося к экземпляру [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da1d0-152">As noted earlier, HOST_NAME() by default returns the name of the computer that is connecting to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="da1d0-153">Если используются параметризованные фильтры, это значение обычно переопределяется путем указания значения при создании подписки.</span><span class="sxs-lookup"><span data-stu-id="da1d0-153">When using parameterized filters, it is common to override this value by supplying a value when you create a subscription.</span></span> <span data-ttu-id="da1d0-154">В этом случае функция HOST_NAME() будет возвращать указанное значение вместо имени компьютера.</span><span class="sxs-lookup"><span data-stu-id="da1d0-154">The HOST_NAME() function then returns the value you specify rather than the name of the computer.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="da1d0-155">Если переопределить функцию HOST_NAME(), все вызовы этой функции будут возвращать указанное значение.</span><span class="sxs-lookup"><span data-stu-id="da1d0-155">If you override HOST_NAME(), all calls to the HOST_NAME() function will return the value you specify.</span></span> <span data-ttu-id="da1d0-156">Убедитесь, что другие приложения не зависят от того, возвращает ли функция HOST_NAME() имя компьютера.</span><span class="sxs-lookup"><span data-stu-id="da1d0-156">Ensure that other applications are not depending on HOST_NAME() returning the computer name.</span></span>  
  
 <span data-ttu-id="da1d0-157">Рассмотрим таблицу **HumanResources.Employee** .</span><span class="sxs-lookup"><span data-stu-id="da1d0-157">Consider the **HumanResources.Employee** table.</span></span> <span data-ttu-id="da1d0-158">Эта таблица включает в себя столбец **EmployeeID**.</span><span class="sxs-lookup"><span data-stu-id="da1d0-158">This table includes the column **EmployeeID**.</span></span> <span data-ttu-id="da1d0-159">Для фильтрации этой таблицы так, чтобы каждый сотрудник получал только данные, относящиеся к нему, укажите следующее предложение фильтра:</span><span class="sxs-lookup"><span data-stu-id="da1d0-159">To filter this table so that each employee receives only the data related to them, specify a filter clause of:</span></span>  
  
 `EmployeeID = CONVERT(int,HOST_NAME())`  
  
 <span data-ttu-id="da1d0-160">Например, сотруднику Pamela Ansman-Wolfe присвоен идентификационный номер 280.</span><span class="sxs-lookup"><span data-stu-id="da1d0-160">For example, employee Pamela Ansman-Wolfe has been assigned an employee ID of 280.</span></span> <span data-ttu-id="da1d0-161">При создании подписки для этого сотрудника задайте значение идентификационного номера (в данном примере это 280) в качестве значения функции HOST_NAME().</span><span class="sxs-lookup"><span data-stu-id="da1d0-161">Specify the value of the employee ID (280 in our example) for the HOST_NAME() value when creating a subscription for this employee.</span></span> <span data-ttu-id="da1d0-162">Когда агент слияния подключается к издателю, он сравнивает значение, возвращаемое функцией HOST_NAME(), со значениями в таблице и загружает только ту строку, которая содержит в столбце **EmployeeID** значение 280.</span><span class="sxs-lookup"><span data-stu-id="da1d0-162">When the Merge Agent connects to the Publisher, it compares the value returned by HOST_NAME() to the values in the table and downloads only the row that contains a value of 280 in the **EmployeeID** column.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="da1d0-163">Функция HOST_NAME() возвращает значение типа `nchar`, поэтому следует использовать CONVERT, если столбец в предложении фильтра имеет числовой тип (как в приведенном выше примере).</span><span class="sxs-lookup"><span data-stu-id="da1d0-163">The HOST_NAME() function returns an `nchar` value, so you must use CONVERT if the column in the filter clause is of a numeric data type, as it is in the example above.</span></span> <span data-ttu-id="da1d0-164">Из соображений производительности функции к именам столбцов в предложениях параметризованных фильтров строк применять не рекомендуется, например: `CONVERT(nchar,EmployeeID) = HOST_NAME()`.</span><span class="sxs-lookup"><span data-stu-id="da1d0-164">For performance reasons, we recommended that you do not apply functions to column names in parameterized row filter clauses, such as `CONVERT(nchar,EmployeeID) = HOST_NAME()`.</span></span> <span data-ttu-id="da1d0-165">Вместо этого рекомендуется использовать показанный в примере подход: `EmployeeID = CONVERT(int,HOST_NAME())`.</span><span class="sxs-lookup"><span data-stu-id="da1d0-165">Instead, we recommend using the approach shown in the example: `EmployeeID = CONVERT(int,HOST_NAME())`.</span></span> <span data-ttu-id="da1d0-166">Это предложение можно использовать для **@subset_filterclause** параметра [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), но обычно его нельзя использовать в мастере создания публикаций (мастер выполняет предложение фильтра для его проверки, что приведет к сбою, поскольку имя компьютера не может быть преобразовано в `int` ).</span><span class="sxs-lookup"><span data-stu-id="da1d0-166">This clause can be used for the **@subset_filterclause** parameter of [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), but it typically cannot be used in the New Publication Wizard (the wizard executes the filter clause to validate it, which fails because the computer name cannot be converted to an `int`).</span></span> <span data-ttu-id="da1d0-167">В мастере создания публикации рекомендуется указать `CONVERT(nchar,EmployeeID) = HOST_NAME()` , а затем перед созданием моментального снимка публикации воспользоваться функцией [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) для замены предложения на `EmployeeID = CONVERT(int,HOST_NAME())` .</span><span class="sxs-lookup"><span data-stu-id="da1d0-167">If you use the New Publication Wizard, we recommend specifying `CONVERT(nchar,EmployeeID) = HOST_NAME()` in the wizard and then use [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) to change the clause to `EmployeeID = CONVERT(int,HOST_NAME())` before creating a snapshot for the publication.</span></span>  
  
 <span data-ttu-id="da1d0-168">**Переопределение значения HOST_NAME()**</span><span class="sxs-lookup"><span data-stu-id="da1d0-168">**To override the HOST_NAME() value**</span></span>  
  
 <span data-ttu-id="da1d0-169">Используйте один из следующих методов, чтобы переопределить значение HOST_NAME().</span><span class="sxs-lookup"><span data-stu-id="da1d0-169">Use one of the following methods to override the HOST_NAME() value:</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]<span data-ttu-id="da1d0-170">: укажите значение на странице **Значения HOST\_NAME\(\)** мастера создания подписки.</span><span class="sxs-lookup"><span data-stu-id="da1d0-170">: specify a value on the **HOST\_NAME\(\) Values** page of the New Subscription Wizard.</span></span> <span data-ttu-id="da1d0-171">Дополнительные сведения о создании подписок см. в статье [Подписка на публикации](../subscribe-to-publications.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-171">For more information about creating subscriptions, see [Subscribe to Publications](../subscribe-to-publications.md).</span></span>  
  
-   <span data-ttu-id="da1d0-172">[!INCLUDE[tsql](../../../includes/tsql-md.md)]Программирование репликации. Укажите значение для **@hostname** параметра [Sp_addmergesubscription &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql) (для принудительных подписок) или [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) (для подписок по запросу).</span><span class="sxs-lookup"><span data-stu-id="da1d0-172">Replication [!INCLUDE[tsql](../../../includes/tsql-md.md)] programming: specify a value for the **@hostname** parameter of [sp_addmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql) (for push subscriptions) or [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) (for pull subscriptions).</span></span>  
  
-   <span data-ttu-id="da1d0-173">Агент слияния: задайте значение параметра **-Hostname** в командной строке или с помощью профиля агента.</span><span class="sxs-lookup"><span data-stu-id="da1d0-173">Merge Agent: specify a value for the **-Hostname** parameter at the command line or through an agent profile.</span></span> <span data-ttu-id="da1d0-174">Дополнительные сведения об агенте слияния см. в разделе [Replication Merge Agent](../agents/replication-merge-agent.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-174">For more information about the Merge Agent, see [Replication Merge Agent](../agents/replication-merge-agent.md).</span></span> <span data-ttu-id="da1d0-175">Дополнительные сведения о профилях агентов см. в разделе [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-175">For more information about agent profiles, see [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span></span>  
  
## <a name="initializing-a-subscription-to-a-publication-with-parameterized-filters"></a><span data-ttu-id="da1d0-176">Инициализация подписки на публикацию с параметризованными фильтрами</span><span class="sxs-lookup"><span data-stu-id="da1d0-176">Initializing a Subscription to a Publication with Parameterized Filters</span></span>  
 <span data-ttu-id="da1d0-177">Когда в публикации слиянием применяются параметризованные фильтры строк, репликация инициализирует каждую подписку с помощью моментального снимка, состоящего из двух частей.</span><span class="sxs-lookup"><span data-stu-id="da1d0-177">When parameterized row filters are used in merge publications, replication initializes each subscription with a two-part snapshot.</span></span> <span data-ttu-id="da1d0-178">Дополнительные сведения см. в статье [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-178">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
## <a name="using-the-appropriate-filtering-options"></a><span data-ttu-id="da1d0-179">Использование подходящих параметров фильтрации</span><span class="sxs-lookup"><span data-stu-id="da1d0-179">Using the Appropriate Filtering Options</span></span>  
 <span data-ttu-id="da1d0-180">При использовании параметризованных фильтров пользователь управляет двумя ключевыми областями:</span><span class="sxs-lookup"><span data-stu-id="da1d0-180">There are two key areas over which you have control when using parameterized filters:</span></span>  
  
-   <span data-ttu-id="da1d0-181">порядком обработки фильтров репликацией слиянием, которая управляется одной из двух настроек публикации: **use partition groups** и **keep partition changes**;</span><span class="sxs-lookup"><span data-stu-id="da1d0-181">How the filters are processed by merge replication, which is controlled by one of two publication settings: **use partition groups** and **keep partition changes**.</span></span>  
  
-   <span data-ttu-id="da1d0-182">совместным использованием данных подписчиками, которое отражается в настройке статьи **partition options**.</span><span class="sxs-lookup"><span data-stu-id="da1d0-182">How the data is shared among Subscribers, which must be reflected by the article setting **partition options**.</span></span>  
  
 <span data-ttu-id="da1d0-183">Чтобы задать параметры фильтрации, см. раздел [Optimize Parameterized Row Filters](../publish/optimize-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-183">To set filtering options, see [Optimize Parameterized Row Filters](../publish/optimize-parameterized-row-filters.md).</span></span>  
  
### <a name="setting-use-partition-groups-and-keep-partition-changes"></a><span data-ttu-id="da1d0-184">Установка параметров use partition groups и keep partition changes</span><span class="sxs-lookup"><span data-stu-id="da1d0-184">Setting 'use partition groups' and 'keep partition changes'</span></span>  
 <span data-ttu-id="da1d0-185">Оба параметра ( **use partition groups** и **keep partition changes** ) улучшают производительность синхронизации публикаций с фильтрованными статьями путем сохранения дополнительных метаданных в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="da1d0-185">Both the **use partition groups** and **keep partition changes** options improve the synchronization performance for publications with filtered articles by storing additional metadata in the publication database.</span></span> <span data-ttu-id="da1d0-186">Параметр **use partition groups** обеспечивает более высокую производительность за счет использования предварительно вычисляемых секций.</span><span class="sxs-lookup"><span data-stu-id="da1d0-186">The **use partition groups** option provides greater performance improvement through the use of the precomputed partitions feature.</span></span> <span data-ttu-id="da1d0-187">Если статьи публикации соответствуют ряду требований, то по умолчанию этот параметр имеет значение `true`.</span><span class="sxs-lookup"><span data-stu-id="da1d0-187">This option is set to `true` by default if the articles in your publication adhere to a set of requirements.</span></span> <span data-ttu-id="da1d0-188">Дополнительные сведения об этих требованиях см. в статье [Оптимизация производительности параметризованного фильтра с помощью предварительно вычисляемых секций](parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-188">For more information about these requirements, see [Optimize Parameterized Filter Performance with Precomputed Partitions](parameterized-filters-optimize-for-precomputed-partitions.md).</span></span> <span data-ttu-id="da1d0-189">Если статьи не соответствуют требованиям к использованию предварительно вычисленных секций, параметр "не **изменять секцию** " устанавливается в значение `true` .</span><span class="sxs-lookup"><span data-stu-id="da1d0-189">If your articles do not meet the requirements for using precomputed partitions, the **keep partition changes** option to is set to `true`.</span></span>  
  
### <a name="setting-partition-options"></a><span data-ttu-id="da1d0-190">Установка параметра partition options</span><span class="sxs-lookup"><span data-stu-id="da1d0-190">Setting 'partition options'</span></span>  
 <span data-ttu-id="da1d0-191">Значение свойства **partition options** указывается при создании статьи в соответствии с тем, как данные фильтрованной таблицы будут совместно использоваться подписчиками.</span><span class="sxs-lookup"><span data-stu-id="da1d0-191">You specify a value for the **partition options** property when creating an article, according to the way in which data in the filtered table will be shared by Subscribers.</span></span> <span data-ttu-id="da1d0-192">Этому свойству при помощи хранимых процедур [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)и диалогового окна **Свойства статьи** может быть задано одно из четырех значений.</span><span class="sxs-lookup"><span data-stu-id="da1d0-192">The property can be set to one of four values using [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), and the **Article Properties** dialog box.</span></span> <span data-ttu-id="da1d0-193">Свойству можно задать одно из двух значений с помощью диалогов **Добавление фильтра** или **Изменение фильтра** , которые доступны из мастера создания публикаций и диалога **Свойства публикации** .</span><span class="sxs-lookup"><span data-stu-id="da1d0-193">The property can be set to one of two values using the **Add Filter** or **Edit Filter** dialog boxes, which are available from the New Publication Wizard and the **Publication Properties** dialog box.</span></span> <span data-ttu-id="da1d0-194">Следующая таблица содержит сводку возможных значений.</span><span class="sxs-lookup"><span data-stu-id="da1d0-194">The following table summarizes the available values:</span></span>  
  
|<span data-ttu-id="da1d0-195">Description</span><span class="sxs-lookup"><span data-stu-id="da1d0-195">Description</span></span>|<span data-ttu-id="da1d0-196">Значение в диалоговых окнах «Добавить фильтр» и «Изменить фильтр»</span><span class="sxs-lookup"><span data-stu-id="da1d0-196">Value in Add Filter and Edit Filter</span></span>|<span data-ttu-id="da1d0-197">Значение в диалоговом окне «Свойства статьи»</span><span class="sxs-lookup"><span data-stu-id="da1d0-197">Value in Article Properties</span></span>|<span data-ttu-id="da1d0-198">Значение в хранимых процедурах</span><span class="sxs-lookup"><span data-stu-id="da1d0-198">Value in stored procedures</span></span>|  
|-----------------|-----------------------------------------|---------------------------------|--------------------------------|  
|<span data-ttu-id="da1d0-199">Данные в секциях перекрываются, и подписчик может обновлять столбцы, на которые имеются ссылки в параметризованном фильтре.</span><span class="sxs-lookup"><span data-stu-id="da1d0-199">Data in the partitions is overlapping, and the Subscriber can update columns referenced in a parameterized filter.</span></span>|<span data-ttu-id="da1d0-200">**Строка из этой таблицы будет отправлена нескольким подпискам**</span><span class="sxs-lookup"><span data-stu-id="da1d0-200">**A row from this table will go to multiple subscriptions**</span></span>|<span data-ttu-id="da1d0-201">**Перекрывающиеся**</span><span class="sxs-lookup"><span data-stu-id="da1d0-201">**Overlapping**</span></span>|<span data-ttu-id="da1d0-202">**0**</span><span class="sxs-lookup"><span data-stu-id="da1d0-202">**0**</span></span>|  
|<span data-ttu-id="da1d0-203">Данные в секциях перекрываются, и подписчик не может обновить столбцы, на которые имеются ссылки в параметризованном фильтре.</span><span class="sxs-lookup"><span data-stu-id="da1d0-203">Data in the partitions is overlapping, and the Subscriber cannot update columns referenced in a parameterized filter.</span></span>|<span data-ttu-id="da1d0-204">НД<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="da1d0-204">N/A<sup>1</sup></span></span>|<span data-ttu-id="da1d0-205">**Перекрывающиеся, с запретом на изменение данных вне секции**</span><span class="sxs-lookup"><span data-stu-id="da1d0-205">**Overlapping, disallow out-of-partition data changes**</span></span>|<span data-ttu-id="da1d0-206">**1**</span><span class="sxs-lookup"><span data-stu-id="da1d0-206">**1**</span></span>|  
|<span data-ttu-id="da1d0-207">Данные в секциях не перекрываются, и данные используются подписками совместно.</span><span class="sxs-lookup"><span data-stu-id="da1d0-207">Data in the partitions is not overlapping, and the data is shared between subscriptions.</span></span> <span data-ttu-id="da1d0-208">Подписчик не может обновить столбцы, на которые имеются ссылки в параметризованном фильтре.</span><span class="sxs-lookup"><span data-stu-id="da1d0-208">The Subscriber cannot update columns referenced in a parameterized filter.</span></span>|<span data-ttu-id="da1d0-209">НД<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="da1d0-209">N/A<sup>1</sup></span></span>|<span data-ttu-id="da1d0-210">**Неперекрывающиеся, общие для нескольких подписок**</span><span class="sxs-lookup"><span data-stu-id="da1d0-210">**Nonoverlapping, shared between subscriptions**</span></span>|<span data-ttu-id="da1d0-211">**2**</span><span class="sxs-lookup"><span data-stu-id="da1d0-211">**2**</span></span>|  
|<span data-ttu-id="da1d0-212">Данные в секциях не перекрываются, и на каждую секцию приходится одна подписка.</span><span class="sxs-lookup"><span data-stu-id="da1d0-212">Data in the partitions is not overlapping, and there is a single subscription per partition.</span></span> <span data-ttu-id="da1d0-213">Подписчик не может обновить столбцы, на которые имеются ссылки в параметризованном фильтре. <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="da1d0-213">The Subscriber cannot update columns referenced in a parameterized filter.<sup>2</sup></span></span>|<span data-ttu-id="da1d0-214">**Строка из этой таблицы будет отправлена только одной подписке**</span><span class="sxs-lookup"><span data-stu-id="da1d0-214">**A row from this table will go to only one subscription**</span></span>|<span data-ttu-id="da1d0-215">**Неперекрывающаяся, одиночная подписка**</span><span class="sxs-lookup"><span data-stu-id="da1d0-215">**Nonoverlapping, single subscription**</span></span>|<span data-ttu-id="da1d0-216">**3**</span><span class="sxs-lookup"><span data-stu-id="da1d0-216">**3**</span></span>|  
  
 <span data-ttu-id="da1d0-217"><sup>1</sup> если параметр базовой фильтрации имеет значение **0**, или **1**, или **2**, то в диалоговых окнах **Добавление фильтра** и **Изменение фильтра** будет отображаться **строка из этой таблицы, которая будет отправлена нескольким подпискам**.</span><span class="sxs-lookup"><span data-stu-id="da1d0-217"><sup>1</sup> If the underlying filtering option is set to **0**, or **1**, or **2**, the **Add Filter** and **Edit Filter** dialog boxes will display **A row from this table will go to multiple subscriptions**.</span></span>  
  
 <span data-ttu-id="da1d0-218"><sup>2</sup> если указан этот параметр, для каждой секции данных в этой статье может существовать только одна подписка.</span><span class="sxs-lookup"><span data-stu-id="da1d0-218"><sup>2</sup> If you specify this option, there can only be a single subscription for each partition of data in that article.</span></span> <span data-ttu-id="da1d0-219">Если создается вторая подписка, в которой условие фильтрации сводится к той же секции, что и в существующей подписке, то существующая подписка удаляется.</span><span class="sxs-lookup"><span data-stu-id="da1d0-219">If a second subscription is created in which the filtering criterion of the new subscription resolves to the same partition as the existing subscription, the existing subscription is dropped.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="da1d0-220">Значение **partition options** должно быть установлено в соответствии со способом совместного использования данных подписчиками.</span><span class="sxs-lookup"><span data-stu-id="da1d0-220">The **partition options** value must be set according to how data is shared by Subscribers.</span></span> <span data-ttu-id="da1d0-221">Например, если указать, что секция является неперекрывающейся с одной подпиской на секцию, а данные затем обновятся на другом подписчике, то во время синхронизации может произойти сбой агента, и возникнет расхождение в данных.</span><span class="sxs-lookup"><span data-stu-id="da1d0-221">If, for example, you specify that a partition is nonoverlapping with a single subscription per partition, but data is then updated at another Subscriber, the Merge Agent can fail during synchronization and non-convergence can occur.</span></span>  
  
#### <a name="selecting-the-appropriate-partition-option"></a><span data-ttu-id="da1d0-222">Выбор подходящего параметра секции</span><span class="sxs-lookup"><span data-stu-id="da1d0-222">Selecting the Appropriate Partition Option</span></span>  
 <span data-ttu-id="da1d0-223">Неперекрывающиеся секции работают совместно с предварительно вычисляемыми секциями для улучшения производительности в случае, когда допустимы некоторые функциональные ограничения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-223">Nonoverlapping partitions work in conjunction with precomputed partitions to improve performance in situations where some functional limitations are acceptable.</span></span> <span data-ttu-id="da1d0-224">Предварительно вычисляемые секции повышают скорость загрузки данных на подписчик, но снижают скорость передачи.</span><span class="sxs-lookup"><span data-stu-id="da1d0-224">Precomputed partitions quicken downloads to Subscribers, but slow uploads.</span></span> <span data-ttu-id="da1d0-225">Неперекрывающиеся секции минимизируют стоимость передачи, связанной с предварительно вычисленными секциями.</span><span class="sxs-lookup"><span data-stu-id="da1d0-225">Nonoverlapping partitions minimize the upload cost associated with precomputed partitions.</span></span> <span data-ttu-id="da1d0-226">Повышение производительности благодаря применению неперекрывающихся секций наиболее заметно при использовании более сложных параметризованных фильтров и фильтров соединения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-226">The performance benefit of nonoverlapping partitions is more noticeable when the parameterized filters and join filters used are more complex.</span></span>  
  
 <span data-ttu-id="da1d0-227">Рассмотрим следующие сценарии при выборе параметров секции для использования в публикации.</span><span class="sxs-lookup"><span data-stu-id="da1d0-227">Consider the following scenarios when deciding which partition options to use in a publication.</span></span>  
  
-   <span data-ttu-id="da1d0-228">В компании[!INCLUDE[ssSampleDBCoShort](../../../includes/sssampledbcoshort-md.md)] имеются мобильные продавцы, причем каждый продавец отвечает за клиентов определенного района (с заданным почтовым индексом).</span><span class="sxs-lookup"><span data-stu-id="da1d0-228">[!INCLUDE[ssSampleDBCoShort](../../../includes/sssampledbcoshort-md.md)] has a mobile sales force with each sales person responsible for customers in a given zip code.</span></span> <span data-ttu-id="da1d0-229">Если клиент перемещается с одной территории продаж на другую, то в соответствии с требованиями приложения почтовый индекс должен обновляться, передавая клиента другому продавцу.</span><span class="sxs-lookup"><span data-stu-id="da1d0-229">The application requires that  the zip code be updated if a customer moves from one sales territory to another, so that the customer is assigned to a different sales person.</span></span> <span data-ttu-id="da1d0-230">Параметризованный фильтр основан на почтовом индексе клиента, поэтому при изменении индекса строка будет удалена из секции одного продавца и вставлена в секцию другого.</span><span class="sxs-lookup"><span data-stu-id="da1d0-230">The parameterized filter is based on the customer's zip code, and the update removes the zip code from one sales person's partition and inserts it into another sales person's partition.</span></span> <span data-ttu-id="da1d0-231">Для этого нужны перекрывающиеся секции с возможностью обновления столбцов, на которые имеются ссылки в параметризованном фильтре.</span><span class="sxs-lookup"><span data-stu-id="da1d0-231">This requires overlapping partitions with the ability to update columns referenced in a parameterized filter.</span></span> <span data-ttu-id="da1d0-232">Этот метод обеспечивает максимальную гибкость, но иногда может давать не столь большую производительность, как неперекрывающиеся секции.</span><span class="sxs-lookup"><span data-stu-id="da1d0-232">This option maximizes flexibility but might not perform as well as nonoverlapping partitions.</span></span>  
  
-   <span data-ttu-id="da1d0-233">Агентство по трудоустройству имеет данные, которые предоставляет своим региональным офисам в каждом округе штата.</span><span class="sxs-lookup"><span data-stu-id="da1d0-233">An employment agency has data that is supplied to regional offices in each county of the state.</span></span> <span data-ttu-id="da1d0-234">Данные не перекрываются, каждая строка таблицы в штаб-квартире агентства включена только в одну секцию, но эта секция отправляется в несколько офисов одного округа.</span><span class="sxs-lookup"><span data-stu-id="da1d0-234">The data does not overlap; each row in the table at the agency's headquarters is included in only one partition, but that partition is sent to multiple offices in the same county.</span></span> <span data-ttu-id="da1d0-235">Наиболее подходящим может оказаться метод неперекрывающихся секций, где секции разделяются между несколькими подписками, обеспечивая более высокую производительность по сравнению с перекрывающимися секциями, в то же время удовлетворяя требованиям приложения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-235">The nonoverlapping partition option with partitions shared between subscriptions is appropriate, providing a performance improvement over overlapping partitions while satisfying the application requirements.</span></span>  
  
-   <span data-ttu-id="da1d0-236">Если имеются неперекрывающиеся секции и только одна подписка получает и обновляет данные в секции, можно реализовать дополнительные преимущества по производительности.</span><span class="sxs-lookup"><span data-stu-id="da1d0-236">If you have nonoverlapping partitions and only one subscription receives and updates the data in a partition, further performance benefits can be realized.</span></span> <span data-ttu-id="da1d0-237">Этот сценарий характерен для систем точки продажи и приложений выездной торговли, в которых данные первоначально собираются на подписчике, а затем передаются на издатель.</span><span class="sxs-lookup"><span data-stu-id="da1d0-237">This scenario is common for point of sale systems, and field force applications in which data is primarily collected at the Subscriber and uploaded to the Publisher.</span></span> <span data-ttu-id="da1d0-238">Рассмотрим таблицу **Пакет** в приложении доставки: при загрузке каждого пакета в грузовик состояние пакета в таблице **Пакет** изменится, и это изменение будет реплицировано обратно в штаб-квартиру.</span><span class="sxs-lookup"><span data-stu-id="da1d0-238">Consider a **Package** table in a delivery application: as each package is loaded onto a truck, the status of the package is changed in the **Package** table, and the change is replicated back to headquarters.</span></span> <span data-ttu-id="da1d0-239">Водители не обновят состояние одного и того же пакета в двух разных грузовиках, так что таблица **Пакет** — неплохой кандидат для использования неперекрывающихся секций с одной подпиской на секцию.</span><span class="sxs-lookup"><span data-stu-id="da1d0-239">Drivers would not update the status of the same package on two different trucks, so the **Package** table is a good candidate for a nonoverlapping partition with a single subscription per partition.</span></span>  
  
#### <a name="considerations-for-nonoverlapping-partitions"></a><span data-ttu-id="da1d0-240">Аспекты использования неперекрывающихся секций</span><span class="sxs-lookup"><span data-stu-id="da1d0-240">Considerations for Nonoverlapping Partitions</span></span>  
 <span data-ttu-id="da1d0-241">При использовании неперекрывающихся секций учитывайте следующие аспекты.</span><span class="sxs-lookup"><span data-stu-id="da1d0-241">Keep the following considerations in mind when using nonoverlapping partitions.</span></span>  
  
##### <a name="general-considerations"></a><span data-ttu-id="da1d0-242">Общие рекомендации</span><span class="sxs-lookup"><span data-stu-id="da1d0-242">General Considerations</span></span>  
  
-   <span data-ttu-id="da1d0-243">Публикация должна использовать предварительно вычисляемые секции.</span><span class="sxs-lookup"><span data-stu-id="da1d0-243">The publication must use precomputed partitions.</span></span>  
  
-   <span data-ttu-id="da1d0-244">Строка должна принадлежать только одной секции.</span><span class="sxs-lookup"><span data-stu-id="da1d0-244">A row must belong to only one partition.</span></span>  
  
-   <span data-ttu-id="da1d0-245">Статьи не могут быть частью логической записи.</span><span class="sxs-lookup"><span data-stu-id="da1d0-245">Articles cannot be part of a logical record.</span></span>  
  
-   <span data-ttu-id="da1d0-246">Альтернативные участники синхронизации не поддерживаются (эта функция устарела).</span><span class="sxs-lookup"><span data-stu-id="da1d0-246">Alternate synchronization partners are not supported (this feature is deprecated).</span></span>  
  
-   <span data-ttu-id="da1d0-247">Подписчик не может обновить столбцы, на которые имеются ссылки в параметризованном фильтре.</span><span class="sxs-lookup"><span data-stu-id="da1d0-247">The Subscriber cannot update columns referenced in a parameterized filter.</span></span>  
  
-   <span data-ttu-id="da1d0-248">Если вставка на подписчике не принадлежит секции, она не удаляется.</span><span class="sxs-lookup"><span data-stu-id="da1d0-248">If an insert at a Subscriber does not belong to the partition, it is not deleted.</span></span> <span data-ttu-id="da1d0-249">Однако она не будет реплицироваться на другие подписчики.</span><span class="sxs-lookup"><span data-stu-id="da1d0-249">However, it will not be replicated to other Subscribers.</span></span>  
  
-   <span data-ttu-id="da1d0-250">В некоторых случаях при работе с перекрывающимися секциями диапазоны идентификаторов настраиваются при вставке данных агентом слияния.</span><span class="sxs-lookup"><span data-stu-id="da1d0-250">In some circumstances with overlapping partitions, identity ranges are adjusted when the Merge Agent inserts data.</span></span> <span data-ttu-id="da1d0-251">В случае же неперекрывающихся секций диапазоны при вставках могут настраиваться пользователями, которые обладают разрешениями на настройку диапазонов идентификаторов в базе данных подписок.</span><span class="sxs-lookup"><span data-stu-id="da1d0-251">With nonoverlapping partitions, ranges can only be adjusted during inserts by a user who has permission to adjust identity ranges in the subscription database.</span></span> <span data-ttu-id="da1d0-252">Пользователь должен быть владельцем таблицы, членом предопределенной роли сервера **sysadmin** , предопределенной роли базы данных **db_owner** или предопределенной роли базы данных **db_ddladmin** .</span><span class="sxs-lookup"><span data-stu-id="da1d0-252">The user must either own the table, or be a member of the **sysadmin** fixed server role, the **db_owner** fixed database role, or the **db_ddladmin** fixed database role.</span></span>  
  
##### <a name="additional-considerations-for-nonoverlapping-partitions-with-a-single-subscription-per-partition"></a><span data-ttu-id="da1d0-253">Дополнительные сведения по неперекрывающимся секциям с одной подпиской на секцию</span><span class="sxs-lookup"><span data-stu-id="da1d0-253">Additional Considerations for Nonoverlapping Partitions with a Single Subscription per Partition</span></span>  
  
-   <span data-ttu-id="da1d0-254">Статьи могут присутствовать только в одной публикации; статьи не могут переиздаваться.</span><span class="sxs-lookup"><span data-stu-id="da1d0-254">Articles can exist in only one publication; articles cannot be republished.</span></span>  
  
-   <span data-ttu-id="da1d0-255">Публикация должна позволять подписчикам инициировать создание моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="da1d0-255">The publication must allow Subscribers to initiate the snapshot process.</span></span> <span data-ttu-id="da1d0-256">Дополнительные сведения см. в статье [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-256">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
##### <a name="additional-considerations-for-join-filters"></a><span data-ttu-id="da1d0-257">Дополнительные соображения по фильтрам соединения</span><span class="sxs-lookup"><span data-stu-id="da1d0-257">Additional Considerations for Join Filters</span></span>  
  
-   <span data-ttu-id="da1d0-258">В иерархии фильтров соединения статья с перекрывающейся секцией не может находиться выше статьи с неперекрывающейся секцией.</span><span class="sxs-lookup"><span data-stu-id="da1d0-258">In a join filter hierarchy, an article with an overlapping partition cannot appear above an article with a nonoverlapping partition.</span></span> <span data-ttu-id="da1d0-259">Другими словами, родительская статья должна использовать неперекрывающиеся секции, если их использует дочерняя секция.</span><span class="sxs-lookup"><span data-stu-id="da1d0-259">In other words, a parent article must use nonoverlapping partitions if the child article does.</span></span> <span data-ttu-id="da1d0-260">Сведения о фильтрах соединения см. в разделе [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-260">For information about join filters, see [Join Filters](join-filters.md).</span></span>  
  
-   <span data-ttu-id="da1d0-261">Фильтр соединения, в котором неперекрывающаяся секция является дочерней, должен иметь свойство **join unique key** со значением 1.</span><span class="sxs-lookup"><span data-stu-id="da1d0-261">A join filter in which the nonoverlapping partition is a child must have the **join unique key** property set to 1.</span></span> <span data-ttu-id="da1d0-262">Дополнительные сведения см. в статье [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="da1d0-262">For more information, see [Join Filters](join-filters.md).</span></span>  
  
-   <span data-ttu-id="da1d0-263">Статья должна иметь только один параметризованный фильтр или фильтр соединения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-263">The article should only have one parameterized filter or join filter.</span></span> <span data-ttu-id="da1d0-264">Разрешается иметь параметризованный фильтр и быть родительским элементом в фильтре соединения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-264">Having a parameterized filter and being the parent in a join filter is allowed.</span></span> <span data-ttu-id="da1d0-265">Не разрешается иметь параметризованный фильтр и быть дочерним элементом в фильтре соединения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-265">Having a parameterized filter and being the child in a join filter is not allowed.</span></span> <span data-ttu-id="da1d0-266">Также нельзя иметь более одного фильтра соединения.</span><span class="sxs-lookup"><span data-stu-id="da1d0-266">Having more than one join filter is also not allowed.</span></span>  
  
-   <span data-ttu-id="da1d0-267">Если пара таблиц издателя связана фильтром соединения и в дочерней таблице есть строки, которым не соответствуют никакие строки таблицы-родителя, то вставка недостающих родительских строк не приведет к загрузке связанных строк в подписчик (строки будут загружены с перекрывающимися секциями).</span><span class="sxs-lookup"><span data-stu-id="da1d0-267">If two tables at the Publisher have a join filter relationship and the child table has rows that have no corresponding row in the parent table, an insert of the missing parent row will not result in the related rows being downloaded to the Subscriber (the rows would be downloaded with overlapping partitions).</span></span> <span data-ttu-id="da1d0-268">Например, если в таблице **SalesOrderDetail** есть строки, для которых нет соответствий в таблице **SalesOrderHeader** , то при вставке недостающей строки в таблицу **SalesOrderHeader**она будет загружена на подписчик, а соответствующие строки таблицы **SalesOrderDetail** — нет.</span><span class="sxs-lookup"><span data-stu-id="da1d0-268">For example, if the **SalesOrderDetail** table has rows with no corresponding row in the **SalesOrderHeader** table, and you insert the missing row in **SalesOrderHeader**, the row is downloaded to the Subscriber, but the corresponding rows in **SalesOrderDetail** are not.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="da1d0-269">См. также:</span><span class="sxs-lookup"><span data-stu-id="da1d0-269">See Also</span></span>  
 <span data-ttu-id="da1d0-270">[Оптимальные методы для фильтров строк на основе времени](best-practices-for-time-based-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="da1d0-270">[Best Practices for Time-Based Row Filters](best-practices-for-time-based-row-filters.md) </span></span>  
 <span data-ttu-id="da1d0-271">[Фильтрация опубликованных данных](../publish/filter-published-data.md) </span><span class="sxs-lookup"><span data-stu-id="da1d0-271">[Filter Published Data](../publish/filter-published-data.md) </span></span>  
 [<span data-ttu-id="da1d0-272">Фильтрация опубликованных данных для репликации слиянием</span><span class="sxs-lookup"><span data-stu-id="da1d0-272">Filter Published Data for Merge Replication</span></span>](filter-published-data-for-merge-replication.md)  
  
  
