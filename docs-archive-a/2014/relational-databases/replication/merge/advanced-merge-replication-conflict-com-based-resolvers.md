---
title: Сопоставители на базе технологии Microsoft COM | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: a6637e4b-4e6b-40aa-bee6-39d98cc507c8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b446c3300b2c8a440a092084f01c55105c9be95e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87733986"
---
# <a name="microsoft-com-based-resolvers"></a>Microsoft COM-Based Resolvers
  Все сопоставители, основанные на технологии COM и поставляемые с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , обрабатывают конфликты обновления, а там, где это оговорено специально, они также обрабатывают конфликты вставки и удаления. Все арбитры производят отслеживание столбцов; большинство из них также производят отслеживание строк. Эти и все другие основанные на технологии COM сопоставители объявляют типы конфликтов, которые они обрабатывают, а для всех остальных типов конфликтов агент слияния использует сопоставитель по умолчанию.  
  
 Сопоставители устанавливаются во время процесса установки [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Выполните хранимую процедуру **sp_enumcustomresolvers** для просмотра всех сопоставителей, зарегистрированных на компьютере. При выполнении этой процедуры отображаются описание и глобальный уникальный идентификатор (GUID) для каждого сопоставителя в отдельном результирующем наборе.  
  
 Чтобы указать сопоставитель, см. [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md).  
  
 В следующей таблице описываются атрибуты конкретных сопоставителей.  
  
|Имя|Требуемые входные данные|Description|Комментарии|  
|----------|--------------------|-----------------|--------------|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий суммирование|Имя суммируемого столбца. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Победитель в конфликте определяется по значению приоритета. Указанные значения столбца устанавливаются равными сумме значений исходного столбца и целевого столбца. Если одно из значений — NULL, итоговое значение устанавливается равным значению другого столбца.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий усреднение|Имя усредняемого столбца. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Победитель в конфликте определяется по значению приоритета. Значения результирующего столбца устанавливаются равными среднему значению от значений исходного и целевого столбца. Если одно из значений — NULL, итоговое значение устанавливается равным значению другого столбца.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий тип DATETIME (побеждает более раннее значение)|Имя столбца, применяемого для определения победителя конфликта. Столбец должен иметь тип данных **datetime** .|Конфликт разрешается в пользу столбца с более ранним значением **datetime** . Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов. Значения столбцов сравниваются напрямую, и поправка на разницу в часовых поясах не производится.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий тип DATETIME (побеждает более позднее значение)|Имя столбца, применяемого для определения победителя конфликта. Столбец должен иметь тип данных **datetime** .|Конфликт разрешается в пользу столбца с более поздним значением **datetime** . Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий максимум|Имя столбца, применяемого для определения победителя конфликта. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Столбец с большим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает отслеживание строк и столбцов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий минимум|Имя столбца, применяемого для определения победителя конфликта. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Столбец с меньшим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий слияние текста|Имя текстового столбца и разделитель, например `@resolver_info = '[col1][===]'`.|Победитель в конфликте определяется по значению приоритета. Конфликтующие текстовые столбцы устанавливаются равными объединенному значению, состоящему из общего префикса, за которым следует уникальная часть от издателя, затем следует разделитель, а затем — уникальная часть от подписчика.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с победой подписчика|Нет входных данных.|Конфликт разрешается в пользу подписчика, независимо от того является он источником или пунктом назначения.|Поддерживает все типы конфликтов.|  
|Сопоставитель [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий приоритетный столбец|Имя столбца, применяемого для определения победителя конфликта. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Столбец с большим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий только передачу|Нет входных данных.|Принимаются изменения, переданные на издатель; изменения не загружаются на подписчик.|Поддерживает все типы конфликтов.|  
|Арбитр конфликтов [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], использующий только загрузку|Нет входных данных.|Отклоняются изменения, переданные на издатель; изменения загружаются на подписчик.|Поддерживает все типы конфликтов.|  
|Арбитр конфликтов хранимых процедур[!INCLUDE[msCoName](../../../includes/msconame-md.md)] SQL Server|Имя хранимой процедуры, которую должен вызвать сопоставитель для разрешения конфликта.|Устранение конфликта зависит от логики указываемой хранимой процедуры.|Поддерживает конфликты обновления. Дополнительные сведения см. в статье [Реализация пользовательского арбитра конфликтов для статьи публикации слиянием](../implement-a-custom-conflict-resolver-for-a-merge-article.md)|  
  
## <a name="see-also"></a>См. также:  
 [Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md)   
 [sp_enumcustomresolvers (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql)  
  
  
