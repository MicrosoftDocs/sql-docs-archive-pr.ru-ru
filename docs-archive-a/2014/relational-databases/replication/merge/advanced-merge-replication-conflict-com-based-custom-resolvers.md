---
title: Сопоставители на основе технологии COM | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: 94195797-ad7a-4962-a8e3-b259cd13aa38
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2b28795c1a7d43bcd4e8cb3f18723e05f9e76966
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87733989"
---
# <a name="com-based-custom-resolvers"></a><span data-ttu-id="43328-102">COM-Based Custom Resolvers</span><span class="sxs-lookup"><span data-stu-id="43328-102">COM-Based Custom Resolvers</span></span>
  <span data-ttu-id="43328-103">Пользовательские сопоставители предоставляют большую гибкость по сравнению с механизмом разрешения конфликтов по умолчанию, и они могут реализовать бизнес-логику, необходимую для приложений, использующих реплицированные данные.</span><span class="sxs-lookup"><span data-stu-id="43328-103">Custom resolvers provide more flexibility than the default resolution mechanism, and they can implement business logic required by applications using the replicated data.</span></span> <span data-ttu-id="43328-104">Пользовательский сопоставитель на основе COM — это динамически подключаемая библиотека (DLL), которая реализует COM-интерфейс **ICustomResolver** , его методы и свойства, а также другие поддерживаемые интерфейсы и определения типов, разработанные специально для устранения конфликтов.</span><span class="sxs-lookup"><span data-stu-id="43328-104">A COM-based custom resolver is a dynamic-link library (DLL) that implements the **ICustomResolver** COM interface, its methods and properties, and other supporting interfaces and type definitions designed specifically for conflict resolution.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="43328-105">Рекомендуется использовать обработчик бизнес-логики вместо пользовательского сопоставителя на основе COM, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="43328-105">It is recommended to use a business logic handler rather than a COM-based custom resolver if possible.</span></span> <span data-ttu-id="43328-106">Дополнительные сведения об обработчиках бизнес-логики см. в статье [Выполнение бизнес логики во время синхронизации слияния](execute-business-logic-during-merge-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="43328-106">For more information on business logic handlers, see [Execute Business Logic During Merge Synchronization](execute-business-logic-during-merge-synchronization.md).</span></span>  
  
 <span data-ttu-id="43328-107">Для создания пользовательского COM-сопоставителя можно использовать библиотеку типов, которая содержится в файле replrec.dll. По умолчанию эта библиотека устанавливается в каталог [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span><span class="sxs-lookup"><span data-stu-id="43328-107">To build a custom COM resolver, you can use the type library that is provided in the replrec.dll; by default, this library is installed at [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span></span>  
  
 <span data-ttu-id="43328-108">Перед написанием пользовательского COM-сопоставителя необходимо определиться по следующим вопросам:</span><span class="sxs-lookup"><span data-stu-id="43328-108">Before writing a custom COM resolver, you need to decide:</span></span>  
  
-   <span data-ttu-id="43328-109">Типы изменений строк, конфликты которых необходимо разрешить, например обновления, вставки и удаления, а также, должен ли сопоставитель вызываться во время передачи изменений слияния, загрузки изменений слияния, или его необходимо вызывать в обеих ситуациях.</span><span class="sxs-lookup"><span data-stu-id="43328-109">The types of row changes you want to resolve, such as updates, inserts, and deletes, and whether the resolver should be invoked during the upload of merge changes, the download of merge changes, or both.</span></span> <span data-ttu-id="43328-110">Можно указать один тип изменений, все изменения, или любое их сочетание.</span><span class="sxs-lookup"><span data-stu-id="43328-110">You can specify one type of change, all changes, or any combination.</span></span> <span data-ttu-id="43328-111">Сопоставитель конфликтов слияния по умолчанию обрабатывает любые конфликты, не охваченные пользовательским арбитром конфликтов.</span><span class="sxs-lookup"><span data-stu-id="43328-111">The default merge conflict resolver handles any conflicts not covered by a custom resolver.</span></span>  
  
-   <span data-ttu-id="43328-112">Надо ли использовать отслеживание столбца при разрешении конфликта.</span><span class="sxs-lookup"><span data-stu-id="43328-112">Whether to use column tracking when resolving the conflict.</span></span> <span data-ttu-id="43328-113">Когда включено отслеживание на уровне столбцов, только данные в тех столбцах, где существует конфликт, помечаются как конфликт, иначе данные объединяются.</span><span class="sxs-lookup"><span data-stu-id="43328-113">When column-level tracking is on, only data in those columns where a conflict exists are flagged as a conflict, otherwise the data is merged.</span></span> <span data-ttu-id="43328-114">Однако конфликты разрешаются таким же способом, как и при отслеживании на уровне строк: победитель по приоритету перезаписывает всю строку данных (однако данные могут быть смесью значений от издателя, подписчиков или измененными значениями, которые не были получены ни от издателя, ни от подписчиков).</span><span class="sxs-lookup"><span data-stu-id="43328-114">However, conflicts are resolved in the same way as row-level tracking: the priority winner overwrites the entire row of data (but the data can be a mix of values from the Publisher, Subscribers, or some altered values that were from neither Publisher nor Subscribers).</span></span> <span data-ttu-id="43328-115">Дополнительные сведения см. в статье [Обнаружение и разрешение конфликтов репликации слиянием](advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="43328-115">For more information, see [Detect and Resolve Merge Replication Conflicts](advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
 <span data-ttu-id="43328-116">Чтобы реализовать пользовательский арбитр конфликтов на основе технологии COM, см. раздел [Реализация пользовательского арбитра конфликтов для статьи публикации слиянием](../implement-a-custom-conflict-resolver-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="43328-116">To implement a COM-based custom conflict resolver, see [Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md).</span></span>  
  
 <span data-ttu-id="43328-117">Пользовательский сопоставитель указывается для статьи, а не для всей публикации.</span><span class="sxs-lookup"><span data-stu-id="43328-117">A custom resolver is specified for an article, not an entire publication.</span></span> <span data-ttu-id="43328-118">Тот же самый сопоставитель может использоваться с более чем одной статьей, однако логика разрешения конфликтов в пользовательских сопоставителях часто характерна для определенной таблицы.</span><span class="sxs-lookup"><span data-stu-id="43328-118">The same resolver can be used with more than one article, but the logic in custom resolvers is often specific to a particular table.</span></span> <span data-ttu-id="43328-119">Если используемая в статье таблица изменена после создания сопоставителя (например, изменено имя столбца, используемого при устранении конфликта), может потребоваться изменение и повторная компиляция пользовательского сопоставителя.</span><span class="sxs-lookup"><span data-stu-id="43328-119">If the table used in the article is modified after the resolver is created (for example, renaming the column name that is used in conflict resolution), the custom resolver might need to be modified and recompiled.</span></span>  
  
 <span data-ttu-id="43328-120">Чтобы указать пользовательский сопоставитель, см. раздел [Определение сопоставителя статей публикации слиянием](../publish/specify-a-merge-article-resolver.md).</span><span class="sxs-lookup"><span data-stu-id="43328-120">To specify a custom resolver, see [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="43328-121">См. также:</span><span class="sxs-lookup"><span data-stu-id="43328-121">See Also</span></span>  
 <span data-ttu-id="43328-122">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="43328-122">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 [<span data-ttu-id="43328-123">Microsoft COM-Based Resolvers</span><span class="sxs-lookup"><span data-stu-id="43328-123">Microsoft COM-Based Resolvers</span></span>](advanced-merge-replication-conflict-com-based-resolvers.md)  
  
  
