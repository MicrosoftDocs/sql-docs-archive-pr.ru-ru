---
title: Повторная инициализация подписки | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- initializing subscriptions [SQL Server replication], reinitializing
- subscriptions [SQL Server replication], reinitializing
- reinitializing subscriptions
ms.assetid: ca3625c5-c62e-4ab7-9829-d511f838e385
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: f751928c05caa5c4acdcc6c667dc59bb7824021b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750671"
---
# <a name="reinitialize-a-subscription"></a><span data-ttu-id="b1a40-102">Повторная инициализация подписки</span><span class="sxs-lookup"><span data-stu-id="b1a40-102">Reinitialize a Subscription</span></span>
  <span data-ttu-id="b1a40-103">В данном разделе описывается повторная инициализация подписки в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]или объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="b1a40-103">This topic describes how to reinitialize a subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="b1a40-104">Отдельные подписки можно помечать для повторной инициализации, чтобы во время следующей синхронизации применялся новый моментальный снимок.</span><span class="sxs-lookup"><span data-stu-id="b1a40-104">Individual subscriptions can be marked for reinitialization so that a new snapshot is applied during the next synchronization.</span></span>  
  
 <span data-ttu-id="b1a40-105">**В этом разделе**</span><span class="sxs-lookup"><span data-stu-id="b1a40-105">**In This Topic**</span></span>  
  
-   <span data-ttu-id="b1a40-106">**Для повторной инициализации подписки используется:**</span><span class="sxs-lookup"><span data-stu-id="b1a40-106">**To reinitialize a subscription, using:**</span></span>  
  
     [<span data-ttu-id="b1a40-107">Среда SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b1a40-107">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="b1a40-108">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b1a40-108">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="b1a40-109">объекты RMO;</span><span class="sxs-lookup"><span data-stu-id="b1a40-109">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="b1a40-110">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b1a40-110">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="b1a40-111">Повторная инициализация подписки — это процесс, состоящий из двух частей:</span><span class="sxs-lookup"><span data-stu-id="b1a40-111">Reinitializing a subscription is a two-part process:</span></span>  
  
1.  <span data-ttu-id="b1a40-112">Одна или все подписки на публикацию *помечаются* для повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-112">A single subscription or all subscriptions to a publication are *marked* for reinitialization.</span></span> <span data-ttu-id="b1a40-113">Подписки помечаются для повторной инициализации в диалоговом окне **Повторная инициализация подписок**, доступ к которому можно получить в папках **Локальные публикации** и **Локальные подписки** в [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b1a40-113">Mark subscriptions for reinitialization in the **Reinitialize Subscription(s)** dialog box, which is available from the **Local Publications** folder and the **Local Subscriptions** folder in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="b1a40-114">Все подписки можно также пометить на вкладке **Все подписки** и в узле публикаций монитора репликации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-114">You can also mark subscriptions from the **All Subscriptions** tab and the publications node in Replication Monitor.</span></span> <span data-ttu-id="b1a40-115">Сведения о запуске монитора репликации см. в [этой статье](monitor/start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-115">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span> <span data-ttu-id="b1a40-116">При пометке подписки для повторной инициализации доступны следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="b1a40-116">When you mark a subscription for reinitialization, you have the following options:</span></span>  
  
     <span data-ttu-id="b1a40-117">**Использовать текущий моментальный снимок**</span><span class="sxs-lookup"><span data-stu-id="b1a40-117">**Use the current snapshot**</span></span>  
     <span data-ttu-id="b1a40-118">Выберите, чтобы применить текущий моментальный снимок к подписчику при следующем запуске агента распространителя или агента слияния.</span><span class="sxs-lookup"><span data-stu-id="b1a40-118">Select to apply the current snapshot to the Subscriber the next time the Distribution Agent or Merge Agent runs.</span></span> <span data-ttu-id="b1a40-119">Если допустимый моментальный снимок отсутствует, этот параметр выбрать нельзя.</span><span class="sxs-lookup"><span data-stu-id="b1a40-119">If there is no valid snapshot available, this option cannot be selected.</span></span>  
  
     <span data-ttu-id="b1a40-120">**Использовать новый моментальный снимок**</span><span class="sxs-lookup"><span data-stu-id="b1a40-120">**Use a new snapshot**</span></span>  
     <span data-ttu-id="b1a40-121">Выберите, чтобы выполнить повторную инициализацию подписки с новым моментальным снимком.</span><span class="sxs-lookup"><span data-stu-id="b1a40-121">Select to reinitialize the subscription with a new snapshot.</span></span> <span data-ttu-id="b1a40-122">Этот моментальный снимок можно применять к подписчику только после того, как он был сформирован агентом моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="b1a40-122">The snapshot can be applied to the Subscriber only after it has been generated by the Snapshot Agent.</span></span> <span data-ttu-id="b1a40-123">Если агент моментальных снимков настроен на запуск по расписанию, подписка не инициализируется повторно до следующего запланированного запуска агента моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="b1a40-123">If the Snapshot Agent is set to run on a schedule, the subscription is not reinitialized until after the next scheduled Snapshot Agent run.</span></span> <span data-ttu-id="b1a40-124">Выберите **Создать новый моментальный снимок** для немедленного запуска агента моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="b1a40-124">Select **Generate the new snapshot now** to start the Snapshot Agent immediately.</span></span>  
  
     <span data-ttu-id="b1a40-125">**Передать несинхронизированные изменения перед повторной инициализацией**</span><span class="sxs-lookup"><span data-stu-id="b1a40-125">**Upload unsynchronized changes before reinitialization**</span></span>  
     <span data-ttu-id="b1a40-126">Только репликация слиянием.</span><span class="sxs-lookup"><span data-stu-id="b1a40-126">Merge replication only.</span></span> <span data-ttu-id="b1a40-127">Выберите, чтобы передать все ожидающие обработки изменения из базы данных подписки, прежде чем данные подписчика будут перезаписаны моментальным снимком.</span><span class="sxs-lookup"><span data-stu-id="b1a40-127">Select to upload any pending changes from the subscription database before the data at the Subscriber is overwritten with a snapshot.</span></span>  
  
     <span data-ttu-id="b1a40-128">Если добавить, удалить или изменить параметризованный фильтр, ожидающие обработки изменения подписчика нельзя будет передать издателю во время повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-128">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="b1a40-129">Если нужно передать изменения, ожидающие обработки, то перед изменением фильтра необходимо синхронизировать все подписки.</span><span class="sxs-lookup"><span data-stu-id="b1a40-129">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="b1a40-130">Подписка повторно инициализируется при следующей синхронизации: агент распространителя (для репликации транзакций) или агент слияния (для репликации слиянием) применяет самый последний моментальный снимок к каждому подписчику, имеющему подписку, отмеченную для повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-130">A subscription is reinitialized the next time it is synchronized: the Distribution Agent (for transactional replication) or Merge Agent (for merge replication) applies the most recent snapshot to each Subscriber that has a subscription marked for reinitialization.</span></span> <span data-ttu-id="b1a40-131">Дополнительные сведения о синхронизации подписок см. в разделах [Synchronize a Push Subscription](synchronize-a-push-subscription.md) и [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-131">For more information about synchronizing subscriptions, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) and [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-mark-a-single-push-or-pull-subscription-for-reinitialization-in-management-studio-at-the-publisher"></a><span data-ttu-id="b1a40-132">Пометка для повторной инициализации одной принудительной подписки или подписки по запросу в Management Studio (на издателе)</span><span class="sxs-lookup"><span data-stu-id="b1a40-132">To mark a single push or pull subscription for reinitialization in Management Studio (at the Publisher)</span></span>  
  
1.  <span data-ttu-id="b1a40-133">Подключитесь к издателю в среде [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], а затем раскройте узел сервера.</span><span class="sxs-lookup"><span data-stu-id="b1a40-133">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="b1a40-134">Раскройте папку **Репликация** , а затем папку **Локальные публикации** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-134">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="b1a40-135">Раскройте публикацию, имеющую подписку, которую нужно повторно инициализировать.</span><span class="sxs-lookup"><span data-stu-id="b1a40-135">Expand the publication that has the subscription you want to reinitialize.</span></span>  
  
4.  <span data-ttu-id="b1a40-136">Щелкните подписку правой кнопкой мыши и выберите **Повторно инициализировать**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-136">Right-click the subscription, and then click **Reinitialize**.</span></span>  
  
5.  <span data-ttu-id="b1a40-137">В диалоговом окне **Повторная инициализация подписок** выберите параметры и щелкните **Пометить для повторной инициализации**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-137">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-a-single-pull-subscription-for-reinitialization-in-management-studio-at-the-subscriber"></a><span data-ttu-id="b1a40-138">Пометка для повторной инициализации одной принудительной подписки в Management Studio (на подписчике)</span><span class="sxs-lookup"><span data-stu-id="b1a40-138">To mark a single pull subscription for reinitialization in Management Studio (at the Subscriber)</span></span>  
  
1.  <span data-ttu-id="b1a40-139">Подключитесь к подписчику в [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]и раскройте узел сервера.</span><span class="sxs-lookup"><span data-stu-id="b1a40-139">Connect to the Subscriber in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="b1a40-140">Раскройте папку **Репликация** , а затем — папку **Локальные подписки** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-140">Expand the **Replication** folder, and then expand the **Local Subscriptions** folder.</span></span>  
  
3.  <span data-ttu-id="b1a40-141">Щелкните подписку правой кнопкой мыши и выберите **Повторно инициализировать**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-141">Right-click the subscription, and then click **Reinitialize**.</span></span>  
  
4.  <span data-ttu-id="b1a40-142">В появившемся окне подтверждения нажмите кнопку **Да**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-142">In the confirmation dialog box that is displayed, click **Yes**.</span></span>  
  
#### <a name="to-mark-all-subscriptions-for-reinitialization-in-management-studio"></a><span data-ttu-id="b1a40-143">Пометить для повторной инициализации все подписки в Management Studio</span><span class="sxs-lookup"><span data-stu-id="b1a40-143">To mark all subscriptions for reinitialization in Management Studio</span></span>  
  
1.  <span data-ttu-id="b1a40-144">Подключитесь к издателю в среде [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], а затем раскройте узел сервера.</span><span class="sxs-lookup"><span data-stu-id="b1a40-144">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="b1a40-145">Раскройте папку **Репликация** , а затем папку **Локальные публикации** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-145">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="b1a40-146">Щелкните правой кнопкой мыши публикацию с подписками, которые необходимо повторно инициализировать, и выберите **Повторно инициализировать все подписки**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-146">Right-click the publication with subscriptions you want to reinitialize, and then click **Reinitialize All Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="b1a40-147">В диалоговом окне **Повторная инициализация подписок** выберите параметры и щелкните **Пометить для повторной инициализации**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-147">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-a-single-push-or-pull-subscription-for-reinitialization-in-replication-monitor"></a><span data-ttu-id="b1a40-148">Пометка для повторной инициализации одной принудительной подписки или подписки по запросу в мониторе репликации</span><span class="sxs-lookup"><span data-stu-id="b1a40-148">To mark a single push or pull subscription for reinitialization in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="b1a40-149">В мониторе репликации раскройте группу издателей на левой панели, раскройте нужного издателя, а затем выберите публикацию.</span><span class="sxs-lookup"><span data-stu-id="b1a40-149">In Replication Monitor, expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>  
  
2.  <span data-ttu-id="b1a40-150">Перейдите на вкладку **Все подписки** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-150">Click the **All Subscriptions** tab.</span></span>  
  
3.  <span data-ttu-id="b1a40-151">Щелкните правой кнопкой мыши подписку, для которой нужно выполнить повторную инициализацию, и выберите **Повторно инициализировать подписку**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-151">Right-click the subscription you want to reinitialize, and then click **Reinitialize Subscription**.</span></span>  
  
4.  <span data-ttu-id="b1a40-152">В диалоговом окне **Повторная инициализация подписок** выберите параметры и щелкните **Пометить для повторной инициализации**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-152">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-all-subscriptions-for-reinitialization-in-replication-monitor"></a><span data-ttu-id="b1a40-153">Пометка для повторной инициализации всех подписок в мониторе репликации</span><span class="sxs-lookup"><span data-stu-id="b1a40-153">To mark all subscriptions for reinitialization in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="b1a40-154">В мониторе репликации раскройте группу издателей на левой панели, а затем раскройте нужного издателя.</span><span class="sxs-lookup"><span data-stu-id="b1a40-154">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="b1a40-155">Щелкните правой кнопкой мыши публикацию с подписками, которые необходимо повторно инициализировать, и выберите **Повторно инициализировать все подписки**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-155">Right-click the publication with subscriptions you want to reinitialize, and then click **Reinitialize All Subscriptions**.</span></span>  
  
3.  <span data-ttu-id="b1a40-156">В диалоговом окне **Повторная инициализация подписок** выберите параметры и щелкните **Пометить для повторной инициализации**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-156">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="b1a40-157">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b1a40-157">Using Transact-SQL</span></span>  
 <span data-ttu-id="b1a40-158">Подписки можно повторно инициализировать программно с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-158">Subscriptions can be reinitialized programmatically using replication stored procedures.</span></span> <span data-ttu-id="b1a40-159">Используемая хранимая процедура зависит от типа подписки (принудительная или по запросу) и типа публикации, которой принадлежит подписка.</span><span class="sxs-lookup"><span data-stu-id="b1a40-159">The stored procedure that is used depends on the type of subscription (push or pull) and the type of publication to which the subscription belongs.</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="b1a40-160">Повторная инициализация подписки по запросу на публикацию транзакций</span><span class="sxs-lookup"><span data-stu-id="b1a40-160">To reinitialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="b1a40-161">В базе данных подписчика на подписчике выполните процедуру [sp_reinitpullsubscription_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-reinitpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b1a40-161">At the Subscriber on the subscription database, execute [sp_reinitpullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitpullsubscription-transact-sql).</span></span> <span data-ttu-id="b1a40-162">Укажите **@publisher** , **@publisher_db** и **@publication** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-162">Specify **@publisher**, **@publisher_db**, and **@publication**.</span></span> <span data-ttu-id="b1a40-163">В результате подписка будет помечена к повторной инициализации при следующем запуске агента распространителя.</span><span class="sxs-lookup"><span data-stu-id="b1a40-163">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
2.  <span data-ttu-id="b1a40-164">(Необязательно) Чтобы синхронизировать подписку, запустите агент распространителя на подписчике.</span><span class="sxs-lookup"><span data-stu-id="b1a40-164">(Optional) Start the Distribution Agent at the Subscriber to synchronize the subscription.</span></span> <span data-ttu-id="b1a40-165">Дополнительные сведения см. в статье [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-165">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="b1a40-166">Повторная инициализация принудительной подписки на публикацию транзакций</span><span class="sxs-lookup"><span data-stu-id="b1a40-166">To reinitialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="b1a40-167">Выполните процедуру [sp_reinitpullsubscription (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-reinitsubscription-transact-sql) на издателе.</span><span class="sxs-lookup"><span data-stu-id="b1a40-167">At the Publisher, execute [sp_reinitsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitsubscription-transact-sql).</span></span> <span data-ttu-id="b1a40-168">Укажите **@publication** , **@subscriber** и **@destination_db** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-168">Specify **@publication**, **@subscriber**, and **@destination_db**.</span></span> <span data-ttu-id="b1a40-169">В результате подписка будет помечена к повторной инициализации при следующем запуске агента распространителя.</span><span class="sxs-lookup"><span data-stu-id="b1a40-169">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
2.  <span data-ttu-id="b1a40-170">(Необязательно) Чтобы синхронизировать подписку, запустите агент распространителя на распространителе.</span><span class="sxs-lookup"><span data-stu-id="b1a40-170">(Optional) Start the Distribution Agent at the Distributor to synchronize the subscription.</span></span> <span data-ttu-id="b1a40-171">Дополнительные сведения см. в статье [Синхронизация принудительной подписки](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-171">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="b1a40-172">Повторная инициализация подписки по запросу на публикацию слиянием</span><span class="sxs-lookup"><span data-stu-id="b1a40-172">To reinitialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="b1a40-173">В базе данных подписчика на подписчике выполните процедуру [sp_reinitmergepullsubscription (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-reinitmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b1a40-173">At the Subscriber on the subscription database, execute [sp_reinitmergepullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="b1a40-174">Укажите **@publisher** , **@publisher_db** и **@publication** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-174">Specify **@publisher**, **@publisher_db**, and **@publication**.</span></span> <span data-ttu-id="b1a40-175">Чтобы передать изменения с подписчика перед повторной инициализацией, укажите значение `true` для **@upload_first** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-175">To upload changes from the Subscriber before reinitialization occurs, specify a value of `true` for **@upload_first**.</span></span> <span data-ttu-id="b1a40-176">Помечает подписку для повторной инициализации при следующем запуске агента слияния.</span><span class="sxs-lookup"><span data-stu-id="b1a40-176">This marks the subscription for reinitialization the next time the Merge Agent runs.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="b1a40-177">Если добавить, удалить или изменить параметризованный фильтр, ожидающие обработки изменения подписчика нельзя будет передать издателю во время повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-177">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="b1a40-178">Если нужно передать изменения, ожидающие обработки, то перед изменением фильтра необходимо синхронизировать все подписки.</span><span class="sxs-lookup"><span data-stu-id="b1a40-178">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="b1a40-179">(Необязательно) Чтобы синхронизировать подписку, запустите агент слияния на подписчике.</span><span class="sxs-lookup"><span data-stu-id="b1a40-179">(Optional) Start the Merge Agent at the Subscriber to synchronize the subscription.</span></span> <span data-ttu-id="b1a40-180">Дополнительные сведения см. в статье [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-180">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="b1a40-181">Повторная инициализация принудительной подписки на публикацию слиянием</span><span class="sxs-lookup"><span data-stu-id="b1a40-181">To reinitialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="b1a40-182">Выполните процедуру [sp_reinitmergesubscription (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-reinitmergesubscription-transact-sql) на издателе.</span><span class="sxs-lookup"><span data-stu-id="b1a40-182">At the Publisher, execute [sp_reinitmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergesubscription-transact-sql).</span></span> <span data-ttu-id="b1a40-183">Укажите **@publication** , **@subscriber** и **@subscriber_db** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-183">Specify **@publication**, **@subscriber**, and **@subscriber_db**.</span></span> <span data-ttu-id="b1a40-184">Чтобы передать изменения с подписчика перед повторной инициализацией, укажите значение `true` для **@upload_first** .</span><span class="sxs-lookup"><span data-stu-id="b1a40-184">To upload changes from the Subscriber before reinitialization occurs, specify a value of `true` for **@upload_first**.</span></span> <span data-ttu-id="b1a40-185">В результате подписка будет помечена к повторной инициализации при следующем запуске агента распространителя.</span><span class="sxs-lookup"><span data-stu-id="b1a40-185">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="b1a40-186">Если добавить, удалить или изменить параметризованный фильтр, ожидающие обработки изменения подписчика нельзя будет передать издателю во время повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-186">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="b1a40-187">Если нужно передать изменения, ожидающие обработки, то перед изменением фильтра необходимо синхронизировать все подписки.</span><span class="sxs-lookup"><span data-stu-id="b1a40-187">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="b1a40-188">(Необязательно) Чтобы синхронизировать подписку, запустите агент слияния на распространителе.</span><span class="sxs-lookup"><span data-stu-id="b1a40-188">(Optional) Start the Merge Agent at the Distributor to synchronize the subscription.</span></span> <span data-ttu-id="b1a40-189">Дополнительные сведения см. в статье [Синхронизация принудительной подписки](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-189">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-set-the-reinitialization-policy-when-creating-a-new-merge-publication"></a><span data-ttu-id="b1a40-190">Установка политики повторной инициализации при создании публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="b1a40-190">To set the reinitialization policy when creating a new merge publication</span></span>  
  
1.  <span data-ttu-id="b1a40-191">На издателе в базе данных публикации выполните хранимую процедуру [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), указав одно из следующих значений в параметре **@automatic_reinitialization_policy**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-191">At the Publisher on the publication database, execute [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), specifying one of the following values for **@automatic_reinitialization_policy**:</span></span>  
  
    -   <span data-ttu-id="b1a40-192">**1** — изменения передаются с подписчика до автоматической повторной инициализации подписки, выполняемой в результате изменения публикации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-192">**1** - changes are uploaded from the Subscriber before a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    -   <span data-ttu-id="b1a40-193">**0** — изменения на подписчике отменяются, когда происходит автоматическая повторная инициализация подписки, выполняемая в результате изменения публикации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-193">**0** - changes at the Subscriber are discarded when a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="b1a40-194">Если добавить, удалить или изменить параметризованный фильтр, ожидающие обработки изменения подписчика нельзя будет передать издателю во время повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-194">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="b1a40-195">Если нужно передать изменения, ожидающие обработки, то перед изменением фильтра необходимо синхронизировать все подписки.</span><span class="sxs-lookup"><span data-stu-id="b1a40-195">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
     <span data-ttu-id="b1a40-196">Дополнительные сведения см. в разделе [Create a Publication](publish/create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-196">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
#### <a name="to-change-the-reinitialization-policy-for-an-existing-merge-publication"></a><span data-ttu-id="b1a40-197">Изменение политики повторной инициализации для существующей публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="b1a40-197">To change the reinitialization policy for an existing merge publication</span></span>  
  
1.  <span data-ttu-id="b1a40-198">На издателе в базе данных публикации выполните хранимую процедуру [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), указав значение **automatic_reinitialization_policy** в параметре **@property** и одно из следующих значений в параметре **@value**.</span><span class="sxs-lookup"><span data-stu-id="b1a40-198">At the Publisher on the publication database, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **automatic_reinitialization_policy** for **@property** and one of the following values for **@value**:</span></span>  
  
    -   <span data-ttu-id="b1a40-199">**1** — изменения передаются с подписчика до автоматической повторной инициализации подписки, выполняемой в результате изменения публикации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-199">**1** - changes are uploaded from the Subscriber before a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    -   <span data-ttu-id="b1a40-200">**0** — изменения на подписчике отменяются, когда происходит автоматическая повторная инициализация подписки, выполняемая в результате изменения публикации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-200">**0** - changes at the Subscriber are discarded when a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="b1a40-201">Если добавить, удалить или изменить параметризованный фильтр, ожидающие обработки изменения подписчика нельзя будет передать издателю во время повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-201">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="b1a40-202">Если нужно передать изменения, ожидающие обработки, то перед изменением фильтра необходимо синхронизировать все подписки.</span><span class="sxs-lookup"><span data-stu-id="b1a40-202">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
     <span data-ttu-id="b1a40-203">Дополнительные сведения см. в статье [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-203">For more information, see [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="b1a40-204">При помощи объектов RMO</span><span class="sxs-lookup"><span data-stu-id="b1a40-204">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="b1a40-205">Отдельные подписки можно помечать для повторной инициализации, чтобы во время следующей синхронизации применялся новый моментальный снимок.</span><span class="sxs-lookup"><span data-stu-id="b1a40-205">Individual subscriptions can be marked for reinitialization so that during the next synchronization, a new snapshot is applied.</span></span> <span data-ttu-id="b1a40-206">Подписки можно повторно инициализировать программно с помощью объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="b1a40-206">Subscriptions can be reinitialized programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="b1a40-207">Используемые классы зависят от типа публикации, которой принадлежит подписка, и типа подписки (принудительная или по запросу).</span><span class="sxs-lookup"><span data-stu-id="b1a40-207">The classes you use depend on the type of publication to which the subscription belongs and the type of subscription (that is, a push or pull subscription).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="b1a40-208">Повторная инициализация подписки по запросу на публикацию транзакций</span><span class="sxs-lookup"><span data-stu-id="b1a40-208">To reinitialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="b1a40-209">Создайте соединение с подписчиком с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-209">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="b1a40-210">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.TransPullSubscription> , задайте свойства <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, а затем задайте соединение из шага 1 для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="b1a40-210">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPullSubscription> class, and set <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="b1a40-211">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-211">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b1a40-212">Если этот метод возвращает значение `false`, значит, на шаге 2 были неправильно заданы свойства подписки либо подписка по запросу не существует.</span><span class="sxs-lookup"><span data-stu-id="b1a40-212">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the pull subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="b1a40-213">Вызовите метод <xref:Microsoft.SqlServer.Replication.TransPullSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-213">Call the <xref:Microsoft.SqlServer.Replication.TransPullSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="b1a40-214">Этот метод помечает подписку для повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-214">This method marks the subscription for reinitialization.</span></span>  
  
5.  <span data-ttu-id="b1a40-215">Выполните синхронизацию подписки по запросу.</span><span class="sxs-lookup"><span data-stu-id="b1a40-215">Synchronize the pull subscription.</span></span> <span data-ttu-id="b1a40-216">Дополнительные сведения см. в статье [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-216">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="b1a40-217">Повторная инициализация принудительной подписки на публикацию транзакций</span><span class="sxs-lookup"><span data-stu-id="b1a40-217">To reinitialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="b1a40-218">Создайте соединение с издателем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-218">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="b1a40-219">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.TransSubscription> , задайте свойства <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, а затем задайте соединение из шага 1 для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="b1a40-219">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class, and set <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="b1a40-220">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-220">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b1a40-221">Если этот метод возвращает значение `false`, значит, на шаге 2 были неправильно заданы свойства подписки либо принудительная подписка не существует.</span><span class="sxs-lookup"><span data-stu-id="b1a40-221">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the push subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="b1a40-222">Вызовите метод <xref:Microsoft.SqlServer.Replication.TransSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-222">Call the <xref:Microsoft.SqlServer.Replication.TransSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="b1a40-223">Этот метод помечает подписку для повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-223">This method marks the subscription for reinitialization.</span></span>  
  
5.  <span data-ttu-id="b1a40-224">Выполните синхронизацию принудительной подписки.</span><span class="sxs-lookup"><span data-stu-id="b1a40-224">Synchronize the push subscription.</span></span> <span data-ttu-id="b1a40-225">Дополнительные сведения см. в статье [Синхронизация принудительной подписки](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-225">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="b1a40-226">Повторная инициализация подписки по запросу на публикацию слиянием</span><span class="sxs-lookup"><span data-stu-id="b1a40-226">To reinitialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="b1a40-227">Создайте соединение с подписчиком с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-227">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="b1a40-228">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.MergePullSubscription> , задайте свойства <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, а затем задайте соединение из шага 1 для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="b1a40-228">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePullSubscription> class, and set <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="b1a40-229">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b1a40-230">Если этот метод возвращает значение `false`, значит, на шаге 2 были неправильно заданы свойства подписки либо подписка по запросу не существует.</span><span class="sxs-lookup"><span data-stu-id="b1a40-230">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the pull subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="b1a40-231">Вызовите метод <xref:Microsoft.SqlServer.Replication.MergePullSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-231">Call the <xref:Microsoft.SqlServer.Replication.MergePullSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="b1a40-232">Передайте значение `true`, чтобы передать изменения на подписчике перед повторной инициализацией, или значение `false`, чтобы выполнить повторную инициализацию с потерей всех изменений, ожидающих на подписчике.</span><span class="sxs-lookup"><span data-stu-id="b1a40-232">Pass a value of `true` to upload changes at the Subscriber before reinitialization or a value of `false` to reinitialize and lose any pending changes at the Subscriber.</span></span> <span data-ttu-id="b1a40-233">Этот метод помечает подписку для повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-233">This method marks the subscription for reinitialization.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b1a40-234">Нельзя передать изменения, если срок действия подписки истек.</span><span class="sxs-lookup"><span data-stu-id="b1a40-234">Changes cannot be uploaded if the subscription is expired.</span></span> <span data-ttu-id="b1a40-235">Дополнительные сведения см. в статье [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-235">For more information, see [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span></span>  
  
5.  <span data-ttu-id="b1a40-236">Выполните синхронизацию подписки по запросу.</span><span class="sxs-lookup"><span data-stu-id="b1a40-236">Synchronize the pull subscription.</span></span> <span data-ttu-id="b1a40-237">Дополнительные сведения см. в статье [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-237">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="b1a40-238">Повторная инициализация принудительной подписки на публикацию слиянием</span><span class="sxs-lookup"><span data-stu-id="b1a40-238">To reinitialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="b1a40-239">Создайте соединение с издателем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-239">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="b1a40-240">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.MergeSubscription> , задайте свойства <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, а затем задайте соединение из шага 1 для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="b1a40-240">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class, and set <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="b1a40-241">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-241">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b1a40-242">Если этот метод возвращает значение `false`, значит, на шаге 2 были неправильно заданы свойства подписки либо принудительная подписка не существует.</span><span class="sxs-lookup"><span data-stu-id="b1a40-242">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the push subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="b1a40-243">Вызовите метод <xref:Microsoft.SqlServer.Replication.MergeSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="b1a40-243">Call the <xref:Microsoft.SqlServer.Replication.MergeSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="b1a40-244">Передайте значение `true`, чтобы передать изменения на подписчике перед повторной инициализацией, или значение `false`, чтобы выполнить повторную инициализацию с потерей всех изменений, ожидающих на подписчике.</span><span class="sxs-lookup"><span data-stu-id="b1a40-244">Pass a value of `true` to upload changes at the Subscriber before reinitialization or a value of `false` to reinitialize and lose any pending changes at the Subscriber.</span></span> <span data-ttu-id="b1a40-245">Этот метод помечает подписку для повторной инициализации.</span><span class="sxs-lookup"><span data-stu-id="b1a40-245">This method marks the subscription for reinitialization.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b1a40-246">Нельзя передать изменения, если срок действия подписки истек.</span><span class="sxs-lookup"><span data-stu-id="b1a40-246">Changes cannot be uploaded if the subscription is expired.</span></span> <span data-ttu-id="b1a40-247">Дополнительные сведения см. в статье [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-247">For more information, see [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span></span>  
  
5.  <span data-ttu-id="b1a40-248">Выполните синхронизацию принудительной подписки.</span><span class="sxs-lookup"><span data-stu-id="b1a40-248">Synchronize the push subscription.</span></span> <span data-ttu-id="b1a40-249">Дополнительные сведения см. в статье [Синхронизация принудительной подписки](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="b1a40-249">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="b1a40-250">Примеры (объекты RMO)</span><span class="sxs-lookup"><span data-stu-id="b1a40-250">Examples (RMO)</span></span>  
 <span data-ttu-id="b1a40-251">В следующем примере повторно инициализируется подписка по запросу на публикацию транзакций.</span><span class="sxs-lookup"><span data-stu-id="b1a40-251">This example reinitializes a pull subscription to a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_ReinitTranPullSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_reinittranpullsub)]  
  
 [!code-vb[HowTo#rmo_vb_ReinitTranPullSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_reinittranpullsub)]  
  
 <span data-ttu-id="b1a40-252">В этом примере повторно инициализируется подписка по запросу на публикацию слиянием после передачи ожидающих изменений на подписчик.</span><span class="sxs-lookup"><span data-stu-id="b1a40-252">This example reinitializes a pull subscription to a merge publication after first uploading pending changes at the Subscriber.</span></span>  
  
 [!code-csharp[HowTo#rmo_ReinitMergePullSub_WithUpload](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_reinitmergepullsub_withupload)]  
  
 [!code-vb[HowTo#rmo_vb_ReinitMergePullSub_WithUpload](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_reinitmergepullsub_withupload)]  
  
## <a name="see-also"></a><span data-ttu-id="b1a40-253">См. также:</span><span class="sxs-lookup"><span data-stu-id="b1a40-253">See Also</span></span>  
 <span data-ttu-id="b1a40-254">[Повторная инициализация подписок](reinitialize-subscriptions.md) </span><span class="sxs-lookup"><span data-stu-id="b1a40-254">[Reinitialize Subscriptions](reinitialize-subscriptions.md) </span></span>  
 <span data-ttu-id="b1a40-255">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="b1a40-255">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 [<span data-ttu-id="b1a40-256">Рекомендации по защите репликации</span><span class="sxs-lookup"><span data-stu-id="b1a40-256">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
