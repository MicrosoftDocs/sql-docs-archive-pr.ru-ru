---
title: Инициализация подписки вручную | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- manual subscription initialization [SQL Server replication]
- subscriptions [SQL Server replication], initializing
- initializing subscriptions [SQL Server replication], without snapshots
ms.assetid: 27a1bc38-e498-4fff-8082-04b52aa4b22c
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 4eaeb50da9e4b71a08ec78614ae62ea33e3dc0d1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655595"
---
# <a name="initialize-a-subscription-manually"></a><span data-ttu-id="30505-102">Инициализация подписки вручную</span><span class="sxs-lookup"><span data-stu-id="30505-102">Initialize a Subscription Manually</span></span>
  <span data-ttu-id="30505-103">В этом разделе описывается инициализация подписки вручную в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="30505-103">This topic describes how to initialize a subscription manually in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="30505-104">Обычно инициализация подписки производится через исходный моментальный снимок, однако подписку на публикацию можно инициализировать и другим способом. Для этого необходимо, чтобы на подписчике уже имелась схема и исходные данные.</span><span class="sxs-lookup"><span data-stu-id="30505-104">While the initial snapshot is normally used to initialize a subscription, subscriptions to publications can be initialized without using a snapshot, provided that the schema and initial data are already present at the subscriber.</span></span>  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="30505-105">Перед началом</span><span class="sxs-lookup"><span data-stu-id="30505-105">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="30505-106">Ограничения</span><span class="sxs-lookup"><span data-stu-id="30505-106">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="30505-107">Если в базе данных, опубликованной с использованием репликации транзакций, между копированием данных и схемы на подписчик и ручной инициализацией подписки выполнялись какие-либо действия, то возникшие в результате этих действий изменения данных могут не реплицироваться на подписчик.</span><span class="sxs-lookup"><span data-stu-id="30505-107">If there is activity on a database published using transactional replication between the time data and schema are copied to the Subscriber and the time at which the subscription is manually initialized, changes resulting from this activity might not be replicated to the Subscriber.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="30505-108">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="30505-108">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="30505-109">Ручная инициализация подписки на публикацию производится путем копирования схемы (а также обычно данных) в базу данных подписки.</span><span class="sxs-lookup"><span data-stu-id="30505-109">Initialize a subscription to a publication manually by copying the schema (and typically data) to the subscription database.</span></span> <span data-ttu-id="30505-110">Схема и данные должны соответствовать базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="30505-110">The schema and data should match the publication database.</span></span> <span data-ttu-id="30505-111">Затем на странице **Инициализация подписок** мастера создания подписок нужно указать, что для подписки не нужны схема и данные.</span><span class="sxs-lookup"><span data-stu-id="30505-111">Then specify that the subscription does not require schema and data on the **Initialize Subscriptions** page of the New Subscription Wizard.</span></span> <span data-ttu-id="30505-112">Дополнительные сведения о доступе к этому мастеру см. в разделах [Инициализация подписки на публикацию транзакций без моментального снимка](initialize-a-transactional-subscription-without-a-snapshot.md) и [Создание подписки по запросу](create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-112">For more information about accessing this wizard, see [Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md) and [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
 <span data-ttu-id="30505-113">При первой синхронизации подписки объекты и метаданные, необходимые для репликации, копируются в базу данных подписки.</span><span class="sxs-lookup"><span data-stu-id="30505-113">When you synchronize the subscription for the first time, the objects and metadata required by replication are copied to the subscription database.</span></span>  
  
#### <a name="to-initialize-a-subscription-to-a-publication-manually"></a><span data-ttu-id="30505-114">Инициализация подписки на публикацию вручную</span><span class="sxs-lookup"><span data-stu-id="30505-114">To initialize a subscription to a publication manually</span></span>  
  
1.  <span data-ttu-id="30505-115">Убедитесь, что схема и данные скопированы в базу данных подписки.</span><span class="sxs-lookup"><span data-stu-id="30505-115">Ensure that the schema and data are copied to the subscription database.</span></span>  
  
2.  <span data-ttu-id="30505-116">Снимите флажок **Инициализировать** на странице **Инициализация подписок** мастера создания подписок.</span><span class="sxs-lookup"><span data-stu-id="30505-116">Clear the **Initialize** check box on the **Initialize Subscriptions** page of the New Subscription Wizard.</span></span> <span data-ttu-id="30505-117">Это действие необходимо выполнить для каждой подписки, требующей копирования только объектов и метаданных репликации.</span><span class="sxs-lookup"><span data-stu-id="30505-117">Do this for each subscription that requires only replication objects and metadata to be copied.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="30505-118">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="30505-118">Using Transact-SQL</span></span>  
 <span data-ttu-id="30505-119">Подписки можно инициализированы вручную с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="30505-119">Subscriptions can be initialized manually using replication stored procedures.</span></span>  
  
#### <a name="to-manually-initialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="30505-120">Ручная инициализация подписки по запросу на публикацию транзакций</span><span class="sxs-lookup"><span data-stu-id="30505-120">To manually initialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="30505-121">Убедитесь, что схема и данные существуют в базе данных подписки.</span><span class="sxs-lookup"><span data-stu-id="30505-121">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="30505-122">Дополнительные сведения см. в статье [Инициализация подписки на публикацию транзакций без моментального снимка](initialize-a-transactional-subscription-without-a-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="30505-122">For more information, see [Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md).</span></span>  
  
2.  <span data-ttu-id="30505-123">На издателе в базе данных публикации выполните хранимую процедуру [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="30505-123">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="30505-124">Укажите **@publication** , **@subscriber** , имя базы данных на подписчике, содержащей опубликованные данные, для **@destination_db** , значение **Pull** в параметре **@subscription_type** и значение **Поддержка репликации только** для **@sync_type** .</span><span class="sxs-lookup"><span data-stu-id="30505-124">Specify **@publication**, **@subscriber**, the name of the database at the Subscriber containing the published data for **@destination_db**, a value of **pull** for **@subscription_type**, and a value of **replication support only** for **@sync_type**.</span></span> <span data-ttu-id="30505-125">Дополнительные сведения см. в статье [Создание подписки по запросу](create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-125">For more information, see [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
3.  <span data-ttu-id="30505-126">Выполните процедуру [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql)на подписчике.</span><span class="sxs-lookup"><span data-stu-id="30505-126">At the Subscriber, execute [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="30505-127">Сведения об обновлении подписок см. в разделе [Создание обновляемых подписок для публикаций транзакций](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span><span class="sxs-lookup"><span data-stu-id="30505-127">For updating subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span></span>  
  
4.  <span data-ttu-id="30505-128">Выполните процедуру [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql)на подписчике.</span><span class="sxs-lookup"><span data-stu-id="30505-128">At the Subscriber, execute [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="30505-129">Дополнительные сведения см. в статье [Создание подписки по запросу](create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-129">For more information, see [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
5.  <span data-ttu-id="30505-130">Запустите агент распространителя, чтобы передать объекты репликации и загрузить последние изменения с издателя.</span><span class="sxs-lookup"><span data-stu-id="30505-130">Start the Distribution Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="30505-131">Дополнительные сведения см. в статье [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-131">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-manually-initialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="30505-132">Ручная инициализация принудительной подписки на публикацию транзакций</span><span class="sxs-lookup"><span data-stu-id="30505-132">To manually initialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="30505-133">Убедитесь, что схема и данные существуют в базе данных подписки.</span><span class="sxs-lookup"><span data-stu-id="30505-133">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="30505-134">Дополнительные сведения см. в статье [Инициализация подписки на публикацию транзакций без моментального снимка](initialize-a-transactional-subscription-without-a-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="30505-134">For more information, see [Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md).</span></span>  
  
2.  <span data-ttu-id="30505-135">На издателе в базе данных публикации выполните хранимую процедуру [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="30505-135">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="30505-136">Укажите имя базы данных на подписчике, содержащей опубликованные данные, для **@destination_db** , значение **Push** в параметре **@subscription_type** и значение **Поддержка репликации только** для **@sync_type** .</span><span class="sxs-lookup"><span data-stu-id="30505-136">Specify the name of the database at the Subscriber containing the published data for **@destination_db**, a value of **push** for **@subscription_type**, and a value of **replication support only** for **@sync_type**.</span></span> <span data-ttu-id="30505-137">Сведения об обновлении подписок см. в разделе [Создание обновляемых подписок для публикаций транзакций](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span><span class="sxs-lookup"><span data-stu-id="30505-137">For updating subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span></span>  
  
3.  <span data-ttu-id="30505-138">На издателе в базе данных публикации выполните хранимую процедуру [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="30505-138">At the Publisher on the publication database, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="30505-139">Дополнительные сведения см. в статье [Создание принудительной подписки](create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-139">For more information, see [Create a Push Subscription](create-a-push-subscription.md).</span></span>  
  
4.  <span data-ttu-id="30505-140">Запустите агент распространителя, чтобы передать объекты репликации и загрузить последние изменения с издателя.</span><span class="sxs-lookup"><span data-stu-id="30505-140">Start the Distribution Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="30505-141">Дополнительные сведения см. в статье [Синхронизация принудительной подписки](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-141">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-manually-initialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="30505-142">Ручная инициализация подписки по запросу на публикацию слиянием</span><span class="sxs-lookup"><span data-stu-id="30505-142">To manually initialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="30505-143">Убедитесь, что схема и данные существуют в базе данных подписки.</span><span class="sxs-lookup"><span data-stu-id="30505-143">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="30505-144">Это можно сделать путем восстановления резервной копии базы данных публикации на подписчике.</span><span class="sxs-lookup"><span data-stu-id="30505-144">This can be done by restoring a backup of the publication database at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="30505-145">Выполните процедуру [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)на издателе.</span><span class="sxs-lookup"><span data-stu-id="30505-145">At the Publisher, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="30505-146">Укажите **@publication** **@subscriber** значения,, **@subscriber_db** и значение **Pull** для **@subscription_type** .</span><span class="sxs-lookup"><span data-stu-id="30505-146">Specify **@publication**, **@subscriber**, **@subscriber_db**, and a value of **pull** for **@subscription_type**.</span></span> <span data-ttu-id="30505-147">После этого подписка по запросу будет зарегистрирована.</span><span class="sxs-lookup"><span data-stu-id="30505-147">This registers the pull subscription.</span></span>  
  
3.  <span data-ttu-id="30505-148">На подписчике в базе данных, содержащей публикуемые данные, выполните хранимую процедуру [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="30505-148">At the Subscriber on the database containing the published data, execute [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="30505-149">В параметре **@sync_type** в параметре **@sync_type**.</span><span class="sxs-lookup"><span data-stu-id="30505-149">Specify a value of **none** for **@sync_type**.</span></span>  
  
4.  <span data-ttu-id="30505-150">Выполните процедуру [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)на подписчике.</span><span class="sxs-lookup"><span data-stu-id="30505-150">At the Subscriber, execute [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="30505-151">Дополнительные сведения см. в статье [Создание подписки по запросу](create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-151">For more information, see [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
5.  <span data-ttu-id="30505-152">Запустите агент слияния, чтобы передать объекты репликации и загрузить последние изменения с издателя.</span><span class="sxs-lookup"><span data-stu-id="30505-152">Start the Merge Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="30505-153">Дополнительные сведения см. в статье [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-153">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-manually-initialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="30505-154">Ручная инициализация принудительной подписки на публикацию слиянием</span><span class="sxs-lookup"><span data-stu-id="30505-154">To manually initialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="30505-155">Убедитесь, что схема и данные существуют в базе данных подписки.</span><span class="sxs-lookup"><span data-stu-id="30505-155">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="30505-156">Это можно сделать путем восстановления резервной копии базы данных публикации на подписчике.</span><span class="sxs-lookup"><span data-stu-id="30505-156">This can be done by restoring a backup of the publication database at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="30505-157">В базе данных публикации на издателе выполните процедуру [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="30505-157">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="30505-158">Укажите имя базы данных на подписчике, содержащей опубликованные данные, для **@subscriber_db** , значение **Push** в параметре **@subscription_type** и значение **None** в параметре **@sync_type** .</span><span class="sxs-lookup"><span data-stu-id="30505-158">Specify the name of the database at the Subscriber containing the published data for **@subscriber_db**, a value of **push** for **@subscription_type**, and a value of **none** for **@sync_type**.</span></span>  
  
3.  <span data-ttu-id="30505-159">На издателе в базе данных публикации выполните хранимую процедуру [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="30505-159">At the Publisher on the publication database, execute [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="30505-160">Дополнительные сведения см. в статье [Создание принудительной подписки](create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-160">For more information, see [Create a Push Subscription](create-a-push-subscription.md).</span></span>  
  
4.  <span data-ttu-id="30505-161">Запустите агент слияния, чтобы передать объекты репликации и загрузить последние изменения с издателя.</span><span class="sxs-lookup"><span data-stu-id="30505-161">Start the Merge Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="30505-162">Дополнительные сведения см. в статье [Синхронизация принудительной подписки](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="30505-162">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="30505-163">См. также:</span><span class="sxs-lookup"><span data-stu-id="30505-163">See Also</span></span>  
 <span data-ttu-id="30505-164">[Инициализация подписки на публикацию транзакций без моментального снимка](initialize-a-transactional-subscription-without-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="30505-164">[Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md) </span></span>  
 <span data-ttu-id="30505-165">[Создание резервной копии и восстановление из копий реплицируемых баз данных](administration/back-up-and-restore-replicated-databases.md) </span><span class="sxs-lookup"><span data-stu-id="30505-165">[Back Up and Restore Replicated Databases](administration/back-up-and-restore-replicated-databases.md) </span></span>  
 [<span data-ttu-id="30505-166">Рекомендации по защите репликации</span><span class="sxs-lookup"><span data-stu-id="30505-166">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
