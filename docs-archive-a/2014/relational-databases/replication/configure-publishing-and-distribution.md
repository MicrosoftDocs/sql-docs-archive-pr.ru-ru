---
title: Настройка публикации и распространения | Документация Майкрософт
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], distribution
- distribution configuration [SQL Server replication]
- publishing [SQL Server replication], configuring
ms.assetid: 3cfc8966-833e-42fa-80cb-09175d1feed7
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: afd1544b5412c6ce2d83a9a1e9a50ddf662b3056
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655101"
---
# <a name="configure-publishing-and-distribution"></a><span data-ttu-id="2e3c5-102">Настройка публикации и распространения</span><span class="sxs-lookup"><span data-stu-id="2e3c5-102">Configure Publishing and Distribution</span></span>
  <span data-ttu-id="2e3c5-103">В данном разделе описывается процесс настройки публикации и распространения в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]или объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-103">This topic describes how to configure publishing and distribution in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="2e3c5-104">Перед началом</span><span class="sxs-lookup"><span data-stu-id="2e3c5-104">Before You Begin</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="2e3c5-105">безопасность</span><span class="sxs-lookup"><span data-stu-id="2e3c5-105">Security</span></span>  
 <span data-ttu-id="2e3c5-106">Дополнительные сведения см. в разделе [безопасное развертывание репликации](security/view-and-modify-replication-security-settings.md).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-106">For more information, see [Secure Replication Deployment](security/view-and-modify-replication-security-settings.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="2e3c5-107">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="2e3c5-107">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="2e3c5-108">Настройте распространение с помощью мастера создания публикаций или мастера настройки распространителя.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-108">Configure distribution using the New Publication Wizard or the Configure Distribution Wizard.</span></span> <span data-ttu-id="2e3c5-109">После настройки распространителя просмотрите и измените его свойства в диалоговом окне **Свойства распространителя — \<Distributor>** .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-109">After the Distributor is configured, view and modify properties in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="2e3c5-110">Используйте мастер настройки распространителя, если требуется настроить распространитель так, чтобы члены предопределенных ролей базы данных **db_owner** могли создавать публикации, или если требуется настроить удаленный распространитель, который не является издателем.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-110">Use the Configure Distribution Wizard if you want to configure a Distributor so that members of the **db_owner** fixed database roles can create publications, or because you want to configure a remote Distributor that is not a Publisher.</span></span>  
  
#### <a name="to-configure-distribution"></a><span data-ttu-id="2e3c5-111">Настройка распространения</span><span class="sxs-lookup"><span data-stu-id="2e3c5-111">To configure distribution</span></span>  
  
1.  <span data-ttu-id="2e3c5-112">В среде [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] подключитесь к серверу, который будет выступать в роли распространителя (в большинстве случаев издатель и распространитель являются одним сервером), и разверните узел сервера.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-112">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], connect to the server that will be the Distributor (in many cases, the Publisher and Distributor are the same server), and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="2e3c5-113">Щелкните правой кнопкой мыши папку **Репликация** , затем щелкните **Настройка распространения**.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-113">Right-click the **Replication** folder, and then click **Configure Distribution**.</span></span>  
  
3.  <span data-ttu-id="2e3c5-114">Выполняйте инструкции мастера настройки распространителя:</span><span class="sxs-lookup"><span data-stu-id="2e3c5-114">Follow the Configure Distribution Wizard to:</span></span>  
  
    -   <span data-ttu-id="2e3c5-115">Выберите распространитель.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-115">Select a Distributor.</span></span> <span data-ttu-id="2e3c5-116">Чтобы использовать локальный распространитель, выберите **" \<ServerName> " будет работать как собственный распространитель; SQL Server создаст базу данных распространителя и журнал**.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-116">To use a local Distributor, select **'\<ServerName>' will act as its own Distributor; SQL Server will create a distribution database and log**.</span></span> <span data-ttu-id="2e3c5-117">Для использования удаленного распространителя выберите **Использовать следующий сервер в качестве распространителя**, а затем выберите сервер.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-117">To use a remote Distributor, select **Use the following server as the Distributor**, and then select a server.</span></span> <span data-ttu-id="2e3c5-118">Сервер должен быть сконфигурирован в качестве распространителя, а издатель должен быть включен для использования распространителя.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-118">The server must already be configured as a Distributor, and the Publisher must be enabled to use the Distributor.</span></span> <span data-ttu-id="2e3c5-119">Дополнительные сведения см. в разделе [Включение удаленного издателя на распространителе (среда SQL Server Management Studio)](enable-a-remote-publisher-at-a-distributor-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-119">For more information, see [Enable a Remote Publisher at a Distributor &#40;SQL Server Management Studio&#41;](enable-a-remote-publisher-at-a-distributor-sql-server-management-studio.md).</span></span>  
  
         <span data-ttu-id="2e3c5-120">Если выбран удаленный распространитель, необходимо ввести пароль на странице **Административный пароль** , который требуется для соединения издателя с распространителем.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-120">If you select a remote Distributor, you must enter a password on the **Administrative Password** page for connections made from the Publisher to the Distributor.</span></span> <span data-ttu-id="2e3c5-121">Пароль должен совпадать с паролем, указанным при включении издателя на удаленном распространителе.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-121">This password must match the password specified when the Publisher was enabled at the remote Distributor.</span></span>  
  
    -   <span data-ttu-id="2e3c5-122">Укажите корневую папку моментальных снимков (для локального распространителя).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-122">Specify a root snapshot folder (for a local Distributor).</span></span> <span data-ttu-id="2e3c5-123">Папка моментальных снимков — это просто каталог, назначенный для совместного использования; агенты, считывающие и записывающие данные в эту папку, должны иметь достаточные разрешения для доступа к ней.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-123">The snapshot folder is simply a directory that you have designated as a share; agents that read from and write to this folder must have sufficient permissions to access it.</span></span> <span data-ttu-id="2e3c5-124">Каждый издатель, использующий распространитель, создает папку в корневой папке, каждая публикация создает папки в папке «Издатель», в которой хранятся файлы моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-124">Each Publisher that uses this Distributor creates a folder under the root folder, and each publication creates folders under the Publisher folder in which to store snapshot files.</span></span> <span data-ttu-id="2e3c5-125">Дополнительные сведения о надлежащей защите папок см. в разделе [Организация безопасности папки моментальных снимков](security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-125">For more information on securing the folder appropriately, see [Secure the Snapshot Folder](security/secure-the-snapshot-folder.md).</span></span>  
  
    -   <span data-ttu-id="2e3c5-126">Укажите базу данных распространителя (для локального распространителя).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-126">Specify the distribution database (for a local Distributor).</span></span> <span data-ttu-id="2e3c5-127">В базе данных распространителя хранятся метаданные и данные журнала для всех типов репликации и транзакций, относящихся к репликации транзакций.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-127">The distribution database stores metadata and history data for all types of replication and transactions for transactional replication.</span></span>  
  
    -   <span data-ttu-id="2e3c5-128">При необходимости укажите, что другие издатели могут использовать распространитель.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-128">Optionally enable other Publishers to use the Distributor.</span></span> <span data-ttu-id="2e3c5-129">Если другим издателям разрешено использовать распространитель, необходимо ввести пароль на странице **Пароль распространителя** , который используется для подключения этих издателей к распространителю.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-129">If other Publishers are enabled to use the Distributor, you must enter a password on the **Distributor Password** page for connections made from these Publishers to the Distributor.</span></span>  
  
    -   <span data-ttu-id="2e3c5-130">При необходимости создайте скрипт настроек конфигурации.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-130">Optionally script configuration settings.</span></span> <span data-ttu-id="2e3c5-131">Дополнительные сведения см. в разделе [Scripting Replication](scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-131">For more information, see [Scripting Replication](scripting-replication.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="2e3c5-132">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="2e3c5-132">Using Transact-SQL</span></span>  
 <span data-ttu-id="2e3c5-133">Публикацию и распространение репликации можно настроить программно с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-133">Replication publishing and distribution can be configured programmatically using replication stored procedures.</span></span>  
  
#### <a name="to-configure-publishing-using-a-local-distributor"></a><span data-ttu-id="2e3c5-134">Настройка публикации с помощью локального распространителя</span><span class="sxs-lookup"><span data-stu-id="2e3c5-134">To configure publishing using a local distributor</span></span>  
  
1.  <span data-ttu-id="2e3c5-135">Чтобы определить, настроен ли сервер в качестве распространителя, выполните процедуру, описанную в разделе [sp_get_distributor (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-135">Execute [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) to determine if the server is already configured as a Distributor.</span></span>  
  
    -   <span data-ttu-id="2e3c5-136">Если значение **installed** в результирующем наборе равно **0**, выполните процедуру [sp_adddistributor (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) на распространителе в базе данных master.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-136">If the value of **installed** in the result set is **0**, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) at the Distributor on the master database.</span></span>  
  
    -   <span data-ttu-id="2e3c5-137">Если значение **distribution db installed** в результирующем наборе равно **0**, выполните процедуру [sp_adddistributiondb (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) на распространителе в базе данных master.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-137">If the value of **distribution db installed** in the result set is **0**, execute [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="2e3c5-138">Укажите имя базы данных распространителя для \*\* \@ базы данных\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-138">Specify the name of the distribution database for **\@database**.</span></span> <span data-ttu-id="2e3c5-139">При необходимости можно указать максимальный срок хранения транзакций для \*\* \@ max_distretention\*\* и срок хранения журнала для \*\* \@ history_retention\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-139">Optionally, you can specify the maximum transactional retention period for **\@max_distretention** and the history retention period for **\@history_retention**.</span></span> <span data-ttu-id="2e3c5-140">Если создается новая база данных, укажите желаемые параметры свойств.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-140">If a new database is being created, specify the desired database property parameters.</span></span>  
  
2.  <span data-ttu-id="2e3c5-141">На распространителе, который также является издателем, выполните [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), указав общий ресурс UNC, который будет использоваться в качестве папки моментальных снимков по умолчанию для \*\* \@ working_directory\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-141">At the Distributor, which is also the Publisher, execute [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specifying the UNC share that will be used as default snapshot folder for **\@working_directory**.</span></span>  
  
3.  <span data-ttu-id="2e3c5-142">На издателе выполните процедуру [sp_replicationdboption (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-142">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span> <span data-ttu-id="2e3c5-143">Укажите базу данных, публикуемую для параметра \*\* \@ dbname**, тип репликации для \*\* \@ optname**, а также значение `true` для параметра \*\* \@ значение\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-143">Specify the database being published for **\@dbname**, the type of replication for **\@optname**, and a value of `true` for **\@value**.</span></span>  
  
#### <a name="to-configure-publishing-using-a-remote-distributor"></a><span data-ttu-id="2e3c5-144">Настройка публикации с помощью удаленного распространителя</span><span class="sxs-lookup"><span data-stu-id="2e3c5-144">To configure publishing using a remote distributor</span></span>  
  
1.  <span data-ttu-id="2e3c5-145">Чтобы определить, настроен ли сервер в качестве распространителя, выполните процедуру, описанную в разделе [sp_get_distributor (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-145">Execute [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) to determine if the server is already configured as a Distributor.</span></span>  
  
    -   <span data-ttu-id="2e3c5-146">Если значение **installed** в результирующем наборе равно **0**, выполните процедуру [sp_adddistributor (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) на распространителе в базе данных master.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-146">If the value of **installed** in the result set is **0**, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="2e3c5-147">Укажите надежный пароль для \*\* \@ пароля\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-147">Specify a strong password for **\@password**.</span></span> <span data-ttu-id="2e3c5-148">Этот пароль для учетной записи **distributor_admin** используется издателем при соединении с распространителем.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-148">This password for the **distributor_admin** account will be used by the Publisher when connecting to the Distributor.</span></span>  
  
    -   <span data-ttu-id="2e3c5-149">Если значение **distribution db installed** в результирующем наборе равно **0**, выполните процедуру [sp_adddistributiondb (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) на распространителе в базе данных master.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-149">If the value of **distribution db installed** in the result set is **0**, execute [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="2e3c5-150">Укажите имя базы данных распространителя для \*\* \@ базы данных\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-150">Specify the name of the distribution database for **\@database**.</span></span> <span data-ttu-id="2e3c5-151">При необходимости можно указать максимальный срок хранения транзакций для \*\* \@ max_distretention\*\* и срок хранения журнала для \*\* \@ history_retention\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-151">Optionally, you can specify the maximum transactional retention period for **\@max_distretention** and the history retention period for **\@history_retention**.</span></span> <span data-ttu-id="2e3c5-152">Если создается новая база данных, укажите желаемые параметры свойств.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-152">If a new database is being created, specify the desired database property parameters.</span></span>  
  
2.  <span data-ttu-id="2e3c5-153">На распространителе выполните [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), указав общий ресурс UNC, который будет использоваться в качестве папки моментальных снимков по умолчанию для \*\* \@ working_directory\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-153">At the Distributor, execute [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specifying the UNC share that will be used as default snapshot folder for **\@working_directory**.</span></span> <span data-ttu-id="2e3c5-154">Если распространитель будет использовать [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] проверку подлинности при соединении с издателем, необходимо также указать значение **0** для \*\* \@ security_mode\*\* и [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] сведения об имени входа для \*\* \@ входа\*\* и \*\* \@ пароля\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-154">If the Distributor will use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **\@login** and **\@password**.</span></span>  
  
3.  <span data-ttu-id="2e3c5-155">На издателе в базе данных master выполните процедуру [sp_adddistributor (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-155">At the Publisher on the master database, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql).</span></span> <span data-ttu-id="2e3c5-156">Укажите надежный пароль, используемый в шаге 1 для \*\* \@ пароля\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-156">Specify the strong password used in step 1 for **\@password**.</span></span> <span data-ttu-id="2e3c5-157">Этот пароль будет использоваться издателем при соединении с распространителем.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-157">This password will be used by the Publisher when connecting to the Distributor.</span></span>  
  
4.  <span data-ttu-id="2e3c5-158">На издателе выполните процедуру [sp_replicationdboption (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-158">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span> <span data-ttu-id="2e3c5-159">Укажите базу данных, публикуемую для параметра \*\* \@ dbname**, тип репликации для \*\* \@ optname**и значение true для \*\* \@ параметра значение\*\*.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-159">Specify the database being published for **\@dbname**, the type of replication for **\@optname**, and a value of true for **\@value**.</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="2e3c5-160">Примеры (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="2e3c5-160">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="2e3c5-161">В следующих разделах описывается программная настройка публикации и распространения.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-161">The following example demonstrates how to configure publishing and distribution programmatically.</span></span> <span data-ttu-id="2e3c5-162">В этом примере имя сервера, настраиваемого в качестве издателя и локального распространителя, указывается с помощью переменных скрипта.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-162">In this example, the name of the server that is being configured as a publisher and a local distributor is supplied using scripting variables.</span></span> <span data-ttu-id="2e3c5-163">Публикацию и распространение репликации можно настроить программно с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-163">Replication publishing and distribution can be configured programmatically using replication stored procedures.</span></span>  
  
 [!code-sql[HowTo#AddDistPub](../../snippets/tsql/SQL15/replication/howto/tsql/adddistpub.sql#adddistpub)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="2e3c5-164">При помощи объектов RMO</span><span class="sxs-lookup"><span data-stu-id="2e3c5-164">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-configure-publishing-and-distribution-on-a-single-server"></a><span data-ttu-id="2e3c5-165">Настройка публикации и распространения на одиночном сервере</span><span class="sxs-lookup"><span data-stu-id="2e3c5-165">To configure publishing and distribution on a single server</span></span>  
  
1.  <span data-ttu-id="2e3c5-166">Создайте соединение с сервером с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-166">Create a connection to the server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="2e3c5-167">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-167">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="2e3c5-168">Передайте объект <xref:Microsoft.SqlServer.Management.Common.ServerConnection> , созданный на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-168">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="2e3c5-169">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.DistributionDatabase>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-169">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> class.</span></span>  
  
4.  <span data-ttu-id="2e3c5-170">Задайте для свойства <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> имя базы данных, а для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> — значение <xref:Microsoft.SqlServer.Management.Common.ServerConnection> из шага 1.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-170">Set the <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> property to the database name and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
5.  <span data-ttu-id="2e3c5-171">Установите распространитель, вызвав метод <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-171">Install the Distributor by calling the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="2e3c5-172">Передайте объект <xref:Microsoft.SqlServer.Replication.DistributionDatabase> , созданный на шаге 3.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-172">Pass the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> object from step 3.</span></span>  
  
6.  <span data-ttu-id="2e3c5-173">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.DistributionPublisher>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-173">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionPublisher> class.</span></span>  
  
7.  <span data-ttu-id="2e3c5-174">Установите следующие свойства <xref:Microsoft.SqlServer.Replication.DistributionPublisher>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-174">Set the following properties of <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span></span>  
  
    -   <span data-ttu-id="2e3c5-175"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> — имя издателя.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-175"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - name of the Publisher.</span></span>  
  
    -   <span data-ttu-id="2e3c5-176"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> — соединение <xref:Microsoft.SqlServer.Management.Common.ServerConnection> , созданное на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-176"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
    -   <span data-ttu-id="2e3c5-177"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> — название базы данных, созданной на шаге 5.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-177"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - the name of the database created in step 5.</span></span>  
  
    -   <span data-ttu-id="2e3c5-178"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> — общая папка, используемая для доступа к файлам моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-178"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - the share used to access snapshot files.</span></span>  
  
    -   <span data-ttu-id="2e3c5-179"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> — режим безопасности при соединении с издателем.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-179"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - the security mode used when connecting to the Publisher.</span></span> <span data-ttu-id="2e3c5-180">Рекомендуется<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-180"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> is recommended.</span></span>  
  
8.  <span data-ttu-id="2e3c5-181">Вызовите метод <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-181">Call the <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> method.</span></span>  
  
#### <a name="to-configure-publishing-and-distribution-using-a-remote-distributor"></a><span data-ttu-id="2e3c5-182">Настройка публикации и распространения с использованием удаленного распространителя</span><span class="sxs-lookup"><span data-stu-id="2e3c5-182">To configure publishing and distribution using a remote Distributor</span></span>  
  
1.  <span data-ttu-id="2e3c5-183">Создайте соединение с удаленным распространителем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-183">Create a connection to the remote Distributor server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="2e3c5-184">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-184">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="2e3c5-185">Передайте объект <xref:Microsoft.SqlServer.Management.Common.ServerConnection> , созданный на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-185">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="2e3c5-186">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.DistributionDatabase>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> class.</span></span>  
  
4.  <span data-ttu-id="2e3c5-187">Задайте для свойства <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> имя базы данных, а для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> — значение <xref:Microsoft.SqlServer.Management.Common.ServerConnection> из шага 1.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-187">Set the <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> property to the database name, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
5.  <span data-ttu-id="2e3c5-188">Установите распространитель, вызвав метод <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-188">Install the Distributor by calling the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="2e3c5-189">Укажите безопасный пароль (используемый издателем для соединения с удаленным распространителем) и объект <xref:Microsoft.SqlServer.Replication.DistributionDatabase> из шага 3.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-189">Specify a secure password (used by the Publisher when connecting to the remote Distributor) and the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> object from step 3.</span></span> <span data-ttu-id="2e3c5-190">Дополнительные сведения см. в разделе [Организация безопасности распространителя](security/secure-the-distributor.md).</span><span class="sxs-lookup"><span data-stu-id="2e3c5-190">For more information, see [Secure the Distributor](security/secure-the-distributor.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="2e3c5-191">По возможности предлагайте пользователям вводить учетные данные системы безопасности во время выполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-191">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="2e3c5-192">Если необходимо хранить учетные данные, используйте [службы шифрования](https://go.microsoft.com/fwlink/?LinkId=34733) , предоставляемые платформой [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-192">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
6.  <span data-ttu-id="2e3c5-193">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.DistributionPublisher>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-193">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionPublisher> class.</span></span>  
  
7.  <span data-ttu-id="2e3c5-194">Установите следующие свойства <xref:Microsoft.SqlServer.Replication.DistributionPublisher>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-194">Set the following properties of <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span></span>  
  
    -   <span data-ttu-id="2e3c5-195"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> — имя локального издателя.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-195"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - name of the local Publisher server.</span></span>  
  
    -   <span data-ttu-id="2e3c5-196"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> — соединение <xref:Microsoft.SqlServer.Management.Common.ServerConnection> , созданное на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-196"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
    -   <span data-ttu-id="2e3c5-197"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> — название базы данных, созданной на шаге 5.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-197"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - the name of the database created in step 5.</span></span>  
  
    -   <span data-ttu-id="2e3c5-198"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> — общая папка, используемая для доступа к файлам моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-198"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - the share used to access snapshot files.</span></span>  
  
    -   <span data-ttu-id="2e3c5-199"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> — режим безопасности при соединении с издателем.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-199"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - the security mode used when connecting to the Publisher.</span></span> <span data-ttu-id="2e3c5-200">Рекомендуется<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-200"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> is recommended.</span></span>  
  
8.  <span data-ttu-id="2e3c5-201">Вызовите метод <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-201">Call the <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> method.</span></span>  
  
9. <span data-ttu-id="2e3c5-202">Создайте соединение с локальным издателем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-202">Create a connection to the local Publisher server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
10. <span data-ttu-id="2e3c5-203">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-203">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="2e3c5-204">Передайте объект <xref:Microsoft.SqlServer.Management.Common.ServerConnection> , созданный на шаге 9.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-204">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 9.</span></span>  
  
11. <span data-ttu-id="2e3c5-205">Вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e3c5-205">Call the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="2e3c5-206">Передайте имя удаленного распространителя и пароль для удаленного распространителя, указанный в шаге 5.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-206">Pass the name of the remote Distributor and the password for the remote Distributor specified in step 5.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="2e3c5-207">По возможности предлагайте пользователям вводить учетные данные системы безопасности во время выполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-207">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="2e3c5-208">Если необходимо хранить учетные данные, используйте [службы шифрования](https://go.microsoft.com/fwlink/?LinkId=34733) , предоставляемые платформой Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-208">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the Windows .NET Framework.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="2e3c5-209">Пример (объекты RMO)</span><span class="sxs-lookup"><span data-stu-id="2e3c5-209">Example (RMO)</span></span>  
 <span data-ttu-id="2e3c5-210">Публикацию и распространение репликации можно настраивать программно, с помощью объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="2e3c5-210">You can programmatically configure replication publishing and distribution by using Replication Management Objects (RMO).</span></span>  
  
 [!code-csharp[HowTo#rmo_AddDistPub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_adddistpub)]  
  
 [!code-vb[HowTo#rmo_vb_AddDistPub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_adddistpub)]  
  
## <a name="see-also"></a><span data-ttu-id="2e3c5-211">См. также:</span><span class="sxs-lookup"><span data-stu-id="2e3c5-211">See Also</span></span>  
 <span data-ttu-id="2e3c5-212">[Просмотр и изменение свойств издателя и распространителя](view-and-modify-distributor-and-publisher-properties.md) </span><span class="sxs-lookup"><span data-stu-id="2e3c5-212">[View and Modify Distributor and Publisher Properties](view-and-modify-distributor-and-publisher-properties.md) </span></span>  
 <span data-ttu-id="2e3c5-213">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="2e3c5-213">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 <span data-ttu-id="2e3c5-214">[Настройка распространения](configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="2e3c5-214">[Configure Distribution](configure-distribution.md) </span></span>  
 <span data-ttu-id="2e3c5-215">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="2e3c5-215">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 [<span data-ttu-id="2e3c5-216">Настройка репликации для группы доступности AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2e3c5-216">Configure Replication for AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](../../database-engine/availability-groups/windows/always-on-availability-groups-sql-server.md) 
  
  
