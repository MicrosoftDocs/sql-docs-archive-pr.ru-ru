---
title: Указание свойств репликации слиянием | Документация Майкрософт
ms.custom: ''
ms.date: 11/29/2018
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication [SQL Server replication], about merge replication
- merge replication [SQL Server replication]
ms.assetid: ff87c368-4c00-4e48-809d-ea752839551e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 3b2e66b7ed26420093166445a478bfec7f1dd21d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87735210"
---
# <a name="specify-merge-replication-properties"></a><span data-ttu-id="d159b-102">Указание свойств репликации слиянием</span><span class="sxs-lookup"><span data-stu-id="d159b-102">Specify Merge Replication Properties</span></span>
<span data-ttu-id="d159b-103">Этот раздел описывает, как определить различные свойства для репликации слиянием.</span><span class="sxs-lookup"><span data-stu-id="d159b-103">This topic explains how to specify various properties for your merge replication.</span></span> 


## <a name="download-only"></a><span data-ttu-id="d159b-104">Только для загрузки</span><span class="sxs-lookup"><span data-stu-id="d159b-104">Download-only</span></span>
  <span data-ttu-id="d159b-105">В этом разделе описывается, как указать, что статья слияния таблиц доступна только для загрузки в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] с помощью [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d159b-105">This section describes how to specify that a merge table article is download-only in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="d159b-106">Статьи, предназначенные только для загрузки, создаются для приложений с данными, не обновляемыми на подписчиках.</span><span class="sxs-lookup"><span data-stu-id="d159b-106">Download-only articles are designed for applications with data that is not updated at Subscribers.</span></span> <span data-ttu-id="d159b-107">Дополнительные сведения см. в статье [Оптимизация производительности репликации слиянием при работе со статьями, доступными только для загрузки](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-107">For more information, see [Optimize Merge Replication Performance with Download-Only Articles](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span></span>  
 
  
###  <a name="limitations-and-restrictions"></a><span data-ttu-id="d159b-108">Ограничения</span><span class="sxs-lookup"><span data-stu-id="d159b-108">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="d159b-109">Если указать, что статья доступна только для загрузки после инициализации подписок, потребуется провести повторную инициализацию всех клиентских подписок, получивших эту статью.</span><span class="sxs-lookup"><span data-stu-id="d159b-109">If you specify that an article is download-only after subscriptions have been initialized, all client subscriptions that received the article must be reinitialized.</span></span> <span data-ttu-id="d159b-110">В повторной инициализации серверных подписок необходимости нет.</span><span class="sxs-lookup"><span data-stu-id="d159b-110">Server subscriptions do not have to be reinitialized.</span></span> <span data-ttu-id="d159b-111">Дополнительные сведения о последствиях изменения свойств см. в статье [Изменение свойств публикации и статьи](change-publication-and-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-111">For more information on the effects of property changes, see [Change Publication and Article Properties](change-publication-and-article-properties.md).</span></span>  
  
### <a name="using-sql-server-management-studio"></a><span data-ttu-id="d159b-112">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="d159b-112">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="d159b-113">Укажите, что статья доступна только для загрузки, на странице **статьи** мастера создания публикаций или на вкладке **Свойства** диалогового окна \*\*Свойства статьи — \<Article> \*\* .</span><span class="sxs-lookup"><span data-stu-id="d159b-113">Specify that an article is download-only on the **Articles** page of the New Publication Wizard or the **Properties** tab of the **Article Properties - \<Article>** dialog box.</span></span> <span data-ttu-id="d159b-114">Это диалоговое окно доступно в мастере создания публикаций и в диалоговом окне **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="d159b-114">This dialog box is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="d159b-115">Дополнительные сведения об использовании мастера и доступе к этому диалоговому окну см. в статьях [Создание публикации](../publish/create-a-publication.md) и [Просмотр и изменение свойств публикации](../publish/view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-115">For more information about using the wizard and accessing the dialog box, see [Create a Publication](../publish/create-a-publication.md) and [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-specify-that-an-article-is-download-only-on-the-articles-page"></a><span data-ttu-id="d159b-116">Указание на странице «Статьи», что статья доступна только для загрузки</span><span class="sxs-lookup"><span data-stu-id="d159b-116">To specify that an article is download-only on the Articles page</span></span>  
  
-   <span data-ttu-id="d159b-117">На странице **Статьи** мастера создания публикаций выберите таблицу, затем установите флажок **Выделенная таблица предназначена только для загрузки**.</span><span class="sxs-lookup"><span data-stu-id="d159b-117">On the **Articles** page of the New Publication Wizard select a table, and then select the checkbox **Highlighted table is download-only**.</span></span> 
  
#### <a name="to-specify-that-an-article-is-download-only-on-the-properties-tab-of-the-article-properties---article-dialog-box"></a><span data-ttu-id="d159b-118">Указание того, что статья доступна только для загрузки, на вкладке «Свойства \<Article> » диалогового окна Свойства статьи —</span><span class="sxs-lookup"><span data-stu-id="d159b-118">To specify that an article is download-only on the Properties tab of the Article Properties - \<Article> dialog box</span></span>  
  
1.  <span data-ttu-id="d159b-119">На странице **Статьи** мастера создания публикаций или в диалоговом окне **Свойства публикации — \<Publication>** выберите таблицу и щелкните **Свойства статьи**.</span><span class="sxs-lookup"><span data-stu-id="d159b-119">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table, and then click **Article Properties**.</span></span>    
2.  <span data-ttu-id="d159b-120">Щелкните **Указать свойства выделенной статьи таблицы** или **Указать свойства всех статей таблиц**.</span><span class="sxs-lookup"><span data-stu-id="d159b-120">Click **Set Properties of Highlighted Table Article** or **Set Properties of All Table Articles**.</span></span>    
3.  <span data-ttu-id="d159b-121">В разделе **Целевой объект** вкладки **Свойства** диалогового окна **Свойства статьи — \<Article>** укажите одно из следующих значений для параметра **Направление синхронизации**.</span><span class="sxs-lookup"><span data-stu-id="d159b-121">In the **Destination Object** section of the **Properties** tab of the **Article Properties - \<Article>** dialog box, specify one of the following values for **Synchronization direction**:</span></span>    
    -   <span data-ttu-id="d159b-122">**Загрузка на подписчик, запретить изменения на подписчике**</span><span class="sxs-lookup"><span data-stu-id="d159b-122">**Download to Subscriber, prohibit Subscriber changes**</span></span>    
    -   <span data-ttu-id="d159b-123">**Загрузка на подписчик, разрешить изменения на подписчике**</span><span class="sxs-lookup"><span data-stu-id="d159b-123">**Download to Subscriber, allow Subscriber changes**</span></span>  
  
4.  <span data-ttu-id="d159b-124">Если вы находитесь в диалоговом окне **Свойства публикации — \<Publication>** , нажмите кнопку **ОК**, чтобы сохранить результаты и закрыть диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="d159b-124">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>    

###  <a name="using-transact-sql"></a><span data-ttu-id="d159b-125">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d159b-125">Using Transact-SQL</span></span>  
  
#### <a name="to-specify-that-a-new-merge-table-article-is-download-only"></a><span data-ttu-id="d159b-126">Указание того, что новая статья таблицы публикации слиянием предназначена только для загрузки</span><span class="sxs-lookup"><span data-stu-id="d159b-126">To specify that a new merge table article is download-only</span></span>    
1.  <span data-ttu-id="d159b-127">Выполните [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), указав значение **1** или **2** для параметра \*\* \@ subscriber_upload_options\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-127">Execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), specifying a value of **1** or **2** for the parameter **\@subscriber_upload_options**.</span></span> <span data-ttu-id="d159b-128">Числа соответствуют следующему поведению.</span><span class="sxs-lookup"><span data-stu-id="d159b-128">The numbers correspond to the following behavior:</span></span>  
  
    -   <span data-ttu-id="d159b-129">**0** = без ограничений (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="d159b-129">**0** - No restrictions (default).</span></span> <span data-ttu-id="d159b-130">Изменения, произведенные на подписчике, передаются на издатель.</span><span class="sxs-lookup"><span data-stu-id="d159b-130">Changes made at the Subscriber are uploaded to the Publisher.</span></span>    
    -   <span data-ttu-id="d159b-131">**1** — изменения на подписчике разрешены, но они не передаются на издатель.</span><span class="sxs-lookup"><span data-stu-id="d159b-131">**1** - Changes are allowed at the Subscriber, but they are not uploaded to the Publisher.</span></span>    
    -   <span data-ttu-id="d159b-132">**2** — изменения на подписчике не разрешены.</span><span class="sxs-lookup"><span data-stu-id="d159b-132">**2** - Changes are not allowed at the Subscriber.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="d159b-133">Если исходная таблица для статьи уже опубликована в другой публикации, то значение \*\* \@ subscriber_upload_options\*\* должно быть одинаковым для обеих статей.</span><span class="sxs-lookup"><span data-stu-id="d159b-133">If the source table for an article is already published in another publication, the value of **\@subscriber_upload_options** must be the same for both articles.</span></span>  
  
#### <a name="to-modify-an-existing-merge-table-article-to-be-download-only"></a><span data-ttu-id="d159b-134">Изменение существующей статьи публикации слиянием с целью сделать ее доступной только для загрузки</span><span class="sxs-lookup"><span data-stu-id="d159b-134">To modify an existing merge table article to be download-only</span></span>  
  
1.  <span data-ttu-id="d159b-135">Чтобы определить, является ли статья доступной только для загрузки, выполните хранимую процедуру [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-135">To determine if an article is download-only, execute [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span></span> <span data-ttu-id="d159b-136">Запомните значение **upload_options** для статьи в результирующем наборе.</span><span class="sxs-lookup"><span data-stu-id="d159b-136">Note the value of **upload_options** for the article in the result set.</span></span>    
2.  <span data-ttu-id="d159b-137">Если значение, возвращаемое на шаге 1, равно **0**, выполните [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), указав значение **subscriber_upload_options** для \*\* \@ Свойства**, значение **1** для \*\* \@ force_invalidate_snapshot** и \*\* \@ force_reinit_subscription**и значение **1** или **2** в качестве \*\* \@ значения**, которое соответствует следующему поведению:</span><span class="sxs-lookup"><span data-stu-id="d159b-137">If the value returned in step 1 is **0**, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying a value of **subscriber_upload_options** for **\@property**, a value of **1** for **\@force_invalidate_snapshot** and **\@force_reinit_subscription**, and a value of **1** or **2** for **\@value**, which corresponds to the following behavior:</span></span>  
  
    -   <span data-ttu-id="d159b-138">**1** — изменения на подписчике разрешены, но они не передаются на издатель.</span><span class="sxs-lookup"><span data-stu-id="d159b-138">**1** - Changes are allowed at the Subscriber, but they are not uploaded to the Publisher.</span></span>    
    -   <span data-ttu-id="d159b-139">**2** — изменения на подписчике не разрешены.</span><span class="sxs-lookup"><span data-stu-id="d159b-139">**2** - Changes are not allowed at the Subscriber.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="d159b-140">Если исходная таблица для статьи уже опубликована в другой публикации, доступность только для загрузки должна быть одинаковой для обеих статей.</span><span class="sxs-lookup"><span data-stu-id="d159b-140">If the source table for an article is already published in another publication, the download-only behavior must be the same for both articles.</span></span>  
 
## <a name=""></a><span data-ttu-id="d159b-141"><a name="interactive-conflict-resolution">Интерактивное разрешение конфликтов</a></span><span class="sxs-lookup"><span data-stu-id="d159b-141"><a name="interactive-conflict-resolution">Interactive conflict resolution</a></span></span>
[!INCLUDE[msCoName](../../../includes/msconame-md.md)]<span data-ttu-id="d159b-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Репликация предоставляет интерактивный сопоставитель, который позволяет разрешать конфликты вручную во время синхронизации по требованию в [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Диспетчер синхронизации Windows.</span><span class="sxs-lookup"><span data-stu-id="d159b-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication provides an Interactive Resolver, which allows you to resolve conflicts manually during on-demand synchronization in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows Synchronization Manager.</span></span> <span data-ttu-id="d159b-143">После того как интерактивное разрешение конфликтов включено, конфликты разрешаются во время синхронизации в интерактивном режиме с помощью интерактивного сопоставителя.</span><span class="sxs-lookup"><span data-stu-id="d159b-143">After interactive resolution is enabled, resolve conflicts interactively during synchronization, using the Interactive Resolver.</span></span> <span data-ttu-id="d159b-144">Интерактивный сопоставитель доступен через диспетчер синхронизации [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows.</span><span class="sxs-lookup"><span data-stu-id="d159b-144">The Interactive Resolver is available through the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows Synchronization Manager.</span></span> <span data-ttu-id="d159b-145">Дополнительные сведения см. в статье [Синхронизация подписки с помощью диспетчера синхронизации Windows (диспетчер синхронизации Windows)](../synchronize-a-subscription-using-windows-synchronization-manager.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-145">For more information, see [Synchronize a Subscription Using Windows Synchronization Manager &#40;Windows Synchronization Manager&#41;](../synchronize-a-subscription-using-windows-synchronization-manager.md).</span></span>  
  
    
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="d159b-146">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="d159b-146">Recommendations</span></span>  
  
-   <span data-ttu-id="d159b-147">Если синхронизация выполнена вне диспетчера синхронизации Windows (по расписанию или по требованию в среде SQL Server Management Studio или мониторе репликации), конфликты разрешаются автоматически без вмешательства пользователя с помощью метода разрешения конфликтов по умолчанию, указанному для статьи.</span><span class="sxs-lookup"><span data-stu-id="d159b-147">If a synchronization is performed outside of Windows Synchronization Manager (as a scheduled synchronization or an on demand synchronization in SQL Server Management Studio or Replication Monitor), conflicts are resolved automatically without user intervention, using the default conflict resolution specified for the article.</span></span> <span data-ttu-id="d159b-148">Дополнительные сведения см. в разделе [Interactive Conflict Resolution](../merge/advanced-merge-replication-conflict-interactive-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-148">For more information, see [Interactive Conflict Resolution](../merge/advanced-merge-replication-conflict-interactive-resolution.md).</span></span>  
  
###  <a name="using-sql-server-management-studio"></a><span data-ttu-id="d159b-149">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="d159b-149">Using SQL Server Management Studio</span></span>  
  
#### <a name="enable-interactive-conflict-resolution-for-an-article"></a><span data-ttu-id="d159b-150">Включение интерактивного разрешения конфликтов для статьи</span><span class="sxs-lookup"><span data-stu-id="d159b-150">Enable interactive conflict resolution for an article</span></span>  
  
1.  <span data-ttu-id="d159b-151">На странице **Статьи** мастера создания публикаций или в диалоговом окне **Свойства публикации — \<Publication>** выберите таблицу.</span><span class="sxs-lookup"><span data-stu-id="d159b-151">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table.</span></span> <span data-ttu-id="d159b-152">Дополнительные сведения об использовании мастера и доступе к этому диалоговому окну см. в статьях [Создание публикации](create-a-publication.md) и [Просмотр и изменение свойств публикации](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-152">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>    
2.  <span data-ttu-id="d159b-153">Щелкните **Свойства статьи**, затем щелкните **Указать свойства выделенной статьи таблицы** или **Указать свойства всех статей таблиц**.</span><span class="sxs-lookup"><span data-stu-id="d159b-153">Click **Article Properties**, and then click **Set Properties of Highlighted Table Article** or **Set Properties of All Table Articles**.</span></span>    
3.  <span data-ttu-id="d159b-154">На странице **Свойства статьи — \<Article>** или **Свойства статьи — \<ArticleType>** щелкните вкладку **Сопоставитель**.</span><span class="sxs-lookup"><span data-stu-id="d159b-154">On the **Article Properties - \<Article>** or **Article Properties - \<ArticleType>** page, click the **Resolver** tab.</span></span>    
4.  <span data-ttu-id="d159b-155">Выберите **Позволить подписчикам разрешать конфликты в интерактивном режиме во время синхронизации по требованию**.</span><span class="sxs-lookup"><span data-stu-id="d159b-155">Select **Allow Subscriber to resolve conflicts interactively during on-demand synchronization**.</span></span>    
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]    
6.  <span data-ttu-id="d159b-156">Если вы находитесь в диалоговом окне **Свойства публикации — \<Publication>** , нажмите кнопку **ОК**, чтобы сохранить результаты и закрыть диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="d159b-156">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
#### <a name="to-specify-that-a-subscription-should-use-interactive-conflict-resolution"></a><span data-ttu-id="d159b-157">Указание, что подписка должна использовать интерактивное разрешение конфликтов</span><span class="sxs-lookup"><span data-stu-id="d159b-157">To specify that a subscription should use interactive conflict resolution</span></span>  
  
1.  <span data-ttu-id="d159b-158">В диалоговом окне **Свойства подписки — \<Subscriber>: \<SubscriptionDatabase>** для параметра **Интерактивное разрешение конфликтов** задайте значение **True**.</span><span class="sxs-lookup"><span data-stu-id="d159b-158">In the **Subscription Properties - \<Subscriber>: \<SubscriptionDatabase>** dialog box, specify a value of **True** for the **Resolve conflicts interactively** option.</span></span> <span data-ttu-id="d159b-159">Дополнительные сведения о доступе к этому диалоговому окну см. в разделах [Просмотр и изменение свойств принудительной подписки](../view-and-modify-push-subscription-properties.md) и [Просмотр и изменение свойств подписки по запросу](../view-and-modify-pull-subscription-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-159">For more information about accessing this dialog box, see [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) and [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md).</span></span> 
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
### <a name="using-transact-sql"></a><span data-ttu-id="d159b-160">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d159b-160">Using Transact-SQL</span></span>  
 <span data-ttu-id="d159b-161">Можно программно указать, чтобы подписчик использовал этот графический интерфейс для разрешения конфликтов статей, если создается подписка по запросу на публикацию слиянием.</span><span class="sxs-lookup"><span data-stu-id="d159b-161">You can programmatically specify that a Subscriber will use this graphical interface to resolve article conflicts when a pull subscription to a merge publication is created.</span></span> <span data-ttu-id="d159b-162">В интерактивном сопоставителе отображаются только конфликты статей, поддерживающих этот параметр.</span><span class="sxs-lookup"><span data-stu-id="d159b-162">Only conflicts in articles that support this option will be displayed in the Interactive Resolver.</span></span>  
  
#### <a name="create-a-merge-pull-subscription-that-uses-the-interactive-resolver"></a><span data-ttu-id="d159b-163">Создание подписки по запросу на публикации слиянием, использующую интерактивный сопоставитель</span><span class="sxs-lookup"><span data-stu-id="d159b-163">Create a merge pull subscription that uses the Interactive Resolver</span></span>  
  
1.  <span data-ttu-id="d159b-164">На издателе в базе данных публикации выполните [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), указав \*\* \@ publication\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-164">At the Publisher on the publication database, execute [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="d159b-165">Запомните значение **allow_interactive_resolver** для каждой статьи в результирующем наборе, для которого будет использоваться интерактивный сопоставитель.</span><span class="sxs-lookup"><span data-stu-id="d159b-165">Note the value of **allow_interactive_resolver** for each article in the result set for which the Interactive Resolver will be used.</span></span>    
    -   <span data-ttu-id="d159b-166">Если это значение равно **1**, будет использоваться интерактивный сопоставитель.</span><span class="sxs-lookup"><span data-stu-id="d159b-166">If this value is **1**, the Interactive Resolver will be used.</span></span>    
    -   <span data-ttu-id="d159b-167">Если значение равно **0**, необходимо вначале включить интерактивный сопоставитель для каждой статьи.</span><span class="sxs-lookup"><span data-stu-id="d159b-167">If this value is **0**, you must first enable the Interactive Resolver for each article.</span></span> <span data-ttu-id="d159b-168">Для этого выполните [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), указав \*\* \@ публикацию**, \*\* \@ статью**, значение **allow_interactive_resolver** для \*\* \@ Свойства**и значение **true** в качестве \*\* \@ значения**.</span><span class="sxs-lookup"><span data-stu-id="d159b-168">To do this, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **\@publication**, **\@article**, a value of **allow_interactive_resolver** for **\@property**, and a value of **true** for **\@value**.</span></span>    
2.  <span data-ttu-id="d159b-169">В базе данных подписки на издателе выполните процедуру [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-169">At the Subscriber on the subscription database, execute [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="d159b-170">Дополнительные сведения см. в статье [Создание подписки по запросу](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-170">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>    
3.  <span data-ttu-id="d159b-171">На подписчике в базе данных подписки выполните хранимую процедуру [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql), указав следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="d159b-171">At the Subscriber on the subscription database, execute [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql), specifying the following parameters:</span></span>  
  
    -   <span data-ttu-id="d159b-172">\*\* \@ Издатель**, \*\* \@ publisher_db** (опубликованная база данных) и \*\* \@ Публикация\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-172">**\@publisher**, **\@publisher_db** (the published database), and **\@publication**.</span></span>    
    -   <span data-ttu-id="d159b-173">Значение **true** для \*\* \@ enabled_for_syncmgr\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-173">A value of **true** for **\@enabled_for_syncmgr**.</span></span>    
    -   <span data-ttu-id="d159b-174">Значение **true** для \*\* \@ use_interactive_resolver\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-174">A value of **true** for **\@use_interactive_resolver**.</span></span>    
    -   <span data-ttu-id="d159b-175">Сведения учетной записи безопасности, необходимой для агента слияния.</span><span class="sxs-lookup"><span data-stu-id="d159b-175">The security account information required by the Merge Agent.</span></span> <span data-ttu-id="d159b-176">Дополнительные сведения см. в статье [Создание подписки по запросу](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-176">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>    
4.  <span data-ttu-id="d159b-177">В базе данных публикации на издателе выполните процедуру [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-177">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span>  
  
#### <a name="define-an-article-that-supports-the-interactive-resolver"></a><span data-ttu-id="d159b-178">Определение статьи, поддерживающей интерактивный сопоставитель</span><span class="sxs-lookup"><span data-stu-id="d159b-178">Define an article that supports the Interactive Resolver</span></span>  
  
<span data-ttu-id="d159b-179">В базе данных публикации на издателе выполните процедуру [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-179">At the Publisher on the publication database, execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="d159b-180">Укажите имя публикации, которой принадлежит статья для \*\* \@ публикации**, \*\* \@ имя статьи для статьи,** публикуемый объект базы данных для \*\* \@ source_object**и значение **true** для \*\* \@ allow_interactive_resolver**.</span><span class="sxs-lookup"><span data-stu-id="d159b-180">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, and a value of **true** for **\@allow_interactive_resolver**.</span></span> <span data-ttu-id="d159b-181">Дополнительные сведения см. в статье [определить статью](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-181">For more information, see [Define an Article](define-an-article.md).</span></span>  

## <a name="specify-the-conflict-tracking-and-resolution-level"></a><span data-ttu-id="d159b-182">Укажите уровень отслеживания и разрешения конфликтов</span><span class="sxs-lookup"><span data-stu-id="d159b-182">Specify the Conflict Tracking and Resolution Level</span></span> 
<span data-ttu-id="d159b-183">При синхронизации подписки на публикацию слиянием репликация проверяет наличие конфликтов, вызванных изменениями в одних и тех же данных, внесенных на издателе и подписчике.</span><span class="sxs-lookup"><span data-stu-id="d159b-183">When a subscription to a merge publication is synchronized, replication checks for conflicts caused by changes to the same data made at both the Publisher and the Subscriber.</span></span> <span data-ttu-id="d159b-184">Можно указать, чтобы конфликты определялись на уровне строки, где любое изменение строки будет считаться конфликтом, либо на уровне столбца, где конфликтом будет считаться только изменение в одних и тех же строке и столбце.</span><span class="sxs-lookup"><span data-stu-id="d159b-184">You can specify whether conflicts are detected at the row-level, where any change to the row is considered a conflict, or column-level, where only changes to the same row and column are considered a conflict.</span></span> <span data-ttu-id="d159b-185">Разрешение конфликтов статей выполняется на уровне строки.</span><span class="sxs-lookup"><span data-stu-id="d159b-185">Conflict resolution for articles is performed at the row-level.</span></span> <span data-ttu-id="d159b-186">Дополнительные сведения по определению и разрешению конфликтов при использовании логических записей см. в разделе [Detecting and Resolving Conflicts in Logical Records](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-186">For more information about conflict detection and resolution when logical records are used, see [Detecting and Resolving Conflicts in Logical Records](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md).</span></span>  
  

  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="d159b-187">Ограничения</span><span class="sxs-lookup"><span data-stu-id="d159b-187">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="d159b-188">Если изменить уровень отслеживания после инициализации подписок, то эти подписки потребуется инициализировать повторно.</span><span class="sxs-lookup"><span data-stu-id="d159b-188">If you modify the tracking level after subscriptions have been initialized, those subscriptions must be reinitialized.</span></span> <span data-ttu-id="d159b-189">Дополнительные сведения о последствиях изменения свойств см. в статье [Изменение свойств публикации и статьи](../publish/change-publication-and-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-189">For more information about the effects of property changes, see [Change Publication and Article Properties](../publish/change-publication-and-article-properties.md).</span></span>    
-   <span data-ttu-id="d159b-190">При отслеживании на уровне строк и столбцов устранение конфликтов всегда выполняется на уровне строк: победившая строка перезаписывает проигравшую строку.</span><span class="sxs-lookup"><span data-stu-id="d159b-190">With row- and column-level tracking, conflict resolution is always performed at the row-level: the winning row overwrites the losing row.</span></span> <span data-ttu-id="d159b-191">Репликация слиянием также позволяет указывать, что конфликты должны отслеживаться и разрешаться на уровне логических записей, но эти параметры недоступны из среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d159b-191">Merge replication also allows you to specify that conflicts be tracked and resolved at the logical record level, but these options are not available from [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="d159b-192">Сведения об установке данных параметров с помощью хранимых процедур репликации см. в разделе [Определение связи логических записей между статьями таблиц слияния](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-192">For information about setting these options from replication stored procedures, see [Define a Logical Record Relationship Between Merge Table Articles](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span></span>  
  
###  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="d159b-193">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="d159b-193">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="d159b-194">Выберите отслеживание на уровне строк или столбцов для статей публикации слиянием на вкладке **Свойства** диалогового окна **Свойства статьи**, которое доступно в мастере создания публикаций и диалоговом окне **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="d159b-194">Specify row- or column-level tracking for merge articles on the **Properties** tab of the **Article Properties** dialog box, which is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="d159b-195">Дополнительные сведения об использовании мастера и доступе к этому диалоговому окну см. в статьях [Создание публикации](create-a-publication.md) и [Просмотр и изменение свойств публикации](../publish/view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-195">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="specify-row--or-column-level-tracking"></a><span data-ttu-id="d159b-196">Указание отслеживания на уровне строк или столбцов</span><span class="sxs-lookup"><span data-stu-id="d159b-196">Specify row- or column-level tracking</span></span>  
  
1.  <span data-ttu-id="d159b-197">На странице **Статьи** мастера создания публикаций или в диалоговом окне **Свойства публикации — \<Publication>** выберите таблицу.</span><span class="sxs-lookup"><span data-stu-id="d159b-197">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table.</span></span>    
2.  <span data-ttu-id="d159b-198">Щелкните **Свойства статьи**, затем щелкните **Указать свойства выделенной статьи таблицы** или **Указать свойства всех статей таблиц**.</span><span class="sxs-lookup"><span data-stu-id="d159b-198">Click **Article Properties**, and then click **Set Properties of Highlighted Table Article** or **Set Properties of All Table Articles**.</span></span>   
3.  <span data-ttu-id="d159b-199">На вкладке **Свойства** диалогового окна **Свойства статьи — \<Article>** выберите одно из следующих значений для свойства **Уровень отслеживания**: **Отслеживание на уровне строк** или **Отслеживание на уровне столбцов**.</span><span class="sxs-lookup"><span data-stu-id="d159b-199">On the **Properties** tab of the **Article Properties \<Article>** dialog box, select one of the following values for the **Tracking level** property: **Row-level tracking** or **Column-level tracking**.</span></span>    
4.  <span data-ttu-id="d159b-200">Если вы находитесь в диалоговом окне **Свойства публикации — \<Publication>** , нажмите кнопку **ОК**, чтобы сохранить результаты и закрыть диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="d159b-200">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
###  <a name="using-transact-sql"></a><span data-ttu-id="d159b-201">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d159b-201">Using Transact-SQL</span></span>  
  
#### <a name="specify-conflict-tracking-options-for-a-new-merge-article"></a><span data-ttu-id="d159b-202">Указание параметров отслеживания конфликтов для новой статьи публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="d159b-202">Specify conflict tracking options for a new merge article</span></span>  
  
1.  <span data-ttu-id="d159b-203">На издателе в базе данных публикации выполните [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) и укажите одно из следующих значений для \*\* \@ column_tracking\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-203">At the Publisher on the publication database, execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) and specify one of the following values for **\@column_tracking**:</span></span>  
  
    -   <span data-ttu-id="d159b-204">**true** — использовать для статьи отслеживание на уровне столбцов;</span><span class="sxs-lookup"><span data-stu-id="d159b-204">**true** - Use column-level tracking for the article.</span></span>    
    -   <span data-ttu-id="d159b-205">**false** — использовать отслеживание на уровне строк (значение по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="d159b-205">**false** - Use row-level tracking, which is the default.</span></span>  
  
#### <a name="change-conflict-tracking-options-for-a-merge-article"></a><span data-ttu-id="d159b-206">Изменение параметров отслеживания конфликтов для статьи публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="d159b-206">Change conflict tracking options for a merge article</span></span>  
  
1.  <span data-ttu-id="d159b-207">Чтобы определить текущие параметры отслеживания конфликтов для статьи публикации слиянием, выполните хранимую процедуру [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-207">To determine the conflict tracking options for a merge article, execute [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span></span> <span data-ttu-id="d159b-208">Проверьте значение параметра **column_tracking** в результирующем наборе для статьи.</span><span class="sxs-lookup"><span data-stu-id="d159b-208">Note the value of the **column_tracking** option in the result set for the article.</span></span> <span data-ttu-id="d159b-209">Значение **1** показывает, что используется отслеживание конфликтов уровня столбца, а значение **0** — отслеживание конфликтов уровня строки.</span><span class="sxs-lookup"><span data-stu-id="d159b-209">A value of **1** means that column-level tracking is being used, and a value of **0** means that row-level tracking is being used.</span></span>    
2.  <span data-ttu-id="d159b-210">В базе данных публикации на издателе выполните процедуру [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-210">At the Publisher on the publication database, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="d159b-211">Укажите значение **column_tracking** для \*\* \@ Свойства\*\* и одно из следующих значений в поле \*\* \@ значение\*\*:</span><span class="sxs-lookup"><span data-stu-id="d159b-211">Specify a value of **column_tracking** for **\@property** and one of the following values for **\@value**:</span></span>
    -   <span data-ttu-id="d159b-212">**true** — использовать для статьи отслеживание на уровне столбцов;</span><span class="sxs-lookup"><span data-stu-id="d159b-212">**true** - Use column-level tracking for the article.</span></span>
    -   <span data-ttu-id="d159b-213">**false** — использовать отслеживание на уровне строк (значение по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="d159b-213">**false** - Use row-level tracking, which is the default.</span></span>  
  
     <span data-ttu-id="d159b-214">Укажите значение **1** как для \*\* \@ force_invalidate_snapshot\*\* , так и для \*\* \@ force_reinit_subscription\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-214">Specify a value of **1** for both **\@force_invalidate_snapshot** and **\@force_reinit_subscription**.</span></span>  

## <a name="tracking-deletes"></a><span data-ttu-id="d159b-215">Отслеживание удалений</span><span class="sxs-lookup"><span data-stu-id="d159b-215">Tracking deletes</span></span>

> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
 <span data-ttu-id="d159b-216">По умолчанию репликация слиянием производит синхронизацию команд DELETE между издателем и подписчиком.</span><span class="sxs-lookup"><span data-stu-id="d159b-216">By default, merge replication synchronizes DELETE commands between the Publisher and Subscriber.</span></span> <span data-ttu-id="d159b-217">Репликация слиянием позволяет извлекать строки из базы данных подписки даже в том случае, если они были удалены из публикации (и наоборот).</span><span class="sxs-lookup"><span data-stu-id="d159b-217">Merge replication enables you to retain rows in the subscription database even when they have been deleted from the publication, and vice versa.</span></span> <span data-ttu-id="d159b-218">При создании новой статьи можно отключить выполнение команд DELETE программным путем, либо сделать это позже с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="d159b-218">You can programmatically specify that DELETE commands be ignored when creating a new article or you can enable this functionality at a later time using replication stored procedures.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="d159b-219">Включение этой функции приведет к потере конвергенции, то есть возникнет несоответствие данных, содержащихся на подписчике и на издателе.</span><span class="sxs-lookup"><span data-stu-id="d159b-219">Enabling this functionality will result in non-convergence, which means that data present at the Subscriber will not accurately reflect data at the Publisher.</span></span> <span data-ttu-id="d159b-220">Потребуется реализация собственного механизма очистки удаленных строк.</span><span class="sxs-lookup"><span data-stu-id="d159b-220">You must implement your own mechanism for manually removing deleted rows.</span></span>  
  
### <a name="specify-that-deletes-be-ignored-for-a-new-merge-article"></a><span data-ttu-id="d159b-221">Отключение обработки команд удаления для новой статьи слияния</span><span class="sxs-lookup"><span data-stu-id="d159b-221">Specify that deletes be ignored for a new merge article</span></span>  
  
1.  <span data-ttu-id="d159b-222">В базе данных публикации на издателе выполните процедуру [sp_addmergearticle (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-222">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="d159b-223">Укажите значение `false` для \*\* \@ delete_tracking\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-223">Specify a value of `false` for **\@delete_tracking**.</span></span> <span data-ttu-id="d159b-224">Дополнительные сведения см. в статье [определить статью](../publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-224">For more information, see [Define an Article](../publish/define-an-article.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="d159b-225">Если исходная таблица для статьи уже опубликована в другой публикации, значение **delete_tracking** должно быть одинаковым для обеих статей.</span><span class="sxs-lookup"><span data-stu-id="d159b-225">If the source table for an article is already published in another publication, the value of **delete_tracking** must be the same for both articles.</span></span>  
  
### <a name="specify-that-deletes-be-ignored-for-an-existing-merge-article"></a><span data-ttu-id="d159b-226">Отключение обработки команд удаления для существующей статьи слияния</span><span class="sxs-lookup"><span data-stu-id="d159b-226">Specify that deletes be ignored for an existing merge article</span></span>  
  
1.  <span data-ttu-id="d159b-227">Чтобы определить, включена ли компенсация ошибок для статьи, выполните хранимую процедуру [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) и в полученных результатах проверьте значение параметра **delete_tracking**.</span><span class="sxs-lookup"><span data-stu-id="d159b-227">To determine if error compensation is enabled for an article, execute [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) and note the value of **delete_tracking** in the result set.</span></span> <span data-ttu-id="d159b-228">Если это значение равно **0**, то команды удаления уже не обрабатываются.</span><span class="sxs-lookup"><span data-stu-id="d159b-228">If this value is **0**, deletes are already being ignored.</span></span>    
2.  <span data-ttu-id="d159b-229">Если на шаге 1 получено значение **1**, в базе данных публикации на издателе выполните процедуру [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-229">If the value from step 1 is **1**, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="d159b-230">Укажите значение **delete_tracking** для \*\* \@ Свойства**и значение `false` для параметра \*\* \@ значение**.</span><span class="sxs-lookup"><span data-stu-id="d159b-230">Specify a value of **delete_tracking** for **\@property**, and a value of `false` for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="d159b-231">Если исходная таблица для статьи уже опубликована в другой публикации, значение **delete_tracking** должно быть одинаковым для обеих статей.</span><span class="sxs-lookup"><span data-stu-id="d159b-231">If the source table for an article is already published in another publication, the value of **delete_tracking** must be the same for both articles.</span></span>  
  
## <a name="processing-order"></a><span data-ttu-id="d159b-232">Порядок обработки</span><span class="sxs-lookup"><span data-stu-id="d159b-232">Processing Order</span></span>
  <span data-ttu-id="d159b-233">Репликация слиянием позволяет указать порядок, в котором статьи обрабатываются агентом слияния во время процесса синхронизации.</span><span class="sxs-lookup"><span data-stu-id="d159b-233">Merge replication enables you to specify the order in which articles are processed by the Merge Agent during the synchronization process.</span></span> <span data-ttu-id="d159b-234">Можно с помощью хранимых процедур репликации программно назначить порядок каждой статье при ее создании.</span><span class="sxs-lookup"><span data-stu-id="d159b-234">You can assign an order to each article programmatically when creating an article using replication stored procedures.</span></span> <span data-ttu-id="d159b-235">Статьи обрабатываются по номерам, от меньших к большим.</span><span class="sxs-lookup"><span data-stu-id="d159b-235">Articles are processed in order from lowest to highest value.</span></span> <span data-ttu-id="d159b-236">Если значения двух статей совпадают, то эти статьи обрабатываются одновременно.</span><span class="sxs-lookup"><span data-stu-id="d159b-236">If two articles have the same value, they are processed concurrently.</span></span> <span data-ttu-id="d159b-237">Дополнительные сведения см. в разделе [Указание свойств репликации слиянием](../publish/specify-merge-replication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-237">For more information, see [Specify Merge Replication properties](../publish/specify-merge-replication-properties.md).</span></span>  

  <span data-ttu-id="d159b-238">Начиная с версии [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] , можно переопределить порядок обработки статей по умолчанию для публикаций слиянием.</span><span class="sxs-lookup"><span data-stu-id="d159b-238">Beginning with [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], it is possible to override the default order of article processing for merge publications.</span></span> <span data-ttu-id="d159b-239">Это полезно, например, при определении ссылочной целостности с помощью триггеров и при этом триггеры должны запускаться в конкретном порядке.</span><span class="sxs-lookup"><span data-stu-id="d159b-239">This is useful, for example, if you define referential integrity through triggers and those triggers must fire in a certain order.</span></span> 

### <a name="how-processing-order-is-determined"></a><span data-ttu-id="d159b-240">Как определяется порядок обработки</span><span class="sxs-lookup"><span data-stu-id="d159b-240">How Processing Order is Determined</span></span>  
 <span data-ttu-id="d159b-241">Во время синхронизации слияния статьи по умолчанию обрабатываются в том порядке, который требуют зависимости между объектами, в том числе ограничения декларативной ссылочной целостности (DRI), определенные для базовых таблиц.</span><span class="sxs-lookup"><span data-stu-id="d159b-241">During merge synchronization, articles are, by default, processed in the order required by the dependencies between objects, including the declarative referential integrity (DRI) constraints defined on the base tables.</span></span> <span data-ttu-id="d159b-242">Обработка включает нумерацию изменений в таблице и применение этих изменений.</span><span class="sxs-lookup"><span data-stu-id="d159b-242">Processing involves enumerating the changes to a table and then applying those changes.</span></span> <span data-ttu-id="d159b-243">Если DRI отсутствуют, но для статей таблиц имеются фильтры соединения или логические записи, то статьи обрабатываются в том порядке, который требуют эти фильтры и логические записи.</span><span class="sxs-lookup"><span data-stu-id="d159b-243">If no DRI is present but join filters or logical records exist between table articles, the articles are processed in the order required by the filters and logical records.</span></span> <span data-ttu-id="d159b-244">Статьи, не связанные с какой-либо другой статьей через DRI, фильтры соединения, логические записи и другие зависимости обрабатываются в соответствии с псевдонимами в системной таблице [sysmergearticles (Transact-SQL)](/sql/relational-databases/system-tables/sysmergearticles-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-244">Articles not related to any other article through DRI, join filters, logical records, or other dependencies are processed according to the article nickname in the [sysmergearticles &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/sysmergearticles-transact-sql) system table.</span></span>  
  
 <span data-ttu-id="d159b-245">Рассмотрим публикацию, включающую таблицы **SalesOrderHeader** и **SalesOrderDetail** с первичным ключевым столбцом **SalesOrderID** в таблице **SalesOrderHeader** и соответствующим внешним ключевым столбцом **SalesOrderID** в таблице **SalesOrderDetail** .</span><span class="sxs-lookup"><span data-stu-id="d159b-245">Consider a publication that includes the tables **SalesOrderHeader** and **SalesOrderDetail** with a primary key column **SalesOrderID** in the **SalesOrderHeader** table and a corresponding foreign key column **SalesOrderID** in the **SalesOrderDetail** table.</span></span> <span data-ttu-id="d159b-246">Во время синхронизации репликация слиянием препятствует нарушениям внешнего ключа путем вставки новых строк в столбец **SalesOrderHeader** перед тем, как вставить соответствующие строки в столбец **SalesOrderDetail**.</span><span class="sxs-lookup"><span data-stu-id="d159b-246">During synchronization, merge replication prevents foreign key violations by inserting any new rows in **SalesOrderHeader** before inserting associated rows in **SalesOrderDetail**.</span></span> <span data-ttu-id="d159b-247">Точно так же строки удаляются из столбца **SalesOrderDetail** перед удалением соответствующих строк из столбца **SalesOrderHeader**.</span><span class="sxs-lookup"><span data-stu-id="d159b-247">Similarly, rows are deleted from **SalesOrderDetail** before the associated row is deleted from **SalesOrderHeader**.</span></span>  
  
 <span data-ttu-id="d159b-248">Однако в некоторых приложениях ссылочная целостность принудительно навязывается через триггеры базы данных или на уровне приложения, а не через DRI.</span><span class="sxs-lookup"><span data-stu-id="d159b-248">However, in some applications referential integrity is enforced through database triggers, or at the application level, rather than through DRI.</span></span> <span data-ttu-id="d159b-249">В приведенной выше публикации таблица **SalesOrderDetail** вместо DRI могла бы иметь триггер Insert, который перед вставкой проверял бы, что в таблице **SalesOrderHeader** существует связанная строка.</span><span class="sxs-lookup"><span data-stu-id="d159b-249">Given the publication described above, instead of DRI, the **SalesOrderDetail** table could have an insert trigger that ensures the associated row in the **SalesOrderHeader** table exists before allowing an insert.</span></span> <span data-ttu-id="d159b-250">Таблица**SalesOrderHeader** могла бы иметь триггер Delete, который перед удалением проверял бы, что в таблице **SalesOrderDetail** отсутствует связанная строка.</span><span class="sxs-lookup"><span data-stu-id="d159b-250">**SalesOrderHeader** could have a delete trigger that ensures there are no associated rows in **SalesOrderDetail** before allowing a delete.</span></span> <span data-ttu-id="d159b-251">Репликация слиянием перед указанием порядка обработки не учитывает триггеры, потому что она перед запуском триггера не может определить, каков будет его результат.</span><span class="sxs-lookup"><span data-stu-id="d159b-251">Merge replication does not take into account triggers when determining processing order of articles because it cannot determine what the result of the trigger will be until it has fired.</span></span> <span data-ttu-id="d159b-252">Точно так же репликация не может учитывать ограничения, определенные на уровне приложения.</span><span class="sxs-lookup"><span data-stu-id="d159b-252">Similarly, replication cannot take into account constraints defined at the application level.</span></span>  
  
 <span data-ttu-id="d159b-253">Если ссылочная целостность сохраняется с помощью триггеров или на уровне приложения, необходимо задать порядок, в котором будут обрабатываться статьи.</span><span class="sxs-lookup"><span data-stu-id="d159b-253">When referential integrity is maintained through triggers or at the application level, you should specify the order in which the articles should be processed.</span></span> <span data-ttu-id="d159b-254">В примере с триггерами следовало бы указать, что таблица **SalesOrderHeader** должна обрабатываться раньше **SalesOrderDetail**, потому что упорядочивание статей основано на порядке вставки.</span><span class="sxs-lookup"><span data-stu-id="d159b-254">In the example with triggers, you would specify that the **SalesOrderHeader** table should be processed before **SalesOrderDetail**, because article ordering is based on insert order.</span></span> <span data-ttu-id="d159b-255">Репликация слиянием автоматически меняет этот порядок на обратный для удалений.</span><span class="sxs-lookup"><span data-stu-id="d159b-255">Merge replication will automatically reverse the order for deletes.</span></span> <span data-ttu-id="d159b-256">Репликация слиянием не завершится неудачей, если статьи не упорядочены, потому что, если происходит нарушение ограничения, агент слияния продолжает обрабатывать статьи. Затем, после обработки остальных статей, он пытается выполнить сбойные операции.</span><span class="sxs-lookup"><span data-stu-id="d159b-256">Merge replication will not fail without article ordering, because the Merge Agent continues to process articles if a constraint violation occurs; it then retries any operations that failed after other articles have been processed.</span></span> <span data-ttu-id="d159b-257">При указании порядка статей просто исключаются повторные попытки и связанная с ними дополнительная обработка.</span><span class="sxs-lookup"><span data-stu-id="d159b-257">Specifying article order simply avoids retries and the additional processing associated with them.</span></span> <span data-ttu-id="d159b-258">Если указать неверный порядок (например, если он задает обработку записей с подробными данными до обработки записей заголовков), репликация слиянием будет продолжать обработку до ее успешного завершения.</span><span class="sxs-lookup"><span data-stu-id="d159b-258">If you specify an incorrect order (for example, one that results in detail records being processed before header records), merge replication will retry processing until it succeeds.</span></span>  

### <a name="new-article"></a><span data-ttu-id="d159b-259">Новая статья</span><span class="sxs-lookup"><span data-stu-id="d159b-259">New Article</span></span>
  
1.  <span data-ttu-id="d159b-260">В базе данных публикации на издателе выполните процедуру [sp_addmergearticle (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-260">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="d159b-261">Укажите целочисленное значение, представляющее порядок обработки статьи для \*\* \@ processing_order\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-261">Specify an integer value that represents the processing order for the article for **\@processing_order**.</span></span> <span data-ttu-id="d159b-262">Дополнительные сведения см. в статье [определить статью](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="d159b-262">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="d159b-263">При создании упорядоченных статей необходимо оставлять промежутки между значениями порядковых номеров статей.</span><span class="sxs-lookup"><span data-stu-id="d159b-263">When creating ordered articles, you should leave gaps between the article order values.</span></span> <span data-ttu-id="d159b-264">Это облегчит задание новых значений в будущем.</span><span class="sxs-lookup"><span data-stu-id="d159b-264">This makes it easier to set new values in the future.</span></span> <span data-ttu-id="d159b-265">Например, если у вас есть три статьи, для которых необходимо указать фиксированный порядок обработки, установите значение \*\* \@ processing_order\*\* равным 10, 20 и 30, а не 1, 2 и 3 соответственно.</span><span class="sxs-lookup"><span data-stu-id="d159b-265">For example, if you have three articles for which you need to specify a fixed processing order, set the value of **\@processing_order** to 10, 20, and 30 rather than 1, 2, and 3, respectively.</span></span>  
  
### <a name="existing-article"></a><span data-ttu-id="d159b-266">Существующая статья</span><span class="sxs-lookup"><span data-stu-id="d159b-266">Existing article</span></span>
  
1.  <span data-ttu-id="d159b-267">Чтобы определить порядок обработки статьи, выполните процедуру [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) и проверьте значение **processing_order** в результирующем наборе.</span><span class="sxs-lookup"><span data-stu-id="d159b-267">To determine processing order of an article, execute [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) and note the value of **processing_order** in the result set.</span></span>  
  
2.  <span data-ttu-id="d159b-268">В базе данных публикации на издателе выполните процедуру [sp_changemergearticle (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d159b-268">At the Publisher on the publication database, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="d159b-269">Укажите значение **processing_order** для \*\* \@ Свойства\*\* и целочисленное значение, представляющее порядок обработки \*\* \@ значения\*\*.</span><span class="sxs-lookup"><span data-stu-id="d159b-269">Specify a value of **processing_order** for **\@property** and an integer value that represents the processing order for **\@value**.</span></span>  



## <a name="see-also"></a><span data-ttu-id="d159b-270">См. также:</span><span class="sxs-lookup"><span data-stu-id="d159b-270">See Also</span></span>  
 [<span data-ttu-id="d159b-271">Оптимизация производительности репликации слиянием с помощью отслеживания условного удаления</span><span class="sxs-lookup"><span data-stu-id="d159b-271">Optimize Merge Replication Performance with Conditional Delete Tracking</span></span>](../merge/optimize-merge-replication-performance-with-conditional-delete-tracking.md)  
 <span data-ttu-id="d159b-272">[Обнаружение и разрешение конфликтов в логических записях](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md) </span><span class="sxs-lookup"><span data-stu-id="d159b-272">[Detecting and Resolving Conflicts in Logical Records](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md) </span></span>  
 <span data-ttu-id="d159b-273">[Определение связи логических записей между статьями таблиц слияния](define-a-logical-record-relationship-between-merge-table-articles.md) </span><span class="sxs-lookup"><span data-stu-id="d159b-273">[Define a Logical Record Relationship Between Merge Table Articles](define-a-logical-record-relationship-between-merge-table-articles.md) </span></span>  
 <span data-ttu-id="d159b-274">[Обнаружение и разрешение конфликтов репликации слиянием](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="d159b-274">[Detect and Resolve Merge Replication Conflicts](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 <span data-ttu-id="d159b-275">[Оптимизация производительности репликации слиянием при работе со статьями, доступными только для загрузки](../merge/optimize-merge-replication-performance-with-download-only-articles.md) </span><span class="sxs-lookup"><span data-stu-id="d159b-275">[Optimize Merge Replication Performance with Download-Only Articles](../merge/optimize-merge-replication-performance-with-download-only-articles.md) </span></span>  
 <span data-ttu-id="d159b-276">[Define an Article](define-an-article.md) </span><span class="sxs-lookup"><span data-stu-id="d159b-276">[Define an Article](define-an-article.md) </span></span>  
 [<span data-ttu-id="d159b-277">View and Modify Article Properties (Просмотр и изменение свойств статьи)</span><span class="sxs-lookup"><span data-stu-id="d159b-277">View and Modify Article Properties</span></span>](view-and-modify-article-properties.md)  