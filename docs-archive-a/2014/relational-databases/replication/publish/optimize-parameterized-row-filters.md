---
title: Оптимизация параметризованных фильтров строк | Документация Майкрософт
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- precomputed partitions [SQL Server replication]
- filters [SQL Server replication], parameterized
- merge replication precomputed partitions [SQL Server replication], SQL Server Management Studio
- parameterized filters [SQL Server replication], optimizing
ms.assetid: 49349605-ebd0-4757-95be-c0447f30ba13
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: f1c6448d8e2dba7a68fab441d4d08fd4a4a1db4d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87749716"
---
# <a name="optimize-parameterized-row-filters"></a><span data-ttu-id="3b7ff-102">Оптимизация параметризованных фильтров строк</span><span class="sxs-lookup"><span data-stu-id="3b7ff-102">Optimize Parameterized Row Filters</span></span>
  <span data-ttu-id="3b7ff-103">В этом разделе описывается оптимизация параметризованных фильтров строк в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3b7ff-103">This topic describes how to optimize parameterized row filters in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>  
  
 <span data-ttu-id="3b7ff-104">**В этом разделе**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="3b7ff-105">**Перед началом работы**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-105">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="3b7ff-106">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="3b7ff-106">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="3b7ff-107">**Для оптимизации параметризованных фильтров строк используется:**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-107">**To optimize parameterized row filters, using:**</span></span>  
  
     [<span data-ttu-id="3b7ff-108">Среда SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="3b7ff-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="3b7ff-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="3b7ff-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="3b7ff-110">Перед началом</span><span class="sxs-lookup"><span data-stu-id="3b7ff-110">Before You Begin</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="3b7ff-111">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="3b7ff-111">Recommendations</span></span>  
  
-   <span data-ttu-id="3b7ff-112">При использовании параметризованных фильтров можно управлять обработкой фильтрами репликацией слиянием, если указать параметр **use partition groups** или **keep partition changes** при создании публикации.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-112">When you use parameterized filters, you can control how the filters are processed by merge replication by specifying either the **use partition groups** option or the **keep partition changes** option when you create a publication.</span></span> <span data-ttu-id="3b7ff-113">Эти параметры повышают производительность синхронизации для публикаций с отфильтрованными статьями, сохраняя дополнительные метаданные в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-113">These options improve the synchronization performance for publications with filtered articles by storing additional metadata in the publication database.</span></span> <span data-ttu-id="3b7ff-114">Можно управлять совместным использованием данных подписчиками, настроив параметр **partition options** при создании статьи.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-114">You can control how the data is shared among Subscribers by setting **partition options** when you create an article.</span></span> <span data-ttu-id="3b7ff-115">Дополнительные сведения об этих требованиях см. в разделе [Параметризованные фильтры строк](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-115">For more information about these requirements, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
     <span data-ttu-id="3b7ff-116">При работе с подписчиками [!INCLUDE[ssEW](../../../includes/ssew-md.md)]SQL Server Compact параметр keep_partition_changes необходимо установить в значение true, чтобы обеспечить правильное распределение удалений.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-116">With [!INCLUDE[ssEW](../../../includes/ssew-md.md)]SQL Server Compact subscribers, keep_partition_changes must be set to true to ensure that deletes are correctly propagated.</span></span> <span data-ttu-id="3b7ff-117">При установке значения false подписчик может получить больше строк, чем ожидается.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-117">When set to false, the subscriber might have more rows than expected.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="3b7ff-118">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="3b7ff-118">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="3b7ff-119">Для оптимизации параметризованных фильтров строк можно воспользоваться следующими настройками:</span><span class="sxs-lookup"><span data-stu-id="3b7ff-119">The following settings can be used to optimize parameterized row filters:</span></span>  
  
 <span data-ttu-id="3b7ff-120">**Partition Options**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-120">**Partition Options**</span></span>  
 <span data-ttu-id="3b7ff-121">Установите этот параметр на странице **Свойства** диалогового окна **Свойства статьи — \<Article>** или в диалоговом окне **Добавление фильтра**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-121">Set this option on the **Properties** page of the **Article Properties - \<Article>** dialog box, or in the **Add Filter** dialog box.</span></span> <span data-ttu-id="3b7ff-122">Оба диалоговых окна доступны в мастере создания публикаций и в диалоговом окне **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="3b7ff-122">Both dialog boxes are available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="3b7ff-123">Диалоговое окно **Свойства статьи — \<Article>** позволяет указывать для этого параметра дополнительные значения, недоступные в диалоговом окне **Добавление фильтра**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-123">The **Article Properties - \<Article>** dialog box allows you to specify additional values for this option that are not available in the **Add Filter** dialog box.</span></span>  
  
 <span data-ttu-id="3b7ff-124">**Предварительное вычисление секций**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-124">**Precompute Partitions**</span></span>  
 <span data-ttu-id="3b7ff-125">Если статьи публикации соблюдают ряд требований, то этот параметр по умолчанию имеет значение **True** .</span><span class="sxs-lookup"><span data-stu-id="3b7ff-125">This option is set to **True** by default if the articles in your publication adhere to a set of requirements.</span></span> <span data-ttu-id="3b7ff-126">Дополнительные сведения об этих требованиях см. в статье [Оптимизация производительности параметризованного фильтра с помощью предварительно вычисляемых секций](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-126">For more information about these requirements, see [Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span></span> <span data-ttu-id="3b7ff-127">Измените этот параметр на странице **Параметры подписки** диалогового окна **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="3b7ff-127">Modify this option on the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
 <span data-ttu-id="3b7ff-128">**Оптимизировать синхронизацию**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-128">**Optimize Synchronization**</span></span>  
 <span data-ttu-id="3b7ff-129">Этот параметр должен иметь значение **True** только в том случае, если значение параметра **Предварительное вычисление секций** установлено равным **False**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-129">This option should be set to **True** only if **Precompute Partitions** is set to **False**.</span></span> <span data-ttu-id="3b7ff-130">Установите этот параметр на странице **Параметры подписки** диалогового окна **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="3b7ff-130">Set this option on the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
 <span data-ttu-id="3b7ff-131">Дополнительные сведения об использовании мастера создания публикаций и доступе к диалоговому окну **Свойства публикации — \<Publication>** см. в статьях [Создание публикации](create-a-publication.md) и [Просмотр и изменение свойств публикации](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-131">For more information about using the New Publication Wizard and accessing the **Publication Properties - \<Publication>** dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-set-partition-options-in-the-add-filter-or-edit-filter-dialog-box"></a><span data-ttu-id="3b7ff-132">Задание настройки «Параметры секционирования» в диалоговом окне «Добавить фильтр» или «Редактировать фильтр»</span><span class="sxs-lookup"><span data-stu-id="3b7ff-132">To set Partition options in the Add Filter or Edit Filter dialog box</span></span>  
  
1.  <span data-ttu-id="3b7ff-133">На странице **Фильтрация строк таблицы** мастера создания публикаций или на странице **Фильтрация строк** диалогового окна **Свойства публикации — \<Publication>** щелкните **Добавить**, а затем **Добавить фильтр**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-133">On the **Filter Table Rows** page of the New Publication Wizard or the **Filter Rows** page of the **Publication Properties - \<Publication>** dialog box, click **Add**, and then click **Add Filter**.</span></span>  
  
2.  <span data-ttu-id="3b7ff-134">Создайте параметризованный фильтр.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-134">Create a parameterized filter.</span></span> <span data-ttu-id="3b7ff-135">Дополнительные сведения см. в статье [Определение и изменение параметризованного фильтра строк для статьи публикации слиянием](define-and-modify-a-parameterized-row-filter-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-135">For more information, see [Define and Modify a Parameterized Row Filter for a Merge Article](define-and-modify-a-parameterized-row-filter-for-a-merge-article.md).</span></span>  
  
3.  <span data-ttu-id="3b7ff-136">Выберите параметр, который соответствует способу совместного использования данных подписчиками:</span><span class="sxs-lookup"><span data-stu-id="3b7ff-136">Select the option that matches how data will be shared among Subscribers:</span></span>  
  
    -   <span data-ttu-id="3b7ff-137">**Строка из этой таблицы будет отправлена нескольким подпискам**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-137">**A row from this table will go to multiple subscriptions**</span></span>  
  
    -   <span data-ttu-id="3b7ff-138">**Строка из этой таблицы будет отправлена только одной подписке**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-138">**A row from this table will go to only one subscription**</span></span>  
  
     <span data-ttu-id="3b7ff-139">Если выбрана настройка **Строка из этой таблицы будет отправлена только одной подписке**, производительность репликации слиянием будет оптимизирована путем уменьшения объема хранимых и обрабатываемых метаданных.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-139">If you select **A row from this table will go to only one subscription**, merge replication can optimize performance by storing and processing less metadata.</span></span> <span data-ttu-id="3b7ff-140">Однако следует убедиться, что данные секционированы таким образом, что одна строка не может быть реплицирована более чем одному подписчику.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-140">However, you must ensure that the data is partitioned in such a way that a row cannot be replicated to more than one Subscriber.</span></span> <span data-ttu-id="3b7ff-141">Дополнительные сведения см. в подразделе «Настройка параметров секционирования» раздела [Параметризованные фильтры строк](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-141">For more information, see the section "Setting 'partition options'" in the topic [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
5.  <span data-ttu-id="3b7ff-142">Если вы находитесь в диалоговом окне **Свойства публикации — \<Publication>** , нажмите кнопку **ОК**, чтобы сохранить результаты и закрыть диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-142">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
#### <a name="to-set-partition-options-in-the-article-properties---article-dialog-box"></a><span data-ttu-id="3b7ff-143">Настройка параметров секционирования в диалоговом окне «Свойства статьи — \<Article>»</span><span class="sxs-lookup"><span data-stu-id="3b7ff-143">To set Partition Options in the Article Properties - \<Article> dialog box</span></span>  
  
1.  <span data-ttu-id="3b7ff-144">На странице **Статьи** мастера создания публикаций или в диалоговом окне **Свойства публикации — \<Publication>** выберите таблицу и щелкните **Свойства статьи**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-144">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table, and then click **Article Properties**.</span></span>  
  
2.  <span data-ttu-id="3b7ff-145">Щелкните **Указать свойства выделенной статьи таблицы** или **Указать свойства всех статей таблиц**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-145">Click **Set Properties of Highlighted Table Article** or **Set Properties of All Table Articles**.</span></span>  
  
3.  <span data-ttu-id="3b7ff-146">В разделе **Целевой объект** вкладки **Свойства** диалогового окна **Свойства статьи — \<Article>** укажите одно из следующих значений в подразделе **Параметры секции**:</span><span class="sxs-lookup"><span data-stu-id="3b7ff-146">In the **Destination Object** section of the **Properties** tab of the **Article Properties - \<Article>** dialog box, specify one of the following values for **Partition Options**:</span></span>  
  
    -   <span data-ttu-id="3b7ff-147">**Перекрывающиеся**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-147">**Overlapping**</span></span>  
  
    -   <span data-ttu-id="3b7ff-148">**Перекрывающиеся, с запретом на изменение данных вне секции**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-148">**Overlapping, disallow out-of-partition data changes**</span></span>  
  
    -   <span data-ttu-id="3b7ff-149">**Неперекрывающаяся, одиночная подписка**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-149">**Nonoverlapping, single subscription**</span></span>  
  
    -   <span data-ttu-id="3b7ff-150">**Неперекрывающиеся, общие для нескольких подписок**</span><span class="sxs-lookup"><span data-stu-id="3b7ff-150">**Nonoverlapping, shared between subscriptions**</span></span>  
  
     <span data-ttu-id="3b7ff-151">Дополнительные сведения об этих параметрах и о том, как они связаны с параметрами, доступными в диалоговых окнах **Добавление фильтра** и **Изменение фильтра** , см. в подразделе «Установка параметров секционирования» раздела [параметризованные фильтры строк](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-151">For more information about these options and how they relate to the options available in the **Add Filter** and **Edit Filter** dialog boxes, see the "Setting 'partition options'" section of [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
5.  <span data-ttu-id="3b7ff-152">Если вы находитесь в диалоговом окне **Свойства публикации — \<Publication>** , нажмите кнопку **ОК**, чтобы сохранить результаты и закрыть диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-152">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
#### <a name="to-set-precompute-partitions"></a><span data-ttu-id="3b7ff-153">Задание настройки «Предварительное вычисление секций»</span><span class="sxs-lookup"><span data-stu-id="3b7ff-153">To set Precompute Partitions</span></span>  
  
1.  <span data-ttu-id="3b7ff-154">На странице **Параметры подписки** диалогового окна **Свойства публикации — \<Publication>** установите значение параметра **Предварительное вычисление секций**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-154">On the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box, select a value for the **Precompute Partitions** option.</span></span> <span data-ttu-id="3b7ff-155">Это свойство доступно только для чтения если:</span><span class="sxs-lookup"><span data-stu-id="3b7ff-155">The property is read-only if:</span></span>  
  
    -   <span data-ttu-id="3b7ff-156">Публикация не отвечает требованиям, предъявляемым к предварительно вычисляемым секциям.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-156">The publication does not meet the requirements for precomputed partitions.</span></span>  
  
    -   <span data-ttu-id="3b7ff-157">Для данной публикации еще не был создан моментальный снимок.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-157">A snapshot has not yet been generated for the publication.</span></span> <span data-ttu-id="3b7ff-158">В этом случае для данного параметра отображается значение **Устанавливается автоматически при создании моментального снимка**.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-158">In this case, the option displays a value of **Set automatically when a snapshot is created**.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-set-optimize-synchronization"></a><span data-ttu-id="3b7ff-159">Задание настройки «Оптимизировать синхронизацию»</span><span class="sxs-lookup"><span data-stu-id="3b7ff-159">To set Optimize Synchronization</span></span>  
  
1.  <span data-ttu-id="3b7ff-160">На странице **Параметры подписки** диалогового окна \*\*Свойства публикации — \<Publication> \*\* выберите значение **true** для параметра **оптимизировать синхронизацию** .</span><span class="sxs-lookup"><span data-stu-id="3b7ff-160">On the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box, select a value of **True** for the **Optimize Synchronization** option.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="3b7ff-161">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="3b7ff-161">Using Transact-SQL</span></span>  
 <span data-ttu-id="3b7ff-162">Определения параметров фильтрации для \*\* \@ keep_partition_changes\*\* и \*\* \@ use_partition_groups\*\*см. в разделе [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-162">For definitions of the filtering options for **\@keep_partition_changes** and **\@use_partition_groups**, see [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span></span>  
  
#### <a name="to-specify-merge-filter-optimizations-when-creating-a-new-publication"></a><span data-ttu-id="3b7ff-163">Указание оптимизации фильтра слияния при создании публикации</span><span class="sxs-lookup"><span data-stu-id="3b7ff-163">To specify merge filter optimizations when creating a new publication</span></span>  
  
1.  <span data-ttu-id="3b7ff-164">На издателе в базе данных публикации выполните процедуру [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-164">At the Publisher on the publication database, execute [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span></span> <span data-ttu-id="3b7ff-165">Укажите параметр \*\* \@ Публикация\*\* и значение `true` для одного из следующих параметров:</span><span class="sxs-lookup"><span data-stu-id="3b7ff-165">Specify **\@publication** and a value of `true` for one the following parameters:</span></span>  
  
    -   <span data-ttu-id="3b7ff-166">\*\* \@ use_partition_groups\*\*: — самая высокая оптимизация производительности при условии, что статьи соответствуют требованиям предварительно вычисленных секций.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-166">**\@use_partition_groups**: - the highest performance optimization, provided that the articles conform to the requirements for precomputed partitions.</span></span> <span data-ttu-id="3b7ff-167">Дополнительные сведения см. в статье [Оптимизация производительности параметризованного фильтра с помощью предварительно вычисляемых секций](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-167">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>  
  
    -   <span data-ttu-id="3b7ff-168">\*\* \@ keep_partition_changes\*\* — используйте эту оптимизацию, если предварительно вычисленные секции использовать нельзя.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-168">**\@keep_partition_changes** - use this optimization if precomputed partitions cannot be used.</span></span>  
  
2.  <span data-ttu-id="3b7ff-169">Добавьте задание моментального снимка для публикации.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-169">Add a snapshot job for the publication.</span></span> <span data-ttu-id="3b7ff-170">Дополнительные сведения см. в статье [о создании публикации](create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-170">For more information see [Create a Publication](create-a-publication.md).</span></span>  
  
3.  <span data-ttu-id="3b7ff-171">На издателе в базе данных публикации выполните хранимую процедуру [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), указав следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="3b7ff-171">At the Publisher on the publication database, execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), specifying the following parameters:</span></span>  
  
    -   <span data-ttu-id="3b7ff-172">\*\* \@ Публикация\*\* — имя публикации из шага 1.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-172">**\@publication** - the name of the publication from step 1.</span></span>  
  
    -   <span data-ttu-id="3b7ff-173">\*\* \@ статья\*\* — имя статьи</span><span class="sxs-lookup"><span data-stu-id="3b7ff-173">**\@article** - a name for the article</span></span>  
  
    -   <span data-ttu-id="3b7ff-174">\*\* \@ source_object\*\* — публикуемый объект базы данных.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-174">**\@source_object** - the database object being published.</span></span>  
  
    -   <span data-ttu-id="3b7ff-175">\*\* \@ subset_filterclause\*\* — необязательное предложение параметризованного фильтра, используемое для горизонтальной фильтрации статьи.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-175">**\@subset_filterclause** - the optional parameterized filter clause used to horizontally filter the article.</span></span>  
  
    -   <span data-ttu-id="3b7ff-176">\*\* \@ partition_options\*\* — параметры раздела для фильтруемой статьи.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-176">**\@partition_options** - the partition options for the filtered article.</span></span>  
  
4.  <span data-ttu-id="3b7ff-177">Повторите шаг 3 для каждой статьи в публикации.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-177">Repeat step 3 for each article in the publication.</span></span>  
  
5.  <span data-ttu-id="3b7ff-178">Чтобы определить фильтр соединения между двумя статьями, на издателе в базе данных публикации выполните процедуру [sp_addmergefilter](/sql/relational-databases/system-stored-procedures/sp-addmergefilter-transact-sql) (необязательно).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-178">(Optional) At the Publisher on the publication database, execute [sp_addmergefilter](/sql/relational-databases/system-stored-procedures/sp-addmergefilter-transact-sql) to define a join filter between two articles.</span></span> <span data-ttu-id="3b7ff-179">Дополнительные сведения см. в статье [Определение и изменение фильтра соединения между статьями публикации слиянием](define-and-modify-a-join-filter-between-merge-articles.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-179">For more information, see [Define and Modify a Join Filter Between Merge Articles](define-and-modify-a-join-filter-between-merge-articles.md).</span></span>  
  
#### <a name="to-view-and-modify-merge-filter-behaviors-for-an-existing-publication"></a><span data-ttu-id="3b7ff-180">Просмотр и изменение поведения фильтра слияния для существующей публикации</span><span class="sxs-lookup"><span data-stu-id="3b7ff-180">To view and modify merge filter behaviors for an existing publication</span></span>  
  
1.  <span data-ttu-id="3b7ff-181">Используемых На издателе в базе данных публикации выполните [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), указав \*\* \@ publication\*\*.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-181">(Optional) At the Publisher on the publication database, execute [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="3b7ff-182">Запомните значения **keep_partition_changes** и **use_partition_groups** в результирующем наборе.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-182">Note the value of **keep_partition_changes** and **use_partition_groups** in the result set.</span></span>  
  
2.  <span data-ttu-id="3b7ff-183">На издателе в базе данных публикации выполните процедуру [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql)(необязательно).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-183">(Optional) At the Publisher on the publication database, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql).</span></span> <span data-ttu-id="3b7ff-184">Укажите значение **use_partition_groups** для \*\* \@ Свойства\*\* и либо `true` для значения, либо `false` для \*\* \@ параметра\*\*.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-184">Specify a value of **use_partition_groups** for **\@property** and either `true` or `false` for **\@value**.</span></span>  
  
3.  <span data-ttu-id="3b7ff-185">На издателе в базе данных публикации выполните процедуру [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql)(необязательно).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-185">(Optional) At the Publisher on the publication database, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql).</span></span> <span data-ttu-id="3b7ff-186">Укажите значение **keep_partition_changes** для \*\* \@ Свойства\*\* и либо `true` для значения, либо `false` для \*\* \@ параметра\*\*.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-186">Specify a value of **keep_partition_changes** for **\@property** and either `true` or `false` for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3b7ff-187">При включении **keep_partition_changes**необходимо сначала отключить **use_partition_groups** и указать значение **1** для \*\* \@ force_reinit_subscription\*\*.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-187">When enabling **keep_partition_changes**, you must first disable **use_partition_groups** and specify a value of **1** for **\@force_reinit_subscription**.</span></span>  
  
4.  <span data-ttu-id="3b7ff-188">На издателе в базе данных публикации выполните хранимую процедуру [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)(необязательно).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-188">(Optional) At the Publisher on the publication database, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="3b7ff-189">Укажите значение **partition_options** для \*\* \@ Свойства\*\* и соответствующее значение для \*\* \@ value\*\*.</span><span class="sxs-lookup"><span data-stu-id="3b7ff-189">Specify a value of **partition_options** for **\@property** and the appropriate value for **\@value**.</span></span> <span data-ttu-id="3b7ff-190">Определения этих параметров фильтрации см. в разделе [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="3b7ff-190">See [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) for definitions of these filtering options.</span></span>  
  
5.  <span data-ttu-id="3b7ff-191">При необходимости запустите агент моментальных снимков для повторного создания моментального снимка (необязательно).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-191">(Optional) Start the Snapshot Agent to regenerate the snapshot if necessary.</span></span> <span data-ttu-id="3b7ff-192">Сведения об изменениях, после которых необходимо повторно создавать моментальный снимок, см. в статье [Изменение свойств публикации и статьи](change-publication-and-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="3b7ff-192">For information about which changes require a new snapshot to be generated, see [Change Publication and Article Properties](change-publication-and-article-properties.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3b7ff-193">См. также:</span><span class="sxs-lookup"><span data-stu-id="3b7ff-193">See Also</span></span>  
 <span data-ttu-id="3b7ff-194">[Automatically Generate Join Filters Between Merge Articles](automatically-generate-join-filters-between-merge-articles.md)  (Автоматическое создание фильтров соединения между статьями публикации слиянием)</span><span class="sxs-lookup"><span data-stu-id="3b7ff-194">[Automatically Generate a Set of Join Filters Between Merge Articles &#40;SQL Server Management Studio&#41;](automatically-generate-join-filters-between-merge-articles.md) </span></span>  
 <span data-ttu-id="3b7ff-195">[Определение и изменение параметризованного фильтра строк для статьи публикации слиянием](define-and-modify-a-parameterized-row-filter-for-a-merge-article.md) </span><span class="sxs-lookup"><span data-stu-id="3b7ff-195">[Define and Modify a Parameterized Row Filter for a Merge Article](define-and-modify-a-parameterized-row-filter-for-a-merge-article.md) </span></span>  
 [<span data-ttu-id="3b7ff-196">Параметризованные фильтры строк</span><span class="sxs-lookup"><span data-stu-id="3b7ff-196">Parameterized Row Filters</span></span>](../merge/parameterized-filters-parameterized-row-filters.md)  
  
  
