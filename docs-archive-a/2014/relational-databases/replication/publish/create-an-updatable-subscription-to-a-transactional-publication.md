---
title: Создание обновляемой подписки на публикацию транзакций (Management Studio) | Документация Майкрософт
ms.custom: ''
ms.date: 07/20/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- updateable transactional subscriptions
- updateable transactional subscriptions, SSMS
ms.assetid: f9ef89ed-36f6-431b-8843-25d445ec137f
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e784216116bdb9ab308dff5fa998740b0fa459b0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750687"
---
# <a name="create-an-updatable-subscription-to-a-transactional-publication-management-studio"></a><span data-ttu-id="040dc-102">Создание обновляемой подписки для публикации транзакций (среда Management Studio)</span><span class="sxs-lookup"><span data-stu-id="040dc-102">Create an Updatable Subscription to a Transactional Publication (Management Studio)</span></span>

> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
 
<span data-ttu-id="040dc-103">Репликация транзакций позволяет распространять изменения, выполненные на подписчике, обратно на издатель с помощью немедленно обновляемых подписок или обновляемых посредством очередей подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-103">Transactional replication enables changes made at a Subscriber to be propagated back to the Publisher using either immediate or queued updating subscriptions.</span></span> <span data-ttu-id="040dc-104">Можно создать обновляемую подписку программно с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="040dc-104">You can create an updating subscription programmatically using replication stored procedures.</span></span>

<span data-ttu-id="040dc-105">Настроить обновляемые подписки можно на странице **Обновляемые подписки** **мастера новых публикаций**.</span><span class="sxs-lookup"><span data-stu-id="040dc-105">Configure updatable subscriptions on the **Updatable Subscriptions** page of the **New Subscription Wizard**.</span></span> <span data-ttu-id="040dc-106">Эта страница доступна только тогда, когда включены публикации транзакций для обновляемых подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-106">This page is only available if you have enabled a transactional publication for updatable subscriptions.</span></span> <span data-ttu-id="040dc-107">Дополнительные сведения о включении обновляемых подписок см. в статье [Включение обновляемых подписок для публикаций транзакций](enable-updating-subscriptions-for-transactional-publications.md).</span><span class="sxs-lookup"><span data-stu-id="040dc-107">For more information about enabling updatable subscriptions, see [Enable Updating Subscriptions for Transactional Publications](enable-updating-subscriptions-for-transactional-publications.md).</span></span>   
  
## <a name="configure-an-updatable-subscription-from-the-publisher"></a><span data-ttu-id="040dc-108">Настройка обновляемой подписки из издателя</span><span class="sxs-lookup"><span data-stu-id="040dc-108">Configure an updatable subscription from the Publisher</span></span>  

1. <span data-ttu-id="040dc-109">Подключитесь к издателю в среде Microsoft SQL Server Management Studio и раскройте узел сервера.</span><span class="sxs-lookup"><span data-stu-id="040dc-109">Connect to the Publisher in Microsoft SQL Server Management Studio, and then expand the server node.</span></span>
2. <span data-ttu-id="040dc-110">Раскройте папку **Репликация** , а затем папку **Локальные публикации** .</span><span class="sxs-lookup"><span data-stu-id="040dc-110">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>
3. <span data-ttu-id="040dc-111">Щелкните правой кнопкой мыши публикацию транзакций, настроенную для обновления подписок, а затем щелкните **Создать подписку**.</span><span class="sxs-lookup"><span data-stu-id="040dc-111">Right-click a transactional publication enabled for updating subscriptions, and then click **New Subscriptions**.</span></span>
4. <span data-ttu-id="040dc-112">На страницах мастера укажите параметры подписки, например, место, где должен выполняться агент распространения.</span><span class="sxs-lookup"><span data-stu-id="040dc-112">Follow pages in the wizard to specify options for the subscription, such as where the Distribution Agent should run.</span></span>
5. <span data-ttu-id="040dc-113">На странице **Обновляемые подписки** в **мастере создания подписок** должен быть отмечен параметр **Реплицировать**.</span><span class="sxs-lookup"><span data-stu-id="040dc-113">On the **Updatable Subscriptions** page of the **New Subscription Wizard**, ensure **Replicate** is selected.</span></span>
6. <span data-ttu-id="040dc-114">Выберите параметр **Зафиксировать на стороне издателя** в раскрывающемся списке.</span><span class="sxs-lookup"><span data-stu-id="040dc-114">Select an option from the **Commit at Publisher** drop-down list:</span></span>

    *  <span data-ttu-id="040dc-115">Для немедленного обновления подписок выберите **Одновременно фиксировать изменения**.</span><span class="sxs-lookup"><span data-stu-id="040dc-115">To use immediate updating subscriptions, select **Simultaneously commit changes**.</span></span> <span data-ttu-id="040dc-116">Если выбран этот параметр, а для публикации разрешено обновление подписок посредством очередей (по умолчанию для публикаций, созданных с помощью мастера создания публикаций), то свойство подписки **update_mode** будет иметь значение **failover**.</span><span class="sxs-lookup"><span data-stu-id="040dc-116">If you select this option, and the publication allows queued updating subscriptions (the default for publications created with the New Publication Wizard), the subscription property **update_mode** is set to **failover**.</span></span> <span data-ttu-id="040dc-117">Этот режим позволяет, при необходимости позднее перейти к обновлению посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="040dc-117">This mode allows you to switch to queued updating later if necessary.</span></span>
    *  <span data-ttu-id="040dc-118">Для обновления подписок посредством очередей выберите **Ставить изменения в очередь и фиксировать при первой возможности**.</span><span class="sxs-lookup"><span data-stu-id="040dc-118">To use queued updating subscriptions, select **Queue changes and commit when possible**.</span></span> <span data-ttu-id="040dc-119">Если выбран этот параметр, для публикации разрешено немедленное обновление подписок (по умолчанию для публикаций, созданных с помощью мастера создания публикаций), и на подписчике работает SQL Server 2005 или более поздняя версия, то свойство подписки **update_mode** примет значение queued failover.</span><span class="sxs-lookup"><span data-stu-id="040dc-119">If you select this option, and the publication allows immediate updating subscriptions (the default for publications created with the New Publication Wizard), and the Subscriber is running SQL Server 2005 or a later version, the subscription property **update_mode** is set to queued failover.</span></span> <span data-ttu-id="040dc-120">Этот режим позволяет, при необходимости, включить немедленное обновление позднее.</span><span class="sxs-lookup"><span data-stu-id="040dc-120">This mode allows you to switch to immediate updating later if necessary.</span></span>

    <span data-ttu-id="040dc-121">Дополнительные сведения см. в статье [Переключение между режимами обновления для обновляемой подписки на публикацию транзакций](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="040dc-121">For information about switching update modes, see [Switch Between Update Modes for an Updatable Transactional Subscription](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span></span>

7. <span data-ttu-id="040dc-122">Страница **Имя входа для обновляемых подписок** отображается для подписок, применяющих немедленное обновление, либо имеющих параметр **update_mode** в значении **queued failover**.</span><span class="sxs-lookup"><span data-stu-id="040dc-122">The **Login for Updatable Subscriptions** page is displayed for subscriptions that use immediate updating or have **update_mode** set to **queued failover**.</span></span> <span data-ttu-id="040dc-123">На странице **Имя входа для обновляемых подписок** укажите связанный сервер, через который устанавливаются соединения с издателем для обновления подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-123">On the **Login for Updatable Subscriptions** page, specify a linked server over which connections to the Publisher are made for immediate updating subscriptions.</span></span> <span data-ttu-id="040dc-124">Соединения используются триггерами, которые запускаются на подписчике и распространяют изменения на издатель.</span><span class="sxs-lookup"><span data-stu-id="040dc-124">Connections are used by the triggers that fire at the Subscriber and propagate changes to the Publisher.</span></span> <span data-ttu-id="040dc-125">Выберите один из следующих вариантов.</span><span class="sxs-lookup"><span data-stu-id="040dc-125">Select one of the following options:</span></span>

    * <span data-ttu-id="040dc-126">**Создать связанный сервер, который соединяется с использованием проверки подлинности SQL Server.**</span><span class="sxs-lookup"><span data-stu-id="040dc-126">**Create a linked server that connects using SQL Server Authentication.**</span></span> <span data-ttu-id="040dc-127">Выберите этот параметр, если вы не определили удаленный сервер или связанный сервер между подписчиком и издателем.</span><span class="sxs-lookup"><span data-stu-id="040dc-127">Select this option if you have not defined a remote server or linked server between the Subscriber and the Publisher.</span></span> <span data-ttu-id="040dc-128">Репликация создает связанный сервер.</span><span class="sxs-lookup"><span data-stu-id="040dc-128">Replication creates a linked server for you.</span></span> <span data-ttu-id="040dc-129">Указанная учетная запись уже должна существовать на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-129">The account you specify must already exist at the Publisher.</span></span>
    * <span data-ttu-id="040dc-130">**Использовать уже указанный связанный или удаленный сервер**</span><span class="sxs-lookup"><span data-stu-id="040dc-130">**Use a linked server or remote server that you have already defined.**</span></span> <span data-ttu-id="040dc-131">Выберите этот параметр, если вы определили удаленный сервер или связанный сервер между подписчиком и издателем с помощью процедуры [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql),[sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio или другого метода.</span><span class="sxs-lookup"><span data-stu-id="040dc-131">Select this option if you have defined a remote server or linked server between the Subscriber and the Publisher using [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio, or another method.</span></span>

    <span data-ttu-id="040dc-132">Дополнительные сведения о разрешениях, требуемых для учетной записи связанного сервера, см. в статье **Подписки, обновляемые посредством очередей** из [введите здесь описание ссылки](../security/secure-the-subscriber.md)</span><span class="sxs-lookup"><span data-stu-id="040dc-132">For information about the permissions required by the linked server account, see the **Queued Updating Subscriptions** of [enter link description here](../security/secure-the-subscriber.md).</span></span>

8. <span data-ttu-id="040dc-133">Завершите работу мастера.</span><span class="sxs-lookup"><span data-stu-id="040dc-133">Complete the wizard.</span></span>

## <a name="configure-an-updatable-subscription-from-the-subscriber"></a><span data-ttu-id="040dc-134">Настройка обновляемой подписки из подписчика</span><span class="sxs-lookup"><span data-stu-id="040dc-134">Configure an updatable subscription from the Subscriber</span></span>


1. <span data-ttu-id="040dc-135">Подключитесь к подписчику в среде Microsoft SQL Server Management Studio и раскройте узел сервера.</span><span class="sxs-lookup"><span data-stu-id="040dc-135">Connect to the Subscriber in SQL Server Management Studio, and then expand the server node.</span></span>
2. <span data-ttu-id="040dc-136">Раскройте папку **Репликация** .</span><span class="sxs-lookup"><span data-stu-id="040dc-136">Expand the **Replication** folder.</span></span>
3. <span data-ttu-id="040dc-137">Щелкните правой кнопкой мыши папку **Локальные подписки** , затем щелкните **Создать подписку**.</span><span class="sxs-lookup"><span data-stu-id="040dc-137">Right-click the **Local Subscriptions** folder, and then click **New Subscriptions**.</span></span>
4. <span data-ttu-id="040dc-138">На странице **Публикация** **мастера создания подписки** выберите **Найти издатель SQL Server** из раскрывающегося списка **Издатель**.</span><span class="sxs-lookup"><span data-stu-id="040dc-138">On the **Publication** page of the **New Subscription Wizard**, select **Find SQL Server Publisher** from the **Publisher** drop-down list.</span></span>
5. <span data-ttu-id="040dc-139">Соединитесь с издателем в диалоговом окне **Соединение с сервером** .</span><span class="sxs-lookup"><span data-stu-id="040dc-139">Connect to the Publisher in the **Connect to Server** dialog box.</span></span>
6. <span data-ttu-id="040dc-140">Выберите публикацию транзакций, настроенную для обновляемых подписок на странице **Публикация**.</span><span class="sxs-lookup"><span data-stu-id="040dc-140">Select a transactional publication enabled for updating subscriptions on the **Publication** page.</span></span>
7. <span data-ttu-id="040dc-141">На страницах мастера укажите параметры подписки, например, место, где должен выполняться агент распространения.</span><span class="sxs-lookup"><span data-stu-id="040dc-141">Follow pages in the wizard to specify options for the subscription, such as where the Distribution Agent should run.</span></span>
8. <span data-ttu-id="040dc-142">На странице **Обновляемые подписки** в мастере создания подписок должен быть отмечен параметр **Реплицировать**.</span><span class="sxs-lookup"><span data-stu-id="040dc-142">On the **Updatable Subscriptions** page of the New Subscription Wizard, ensure **Replicate** is selected.</span></span>
9. <span data-ttu-id="040dc-143">Выберите параметр **Зафиксировать на стороне издателя** в раскрывающемся списке.</span><span class="sxs-lookup"><span data-stu-id="040dc-143">Select an option from the **Commit at Publisher** drop-down list:</span></span>

    * <span data-ttu-id="040dc-144">Для немедленного обновления подписок выберите **Одновременно фиксировать изменения**.</span><span class="sxs-lookup"><span data-stu-id="040dc-144">To use immediate updating subscriptions, select **Simultaneously commit changes**.</span></span> <span data-ttu-id="040dc-145">Если выбран этот параметр, а для публикации разрешено обновление подписок посредством очередей (по умолчанию для публикаций, созданных с помощью мастера создания публикаций), то свойство подписки **update_mode** будет иметь значение **failover**.</span><span class="sxs-lookup"><span data-stu-id="040dc-145">If you select this option, and the publication allows queued updating subscriptions (the default for publications created with the New Publication Wizard), the subscription property **update_mode** is set to **failover**.</span></span> <span data-ttu-id="040dc-146">Этот режим позволяет, при необходимости позднее перейти к обновлению посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="040dc-146">This mode allows you to switch to queued updating later if necessary.</span></span>
    * <span data-ttu-id="040dc-147">Для обновления подписок посредством очередей выберите **Ставить изменения в очередь и фиксировать при первой возможности**.</span><span class="sxs-lookup"><span data-stu-id="040dc-147">To use queued updating subscriptions, select **Queue changes and commit when possible**.</span></span> <span data-ttu-id="040dc-148">Если выбран этот параметр, для публикации разрешено немедленное обновление подписок (по умолчанию для публикаций, созданных с помощью мастера создания публикаций), и на подписчике работает SQL Server 2005 или более поздняя версия, то свойство подписки **update_mode** примет значение **queued failover**.</span><span class="sxs-lookup"><span data-stu-id="040dc-148">If you select this option, and the publication allows immediate updating subscriptions (the default for publications created with the New Publication Wizard), and the Subscriber is running SQL Server 2005 or a later version, the subscription property **update_mode** is set to queued **failover**.</span></span> <span data-ttu-id="040dc-149">Этот режим позволяет, при необходимости, включить немедленное обновление позднее.</span><span class="sxs-lookup"><span data-stu-id="040dc-149">This mode allows you to switch to immediate updating later if necessary.</span></span>

    <span data-ttu-id="040dc-150">Дополнительные сведения см. в статье [Переключение между режимами обновления для обновляемой подписки на публикацию транзакций](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="040dc-150">For information about switching update modes, see [Switch Between Update Modes for an Updatable Transactional Subscription](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span></span>

10. <span data-ttu-id="040dc-151">Страница **Имя входа для обновляемых подписок** отображается для подписок, применяющих немедленное обновление, либо имеющих параметр **update_mode** в значении **queued failover**.</span><span class="sxs-lookup"><span data-stu-id="040dc-151">The **Login for Updatable Subscriptions** page is displayed for subscriptions that use immediate updating or have **update_mode** set to queued **failover**.</span></span> <span data-ttu-id="040dc-152">На странице **Имя входа для обновляемых подписок** укажите связанный сервер, через который устанавливаются соединения с издателем для обновления подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-152">On the **Login for Updatable Subscriptions** page, specify a linked server over which connections to the Publisher are made for immediate updating subscriptions.</span></span> <span data-ttu-id="040dc-153">Соединения используются триггерами, которые запускаются на подписчике и распространяют изменения на издатель.</span><span class="sxs-lookup"><span data-stu-id="040dc-153">Connections are used by the triggers that fire at the Subscriber and propagate changes to the Publisher.</span></span> <span data-ttu-id="040dc-154">Выберите один из следующих вариантов.</span><span class="sxs-lookup"><span data-stu-id="040dc-154">Select one of the following options:</span></span>

    * <span data-ttu-id="040dc-155">**Создать связанный сервер, который соединяется с использованием проверки подлинности SQL Server.**</span><span class="sxs-lookup"><span data-stu-id="040dc-155">**Create a linked server that connects using SQL Server Authentication.**</span></span> <span data-ttu-id="040dc-156">Выберите этот параметр, если вы не определили удаленный сервер или связанный сервер между подписчиком и издателем.</span><span class="sxs-lookup"><span data-stu-id="040dc-156">Select this option if you have not defined a remote server or linked server between the Subscriber and the Publisher.</span></span> <span data-ttu-id="040dc-157">Репликация создает связанный сервер.</span><span class="sxs-lookup"><span data-stu-id="040dc-157">Replication creates a linked server for you.</span></span> <span data-ttu-id="040dc-158">Указанная учетная запись уже должна существовать на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-158">The account you specify must already exist at the Publisher.</span></span>
    * <span data-ttu-id="040dc-159">**Использовать уже указанный связанный или удаленный сервер**</span><span class="sxs-lookup"><span data-stu-id="040dc-159">**Use a linked server or remote server that you have already defined.**</span></span> <span data-ttu-id="040dc-160">Выберите этот параметр, если вы определили удаленный сервер или связанный сервер между подписчиком и издателем с помощью процедуры [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql),[sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio или другого метода.</span><span class="sxs-lookup"><span data-stu-id="040dc-160">Select this option if you have defined a remote server or linked server between the Subscriber and the Publisher using [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio, or another method.</span></span>

    <span data-ttu-id="040dc-161">Дополнительные сведения о разрешениях, требуемых для учетной записи связанного сервера, см. в статье **Подписки, обновляемые посредством очередей** из [введите здесь описание ссылки](../security/secure-the-subscriber.md)</span><span class="sxs-lookup"><span data-stu-id="040dc-161">For information about the permissions required by the linked server account, see the **Queued Updating Subscriptions** of [enter link description here](../security/secure-the-subscriber.md).</span></span>

11. <span data-ttu-id="040dc-162">Завершите работу мастера.</span><span class="sxs-lookup"><span data-stu-id="040dc-162">Complete the wizard.</span></span>

## <a name="create-an-immediate-updating-pull-subscription"></a><span data-ttu-id="040dc-163">Создание немедленно обновляемой подписки по запросу</span><span class="sxs-lookup"><span data-stu-id="040dc-163">Create an immediate updating pull subscription</span></span>

1. <span data-ttu-id="040dc-164">Проверьте на издателе, что публикация поддерживает немедленное обновление подписок. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-164">At the Publisher, verify that the publication supports immediate updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-165">Если значение параметра `allow_sync_tran` в результирующем наборе равно `1`, то публикация поддерживает немедленное обновление подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-165">If the value of `allow_sync_tran` in the result set is `1`, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="040dc-166">Если значение параметра `allow_sync_tran` в результирующем наборе равно `0`, публикацию необходимо создать заново с включенной возможностью немедленного обновления подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-166">If the value of `allow_sync_tran` in the result set is `0`, the publication must be recreated with immediate updating subscriptions enabled.</span></span>

2. <span data-ttu-id="040dc-167">Проверьте на издателе, что публикация поддерживает подписки по запросу. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-167">At the Publisher, verify that the publication supports pull subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-168">Если значение столбца `allow_pull` в результирующем наборе равно `1`, то публикация поддерживает подписки по запросу.</span><span class="sxs-lookup"><span data-stu-id="040dc-168">If the value of `allow_pull` in the result set is `1`, the publication supports pull subscriptions.</span></span>
    * <span data-ttu-id="040dc-169">Если `allow_pull` имеет значение `0`, выполните хранимую процедуру [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), указав при этом значение `allow_pull` для параметра `@property` и значение `true` для параметра `@value`.</span><span class="sxs-lookup"><span data-stu-id="040dc-169">If the value of `allow_pull` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `allow_pull` for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="040dc-170">Выполните процедуру [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql)на подписчике.</span><span class="sxs-lookup"><span data-stu-id="040dc-170">At the Subscriber, execute [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="040dc-171">Задайте `@publisher` и `@publication`, а также установите одно из следующих значений для `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="040dc-171">Specify `@publisher` and `@publication`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="040dc-172">`sync tran` — включает подписку для немедленного обновления;</span><span class="sxs-lookup"><span data-stu-id="040dc-172">`sync tran` - enables the subscription for immediate updating.</span></span>
    * <span data-ttu-id="040dc-173">`failover` — включает для подписки немедленное обновление, с обновлением посредством очередей в случае отработки отказа;</span><span class="sxs-lookup"><span data-stu-id="040dc-173">`failover` - enables the subscription for immediate updating with queued updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="040dc-174">`failover` — требует, чтобы для публикации были включены обновляемые посредством очередей подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-174">`failover` requires that the publication also be enabled for queued updating subscriptions.</span></span> 
 
4. <span data-ttu-id="040dc-175">Выполните процедуру [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql)на подписчике.</span><span class="sxs-lookup"><span data-stu-id="040dc-175">At the Subscriber, execute [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="040dc-176">Укажите следующее.</span><span class="sxs-lookup"><span data-stu-id="040dc-176">Specify the following:</span></span>

    * <span data-ttu-id="040dc-177">Параметры `@publisher`, `@publisher_db`и `@publication` .</span><span class="sxs-lookup"><span data-stu-id="040dc-177">The `@publisher`, `@publisher_db`, and `@publication` parameters.</span></span> 
    * <span data-ttu-id="040dc-178">Учетные данные пользователя Microsoft Windows, от имени которого на подписчике запускается агент распространителя, в качестве значений параметров `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-178">The Microsoft Windows credentials under which the Distribution Agent at the Subscriber runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="040dc-179">Соединения, производимые с использованием встроенной проверки подлинности Windows, всегда используют учетные данные Windows, указанные в параметрах `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-179">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="040dc-180">Агент распространителя всегда создает локальное соединение с подписчиком с использованием встроенной проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="040dc-180">The Distribution Agent always makes the local connection to the Subscriber using Windows Integrated Authentication.</span></span> <span data-ttu-id="040dc-181">По умолчанию агент соединяется с распространителем с использованием встроенной проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="040dc-181">By default, the agent connects to the Distributor using Windows Integrated Authentication.</span></span> 
 
    * <span data-ttu-id="040dc-182">(Необязательно) Значение `0` для параметра `@distributor_security_mode` и данные входа Microsoft SQL Server для параметров `@distributor_login` и `@distributor_password`, если для соединения с распространителем нужно использовать проверку подлинности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="040dc-182">(Optional) A value of `0` for `@distributor_security_mode` and the Microsoft SQL Server login information for `@distributor_login` and `@distributor_password`, if you need to use SQL Server Authentication when connecting to the Distributor.</span></span> 
    * <span data-ttu-id="040dc-183">Расписание задания агента распространителя для этой подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-183">A schedule for the Distribution Agent job for this subscription.</span></span> 

5. <span data-ttu-id="040dc-184">В базе данных подписки на подписчике выполните процедуру [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-184">At the Subscriber on the subscription database, execute [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span> <span data-ttu-id="040dc-185">Укажите параметр `@publisher`, параметр `@publication`, имя базы данных публикации в параметре `@publisher_db`и одно из следующих значений параметра `@security_mode`.</span><span class="sxs-lookup"><span data-stu-id="040dc-185">Specify `@publisher`, `@publication`, the name of the publication database for `@publisher_db`, and one of the following values for `@security_mode`:</span></span> 

    * <span data-ttu-id="040dc-186">`0` — Использовать проверку подлинности SQL Server при выполнении обновлений на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-186">`0` - Use SQL Server Authentication when making updates at the Publisher.</span></span> <span data-ttu-id="040dc-187">При этом необходимо указать допустимое имя входа на издатель в параметрах `@login` и `@password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-187">This option requires you to specify a valid login at the Publisher for `@login` and `@password`.</span></span>
    * <span data-ttu-id="040dc-188">`1` — При соединении с издателем использовать контекст безопасности пользователя, выполняющего изменения на подписчике.</span><span class="sxs-lookup"><span data-stu-id="040dc-188">`1` - Use the security context of the user making changes at the Subscriber when connecting to the Publisher.</span></span> <span data-ttu-id="040dc-189">Связанные с этим режимом безопасности ограничения см. в разделе [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="040dc-189">See [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) for restrictions related to this security mode.</span></span>
    * <span data-ttu-id="040dc-190">`2` — Использовать существующее определенное пользователем имя входа на связанный сервер, созданное с помощью процедуры [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-190">`2` - Use an existing, user-defined linked server login created using [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>

6. <span data-ttu-id="040dc-191">Выполните на издателе хранимую процедуру [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) , указав параметры `@publication`, `@subscriber`, `@destination_db`, значение pull в параметре `@subscription_type`и значение, указанное в шаге 3, в параметре `@update_mode`.</span><span class="sxs-lookup"><span data-stu-id="040dc-191">At the publisher, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) specifying `@publication`, `@subscriber`, `@destination_db`, a value of pull for `@subscription_type`, and the same value specified in step 3 for `@update_mode`.</span></span>

<span data-ttu-id="040dc-192">Подписка по запросу на издателе будет зарегистрирована.</span><span class="sxs-lookup"><span data-stu-id="040dc-192">This registers the pull subscription at the Publisher.</span></span> 


## <a name="create-an-immediate-updating-push-subscription"></a><span data-ttu-id="040dc-193">Создание немедленно обновляемой принудительной подписки</span><span class="sxs-lookup"><span data-stu-id="040dc-193">Create an immediate updating push subscription</span></span> 

1. <span data-ttu-id="040dc-194">Проверьте на издателе, что публикация поддерживает немедленное обновление подписок. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-194">At the Publisher, verify that the publication supports immediate updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-195">Если значение параметра `allow_sync_tran` в результирующем наборе равно `1`, то публикация поддерживает немедленное обновление подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-195">If the value of `allow_sync_tran` in the result set is `1`, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="040dc-196">Если значение параметра `allow_sync_tran` в результирующем наборе равно `0`, публикацию необходимо создать заново с включенной возможностью немедленного обновления подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-196">If the value of `allow_sync_tran` in the result set is `0`, the publication must be recreated with immediate updating subscriptions enabled.</span></span>

2. <span data-ttu-id="040dc-197">Проверьте на издателе, что публикация поддерживает принудительные подписки. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-197">At the Publisher, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-198">Если значение столбца `allow_push` в результирующем наборе равно `1`, то публикация поддерживает принудительные подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-198">If the value of `allow_push` in the result set is `1`, the publication supports push subscriptions.</span></span>
    * <span data-ttu-id="040dc-199">Если `allow_push` имеет значение `0`, выполните хранимую процедуру [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), указав при этом значение `allow_push` для параметра `@property` и значение `true` для параметра `@value`.</span><span class="sxs-lookup"><span data-stu-id="040dc-199">If the value of `allow_push` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `allow_push` for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="040dc-200">Выполните процедуру [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-200">At the Publisher, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="040dc-201">Задайте `@publication`, `@subscriber`и `@destination_db`, а также установите одно из следующих значений для `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="040dc-201">Specify `@publication`, `@subscriber`, `@destination_db`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="040dc-202">`sync tran` — включает поддержку немедленного обновления;</span><span class="sxs-lookup"><span data-stu-id="040dc-202">`sync tran` - enables support for immediate updating.</span></span>
    * <span data-ttu-id="040dc-203">`failover` — включает поддержку немедленного обновления с обновлением посредством очередей при отработке отказа;</span><span class="sxs-lookup"><span data-stu-id="040dc-203">`failover` - enables support for immediate updating with queued updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="040dc-204">`failover` — требует, чтобы для публикации были включены обновляемые посредством очередей подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-204">`failover` requires that the publication also be enabled for queued updating subscriptions.</span></span> 
 
4. <span data-ttu-id="040dc-205">Выполните процедуру [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql)на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-205">At the Publisher, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="040dc-206">Укажите значения следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="040dc-206">Specify the following parameters:</span></span>

    * <span data-ttu-id="040dc-207">`@subscriber`, `@subscriber_db`и `@publication`.</span><span class="sxs-lookup"><span data-stu-id="040dc-207">`@subscriber`, `@subscriber_db`, and `@publication`.</span></span> 
    * <span data-ttu-id="040dc-208">Учетные данные Windows, с которыми будет запускаться агент распространителя на распространителе, в параметрах `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-208">The Windows credentials under which the Distribution Agent at the Distributor runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="040dc-209">Соединения, производимые с использованием встроенной проверки подлинности Windows, всегда используют учетные данные Windows, указанные в параметрах `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-209">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="040dc-210">Агент распространителя всегда создает локальные соединения с распространителем через встроенную систему проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="040dc-210">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="040dc-211">По умолчанию агент подключается к подписчику через встроенную систему проверки подлинности Windows;</span><span class="sxs-lookup"><span data-stu-id="040dc-211">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span> 

    * <span data-ttu-id="040dc-212">(Необязательно) Значение `0` для параметра `@subscriber_security_mode` и данные входа SQL Server для параметров `@subscriber_login` и `@subscriber_password`, если для соединения с подписчиком нужно использовать проверку подлинности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="040dc-212">(Optional) A value of `0` for `@subscriber_security_mode` and the SQL Server login information for `@subscriber_login` and `@subscriber_password`, if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span> 
    * <span data-ttu-id="040dc-213">Расписание задания агента распространителя для этой подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-213">A schedule for the Distribution Agent job for this subscription.</span></span>

5. <span data-ttu-id="040dc-214">В базе данных подписки на подписчике выполните процедуру [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-214">At the Subscriber on the subscription database, execute [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span> <span data-ttu-id="040dc-215">Укажите параметр `@publisher`, параметр `@publication`, имя базы данных публикации в параметре `@publisher_db`и одно из следующих значений параметра `@security_mode`.</span><span class="sxs-lookup"><span data-stu-id="040dc-215">Specify `@publisher`, `@publication`, the name of the publication database for `@publisher_db`, and one of the following values for `@security_mode`:</span></span> 

     * <span data-ttu-id="040dc-216">`0` — Использовать проверку подлинности SQL Server при выполнении обновлений на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-216">`0` - Use SQL Server Authentication when making updates at the Publisher.</span></span> <span data-ttu-id="040dc-217">При этом необходимо указать допустимое имя входа на издатель в параметрах `@login` и `@password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-217">This option requires you to specify a valid login at the Publisher for `@login` and `@password`.</span></span>
     * <span data-ttu-id="040dc-218">`1` — При соединении с издателем использовать контекст безопасности пользователя, выполняющего изменения на подписчике.</span><span class="sxs-lookup"><span data-stu-id="040dc-218">`1` - Use the security context of the user making changes at the Subscriber when connecting to the Publisher.</span></span> <span data-ttu-id="040dc-219">Связанные с этим режимом безопасности ограничения см. в разделе [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="040dc-219">See [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) for restrictions related to this security mode.</span></span>
     * <span data-ttu-id="040dc-220">`2` — Использовать существующее определенное пользователем имя входа на связанный сервер, созданное с помощью процедуры [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-220">`2` - Use an existing, user-defined linked server login created using [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>


## <a name="create-a-queued-updating-pull-subscription"></a><span data-ttu-id="040dc-221">Создание обновляемой посредством очередей подписки по запросу</span><span class="sxs-lookup"><span data-stu-id="040dc-221">Create a queued updating pull subscription</span></span> ##

1. <span data-ttu-id="040dc-222">Проверьте на издателе, что публикация поддерживает обновляемые посредством очередей подписки. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-222">At the Publisher, verify that the publication supports queued updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-223">Если значение параметра `allow_queued_tran` в результирующем наборе равно `1`, то публикация поддерживает немедленное обновление подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-223">If the value of `allow_queued_tran` in the result set is `1`, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="040dc-224">Если значение параметра `allow_queued_tran` в результирующем наборе равно `0`, публикацию необходимо создать заново с включенной возможностью обновления подписок посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="040dc-224">If the value of `allow_queued_tran` in the result set is `0`, the publication must be recreated with queued updating subscriptions enabled.</span></span>

2. <span data-ttu-id="040dc-225">Проверьте на издателе, что публикация поддерживает подписки по запросу. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-225">At the Publisher, verify that the publication supports pull subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-226">Если значение столбца `allow_pull` в результирующем наборе равно `1`, то публикация поддерживает подписки по запросу.</span><span class="sxs-lookup"><span data-stu-id="040dc-226">If the value of `allow_pull` in the result set is `1`, the publication supports pull subscriptions.</span></span>
    * <span data-ttu-id="040dc-227">Если `allow_pull` имеет значение `0`, выполните хранимую процедуру [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), указав при этом значение `allow_pull` для параметра `@property` и значение `true` для параметра `@value`.</span><span class="sxs-lookup"><span data-stu-id="040dc-227">If the value of `allow_pull` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `allow_pull` for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="040dc-228">Выполните процедуру [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql)на подписчике.</span><span class="sxs-lookup"><span data-stu-id="040dc-228">At the Subscriber, execute [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="040dc-229">Задайте `@publisher` и `@publication`, а также установите одно из следующих значений для `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="040dc-229">Specify `@publisher` and `@publication`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="040dc-230">`queued tran` — включает возможность обновления подписок посредством очередей;</span><span class="sxs-lookup"><span data-stu-id="040dc-230">`queued tran` - enables the subscription for queued updating.</span></span>
    * <span data-ttu-id="040dc-231">`queued failover` — включает поддержку обновления посредством очередей с немедленным обновлением в качестве варианта для отработки отказа;</span><span class="sxs-lookup"><span data-stu-id="040dc-231">`queued failover` - enables support for queued updating with immediate updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="040dc-232">`queued failover` — требует, чтобы для публикации также были включены немедленно обновляемые подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-232">`queued failover` requires that the publication also be enabled for immediate updating subscriptions.</span></span> <span data-ttu-id="040dc-233">Чтобы переключиться на немедленное обновление, необходимо использовать процедуру [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) для определения учетных данных, с которыми изменения на подписчике реплицируются на издатель.</span><span class="sxs-lookup"><span data-stu-id="040dc-233">To fail over to immediate updating, you must use [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) to define the credentials under which changes at the Subscriber are replicated to the Publisher.</span></span>
 
4. <span data-ttu-id="040dc-234">Выполните процедуру [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql)на подписчике.</span><span class="sxs-lookup"><span data-stu-id="040dc-234">At the Subscriber, execute [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="040dc-235">Укажите значения следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="040dc-235">Specify the following parameters:</span></span>

    * <span data-ttu-id="040dc-236">@publisher, `@publisher_db`и `@publication`.</span><span class="sxs-lookup"><span data-stu-id="040dc-236">@publisher, `@publisher_db`, and `@publication`.</span></span> 
    * <span data-ttu-id="040dc-237">Учетные данные Windows, с которыми будет запускаться агент распространителя на подписчике, в параметрах `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-237">The Windows credentials under which the Distribution Agent at the Subscriber runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="040dc-238">Соединения, производимые с использованием встроенной проверки подлинности Windows, всегда используют учетные данные Windows, указанные в параметрах `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-238">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="040dc-239">Агент распространителя всегда создает локальное соединение с подписчиком с использованием встроенной проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="040dc-239">The Distribution Agent always makes the local connection to the Subscriber using Windows Integrated Authentication.</span></span> <span data-ttu-id="040dc-240">По умолчанию агент соединяется с распространителем с использованием встроенной проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="040dc-240">By default, the agent connects to the Distributor using Windows Integrated Authentication.</span></span> 
 
    * <span data-ttu-id="040dc-241">(Необязательно) Значение `0` для параметра `@distributor_security_mode` и данные входа SQL Server для параметров `@distributor_login` и `@distributor_password`, если для соединения с распространителем нужно использовать проверку подлинности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="040dc-241">(Optional) A value of `0` for `@distributor_security_mode` and the SQL Server login information for `@distributor_login` and `@distributor_password`, if you need to use SQL Server Authentication when connecting to the Distributor.</span></span> 
    * <span data-ttu-id="040dc-242">Расписание задания агента распространителя для этой подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-242">A schedule for the Distribution Agent job for this subscription.</span></span>

5. <span data-ttu-id="040dc-243">Выполните на издателе хранимую процедуру [sp_addsubscriber](/sql/relational-databases/system-stored-procedures/sp-addsubscriber-transact-sql) для регистрации подписчика на издателе, указав параметры `@publication`, `@subscriber`, `@destination_db`, значение pull в параметре `@subscription_type`и значение, указанное в шаге 3, в параметре `@update_mode`.</span><span class="sxs-lookup"><span data-stu-id="040dc-243">At the publisher, execute [sp_addsubscriber](/sql/relational-databases/system-stored-procedures/sp-addsubscriber-transact-sql) to register the Subscriber at the Publisher, specifying `@publication`, `@subscriber`, `@destination_db`, a value of pull for `@subscription_type`, and the same value specified in step 3 for `@update_mode`.</span></span>

<span data-ttu-id="040dc-244">Подписка по запросу на издателе будет зарегистрирована.</span><span class="sxs-lookup"><span data-stu-id="040dc-244">This registers the pull subscription at the Publisher.</span></span> 


## <a name="to-create-a-queued-updating-push-subscription"></a><span data-ttu-id="040dc-245">Создание принудительной подписки, обновляемой посредством очередей</span><span class="sxs-lookup"><span data-stu-id="040dc-245">To create a queued updating push subscription</span></span> ##

1. <span data-ttu-id="040dc-246">Проверьте на издателе, что публикация поддерживает обновляемые посредством очередей подписки. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-246">At the Publisher, verify that the publication supports queued updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-247">Если значение allow_queued_tran в результирующем наборе равно 1, то публикация поддерживает немедленное обновление подписок.</span><span class="sxs-lookup"><span data-stu-id="040dc-247">If the value of allow_queued_tran in the result set is 1, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="040dc-248">Если значение allow_queued_tran в результирующем наборе равно 0, публикацию необходимо создать заново с включенной возможностью обновления подписок посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="040dc-248">If the value of allow_queued_tran in the result set is 0, the publication must be recreated with queued updating subscriptions enabled.</span></span> <span data-ttu-id="040dc-249">Дополнительные сведения см. в разделе "Как включить обновляемые подписки для публикаций транзакций (программирование репликации на языке Transact-SQL)".</span><span class="sxs-lookup"><span data-stu-id="040dc-249">For more information, see How to: Enable Updating Subscriptions for Transactional Publications (Replication Transact-SQL Programming).</span></span>

2. <span data-ttu-id="040dc-250">Проверьте на издателе, что публикация поддерживает принудительные подписки. Для этого выполните процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="040dc-250">At the Publisher, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="040dc-251">Если значение столбца `allow_push` в результирующем наборе равно `1`, то публикация поддерживает принудительные подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-251">If the value of `allow_push` in the result set is `1`, the publication supports push subscriptions.</span></span>
    * <span data-ttu-id="040dc-252">Если `allow_push` имеет значение `0`, выполните хранимую процедуру [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), указав при этом значение allow_push для параметра `@property` и значение `true` для параметра `@value`.</span><span class="sxs-lookup"><span data-stu-id="040dc-252">If the value of `allow_push` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying allow_push for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="040dc-253">Выполните процедуру [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-253">At the Publisher, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="040dc-254">Задайте `@publication`, `@subscriber`и `@destination_db`, а также установите одно из следующих значений для `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="040dc-254">Specify `@publication`, `@subscriber`, `@destination_db`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="040dc-255">`queued tran` — включает возможность обновления подписок посредством очередей;</span><span class="sxs-lookup"><span data-stu-id="040dc-255">`queued tran` - enables the subscription for queued updating.</span></span>
    * <span data-ttu-id="040dc-256">`queued failover` — включает поддержку обновления посредством очередей с немедленным обновлением в качестве варианта для отработки отказа;</span><span class="sxs-lookup"><span data-stu-id="040dc-256">`queued failover` - enables support for queued updating with immediate updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="040dc-257">Параметр queued failover требует, чтобы для публикации также были включены немедленно обновляемые подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-257">The queued failover option requires that the publication also be enabled for immediate updating subscriptions.</span></span> <span data-ttu-id="040dc-258">Чтобы переключиться на немедленное обновление, необходимо использовать процедуру [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) для определения учетных данных, с которыми изменения на подписчике реплицируются на издатель.</span><span class="sxs-lookup"><span data-stu-id="040dc-258">To fail over to immediate updating, you must use [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) to define the credentials under which changes at the Subscriber are replicated to the Publisher.</span></span>

4. <span data-ttu-id="040dc-259">Выполните процедуру [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql)на издателе.</span><span class="sxs-lookup"><span data-stu-id="040dc-259">At the Publisher, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="040dc-260">Укажите значения следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="040dc-260">Specify the following parameters:</span></span>

    * <span data-ttu-id="040dc-261">`@subscriber`, `@subscriber_db`и `@publication`.</span><span class="sxs-lookup"><span data-stu-id="040dc-261">`@subscriber`, `@subscriber_db`, and `@publication`.</span></span> 
    * <span data-ttu-id="040dc-262">Учетные данные Windows, с которыми будет запускаться агент распространителя на распространителе, в параметрах `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-262">The Windows credentials under which the Distribution Agent at the Distributor runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="040dc-263">Соединения, производимые с использованием встроенной проверки подлинности Windows, всегда используют учетные данные Windows, указанные в параметрах `@job_login` и `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="040dc-263">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="040dc-264">Агент распространителя всегда создает локальные соединения с распространителем через встроенную систему проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="040dc-264">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="040dc-265">По умолчанию агент подключается к подписчику с помощью встроенной проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="040dc-265">By default, the agent connects to the Subscriber using Windows Integrated Authentication.</span></span> 
 
    * <span data-ttu-id="040dc-266">(Необязательно) Значение `0` для параметра `@subscriber_security_mode` и данные входа SQL Server для параметров `@subscriber_login` и `@subscriber_password`, если для соединения с подписчиком нужно использовать проверку подлинности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="040dc-266">(Optional) A value of `0` for `@subscriber_security_mode` and the SQL Server login information for `@subscriber_login` and `@subscriber_password`, if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span> 
    * <span data-ttu-id="040dc-267">Расписание задания агента распространителя для этой подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-267">A schedule for the Distribution Agent job for this subscription.</span></span>


## <a name="example"></a><span data-ttu-id="040dc-268">Пример</span><span class="sxs-lookup"><span data-stu-id="040dc-268">Example</span></span> ##

<span data-ttu-id="040dc-269">В этом примере создается немедленно обновляемая подписка по запросу на публикацию, поддерживающую немедленно обновляемые подписки.</span><span class="sxs-lookup"><span data-stu-id="040dc-269">This example creates an immediate updating pull subscription to a publication that supports immediate updating subscriptions.</span></span> <span data-ttu-id="040dc-270">Имя входа и пароль предоставляются во время выполнения переменными сценария sqlcmd.</span><span class="sxs-lookup"><span data-stu-id="040dc-270">Login and password values are supplied at runtime using sqlcmd scripting variables.</span></span>

> [!NOTE]  
>  <span data-ttu-id="040dc-271">Этот скрипт использует переменные скрипта sqlcmd.</span><span class="sxs-lookup"><span data-stu-id="040dc-271">This script uses sqlcmd scripting variables.</span></span> <span data-ttu-id="040dc-272">Они представлены в виде `$(MyVariable)`.</span><span class="sxs-lookup"><span data-stu-id="040dc-272">They are in the form `$(MyVariable)`.</span></span> <span data-ttu-id="040dc-273">Сведения об использовании переменных скрипта в командной строке и среде SQL Server Management Studio см. в подразделе **Выполнение скриптов репликации** раздела [Основные понятия системных хранимых процедур репликации](../concepts/replication-system-stored-procedures-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="040dc-273">For information about how to use scripting variables on the command line and in SQL Server Management Studio, see the **Executing Replication Scripts** section in the topic [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>

```sql
-- Execute this batch at the Subscriber.
DECLARE @publication AS sysname;
DECLARE @publicationDB AS sysname;
DECLARE @publisher AS sysname;
DECLARE @login AS sysname;
DECLARE @password AS nvarchar(512);
SET @publication = N'AdvWorksProductTran';
SET @publicationDB = N'AdventureWorks2008R2';
SET @publisher = $(PubServer);
SET @login = $(Login);
SET @password = $(Password);

-- At the subscription database, create a pull subscription to a transactional 
-- publication using immediate updating with queued updating as a failover.
EXEC sp_addpullsubscription 
    @publisher = @publisher, 
    @publication = @publication, 
    @publisher_db = @publicationDB, 
    @update_mode = N'failover', 
    @subscription_type = N'pull';

-- Add an agent job to synchronize the pull subscription, 
-- which uses Windows Authentication when connecting to the Distributor.
EXEC sp_addpullsubscription_agent 
    @publisher = @publisher, 
    @publisher_db = @publicationDB, 
    @publication = @publication,
    @job_login = @login,
    @job_password = @password; 

-- Add a Windows Authentication-based linked server that enables the 
-- Subscriber-side triggers to make updates at the Publisher. 
EXEC sp_link_publication 
    @publisher = @publisher, 
    @publication = @publication,
    @publisher_db = @publicationDB, 
    @security_mode = 0,
    @login = @login,
    @password = @password;
GO

USE AdventureWorks2008R2;
GO

-- Execute this batch at the Publisher.
DECLARE @publication AS sysname;
DECLARE @subscriptionDB AS sysname;
DECLARE @subscriber AS sysname;
SET @publication = N'AdvWorksProductTran'; 
SET @subscriptionDB = N'AdventureWorks2008R2Replica'; 
SET @subscriber = $(SubServer);

-- At the Publisher, register the subscription, using the defaults.
USE [AdventureWorks2008R2]
EXEC sp_addsubscription 
    @publication = @publication, 
    @subscriber = @subscriber, 
    @destination_db = @subscriptionDB, 
    @subscription_type = N'pull', 
    @update_mode = N'failover';
GO
```

## <a name="set-queued-updating-conflict-resolution-options-sql-server-management-studio"></a><span data-ttu-id="040dc-274">настроить параметры разрешения конфликтов обновления посредством очередей (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="040dc-274">Set Queued Updating Conflict Resolution Options (SQL Server Management Studio)</span></span>
  <span data-ttu-id="040dc-275">Установить параметры разрешения конфликтов для публикаций, которые поддерживают подписки, обновляемые посредством очередей, можно на странице **Параметры подписки** диалогового окна **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="040dc-275">Set conflict resolution options for publications that support queued updating subscriptions on the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="040dc-276">Дополнительные сведения о доступе к этому диалоговому окну см. в разделе [Просмотр и изменение свойств публикации](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="040dc-276">For more information about accessing this dialog box, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
### <a name="to-set-queued-updating-conflict-resolution-options"></a><span data-ttu-id="040dc-277">Установка параметров разрешения конфликтов обновления посредством очередей</span><span class="sxs-lookup"><span data-stu-id="040dc-277">To set queued updating conflict resolution options</span></span>  
  
1.  <span data-ttu-id="040dc-278">На странице **Параметры подписки** диалогового окна **Свойства публикации — \<Publication>** выберите одно из следующих значений для параметра **Политика разрешения конфликтов**:</span><span class="sxs-lookup"><span data-stu-id="040dc-278">On the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box, select one of the following values for the **Conflict resolution policy** option:</span></span>    
    -   <span data-ttu-id="040dc-279">**Сохранить изменение издателя**</span><span class="sxs-lookup"><span data-stu-id="040dc-279">**Keep the Publisher change**</span></span>    
    -   <span data-ttu-id="040dc-280">**Сохранить изменение подписчика**</span><span class="sxs-lookup"><span data-stu-id="040dc-280">**Keep the Subscriber change**</span></span>    
    -   <span data-ttu-id="040dc-281">**Повторно инициализировать подписку**</span><span class="sxs-lookup"><span data-stu-id="040dc-281">**Reinitialize the subscription**</span></span>    
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  

## <a name="see-also"></a><span data-ttu-id="040dc-282">См. также:</span><span class="sxs-lookup"><span data-stu-id="040dc-282">See Also</span></span> ##
 <span data-ttu-id="040dc-283">[Create a Publication](create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="040dc-283">[Create a Publication](create-a-publication.md) </span></span>  
 <span data-ttu-id="040dc-284">[Updatable Subscriptions for Transactional Replication](../transactional/updatable-subscriptions-for-transactional-replication.md) </span><span class="sxs-lookup"><span data-stu-id="040dc-284">[Updatable Subscriptions for Transactional Replication](../transactional/updatable-subscriptions-for-transactional-replication.md) </span></span>  
 [<span data-ttu-id="040dc-285">Использование программы sqlcmd с переменными скрипта</span><span class="sxs-lookup"><span data-stu-id="040dc-285">Use sqlcmd with Scripting Variables</span></span>](../../scripting/sqlcmd-use-with-scripting-variables.md)   

  
