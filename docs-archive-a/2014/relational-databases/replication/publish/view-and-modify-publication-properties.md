---
title: Просмотр и изменение свойств публикации | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- viewing replication properties
- modifying replication properties, articles
- articles [SQL Server replication], modifying
- publications [SQL Server replication], properties
- articles [SQL Server replication], properties
- modifying replication properties, publications
- publications [SQL Server replication], modifying
ms.assetid: 27d72ea4-bcb6-48f2-b4aa-eb1410da7efc
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 89b969bc3e285bbdc633a2b39d237968b216069a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655047"
---
# <a name="view-and-modify-publication-properties"></a><span data-ttu-id="87d36-102">Просмотр и изменение свойств публикации</span><span class="sxs-lookup"><span data-stu-id="87d36-102">View and Modify Publication Properties</span></span>
  <span data-ttu-id="87d36-103">В данном разделе описывается процесс просмотра и изменения свойств публикации в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] при помощи среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]или объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="87d36-103">This topic describes how to view and modify publication properties in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="87d36-104">**В этом разделе**</span><span class="sxs-lookup"><span data-stu-id="87d36-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="87d36-105">**Перед началом работы**</span><span class="sxs-lookup"><span data-stu-id="87d36-105">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="87d36-106">Ограничения</span><span class="sxs-lookup"><span data-stu-id="87d36-106">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="87d36-107">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="87d36-107">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="87d36-108">**Для просмотра и изменения свойств публикации используется:**</span><span class="sxs-lookup"><span data-stu-id="87d36-108">**To view and modify publication properties, using:**</span></span>  
  
     [<span data-ttu-id="87d36-109">Среда SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="87d36-109">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="87d36-110">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="87d36-110">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="87d36-111">объекты RMO;</span><span class="sxs-lookup"><span data-stu-id="87d36-111">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="87d36-112">Перед началом</span><span class="sxs-lookup"><span data-stu-id="87d36-112">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="87d36-113">Ограничения</span><span class="sxs-lookup"><span data-stu-id="87d36-113">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="87d36-114">Некоторые свойства нельзя изменять после создания публикации, другие нельзя изменять при наличии подписок на публикацию.</span><span class="sxs-lookup"><span data-stu-id="87d36-114">Some properties cannot be modified after a publication has been created, and others cannot be modified if there are subscriptions to the publication.</span></span> <span data-ttu-id="87d36-115">Свойства, которые нельзя изменять, отображаются в режиме только для чтения.</span><span class="sxs-lookup"><span data-stu-id="87d36-115">Properties that cannot be modified are displayed as read-only.</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="87d36-116">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="87d36-116">Recommendations</span></span>  
  
-   <span data-ttu-id="87d36-117">После создания публикации для некоторых изменений свойств требуется новый моментальный снимок.</span><span class="sxs-lookup"><span data-stu-id="87d36-117">After a publication is created, some property changes require a new snapshot.</span></span> <span data-ttu-id="87d36-118">Если на публикацию имеются подписки, для некоторых изменений также требуется повторная инициализация всех подписок.</span><span class="sxs-lookup"><span data-stu-id="87d36-118">If a publication has subscriptions, some changes also require all subscriptions to be reinitialized.</span></span> <span data-ttu-id="87d36-119">Дополнительные сведения см. в статьях [Изменение свойств публикации и статьи](change-publication-and-article-properties.md) и [Добавление и удаление статей в существующих публикациях](add-articles-to-and-drop-articles-from-existing-publications.md).</span><span class="sxs-lookup"><span data-stu-id="87d36-119">For more information, see [Change Publication and Article Properties](change-publication-and-article-properties.md) and [Add Articles to and Drop Articles from Existing Publications](add-articles-to-and-drop-articles-from-existing-publications.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="87d36-120">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="87d36-120">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="87d36-121">Просмотр и изменение свойств публикации осуществляется в диалоговом окне **Свойства публикации — \<Publication>** , которое доступно в среде [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] и в мониторе репликации.</span><span class="sxs-lookup"><span data-stu-id="87d36-121">View and modify publication properties in the **Publication Properties - \<Publication>** dialog box, which is available in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] and Replication Monitor.</span></span> <span data-ttu-id="87d36-122">Сведения о запуске монитора репликации см. в [этой статье](../monitor/start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="87d36-122">For information about starting Replication Monitor, see [Start the Replication Monitor](../monitor/start-the-replication-monitor.md).</span></span>  
  
 <span data-ttu-id="87d36-123">Диалоговое окно **Свойства публикации — \<Publication>** содержит следующие страницы:</span><span class="sxs-lookup"><span data-stu-id="87d36-123">The **Publication Properties - \<Publication>** dialog box includes the following pages:</span></span>  
  
-   <span data-ttu-id="87d36-124">Страница **Общие** включает имя и описание публикации, имя базы данных, тип публикации и настройки срока окончания действия подписки.</span><span class="sxs-lookup"><span data-stu-id="87d36-124">The **General** page includes the publication name and description, the database name, the type of publication, and the subscription expiration settings.</span></span>  
  
-   <span data-ttu-id="87d36-125">Страница **Статьи** соответствует странице **Статьи** мастера создания публикаций.</span><span class="sxs-lookup"><span data-stu-id="87d36-125">The **Articles** page corresponds to the **Articles** page in the New Publication Wizard.</span></span> <span data-ttu-id="87d36-126">Эта страница предназначена для добавления и удаления статей, изменения свойств и фильтрации столбцов для статей.</span><span class="sxs-lookup"><span data-stu-id="87d36-126">Use this page to add and delete articles, and to change properties and column filtering for articles.</span></span>  
  
-   <span data-ttu-id="87d36-127">Страница **Фильтрация строк** соответствует странице **Фильтрация строк таблицы** мастера создания публикаций.</span><span class="sxs-lookup"><span data-stu-id="87d36-127">The **Filter Rows** page corresponds to the **Filter Table Rows** page in the New Publication Wizard.</span></span> <span data-ttu-id="87d36-128">Эта страница предназначена для добавления, изменения и удаления статических фильтров строк для всех типов публикаций, для добавления, изменения и удаления параметризованных фильтров строк и фильтров соединения для публикаций слиянием.</span><span class="sxs-lookup"><span data-stu-id="87d36-128">Use this page to add, edit, and delete static row filters for all types of publications, and to add, edit, and delete parameterized row filters and join filters for merge publications.</span></span>  
  
-   <span data-ttu-id="87d36-129">Страница **Моментальный снимок** позволяет задать формат и местоположение моментального снимка, необходимость его сжатия, а также скрипты для запуска до и после применения моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="87d36-129">The **Snapshot** page allows you to specify the format and location of the snapshot, whether the snapshot should be compressed, and scripts to run before and after the snapshot is applied.</span></span>  
  
-   <span data-ttu-id="87d36-130">Страница **Моментальный снимок FTP** (для публикаций моментальных снимков и транзакций, а также для публикаций слиянием для издателей, использующих версии более ранние, чем SQL Server 2005) позволяет указать возможность загрузки файлов моментальных снимков подписчиками через протокол передачи файлов (FTP).</span><span class="sxs-lookup"><span data-stu-id="87d36-130">The **FTP Snapshot** page (for snapshot and transactional publications, and merge publications for Publishers running versions prior to SQL Server 2005) allows you to specify whether Subscribers can download snapshot files through File Transfer Protocol (FTP).</span></span>  
  
-   <span data-ttu-id="87d36-131">Страница **Моментальный снимок FTP и Интернет** (для публикаций слиянием от издателей, использующих версию SQL Server 2005 или более позднюю) позволяет указать возможность загрузки файлов моментальных снимков подписчиками через протокол FTP и возможность синхронизации подписки подписчиками через протокол HTTPS.</span><span class="sxs-lookup"><span data-stu-id="87d36-131">The **FTP Snapshot and Internet** page (for merge publications from Publishers running SQL Server 2005 or later) allows you to specify whether Subscribers can download snapshot files through FTP, and whether Subscribers can synchronize subscriptions through HTTPS.</span></span>  
  
-   <span data-ttu-id="87d36-132">Страница **Параметры подписки** позволяет устанавливать ряд параметров, которые применяются ко всем подпискам.</span><span class="sxs-lookup"><span data-stu-id="87d36-132">The **Subscription Options** page allows you to set a number of options that apply to all subscriptions.</span></span> <span data-ttu-id="87d36-133">Параметры отличаются в зависимости от типа публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-133">The options differ depending on the type of publication.</span></span>  
  
-   <span data-ttu-id="87d36-134">Страница **Список доступа к публикации** позволяет указать, какие имена входа и группы имеют доступ к публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-134">The **Publication Access List** page allows you to specify which logins and groups can access a publication.</span></span>  
  
-   <span data-ttu-id="87d36-135">Страница **Безопасность агентов** предоставляет доступ к настройкам учетных записей, под которыми запускаются и устанавливают соединения с компьютерами в топологии репликации следующие агенты: агент моментальных снимков для всех публикаций, агент чтения журнала для всех публикаций транзакций и агент чтения очереди для публикаций транзакций, в которых допускаются подписки, обновляемые посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="87d36-135">The **Agent Security** page allows you to access settings for the accounts under which the following agents run and make connections to the computers in a replication topology: the Snapshot Agent for all publications; the Log Reader Agent for all transactional publications; and the Queue Reader Agent for transactional publications that allow queued updating subscriptions.</span></span>  
  
-   <span data-ttu-id="87d36-136">Страница **Секции данных** (для публикаций слиянием от издателей, использующих версию SQL Server 2005 или более позднюю) позволяет указать, могут ли подписчики на публикации с параметризованными фильтрами запрашивать моментальный снимок, если он не доступен.</span><span class="sxs-lookup"><span data-stu-id="87d36-136">The **Data Partitions** page (for merge publications from Publishers running SQL Server 2005 or later) allows you to specify whether Subscribers to publications with parameterized filters can request a snapshot if one is not available.</span></span> <span data-ttu-id="87d36-137">Эта страница также позволяет создавать моментальные снимки для одной или нескольких секций либо однократно, либо по расписанию.</span><span class="sxs-lookup"><span data-stu-id="87d36-137">It also allows you to generate snapshots for one or more partitions, either once or on a recurring schedule.</span></span>  
  
#### <a name="to-view-and-modify-publication-properties-in-management-studio"></a><span data-ttu-id="87d36-138">Просмотр и изменение свойств публикации в среде Management Studio</span><span class="sxs-lookup"><span data-stu-id="87d36-138">To view and modify publication properties in Management Studio</span></span>  
  
1.  <span data-ttu-id="87d36-139">Подключитесь к издателю в среде [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], а затем раскройте узел сервера.</span><span class="sxs-lookup"><span data-stu-id="87d36-139">Connect to the Publisher in [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="87d36-140">Раскройте папку **Репликация** , а затем папку **Локальные публикации** .</span><span class="sxs-lookup"><span data-stu-id="87d36-140">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="87d36-141">Щелкните правой кнопкой мыши публикацию и выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="87d36-141">Right-click a publication, and then click **Properties**.</span></span>  
  
4.  <span data-ttu-id="87d36-142">Измените свойства, если необходимо, и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="87d36-142">Modify any properties if necessary, and then click **OK**.</span></span>  
  
#### <a name="to-view-and-modify-publication-properties-in-replication-monitor"></a><span data-ttu-id="87d36-143">Просмотр и изменение свойств публикации в мониторе репликации</span><span class="sxs-lookup"><span data-stu-id="87d36-143">To view and modify publication properties in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="87d36-144">Раскройте группу издателей в левой панели монитора репликации, а затем раскройте издатель.</span><span class="sxs-lookup"><span data-stu-id="87d36-144">Expand a Publisher group in the left pane of Replication Monitor, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="87d36-145">Щелкните правой кнопкой мыши публикацию и выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="87d36-145">Right-click a publication, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="87d36-146">Измените свойства, если необходимо, и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="87d36-146">Modify any properties if necessary, and then click **OK**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="87d36-147">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="87d36-147">Using Transact-SQL</span></span>  
 <span data-ttu-id="87d36-148">Публикации могут быть изменены, а их свойства могут быть возвращены программно с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="87d36-148">Publications can be modified and their properties returned programmatically using replication stored procedures.</span></span> <span data-ttu-id="87d36-149">Используемые хранимые процедуры зависят от типа публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-149">The stored procedures that you use will depend on the type of publication.</span></span>  
  
#### <a name="to-view-the-properties-of-a-snapshot-or-transactional-publication"></a><span data-ttu-id="87d36-150">Просмотр свойств публикации моментальных снимков или публикации транзакций</span><span class="sxs-lookup"><span data-stu-id="87d36-150">To view the properties of a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="87d36-151">Выполните хранимую процедуру [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql), указав имя публикации в параметре **\@publication**.</span><span class="sxs-lookup"><span data-stu-id="87d36-151">Execute [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql), specifying the name of the publication for the **\@publication** parameter.</span></span> <span data-ttu-id="87d36-152">Если не указать этот параметр, будут возвращены сведения обо всех публикациях на издателе.</span><span class="sxs-lookup"><span data-stu-id="87d36-152">If you do not specify this parameter, information on all publications at the Publisher is returned.</span></span>  
  
#### <a name="to-change-the-properties-of-a-snapshot-or-transactional-publication"></a><span data-ttu-id="87d36-153">Изменение свойств публикации моментальных снимков или публикации транзакций</span><span class="sxs-lookup"><span data-stu-id="87d36-153">To change the properties of a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="87d36-154">Выполните хранимую процедуру [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), указав изменяемое свойство публикации в параметре **\@property**, а новое значение этого свойства — в параметре **\@value**.</span><span class="sxs-lookup"><span data-stu-id="87d36-154">Execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying the publication property to change in the **\@property** parameter and the new value of this property in the **\@value** parameter.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="87d36-155">Если изменение потребует создания нового моментального снимка, нужно также указать значение **1** в параметре **\@force_invalidate_snapshot**, а если изменение потребует повторной инициализации подписчиков — значение **1** в параметре **\@force_reinit_subscription**.</span><span class="sxs-lookup"><span data-stu-id="87d36-155">If the change will require the generation of a new snapshot, you must also specify a value of **1** for **\@force_invalidate_snapshot**, and if the change will require that Subscribers be reinitialized, you must specify a value of **1** for **\@force_reinit_subscription**.</span></span> <span data-ttu-id="87d36-156">Дополнительные сведения о свойствах публикации и статьи, при изменении которых требуется создание нового моментального снимка или повторная инициализация, см. в [этой статье](change-publication-and-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="87d36-156">For more information on the properties that, when changed, require a new snapshot or reinitialization, see [Change Publication and Article Properties](change-publication-and-article-properties.md).</span></span>  
  
#### <a name="to-view-the-properties-of-a-merge-publication"></a><span data-ttu-id="87d36-157">Просмотр свойств публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="87d36-157">To view the properties of a merge publication</span></span>  
  
1.  <span data-ttu-id="87d36-158">Выполните хранимую процедуру [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), указав имя публикации в параметре **\@publication**.</span><span class="sxs-lookup"><span data-stu-id="87d36-158">Execute [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), specifying the name of the publication for the **\@publication** parameter.</span></span> <span data-ttu-id="87d36-159">Если не указать этот параметр, будут возвращены сведения обо всех публикациях на издателе.</span><span class="sxs-lookup"><span data-stu-id="87d36-159">If you do not specify this parameter, information on all publications at the Publisher is returned.</span></span>  
  
#### <a name="to-change-the-properties-of-a-merge-publication"></a><span data-ttu-id="87d36-160">Изменение свойств публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="87d36-160">To change the properties of a merge publication</span></span>  
  
1.  <span data-ttu-id="87d36-161">Выполните хранимую процедуру [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), указав свойство публикации, которое нужно изменить, в параметре **\@property**, а новое значение этого свойства — в параметре **\@value**.</span><span class="sxs-lookup"><span data-stu-id="87d36-161">Execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying the publication property being changed in the **\@property** parameter and the new value of this property in the **\@value** parameter.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="87d36-162">Если изменение потребует создания нового моментального снимка, нужно также указать значение **1** в параметре **\@force_invalidate_snapshot**, а если изменение потребует повторной инициализации подписчиков — значение **1** в параметре **\@force_reinit_subscription**. Дополнительные сведения о свойствах, изменение которых требует нового мгновенного снимка или повторной инициализации, см. в статье [Изменение свойств публикации и статьи](change-publication-and-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="87d36-162">If the change will require the generation of a new snapshot, you must also specify a value of **1** for **\@force_invalidate_snapshot**, and if the change will require that Subscribers be reinitialized, you must specify a value of **1** for **\@force_reinit_subscription** For more information on the properties that, when changed, require a new snapshot or reinitialization, see [Change Publication and Article Properties](change-publication-and-article-properties.md).</span></span>  
  
#### <a name="to-view-the-properties-of-a-snapshot"></a><span data-ttu-id="87d36-163">Просмотр свойств моментального снимка</span><span class="sxs-lookup"><span data-stu-id="87d36-163">To view the properties of a snapshot</span></span>  
  
1.  <span data-ttu-id="87d36-164">Выполните хранимую процедуру [sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql), указав имя публикации в параметре **\@publication**.</span><span class="sxs-lookup"><span data-stu-id="87d36-164">Execute [sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql), specifying the name of the publication for the **\@publication** parameter.</span></span>  
  
#### <a name="to-change-the-properties-of-a-snapshot"></a><span data-ttu-id="87d36-165">Изменение свойств моментального снимка</span><span class="sxs-lookup"><span data-stu-id="87d36-165">To change the properties of a snapshot</span></span>  
  
1.  <span data-ttu-id="87d36-166">Выполните хранимую процедуру [sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql), указав одно или несколько новых свойств моментальных снимков в соответствующих параметрах моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="87d36-166">Execute [sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql), specifying one or more of the new snapshot properties for the appropriate snapshot parameters.</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="87d36-167">Примеры (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="87d36-167">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="87d36-168">В этом примере репликации транзакций возвращаются свойства публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-168">This transactional replication example returns the properties of the publication.</span></span>  
  
 [!code-sql[HowTo#sp_helppublication](../../../snippets/tsql/SQL15/replication/howto/tsql/changetranpub.sql#sp_helppublication)]  
  
 <span data-ttu-id="87d36-169">В этом примере репликации транзакций отключается репликация схемы для публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-169">This transactional replication example disables schema replication for the publication.</span></span>  
  
 [!code-sql[HowTo#sp_changepublication](../../../snippets/tsql/SQL15/replication/howto/tsql/changetranpub.sql#sp_changepublication)]  
  
 <span data-ttu-id="87d36-170">В этом примере репликации слиянием возвращаются свойства публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-170">This merge replication example returns the properties of the publication.</span></span>  
  
 [!code-sql[HowTo#sp_helpmergepublication](../../../snippets/tsql/SQL15/replication/howto/tsql/changemergepub.sql#sp_helpmergepublication)]  
  
 <span data-ttu-id="87d36-171">В этом примере репликации слиянием отключается репликация схемы для публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-171">This merge replication example disables schema replication for the publication.</span></span>  
  
 [!code-sql[HowTo#sp_changemergepublication](../../../snippets/tsql/SQL15/replication/howto/tsql/changemergepub.sql#sp_changemergepublication)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="87d36-172">При помощи объектов RMO</span><span class="sxs-lookup"><span data-stu-id="87d36-172">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="87d36-173">Публикации можно изменять и получать доступ к их свойствам программно с помощью объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="87d36-173">You can modify publications and access their properties programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="87d36-174">Классы RMO, которые используются для просмотра или изменения публикации, зависят от типа публикации.</span><span class="sxs-lookup"><span data-stu-id="87d36-174">The RMO classes that you use to view or modify publication properties depend on the type of publication.</span></span>  
  
#### <a name="to-view-or-modify-properties-of-a-snapshot-or-transactional-publication"></a><span data-ttu-id="87d36-175">Просмотр или изменение свойств публикации моментальных снимков или публикации транзакций</span><span class="sxs-lookup"><span data-stu-id="87d36-175">To view or modify properties of a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="87d36-176">Создайте соединение с издателем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="87d36-176">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="87d36-177">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.TransPublication> , установите для публикации свойства <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> и <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> , а также установите созданное на шаге 1 соединение в качестве значения свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> .</span><span class="sxs-lookup"><span data-stu-id="87d36-177">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class, set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="87d36-178">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="87d36-178">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="87d36-179">Если этот метод возвращает `false`, то либо на шаге 2 были неверно определены свойства публикации, либо публикация не существует.</span><span class="sxs-lookup"><span data-stu-id="87d36-179">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="87d36-180">Чтобы изменить свойства, задайте новые значения для устанавливаемых свойств (необязательно).</span><span class="sxs-lookup"><span data-stu-id="87d36-180">(Optional) To change properties, set a new value for one or more of the settable properties.</span></span> <span data-ttu-id="87d36-181">Чтобы определить, присвоено ли данное значение <xref:Microsoft.SqlServer.Replication.PublicationAttributes> свойству <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>, используется логический оператор AND (`&` в Microsoft Visual C# и `And` в Microsoft Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="87d36-181">Use the logical AND operator (`&` in Microsoft Visual C# and `And` in Microsoft Visual Basic) to determine if a given <xref:Microsoft.SqlServer.Replication.PublicationAttributes> value is set for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span> <span data-ttu-id="87d36-182">С помощью операторов включающего логического ИЛИ (`|` в Visual C# и `Or` в Visual Basic) и исключающего логического ИЛИ (`^` в Visual C# и `Xor` в Visual Basic) измените значения <xref:Microsoft.SqlServer.Replication.PublicationAttributes> для свойства <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="87d36-182">Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to change the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
5.  <span data-ttu-id="87d36-183">Если для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> указать значение `true`, то для фиксирования изменений на сервере необходимо вызвать метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> (необязательно).</span><span class="sxs-lookup"><span data-stu-id="87d36-183">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="87d36-184">Если для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> указать значение `false` (по умолчанию), изменения будут отправлены на сервер немедленно.</span><span class="sxs-lookup"><span data-stu-id="87d36-184">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-view-or-modify-properties-of-a-merge-publication"></a><span data-ttu-id="87d36-185">Просмотр или изменение свойств публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="87d36-185">To view or modify properties of a merge publication</span></span>  
  
1.  <span data-ttu-id="87d36-186">Создайте соединение с издателем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="87d36-186">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="87d36-187">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.MergePublication> , установите для публикации свойства <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> и <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> , а также установите созданное на шаге 1 соединение в качестве значения свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> .</span><span class="sxs-lookup"><span data-stu-id="87d36-187">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class, set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="87d36-188">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="87d36-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="87d36-189">Если этот метод возвращает `false`, то либо на шаге 2 были неверно определены свойства публикации, либо публикация не существует.</span><span class="sxs-lookup"><span data-stu-id="87d36-189">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="87d36-190">Чтобы изменить свойства, задайте новые значения для устанавливаемых свойств (необязательно).</span><span class="sxs-lookup"><span data-stu-id="87d36-190">(Optional) To change properties, set a new value for one or more of the settable properties.</span></span> <span data-ttu-id="87d36-191">Чтобы определить, присвоено ли данное значение <xref:Microsoft.SqlServer.Replication.PublicationAttributes> свойству <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>, используется логический оператор AND (`&` в Visual C# и `And` в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="87d36-191">Use the logical AND operator (`&` in Visual C# and `And` in Visual Basic) to determine if a given <xref:Microsoft.SqlServer.Replication.PublicationAttributes> value is set for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span> <span data-ttu-id="87d36-192">С помощью операторов включающего логического ИЛИ (`|` в Visual C# и `Or` в Visual Basic) и исключающего логического ИЛИ (`^` в Visual C# и `Xor` в Visual Basic) измените значения <xref:Microsoft.SqlServer.Replication.PublicationAttributes> для свойства <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="87d36-192">Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to change the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
5.  <span data-ttu-id="87d36-193">Если для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> указать значение `true`, то для фиксирования изменений на сервере необходимо вызвать метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> (необязательно).</span><span class="sxs-lookup"><span data-stu-id="87d36-193">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="87d36-194">Если для свойства <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> указать значение `false` (по умолчанию), изменения будут отправлены на сервер немедленно.</span><span class="sxs-lookup"><span data-stu-id="87d36-194">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="87d36-195">Примеры (объекты RMO)</span><span class="sxs-lookup"><span data-stu-id="87d36-195">Examples (RMO)</span></span>  
 <span data-ttu-id="87d36-196">В этом примере устанавливаются атрибуты публикации для публикации транзакций.</span><span class="sxs-lookup"><span data-stu-id="87d36-196">This example sets publication attributes for a transactional publication.</span></span> <span data-ttu-id="87d36-197">Изменения кэшируются до тех пор, пока явно не отправляются на сервер.</span><span class="sxs-lookup"><span data-stu-id="87d36-197">The changes are cached until explicitly sent to the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeTranPub_cached](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changetranpub_cached)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeTranPub_cached](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changetranpub_cached)]  
  
 <span data-ttu-id="87d36-198">В этом примере отключается DDL-репликация для публикации слиянием.</span><span class="sxs-lookup"><span data-stu-id="87d36-198">This example disables DDL replication for a merge publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeMergePub_ddl](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changemergepub_ddl)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeMergePub_ddl](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changemergepub_ddl)]  
  
## <a name="see-also"></a><span data-ttu-id="87d36-199">См. также:</span><span class="sxs-lookup"><span data-stu-id="87d36-199">See Also</span></span>  
 <span data-ttu-id="87d36-200">[Публикация данных и объектов базы данных](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="87d36-200">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 <span data-ttu-id="87d36-201">[Изменение свойств публикации и статьи](change-publication-and-article-properties.md) </span><span class="sxs-lookup"><span data-stu-id="87d36-201">[Change Publication and Article Properties](change-publication-and-article-properties.md) </span></span>  
 <span data-ttu-id="87d36-202">[Внесение изменений в схемы баз данных публикации](make-schema-changes-on-publication-databases.md) </span><span class="sxs-lookup"><span data-stu-id="87d36-202">[Make Schema Changes on Publication Databases](make-schema-changes-on-publication-databases.md) </span></span>  
 <span data-ttu-id="87d36-203">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="87d36-203">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 <span data-ttu-id="87d36-204">[Добавление и удаление статей в публикации](add-articles-to-and-drop-articles-from-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="87d36-204">[Add Articles to and Drop Articles from a Publication](add-articles-to-and-drop-articles-from-a-publication.md) </span></span>  
 <span data-ttu-id="87d36-205">[Просмотр сведений и выполнение задач с помощью монитора репликации](../monitor/view-information-and-perform-tasks-replication-monitor.md) </span><span class="sxs-lookup"><span data-stu-id="87d36-205">[View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md) </span></span>  
 [<span data-ttu-id="87d36-206">View and Modify Article Properties (Просмотр и изменение свойств статьи)</span><span class="sxs-lookup"><span data-stu-id="87d36-206">View and Modify Article Properties</span></span>](view-and-modify-article-properties.md)  
  
  
