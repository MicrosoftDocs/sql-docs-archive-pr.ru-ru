---
title: Задание метода распространения изменений данных в транзакционные статьи | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- transactional replication, propagation methods
- propagating data changes [SQL Server replication]
ms.assetid: 0a291582-f034-42da-a1a3-29535b607b74
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: a3f8be8b6df1034b06d0aaff6ee61c0c494833c5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87733874"
---
# <a name="set-the-propagation-method-for-data-changes-to-transactional-articles"></a><span data-ttu-id="52072-102">Задание метода распространения изменений данных в транзакционные статьи</span><span class="sxs-lookup"><span data-stu-id="52072-102">Set the Propagation Method for Data Changes to Transactional Articles</span></span>
  <span data-ttu-id="52072-103">В этом разделе описывается задание метода распространения изменений данных в транзакционных статьях в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="52072-103">This topic describes how to set the propagation method for data changes to transactional articles in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>  
  
 <span data-ttu-id="52072-104">По умолчанию репликация транзакций передает изменения подписчикам при помощи набора хранимых процедур для каждой статьи.</span><span class="sxs-lookup"><span data-stu-id="52072-104">By default, transactional replication propagates changes to Subscribers using a set of stored procedures for each article.</span></span> <span data-ttu-id="52072-105">Эти процедуры можно заменить на пользовательские процедуры.</span><span class="sxs-lookup"><span data-stu-id="52072-105">You can replace these procedures with custom procedures.</span></span> <span data-ttu-id="52072-106">Дополнительные сведения см. в статье [Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span><span class="sxs-lookup"><span data-stu-id="52072-106">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
 <span data-ttu-id="52072-107">**В этом разделе**</span><span class="sxs-lookup"><span data-stu-id="52072-107">**In This Topic**</span></span>  
  
-   <span data-ttu-id="52072-108">**Перед началом работы**</span><span class="sxs-lookup"><span data-stu-id="52072-108">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="52072-109">Ограничения</span><span class="sxs-lookup"><span data-stu-id="52072-109">Limitations and Restrictions</span></span>](#Restrictions)  
  
-   <span data-ttu-id="52072-110">**Для задания метода распространения изменений данных в транзакционных статьях используется:**</span><span class="sxs-lookup"><span data-stu-id="52072-110">**To set the propagation method for data changes to transactional articles, using:**</span></span>  
  
     [<span data-ttu-id="52072-111">Среда SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="52072-111">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="52072-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="52072-112">Transact-SQL</span></span>](#TsqlProcedure)  
  
## <a name="before-you-begin"></a><span data-ttu-id="52072-113">Перед началом</span><span class="sxs-lookup"><span data-stu-id="52072-113">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="52072-114">Ограничения</span><span class="sxs-lookup"><span data-stu-id="52072-114">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="52072-115">Необходимо соблюдать осторожность при изменении любого файла моментального снимка, созданного репликацией.</span><span class="sxs-lookup"><span data-stu-id="52072-115">Care must be taken when editing any of the snapshot files generated by replication.</span></span> <span data-ttu-id="52072-116">Необходимо тестировать и поддерживать пользовательскую логику в пользовательских хранимых процедурах.</span><span class="sxs-lookup"><span data-stu-id="52072-116">You must test and support custom logic in the custom stored procedures.</span></span> [!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="52072-117">не поддерживает настраиваемую логику.</span><span class="sxs-lookup"><span data-stu-id="52072-117">does not provide support for custom logic.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="52072-118">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="52072-118">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="52072-119">Укажите метод распространения на вкладке **Свойства** диалогового окна **Свойства статьи — \<Article>** , которое доступно в мастере создания публикаций и диалоговом окне **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="52072-119">Specify the propagation method on the **Properties** tab of the **Article Properties - \<Article>** dialog box, which is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="52072-120">Дополнительные сведения об использовании мастера и доступе к этому диалоговому окну см. в статьях [Создание публикации](create-a-publication.md) и [Просмотр и изменение свойств публикации](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="52072-120">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-specify-the-propagation-method"></a><span data-ttu-id="52072-121">Указание метода распространения</span><span class="sxs-lookup"><span data-stu-id="52072-121">To specify the propagation method</span></span>  
  
1.  <span data-ttu-id="52072-122">На странице **Статьи** мастера создания публикаций или в диалоговом окне **Свойства публикации — \<Publication>** выберите таблицу и щелкните **Свойства статьи**.</span><span class="sxs-lookup"><span data-stu-id="52072-122">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table, and then click **Article Properties**.</span></span>  
  
2.  <span data-ttu-id="52072-123">Щелкните **Указать свойства выделенной статьи таблицы**.</span><span class="sxs-lookup"><span data-stu-id="52072-123">Click **Set Properties of Highlighted Table Article**.</span></span>  
  
3.  <span data-ttu-id="52072-124">На вкладке **Свойства** диалогового окна **Свойства статьи — \<Article>** в разделе **Доставка инструкций** укажите метод распространения каждой операции с помощью меню **Формат доставки инструкций INSERT**, **Формат доставки инструкций UPDATE** и **Формат доставки инструкций DELETE**.</span><span class="sxs-lookup"><span data-stu-id="52072-124">On the **Properties** tab of the **Article Properties - \<Article>** dialog box, in the **Statement Delivery** section, specify the propagation method for each operation using the **INSERT delivery format**, **UPDATE delivery format**, and **DELETE delivery format** menus.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
5.  <span data-ttu-id="52072-125">Если вы находитесь в диалоговом окне **Свойства публикации — \<Publication>** , нажмите кнопку **OK**, чтобы сохранить результаты и закрыть диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="52072-125">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
#### <a name="to-generate-and-use-custom-stored-procedures"></a><span data-ttu-id="52072-126">Создание и использование пользовательских хранимых процедур</span><span class="sxs-lookup"><span data-stu-id="52072-126">To generate and use custom stored procedures</span></span>  
  
1.  <span data-ttu-id="52072-127">На странице **Статьи** мастера создания публикаций или в диалоговом окне **Свойства публикации — \<Publication>** выберите таблицу и щелкните **Свойства статьи**.</span><span class="sxs-lookup"><span data-stu-id="52072-127">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table, and then click **Article Properties**.</span></span>  
  
2.  <span data-ttu-id="52072-128">Щелкните **Указать свойства выделенной статьи таблицы**.</span><span class="sxs-lookup"><span data-stu-id="52072-128">Click **Set Properties of Highlighted Table Article**.</span></span>  
  
     <span data-ttu-id="52072-129">На вкладке **Свойства** диалогового окна **Свойства статьи — \<Article>** в разделе **Доставка инструкций** выберите синтаксис инструкции CALL из соответствующего меню формата доставки (**Формат доставки инструкций INSERT**, **Формат доставки инструкций UPDATE** или **Формат доставки инструкций DELETE**), а затем введите имя процедуры, чтобы использовать его в параметре **Хранимая процедура INSERT**, **Хранимая процедура DELETE** или **Хранимая процедура UPDATE**.</span><span class="sxs-lookup"><span data-stu-id="52072-129">On the **Properties** tab of the **Article Properties - \<Article>** dialog box, in the **Statement Delivery** section, select the CALL syntax from the appropriate delivery format menu (**INSERT delivery format**, **UPDATE delivery format**, or **DELETE delivery format**), and then type the name of the procedure to use in **INSERT stored procedure**, **DELETE stored procedure**, or **UPDATE stored procedure**.</span></span> <span data-ttu-id="52072-130">Дополнительные сведения о синтаксисе инструкции CALL см. в разделе "Синтаксис вызова для хранимых процедур" статьи [Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span><span class="sxs-lookup"><span data-stu-id="52072-130">For more information about CALL syntax, see the section "Call syntax for stored procedures" in [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
4.  <span data-ttu-id="52072-131">Если вы находитесь в диалоговом окне **Свойства публикации — \<Publication>** , нажмите кнопку **OK**, чтобы сохранить результаты и закрыть диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="52072-131">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
5.  <span data-ttu-id="52072-132">Моментальный снимок, созданный для публикации, включает процедуру, заданную вами на предыдущем шаге.</span><span class="sxs-lookup"><span data-stu-id="52072-132">When the snapshot for the publication is generated, it will include the procedure you specified in the previous step.</span></span> <span data-ttu-id="52072-133">Процедуры будут использовать заданный вами синтаксис инструкции CALL, но при этом будут включать логику по умолчанию, используемую репликацией.</span><span class="sxs-lookup"><span data-stu-id="52072-133">The procedures will use the CALL syntax you specified, but will include the default logic that replication uses.</span></span>  
  
     <span data-ttu-id="52072-134">После создания моментального снимка перейдите в папку моментальных снимков, относящуюся к публикации, которой принадлежит данная статья, затем найдите файл с расширением **.sch** и с таким же именем, что и статья.</span><span class="sxs-lookup"><span data-stu-id="52072-134">After the snapshot has been generated, navigate to the snapshot folder for the publication to which this article belongs and locate the **.sch** file with the same name as the article.</span></span> <span data-ttu-id="52072-135">Откройте этот файл при помощи программы «Блокнот» или другого текстового редактора, найдите команду CREATE PROCEDURE для вставки, обновления или удаления хранимых процедур и измените определение процедуры, чтобы указать пользовательскую логику для распространения изменений данных.</span><span class="sxs-lookup"><span data-stu-id="52072-135">Open this file using Notepad or another text editor, locate the CREATE PROCEDURE command for the insert, update, or delete stored procedures, and edit the procedure definition to supply any custom logic for propagating data changes.</span></span> <span data-ttu-id="52072-136">Если моментальный снимок восстановлен, создайте заново пользовательскую процедуру.</span><span class="sxs-lookup"><span data-stu-id="52072-136">If the snapshot is regenerated, you must re-create the custom procedure.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="52072-137">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="52072-137">Using Transact-SQL</span></span>  
 <span data-ttu-id="52072-138">Репликация транзакций позволяет управлять процессом распространения изменений от издателя к подписчику. Метод распространения может быть задан программным путем при создании и последующем изменении статей с помощью хранимых процедур репликации.</span><span class="sxs-lookup"><span data-stu-id="52072-138">Transactional replication enables you to control how changes are propagated from the Publisher to Subscribers, and this propagation method can be set programmatically when an article is created and changed later using replication stored procedures.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="52072-139">Разным операциям DML (вставка, обновление или удаление), выполняемым над строками опубликованных данных, могут быть назначены различные методы распространения.</span><span class="sxs-lookup"><span data-stu-id="52072-139">You can specify a different propagation method for each type of DML (data manipulation language) operation (insert, update, or delete) that occurs on a row of a published data.</span></span>  
  
 <span data-ttu-id="52072-140">Дополнительные сведения см. в статье [Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span><span class="sxs-lookup"><span data-stu-id="52072-140">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
#### <a name="to-create-an-article-that-uses-transact-sql-commands-to-propagate-data-changes"></a><span data-ttu-id="52072-141">Создание статьи, использующей команды Transact-SQL для распространения изменений данных</span><span class="sxs-lookup"><span data-stu-id="52072-141">To create an article that uses Transact-SQL commands to propagate data changes</span></span>  
  
1.  <span data-ttu-id="52072-142">Выполните процедуру [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)на издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="52072-142">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="52072-143">В параметре **\@publication** задайте имя публикации, которой принадлежит статья, в параметре **\@article** — имя статьи, в параметре **\@source_object** — базу данных, на которой опубликован объект, а для одного из следующих параметров задайте значение **SQL**.</span><span class="sxs-lookup"><span data-stu-id="52072-143">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, and a value of **SQL** for at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="52072-144">**\@ins_cmd** — управляет репликацией команд [INSERT](/sql/t-sql/statements/insert-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="52072-144">**\@ins_cmd** - controls the replication of [INSERT](/sql/t-sql/statements/insert-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="52072-145">**\@upd_cmd** — управляет репликацией команд [UPDATE](/sql/t-sql/queries/update-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="52072-145">**\@upd_cmd** - controls the replication of [UPDATE](/sql/t-sql/queries/update-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="52072-146">**\@del_cmd** — управляет репликацией команд [DELETE](/sql/t-sql/statements/delete-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="52072-146">**\@del_cmd** - controls the replication of [DELETE](/sql/t-sql/statements/delete-transact-sql) commands.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="52072-147">При указании значения **SQL** для одного из перечисленных выше параметров репликация этого типа на подписчик будет производиться соответствующими командами [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="52072-147">When specifying a value of **SQL** for any of the above parameters, commands of that type will be replicated to the Subscriber as the appropriate [!INCLUDE[tsql](../../../includes/tsql-md.md)] command.</span></span>  
  
     <span data-ttu-id="52072-148">Дополнительные сведения см. в статье [определить статью](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="52072-148">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
#### <a name="to-create-an-article-that-does-not-propagate-data-changes"></a><span data-ttu-id="52072-149">Создание статьи, не распространяющей изменения данных</span><span class="sxs-lookup"><span data-stu-id="52072-149">To create an article that does not propagate data changes</span></span>  
  
1.  <span data-ttu-id="52072-150">Выполните процедуру [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)на издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="52072-150">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="52072-151">В параметре **\@publication** укажите имя публикации, которой принадлежит статья, в параметре **\@article** — имя статьи, в параметре **\@source_object** — базу данных, на которой опубликован объект, а для одного из следующих параметров задайте значение **NONE**.</span><span class="sxs-lookup"><span data-stu-id="52072-151">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, and a value of **NONE** for at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="52072-152">**\@ins_cmd** — управляет репликацией команд [INSERT](/sql/t-sql/statements/insert-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="52072-152">**\@ins_cmd** - controls the replication of [INSERT](/sql/t-sql/statements/insert-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="52072-153">**\@upd_cmd** — управляет репликацией команд [UPDATE](/sql/t-sql/queries/update-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="52072-153">**\@upd_cmd** - controls the replication of [UPDATE](/sql/t-sql/queries/update-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="52072-154">**\@del_cmd** — управляет репликацией команд [DELETE](/sql/t-sql/statements/delete-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="52072-154">**\@del_cmd** - controls the replication of [DELETE](/sql/t-sql/statements/delete-transact-sql) commands.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="52072-155">При указании значения **NONE** для одного из перечисленных выше параметров репликация команд указанного на подписчик производиться не будет.</span><span class="sxs-lookup"><span data-stu-id="52072-155">When specifying a value of **NONE** for any of the above parameters, commands of that type will not be replicated to the Subscriber.</span></span>  
  
     <span data-ttu-id="52072-156">Дополнительные сведения см. в статье [определить статью](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="52072-156">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
#### <a name="to-create-an-article-with-user-modified-custom-stored-procedures"></a><span data-ttu-id="52072-157">Создание статьи с изменяемыми пользовательскими хранимыми процедурами</span><span class="sxs-lookup"><span data-stu-id="52072-157">To create an article with user-modified custom stored procedures</span></span>  
  
1.  <span data-ttu-id="52072-158">Выполните процедуру [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)на издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="52072-158">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="52072-159">В параметре **\@publication** задайте имя публикации, которой принадлежит статья, в параметре **\@article** — имя статьи, в параметре **\@source_object** — базу данных, на которой опубликован объект, а в параметре **\@schema_option** задайте битовую маску, содержащую значение **0x02** (для включения автоматического режима создания пользовательской хранимой процедуры), и хотя бы один из следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="52072-159">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, a value for the **\@schema_option** bitmask that contains the value **0x02** (enables automatic generation of custom stored procedures), and at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="52072-160">\*\* \@ ins_cmd\*\* — укажите значение <strong>Call sp_MSins_*article_name*</strong>, где **_article_name_** — это значение, указанное для \*\* \@ статьи\*\*.</span><span class="sxs-lookup"><span data-stu-id="52072-160">**\@ins_cmd** - specify a value of <strong>CALL sp_MSins_*article_name*</strong>, where **_article_name_** is the value specified for **\@article**.</span></span>  
  
    -   <span data-ttu-id="52072-161">\*\* \@ del_cmd\*\* — укажите значение <strong>Call sp_MSdel_*article_name* </strong> или <strong>XCALL sp_MSdel_*article_name*</strong>, где **_article_name_** — это значение, заданное для _ \* \@ статьи \* \*.</span><span class="sxs-lookup"><span data-stu-id="52072-161">**\@del_cmd** - specify a value of <strong>CALL sp_MSdel_*article_name*</strong> or <strong>XCALL sp_MSdel_*article_name*</strong>, where **_article_name_** is the value specified for _\*\@article\*\*.</span></span>  
  
    -   <span data-ttu-id="52072-162">\*\* \@ upd_cmd\*\* — укажите значение параметра <strong>*article_name*масштабируемого sp_MSupd_</strong>, <strong>вызовите sp_MSupd_*article_name*</strong>, <strong>XCALL sp_MSupd__article_name *</strong> или <strong>MCALL sp_MSupd_* article_name \*</strong>, где _**article_name**_ — это значение, указанное для \*\* \@ статьи\*\*.</span><span class="sxs-lookup"><span data-stu-id="52072-162">**\@upd_cmd** - specify a value of <strong>SCALL sp_MSupd_*article_name*</strong>, <strong>CALL sp_MSupd_*article_name*</strong>, <strong>XCALL sp_MSupd__article_name*</strong>, or <strong>MCALL sp_MSupd_* article_name\*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="52072-163">Для каждой из приведенных выше команд в качестве параметров можно указать собственное имя хранимых процедур, создаваемых репликацией.</span><span class="sxs-lookup"><span data-stu-id="52072-163">For each of the above command parameters, you can specify your own name for the stored procedures that replication generates.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="52072-164">Подробные сведения о синтаксисе инструкций CALL, SCALL, XCALL и MCALL см. в статье [Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span><span class="sxs-lookup"><span data-stu-id="52072-164">For more information on CALL, SCALL, XCALL, and MCALL syntax, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
     <span data-ttu-id="52072-165">Дополнительные сведения см. в статье [определить статью](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="52072-165">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
2.  <span data-ttu-id="52072-166">После создания моментального снимка перейдите в папку моментальных снимков, относящуюся к публикации, которой принадлежит данная статья, затем найдите файл с расширением **.sch** и с таким же именем, что и статья.</span><span class="sxs-lookup"><span data-stu-id="52072-166">After the snapshot has been generated, navigate to the snapshot folder for the publication to which this article belongs and locate the **.sch** file with the same name as the article.</span></span> <span data-ttu-id="52072-167">Откройте этот файл в блокноте, найдите инструкцию CREATE PROCEDURE для хранимой процедуры вставки, обновления или удаления и измените ее определение, задав пользовательскую логику распространения изменений данных.</span><span class="sxs-lookup"><span data-stu-id="52072-167">Open this file using Notepad.exe, locate the CREATE PROCEDURE command for the insert, update, or delete stored procedures, and edit the procedure definition to supply any custom logic for propagating data changes.</span></span> <span data-ttu-id="52072-168">Дополнительные сведения см. в статье [Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span><span class="sxs-lookup"><span data-stu-id="52072-168">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
#### <a name="to-create-an-article-with-custom-scripting-in-the-custom-stored-procedures-to-propagate-data-changes"></a><span data-ttu-id="52072-169">Создание статьи, использующей пользовательские скрипты в пользовательских хранимых процедурах для распространения изменений данных</span><span class="sxs-lookup"><span data-stu-id="52072-169">To create an article with custom scripting in the custom stored procedures to propagate data changes</span></span>  
  
1.  <span data-ttu-id="52072-170">Выполните процедуру [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)на издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="52072-170">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="52072-171">В параметре **\@publication** задайте имя публикации, которой принадлежит статья, в параметре **\@article** — имя статьи, в параметре **\@source_object** — базу данных, на которой опубликован объект, а в параметре **\@schema_option** задайте битовую маску, содержащую значение **0x02** (для включения автоматического режима создания пользовательской хранимой процедуры), и хотя бы один из следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="52072-171">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, a value for the **\@schema_option** bitmask that contains the value **0x02** (enables automatic generation of custom stored procedures), and at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="52072-172">\*\* \@ ins_cmd\*\* — укажите значение <strong>Call sp_MSins_*article_name*</strong>, где _**article_name**_ — это значение, указанное для \*\* \@ статьи\*\*.</span><span class="sxs-lookup"><span data-stu-id="52072-172">**\@ins_cmd** - specify a value of <strong>CALL sp_MSins_*article_name*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    -   <span data-ttu-id="52072-173">\*\* \@ del_cmd\*\* — укажите значение <strong>Call sp_MSdel_*article_name* </strong> или <strong>XCALL sp_MSdel_*article_name*</strong>, где _**article_name**_ — это значение, указанное для \*\* \@ статьи\*\*.</span><span class="sxs-lookup"><span data-stu-id="52072-173">**\@del_cmd** - specify a value of <strong>CALL sp_MSdel_*article_name*</strong> or <strong>XCALL sp_MSdel_*article_name*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    -   <span data-ttu-id="52072-174">\*\* \@ upd_cmd\*\* — укажите значение параметра <strong>масштабируемое sp_MSupd_*article_name*</strong>, <strong>вызовите sp_MSupd_*article_name*</strong>article_name, <strong>XCALL sp_MSupd_*article_name*</strong>, <strong>MCALL sp_MSupd_*article_name*</strong>, где _**article_name**_ — значение, указанное для \*\* \@ статьи\*\*.</span><span class="sxs-lookup"><span data-stu-id="52072-174">**\@upd_cmd** - specify a value of <strong>SCALL sp_MSupd_*article_name*</strong>, <strong>CALL sp_MSupd_*article_name*</strong>, <strong>XCALL sp_MSupd_*article_name*</strong>, <strong>MCALL sp_MSupd_*article_name*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="52072-175">Для каждой из приведенных выше команд в качестве параметров можно указать собственное имя хранимых процедур, создаваемых репликацией.</span><span class="sxs-lookup"><span data-stu-id="52072-175">For each of the above command parameters, you can specify your own name for the stored procedures that replication generates.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="52072-176">Подробные сведения о синтаксисе инструкций CALL, SCALL, XCALL и MCALL см. в статье [Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span><span class="sxs-lookup"><span data-stu-id="52072-176">For more information on CALL, SCALL, XCALL, and MCALL syntax, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
     <span data-ttu-id="52072-177">Дополнительные сведения см. в статье [определить статью](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="52072-177">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
2.  <span data-ttu-id="52072-178">В базе данных публикации на издателе при помощи инструкции [ALTER PROCEDURE](/sql/t-sql/statements/alter-procedure-transact-sql) измените хранимую процедуру [sp_scriptpublicationcustomprocs](/sql/relational-databases/system-stored-procedures/sp-scriptpublicationcustomprocs-transact-sql) таким образом, чтобы она возвращала скрипт [CREATE PROCEDURE](/sql/t-sql/statements/create-procedure-transact-sql) пользовательских хранимых процедур для вставки, обновления и удаления.</span><span class="sxs-lookup"><span data-stu-id="52072-178">At the Publisher on the publication database, use the [ALTER PROCEDURE](/sql/t-sql/statements/alter-procedure-transact-sql) statement to edit [sp_scriptpublicationcustomprocs](/sql/relational-databases/system-stored-procedures/sp-scriptpublicationcustomprocs-transact-sql) so that it returns a [CREATE PROCEDURE](/sql/t-sql/statements/create-procedure-transact-sql) script for the insert, update, and delete custom stored procedures.</span></span> <span data-ttu-id="52072-179">Дополнительные сведения см. в статье [Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span><span class="sxs-lookup"><span data-stu-id="52072-179">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
#### <a name="to-change-the-method-of-propagating-changes-for-an-existing-article"></a><span data-ttu-id="52072-180">Изменение метода распространения изменений для существующей статьи</span><span class="sxs-lookup"><span data-stu-id="52072-180">To change the method of propagating changes for an existing article</span></span>  
  
1.  <span data-ttu-id="52072-181">Выполните процедуру [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql)на издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="52072-181">At the Publisher on the publication database, execute [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql).</span></span> <span data-ttu-id="52072-182">Задайте значения параметров **\@publication** и **\@article**, укажите значение **ins_cmd**, **upd_cmd** или **del_cmd** в параметре **\@property**, а в параметре **\@value** — необходимый метод распространения.</span><span class="sxs-lookup"><span data-stu-id="52072-182">Specify **\@publication**, **\@article**, a value of **ins_cmd**, **upd_cmd**, or **del_cmd** for **\@property**, and the appropriate propagation method for **\@value**.</span></span>  
  
2.  <span data-ttu-id="52072-183">Повторите шаг 1 для каждого изменяемого метода распространения.</span><span class="sxs-lookup"><span data-stu-id="52072-183">Repeat step 1 for each propagation method to be changed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="52072-184">См. также:</span><span class="sxs-lookup"><span data-stu-id="52072-184">See Also</span></span>  
 <span data-ttu-id="52072-185">[Указание способа распространения изменений для статей транзакций](../transactional/transactional-articles-specify-how-changes-are-propagated.md) </span><span class="sxs-lookup"><span data-stu-id="52072-185">[Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md) </span></span>  
 [<span data-ttu-id="52072-186">Создание публикации</span><span class="sxs-lookup"><span data-stu-id="52072-186">Create a publication</span></span>](create-a-publication.md)  
  
  
