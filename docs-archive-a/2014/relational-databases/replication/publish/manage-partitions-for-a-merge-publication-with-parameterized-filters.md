---
title: Управление секциями для публикации слиянием с параметризованными фильтрами | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- partitions [SQL Server replication]
- merge replication partitions [SQL Server replication], SQL Server Management Studio
- parameterized filters [SQL Server replication], partition management
ms.assetid: fb5566fe-58c5-48f7-8464-814ea78e6221
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 983b02865c0564919259f896bf09d8bdb0cd969f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655048"
---
# <a name="manage-partitions-for-a-merge-publication-with-parameterized-filters"></a><span data-ttu-id="4b801-102">Управление секциями для публикации слиянием с параметризованными фильтрами</span><span class="sxs-lookup"><span data-stu-id="4b801-102">Manage Partitions for a Merge Publication with Parameterized Filters</span></span>
  <span data-ttu-id="4b801-103">В данном разделе описывается управление секциями для публикации слиянием с параметризованными фильтрами в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]или объектов RMO.</span><span class="sxs-lookup"><span data-stu-id="4b801-103">This topic describes how to manage partitions for a merge publication with parameterized filters in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="4b801-104">Параметризованные фильтры строк могут быть использованы для формирования неперекрывающихся секций.</span><span class="sxs-lookup"><span data-stu-id="4b801-104">Parameterized row filters can be used to generate nonoverlapping partitions.</span></span> <span data-ttu-id="4b801-105">Такие секции могут быть ограничены таким образом, чтобы каждая данная секция предоставлялась только одной подписке.</span><span class="sxs-lookup"><span data-stu-id="4b801-105">These partitions can be restricted so that only one subscription receives a given partition.</span></span> <span data-ttu-id="4b801-106">В таком случае, чем больше число подписчиков, тем большее число секций потребуется, а это, в свою очередь, приведет к необходимости создания такого же числа секционированных моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="4b801-106">In these cases, a large number of subscribers will result in a large number of partitions, which in turn requires an equal number of partitioned snapshots.</span></span> <span data-ttu-id="4b801-107">Дополнительные сведения см. в разделе [Параметризованные фильтры строк](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-107">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
 <span data-ttu-id="4b801-108">**В этом разделе**</span><span class="sxs-lookup"><span data-stu-id="4b801-108">**In This Topic**</span></span>  
  
-   <span data-ttu-id="4b801-109">**Перед началом работы**</span><span class="sxs-lookup"><span data-stu-id="4b801-109">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="4b801-110">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="4b801-110">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="4b801-111">**Для управления секциями для публикации слиянием с параметризованными фильтрами используется:**</span><span class="sxs-lookup"><span data-stu-id="4b801-111">**To manage partitions for a merge publication with parameterized filters, using:**</span></span>  
  
     [<span data-ttu-id="4b801-112">Среда SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="4b801-112">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="4b801-113">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="4b801-113">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="4b801-114">объекты RMO;</span><span class="sxs-lookup"><span data-stu-id="4b801-114">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="4b801-115">Перед началом</span><span class="sxs-lookup"><span data-stu-id="4b801-115">Before You Begin</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="4b801-116">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="4b801-116">Recommendations</span></span>  
  
-   <span data-ttu-id="4b801-117">Если в соответствии с рекомендациями создается скрипт топологии репликации, скрипты публикации содержат вызовы хранимых процедур для создания секций данных.</span><span class="sxs-lookup"><span data-stu-id="4b801-117">If you script a replication topology, which is recommended, publication scripts contain the stored procedure calls to create data partitions.</span></span> <span data-ttu-id="4b801-118">Скрипт содержит справочную информацию для созданных секций и способ воссоздания одной или нескольких секций в случае необходимости.</span><span class="sxs-lookup"><span data-stu-id="4b801-118">The script provides a reference for the partitions created and a way in which to re-create one or more partitions if necessary.</span></span> <span data-ttu-id="4b801-119">Дополнительные сведения см. в разделе [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-119">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
-   <span data-ttu-id="4b801-120">Если публикация имеет параметризованные фильтры, позволяющие получать подписки с неперекрывающимися секциями, то при необходимости повторного создания подписки в случае ее утраты необходимо удалить секцию, которая была на нее подписана, создать заново подписку, а затем повторно создать секцию.</span><span class="sxs-lookup"><span data-stu-id="4b801-120">When a publication has parameterized filters that yield subscriptions with nonoverlapping partitions, and if a particular subscription is lost and needs to be re-created, you must do the following: remove the partition that was subscribed to, re-create the subscription, and then re-create the partition.</span></span> <span data-ttu-id="4b801-121">Дополнительные сведения см. в разделе [Параметризованные фильтры строк](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-121">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span> <span data-ttu-id="4b801-122">При формировании скрипта публикации репликация формирует скрипты создания для существующих секций подписчика.</span><span class="sxs-lookup"><span data-stu-id="4b801-122">Replication generates creation scripts for existing Subscriber partitions when a publication creation script is generated.</span></span> <span data-ttu-id="4b801-123">Дополнительные сведения см. в разделе [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-123">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="4b801-124">Использование среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="4b801-124">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="4b801-125">Управление секциями осуществляется на странице **Секции данных** диалогового окна **Свойства публикации — \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="4b801-125">Manage partitions on the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="4b801-126">Дополнительные сведения о доступе к этому диалоговому окну см. в разделе [Просмотр и изменение свойств публикации](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-126">For more information about accessing this dialog box, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span> <span data-ttu-id="4b801-127">На этой странице доступны следующие возможности: создание и удаление секций, разрешение подписчикам выполнять создание и доставку моментального снимка, создание моментальных снимков для одной или нескольких секций, очистка моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="4b801-127">On this page you can: create and delete partitions; allow Subscribers to initiate snapshot generation and delivery; generate snapshots for one or more partitions; and clean up snapshots.</span></span>  
  
#### <a name="to-create-a-partition"></a><span data-ttu-id="4b801-128">Создание секции</span><span class="sxs-lookup"><span data-stu-id="4b801-128">To create a partition</span></span>  
  
1.  <span data-ttu-id="4b801-129">На странице **Секции данных** диалогового окна **Свойства публикации — \<Publication>** нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="4b801-129">On the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box, click **Add**.</span></span>  
  
2.  <span data-ttu-id="4b801-130">В диалоговом окне **Добавить секцию данных** введите значение **HOST_NAME()** и/или значение **SUSER_SNAME()** , связанное с секцией, которую требуется создать.</span><span class="sxs-lookup"><span data-stu-id="4b801-130">In the **Add Data Partition** dialog box, enter a value for the **HOST_NAME()** and/or **SUSER_SNAME()** value associated with the partition you want to create.</span></span>  
  
3.  <span data-ttu-id="4b801-131">При необходимости задайте расписание обновления моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="4b801-131">Optionally specify a schedule for refreshing snapshots:</span></span>  
  
    1.  <span data-ttu-id="4b801-132">Установите флажок **Запланировать запуск агента моментальных снимков для этой секции в следующее время**.</span><span class="sxs-lookup"><span data-stu-id="4b801-132">Select **Schedule the Snapshot Agent for this partition to run at the following time(s)**</span></span>  
  
    2.  <span data-ttu-id="4b801-133">Примите используемое по умолчанию расписание обновления моментальных снимков или щелкните **Изменить** , чтобы указать другое расписание.</span><span class="sxs-lookup"><span data-stu-id="4b801-133">Accept the default schedule for refreshing snapshots, or click **Change** to specify a different schedule.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="4b801-134">Удаление секции</span><span class="sxs-lookup"><span data-stu-id="4b801-134">To delete a partition</span></span>  
  
1.  <span data-ttu-id="4b801-135">На странице **Секции данных** выберите секцию в сетке.</span><span class="sxs-lookup"><span data-stu-id="4b801-135">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="4b801-136">Щелкните **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="4b801-136">Click **Delete**.</span></span>  
  
#### <a name="to-allow-subscribers-to-initiate-snapshot-generation-and-delivery"></a><span data-ttu-id="4b801-137">Разрешение подписчикам запускать создание и доставку моментальных снимков</span><span class="sxs-lookup"><span data-stu-id="4b801-137">To allow Subscribers to initiate snapshot generation and delivery</span></span>  
  
1.  <span data-ttu-id="4b801-138">На странице **Секции данных** выберите **Автоматически определять секцию и, при необходимости, создавать моментальный снимок при попытке синхронизации от нового подписчика**.</span><span class="sxs-lookup"><span data-stu-id="4b801-138">On the **Data Partitions** page, select **Automatically define a partition and generate a snapshot if needed when a new Subscriber tries to synchronize**.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-generate-a-snapshot-for-a-partition"></a><span data-ttu-id="4b801-139">Создание моментального снимка секции</span><span class="sxs-lookup"><span data-stu-id="4b801-139">To generate a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="4b801-140">На странице **Секции данных** выберите секцию в сетке.</span><span class="sxs-lookup"><span data-stu-id="4b801-140">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="4b801-141">Щелкните **Создать выбранные моментальные снимки**.</span><span class="sxs-lookup"><span data-stu-id="4b801-141">Click **Generate the selected snapshots now**.</span></span>  
  
#### <a name="to-clean-up-a-snapshot-for-a-partition"></a><span data-ttu-id="4b801-142">Очистка моментального снимка секции</span><span class="sxs-lookup"><span data-stu-id="4b801-142">To clean up a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="4b801-143">На странице **Секции данных** выберите секцию в сетке.</span><span class="sxs-lookup"><span data-stu-id="4b801-143">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="4b801-144">Щелкните **Очистить существующие моментальные снимки**.</span><span class="sxs-lookup"><span data-stu-id="4b801-144">Click **Clean up the existing snapshots**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="4b801-145">Использование Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="4b801-145">Using Transact-SQL</span></span>  
 <span data-ttu-id="4b801-146">Программный перебор существующих секций с помощью хранимых процедур репликации позволяет повысить управляемость публикаций с параметризованными фильтрами.</span><span class="sxs-lookup"><span data-stu-id="4b801-146">To better manage a publication with parameterized filters, you can programmatically enumerate the existing partitions using replication stored procedures.</span></span> <span data-ttu-id="4b801-147">Кроме того, секции можно создавать и удалять.</span><span class="sxs-lookup"><span data-stu-id="4b801-147">You can also create and delete existing partitions.</span></span> <span data-ttu-id="4b801-148">Для существующей секции доступны следующие сведения.</span><span class="sxs-lookup"><span data-stu-id="4b801-148">The following information on existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="4b801-149">Метод фильтрации секции (при помощи функций [SUSER_SNAME (Transact-SQL)](/sql/t-sql/functions/suser-sname-transact-sql) или [HOST_NAME (Transact-SQL)](/sql/t-sql/functions/host-name-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="4b801-149">How a partition is filtered (using [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql) or [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql)).</span></span>  
  
-   <span data-ttu-id="4b801-150">Имя задания, которым формируется секционированный моментальный снимок.</span><span class="sxs-lookup"><span data-stu-id="4b801-150">The name of the job that generates a partitioned snapshot.</span></span>  
  
-   <span data-ttu-id="4b801-151">Время последнего запуска задания секционированного снимка.</span><span class="sxs-lookup"><span data-stu-id="4b801-151">The last time that a partitioned snapshot job ran.</span></span>  
  
 <span data-ttu-id="4b801-152">Если вторая часть снимка, состоящего из двух частей, может быть сформирована по запросу в момент инициализации новой подписки, то приведенные ниже процедуры позволят выполнить предварительное формирование снимка в подходящее время и управлять его формированием.</span><span class="sxs-lookup"><span data-stu-id="4b801-152">While the second part of the two-part snapshot can be generated on-demand when a new subscription is initialized, the procedures below enable you to control how this snapshot is generated and to pre-generate this snapshot when it is most convenient.</span></span> <span data-ttu-id="4b801-153">Дополнительные сведения см. в статье [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-153">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="4b801-154">Просмотр информации о существующих секциях</span><span class="sxs-lookup"><span data-stu-id="4b801-154">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="4b801-155">На издателе в базе данных публикации выполните хранимую процедуру [sp_helpmergepartition (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4b801-155">At the Publisher on the publication database, execute [sp_helpmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql).</span></span> <span data-ttu-id="4b801-156">Укажите имя публикации для \*\* \@ публикации\*\*.</span><span class="sxs-lookup"><span data-stu-id="4b801-156">Specify the name of the publication for **\@publication**.</span></span> <span data-ttu-id="4b801-157">Используемых Укажите \*\* \@ suser_sname\*\* или \*\* \@ HOST_NAME\*\* , чтобы получить сведения только на основе одного критерия фильтрации.</span><span class="sxs-lookup"><span data-stu-id="4b801-157">(Optional) Specify **\@suser_sname** or **\@host_name** to return only information based on a single filtering criterion.</span></span>  
  
#### <a name="to-define-a-new-partition-and-generate-a-new-partitioned-snapshot"></a><span data-ttu-id="4b801-158">Определение новой секции и формирование нового секционированного снимка</span><span class="sxs-lookup"><span data-stu-id="4b801-158">To define a new partition and generate a new partitioned snapshot</span></span>  
  
1.  <span data-ttu-id="4b801-159">На издателе в базе данных публикации выполните хранимую процедуру [sp_addmergepartition (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4b801-159">At the Publisher on the publication database, execute [sp_addmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql).</span></span> <span data-ttu-id="4b801-160">Укажите имя публикации для \*\* \@ публикации\*\*и параметризованное значение, определяющее секцию для одного из следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="4b801-160">Specify the name of the publication for **\@publication**, and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="4b801-161">\*\* \@ SUSER_SNAME\*\* — когда параметризованный фильтр определяется значением, возвращаемым [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4b801-161">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="4b801-162">\*\* \@ HOST_NAME\*\* — когда параметризованный фильтр определяется значением, возвращаемым [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4b801-162">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
2.  <span data-ttu-id="4b801-163">Создайте и инициализируйте параметризованный снимок для новой секции.</span><span class="sxs-lookup"><span data-stu-id="4b801-163">Create and initialize the parameterized snapshot for this new partition.</span></span> <span data-ttu-id="4b801-164">Дополнительные сведения см. в статье [Создание моментального снимка для публикации слиянием с параметризованными фильтрами](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-164">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="4b801-165">Удаление секции</span><span class="sxs-lookup"><span data-stu-id="4b801-165">To delete a partition</span></span>  
  
1.  <span data-ttu-id="4b801-166">На издателе в базе данных публикации выполните хранимую процедуру [sp_dropmergepartition (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4b801-166">At the Publisher on the publication database, execute [sp_dropmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql).</span></span> <span data-ttu-id="4b801-167">Укажите имя публикации для \*\* \@ публикации\*\* и параметризованное значение, определяющее секцию для одного из следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="4b801-167">Specify the name of the publication for **\@publication** and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="4b801-168">\*\* \@ SUSER_SNAME\*\* — когда параметризованный фильтр определяется значением, возвращаемым [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4b801-168">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="4b801-169">\*\* \@ HOST_NAME\*\* — когда параметризованный фильтр определяется значением, возвращаемым [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4b801-169">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
     <span data-ttu-id="4b801-170">При этом также будет удалено задание моментального снимка и все файлы снимка для этой секции.</span><span class="sxs-lookup"><span data-stu-id="4b801-170">This also removes the snapshot job and any snapshot files for the partition.</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="4b801-171">При помощи объектов RMO</span><span class="sxs-lookup"><span data-stu-id="4b801-171">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="4b801-172">Программное формирование новых, перебор существующих и удаление секций подписчика с помощью объектов RMO обеспечивает большую управляемость публикации с параметризованными фильтрами.</span><span class="sxs-lookup"><span data-stu-id="4b801-172">To better manage a publication with parameterized filters, you can programmatically create new Subscriber partitions, enumerate the existing Subscriber partitions, and delete Subscriber partitions by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="4b801-173">Сведения о создании секций подписчика см. в разделе [Создание моментального снимка для публикации слиянием с параметризованными фильтрами](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="4b801-173">For information about how to create Subscriber partitions, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span> <span data-ttu-id="4b801-174">Для существующей секции доступны следующие сведения.</span><span class="sxs-lookup"><span data-stu-id="4b801-174">The following information about existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="4b801-175">Значение и функция фильтрации, на которых базируется секция.</span><span class="sxs-lookup"><span data-stu-id="4b801-175">The value and filtering function upon which the partition is based.</span></span>  
  
-   <span data-ttu-id="4b801-176">Имя задания, формирующего параметризованный снимок для подписчика.</span><span class="sxs-lookup"><span data-stu-id="4b801-176">The name of the job that generates a parameterized snapshot for the Subscriber.</span></span>  
  
-   <span data-ttu-id="4b801-177">Время последнего выполнения задания параметризованного моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="4b801-177">The last time that a parameterized snapshot job ran.</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="4b801-178">Просмотр информации о существующих секциях</span><span class="sxs-lookup"><span data-stu-id="4b801-178">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="4b801-179">Создайте соединение с издателем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="4b801-179">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="4b801-180">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.MergePublication>.</span><span class="sxs-lookup"><span data-stu-id="4b801-180">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="4b801-181">Задайте для публикации свойства <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> и <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> , а также установите созданное на шаге 1 соединение <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> в качестве значения для свойства <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="4b801-181">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="4b801-182">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="4b801-182">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="4b801-183">Если этот метод возвращает `false`, то либо на шаге 2 были неверно определены свойства публикации, либо публикация не существует.</span><span class="sxs-lookup"><span data-stu-id="4b801-183">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="4b801-184">Вызовите метод <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> и передайте его результат в массив объектов <xref:Microsoft.SqlServer.Replication.MergePartition> .</span><span class="sxs-lookup"><span data-stu-id="4b801-184">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="4b801-185">Для каждого объекта <xref:Microsoft.SqlServer.Replication.MergePartition> в массиве доступны любые интересующие свойства.</span><span class="sxs-lookup"><span data-stu-id="4b801-185">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, get any properties of interest.</span></span>  
  
#### <a name="to-delete-existing-partitions"></a><span data-ttu-id="4b801-186">Удаление существующих секций</span><span class="sxs-lookup"><span data-stu-id="4b801-186">To delete existing partitions</span></span>  
  
1.  <span data-ttu-id="4b801-187">Создайте соединение с издателем с помощью класса <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="4b801-187">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="4b801-188">Создайте экземпляр класса <xref:Microsoft.SqlServer.Replication.MergePublication>.</span><span class="sxs-lookup"><span data-stu-id="4b801-188">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="4b801-189">Задайте для публикации свойства <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> и <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> , а также установите созданное на шаге 1 соединение <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> в качестве значения для свойства <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="4b801-189">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="4b801-190">Чтобы получить свойства объекта, вызовите метод <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="4b801-190">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="4b801-191">Если этот метод возвращает `false`, то либо на шаге 2 были неверно определены свойства публикации, либо публикация не существует.</span><span class="sxs-lookup"><span data-stu-id="4b801-191">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="4b801-192">Вызовите метод <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> и передайте его результат в массив объектов <xref:Microsoft.SqlServer.Replication.MergePartition> .</span><span class="sxs-lookup"><span data-stu-id="4b801-192">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="4b801-193">Определите для каждого объекта <xref:Microsoft.SqlServer.Replication.MergePartition> в массиве, необходимо ли удаление соответствующей секции.</span><span class="sxs-lookup"><span data-stu-id="4b801-193">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, determine whether the partition should be deleted.</span></span> <span data-ttu-id="4b801-194">Решение обычно принимается исходя из значения свойств <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> и <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> .</span><span class="sxs-lookup"><span data-stu-id="4b801-194">This decision is usually based on the value of the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> property or the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> property.</span></span>  
  
6.  <span data-ttu-id="4b801-195">Вызовите метод <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> объекта <xref:Microsoft.SqlServer.Replication.MergePublication> , созданного на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="4b801-195">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> method on the <xref:Microsoft.SqlServer.Replication.MergePublication> object from step 2.</span></span> <span data-ttu-id="4b801-196">Передайте объект <xref:Microsoft.SqlServer.Replication.MergePartition> , созданный на шаге 5.</span><span class="sxs-lookup"><span data-stu-id="4b801-196">Pass the <xref:Microsoft.SqlServer.Replication.MergePartition> object from step 5.</span></span>  
  
7.  <span data-ttu-id="4b801-197">Повторите шаг 6 для каждой удаляемой секции.</span><span class="sxs-lookup"><span data-stu-id="4b801-197">Repeat step 6 for each partition that is deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4b801-198">См. также:</span><span class="sxs-lookup"><span data-stu-id="4b801-198">See Also</span></span>  
 <span data-ttu-id="4b801-199">[Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="4b801-199">[Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md) </span></span>  
 [<span data-ttu-id="4b801-200">Snapshots for Merge Publications with Parameterized Filters</span><span class="sxs-lookup"><span data-stu-id="4b801-200">Snapshots for Merge Publications with Parameterized Filters</span></span>](../snapshots-for-merge-publications-with-parameterized-filters.md)  
  
  
