---
title: Добавление или изменение фильтра | Документация Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
f1_keywords:
- sql12.rep.newpubwizard.addeditfilter.f1
ms.assetid: bdd7c71d-1c59-4044-bfe8-c85f908345bb
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 54dcb1ea0b7bf10f51659a14b9d0cc5eb7991769
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655677"
---
# <a name="add-or-edit-filter"></a><span data-ttu-id="ea6e7-102">Добавление или редактирование фильтров</span><span class="sxs-lookup"><span data-stu-id="ea6e7-102">Add or Edit Filter</span></span>
  <span data-ttu-id="ea6e7-103">Диалоговые окна **Добавить фильтр** и **Редактирование фильтра** позволяют добавлять и изменять статические и параметризованные строковые фильтры.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-103">The **Add Filter** and **Edit Filter** dialog boxes allow you to add and edit static row filters and parameterized row filters.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ea6e7-104">Для редактирования фильтра в существующей публикации необходим новый моментальный снимок для этой публикации.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-104">Editing a filter in an existing publication requires a new snapshot for the publication.</span></span> <span data-ttu-id="ea6e7-105">Если публикация содержит подписки, эти подписки должны быть повторно инициализированы.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-105">If a publication has subscriptions, the subscriptions must be reinitialized.</span></span> <span data-ttu-id="ea6e7-106">Дополнительные сведения об изменении свойств см. в статье [Изменение свойств публикации и статьи](publish/change-publication-and-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="ea6e7-106">For more information about property changes, see [Change Publication and Article Properties](publish/change-publication-and-article-properties.md).</span></span>  
  
 <span data-ttu-id="ea6e7-107">Публикации всех типов могут включать статические фильтры, а публикации слиянием могут также включать и параметризованные фильтры.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-107">All publication types can include static filters; merge publications can also include parameterized filters.</span></span> <span data-ttu-id="ea6e7-108">Оценка статического фильтра выполняется при создании публикации: все подписчики на публикацию получают одни и те же данные.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-108">A static filter is evaluated when the publication is created: all Subscribers to the publication receive the same data.</span></span> <span data-ttu-id="ea6e7-109">Оценка параметризованного фильтра выполняется во время синхронизации репликации: разные подписчики могут получать разные секции данных, зависящие от имени входа или имени компьютера каждого подписчика.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-109">A parameterized filter is evaluated during replication synchronization: different Subscribers can receive different partitions of data based on the login or computer name of each Subscriber.</span></span> <span data-ttu-id="ea6e7-110">Чтобы посмотреть примеры фильтров каждого типа, в диалоговом окне перейдите по ссылке **Примеры инструкций** .</span><span class="sxs-lookup"><span data-stu-id="ea6e7-110">Click the **Example statements** link in the dialog box to see examples of each type of filter.</span></span> <span data-ttu-id="ea6e7-111">Дополнительные сведения о вариантах фильтрации см. в статье [Фильтрация опубликованных данных](publish/filter-published-data.md).</span><span class="sxs-lookup"><span data-stu-id="ea6e7-111">For more information about filtering options, see [Filter Published Data](publish/filter-published-data.md).</span></span>  
  
 <span data-ttu-id="ea6e7-112">При помощи фильтров строк можно указать подмножество строк, которые должны публиковаться из таблицы.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-112">Using row filters, you can specify a subset of rows to be published from a table.</span></span> <span data-ttu-id="ea6e7-113">Фильтры строк могут использоваться для исключения строк, которые пользователям не нужно видеть (например, строки с важной или конфиденциальной информацией), или для создания других секций данных, отправляемых другим подписчикам.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-113">Row filters can be used to eliminate rows that users do not need to see (such as rows that contain sensitive or confidential information), or to create different partitions of data that are sent to different Subscribers.</span></span> <span data-ttu-id="ea6e7-114">Публикация разных секций данных для разных подписчиков помогает избежать конфликтов, которые могли бы возникнуть в ситуации, когда несколько подписчиков обновляют одни и те же данные.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-114">Publishing different partitions of data to different Subscribers can also help avoid conflicts that would otherwise be caused by multiple Subscribers updating the same data.</span></span>  
  
## <a name="options"></a><span data-ttu-id="ea6e7-115">Параметры</span><span class="sxs-lookup"><span data-stu-id="ea6e7-115">Options</span></span>  
 <span data-ttu-id="ea6e7-116">При помощи этого диалогового окна осуществляется двухступенчатый процесс публикаций транзакций и публикаций моментальных снимков, а также трехступенчатый процесс публикаций слиянием.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-116">This dialog box involves a two-step process for transactional and snapshot publications and a three-step process for merge publications.</span></span> <span data-ttu-id="ea6e7-117">Для публикаций всех типов необходимо, чтобы пользователь выбрал таблицу для фильтрации и один или несколько столбцов, включаемых в фильтр; фильтр определяется как обычное предложение WHERE.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-117">All publication types require you to select a table to be filtered and one or more columns to be included in the filter; the filter is defined as a standard WHERE clause.</span></span>  
  
1.  <span data-ttu-id="ea6e7-118">**Выбрать таблицу для фильтрации**</span><span class="sxs-lookup"><span data-stu-id="ea6e7-118">**Select the table to filter**</span></span>  
  
     <span data-ttu-id="ea6e7-119">При редактировании существующего фильтра выбор таблицы не может быть изменен.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-119">If you are editing an existing filter, the table selection cannot be changed.</span></span> <span data-ttu-id="ea6e7-120">При добавлении нового фильтра таблица должна быть выбрана из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-120">If you are adding a new filter, select a table from the drop-down list box.</span></span> <span data-ttu-id="ea6e7-121">Таблицы присутствуют в списке, если только они были выбраны на странице **Статьи** и еще не имеют фильтра строк.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-121">Tables appear in the list box only if they were selected on the **Articles** page and do not already have a row filter.</span></span> <span data-ttu-id="ea6e7-122">Если таблица имеет фильтр строк и необходимо определить новый фильтр, следует выполнить следующее:</span><span class="sxs-lookup"><span data-stu-id="ea6e7-122">If a table has a row filter and you want to define a new one:</span></span>  
  
    1.  <span data-ttu-id="ea6e7-123">Нажмите кнопку **Отмена** в диалоговом окне **Добавить фильтр** .</span><span class="sxs-lookup"><span data-stu-id="ea6e7-123">Click **Cancel** on the **Add Filter** dialog box.</span></span>  
  
    2.  <span data-ttu-id="ea6e7-124">На панели фильтров страницы **Фильтрация строк таблицы** выберите таблицу и щелкните **Правка**.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-124">Select the table in the filter pane on the **Filter Table Rows** page and click **Edit**.</span></span>  
  
    3.  <span data-ttu-id="ea6e7-125">В диалоговом окне **Редактирование фильтра** отредактируйте существующий фильтр.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-125">Edit an existing filter in the **Edit Filter** dialog box.</span></span>  
  
2.  <span data-ttu-id="ea6e7-126">**Завершите инструкцию фильтра, чтобы указать те строки таблицы, которые будут получать подписчики**</span><span class="sxs-lookup"><span data-stu-id="ea6e7-126">**Complete the filter statement to identify which table rows Subscribers will receive**</span></span>  
  
     <span data-ttu-id="ea6e7-127">Определите новую инструкцию фильтра или отредактируйте уже имеющуюся.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-127">Define a new filter statement or edit an existing one.</span></span> <span data-ttu-id="ea6e7-128">Список **Столбцы** содержит все столбцы, публикуемые из выбранной таблицы в поле **Выберите таблицу для фильтрации**.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-128">The **Columns** list box lists all the columns that you are publishing from the table you selected in **Select the table to filter**.</span></span> <span data-ttu-id="ea6e7-129">Текстовая область **Инструкция фильтра** содержит текст по умолчанию, в виде:</span><span class="sxs-lookup"><span data-stu-id="ea6e7-129">The **Filter statement** text area includes the default text, which is in the form of:</span></span>  
  
     `SELECT <published_columns> FROM [schema].[tablename] WHERE`  
  
     <span data-ttu-id="ea6e7-130">Этот текст не может быть изменен; введите предложение фильтра после ключевого слова WHERE, используя обычный синтаксис [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ea6e7-130">This text cannot be changed; type the filter clause after the WHERE keyword using standard [!INCLUDE[tsql](../../includes/tsql-md.md)] syntax.</span></span> <span data-ttu-id="ea6e7-131">Если издатель является издателем Oracle, предложение WHERE должно соответствовать синтаксису запроса Oracle.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-131">If the Publisher is an Oracle Publisher, the WHERE clause must be compliant with Oracle query syntax.</span></span> <span data-ttu-id="ea6e7-132">По возможности избегайте использования сложных фильтров.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-132">Avoid using complex filters when possible.</span></span> <span data-ttu-id="ea6e7-133">Как статические, так и параметризованные фильтры увеличивают время обработки для публикаций, поэтому инструкции фильтра должны быть как можно более простыми.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-133">Both static and parameterized filters increase processing time for publications; therefore you should keep filter statements as simple as possible.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="ea6e7-134">Из соображений производительности не рекомендуется применять функции к именам столбцов в предложениях параметризованных фильтров строк для публикации слиянием, таких как `LEFT([MyColumn]) = SUSER_SNAME()`.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-134">For performance reasons, we recommended that you not apply functions to column names in parameterized row filter clauses for merge publications, such as `LEFT([MyColumn]) = SUSER_SNAME()`.</span></span> <span data-ttu-id="ea6e7-135">Если в предложении фильтра используется HOST_NAME и переопределяется значение HOST_NAME, может быть, необходимо выполнить преобразование типов данных при помощи инструкции CONVERT.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-135">If you use HOST_NAME in a filter clause and override the HOST_NAME value, it might be necessary to convert data types using CONVERT.</span></span> <span data-ttu-id="ea6e7-136">Дополнительные сведения см. в подразделе «Переопределение значения HOST_NAME()» раздела [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="ea6e7-136">For more information about best practices for this case, see the section "Overriding the HOST_NAME() Value" in the topic [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
3.  <span data-ttu-id="ea6e7-137">**Укажите, сколько подписок будет получать данные из этой таблицы**</span><span class="sxs-lookup"><span data-stu-id="ea6e7-137">**Specify how many subscriptions will receive data from this table**</span></span>  
  
     <span data-ttu-id="ea6e7-138">Только для сервера [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и более поздних версий и только для репликации слиянием.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-138">[!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and later versions only; merge replication only.</span></span> <span data-ttu-id="ea6e7-139">Репликация слиянием позволяет указать тип секций, наилучшим образом подходящих для данных и приложения пользователя.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-139">Merge replication allows you to specify the type of partitions that are best suited to your data and application.</span></span> <span data-ttu-id="ea6e7-140">При выборе значения **Строка из этой таблицы будет отправлена только одной подписке**репликация слиянием устанавливает параметр неперекрывающихся секций.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-140">If you select **A row from this table will go to only one subscription**, merge replication sets the nonoverlapping partitions option.</span></span> <span data-ttu-id="ea6e7-141">Для повышения производительности неперекрывающиеся секции работают в сочетании с предварительно вычисляемыми секциями; при этом неперекрывающиеся секции предельно снижают стоимость передачи, связанную с предварительно вычисляемыми секциями.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-141">Nonoverlapping partitions work in conjunction with precomputed partitions to improve performance, with nonoverlapping partitions minimizing the upload cost associated with precomputed partitions.</span></span> <span data-ttu-id="ea6e7-142">Повышение производительности благодаря применению неперекрывающихся секций наиболее заметно при использовании более сложных параметризованных фильтров и фильтров соединения.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-142">The performance benefit of nonoverlapping partitions is more noticeable when the parameterized filters and join filters used are more complex.</span></span> <span data-ttu-id="ea6e7-143">При выборе этого параметра необходимо убедиться в том, что данные секционированы таким образом, что строка не может реплицироваться на несколько подписчиков.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-143">If you select this option, you must ensure that the data is partitioned in such a way that a row cannot be replicated to more than one Subscriber.</span></span> <span data-ttu-id="ea6e7-144">Дополнительные сведения см. в подразделе «Настройка параметров секционирования» раздела [Параметризованные фильтры строк](merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="ea6e7-144">For more information, see the section "Setting 'partition options'" in the topic [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
 <span data-ttu-id="ea6e7-145">После добавления или редактирования фильтра нажмите кнопку **ОК** для сохранения изменений и закрытия диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-145">After you have added or edited a filter, click **OK** to save changes and close the dialog box.</span></span> <span data-ttu-id="ea6e7-146">Проводится синтаксический анализ указанного фильтра, после чего фильтр применяется к таблице в предложении SELECT.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-146">The filter you specified is parsed and run against the table in the SELECT clause.</span></span> <span data-ttu-id="ea6e7-147">Если инструкция фильтра содержит синтаксические ошибки или встречаются другие проблемы, пользователь получает соответствующее уведомление, в результате чего он может отредактировать инструкцию фильтра.</span><span class="sxs-lookup"><span data-stu-id="ea6e7-147">If the filter statement contains syntax errors or other problems, you are notified and are able to edit the filter statement.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea6e7-148">См. также:</span><span class="sxs-lookup"><span data-stu-id="ea6e7-148">See Also</span></span>  
 <span data-ttu-id="ea6e7-149">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="ea6e7-149">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="ea6e7-150">[Просмотр и изменение свойств публикации](publish/view-and-modify-publication-properties.md) </span><span class="sxs-lookup"><span data-stu-id="ea6e7-150">[View and Modify Publication Properties](publish/view-and-modify-publication-properties.md) </span></span>  
 <span data-ttu-id="ea6e7-151">[Фильтрация опубликованных данных](publish/filter-published-data.md) </span><span class="sxs-lookup"><span data-stu-id="ea6e7-151">[Filter Published Data](publish/filter-published-data.md) </span></span>  
 <span data-ttu-id="ea6e7-152">[Join Filters](merge/join-filters.md) </span><span class="sxs-lookup"><span data-stu-id="ea6e7-152">[Join Filters](merge/join-filters.md) </span></span>  
 <span data-ttu-id="ea6e7-153">[Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="ea6e7-153">[Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md) </span></span>  
 [<span data-ttu-id="ea6e7-154">Публикация данных и объектов базы данных</span><span class="sxs-lookup"><span data-stu-id="ea6e7-154">Publish Data and Database Objects</span></span>](publish/publish-data-and-database-objects.md)  
  
  
