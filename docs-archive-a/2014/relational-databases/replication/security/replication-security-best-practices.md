---
title: Рекомендации по защите репликации | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- security [SQL Server replication], best practices
- security [SQL Server replication], between domains
- authentication [SQL Server replication]
- Internet [SQL Server replication], security
ms.assetid: 1ab2635d-0992-4c99-b17d-041d02ec9a7c
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8e5918bfed52a6ed1befd81d2fdb7910062060e6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87654147"
---
# <a name="replication-security-best-practices"></a><span data-ttu-id="b0ffa-102">Рекомендации по защите репликации</span><span class="sxs-lookup"><span data-stu-id="b0ffa-102">Replication Security Best Practices</span></span>
  <span data-ttu-id="b0ffa-103">Репликация перемещает данные в распределенных средах, начиная с внутренних сетей в рамках одного домена и заканчивая приложениями, обеспечивающими передачу данных между доменами без доверия, а также через Интернет.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-103">Replication moves data in distributed environments ranging from intranets on a single domain to applications that access data between untrusted domains and over the Internet.</span></span> <span data-ttu-id="b0ffa-104">Чтобы обеспечить безопасность соединения при репликации, важно выбрать способ, соответствующий конкретным обстоятельствам.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-104">It is important to understand the best approach for securing replication connections under these different circumstances.</span></span>  
  
 <span data-ttu-id="b0ffa-105">Сведения, указанные ниже, необходимо учитывать при проведении репликации в любых средах:</span><span class="sxs-lookup"><span data-stu-id="b0ffa-105">The following information is relevant to replication in all environments:</span></span>  
  
-   <span data-ttu-id="b0ffa-106">При шифровании соединения между компьютерами, занятыми в топологии репликации, необходимо использовать общепризнанную стандартную технологию, такую как виртуальная частная сеть (VPN), протокол безопасных соединений (SSL) или IP-безопасность (IPSEC).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-106">Encrypt the connections between computers in a replication topology using an industry standard method, such as Virtual Private Networks (VPN), Secure Sockets Layer (SSL), or IP Security (IPSEC).</span></span> <span data-ttu-id="b0ffa-107">Дополнительные сведения см. в разделе [Включение шифрования соединений в компоненте Database Engine (диспетчер конфигураций SQL Server)](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-107">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span> <span data-ttu-id="b0ffa-108">Сведения об использовании VPN и SSL для репликации данных через Интернет см. в разделе [Securing Replication Over the Internet](securing-replication-over-the-internet.md).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-108">For information about using VPN and SSL for replicating data over the Internet, see [Securing Replication Over the Internet](securing-replication-over-the-internet.md).</span></span>  
  
     <span data-ttu-id="b0ffa-109">Если используется протокол SSL для защиты соединений между компьютерами в топологии репликации, задайте значение **1** или **2** для параметра **-EncryptionLevel** каждого агента репликации (рекомендуется значение **2** ).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-109">If you use SSL to secure the connections between computers in a replication topology, specify a value of **1** or **2** for the **-EncryptionLevel** parameter of each replication agent (a value of **2** is recommended).</span></span> <span data-ttu-id="b0ffa-110">Значение **1** указывает, что шифрование будет использоваться, но агент не будет проверять, подписан ли SSL-сертификат сервера доверенным издателем; значение **2** указывает, что будет проверяться подпись сертификата.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-110">A value of **1** specifies that encryption is used, but the agent does not verify that the SSL server certificate is signed by a trusted issuer; a value of **2** specifies that the certificate is verified.</span></span> <span data-ttu-id="b0ffa-111">Параметры агента могут задаваться в профилях агента или в командной строке.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-111">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="b0ffa-112">Дополнительные сведения см. в разделе:</span><span class="sxs-lookup"><span data-stu-id="b0ffa-112">For more information, see:</span></span>  
  
    -   [<span data-ttu-id="b0ffa-113">Работа с профилями агента репликации</span><span class="sxs-lookup"><span data-stu-id="b0ffa-113">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
    -   [<span data-ttu-id="b0ffa-114">Просмотр и изменение параметров командной строки агента репликации (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="b0ffa-114">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
    -   [<span data-ttu-id="b0ffa-115">Replication Agent Executables Concepts</span><span class="sxs-lookup"><span data-stu-id="b0ffa-115">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
-   <span data-ttu-id="b0ffa-116">При запуске каждого агента репликации необходимо использовать новую учетную запись Windows, а в отношении всех соединений агента репликации применять проверку подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-116">Run each replication agent under a different Windows account, and use Windows Authentication for all replication agent connections.</span></span> <span data-ttu-id="b0ffa-117">Дополнительные сведения об указании учетных записей см. в статье [Управление именами для входа и паролями в репликации](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-117">For more information about specifying accounts, see [Manage Logins and Passwords in Replication](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication).</span></span>  
  
-   <span data-ttu-id="b0ffa-118">Предоставляйте каждому из агентов только те разрешения, которые необходимы.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-118">Grant only the required permissions to each agent.</span></span> <span data-ttu-id="b0ffa-119">Дополнительные сведения см. в подразделе «Разрешения, необходимые для агентов» раздела [Replication Agent Security Model](replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-119">For more information, see the "Permissions Required by Agents" section of [Replication Agent Security Model](replication-agent-security-model.md).</span></span>  
  
-   <span data-ttu-id="b0ffa-120">Убедитесь в том, что все учетные записи агента слияния и агента распространителя находятся в списке доступа к публикации (PAL).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-120">Ensure all Merge Agent and Distribution Agent accounts are in the publication access list (PAL).</span></span> <span data-ttu-id="b0ffa-121">Дополнительные сведения см. в статье [Организация безопасности издателя](secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-121">For more information, see [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
-   <span data-ttu-id="b0ffa-122">Учетным записям в списке доступа к публикации необходимо предоставлять только те разрешения, которые им необходимы для выполнения задач репликации.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-122">Follow the principle of least privilege by allowing accounts in the PAL only the permissions they need to perform replication tasks.</span></span> <span data-ttu-id="b0ffa-123">Не добавляйте в предопределенные роли сервера имена входа, которые не требуются для репликации.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-123">Do not add the logins to any fixed server roles that are not required for replication.</span></span>  
  
-   <span data-ttu-id="b0ffa-124">Настройте хранилище моментального снимка таким образом, чтобы оно было доступно для чтения всем агентам слияния и агентам распространителя.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-124">Configure the snapshot share to allow read access by all Merge Agents and Distribution Agents.</span></span> <span data-ttu-id="b0ffa-125">При работе с моментальными снимками для публикаций с параметризованными фильтрами убедитесь в том, что настройки каждой папки разрешают доступ к такой папке только учетным записям соответствующих агентов слияния.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-125">In the case of snapshots for publications with parameterized filters, ensure that each folder is configured to allow access only to the appropriate Merge Agent accounts.</span></span>  
  
-   <span data-ttu-id="b0ffa-126">Настройте хранилище моментального снимка таким образом, чтобы оно было доступно для записи агенту моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-126">Configure the snapshot share to allow write access by the Snapshot Agent.</span></span>  
  
-   <span data-ttu-id="b0ffa-127">В случае подписок по запросу используйте в качестве папки моментальных снимков общий сетевой ресурс, а не локальную папку.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-127">If you use pull subscriptions, use a network share rather than a local path for the snapshot folder.</span></span>  
  
 <span data-ttu-id="b0ffa-128">В том случае, если в топологии репликации участвуют компьютеры, находящиеся в разных доменах или в доменах, между которыми нет доверительных отношений, можно использовать проверку подлинности Windows или проверку подлинности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для соединений, установленных агентами. (Дополнительные сведения о доменах см. в документации Windows.)</span><span class="sxs-lookup"><span data-stu-id="b0ffa-128">If your replication topology includes computers that are not in the same domain or are in domains that do not have trust relationships with each other, you can use Windows Authentication or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication for the connections made by agents (For more information about domains, see the Windows documentation).</span></span> <span data-ttu-id="b0ffa-129">В качестве метода, обеспечивающего наилучшую защиту, рекомендуется использовать проверку подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-129">It is recommended as a security best practice that you use Windows Authentication.</span></span>  
  
-   <span data-ttu-id="b0ffa-130">Чтобы использовать проверку подлинности Windows:</span><span class="sxs-lookup"><span data-stu-id="b0ffa-130">To use Windows Authentication:</span></span>  
  
    -   <span data-ttu-id="b0ffa-131">Добавьте локальную учетную запись Windows (но не учетную запись домена) для каждого агента в соответствующих узлах (в каждом узле используйте одно и то же имя и пароль).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-131">Add a local Windows account (not a domain account) for each agent at the appropriate nodes (use the same name and password at each node).</span></span> <span data-ttu-id="b0ffa-132">Например, агент распространителя для принудительной подписки запускается на распространителе и устанавливает соединение между распространителем и подписчиком.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-132">For example, the Distribution Agent for a push subscription runs at the Distributor and makes connections to the Distributor and Subscriber.</span></span> <span data-ttu-id="b0ffa-133">Учетная запись Windows для агента распространителя должна быть добавлена на распространитель и подписчик.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-133">The Windows account for the Distribution Agent should be added to the Distributor and Subscriber.</span></span>  
  
    -   <span data-ttu-id="b0ffa-134">Убедитесь, что такой агент, например агент распространителя для подписки, запускается под одной и той же учетной записью на каждом компьютере.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-134">Ensure that a given agent (for example the Distribution Agent for a subscription) runs under the same account at each computer.</span></span>  
  
-   <span data-ttu-id="b0ffa-135">Чтобы использовать проверку подлинности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="b0ffa-135">To use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication:</span></span>  
  
    -   <span data-ttu-id="b0ffa-136">Добавьте учетную запись [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для каждого агента в соответствующих узлах (в каждом узле используйте одно и то же имя и пароль).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-136">Add a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] account for each agent at the appropriate nodes (use the same account name and password at each node).</span></span> <span data-ttu-id="b0ffa-137">Например, агент распространителя для принудительной подписки запускается на распространителе и устанавливает соединение между распространителем и подписчиком.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-137">For example, the Distribution Agent for a push subscription runs at the Distributor and makes connections to the Distributor and Subscriber.</span></span> <span data-ttu-id="b0ffa-138">Учетная запись [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для агента распространителя должна быть добавлена на распространитель и подписчик.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-138">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] account for the Distribution Agent should be added to the Distributor and Subscriber.</span></span>  
  
    -   <span data-ttu-id="b0ffa-139">Убедитесь, что такой агент, например агент распространителя для подписки, устанавливает соединения под одной и той же учетной записью на каждом компьютере.</span><span class="sxs-lookup"><span data-stu-id="b0ffa-139">Ensure that a given agent (for example the Distribution Agent for a subscription) makes connections under the same account at each computer.</span></span>  
  
    -   <span data-ttu-id="b0ffa-140">В ситуациях, требующих проверки подлинности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , часто не предоставляется доступ к хранилищу моментального снимка UNC (например, доступ может быть заблокирован брандмауэром).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-140">In situations that require [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, access to UNC snapshot shares is often not available (for example access might be blocked by a firewall).</span></span> <span data-ttu-id="b0ffa-141">В таком случае моментальный снимок может быть передан подписчикам при помощи протокола передачи данных (FTP).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-141">In this case, you can transfer the snapshot to Subscribers through file transfer protocol (FTP).</span></span> <span data-ttu-id="b0ffa-142">Дополнительные сведения см. в статье [Передача моментальных снимков через FTP](../transfer-snapshots-through-ftp.md).</span><span class="sxs-lookup"><span data-stu-id="b0ffa-142">For more information, see [Transfer Snapshots Through FTP](../transfer-snapshots-through-ftp.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b0ffa-143">См. также:</span><span class="sxs-lookup"><span data-stu-id="b0ffa-143">See Also</span></span>  
 <span data-ttu-id="b0ffa-144">[Включение шифрования соединений в ядре СУБД (диспетчер конфигурации SQL Server)](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="b0ffa-144">[Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md) </span></span>  
 <span data-ttu-id="b0ffa-145">[Репликация через Интернет](../replication-over-the-internet.md) </span><span class="sxs-lookup"><span data-stu-id="b0ffa-145">[Replication over the Internet](../replication-over-the-internet.md) </span></span>  
 <span data-ttu-id="b0ffa-146">[Защита подписчика](secure-the-subscriber.md) </span><span class="sxs-lookup"><span data-stu-id="b0ffa-146">[Secure the Subscriber](secure-the-subscriber.md) </span></span>  
 <span data-ttu-id="b0ffa-147">[Организация безопасности распространителя](secure-the-distributor.md) </span><span class="sxs-lookup"><span data-stu-id="b0ffa-147">[Secure the Distributor](secure-the-distributor.md) </span></span>  
 <span data-ttu-id="b0ffa-148">[Организация безопасности издателя](secure-the-publisher.md) </span><span class="sxs-lookup"><span data-stu-id="b0ffa-148">[Secure the Publisher](secure-the-publisher.md) </span></span>  
 [<span data-ttu-id="b0ffa-149">Безопасность Репликация SQL Server</span><span class="sxs-lookup"><span data-stu-id="b0ffa-149">SQL Server Replication Security</span></span>](view-and-modify-replication-security-settings.md)  
  
  
