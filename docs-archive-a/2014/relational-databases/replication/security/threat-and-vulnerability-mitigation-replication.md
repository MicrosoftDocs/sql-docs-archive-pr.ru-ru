---
title: Предотвращение угроз и уязвимости для безопасности (репликация) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- attacks [SQL Server replication]
- threats [SQL Server replication security]
- security [SQL Server replication], threats
- security threats [SQL Server replication]
ms.assetid: 314fe497-56d8-4192-98e9-21b87cf8db04
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c1a9c2c646f26d0cb61ae3d41ccdbd72551094d4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736138"
---
# <a name="threat-and-vulnerability-mitigation-replication"></a><span data-ttu-id="6e9d2-102">Предотвращение угроз и уязвимости для безопасности (репликация)</span><span class="sxs-lookup"><span data-stu-id="6e9d2-102">Threat and Vulnerability Mitigation (Replication)</span></span>
  <span data-ttu-id="6e9d2-103">В этом разделе приводятся методы снижения угроз для топологии репликации.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-103">This topic describes techniques to reduce threats to a replication topology.</span></span>  
  
## <a name="encryption"></a><span data-ttu-id="6e9d2-104">Шифрование</span><span class="sxs-lookup"><span data-stu-id="6e9d2-104">Encryption</span></span>  
 <span data-ttu-id="6e9d2-105">Шифрование представляет собой процесс преобразования данных в форму, которую невозможно прочитать без специального ключа, поэтому прочитать данные могут только назначенные пользователи.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-105">Encryption is the process of converting data into a form that cannot be read without a special key, so that only the intended recipient can read the data.</span></span> <span data-ttu-id="6e9d2-106">Репликация не производит шифрование данных, хранящихся в таблицах или передаваемых через сетевые соединения.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-106">Replication does not encrypt data stored in tables or sent over network connections.</span></span> <span data-ttu-id="6e9d2-107">Это сделано намеренно, так как шифрование доступно на транспортном уровне в различных технологиях, включая следующие отраслевые стандартные технологии: виртуальные частные сети (VPN), протокол SSL и протокол IPSEC.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-107">This is by design, because encryption is available at the transport level with a number of technologies, including the following industry standard technologies: Virtual Private Networks (VPN), Secure Sockets Layer (SSL), and IP Security (IPSEC).</span></span> <span data-ttu-id="6e9d2-108">Для соединений между компьютерами в топологии репликации рекомендуется использовать один из этих методов.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-108">We recommend using one of these encryption methods for the connections between computers in a replication topology.</span></span> <span data-ttu-id="6e9d2-109">Дополнительные сведения см. в разделе [Включение шифрования соединений в компоненте Database Engine (диспетчер конфигураций SQL Server)](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-109">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span> <span data-ttu-id="6e9d2-110">Сведения об использовании VPN и SSL для репликации данных через Интернет см. в разделе [Securing Replication Over the Internet](securing-replication-over-the-internet.md).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-110">For information about using VPN and SSL for replicating data over the Internet, see [Securing Replication Over the Internet](securing-replication-over-the-internet.md).</span></span>  
  
 <span data-ttu-id="6e9d2-111">Если используется протокол SSL для защиты соединений между компьютерами в топологии репликации, задайте значение **1** или **2** для параметра **-EncryptionLevel** каждого агента репликации (рекомендуется значение **2** ).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-111">If you use SSL to secure the connections between computers in a replication topology, specify a value of **1** or **2** for the **-EncryptionLevel** parameter of each replication agent (a value of **2** is recommended).</span></span> <span data-ttu-id="6e9d2-112">Значение **1** указывает, что шифрование будет использоваться, но агент не будет проверять, подписан ли SSL-сертификат сервера доверенным издателем; значение **2** указывает, что будет проверяться подпись сертификата.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-112">A value of **1** specifies that encryption is used, but the agent does not verify that the SSL server certificate is signed by a trusted issuer; a value of **2** specifies that the certificate is verified.</span></span> <span data-ttu-id="6e9d2-113">Параметры агента могут задаваться в профилях агента или в командной строке.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-113">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="6e9d2-114">Дополнительные сведения см. в разделе:</span><span class="sxs-lookup"><span data-stu-id="6e9d2-114">For more information, see:</span></span>  
  
-   [<span data-ttu-id="6e9d2-115">Работа с профилями агента репликации</span><span class="sxs-lookup"><span data-stu-id="6e9d2-115">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
-   [<span data-ttu-id="6e9d2-116">Просмотр и изменение параметров командной строки агента репликации (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="6e9d2-116">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
-   [<span data-ttu-id="6e9d2-117">Replication Agent Executables Concepts</span><span class="sxs-lookup"><span data-stu-id="6e9d2-117">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
 <span data-ttu-id="6e9d2-118">Репликация взаимодействует с главными ключами базы данных, которые используются для шифрования данных, следующим образом.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-118">Replication has the following behavior with respect to database Master Keys, which are used to encrypt data:</span></span>  
  
-   <span data-ttu-id="6e9d2-119">Если главный ключ находится в базе данных, участвующей в репликации (база данных публикации, база данных подписки или база данных распространителя), репликация шифрует и дешифрует пароли агентов в этой базе данных с помощью симметричного ключа базы данных [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6e9d2-119">If a Master Key is present in a database involved in replication (a publication database, subscription database, or distribution database), replication encrypts and decrypts agent passwords in that database using a [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] database symmetric key.</span></span> <span data-ttu-id="6e9d2-120">Если используются главные ключи, то их необходимо создать во всех базах данных, участвующих в репликации.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-120">If Master Keys are used, a Master Key should be created in each database involved in replication.</span></span> <span data-ttu-id="6e9d2-121">Дополнительные сведения о создании главных ключей см. в статье [CREATE MASTER KEY (Transact-SQL)](/sql/t-sql/statements/create-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-121">For more information about creating Master Keys, see [CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql).</span></span>  
  
-   <span data-ttu-id="6e9d2-122">При репликации главные ключи не реплицируются.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-122">Replication does not replicate Master Keys.</span></span> <span data-ttu-id="6e9d2-123">Если главный ключ требуется на подписчике, его необходимо экспортировать из базы данных публикации с помощью команды BACKUP MASTER KEY, а затем импортировать его в базу данных подписки с использованием команды RESTORE MASTER KEY.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-123">If you require the Master Key at the Subscriber, you must export it from the publication database using BACKUP MASTER KEY and then import it into the subscription database using RESTORE MASTER KEY.</span></span> <span data-ttu-id="6e9d2-124">Дополнительные сведения см. в статьях [BACKUP MASTER KEY (Transact-SQL)](/sql/t-sql/statements/backup-master-key-transact-sql) и [RESTORE MASTER KEY (Transact-SQL)](/sql/t-sql/statements/restore-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-124">For more information, see [BACKUP MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-master-key-transact-sql) and [RESTORE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-master-key-transact-sql).</span></span>  
  
-   <span data-ttu-id="6e9d2-125">Если для присоединяемой базы данных подписки определен главный ключ, укажите пароль главного ключа с помощью **@db_master_key_password** параметра [Sp_attachsubscription &#40;TRANSACT-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-attachsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-125">If a Master Key is defined for an attachable subscription database, specify the Master Key password using the **@db_master_key_password** parameter of [sp_attachsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-attachsubscription-transact-sql).</span></span> <span data-ttu-id="6e9d2-126">Такое действие позволяет присоединять базу данных на подписчике.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-126">This allows the database to be attached at the Subscriber.</span></span>  
  
 <span data-ttu-id="6e9d2-127">Дополнительные сведения о шифровании и главных ключах см. в разделе [Encryption Hierarchy](../../security/encryption/encryption-hierarchy.md).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-127">For more information about encryption and Master Keys, see [Encryption Hierarchy](../../security/encryption/encryption-hierarchy.md).</span></span>  
  
 <span data-ttu-id="6e9d2-128">Репликация позволяет публиковать данные зашифрованных столбцов.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-128">Replication enables you to publish encrypted column data.</span></span> <span data-ttu-id="6e9d2-129">Для расшифровки и использования этих данных на подписчике ключ, который был использован при шифровании данных на издателе, должен также располагаться и на подписчике.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-129">To decrypt and use this data at the Subscriber, the key that was used to encrypt the data at the Publisher must also be present on the Subscriber.</span></span> <span data-ttu-id="6e9d2-130">Репликация не предоставляет безопасного механизма для передачи ключей шифрования.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-130">Replication does not provide a secure mechanism to transport encryption keys.</span></span> <span data-ttu-id="6e9d2-131">Необходимо вручную повторно создать ключ шифрования на подписчике.</span><span class="sxs-lookup"><span data-stu-id="6e9d2-131">You must manually re-create the encryption key at the Subscriber.</span></span> <span data-ttu-id="6e9d2-132">Дополнительные сведения см. в статье [Репликация данных в зашифрованных столбцах (среда SQL Server Management Studio)](replicate-data-in-encrypted-columns-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="6e9d2-132">For more information, see [Replicate Data in Encrypted Columns &#40;SQL Server Management Studio&#41;](replicate-data-in-encrypted-columns-sql-server-management-studio.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6e9d2-133">См. также:</span><span class="sxs-lookup"><span data-stu-id="6e9d2-133">See Also</span></span>  
 <span data-ttu-id="6e9d2-134">[Управление удостоверениями и доступом &#40;репликация&#41;](identity-and-access-control-replication.md) </span><span class="sxs-lookup"><span data-stu-id="6e9d2-134">[Identity and Access Control &#40;Replication&#41;](identity-and-access-control-replication.md) </span></span>  
 [<span data-ttu-id="6e9d2-135">Безопасное развертывание репликации</span><span class="sxs-lookup"><span data-stu-id="6e9d2-135">Secure Replication Deployment</span></span>](view-and-modify-replication-security-settings.md)  
  
  
