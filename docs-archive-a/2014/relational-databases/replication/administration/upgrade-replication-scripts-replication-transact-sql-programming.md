---
title: Обновление скриптов репликации (программирование репликации на языке Transact-SQL) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- scripts [SQL Server replication], upgrading
- upgrading SQL Server, replicated databases
- upgrading replication applications
- replication [SQL Server], scripting
- replication [SQL Server], upgrading
- upgrading replicated databases
ms.assetid: 0b8720bd-f339-4842-bc8f-b35a46f6d3ee
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c47101c76ca2c585accd493b74f0e59c56bf009e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87657679"
---
# <a name="upgrade-replication-scripts-replication-transact-sql-programming"></a><span data-ttu-id="def6d-102">обновить скрипты репликации (программирование репликации на языке Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="def6d-102">Upgrade Replication Scripts (Replication Transact-SQL Programming)</span></span>
  <span data-ttu-id="def6d-103">Настройка топологии репликации программным способом возможна при помощи файлов скриптов на языке[!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="def6d-103">[!INCLUDE[tsql](../../../includes/tsql-md.md)] script files can be used to programmatically configure a replication topology.</span></span> <span data-ttu-id="def6d-104">Дополнительные сведения см. в статье [Основные понятия системных хранимых процедур репликации](../concepts/replication-system-stored-procedures-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-104">For more information, see [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="def6d-105">Хотя обновление скриптов, выполняемых членами роли `sysadmin`, не является обязательным, рекомендуется внести в существующие скрипты изменения, описанные в настоящем разделе.</span><span class="sxs-lookup"><span data-stu-id="def6d-105">Although you are not required to upgrade scripts that are executed by members of the `sysadmin` role, we recommend that you modify existing scripts as described in this topic.</span></span> <span data-ttu-id="def6d-106">Для всех агентов репликации следует указывать учетные записи, наделенные минимальным числом разрешений, как это описано в подразделе «Разрешения, необходимые для агентов» раздела [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-106">Specify an account that has minimum permissions for each replication agent as described in the "Permissions Required By Agents" section of the topic [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="def6d-107">Улучшения в области безопасности, повышающие управляемость разрешений за счет предоставления пользователю возможности явно задавать учетные записи [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows, от которых выполняются задания агента репликации, затронут следующие хранимые процедуры в существующих скриптов.</span><span class="sxs-lookup"><span data-stu-id="def6d-107">These security improvements, which enable more control over permissions by allowing you to explicitly specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows accounts under which replication agent jobs are executed, affect the following stored procedures in existing scripts:</span></span>  
  
-   <span data-ttu-id="def6d-108">**sp_addpublication_snapshot**:</span><span class="sxs-lookup"><span data-stu-id="def6d-108">**sp_addpublication_snapshot**:</span></span>  
  
     <span data-ttu-id="def6d-109">Теперь учетные данные Windows следует указывать как **@job_login** и **@job_password** при выполнении [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) для создания задания, при котором агент моментальных снимков выполняется на распространителе.</span><span class="sxs-lookup"><span data-stu-id="def6d-109">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) to create the job under which the Snapshot Agent runs at the Distributor.</span></span>  
  
-   <span data-ttu-id="def6d-110">**sp_addpushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="def6d-110">**sp_addpushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="def6d-111">Теперь пользователь должен выполнять хранимую процедуру [sp_addpushsubscription_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql), чтобы явным образом добавить задание и передать учетные данные Windows(в параметрах **@job_login** и **@job_password**), с которыми задание агента распространителя будет выполняться на распространителе.</span><span class="sxs-lookup"><span data-stu-id="def6d-111">You should now execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Distribution Agent job runs at the Distributor.</span></span> <span data-ttu-id="def6d-112">В версиях [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] до [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]это выполнялось автоматически при создании принудительной подписки.</span><span class="sxs-lookup"><span data-stu-id="def6d-112">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="def6d-113">**sp_addmergepushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="def6d-113">**sp_addmergepushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="def6d-114">Теперь пользователь должен выполнить процедуру [sp_addpushsubscription_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql), чтобы явным образом добавить задание и передать учетные данные Windows (в параметрах **@job_login** и **@job_password**), с использованием которых задание агента слияния будет выполняться на распространителе.</span><span class="sxs-lookup"><span data-stu-id="def6d-114">You should now execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Merge Agent job runs at the Distributor.</span></span> <span data-ttu-id="def6d-115">В версиях [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] до [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]это выполнялось автоматически при создании принудительной подписки.</span><span class="sxs-lookup"><span data-stu-id="def6d-115">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="def6d-116">**sp_addpullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="def6d-116">**sp_addpullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="def6d-117">Теперь учетные данные Windows следует указывать как **@job_login** и **@job_password** при выполнении [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) для создания задания, при котором агент распространения выполняется на подписчике.</span><span class="sxs-lookup"><span data-stu-id="def6d-117">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to create the job under which the Distribution Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="def6d-118">**sp_addmergepullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="def6d-118">**sp_addmergepullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="def6d-119">Теперь учетные данные Windows следует указывать как **@job_login** и **@job_password** при выполнении [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) для создания задания, при котором агент слияния выполняется на подписчике.</span><span class="sxs-lookup"><span data-stu-id="def6d-119">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to create the job under which the Merge Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="def6d-120">**sp_addlogreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="def6d-120">**sp_addlogreader_agent**:</span></span>  
  
     <span data-ttu-id="def6d-121">Теперь пользователь должен вызвать хранимую процедуру [sp_addlogreader_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql), чтобы вручную добавить задание и передать учетные данные Windows, с использованием которых агент чтения журнала будет выполняться на распространителе.</span><span class="sxs-lookup"><span data-stu-id="def6d-121">You should now execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Log Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="def6d-122">В версиях [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ранее [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]это делалось автоматически при создании публикации транзакций.</span><span class="sxs-lookup"><span data-stu-id="def6d-122">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication was created.</span></span>  
  
-   <span data-ttu-id="def6d-123">**sp_addqreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="def6d-123">**sp_addqreader_agent**:</span></span>  
  
     <span data-ttu-id="def6d-124">Теперь пользователь должен вызвать хранимую процедуру [sp_addlogreader_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql), чтобы вручную добавить задание и передать учетные данные Windows, с использованием которых агент чтения очереди будет выполняться на распространителе.</span><span class="sxs-lookup"><span data-stu-id="def6d-124">You should now execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Queue Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="def6d-125">В версиях [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ранее [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]это производилось автоматически при создании публикации транзакций, поддерживающей обновление посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="def6d-125">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication that supported queued updating was created.</span></span>  
  
 <span data-ttu-id="def6d-126">В модели безопасности, представленной в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] , агенты репликации всегда выполняют соединения с локальным экземпляром [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с проверкой подлинности Windows, используя учетные данные, указанные в **@job_name** и **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-126">In the security model introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], replication agents always make connections to the local instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] with Windows Authentication using the credentials supplied in **@job_name** and **@job_password**.</span></span> <span data-ttu-id="def6d-127">Сведения о требованиях к учетным записям Windows, которые предназначены для выполнения заданий агента репликации, см. в разделе [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-127">For information about the requirements of Windows accounts used when running replication agent jobs, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="def6d-128">По возможности предлагайте пользователям вводить учетные данные системы безопасности во время выполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="def6d-128">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="def6d-129">Если учетные данные сохраняются в файле скрипта, то должна быть обеспечена защита этого файла.</span><span class="sxs-lookup"><span data-stu-id="def6d-129">If you store credentials in a script file, ensure that the file itself is secured.</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-snapshot-or-transactional-publication"></a><span data-ttu-id="def6d-130">Обновление скриптов настройки репликации моментальными снимками и публикацией транзакций</span><span class="sxs-lookup"><span data-stu-id="def6d-130">To upgrade scripts that configure a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="def6d-131">В существующем скрипте перед [sp_addpublication (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) выполните хранимую процедуру [sp_addlogreader_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) в издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="def6d-131">In the existing script, before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="def6d-132">Укажите учетные данные Windows, с которыми будет выполняться агент чтения журнала, для **@job_name** и **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-132">Specify the Windows credentials under which the Log Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="def6d-133">Если агент будет использовать [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] проверку подлинности при соединении с издателем, необходимо также указать значение **0** в параметре **@publisher_security_mode** и [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] сведения об имени входа для **@publisher_login** и **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-133">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="def6d-134">Таким образом будет сформировано задание агента чтения журнала для базы данных публикации.</span><span class="sxs-lookup"><span data-stu-id="def6d-134">This creates a Log Reader Agent job for the publication database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="def6d-135">Этот шаг предназначен только для публикаций транзакций и не обязателен для публикаций моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="def6d-135">This step is only for transactional publications and is not required for snapshot publications.</span></span>  
  
2.  <span data-ttu-id="def6d-136">(Необязательно.) Перед [sp_addpublication (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) выполните [sp_addlogreader_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) в издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="def6d-136">(Optional) Before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) at the Distributor on the distribution database.</span></span> <span data-ttu-id="def6d-137">Укажите учетные данные Windows, с которыми будет выполняться агент чтения очереди, для **@job_name** и **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-137">Specify the Windows credentials under which the Queue Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="def6d-138">В результате этого будет сформировано задание агента чтения очереди для распространителя.</span><span class="sxs-lookup"><span data-stu-id="def6d-138">This creates a Queue Reader Agent job for the Distributor.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="def6d-139">Этот шаг обязателен только для публикаций транзакций, которые поддерживают подписчиков, обновляемых посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="def6d-139">This step is only required for transactional publications that support queued updating subscribers.</span></span>  
  
3.  <span data-ttu-id="def6d-140">Чтобы установить для параметров, реализующих новые функции репликации, значения отличные от принятых по умолчанию, обновите код вызова процедуры [sp_addpublication (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) (необязательно).</span><span class="sxs-lookup"><span data-stu-id="def6d-140">(Optional) Update the execution of [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
4.  <span data-ttu-id="def6d-141">После [sp_addpublication (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) выполните [sp_addpublication_snapshot (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) в издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="def6d-141">After [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="def6d-142">Укажите **@publication** учетные данные Windows, с которыми будет запускаться агент моментальных снимков, и **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-142">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="def6d-143">Если агент будет использовать [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] проверку подлинности при соединении с издателем, необходимо также указать значение **0** в параметре **@publisher_security_mode** и [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] сведения об имени входа для **@publisher_login** и **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-143">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="def6d-144">Будет создано задание агента моментальных снимков для публикации.</span><span class="sxs-lookup"><span data-stu-id="def6d-144">This creates a Snapshot Agent job for the publication.</span></span>  
  
5.  <span data-ttu-id="def6d-145">Чтобы установить для параметров, реализующих новые функции репликации, значения, отличные от принятых по умолчанию, обновите код вызова процедуры [sp_addarticle (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) (необязательно).</span><span class="sxs-lookup"><span data-stu-id="def6d-145">(Optional) Update the execution of [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="def6d-146">Обновление скриптов, которые добавляют подписки к публикациям моментальных снимков или публикациям транзакций</span><span class="sxs-lookup"><span data-stu-id="def6d-146">To upgrade scripts that add subscriptions to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="def6d-147">После вызова хранимой процедуры, которая создает подписку, обязательно выполните хранимую процедуру, формирующую задание агента распространителя для синхронизации подписки.</span><span class="sxs-lookup"><span data-stu-id="def6d-147">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Distribution Agent job to synchronize the subscription.</span></span> <span data-ttu-id="def6d-148">Используемая хранимая процедура зависит от типа подписки.</span><span class="sxs-lookup"><span data-stu-id="def6d-148">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="def6d-149">Для подписки по запросу обновите вызов процедуры [sp_addpullsubscription_agent (Transact-SQL) ](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql), указав в параметрах **@job_name** и **@job_password** учетные данные Windows, с использованием которых агент распространителя будет запускаться на подписчике.</span><span class="sxs-lookup"><span data-stu-id="def6d-149">For a pull subscription, update the execution of [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to supply the Windows credentials under which the Distribution Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="def6d-150">Это необходимо сделать после вызова хранимой процедуры [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="def6d-150">This is done after the execution of [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="def6d-151">Дополнительные сведения см. в статье [Создание подписки по запросу](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-151">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="def6d-152">Для принудительной подписки выполните процедуру [sp_addpushsubscription_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) на издателе.</span><span class="sxs-lookup"><span data-stu-id="def6d-152">For a push subscription, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="def6d-153">Укажите **@subscriber** , **@subscriber_db** , **@publication** , учетные данные Windows, с которыми агент распространения выполняется на распространителе для **@job_name** и **@job_password** , и расписание для этого задания агента.</span><span class="sxs-lookup"><span data-stu-id="def6d-153">Specify **@subscriber**, **@subscriber_db**, **@publication**, Windows credentials under which the Distribution Agent runs at the Distributor for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="def6d-154">Дополнительные сведения см. в статье [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-154">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="def6d-155">Это необходимо сделать после вызова процедуры [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="def6d-155">This is done after the execution of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="def6d-156">Дополнительные сведения см. в статье [Создание принудительной подписки](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-156">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-merge-publication"></a><span data-ttu-id="def6d-157">Обновление скриптов настройки публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="def6d-157">To upgrade scripts that configure a merge publication</span></span>  
  
1.  <span data-ttu-id="def6d-158">В существующем скрипте обновите вызов процедуры [sp_addmergepublication (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), указав для новых параметров, реализующих новые функции репликации, значения, отличные от заданных по умолчанию (необязательно).</span><span class="sxs-lookup"><span data-stu-id="def6d-158">(Optional) In the existing script, update the execution of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
2.  <span data-ttu-id="def6d-159">После [sp_addmergepublication (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) выполните [sp_addpublication_snapshot (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) в издателе в базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="def6d-159">After [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="def6d-160">Укажите **@publication** учетные данные Windows, с которыми будет запускаться агент моментальных снимков, и **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-160">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="def6d-161">Если агент будет использовать [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] проверку подлинности при соединении с издателем, необходимо также указать значение **0** в параметре **@publisher_security_mode** и [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] сведения об имени входа для **@publisher_login** и **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="def6d-161">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="def6d-162">Будет создано задание агента моментальных снимков для публикации.</span><span class="sxs-lookup"><span data-stu-id="def6d-162">This creates a Snapshot Agent job for the publication.</span></span>  
  
3.  <span data-ttu-id="def6d-163">(Необязательно.) Чтобы установить для параметров, реализующих новые функции репликации, значения, отличные от принятых по умолчанию, обновите код вызова процедуры [sp_addmergearticle (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="def6d-163">(Optional) Update the execution of [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-merge-publication"></a><span data-ttu-id="def6d-164">Обновление скриптов, добавляющих подписки к публикации слиянием</span><span class="sxs-lookup"><span data-stu-id="def6d-164">To upgrade scripts that add subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="def6d-165">После вызова хранимой процедуры, которая создает подписку, обязательно выполните хранимую процедуру, формирующую задание агента слияния для синхронизации подписки.</span><span class="sxs-lookup"><span data-stu-id="def6d-165">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Merge Agent job to synchronize the subscription.</span></span> <span data-ttu-id="def6d-166">Используемая хранимая процедура зависит от типа подписки.</span><span class="sxs-lookup"><span data-stu-id="def6d-166">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="def6d-167">Для подписки по запросу обновите вызов процедуры [sp_addmergepullsubscription_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql), указав в параметрах **@job_name** и **@job_password** учетные данные Windows, с использованием которых агент слияния будет запускаться на подписчике.</span><span class="sxs-lookup"><span data-stu-id="def6d-167">For a pull subscription, update the execution of [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to supply the Windows credentials under which the Merge Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="def6d-168">Это необходимо сделать после вызова процедуры [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="def6d-168">This is done after the execution of [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="def6d-169">Дополнительные сведения см. в статье [Создание подписки по запросу](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-169">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="def6d-170">Для принудительной подписки, выполните процедуру [sp_addmergepushsubscription_agent (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) на издателе.</span><span class="sxs-lookup"><span data-stu-id="def6d-170">For a push subscription, execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="def6d-171">Укажите **@subscriber** , **@subscriber_db** , **@publication** , учетные данные Windows, с которыми будет запускаться агент слияния на распространителе **@job_name** **@job_password** , и расписание для этого задания агента.</span><span class="sxs-lookup"><span data-stu-id="def6d-171">Specify **@subscriber**, **@subscriber_db**, **@publication**, the Windows credentials under which the Merge Agent at the Distributor runs for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="def6d-172">Дополнительные сведения см. в статье [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-172">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="def6d-173">Это необходимо сделать после вызова хранимой процедуры [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="def6d-173">This is done after the execution of [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="def6d-174">Дополнительные сведения см. в статье [Создание принудительной подписки](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="def6d-174">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="def6d-175">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-175">Example</span></span>  
 <span data-ttu-id="def6d-176">Ниже приведен пример скрипта [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , который создает публикацию транзакций для таблицы Product.</span><span class="sxs-lookup"><span data-stu-id="def6d-176">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a transactional publication for the Product table.</span></span> <span data-ttu-id="def6d-177">Эта публикация поддерживает немедленное обновление с переключением на обновление отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="def6d-177">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="def6d-178">Значения по умолчанию были удалены для удобства чтения.</span><span class="sxs-lookup"><span data-stu-id="def6d-178">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpub80.sql#sp_createtranpub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-179">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-179">Example</span></span>  
 <span data-ttu-id="def6d-180">Ниже приведено обновление предыдущего примера скрипта, который создает публикацию транзакций для запуска в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="def6d-180">The following is an example of upgrading the previous script, which creates a transactional publication, to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="def6d-181">Эта публикация поддерживает немедленное обновление с переключением на обновление отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="def6d-181">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="def6d-182">Значения по умолчанию для новых параметров были объявлены явно.</span><span class="sxs-lookup"><span data-stu-id="def6d-182">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="def6d-183"> Учетные данные Windows предоставляются во время выполнения с помощью переменных сценария **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="def6d-183">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpublication.sql#sp_createtranpub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-184">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-184">Example</span></span>  
 <span data-ttu-id="def6d-185">Ниже приведен пример скрипта [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , который создает публикацию слиянием для таблицы Customers.</span><span class="sxs-lookup"><span data-stu-id="def6d-185">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a merge publication for the Customers table.</span></span> <span data-ttu-id="def6d-186">Значения по умолчанию были удалены для удобства чтения.</span><span class="sxs-lookup"><span data-stu-id="def6d-186">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepub80.sql#sp_createmergepub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-187">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-187">Example</span></span>  
 <span data-ttu-id="def6d-188">Ниже приведен предыдущий пример скрипта для создания публикации слиянием, обновленный для запуска в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="def6d-188">The following is an example of the previous script, which creates a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="def6d-189">Значения по умолчанию для новых параметров были объявлены явно.</span><span class="sxs-lookup"><span data-stu-id="def6d-189">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="def6d-190"> Учетные данные Windows предоставляются во время выполнения с помощью переменных сценария **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="def6d-190">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepublication.sql#sp_createmergepub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-191">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-191">Example</span></span>  
 <span data-ttu-id="def6d-192">Ниже приведен пример скрипта [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , который создает принудительную подписку для публикации транзакций.</span><span class="sxs-lookup"><span data-stu-id="def6d-192">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="def6d-193">Значения по умолчанию были удалены для удобства чтения.</span><span class="sxs-lookup"><span data-stu-id="def6d-193">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpushsub80.sql#sp_createtranpushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-194">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-194">Example</span></span>  
 <span data-ttu-id="def6d-195">Ниже приведен предыдущий пример скрипта для создания принудительной подписки для публикации транзакций, обновленный для запуска в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="def6d-195">The following is an example of the previous script, which creates a push subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="def6d-196">Значения по умолчанию для новых параметров были объявлены явно.</span><span class="sxs-lookup"><span data-stu-id="def6d-196">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="def6d-197"> Учетные данные Windows предоставляются во время выполнения с помощью переменных сценария **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="def6d-197">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createtranpushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-198">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-198">Example</span></span>  
 <span data-ttu-id="def6d-199">Ниже приведен пример скрипта [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , который создает принудительную подписку для публикации слиянием.</span><span class="sxs-lookup"><span data-stu-id="def6d-199">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a merge publication.</span></span> <span data-ttu-id="def6d-200">Значения по умолчанию были удалены для удобства чтения.</span><span class="sxs-lookup"><span data-stu-id="def6d-200">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-201">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-201">Example</span></span>  
 <span data-ttu-id="def6d-202">Ниже приведен предыдущий пример скрипта, создающий принудительную подписку для публикации слиянием, обновленный для запуска в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="def6d-202">The following is an example of the previous script, which creates a push subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="def6d-203">Значения по умолчанию для новых параметров были объявлены явно.</span><span class="sxs-lookup"><span data-stu-id="def6d-203">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="def6d-204"> Учетные данные Windows предоставляются во время выполнения с помощью переменных сценария **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="def6d-204">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createmergepushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-205">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-205">Example</span></span>  
 <span data-ttu-id="def6d-206">Ниже приведен пример скрипта [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , который создает подписку по запросу для публикации транзакций.</span><span class="sxs-lookup"><span data-stu-id="def6d-206">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="def6d-207">Значения по умолчанию были удалены для удобства чтения.</span><span class="sxs-lookup"><span data-stu-id="def6d-207">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-208">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-208">Example</span></span>  
 <span data-ttu-id="def6d-209">Ниже приведен предыдущий пример скрипта для создания подписки по запросу для публикации транзакций, обновленный для запуска в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="def6d-209">The following is an example of the previous script, which creates a pull subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="def6d-210">Значения по умолчанию для новых параметров были объявлены явно.</span><span class="sxs-lookup"><span data-stu-id="def6d-210">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="def6d-211"> Учетные данные Windows предоставляются во время выполнения с помощью переменных сценария **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="def6d-211">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createtranpullsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-212">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-212">Example</span></span>  
 <span data-ttu-id="def6d-213">Ниже приведен пример скрипта [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , который создает подписку по запросу для публикации слиянием.</span><span class="sxs-lookup"><span data-stu-id="def6d-213">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="def6d-214">Значения по умолчанию были удалены для удобства чтения.</span><span class="sxs-lookup"><span data-stu-id="def6d-214">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepullsub80.sql#sp_createmergepullsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="def6d-215">Пример</span><span class="sxs-lookup"><span data-stu-id="def6d-215">Example</span></span>  
 <span data-ttu-id="def6d-216">Ниже приведен предыдущий пример скрипта, создающий подписку по запросу для публикации слиянием, обновленный для запуска в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях.</span><span class="sxs-lookup"><span data-stu-id="def6d-216">The following is an example of the previous script, which creates a pull subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="def6d-217">Значения по умолчанию для новых параметров были объявлены явно.</span><span class="sxs-lookup"><span data-stu-id="def6d-217">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="def6d-218"> Учетные данные Windows предоставляются во время выполнения с помощью переменных сценария **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="def6d-218">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createmergepullsub_nwpostupgrade)]  
  
## <a name="see-also"></a><span data-ttu-id="def6d-219">См. также:</span><span class="sxs-lookup"><span data-stu-id="def6d-219">See Also</span></span>  
 <span data-ttu-id="def6d-220">[Create a Publication](../publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="def6d-220">[Create a Publication](../publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="def6d-221">[Create a Push Subscription](../create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="def6d-221">[Create a Push Subscription](../create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="def6d-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="def6d-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="def6d-223">[Просмотр и изменение параметров безопасности репликации](../security/view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="def6d-223">[View and Modify Replication Security Settings](../security/view-and-modify-replication-security-settings.md) </span></span>  
 <span data-ttu-id="def6d-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span><span class="sxs-lookup"><span data-stu-id="def6d-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span></span>  
 <span data-ttu-id="def6d-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span><span class="sxs-lookup"><span data-stu-id="def6d-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span></span>  
 <span data-ttu-id="def6d-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="def6d-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="def6d-227">Обновление реплицируемых баз данных</span><span class="sxs-lookup"><span data-stu-id="def6d-227">Upgrade Replicated Databases</span></span>](../../../database-engine/install-windows/upgrade-replicated-databases.md)  
  
  
