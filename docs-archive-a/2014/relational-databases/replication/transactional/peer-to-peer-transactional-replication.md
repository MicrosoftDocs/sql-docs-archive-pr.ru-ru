---
title: Одноранговая репликация транзакций | Документация Майкрософт
ms.custom: ''
ms.date: 08/29/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- bidirectional replication
- transactional replication, bidirectional replication
- bidirectional transactional replication
- transactional replication, peer-to-peer replication
- peer-to-peer transactional replication
ms.assetid: 23e7e8c1-002f-4e69-8c99-d63e4100de64
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: f61db9a8e7cecb107fd1b27fae966d133e043c8b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664849"
---
# <a name="peer-to-peer-transactional-replication"></a><span data-ttu-id="aee28-102">Peer-to-Peer Transactional Replication</span><span class="sxs-lookup"><span data-stu-id="aee28-102">Peer-to-Peer Transactional Replication</span></span>
  <span data-ttu-id="aee28-103">Одноранговая репликация поддерживает масштабируемые и отказоустойчивые решения, сохраняя копии данных на нескольких экземплярах сервера, которые также называются *узлами*.</span><span class="sxs-lookup"><span data-stu-id="aee28-103">Peer-to-peer replication provides a scale-out and high-availability solution by maintaining copies of data across multiple server instances, also referred to as *nodes*.</span></span> <span data-ttu-id="aee28-104">Одноранговая репликация, основанная на репликации транзакций, распространяет согласованные на уровне транзакций изменения почти в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="aee28-104">Built on the foundation of transactional replication, peer-to-peer replication propagates transactionally consistent changes in near real-time.</span></span> <span data-ttu-id="aee28-105">Это позволяет приложениям, для которых требуется масштабируемость операций чтения, распределять клиентские операции чтения на несколько узлов.</span><span class="sxs-lookup"><span data-stu-id="aee28-105">This enables applications that require scale-out of read operations to distribute the reads from clients across multiple nodes.</span></span> <span data-ttu-id="aee28-106">Поскольку данные сохраняются на узлах почти в режиме реального времени, одноранговая репликация обеспечивает избыточность данных, что повышает доступность данных.</span><span class="sxs-lookup"><span data-stu-id="aee28-106">Because data is maintained across the nodes in near real-time, peer-to-peer replication provides data redundancy, which increases the availability of data.</span></span>  
  
 <span data-ttu-id="aee28-107">Рассмотрим веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="aee28-107">Consider a Web application.</span></span> <span data-ttu-id="aee28-108">В этом случае извлечь выгоду из одноранговой репликации можно следующими способами.</span><span class="sxs-lookup"><span data-stu-id="aee28-108">This can benefit from peer-to-peer replication in the following ways:</span></span>  
  
-   <span data-ttu-id="aee28-109">Запросы к каталогам и другие операции чтения распределяются на нескольких узлах.</span><span class="sxs-lookup"><span data-stu-id="aee28-109">Catalog queries and other reads are spread across multiple nodes.</span></span> <span data-ttu-id="aee28-110">Тем самым повышается производительность и сохраняется согласованность.</span><span class="sxs-lookup"><span data-stu-id="aee28-110">This enables performance to remain consistent as reads increase.</span></span>  
  
-   <span data-ttu-id="aee28-111">Если один из узлов в системе выходит из строя, уровень приложения может перенаправить операции записи на другой узел.</span><span class="sxs-lookup"><span data-stu-id="aee28-111">If one of the nodes in the system fails, an application layer can redirect the writes for that node to another node.</span></span> <span data-ttu-id="aee28-112">Это позволяет сохранить доступность данных.</span><span class="sxs-lookup"><span data-stu-id="aee28-112">This maintains availability.</span></span>  
  
-   <span data-ttu-id="aee28-113">Если узлу требуется обслуживание или вся система нуждается в обновлении, каждый узел можно перевести в режим «вне сети», а затем опять добавить к системе, не затрагивая доступность приложения.</span><span class="sxs-lookup"><span data-stu-id="aee28-113">If a node requires maintenance or the whole system requires an upgrade, each node can be taken offline and added back to the system without affecting the availability of the application.</span></span>  
  
 <span data-ttu-id="aee28-114">Хотя одноранговая репликация позволяет масштабировать операции чтения, производительность операций записи для топологии такая же, как для одного узла.</span><span class="sxs-lookup"><span data-stu-id="aee28-114">Although peer-to-peer replication enables scaling out of read operations, write performance for the topology is like that for a single node.</span></span> <span data-ttu-id="aee28-115">Это объясняется тем, что в конце концов все операции вставки, обновления и удаления распространяются на все узлы.</span><span class="sxs-lookup"><span data-stu-id="aee28-115">This is because ultimately all inserts, updates, and deletes are propagated to all nodes.</span></span> <span data-ttu-id="aee28-116">Примененное к данному узлу изменение распознается репликацией, что предотвращает выполнение изменений на узлах более одного раза.</span><span class="sxs-lookup"><span data-stu-id="aee28-116">Replication recognizes when a change has been applied to a given node and prevents changes from cycling through the nodes more than one time.</span></span> <span data-ttu-id="aee28-117">Настоятельно рекомендуется выполнять операции записи для каждой строки только на одном узле по следующим причинам.</span><span class="sxs-lookup"><span data-stu-id="aee28-117">We strongly recommend that write operations for each row be performed at only node, for the following reasons:</span></span>  
  
-   <span data-ttu-id="aee28-118">Если строка изменяется на нескольких узлах, это может вызвать конфликт или даже потерю обновления, когда эта строка передается на другие узлы.</span><span class="sxs-lookup"><span data-stu-id="aee28-118">If a row is modified at more than one node, it can cause a conflict or even a lost update when the row is propagated to other nodes.</span></span>  
  
-   <span data-ttu-id="aee28-119">При репликации изменений всегда существует некоторая задержка.</span><span class="sxs-lookup"><span data-stu-id="aee28-119">There is always some latency involved when changes are replicated.</span></span> <span data-ttu-id="aee28-120">Для приложений, которым требуется немедленно отслеживать последние изменения, равномерное распределение динамической загрузки может оказаться проблематичным.</span><span class="sxs-lookup"><span data-stu-id="aee28-120">For applications that require the latest change to be seen immediately, dynamically load balancing the application across multiple nodes can be problematic.</span></span>  
  
 <span data-ttu-id="aee28-121">Одноранговая репликация содержит возможность включить обнаружение конфликтов во всей одноранговой топологии.</span><span class="sxs-lookup"><span data-stu-id="aee28-121">Peer-to-peer replication includes the option to enable conflict detection across a peer-to-peer topology.</span></span> <span data-ttu-id="aee28-122">Эта возможность помогает избежать проблем, которые вызываются необнаруженными конфликтами, в том числе недопустимым поведением приложения и потерянными обновлениями.</span><span class="sxs-lookup"><span data-stu-id="aee28-122">This option helps prevent the issues that are caused from undetected conflicts, including inconsistent application behavior and lost updates.</span></span> <span data-ttu-id="aee28-123">При включенном обнаружении конфликтов конфликтующее изменение по умолчанию рассматривается как критическая ошибка, вызывающая сбой агента распространителя.</span><span class="sxs-lookup"><span data-stu-id="aee28-123">By enabling this option, by default a conflicting change is treated as a critical error that causes the failure of the Distribution Agent.</span></span> <span data-ttu-id="aee28-124">В случае конфликта топология остается в несогласованном состоянии, пока конфликт не будет разрешен вручную, а данные согласованы во всей топологии.</span><span class="sxs-lookup"><span data-stu-id="aee28-124">In the event of a conflict, the topology remains in an inconsistent state until the conflict is resolved manually and the data is made consistent across the topology.</span></span> <span data-ttu-id="aee28-125">Дополнительные сведения см. в разделе [Conflict Detection in Peer-to-Peer Replication](peer-to-peer-conflict-detection-in-peer-to-peer-replication.md).</span><span class="sxs-lookup"><span data-stu-id="aee28-125">For more information, see [Conflict Detection in Peer-to-Peer Replication](peer-to-peer-conflict-detection-in-peer-to-peer-replication.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="aee28-126">Чтобы избежать возможной несогласованности данных, убедитесь, что в одноранговой топологии отсутствуют конфликты, даже при включенном обнаружении конфликтов.</span><span class="sxs-lookup"><span data-stu-id="aee28-126">To avoid potential data inconsistency, make sure that you avoid conflicts in a peer-to-peer topology, even with conflict detection enabled.</span></span> <span data-ttu-id="aee28-127">Чтобы операции записи выполнялись только на одном узле, приложения, получающие доступ к данным и изменяющие их, должны секционировать операции вставки, обновления и удаления.</span><span class="sxs-lookup"><span data-stu-id="aee28-127">To ensure that write operations for a particular row are performed at only one node, applications that access and change data must partition insert, update, and delete operations.</span></span> <span data-ttu-id="aee28-128">Такое секционирование обеспечивает тот факт, что изменения конкретной строки на одном узле синхронизируются с остальными узлами в топологии, прежде чем эта строка будет изменена другим узлом.</span><span class="sxs-lookup"><span data-stu-id="aee28-128">This partitioning ensures that modifications to a given row originating at one node are synchronized with all other nodes in the topology before the row is modified by a different node.</span></span> <span data-ttu-id="aee28-129">Если приложению требуется усложненное обнаружение конфликтов, используйте репликацию слиянием.</span><span class="sxs-lookup"><span data-stu-id="aee28-129">If an application requires sophisticated conflict detection and resolution capabilities, use merge replication.</span></span> <span data-ttu-id="aee28-130">Дополнительные сведения см. в статьях [Merge Replication](../merge/merge-replication.md) (Репликация слиянием) и [Detect and Resolve Merge Replication Conflicts](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) (Обнаружение и разрешение конфликтов репликации слиянием).</span><span class="sxs-lookup"><span data-stu-id="aee28-130">For more information, see [Merge Replication](../merge/merge-replication.md) and [Detect and Resolve Merge Replication Conflicts](../merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
## <a name="peer-to-peer-topologies"></a><span data-ttu-id="aee28-131">Одноранговые топологии</span><span class="sxs-lookup"><span data-stu-id="aee28-131">Peer-to-Peer Topologies</span></span>  
 <span data-ttu-id="aee28-132">Типичные способы использования одноранговой репликации проиллюстрированы следующими сценариями.</span><span class="sxs-lookup"><span data-stu-id="aee28-132">The following scenarios illustrate typical uses for peer-to-peer replication.</span></span>  
  
### <a name="topology-that-has-two-participating-databases"></a><span data-ttu-id="aee28-133">Топология с двумя участвующими базами данных</span><span class="sxs-lookup"><span data-stu-id="aee28-133">Topology That Has Two Participating Databases</span></span>  
 <span data-ttu-id="aee28-134">![Одноранговая репликация с двумя узлами](../media/repl-multinode-01.gif "Одноранговая репликация с двумя узлами")</span><span class="sxs-lookup"><span data-stu-id="aee28-134">![Peer-to-peer replication, two nodes](../media/repl-multinode-01.gif "Peer-to-peer replication, two nodes")</span></span>  
  
 <span data-ttu-id="aee28-135">На обоих приведенных выше рисунках показаны две участвующие базы данных и пользовательский трафик, направленный к базам данных через сервер приложений.</span><span class="sxs-lookup"><span data-stu-id="aee28-135">Both of the preceding illustrations show two participating databases, with user traffic directed to the databases through an application server.</span></span> <span data-ttu-id="aee28-136">Такую конфигурацию можно использовать для различных приложений — от веб-сайтов до приложений рабочих групп. Это позволяет получить следующие преимущества.</span><span class="sxs-lookup"><span data-stu-id="aee28-136">This configuration can be used for a variety of applications, from Web sites to workgroup applications, and provides the following benefits:</span></span>  
  
-   <span data-ttu-id="aee28-137">Улучшенная производительность операции чтения, так как чтение распределено на два сервера.</span><span class="sxs-lookup"><span data-stu-id="aee28-137">Improved read performance, because reads are spread out over two servers.</span></span>  
  
-   <span data-ttu-id="aee28-138">Более высокая доступность при необходимости обслуживания или в случае сбоя одного из узлов.</span><span class="sxs-lookup"><span data-stu-id="aee28-138">Higher availability if maintenance is required or in case of failure at one node.</span></span>  
  
 <span data-ttu-id="aee28-139">На обеих иллюстрациях операция чтения между участвующими базами данных сбалансирована, но обновления обрабатываются разными способами:</span><span class="sxs-lookup"><span data-stu-id="aee28-139">In both illustrations, read activity is load-balanced between the participating databases, but updates are handled differently:</span></span>  
  
-   <span data-ttu-id="aee28-140">Слева операции обновления секционируются между двумя серверами.</span><span class="sxs-lookup"><span data-stu-id="aee28-140">On the left, updates are partitioned between the two servers.</span></span> <span data-ttu-id="aee28-141">Если база данных содержит каталог продукции, можно, например, создать пользовательское приложение, направляющее обновления продуктов, начинающихся символами с «А» до «М», на узел **A** , а обновления продуктов с «Н» до «Я» — на узел **B** .</span><span class="sxs-lookup"><span data-stu-id="aee28-141">If the database contained a product catalog, you could, for example, have a custom application direct updates to node **A** for product names that start with A through M, and direct updates to node **B** for product names that start with N through Z. Updates are then replicated to the other node.</span></span>  
  
-   <span data-ttu-id="aee28-142">Справа все обновления направляются на узел **В**. С узла В обновления реплицируются на узел **A**. Если узел **B** находится в режиме "вне сети" (например, на обслуживании), сервер приложений может направлять все операции на узел **A**. Когда узел **B** переходит в режим "в сети", на него можно направлять обновления и сервер приложений может переместить все обновления обратно на узел **B** или сохранить их передачу на узел **A**.</span><span class="sxs-lookup"><span data-stu-id="aee28-142">On the right, all updates are directed to node **B**. From there, updates are replicated to node **A**. If **B** is offline (for example, for maintenance), the application server can direct all activity to **A**. When **B** is back online, updates can flow to it, and the application server can move all updates back to **B** or keep directing them to **A**.</span></span>  
  
 <span data-ttu-id="aee28-143">Одноранговая репликация поддерживает любой из этих подходов, но основной пример обновления, показанный справа, также часто используется для стандартной репликации транзакций.</span><span class="sxs-lookup"><span data-stu-id="aee28-143">Peer-to-peer replication can support either approach, but the central update example on the right is also often used with standard transactional replication.</span></span>  
  
### <a name="topologies-that-have-three-or-more-participating-databases"></a><span data-ttu-id="aee28-144">Топологии с тремя или более участвующими базами данных</span><span class="sxs-lookup"><span data-stu-id="aee28-144">Topologies That Have Three or More Participating Databases</span></span>  
 <span data-ttu-id="aee28-145">![Одноранговая репликация в распределенные места назначения](../media/repl-multinode-02.gif "Одноранговая репликация в распределенные места назначения")</span><span class="sxs-lookup"><span data-stu-id="aee28-145">![Peer-to-peer replication to dispersed locations](../media/repl-multinode-02.gif "Peer-to-peer replication to dispersed locations")</span></span>  
  
 <span data-ttu-id="aee28-146">На предыдущем рисунке показаны три участвующие базы данных, предоставляющие данные для глобальной организации по поддержке программного обеспечения с офисами в Лос-Анджелесе, Лондоне и Тайбэе.</span><span class="sxs-lookup"><span data-stu-id="aee28-146">The preceding illustration shows three participating databases that provide data for a worldwide software support organization, with offices in Los Angeles, London, and Taipei.</span></span> <span data-ttu-id="aee28-147">Инженеры службы поддержки во всех офисах принимают звонки клиентов, вводят и обновляют сведения о каждом звонке.</span><span class="sxs-lookup"><span data-stu-id="aee28-147">The support engineers at each office take customer calls and enter and update information about each customer call.</span></span> <span data-ttu-id="aee28-148">Часовые пояса трех офисов отличаются на восемь часов, поэтому рабочие часы не перекрываются.</span><span class="sxs-lookup"><span data-stu-id="aee28-148">The time zones for the three offices are eight hours apart, so there is no overlap in the workday.</span></span> <span data-ttu-id="aee28-149">Когда закрывается офис в Тайбэе, открывается офис в Лондоне.</span><span class="sxs-lookup"><span data-stu-id="aee28-149">As the Taipei office closes, the London office is opening for the day.</span></span> <span data-ttu-id="aee28-150">Если звонок находится в стадии обработки во время закрытия одного офиса, он передается представителю в другой открытый офис.</span><span class="sxs-lookup"><span data-stu-id="aee28-150">If a call is still in progress as one office is closing, the call is transferred to a representative at the next office to open.</span></span>  
  
 <span data-ttu-id="aee28-151">В каждом офисе имеется база данных и сервер приложений, которые используются инженерами службы поддержки для ввода и обновления сведений о звонках клиентов.</span><span class="sxs-lookup"><span data-stu-id="aee28-151">Each location has a database and an application server, which are used by the support engineers as they enter and update information about customer calls.</span></span> <span data-ttu-id="aee28-152">Топология секционируется по времени.</span><span class="sxs-lookup"><span data-stu-id="aee28-152">The topology is partitioned by time.</span></span> <span data-ttu-id="aee28-153">Поэтому обновления происходят на узле, открытом для бизнеса в текущее время, а затем передаются в другие участвующие базы данных.</span><span class="sxs-lookup"><span data-stu-id="aee28-153">Therefore, updates occur only at the node that is currently open for business, and then the updates flow to the other participating databases.</span></span> <span data-ttu-id="aee28-154">Данная топология обеспечивает следующие преимущества:</span><span class="sxs-lookup"><span data-stu-id="aee28-154">This topology provides the following benefits:</span></span>  
  
-   <span data-ttu-id="aee28-155">Независимость без изоляции: в каждом офисе можно независимо добавлять, обновлять или удалять данные; при этом также можно использовать данные совместно, так как они реплицируются во все участвующие базы данных.</span><span class="sxs-lookup"><span data-stu-id="aee28-155">Independence without isolation: Each office can insert, update, or delete data independently but can also share the data because it is replicated to all other participating databases.</span></span>  
  
-   <span data-ttu-id="aee28-156">Более высокая доступность в случае сбоя или во время обслуживания одной или нескольких участвующих баз данных.</span><span class="sxs-lookup"><span data-stu-id="aee28-156">Higher availability in case of failure or to allow maintenance at one or more of the participating databases.</span></span>  
  
     <span data-ttu-id="aee28-157">![Одноранговая репликация с тремя-четырьмя узлами](../media/repl-multinode-04.gif "Одноранговая репликация с тремя-четырьмя узлами")</span><span class="sxs-lookup"><span data-stu-id="aee28-157">![Peer-to-peer replication, three and four nodes](../media/repl-multinode-04.gif "Peer-to-peer replication, three and four nodes")</span></span>  
  
 <span data-ttu-id="aee28-158">На предыдущем рисунке показано добавление узла в топологию с тремя узлами.</span><span class="sxs-lookup"><span data-stu-id="aee28-158">The preceding illustration shows the addition of a node to the three-node topology.</span></span> <span data-ttu-id="aee28-159">В этом сценарии узел можно добавить по следующим причинам.</span><span class="sxs-lookup"><span data-stu-id="aee28-159">A node could be added in this scenario for the following reasons:</span></span>  
  
-   <span data-ttu-id="aee28-160">Так как другой офис открыт.</span><span class="sxs-lookup"><span data-stu-id="aee28-160">Because another office is opened.</span></span>  
  
-   <span data-ttu-id="aee28-161">Чтобы обеспечить более высокую доступность в целях поддержки обслуживания или повышения отказоустойчивости при сбое диска или других серьезных неисправностях.</span><span class="sxs-lookup"><span data-stu-id="aee28-161">To provide higher availability to support maintenance or increase fault tolerance if a disk failure or other major failure occurs.</span></span>  
  
 <span data-ttu-id="aee28-162">Обратите внимание, что в обеих трех- и четырехузловых топологиях все базы данных публикуют свои данные и подписываются на данные из остальных баз данных.</span><span class="sxs-lookup"><span data-stu-id="aee28-162">Notice that in both the three- and four-node topologies, all databases publish and subscribe to all other databases.</span></span> <span data-ttu-id="aee28-163">Этим обеспечивается максимальная доступность при проведении обслуживания или в случае сбоя на одном или нескольких узлах.</span><span class="sxs-lookup"><span data-stu-id="aee28-163">This provides maximum availability in case of maintenance needs or failure of one or more nodes.</span></span> <span data-ttu-id="aee28-164">По мере добавления узлов необходимо соблюдать баланс между доступностью и масштабируемостью с одной стороны и производительностью, сложностью развертывания и администрирования с другой стороны.</span><span class="sxs-lookup"><span data-stu-id="aee28-164">As nodes are added, you must balance availability and scalability needs against performance and the complexity of deployment and administration.</span></span>  
  
## <a name="configuring-peer-to-peer-replication"></a><span data-ttu-id="aee28-165">Настройка одноранговой репликации</span><span class="sxs-lookup"><span data-stu-id="aee28-165">Configuring Peer-to-Peer Replication</span></span>  
 <span data-ttu-id="aee28-166">Настройка топологии одноранговой репликации очень похожа на настройку серии стандартных публикаций и подписок транзакций.</span><span class="sxs-lookup"><span data-stu-id="aee28-166">Configuring a peer-to-peer replication topology is very similar to configuring a series of standard transactional publications and subscriptions.</span></span> <span data-ttu-id="aee28-167">В следующих разделах показан процесс настройки системы из трех узлов, аналогичной конфигурации с одноранговой топологией, которая представлена выше на рисунке слева.</span><span class="sxs-lookup"><span data-stu-id="aee28-167">The steps described in the following topics show the configuration of a three-node system, similar to the configuration shown on the left in the previous illustration that shows peer-to-peer topology.</span></span>  
  
## <a name="considerations-for-using-peer-to-peer-replication"></a><span data-ttu-id="aee28-168">Вопросы использования одноранговой репликации</span><span class="sxs-lookup"><span data-stu-id="aee28-168">Considerations for Using Peer-to-Peer Replication</span></span>  
 <span data-ttu-id="aee28-169">В этом разделе представлены сведения и рекомендации по использованию одноранговой репликации.</span><span class="sxs-lookup"><span data-stu-id="aee28-169">This section provides information and guidelines to consider when you use peer-to-peer replication.</span></span>  
  
### <a name="general-considerations"></a><span data-ttu-id="aee28-170">Общие рекомендации</span><span class="sxs-lookup"><span data-stu-id="aee28-170">General Considerations</span></span>  
  
-   <span data-ttu-id="aee28-171">Одноранговая репликация доступна только в выпусках [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Enterprise.</span><span class="sxs-lookup"><span data-stu-id="aee28-171">Peer-to-peer replication is available only in Enterprise versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="aee28-172">Все базы данных, участвующие в одноранговой репликации, должны содержать идентичные схемы и данные.</span><span class="sxs-lookup"><span data-stu-id="aee28-172">All databases that participate in peer-to-peer replication should contain identical schema and data:</span></span>  
  
    -   <span data-ttu-id="aee28-173">Имена объектов, схемы объектов и публикаций должны быть идентичными.</span><span class="sxs-lookup"><span data-stu-id="aee28-173">Object names, object schema, and publication names should be identical.</span></span>  
  
    -   <span data-ttu-id="aee28-174">Публикации для реплицирования должны разрешать изменения схемы.</span><span class="sxs-lookup"><span data-stu-id="aee28-174">Publications must allow schema changes to be replicated.</span></span> <span data-ttu-id="aee28-175">(То есть свойство публикации **replicate_ddl** должно иметь значение **1**, которое является значением по умолчанию.) Дополнительные сведения см. в статье [Внесение изменений в схемы баз данных публикации](../publish/make-schema-changes-on-publication-databases.md).</span><span class="sxs-lookup"><span data-stu-id="aee28-175">(This is a setting of **1** for the publication property **replicate_ddl**, which is the default setting.) For more information, see [Make Schema Changes on Publication Databases](../publish/make-schema-changes-on-publication-databases.md).</span></span>  
  
    -   <span data-ttu-id="aee28-176">Фильтрация строк и столбцов не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="aee28-176">Row and column filtering are not supported.</span></span>  
  
-   <span data-ttu-id="aee28-177">Рекомендуется на каждом узле использовать собственную базу данных распространителя.</span><span class="sxs-lookup"><span data-stu-id="aee28-177">We recommend that each node use its own distribution database.</span></span> <span data-ttu-id="aee28-178">Это исключит возможность образования одной точки сбоя.</span><span class="sxs-lookup"><span data-stu-id="aee28-178">This eliminates the potential of having a single point of failure.</span></span>  
  
-   <span data-ttu-id="aee28-179">Таблицы и другие объекты нельзя включать в несколько одноранговых публикаций в отдельной базе данных публикации.</span><span class="sxs-lookup"><span data-stu-id="aee28-179">Tables and other objects cannot be included in multiple peer-to-peer publications in a single publication database.</span></span>  
  
-   <span data-ttu-id="aee28-180">Публикация должна быть доступна для одноранговой репликации до создания подписок.</span><span class="sxs-lookup"><span data-stu-id="aee28-180">A publication must be enabled for peer-to-peer replication before any subscriptions are created.</span></span>  
  
-   <span data-ttu-id="aee28-181">Подписки должны быть инициализированы с помощью резервного копирования или параметра **только поддержка репликации** .</span><span class="sxs-lookup"><span data-stu-id="aee28-181">Subscriptions must be initialized by using a backup or with the **'replication support only'** option.</span></span> <span data-ttu-id="aee28-182">Дополнительные сведения см. в статье [Инициализация подписки на публикацию транзакций без моментального снимка](../initialize-a-transactional-subscription-without-a-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="aee28-182">For more information, see [Initialize a Transactional Subscription Without a Snapshot](../initialize-a-transactional-subscription-without-a-snapshot.md).</span></span>  
  
-   <span data-ttu-id="aee28-183">Не рекомендуется использовать столбцы идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="aee28-183">We do not recommend the use of identity columns.</span></span> <span data-ttu-id="aee28-184">При использовании идентификаторов необходимо вручную управлять диапазонами, назначенными таблицам, в каждой участвующей базе данных.</span><span class="sxs-lookup"><span data-stu-id="aee28-184">When using identities, you must manually manage the ranges assigned to the tables at each participating database.</span></span> <span data-ttu-id="aee28-185">Дополнительные сведения см. в разделе "Назначение диапазонов для управления диапазонами идентификаторов вручную" статьи [Replicate Identity Columns](../publish/replicate-identity-columns.md) (Репликация столбцов идентификаторов).</span><span class="sxs-lookup"><span data-stu-id="aee28-185">For more information, see the section "Assigning Ranges for Manual Identity Range Management" in [Replicate Identity Columns](../publish/replicate-identity-columns.md).</span></span>  
  
### <a name="feature-restrictions"></a><span data-ttu-id="aee28-186">Функциональные ограничения</span><span class="sxs-lookup"><span data-stu-id="aee28-186">Feature Restrictions</span></span>  
 <span data-ttu-id="aee28-187">Одноранговая репликация поддерживает ключевые свойства репликации транзакций, но не поддерживает следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="aee28-187">Peer-to-peer replication supports the core features of transactional replication, but does not support the following options:</span></span>  
  
-   <span data-ttu-id="aee28-188">Инициация и повторная инициация с помощью моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="aee28-188">Initialization and reinitialization with a snapshot.</span></span>  
  
-   <span data-ttu-id="aee28-189">Фильтрация строк и столбцов.</span><span class="sxs-lookup"><span data-stu-id="aee28-189">Row and column filters.</span></span>  
  
-   <span data-ttu-id="aee28-190">Столбцы отметок времени.</span><span class="sxs-lookup"><span data-stu-id="aee28-190">Timestamp columns.</span></span>  
  
-   <span data-ttu-id="aee28-191">Издатели и подписчики, отличные от[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="aee28-191">Non-[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publishers and Subscribers.</span></span>  
  
-   <span data-ttu-id="aee28-192">Немедленно обновляемые подписки и подписки, обновляемые посредством очередей.</span><span class="sxs-lookup"><span data-stu-id="aee28-192">Immediate updating and queued updating subscriptions.</span></span>  
  
-   <span data-ttu-id="aee28-193">Анонимные подписки.</span><span class="sxs-lookup"><span data-stu-id="aee28-193">Anonymous subscriptions.</span></span>  
  
-   <span data-ttu-id="aee28-194">Частичные подписки.</span><span class="sxs-lookup"><span data-stu-id="aee28-194">Partial subscriptions.</span></span>  
  
-   <span data-ttu-id="aee28-195">Присоединяемые подписки и трансформируемые подписки.</span><span class="sxs-lookup"><span data-stu-id="aee28-195">Attachable subscriptions and transformable subscriptions.</span></span> <span data-ttu-id="aee28-196">(Оба параметра устарели, начиная с версии [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="aee28-196">(Both of these options were deprecated in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].)</span></span>  
  
-   <span data-ttu-id="aee28-197">Общие агенты распространителя.</span><span class="sxs-lookup"><span data-stu-id="aee28-197">Shared Distribution Agents.</span></span>  
  
-   <span data-ttu-id="aee28-198">Параметр агента распространителя **-SubscriptionStreams** и параметр агента чтения журнала **-MaxCmdsInTran**.</span><span class="sxs-lookup"><span data-stu-id="aee28-198">The Distribution Agent parameter **-SubscriptionStreams** and the Log Reader Agent parameter **-MaxCmdsInTran**.</span></span>  
  
-   <span data-ttu-id="aee28-199">Свойства статьи \*\* \@ destination_owner\*\* и \*\* \@ destination_table\*\*.</span><span class="sxs-lookup"><span data-stu-id="aee28-199">The article properties **\@destination_owner** and **\@destination_table**.</span></span>  

-   <span data-ttu-id="aee28-200">Одноранговая репликация транзакций не поддерживает создание односторонней транзакционной подписки на одноранговые публикации.</span><span class="sxs-lookup"><span data-stu-id="aee28-200">Peer-to-Peer transactional replication does not support creating a one-way transactional subscription to a Peer-to-Peer publication</span></span>
  
 <span data-ttu-id="aee28-201">Следующие свойства имеют особые соглашения.</span><span class="sxs-lookup"><span data-stu-id="aee28-201">The following properties have special considerations:</span></span>  
  
-   <span data-ttu-id="aee28-202">Для свойства публикации \*\* \@ allow_initialize_from_backup\*\* требуется значение `true` .</span><span class="sxs-lookup"><span data-stu-id="aee28-202">The publication property **\@allow_initialize_from_backup** requires a value of `true`.</span></span>  
  
-   <span data-ttu-id="aee28-203">Для свойства статьи \*\* \@ replicate_ddl\*\* требуется значение `true` ; для \*\* \@ identityrangemanagementoption\*\* требуется значение `manual` ; для и \*\* \@ состояния\*\* требуется задать параметр **24** .</span><span class="sxs-lookup"><span data-stu-id="aee28-203">The article property **\@replicate_ddl** requires a value of `true`; **\@identityrangemanagementoption** requires a value of `manual`; and **\@status** requires that option **24** is set.</span></span>  
  
-   <span data-ttu-id="aee28-204">Значение свойств статьи \*\* \@ ins_cmd**, \*\* \@ del_cmd**и \*\* \@ upd_cmd\*\* не может быть задано равным `SQL` .</span><span class="sxs-lookup"><span data-stu-id="aee28-204">The value for article properties **\@ins_cmd**, **\@del_cmd**, and **\@upd_cmd** cannot be set to `SQL`.</span></span>  
  
-   <span data-ttu-id="aee28-205">Для свойства подписки \*\* \@ sync_type\*\* требуется значение `none` или `automatic` .</span><span class="sxs-lookup"><span data-stu-id="aee28-205">The subscription property **\@sync_type** requires a value of `none` or `automatic`.</span></span>  
  
### <a name="maintenance-considerations"></a><span data-ttu-id="aee28-206">Вопросы обслуживания</span><span class="sxs-lookup"><span data-stu-id="aee28-206">Maintenance Considerations</span></span>  
 <span data-ttu-id="aee28-207">Следующие операции требуют приостановки системы.</span><span class="sxs-lookup"><span data-stu-id="aee28-207">The following actions require the system to be quiesced.</span></span> <span data-ttu-id="aee28-208">Это подразумевает остановку действий в опубликованных таблицах на всех узлах и проверку получения изменений на каждом узле.</span><span class="sxs-lookup"><span data-stu-id="aee28-208">This means stopping activity on published tables at all nodes and making sure that each node has received all changes from all other nodes.</span></span>  
  
-   <span data-ttu-id="aee28-209">Добавление [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] узла в существующую топологию</span><span class="sxs-lookup"><span data-stu-id="aee28-209">Adding a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] node to an existing topology</span></span>  
  
-   <span data-ttu-id="aee28-210">Добавление статьи к существующей публикации</span><span class="sxs-lookup"><span data-stu-id="aee28-210">Adding an article to an existing publication</span></span>  
  
-   <span data-ttu-id="aee28-211">Изменения схемы</span><span class="sxs-lookup"><span data-stu-id="aee28-211">Making schema changes</span></span>  
  
-   <span data-ttu-id="aee28-212">Восстановление узла из резервной копии</span><span class="sxs-lookup"><span data-stu-id="aee28-212">Restoring a node from a backup</span></span>  
  
 <span data-ttu-id="aee28-213">Дополнительные сведения см. в статье [Заморозка топологии репликации (программирование репликации на языке Transact-SQL)](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md) и [Администрирование одноранговой топологии (программирование репликации на языке Transact-SQL)](../administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="aee28-213">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md) and [Administer a Peer-to-Peer Topology &#40;Replication Transact-SQL Programming&#41;](../administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md).</span></span>  
  
-   <span data-ttu-id="aee28-214">Если к одноранговой топологии добавлен новый узел, восстановление необходимо выполнять только из резервных копий, созданных после добавления нового узла.</span><span class="sxs-lookup"><span data-stu-id="aee28-214">If you add a new node to a peer-to-peer topology, you should restore only from backups that were created after the new node was added.</span></span>  
  
-   <span data-ttu-id="aee28-215">Повторно инициализировать подписки в одноранговой топологии нельзя.</span><span class="sxs-lookup"><span data-stu-id="aee28-215">You cannot reinitialize subscriptions in a peer-to-peer topology.</span></span> <span data-ttu-id="aee28-216">Если нужно убедиться в том, что узел имеет новую копию данных, восстановите резервную копию на этом узле.</span><span class="sxs-lookup"><span data-stu-id="aee28-216">If you have to ensure that a node has a new copy of the data, restore a backup at the node.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aee28-217">См. также:</span><span class="sxs-lookup"><span data-stu-id="aee28-217">See Also</span></span>  
 <span data-ttu-id="aee28-218">[Администрирование одноранговой топологии (программирование репликации на языке Transact-SQL)](../administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) </span><span class="sxs-lookup"><span data-stu-id="aee28-218">[Administer a Peer-to-Peer Topology &#40;Replication Transact-SQL Programming&#41;](../administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) </span></span>  
 <span data-ttu-id="aee28-219">[Стратегии архивации и восстановления из копии репликации моментальных снимков и репликации транзакций](../administration/strategies-for-backing-up-and-restoring-snapshot-and-transactional-replication.md) </span><span class="sxs-lookup"><span data-stu-id="aee28-219">[Strategies for Backing Up and Restoring Snapshot and Transactional Replication](../administration/strategies-for-backing-up-and-restoring-snapshot-and-transactional-replication.md) </span></span>  
 [<span data-ttu-id="aee28-220">Типы публикации для репликации транзакций</span><span class="sxs-lookup"><span data-stu-id="aee28-220">Publication Types for Transactional Replication</span></span>](transactional-replication.md)  
  
  
