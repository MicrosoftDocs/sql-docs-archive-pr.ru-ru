---
title: Обновляемые подписки для репликации транзакций | Документация Майкрософт
ms.custom: ''
ms.date: 03/31/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- transactional replication, updatable subscriptions
- updatable subscriptions, about updatable subscriptions
- queued updating subscriptions [SQL Server replication]
- immediate updating subscriptions
- subscriptions [SQL Server replication], updatable
- updatable subscriptions
ms.assetid: 8eec95cb-3a11-436e-bcee-bdcd05aa5c5a
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e0b739ffe34a14519ff5290c406805ff7715edce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668754"
---
# <a name="updatable-subscriptions-for-transactional-replication"></a><span data-ttu-id="dd74e-102">Updatable Subscriptions for Transactional Replication</span><span class="sxs-lookup"><span data-stu-id="dd74e-102">Updatable Subscriptions for Transactional Replication</span></span>

<span data-ttu-id="dd74e-103">**Применимо к:** SQL Server 2008 (и более поздние версии)</span><span class="sxs-lookup"><span data-stu-id="dd74e-103">**Applies to:** SQL Server 2008 (and later)</span></span>

    
> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
<span data-ttu-id="dd74e-104">В SQL Server 2014 репликация транзакций поддерживает обновления на подписчиках через обновляемые подписки и одноранговую репликацию.</span><span class="sxs-lookup"><span data-stu-id="dd74e-104">In SQL Server 2014, transactional replication supports updates at Subscribers through updatable subscriptions and peer-to-peer replication.</span></span> <span data-ttu-id="dd74e-105">Существуют два типа обновляемых подписок:</span><span class="sxs-lookup"><span data-stu-id="dd74e-105">The following are the two types of updatable subscriptions:</span></span>  
  
-   <span data-ttu-id="dd74e-106">Немедленное обновление.</span><span class="sxs-lookup"><span data-stu-id="dd74e-106">Immediate updating.</span></span> <span data-ttu-id="dd74e-107">Для обновления данных на подписчике должны быть подключены и издатель, и подписчик.</span><span class="sxs-lookup"><span data-stu-id="dd74e-107">The Publisher and Subscriber must be connected to update data at the Subscriber.</span></span>  
  
-   <span data-ttu-id="dd74e-108">Отложенное обновление. Для обновления данных на подписчике подключение издателя и подписчика не требуется.</span><span class="sxs-lookup"><span data-stu-id="dd74e-108">Queued updating The Publisher and Subscriber do not have to be connected to update data at the Subscriber.</span></span> <span data-ttu-id="dd74e-109">Обновления могут быть выполнены в режиме «вне сети» работы подписчика или издателя.</span><span class="sxs-lookup"><span data-stu-id="dd74e-109">Updates can be made while the Subscriber or Publisher is offline.</span></span>  
  
 <span data-ttu-id="dd74e-110">При обновлении данных на подписчике обновление сначала распространяется на издатель, а затем распространяется на другие подписчики.</span><span class="sxs-lookup"><span data-stu-id="dd74e-110">When data is updated at a Subscriber, it is first propagated to the Publisher and then propagated to other Subscribers.</span></span> <span data-ttu-id="dd74e-111">При использовании немедленного обновления изменения распространяются немедленно с использованием протокола двухэтапного фиксирования.</span><span class="sxs-lookup"><span data-stu-id="dd74e-111">If immediate updating is used, the changes are propagated immediately using the two-phase commit protocol.</span></span> <span data-ttu-id="dd74e-112">При использовании отложенного обновления изменения хранятся в очереди; затем транзакции, находящиеся в очереди, применяются асинхронно на издателе всякий раз, когда доступны необходимые сетевые подключения.</span><span class="sxs-lookup"><span data-stu-id="dd74e-112">If queued updating is used, the changes are stored in a queue; the queued transactions are then applied asynchronously at the Publisher whenever network connectivity is available.</span></span> <span data-ttu-id="dd74e-113">Поскольку обновления распространяются на издатель асинхронно, одни и те же данные могут быть обновлены издателем или другим подписчиком, поэтому при применении обновлений могут возникать конфликты.</span><span class="sxs-lookup"><span data-stu-id="dd74e-113">Because the updates are propagated asynchronously to the Publisher, the same data may have been updated by the Publisher or by another Subscriber and conflicts can occur when applying the updates.</span></span> <span data-ttu-id="dd74e-114">Конфликты обнаруживаются и разрешаются согласно политике разрешения конфликтов, которая устанавливается при создании публикации.</span><span class="sxs-lookup"><span data-stu-id="dd74e-114">Conflicts are detected and resolved according to a conflict resolution policy that is set when creating the publication.</span></span>  
  
 <span data-ttu-id="dd74e-115">Если создается публикация транзакций с помощью обновляемых подписок в мастере создания публикаций, активизируется как немедленное обновление, так и отложенное обновление.</span><span class="sxs-lookup"><span data-stu-id="dd74e-115">If you create a transactional publication with updatable subscriptions in the New Publication Wizard, both immediate updating and queued updating are enabled.</span></span> <span data-ttu-id="dd74e-116">Если создается публикация с помощью хранимых процедур, можно включить один или оба режима обновления.</span><span class="sxs-lookup"><span data-stu-id="dd74e-116">If you create a publication with stored procedures, you can enable one or both options.</span></span> <span data-ttu-id="dd74e-117">Когда создается подписка на публикацию, указывается используемый режим обновления.</span><span class="sxs-lookup"><span data-stu-id="dd74e-117">When you create a subscription to the publication, you specify which update mode to use.</span></span> <span data-ttu-id="dd74e-118">В случае необходимости можно переключать режимы обновления.</span><span class="sxs-lookup"><span data-stu-id="dd74e-118">You can then switch between update modes if necessary.</span></span> <span data-ttu-id="dd74e-119">Дополнительные сведения см. в следующем разделе «Переключение режимов обновления».</span><span class="sxs-lookup"><span data-stu-id="dd74e-119">For more information, see the following section "Switching between Update Modes".</span></span>  
  
 <span data-ttu-id="dd74e-120">Включение обновляемых подписок для публикаций транзакций — [Enable Updating Subscriptions for Transactional Publications](../publish/enable-updating-subscriptions-for-transactional-publications.md)</span><span class="sxs-lookup"><span data-stu-id="dd74e-120">To enable updatable subscriptions for transactional publications, [Enable Updating Subscriptions for Transactional Publications](../publish/enable-updating-subscriptions-for-transactional-publications.md)</span></span>  
  
 <span data-ttu-id="dd74e-121">Создание обновляемых подписок для публикаций транзакций — [Create an Updatable Subscription to a Transactional Publication](../publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span><span class="sxs-lookup"><span data-stu-id="dd74e-121">To create updatable subscriptions for transactional publications, see [Create an Updatable Subscription to a Transactional Publication](../publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span></span>  
  
## <a name="switching-between-update-modes"></a><span data-ttu-id="dd74e-122">Переключение режимов обновления</span><span class="sxs-lookup"><span data-stu-id="dd74e-122">Switching Between Update Modes</span></span>  
 <span data-ttu-id="dd74e-123">При применении обновляемых подписок можно указать, что подписка должна использовать один режим обновления, а затем можно переключиться на другой режим обновления, если это необходимо для приложения.</span><span class="sxs-lookup"><span data-stu-id="dd74e-123">When using updatable subscriptions you can specify that a subscription should use one update mode and then switch to the other if the application requires it.</span></span> <span data-ttu-id="dd74e-124">Например, можно указать, что подписка должна использовать немедленное обновление, а затем переключиться на отложенное обновление, если ошибка системы привела к потере сетевого подключения.</span><span class="sxs-lookup"><span data-stu-id="dd74e-124">For example, you can specify that a subscription should use immediate updating, but switch to queued updating if a system failure results in the loss of network connectivity.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="dd74e-125">Репликация не переключает режимы обновления автоматически.</span><span class="sxs-lookup"><span data-stu-id="dd74e-125">Replication does not switch automatically between update modes.</span></span> <span data-ttu-id="dd74e-126">Режим обновления можно установить через среду SQL Server Management Studio, либо ваше приложение должно вызвать хранимую процедуру [sp_setreplfailovermode &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setreplfailovermode-transact-sql) для переключения режимов обновления.</span><span class="sxs-lookup"><span data-stu-id="dd74e-126">You must set the update mode through SQL Server Management Studio or your application must call [sp_setreplfailovermode &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setreplfailovermode-transact-sql) to switch between modes.</span></span>  
  
 <span data-ttu-id="dd74e-127">Если переключитесь с немедленного обновления на отложенное обновление, то вам не удастся переключиться обратно на немедленное обновление, пока подписчик и издатель не подключатся, а агент чтения очереди не применит все сообщения, находящиеся в очереди, к издателю.</span><span class="sxs-lookup"><span data-stu-id="dd74e-127">If you switch from immediate updating to queued updating, you cannot switch back to immediate updating until the Subscriber and Publisher are connected and the Queue Reader Agent has applied all pending messages in the queue to the Publisher.</span></span>  
  
 <span data-ttu-id="dd74e-128">**Переключение режимов обновления**</span><span class="sxs-lookup"><span data-stu-id="dd74e-128">**To switch between update modes**</span></span>  
  
 <span data-ttu-id="dd74e-129">Для переключения между режимами обновления необходимо разрешить оба режима обновления для публикации и подписки, а затем можно переключаться между режимами по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="dd74e-129">To switch between updating modes, you must enable the publication and subscription for both update modes, and then switch between them if necessary.</span></span> <span data-ttu-id="dd74e-130">Дополнительные сведения см. в разделе</span><span class="sxs-lookup"><span data-stu-id="dd74e-130">For more information, see</span></span>  
<span data-ttu-id="dd74e-131">[Переключение между режимами обновления для обновляемой подписки на публикацию транзакций](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="dd74e-131">[Switch Between Update Modes for an Updatable Transactional Subscription](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span></span>  
  
### <a name="considerations-for-using-updatable-subscriptions"></a><span data-ttu-id="dd74e-132">Вопросы использования обновляемых подписок</span><span class="sxs-lookup"><span data-stu-id="dd74e-132">Considerations for Using Updatable Subscriptions</span></span>  
  
-   <span data-ttu-id="dd74e-133">После активизации для публикации обновляемых подписок или очереди обновляемых подписок данный параметр нельзя отключить для публикации (несмотря на то, что для подписок этот параметр не нужен).</span><span class="sxs-lookup"><span data-stu-id="dd74e-133">After a publication is enabled for updating subscriptions or queued updating subscriptions, the option cannot be disabled for the publication (although subscriptions do not need to use it).</span></span> <span data-ttu-id="dd74e-134">Чтобы отключить параметр, публикацию следует удалить и создать новую публикацию.</span><span class="sxs-lookup"><span data-stu-id="dd74e-134">To disable the option, the publication must be deleted and a new one created.</span></span>  
  
-   <span data-ttu-id="dd74e-135">Повторная публикация данных не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="dd74e-135">Republishing data is not supported.</span></span>  
  
-   <span data-ttu-id="dd74e-136">Репликация добавляет столбец **msrepl_tran_version** в публикуемые таблицы для отслеживания.</span><span class="sxs-lookup"><span data-stu-id="dd74e-136">Replication adds the **msrepl_tran_version** column to published tables for tracking purposes.</span></span> <span data-ttu-id="dd74e-137">Из-за этого дополнительного столбца все инструкции `INSERT` должны содержать список столбцов.</span><span class="sxs-lookup"><span data-stu-id="dd74e-137">Because of this additional column, all `INSERT` statements should include a column list.</span></span>  
  
-   <span data-ttu-id="dd74e-138">Для внесения изменений схемы в таблицу публикации, поддерживающей обновляемые подписки, необходимо остановить все действия в этой таблице на издателе и подписчиках, а отложенные изменения данных должны быть распространены на все узлы до внесения каких-либо изменений схемы.</span><span class="sxs-lookup"><span data-stu-id="dd74e-138">To make schema changes on a table in a publication that supports updating subscriptions, all activity on the table must be stopped at the Publisher and Subscribers, and pending data changes must be propagated to all nodes before making any schema changes.</span></span> <span data-ttu-id="dd74e-139">Это гарантирует отсутствие конфликтов невыполненных транзакций с отложенным изменением схемы.</span><span class="sxs-lookup"><span data-stu-id="dd74e-139">This ensures that outstanding transactions do not conflict with the pending schema change.</span></span> <span data-ttu-id="dd74e-140">После распространения изменений схемы на все узлы можно возобновить действия в опубликованных таблицах.</span><span class="sxs-lookup"><span data-stu-id="dd74e-140">After the schema changes have propagated to all nodes, activity can resume on the published tables.</span></span> <span data-ttu-id="dd74e-141">Дополнительные сведения см. в разделе [Замораживание топологии репликации (программирование репликации на языке Transact-SQL)](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="dd74e-141">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
-   <span data-ttu-id="dd74e-142">Если планируется переключаться между режимами обновления, агент чтения очереди должен быть запущен, по крайней мере, один раз после инициализации подписки (по умолчанию агент чтения очереди работает непрерывно).</span><span class="sxs-lookup"><span data-stu-id="dd74e-142">If you plan to switch between update modes, the Queue Reader Agent must run at least once after the subscription has been initialized (by default, the Queue Reader Agent runs continuously).</span></span>  
  
-   <span data-ttu-id="dd74e-143">Если база данных подписчика секционирована горизонтально и в секции есть строки, существующие на подписчике, но отсутствующие на издателе, подписчик не сможет обновить строки, существовавшие ранее.</span><span class="sxs-lookup"><span data-stu-id="dd74e-143">If the Subscriber database is partitioned horizontally and there are rows in the partition that exist at the Subscriber, but not at the Publisher, the Subscriber cannot update the preexisting rows.</span></span> <span data-ttu-id="dd74e-144">При попытке обновить эти строки возвращается ошибка.</span><span class="sxs-lookup"><span data-stu-id="dd74e-144">Attempting to update these rows returns an error.</span></span> <span data-ttu-id="dd74e-145">Данные строки должны быть удалены из таблицы и затем добавлены на издателе.</span><span class="sxs-lookup"><span data-stu-id="dd74e-145">The rows should be deleted from the table and then added at the Publisher.</span></span>  
  
### <a name="updates-at-the-subscriber"></a><span data-ttu-id="dd74e-146">Обновления на подписчике</span><span class="sxs-lookup"><span data-stu-id="dd74e-146">Updates at the Subscriber</span></span>  
  
-   <span data-ttu-id="dd74e-147">Обновления на подписчике распространяются на издатель, даже если срок подписки истек или подписка неактивна.</span><span class="sxs-lookup"><span data-stu-id="dd74e-147">Updates at the Subscriber are propagated to the Publisher even if a subscription is expired or is inactive.</span></span> <span data-ttu-id="dd74e-148">Убедитесь, что все такие подписки либо удалены, либо инициализированы повторно.</span><span class="sxs-lookup"><span data-stu-id="dd74e-148">Ensure that any such subscriptions are either dropped or reinitialized.</span></span>  
  
-   <span data-ttu-id="dd74e-149">Если используются столбцы `TIMESTAMP` или `IDENTITY` и они реплицируются как их базовые типы данных, значения в этих столбцах не должны обновляться на подписчике.</span><span class="sxs-lookup"><span data-stu-id="dd74e-149">If `TIMESTAMP` or `IDENTITY` columns are used, and they are replicated as their base data types, values in these columns should not be updated at the Subscriber.</span></span>  
  
-   <span data-ttu-id="dd74e-150">Подписчики не могут обновлять или вставлять значения `text`, `ntext` или `image`, поскольку невозможно выполнить считывание из вставленных или удаленных таблиц внутри триггеров, отслеживающих изменения репликации.</span><span class="sxs-lookup"><span data-stu-id="dd74e-150">Subscribers cannot update or insert `text`, `ntext` or `image` values because it is not possible to read from the inserted or deleted tables inside the replication change-tracking triggers.</span></span> <span data-ttu-id="dd74e-151">Аналогично подписчики не могут обновлять или вставлять значения `text` или `image` с помощью `WRITETEXT` или `UPDATETEXT`, поскольку данные перезаписываются издателем.</span><span class="sxs-lookup"><span data-stu-id="dd74e-151">Similarly, Subscribers cannot update or insert `text` or `image` values using `WRITETEXT` or `UPDATETEXT` because the data is overwritten by the Publisher.</span></span> <span data-ttu-id="dd74e-152">Вместо этого можно секционировать столбцы `text` и `image` в отдельную таблицу и изменить две таблицы в пределах транзакции.</span><span class="sxs-lookup"><span data-stu-id="dd74e-152">Instead, you could partition the `text` and `image` columns into a separate table and modify the two tables within a transaction.</span></span>  
  
     <span data-ttu-id="dd74e-153">Чтобы обновить большие объекты на подписчике, используйте типы данных `varchar(max)`, `nvarchar(max)` и `varbinary(max)` вместо типов данных `text`, `ntext` и `image` соответственно.</span><span class="sxs-lookup"><span data-stu-id="dd74e-153">To update large objects at a Subscriber, use the data types `varchar(max)`, `nvarchar(max)`, `varbinary(max)` instead of `text`, `ntext`, and `image` data types, respectively.</span></span>  
  
-   <span data-ttu-id="dd74e-154">Обновления уникальных ключей (включая первичные ключи), создающие дубликаты (например, обновление вида `UPDATE <column> SET <column> =<column>+1` ), не допускаются и будут отклонены из-за нарушения уникальности.</span><span class="sxs-lookup"><span data-stu-id="dd74e-154">Updates to unique keys (including primary keys) that generate duplicates (for example, an update of the form `UPDATE <column> SET <column> =<column>+1` are not allowed and will be rejected because of a uniqueness violation.</span></span> <span data-ttu-id="dd74e-155">Это связано с тем, что SET-обновления, выполненные на подписчике, распространяются репликацией в виде отдельных инструкций `UPDATE` для каждой затронутой строки.</span><span class="sxs-lookup"><span data-stu-id="dd74e-155">This is because set updates made at the Subscriber are propagated by replication as individual `UPDATE` statements for each row affected.</span></span>  
  
-   <span data-ttu-id="dd74e-156">Если база данных подписчика секционирована горизонтально и имеются строки в секции, существующей на подписчике, но отсутствующей на издателе, подписчику не удастся обновить существовавшие ранее строки.</span><span class="sxs-lookup"><span data-stu-id="dd74e-156">If the Subscriber database is partitioned horizontally and there are rows in the partition that exist at the Subscriber but not at the Publisher, the Subscriber cannot update the pre-existing rows.</span></span> <span data-ttu-id="dd74e-157">При попытке обновить эти строки возвращается ошибка.</span><span class="sxs-lookup"><span data-stu-id="dd74e-157">Attempting to update these rows returns an error.</span></span> <span data-ttu-id="dd74e-158">Ряды должны быть удалены из таблицы и вставлены снова.</span><span class="sxs-lookup"><span data-stu-id="dd74e-158">The rows should be deleted from the table and inserted again.</span></span>  
  
### <a name="user-defined-triggers"></a><span data-ttu-id="dd74e-159">Пользовательские триггеры</span><span class="sxs-lookup"><span data-stu-id="dd74e-159">User-defined Triggers</span></span>  
  
-   <span data-ttu-id="dd74e-160">Если приложение требует наличия триггеров на подписчике, то эти триггеры должны определяться с параметром `NOT FOR REPLICATION` на издателе и подписчике.</span><span class="sxs-lookup"><span data-stu-id="dd74e-160">If the application requires triggers at the Subscriber, the triggers should be defined with the `NOT FOR REPLICATION` option at the Publisher and Subscriber.</span></span> <span data-ttu-id="dd74e-161">Это гарантирует, что триггеры сработают только для исходного изменения данных, и не будут активизированы, когда это изменение реплицируется.</span><span class="sxs-lookup"><span data-stu-id="dd74e-161">This ensures that triggers fire only for the original data change, but not when that change is replicated.</span></span>  
  
     <span data-ttu-id="dd74e-162">Убедитесь, что определяемый пользователем триггер не включается при обновлении таблицы триггером репликации.</span><span class="sxs-lookup"><span data-stu-id="dd74e-162">Ensure that the user-defined trigger does not fire when the replication trigger updates the table.</span></span> <span data-ttu-id="dd74e-163">Это достигается посредством вызова процедуры `sp_check_for_sync_trigger` в теле пользовательского триггера.</span><span class="sxs-lookup"><span data-stu-id="dd74e-163">This is accomplished by calling the procedure `sp_check_for_sync_trigger` in the body of the user-defined trigger.</span></span> <span data-ttu-id="dd74e-164">Дополнительные сведения см. в статье [sp_check_for_sync_trigger (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-check-for-sync-trigger-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dd74e-164">For more information, see [sp_check_for_sync_trigger &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-check-for-sync-trigger-transact-sql).</span></span>  
  
### <a name="immediate-updating"></a><span data-ttu-id="dd74e-165">Немедленное обновление</span><span class="sxs-lookup"><span data-stu-id="dd74e-165">Immediate Updating</span></span>  
  
-   <span data-ttu-id="dd74e-166">Для подписок с немедленным обновлением изменения на подписчике распространяются на издатель и применяются с использованием координатора распределенных транзакций Майкрософт (MS DTC).</span><span class="sxs-lookup"><span data-stu-id="dd74e-166">For immediate updating subscriptions, changes at the Subscriber are propagated to the Publisher and applied using Microsoft Distributed Transaction Coordinator (MS DTC).</span></span> <span data-ttu-id="dd74e-167">Убедитесь в том, что на издателе и подписчике установлен и настроен MS DTC.</span><span class="sxs-lookup"><span data-stu-id="dd74e-167">Ensure that MS DTC is installed and configured at the Publisher and Subscriber.</span></span> <span data-ttu-id="dd74e-168">Дополнительные сведения см. в документации по Windows.</span><span class="sxs-lookup"><span data-stu-id="dd74e-168">For more information, see the Windows documentation.</span></span>  
  
-   <span data-ttu-id="dd74e-169">Триггеры, используемые подписками с немедленным обновлением, требуют подключения к издателю для репликации изменений.</span><span class="sxs-lookup"><span data-stu-id="dd74e-169">The triggers used by immediate updating subscriptions require a connection to the Publisher to replicate changes.</span></span>  
  
-   <span data-ttu-id="dd74e-170">Если публикация разрешает подписки с немедленным обновлением и статья в публикации имеет фильтр столбцов, вам не удастся отфильтровать столбцы, не допускающие значения NULL и не содержащие значений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="dd74e-170">If the publication allows immediate updating subscriptions and an article in the publication has a column filter, you cannot filter out non-nullable columns without defaults.</span></span>  
  
### <a name="queued-updating"></a><span data-ttu-id="dd74e-171">Обновление посредством очереди</span><span class="sxs-lookup"><span data-stu-id="dd74e-171">Queued Updating</span></span>  
  
-   <span data-ttu-id="dd74e-172">Таблицы, включенные в публикацию слиянием, не могут быть опубликованы и как часть публикации транзакций, разрешающей очереди обновляемых подписок.</span><span class="sxs-lookup"><span data-stu-id="dd74e-172">Tables included in a merge publication cannot also be published as part of a transactional publication that allows queued updating subscriptions.</span></span>  
  
-   <span data-ttu-id="dd74e-173">При использовании отложенного обновления не рекомендуется обновлять столбцы первичного ключа, поскольку первичный ключ применяется для всех запросов как средство поиска записей.</span><span class="sxs-lookup"><span data-stu-id="dd74e-173">Updates made to primary key columns are not recommended when using queued updating because the primary key is used as a record locator for all queries.</span></span> <span data-ttu-id="dd74e-174">Когда политика разрешения конфликтов установлена с приоритетом подписчика, обновления первичных ключей должны производиться с осторожностью.</span><span class="sxs-lookup"><span data-stu-id="dd74e-174">When the conflict resolution policy is set to Subscriber Wins, updates to primary keys should be made with caution.</span></span> <span data-ttu-id="dd74e-175">Если обновления первичного ключа производятся и на издателе, и на подписчике, это приведет к появлению двух строк с разными первичными ключами.</span><span class="sxs-lookup"><span data-stu-id="dd74e-175">If updates to the primary key are made at both the Publisher and at the Subscriber, the result will be two rows with different primary keys.</span></span>  
  
-   <span data-ttu-id="dd74e-176">Для столбцов типа данных `SQL_VARIANT`: при вставке или обновлении данных на подписчике, когда они копируются с подписчика в очередь, агент чтения очереди сопоставляет данные следующим образом.</span><span class="sxs-lookup"><span data-stu-id="dd74e-176">For columns of data type `SQL_VARIANT`: when data is inserted or updated at the Subscriber, it is mapped in the following way by the Queue Reader Agent when it is copied from the Subscriber to the queue:</span></span>  
  
    -   <span data-ttu-id="dd74e-177">`BIGINT`, `DECIMAL`, `NUMERIC`, `MONEY` и `SMALLMONEY` сопоставляются с `NUMERIC`.</span><span class="sxs-lookup"><span data-stu-id="dd74e-177">`BIGINT`, `DECIMAL`, `NUMERIC`, `MONEY`, and `SMALLMONEY` are mapped to `NUMERIC`.</span></span>  
  
    -   <span data-ttu-id="dd74e-178">`BINARY` и `VARBINARY` сопоставляются с данными `VARBINARY`.</span><span class="sxs-lookup"><span data-stu-id="dd74e-178">`BINARY` and `VARBINARY` are mapped to `VARBINARY` data.</span></span>  
  
### <a name="conflict-detection-and-resolution"></a><span data-ttu-id="dd74e-179">Обнаружение и разрешение конфликтов</span><span class="sxs-lookup"><span data-stu-id="dd74e-179">Conflict Detection and Resolution</span></span>  
  
-   <span data-ttu-id="dd74e-180">Для политики конфликтов с приоритетом подписчика: разрешение конфликтов не поддерживается для обновлений столбцов первичного ключа.</span><span class="sxs-lookup"><span data-stu-id="dd74e-180">For the Subscriber Wins conflict policy: conflict resolution is not supported for updates to primary key columns.</span></span>  
  
-   <span data-ttu-id="dd74e-181">Конфликты, возникающие из-за ошибок ограничений внешних ключей, не могут быть разрешены репликацией:</span><span class="sxs-lookup"><span data-stu-id="dd74e-181">Conflicts due to foreign key constraint failures are not resolved by replication:</span></span>  
  
    -   <span data-ttu-id="dd74e-182">Если конфликты не ожидаются, и данные секционированы должным образом (подписчики не обновляют одни и те же строки), на издателе и подписчиках можно использовать ограничения внешних ключей.</span><span class="sxs-lookup"><span data-stu-id="dd74e-182">If conflicts are not expected and data is well partitioned (Subscribers do not update the same rows), you can use foreign key constraints on the Publisher and Subscribers.</span></span>  
  
    -   <span data-ttu-id="dd74e-183">Если ожидаются конфликты: не следует применять ограничения внешних ключей на издателе или подписчике, если используется политика разрешения конфликтов с приоритетом подписчика; не следует применять ограничения внешних ключей на подписчике, если используется политика разрешения конфликтов с приоритетом издателя.</span><span class="sxs-lookup"><span data-stu-id="dd74e-183">If conflicts are expected: you should not use foreign key constraints at the Publisher or Subscriber if you use "Subscriber wins" conflict resolution; you should not use foreign key constraints at the Subscriber if you use "Publisher wins" conflict resolution.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dd74e-184">См. также:</span><span class="sxs-lookup"><span data-stu-id="dd74e-184">See Also</span></span>  
 <span data-ttu-id="dd74e-185">[Одноранговая репликация транзакций](peer-to-peer-transactional-replication.md) </span><span class="sxs-lookup"><span data-stu-id="dd74e-185">[Peer-to-Peer Transactional Replication](peer-to-peer-transactional-replication.md) </span></span>  
 <span data-ttu-id="dd74e-186">[Репликация транзакций](transactional-replication.md) </span><span class="sxs-lookup"><span data-stu-id="dd74e-186">[Transactional Replication](transactional-replication.md) </span></span>  
 <span data-ttu-id="dd74e-187">[Публикация данных и объектов базы данных](../publish/publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="dd74e-187">[Publish Data and Database Objects](../publish/publish-data-and-database-objects.md) </span></span>  
 [<span data-ttu-id="dd74e-188">Подписка на публикации</span><span class="sxs-lookup"><span data-stu-id="dd74e-188">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
  
  
