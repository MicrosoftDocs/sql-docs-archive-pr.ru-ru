---
title: Инициализация подписки с помощью моментального снимка | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], initializing subscriptions
- initializing subscriptions [SQL Server replication], snapshots
ms.assetid: 77a9ade2-cdc0-4ae9-a02d-6e29d7c2ada0
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: f8b776e71e9d1197bc174169aee8ccf692884308
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655596"
---
# <a name="initialize-a-subscription-with-a-snapshot"></a>Инициализация подписки с помощью моментального снимка
  После того как публикация создана, обычно создается и копируется в папку моментальных снимков исходный моментальный снимок (это происходит по умолчанию для публикаций слиянием, созданных с помощью мастера создания публикаций). Затем, при начальной синхронизации подписки, снимок применяется к подписчику агентом распространителя (для публикаций транзакций и публикаций моментальных снимков) или агентом слияния (для публикаций слиянием). Процесс создания моментального снимка зависит от типа публикации:  
  
-   Если моментальный снимок предназначен для публикации моментальных снимков, публикации транзакций или публикации слиянием, не использующей параметризованных фильтров, снимок содержит схему и данные в файлах программы массового копирования (bcp), а также ограничения, расширенные свойства, индексы, триггеры и системные таблицы, необходимые для репликации. Дополнительные сведения о создании и применении моментального снимка см. в [этой статье](create-and-apply-the-snapshot.md).  
  
-   Если требуется моментальный снимок для публикации слиянием, в которой используются параметризованные фильтры, процесс создания моментального снимка происходит в два этапа. Сначала создается моментальный снимок схемы, который содержит скрипты репликации и схему публикуемых объектов, но не содержит данные. Потом каждая подписка инициализируется при помощи моментального снимка, который содержит скрипты и схему, скопированную из моментального снимка схемы, и данные, которые принадлежат секции подписки. Дополнительные сведения см. в статье [Snapshots for Merge Publications with Parameterized Filters](snapshots-for-merge-publications-with-parameterized-filters.md).  
  
 Моментальный снимок состоит из различных файлов, в зависимости от типа репликации и статей в публикации. Эти файлы копируются в папку моментальных снимков по умолчанию, указанную при настройке распространителя, или в альтернативную папку моментальных снимков, указанную при создании публикации.  
  
|Тип репликации|Общие файлы моментальных снимков|  
|-------------------------|---------------------------|  
|Репликация моментальных снимков или репликация транзакций|схема (SCH); данные (BCP); ограничения и индексы (DRI); ограничения (IDX); триггеры (TRG): для обновления только подписчиков; сжатые файлы моментальных снимков (CAB).|  
|Репликация слиянием|схема (SCH); данные (BCP); ограничения и индексы (DRI); триггеры (TRG); данные системной таблицы (SYS); таблицы конфликтов (CFT); сжатые файлы моментальных снимков (CAB).|  
  
 Если передача моментального снимка прерывается в любой точке, она автоматически возобновляется, не передавая повторно файлы, которые уже были переданы полностью. Единицей доставки для агента моментальных снимков является BCP-файл статьи публикации, поэтому файлы, доставленные частично, должны быть повторно доставлены полностью. Однако возобновление моментального снимка может значительно снизить объем передаваемых данных и гарантировать своевременную доставку снимка, даже если соединение ненадежно.  
  
## <a name="snapshot-options"></a>Параметры моментального снимка  
 При инициализации подписки с помощью моментального снимка есть несколько возможностей. Вы можете:  
  
-   Указать другое расположение папки моментальных снимков вместо или дополнительно к папке по умолчанию. Дополнительные сведения см. в статье [Alternate Snapshot Folder Locations](alternate-snapshot-folder-locations.md).  
  
-   Сжать моментальные снимки для хранения на съемном носителе или для передачи по медленной сети. Дополнительные сведения см. в разделе [Compressed Snapshots](compressed-snapshots.md).  
  
-   Выполнить скрипты Transact-SQL до или после применения моментального снимка. Дополнительные сведения см. в статье [Выполнение скриптов до и после применения моментального снимка](snapshot-options.md#execute-scripts-before-and-after-snapshot-is-applied).  
  
-   Передать файлы моментальных снимков с помощью протокола передачи файлов (FTP). Дополнительные сведения см. в статье [Передача моментальных снимков через FTP](transfer-snapshots-through-ftp.md).  
  
## <a name="see-also"></a>См. также:  
 [Инициализация подписки](initialize-a-subscription.md)   
 [Защита папки моментальных снимков](security/secure-the-snapshot-folder.md)  
  
  
