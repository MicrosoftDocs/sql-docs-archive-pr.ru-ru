---
title: Проверка сведений о секции для подписчика на публикацию слиянием | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication data validation [SQL Server replication], partitions
- parameterized filters [SQL Server replication], validating partition information
- validating partition information
ms.assetid: c059553e-df2c-4333-ba79-e8d6e2890c34
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 3032ff13af69a0690e1f81f08f7b3fb17aae0ee1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655019"
---
# <a name="validate-partition-information-for-a-merge-subscriber"></a><span data-ttu-id="d0d80-102">Проверка сведений о секции для подписчика на публикацию слиянием</span><span class="sxs-lookup"><span data-stu-id="d0d80-102">Validate Partition Information for a Merge Subscriber</span></span>
  <span data-ttu-id="d0d80-103">При определении параметризованного фильтра строк для публикации слиянием используется функция, ссылающаяся на данные подписчика, например на имя входа подписчика.</span><span class="sxs-lookup"><span data-stu-id="d0d80-103">When you define a parameterized row filter for a merge publication, you use a function that references Subscriber information, such as the Subscriber's login name.</span></span> <span data-ttu-id="d0d80-104">По умолчанию репликация проверяет данные подписчика на основании этой функции перед каждой синхронизацией и при использовании моментального снимка на подписчике.</span><span class="sxs-lookup"><span data-stu-id="d0d80-104">By default, replication validates Subscriber information based on that function before each synchronization and whenever a snapshot is applied at the Subscriber.</span></span> <span data-ttu-id="d0d80-105">Процесс проверки обеспечивает правильность секционирования данных для каждого подписчика.</span><span class="sxs-lookup"><span data-stu-id="d0d80-105">The validation process ensures that data is partitioned correctly for each Subscriber.</span></span> <span data-ttu-id="d0d80-106">Характер проверки контролируется свойством публикации **validate_subscriber_info**, изменить которое можно при помощи процедуры [sp_changemergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql) или на странице **Параметры подписки** диалогового окна **Свойства публикаций**.</span><span class="sxs-lookup"><span data-stu-id="d0d80-106">Validation behavior is controlled by the **validate_subscriber_info** publication property, which can be changed using [sp_changemergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql) or on the **Subscription Options** page of the **Publication Properties** dialog box.</span></span> <span data-ttu-id="d0d80-107">Дополнительные сведения об изменении свойств публикаций см. в разделе [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d0d80-107">For more information about changing publication properties, see [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span></span>  
  
## <a name="how-partition-validation-works"></a><span data-ttu-id="d0d80-108">Сведения о работе проверки секции</span><span class="sxs-lookup"><span data-stu-id="d0d80-108">How Partition Validation Works</span></span>  
 <span data-ttu-id="d0d80-109">Например, при фильтрации публикации при помощи функции **SUSER_SNAME()** агент слияния использует исходный моментальный снимок для каждого подписчика на основании данных, допустимых для выражения **SUSER_SNAME()** .</span><span class="sxs-lookup"><span data-stu-id="d0d80-109">When a publication is filtered, for example, using the function **SUSER_SNAME()**, the Merge Agent applies the initial snapshot to each Subscriber based on data that is valid for the **SUSER_SNAME()** expression.</span></span>  
  
 <span data-ttu-id="d0d80-110">Если проверка включена, когда подписчик вновь подключается к издателю для следующей синхронизации, агент слияния проверяет данные на подписчике и гарантирует, что каждая секция подписчика является именно той секцией, которая была получена в исходном моментальном снимке.</span><span class="sxs-lookup"><span data-stu-id="d0d80-110">If validation is enabled, when the Subscriber reconnects to the Publisher for the next synchronization, the Merge Agent validates the information at the Subscriber and ensures that each Subscriber's partition is the same as the one received in the initial snapshot.</span></span> <span data-ttu-id="d0d80-111">Для каждого последующего применения слияния или моментального снимка агент слияния проверяет каждую секцию подписчика.</span><span class="sxs-lookup"><span data-stu-id="d0d80-111">For each subsequent merge or snapshot application, the Merge Agent validates each Subscriber's partition.</span></span>  
  
 <span data-ttu-id="d0d80-112">Если агент слияния обнаруживает, что функция, используемая в выражении фильтрации, возвращает значение, отличное от значения, бывшего при исходном моментальном снимке, слияние или применение моментального снимка завершается ошибкой, и для этой подписки подписчика может понадобиться повторная инициализация.</span><span class="sxs-lookup"><span data-stu-id="d0d80-112">If the Merge Agent detects that the function used in the filtering expression returns a different value than it did at the initial snapshot, the merge or snapshot application fails, and that Subscriber's subscription might require reinitialization.</span></span> <span data-ttu-id="d0d80-113">Повторная инициализация может быть необходимой для предотвращения проблем в случае изменения установки слияния подписчика, но может быть достаточно изменить информацию на подписчике, например имя входа, и вернуть ее к значению, которое использовалось во время исходного моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="d0d80-113">Reinitialization might be necessary to prevent problems that can arise if the merge settings of a Subscriber are changed, but it might be sufficient to change information at the Subscriber, such as the login name, back to the value used at the time of the original snapshot.</span></span>  
  
 <span data-ttu-id="d0d80-114">Когда агент слияния проверяет секцию, наряду с проверкой значений секции, возвращаемых функциями, используемыми в выражениях фильтрации, агент проверяет также, сформирован ли моментальный снимок перед изменениями, которые сделали его недействительным, например перед выполнением операций очистки метаданных или изменениями схемы.</span><span class="sxs-lookup"><span data-stu-id="d0d80-114">When the Merge Agent validates a partition, in addition to validating the partition against the values returned by any functions used in filtering expressions, the agent also checks whether the snapshot was generated prior to changes that invalidate it, such as metadata cleanup operations or schema changes.</span></span> <span data-ttu-id="d0d80-115">Если секционированный моментальный снимок слишком стар, агент слияния возвращает ошибку, и пользователь должен вновь сформировать секционированный моментальный снимок для этого подписчика на основании текущего стандартного моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="d0d80-115">If a partitioned snapshot is too old, the Merge Agent will return an error and you must regenerate a partitioned snapshot for that Subscriber based on a current regular snapshot.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d0d80-116">См. также:</span><span class="sxs-lookup"><span data-stu-id="d0d80-116">See Also</span></span>  
 <span data-ttu-id="d0d80-117">[Вопросы и ответы об администрировании репликации](administration/frequently-asked-questions-for-replication-administrators.md) </span><span class="sxs-lookup"><span data-stu-id="d0d80-117">[Replication Administration FAQ](administration/frequently-asked-questions-for-replication-administrators.md) </span></span>  
 <span data-ttu-id="d0d80-118">[Рекомендации по администрированию репликации](administration/best-practices-for-replication-administration.md) </span><span class="sxs-lookup"><span data-stu-id="d0d80-118">[Best Practices for Replication Administration](administration/best-practices-for-replication-administration.md) </span></span>  
 <span data-ttu-id="d0d80-119">[Повторная инициализация подписок](reinitialize-subscriptions.md) </span><span class="sxs-lookup"><span data-stu-id="d0d80-119">[Reinitialize Subscriptions](reinitialize-subscriptions.md) </span></span>  
 [<span data-ttu-id="d0d80-120">Проверка реплицированных данных</span><span class="sxs-lookup"><span data-stu-id="d0d80-120">Validate Replicated Data</span></span>](validate-data-at-the-subscriber.md)  
  
  
