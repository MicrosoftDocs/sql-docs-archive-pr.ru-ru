---
title: SQL Server объектной модели с массовым загрузкой XML (SQLXML 4,0) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- bulk load [SQLXML], object model
- ErrorLogFile property
- SGDropTables property
- SGUseID property
- KeepNulls property
- ConnectionCommand property
- SchemaGen property
- XMLFragment property
- SQLXMLBulkLoad object
- ForceTableLock property
- CheckConstraints property
- BulkLoad property
- TempFilePath property
- IgnoreDuplicateKeys property
- Transaction property
- KeepIdentity property
- ConnectionString property
- FireTriggers property
- Execute method
- XML Bulk Load [SQLXML], object model
ms.assetid: a9efbbde-ed2b-4929-acc1-261acaaed19d
author: rothja
ms.author: jroth
ms.openlocfilehash: 364515afaea17ce403f8eb38cb10bbe6003dfe2b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87728130"
---
# <a name="sql-server-xml-bulk-load-object-model-sqlxml-40"></a>Объектная модель массовой загрузки XML SQL Server (SQLXML 4.0)
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Объектная модель Microsoft XML с массовым загрузкой состоит из объекта склксмлбулклоад. Этот объект поддерживает следующие свойства и методы.  
  
## <a name="methods"></a>Методы  
 Execute  
 Проводит массовую загрузку данных на основании файла схемы и файла (или потока) данных, которые передаются как параметры.  
  
## <a name="properties"></a>Свойства  
 Функцию  
 Указывает, должна ли проводиться массовая загрузка. Это свойство полезно, если требуется создавать только схемы (см. следующие свойства SchemaGen, Сгдроптаблес и Сгусеид) и не выполнять полную загрузку. Это свойство является логическим. Когда свойство имеет значение TRUE, проводится массовая загрузка XML. Когда свойство имеет значение FALSE, массовая загрузка XML не проводится.  
  
 Значение по умолчанию — TRUE.  
  
 CheckConstraints  
 Указывает, следует ли проверять ограничения (например, ограничения связи «первичный ключ - внешний ключ» между столбцами), заданные для столбцов, когда массовая загрузка XML вставляет данные в столбцы. Это свойство является логическим.  
  
 Если свойство имеет значение TRUE, массовая загрузка XML проверяет ограничения для каждого вставляемого значения (а это значит, что при нарушении ограничения возникнет ошибка).  
  
> [!NOTE]  
>  Чтобы оставить это свойство ЛОЖНЫм, необходимо иметь разрешения **ALTER TABLE** для целевых таблиц. Дополнительные сведения см. в разделе [ALTER TABLE (Transact-SQL)](/sql/t-sql/statements/alter-table-transact-sql).  
  
 Значение по умолчанию — FALSE. Когда для свойства задано значение FALSE, массовая загрузка XML при выполнении вставки не учитывает ограничения. В текущей реализации нужно определять таблицы в порядке связи первичного и внешнего ключей, заданных в схеме сопоставления. Иными словами, таблица, содержащая первичный ключ, должна быть определена раньше, чем соответствующая ей таблица с внешним ключом. В противном случае массовая загрузка XML завершится ошибкой.  
  
 Следует заметить, что, если проводится распространение идентификаторов, этот параметр неприменим и проверка ограничений будет проводиться. Это происходит в том случае, если задано `KeepIdentity=False` и определена связь, в которой родительский элемент является полем идентификатора, а значение назначается дочернему элементу при его формировании.  
  
 ConnectionCommand  
 Определяет существующий объект соединения (например, объект команды ADO или ICommand), который должен использоваться при выполнении групповой загрузки XML. Свойство ConnectionCommand можно использовать вместо указания строки соединения со свойством ConnectionString. Для свойства Transaction необходимо задать значение TRUE, если используется ConnectionCommand.  
  
 Если одновременно используются свойства ConnectionString и ConnectionCommand, то при выполнении групповой загрузки XML используется последнее указанное свойство.  
  
 Значение по умолчанию — NULL.  
  
 ConnectionString  
 Задает строку соединения OLE DB, содержащую необходимую информацию для установления соединения с экземпляром базы данных. Если одновременно используются свойства ConnectionString и ConnectionCommand, то при выполнении групповой загрузки XML используется последнее указанное свойство.  
  
 Значение по умолчанию — NULL.  
  
 еррорлогфиле  
 Указывает имя файла журнала, в который массовая загрузка XML заносит сообщения об ошибках и другие виды сообщений. Значение по умолчанию — пустая строка; в этом случае занесение в журнал не производится.  
  
 FireTriggers  
 Указывает, должны ли срабатывать триггеры, определенные в целевых таблицах, во время операции массовой загрузки. Значение по умолчанию — FALSE.  
  
 Если задано значение TRUE, триггеры будут срабатывать как при обычной операции вставки.  
  
> [!NOTE]  
>  Чтобы оставить это свойство ЛОЖНЫм, необходимо иметь разрешения **ALTER TABLE** для целевых таблиц. Дополнительные сведения см. в разделе [ALTER TABLE (Transact-SQL)](/sql/t-sql/statements/alter-table-transact-sql).  
  
 Следует заметить, что, если проводится распространение идентификаторов, этот параметр неприменим и все триггеры останутся включенными. Это происходит в том случае, если задано `KeepIdentity=False` и определена связь, в которой родительский элемент является полем идентификатора, а значение назначается дочернему элементу при его формировании.  
  
 ForceTableLock  
 Указывает, следует ли блокировать таблицы, в которые массовая загрузка XML копирует данные, на время массовой загрузки. Это свойство является логическим. Когда свойство имеет значение TRUE, массовая загрузка XML блокирует таблицы на все время своей работы. Когда для свойства задано значение FALSE, массовая загрузка XML блокирует таблицу только на то время, когда вставляет в нее запись.  
  
 Значение по умолчанию — FALSE.  
  
 IgnoreDuplicateKeys  
 Указывает, что делать в случае попытки вставить повторяющиеся значения в ключевой столбец. Если свойство имеет значение TRUE, то в случае попытки вставить повторяющиеся значения в ключевой столбец [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] не разрешит вставить запись. Однако следующая запись будет вставлена; таким образом, операция массовой загрузки XML завершится успешно. Если свойство имеет значение FALSE, в случае попытки вставить повторяющиеся значения в ключевой столбец операция массовой загрузки XML завершится ошибкой.  
  
 Если свойство IgnoreDuplicateKeys имеет значение TRUE, то для каждой записи, вставленной в таблицу, выдается инструкция COMMIT. Это замедляет операцию. Свойство может иметь значение TRUE, только если для свойства Transaction задано значение FALSE, так как транзакционное поведение реализуется с помощью файлов.  
  
 Значение по умолчанию — FALSE.  
  
 KeepIdentity  
 Указывает, как обрабатывать значения столбца типа Identity в исходном файле. Это свойство является логическим. Когда свойство имеет значение TRUE, массовая загрузка XML назначает столбцу идентификаторов значения, заданные в исходном файле. Когда свойство имеет значение FALSE, массовая загрузка XML не учитывает значения столбца идентификаторов, заданные в исходном файле. В этом случае [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] присваивает столбцу идентификаторов собственные значения.  
  
 Если в массовой загрузке XML участвует столбец, являющийся внешним ключом для столбца идентификаторов, в котором хранятся значения, сформированные [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], массовая загрузка распространяет эти значения идентификаторов на внешний ключевой столбец.  
  
 Значение этого свойства применяется ко всем столбцам, задействованным в массовой загрузке. Значение по умолчанию — TRUE.  
  
> [!NOTE]  
>  Чтобы оставить это свойство ИСТИНным, необходимо иметь разрешения **ALTER TABLE** для целевых таблиц. В противном случае ему должно быть присвоено значение FALSE. Дополнительные сведения см. в разделе [ALTER TABLE (Transact-SQL)](/sql/t-sql/statements/alter-table-transact-sql).  
  
 KeepNulls  
 Указывает, какое значение будет использовано для столбца, не имеющего соответствующего атрибута или дочернего элемента в XML-документе. Это свойство является логическим. Если свойство имеет значение TRUE, массовая загрузка XML назначит этому столбцу значение NULL. Столбцу не будет присвоено значение по умолчанию, даже если таковое установлено на сервере. Значение этого свойства применяется ко всем столбцам, задействованным в массовой загрузке.  
  
 Значение по умолчанию — FALSE.  
  
 SchemaGen  
 Указывает, следует ли создавать нужные таблицы до операции массовой загрузки. Это свойство является логическим. Если свойство имеет значение TRUE, таблицы, заданные в схеме сопоставления, будут созданы (база данных должна существовать). Если одна или несколько таблиц уже существуют в базе данных, свойство Сгдроптаблес определяет, нужно ли удалять и повторно создавать эти предварительно существовавшие таблицы.  
  
 Значение по умолчанию для свойства SchemaGen — FALSE. SchemaGen не создает ограничения ПЕРВИЧного ключа для вновь созданных таблиц. Однако SchemaGen создает в базе данных ограничения внешнего ключа, если она может найти совпадающие `sql:relationship` и `sql:key-fields` аннотации в схеме сопоставления, а также если ключевое поле состоит из одного столбца.  
  
 Обратите внимание, что если для свойства SchemaGen задано значение TRUE, при выполнении групповой загрузки XML выполняется следующее:  
  
-   создает необходимые таблицы на основании имен атрибутов и элементов. Поэтому нельзя использовать зарезервированные слова [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для имен атрибутов и элементов схемы;  
  
-   Возвращает данные переполнения для любого столбца, указанного с помощью [SQL: overflow-поля](annotation-interpretation-sql-overflow-field.md) в формате [типа данных XML](/sql/t-sql/xml/xml-transact-sql) .  
  
 сгдроптаблес  
 Указывает, следует ли удалить и создать повторно существующие таблицы. Это свойство используется, если свойство SchemaGen имеет значение TRUE. Если Сгдроптаблес имеет значение FALSE, существующие таблицы сохраняются. Если свойство имеет значение TRUE, существующие таблицы удаляются и создаются повторно.  
  
 Значение по умолчанию — FALSE.  
  
 сгусеид  
 Указывает, будет ли атрибут, заданный в схеме сопоставления как `id`, использован в создании ограничения типа PRIMARY KEY при создании таблицы. Это свойство используется, если свойство SchemaGen имеет значение TRUE. Если Сгусеид имеет значение TRUE, то служебная программа SchemaGen использует атрибут, который `dt:type="id"` указан в качестве первичного ключевого столбца, и добавляет соответствующее ограничение первичного ключа при создании таблицы.  
  
 Значение по умолчанию — FALSE.  
  
 TempFilePath  
 Указывает файловый путь, по которому массовая загрузка XML создает временные файлы для хранения данных, массово загружаемых в транзакции. (Это свойство полезно, только если свойство Transaction имеет значение TRUE.) Необходимо убедиться, что [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] учетная запись, используемая для выполнения групповой загрузки XML, имеет доступ к этому пути. Если это свойство не установлено, массовая загрузка XML хранит временные файлы в месте, заданном переменной среды TEMP.  
  
 Транзакция  
 Указывает, должна ли массовая загрузка выполняться в транзакции. В этом случае при неудачном завершении массовой загрузки производится откат транзакции. Это свойство является логическим. Когда свойство имеет значение TRUE, массовая загрузка XML проводится в контексте транзакции. Свойство TempFilePath используется только в том случае, если для транзакции задано значение TRUE.  
  
> [!NOTE]  
>  Если вы загружаете двоичные данные (например, типы данных bin. Hex, bin. Base64 в двоичный формат, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] типы данных Image), то свойству Transaction должно быть присвоено значение false.  
  
 Значение по умолчанию — FALSE.  
  
 XMLFragment  
 Указывает, являются ли исходные данные XML-фрагментом. Фрагмент XML — это XML-документ, в котором нет единственного элемента верхнего уровня. Это свойство является логическим. Если исходный файл является XML-фрагментом, для этого свойства следует задать значение TRUE.  
  
 Значение по умолчанию — FALSE.  
  
  
