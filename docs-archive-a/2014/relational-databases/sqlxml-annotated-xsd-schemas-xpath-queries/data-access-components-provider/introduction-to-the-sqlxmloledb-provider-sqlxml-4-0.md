---
title: Введение в поставщик SQLXMLOLEDB (SQLXML 4,0) | Документация Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- SQLXMLOLEDB Provider, properties
- adExecuteStream flag
- SQLXMLOLEDB Provider, about SQLXMLOLEDB Provider
ms.assetid: 2e3f3817-4209-4bf4-9f46-248c95bc6f1b
author: rothja
ms.author: jroth
ms.openlocfilehash: af8b37620abd0b1228c82c902f812cf0d0912dd8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87732458"
---
# <a name="introduction-to-the-sqlxmloledb-provider-sqlxml-40"></a><span data-ttu-id="68333-102">Введение в поставщик SQLXMLOLEDB (SQLXML 4.0)</span><span class="sxs-lookup"><span data-stu-id="68333-102">Introduction to the SQLXMLOLEDB Provider (SQLXML 4.0)</span></span>
  <span data-ttu-id="68333-103">Поставщик SQLXMLOLEDB — это поставщик OLE DB, который предоставляет функциональность [!INCLUDE[msCoName](../../../includes/msconame-md.md)] SQLXML через объекты ADO.</span><span class="sxs-lookup"><span data-stu-id="68333-103">The SQLXMLOLEDB Provider is an OLE DB provider that exposes [!INCLUDE[msCoName](../../../includes/msconame-md.md)] SQLXML functionality through ActiveX Data Objects (ADO).</span></span> <span data-ttu-id="68333-104">Однако этот поставщик может выполнять команды только в режиме ADO «запись в выходящий поток».</span><span class="sxs-lookup"><span data-stu-id="68333-104">However, the provider can execute commands only in the "write to an output stream" mode of ADO.</span></span> <span data-ttu-id="68333-105">Поставщик SQLXMLOLEDB не является поставщиком набора строк.</span><span class="sxs-lookup"><span data-stu-id="68333-105">The SQLXMLOLEDB Provider is not a rowset provider.</span></span> <span data-ttu-id="68333-106">При выполнении команды необходимо указать флаг Адексекутестреам, который направляет ADO использовать указанный выходной поток.</span><span class="sxs-lookup"><span data-stu-id="68333-106">When you execute a command, you must specify the adExecuteStream flag, which directs ADO to use the output stream that you have specified.</span></span>  
  
 <span data-ttu-id="68333-107">В следующем примере показан синтаксис команды EXECUTE, в которой указан флаг Адексекутестреам:</span><span class="sxs-lookup"><span data-stu-id="68333-107">The following example shows the syntax for the Execute command in which the adExecuteStream flag is specified:</span></span>  
  
```  
Dim oTestCommand As New ADODB.Command  
...  
oTestCommand.Properties("Output Stream").Value = oTestStream  
oTestCommand.Execute , , adExecuteStream  
...  
```  
  
## <a name="sqlxmloledb-provider-specific-properties"></a><span data-ttu-id="68333-108">Свойства поставщика SQLXMLOLEDB</span><span class="sxs-lookup"><span data-stu-id="68333-108">SQLXMLOLEDB Provider-specific Properties</span></span>  
 <span data-ttu-id="68333-109">Поставщик SQLXMLOLEDB имеет следующие характерные для него свойства соединения.</span><span class="sxs-lookup"><span data-stu-id="68333-109">The SQLXMLOLEDB Provider exposes the following provider-specific connection property.</span></span>  
  
|<span data-ttu-id="68333-110">Соединение</span><span class="sxs-lookup"><span data-stu-id="68333-110">Connection</span></span><br /><br /> <span data-ttu-id="68333-111">свойство;</span><span class="sxs-lookup"><span data-stu-id="68333-111">property</span></span>|<span data-ttu-id="68333-112">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="68333-112">Default</span></span><br /><br /> <span data-ttu-id="68333-113">(если есть)</span><span class="sxs-lookup"><span data-stu-id="68333-113">(if any)</span></span>|<span data-ttu-id="68333-114">Описание</span><span class="sxs-lookup"><span data-stu-id="68333-114">Description</span></span>|  
|-----------------------------|----------------------------|-----------------|  
|<span data-ttu-id="68333-115">Поставщик данных</span><span class="sxs-lookup"><span data-stu-id="68333-115">Data Provider</span></span>||<span data-ttu-id="68333-116">Предоставляет идентификатор PROGID поставщика OLE DB, через который SQLXMLOLEDB выполняет команды.</span><span class="sxs-lookup"><span data-stu-id="68333-116">Provides the PROGID of the OLE DB provider through which SQLXMLOLEDB executes the commands.</span></span> <span data-ttu-id="68333-117">Начиная с SQLXML 4.0 и [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], этот поставщик является частью собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]; поэтому значение этого свойства может быть только «SQLNCLI11».</span><span class="sxs-lookup"><span data-stu-id="68333-117">Beginning in SQLXML 4.0 and [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this provider is contained within the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client; therefore, this property value is restricted to "SQLNCLI11".</span></span> <span data-ttu-id="68333-118">Дополнительные сведения см. в статье [Программирование SQL Server Native Client](../../native-client/sql-server-native-client-programming.md).</span><span class="sxs-lookup"><span data-stu-id="68333-118">For more information, see [SQL Server Native Client Programming](../../native-client/sql-server-native-client-programming.md).</span></span>|  
  
 <span data-ttu-id="68333-119">Поставщик SQLXMLOLEDB имеет следующие характерные для него свойства команды.</span><span class="sxs-lookup"><span data-stu-id="68333-119">The SQLXMLOLEDB Provider exposes the following provider-specific command properties.</span></span>  
  
|<span data-ttu-id="68333-120">Get-Help</span><span class="sxs-lookup"><span data-stu-id="68333-120">Command</span></span><br /><br /> <span data-ttu-id="68333-121">свойство;</span><span class="sxs-lookup"><span data-stu-id="68333-121">property</span></span>|<span data-ttu-id="68333-122">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="68333-122">Default</span></span><br /><br /> <span data-ttu-id="68333-123">(если есть)</span><span class="sxs-lookup"><span data-stu-id="68333-123">(if any)</span></span>|<span data-ttu-id="68333-124">Описание</span><span class="sxs-lookup"><span data-stu-id="68333-124">Description</span></span>|  
|--------------------------|----------------------------|-----------------|  
|<span data-ttu-id="68333-125">Базовый путь</span><span class="sxs-lookup"><span data-stu-id="68333-125">Base Path</span></span>|<span data-ttu-id="68333-126">""</span><span class="sxs-lookup"><span data-stu-id="68333-126">""</span></span>|<span data-ttu-id="68333-127">Указывает базовый путь к файлу.</span><span class="sxs-lookup"><span data-stu-id="68333-127">Specifies the base file path.</span></span> <span data-ttu-id="68333-128">Базовый путь к файлу используется для указания местоположения файлов языка XSL или схемы сопоставления.</span><span class="sxs-lookup"><span data-stu-id="68333-128">The base file path is used to specify the location of the XML Stylesheet Language (XSL) or mapping schema files.</span></span> <span data-ttu-id="68333-129">Базовый путь к файлу также используется для разрешения относительных путей к файлам схемы XSL или сопоставления, указанным в свойствах схемы XSL или сопоставления.</span><span class="sxs-lookup"><span data-stu-id="68333-129">The base file path is also used to resolve the relative paths of XSL or mapping schema files that have been specified in the XSL or Mapping Schema properties.</span></span><br /><br /> <span data-ttu-id="68333-130">Пример использования этого свойства см. в разделе [исполнение запросов XPath &#40;поставщика SQLXMLOLEDB&#41;](executing-xpath-queries-sqlxmloledb-provider.md).</span><span class="sxs-lookup"><span data-stu-id="68333-130">For an example in which this property is used, see [Executing XPath Queries &#40;SQLXMLOLEDB Provider&#41;](executing-xpath-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="68333-131">клиентсидексмл</span><span class="sxs-lookup"><span data-stu-id="68333-131">ClientSideXML</span></span>|<span data-ttu-id="68333-132">Неверно</span><span class="sxs-lookup"><span data-stu-id="68333-132">False</span></span>|<span data-ttu-id="68333-133">Если требуется, чтобы процесс преобразования набора строк в XML был выполнен на клиенте, а не на сервере, установите этому свойству значение TRUE.</span><span class="sxs-lookup"><span data-stu-id="68333-133">Set this property to True if you want the process of converting the rowset to XML to occur on the client instead of on the server.</span></span> <span data-ttu-id="68333-134">Это полезно, когда необходимо переместить нагрузку производительности на средний уровень.</span><span class="sxs-lookup"><span data-stu-id="68333-134">This is useful when you want to move the performance load to the middle tier.</span></span><br /><br /> <span data-ttu-id="68333-135">Пример использования этого свойства см. в статьях [исполнение SQL-запросов &#40;поставщика SQLXMLOLEDB&#41;](executing-sql-queries-sqlxmloledb-provider.md) или запуск [шаблонов, содержащих SQL-запросы &#40;&#41;поставщика SQLXMLOLEDB ](executing-templates-that-contain-sql-queries-sqlxmloledb-provider.md).</span><span class="sxs-lookup"><span data-stu-id="68333-135">For an example in which this property is used, see [Executing SQL Queries &#40;SQLXMLOLEDB Provider&#41;](executing-sql-queries-sqlxmloledb-provider.md) or [Executing Templates That Contain SQL Queries &#40;SQLXMLOLEDB Provider&#41;](executing-templates-that-contain-sql-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="68333-136">Тип содержимого</span><span class="sxs-lookup"><span data-stu-id="68333-136">Content Type</span></span>||<span data-ttu-id="68333-137">Возвращает тип выходящего содержимого.</span><span class="sxs-lookup"><span data-stu-id="68333-137">Returns the output content type.</span></span> <span data-ttu-id="68333-138">Это свойство доступно только для чтения.</span><span class="sxs-lookup"><span data-stu-id="68333-138">This is a READ ONLY property.</span></span><br /><br /> <span data-ttu-id="68333-139">Это свойство предоставляет браузеру сведения о типе содержимого (например, ТЕКСТ/XML, ТЕКСТ/HTML, изображение/jpeg и так далее).</span><span class="sxs-lookup"><span data-stu-id="68333-139">This property provides information to the browser about the content type (such as TEXT/XML, TEXT/HTML, image/jpeg, and so on).</span></span> <span data-ttu-id="68333-140">Значение этого свойства становится полем **Content-Type** , которое отправляется браузеру как часть заголовка HTTP, который содержит MIME-тип документа, отправляемого в качестве текста.</span><span class="sxs-lookup"><span data-stu-id="68333-140">The value of this property becomes the **content-type** field that is sent to the browser as part of the HTTP header, which contains the MIME-type (Multipurpose Internet Mail Extensions) of the document being sent as the body.</span></span>|  
|<span data-ttu-id="68333-141">Схема сопоставления</span><span class="sxs-lookup"><span data-stu-id="68333-141">Mapping Schema</span></span>|<span data-ttu-id="68333-142">NULL</span><span class="sxs-lookup"><span data-stu-id="68333-142">NULL</span></span>|<span data-ttu-id="68333-143">Когда клиентское приложение выполняет запрос XPath к схеме сопоставления (XDR или XSD), это свойство используется для указания имени схемы сопоставления.</span><span class="sxs-lookup"><span data-stu-id="68333-143">If a client application executes an XPath query against a mapping schema (XDR or XSD), this property is used to specify the name of the mapping schema.</span></span><br /><br /> <span data-ttu-id="68333-144">Указываемый путь может быть относительным (xyz/abc/МояСхема.xml) или абсолютным (C:\МояПапка\abc\МояСхема.xml).</span><span class="sxs-lookup"><span data-stu-id="68333-144">The path that is specified can be relative (xyz/abc/MySchema.xml) or absolute (C:\MyFolder\abc\MySchema.xml).</span></span><br /><br /> <span data-ttu-id="68333-145">Если указан относительный путь, то для разрешения относительного пути используется базовый путь, заданный свойством базового пути.</span><span class="sxs-lookup"><span data-stu-id="68333-145">If a relative path is specified, the base path that is specified by the Base Path property is used to resolve the relative path.</span></span> <span data-ttu-id="68333-146">Если в свойстве базового пути не указан путь, то относительный путь указывается относительно текущего каталога.</span><span class="sxs-lookup"><span data-stu-id="68333-146">If no path has been specified in the Base Path property, the relative path is relative to the current directory.</span></span><br /><br /> <span data-ttu-id="68333-147">При указании значения для свойства схема сопоставления можно указать путь к локальному каталогу или URL-адрес (http://...). При указании URL-адреса необходимо настроить WinHTTP для доступа к серверам HTTP и HTTPS через прокси-сервер.</span><span class="sxs-lookup"><span data-stu-id="68333-147">In specifying a value for the Mapping Schema property, you can specify a local directory path or a URL (http://...). If you specify a URL, you must configure WinHTTP to access HTTP and HTTPS servers through a proxy server.</span></span> <span data-ttu-id="68333-148">Сделать это можно при помощи программы Proxycfg.exe.</span><span class="sxs-lookup"><span data-stu-id="68333-148">You can do this by executing the Proxycfg.exe utility.</span></span> <span data-ttu-id="68333-149">Дополнительные сведения см. в статье «Использование программы настройки доступа модуля WinHTTP через прокси-сервер» в библиотеке MSDN.</span><span class="sxs-lookup"><span data-stu-id="68333-149">For more information, see "Using the WinHTTP Proxy Configuration Utility" in the MSDN Library.</span></span><br /><br /> <span data-ttu-id="68333-150">Пример использования этого свойства см. в разделе [исполнение запросов XPath &#40;поставщика SQLXMLOLEDB&#41;](executing-xpath-queries-sqlxmloledb-provider.md).</span><span class="sxs-lookup"><span data-stu-id="68333-150">For an example in which this property is used, see [Executing XPath Queries &#40;SQLXMLOLEDB Provider&#41;](executing-xpath-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="68333-151">пространства имен</span><span class="sxs-lookup"><span data-stu-id="68333-151">namespaces</span></span>||<span data-ttu-id="68333-152">Это свойство включает использование запросов XPath, которые используют пространства имен.</span><span class="sxs-lookup"><span data-stu-id="68333-152">This property enables the execution of XPath queries that use namespaces.</span></span> <span data-ttu-id="68333-153">Пример использования этого свойства см. в разделе [исполнение запросов XPath с пространствами имен &#40;поставщик SQLXMLOLEDB&#41;](executing-xpath-queries-with-namespaces-sqlxmloledb-provider.md).</span><span class="sxs-lookup"><span data-stu-id="68333-153">For an example in which this property is used, see [Executing XPath Queries with Namespaces &#40;SQLXMLOLEDB Provider&#41;](executing-xpath-queries-with-namespaces-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="68333-154">ss Stream Flags</span><span class="sxs-lookup"><span data-stu-id="68333-154">ss Stream Flags</span></span>||<span data-ttu-id="68333-155">Это свойство используется для указания конкретных типов ограничений безопасности.</span><span class="sxs-lookup"><span data-stu-id="68333-155">This property is used to specify particular types of security restrictions.</span></span> <span data-ttu-id="68333-156">Например, может потребоваться запретить URL-ссылки на файлы или абсолютные пути к файлам (например, внешние веб-сайты).</span><span class="sxs-lookup"><span data-stu-id="68333-156">For example, you might not want to allow URL references to files or absolute paths to files (such as external sites).</span></span> <span data-ttu-id="68333-157">Либо может потребоваться запретить запросы в шаблонах.</span><span class="sxs-lookup"><span data-stu-id="68333-157">Or you might not want to allow queries in the templates.</span></span><br /><br /> <span data-ttu-id="68333-158">Свойству могут быть присвоены следующие значения:</span><span class="sxs-lookup"><span data-stu-id="68333-158">The property can be assigned these values:</span></span><br /><br /> <span data-ttu-id="68333-159">1 = STREAM_FLAGS_DISALLOW_URL 2 = STREAM_FLAGS_DISALLOW_ABSOLUTE_PATH 4 = STREAM_FLAGS_DISALLOW_QUERY 8 = STREAM_FLAGS_       DONTCACHEMAPPINGSCHEMA 16 = STREAM_FLAGS_DONTCACHETEMPLATE 32 = STREAM_FLAGS_DONTCACHEXSL</span><span class="sxs-lookup"><span data-stu-id="68333-159">1 = STREAM_FLAGS_DISALLOW_URL 2 = STREAM_FLAGS_DISALLOW_ABSOLUTE_PATH 4 = STREAM_FLAGS_DISALLOW_QUERY 8 = STREAM_FLAGS_       DONTCACHEMAPPINGSCHEMA 16 = STREAM_FLAGS_DONTCACHETEMPLATE 32 = STREAM_FLAGS_DONTCACHEXSL</span></span><br /><br /> <span data-ttu-id="68333-160">Дополнительные сведения об этих значениях приведены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="68333-160">Additional information about these values is provided in the next table.</span></span>|  
|<span data-ttu-id="68333-161">xml root</span><span class="sxs-lookup"><span data-stu-id="68333-161">xml root</span></span>||<span data-ttu-id="68333-162">Это свойство используется для определения корневого тега для итогового XML.</span><span class="sxs-lookup"><span data-stu-id="68333-162">This property is used to define a root tag for the resulting XML.</span></span> <span data-ttu-id="68333-163">Например, в случае выполнения запросов SQL к базе данных и отсутствия в итоговом XML-документе одного корневого элемента, значение этого свойства используется для добавления одного корневого элемента в документ.</span><span class="sxs-lookup"><span data-stu-id="68333-163">For example, if you execute SQL queries against the database and the resulting XML document has no single root element, the value of the property is used to add a single root element to the document.</span></span><br /><br /> <span data-ttu-id="68333-164">Пример использования этого свойства см. в разделе [исполнение SQL-запросов &#40;поставщика SQLXMLOLEDB&#41;](executing-sql-queries-sqlxmloledb-provider.md).</span><span class="sxs-lookup"><span data-stu-id="68333-164">For an example in which this property is used, see [Executing SQL Queries &#40;SQLXMLOLEDB Provider&#41;](executing-sql-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="68333-165">xsl</span><span class="sxs-lookup"><span data-stu-id="68333-165">xsl</span></span>||<span data-ttu-id="68333-166">Это свойство используется для указания имени файла XSL, когда требуется применить преобразование XSL к XML-документу, возвращенному запросом.</span><span class="sxs-lookup"><span data-stu-id="68333-166">This property is used to specify the XSL file name when you want to apply XSL transformation to the XML document returned by the query.</span></span><br /><br /> <span data-ttu-id="68333-167">Указываемый путь может быть относительным (xyz/abc/МойXSL.xsl) или абсолютным (C:\МояПапка\abc\МойXSL.xsl).</span><span class="sxs-lookup"><span data-stu-id="68333-167">The path that is specified can be relative (xyz/abc/MyXSL.xsl) or absolute (C:\MyFolder\abc\MyXSL.xsl).</span></span><br /><br /> <span data-ttu-id="68333-168">Если указан относительный путь, то для разрешения относительного пути используется базовый путь, заданный свойством базового пути.</span><span class="sxs-lookup"><span data-stu-id="68333-168">If a relative path is specified, the base path that is specified by the Base Path property is used to resolve the relative path.</span></span> <span data-ttu-id="68333-169">Если в свойстве базового пути не указан путь, то относительный путь указывается относительно текущего каталога.</span><span class="sxs-lookup"><span data-stu-id="68333-169">If no path has been specified in the Base Path property, the relative path is relative to the current directory.</span></span><br /><br /> <span data-ttu-id="68333-170">Пример использования этого свойства см. в разделе применение преобразования XSL (SQLXMLOLEDB Provider).</span><span class="sxs-lookup"><span data-stu-id="68333-170">For an example in which this property is used, see Applying an XSL Transformation (SQLXMLOLEDB Provider).</span></span>|  
  
 <span data-ttu-id="68333-171">В следующей таблице содержатся описания значений свойств флагов потока SS.</span><span class="sxs-lookup"><span data-stu-id="68333-171">The following table contains descriptions of the ss Stream Flags property values.</span></span>  
  
|<span data-ttu-id="68333-172">Значение свойства</span><span class="sxs-lookup"><span data-stu-id="68333-172">Property value</span></span>|<span data-ttu-id="68333-173">Описание</span><span class="sxs-lookup"><span data-stu-id="68333-173">Description</span></span>|  
|--------------------|-----------------|  
|<span data-ttu-id="68333-174">STREAM_FLAGS_DISALLOW_URL</span><span class="sxs-lookup"><span data-stu-id="68333-174">STREAM_FLAGS_DISALLOW_URL</span></span>|<span data-ttu-id="68333-175">URL-адреса не принимаются для схем сопоставления или XSL.</span><span class="sxs-lookup"><span data-stu-id="68333-175">URLs are not accepted for mapping schemas or XSL.</span></span>|  
|<span data-ttu-id="68333-176">STREAM_FLAGS_DISALLOW_ABSOLTE_PATH</span><span class="sxs-lookup"><span data-stu-id="68333-176">STREAM_FLAGS_DISALLOW_ABSOLTE_PATH</span></span>|<span data-ttu-id="68333-177">Путь, указываемый для схемы сопоставления или XSL, должен задаваться относительно базового пути самого шаблона.</span><span class="sxs-lookup"><span data-stu-id="68333-177">A path that is specified for a mapping schema or for XSL must be relative to the base path of the template itself.</span></span>|  
|<span data-ttu-id="68333-178">STREAM_FLAGS_DISALLOW_QUERY</span><span class="sxs-lookup"><span data-stu-id="68333-178">STREAM_FLAGS_DISALLOW_QUERY</span></span>|<span data-ttu-id="68333-179">Запросы недопустимы в шаблоне.</span><span class="sxs-lookup"><span data-stu-id="68333-179">Queries are not allowed in a template.</span></span>|  
|<span data-ttu-id="68333-180">STREAM_FLAGS_DONTCACHEMAPPINGSCHEMA</span><span class="sxs-lookup"><span data-stu-id="68333-180">STREAM_FLAGS_DONTCACHEMAPPINGSCHEMA</span></span>|<span data-ttu-id="68333-181">Схема сопоставления не кэшируется.</span><span class="sxs-lookup"><span data-stu-id="68333-181">The mapping schema is not cached.</span></span> <span data-ttu-id="68333-182">Значение этого свойства полезно на стадии разработки базы данных, когда схемы базы данных часто изменяются.</span><span class="sxs-lookup"><span data-stu-id="68333-182">This property value is useful during the database development phase, when database schemas are subject to alteration.</span></span>|  
|<span data-ttu-id="68333-183">STREAM_FLAGS_DONTCACHETEMPLATE</span><span class="sxs-lookup"><span data-stu-id="68333-183">STREAM_FLAGS_DONTCACHETEMPLATE</span></span>|<span data-ttu-id="68333-184">Шаблоны не кэшируются.</span><span class="sxs-lookup"><span data-stu-id="68333-184">Templates are not cached.</span></span>|  
|<span data-ttu-id="68333-185">STREAM_FLAGS_DONTCACHEXSL</span><span class="sxs-lookup"><span data-stu-id="68333-185">STREAM_FLAGS_DONTCACHEXSL</span></span>|<span data-ttu-id="68333-186">XSL не кэшируется.</span><span class="sxs-lookup"><span data-stu-id="68333-186">XSL is not cached.</span></span>|  
  
  
