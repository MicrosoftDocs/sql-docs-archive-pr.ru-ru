---
title: Настройка безопасности диалогов для уведомлений о событиях | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- event notifications [SQL Server], security
ms.assetid: 12afbc84-2d2a-4452-935e-e1c70e8c53c1
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: d83bfe63c3a9b24c2be8d08916dd2384c59edc93
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666994"
---
# <a name="configure-dialog-security-for-event-notifications"></a><span data-ttu-id="56f14-102">Настройка безопасности диалогов для уведомлений о событиях</span><span class="sxs-lookup"><span data-stu-id="56f14-102">Configure Dialog Security for Event Notifications</span></span>
  [!INCLUDE[ssSB](../../includes/sssb-md.md)] <span data-ttu-id="56f14-103">на удаленном сервере, необходимо настроить безопасность диалога.</span><span class="sxs-lookup"><span data-stu-id="56f14-103">dialog security should be configured for event notifications that send messages to a service broker on a remote server.</span></span> <span data-ttu-id="56f14-104">Безопасность диалога должна настраиваться вручную согласно модели полной безопасности диалога компонента [!INCLUDE[ssSB](../../includes/sssb-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="56f14-104">Dialog security must be manually configured according to the [!INCLUDE[ssSB](../../includes/sssb-md.md)] dialog full-security model.</span></span> <span data-ttu-id="56f14-105">Модель полной безопасности включает шифрование и дешифрование сообщений, посылаемых на удаленный сервер и принимаемых с этого сервера.</span><span class="sxs-lookup"><span data-stu-id="56f14-105">The full-security model enables encryption and decryption of messages that are sent to and from remote servers.</span></span> <span data-ttu-id="56f14-106">Хотя уведомления о событиях посылаются в одном направлении, другие сообщения, например ошибки, возвращаются в противоположном направлении.</span><span class="sxs-lookup"><span data-stu-id="56f14-106">Although event notifications are sent in one direction, other messages, such as errors, are also returned in the opposite direction.</span></span>  
  
## <a name="configuring-dialog-security-for-event-notifications"></a><span data-ttu-id="56f14-107">Настройка безопасности диалога для уведомлений о событиях</span><span class="sxs-lookup"><span data-stu-id="56f14-107">Configuring Dialog Security for Event Notifications</span></span>  
 <span data-ttu-id="56f14-108">Процесс, необходимый для реализации безопасности диалога для уведомлений о событиях, описан в последующих шагах.</span><span class="sxs-lookup"><span data-stu-id="56f14-108">The process required to implement dialog security for event notification is described in the following steps.</span></span> <span data-ttu-id="56f14-109">Эти шаги включают в себя действия, которые должны предприниматься как на исходном сервере, так и на целевом сервере.</span><span class="sxs-lookup"><span data-stu-id="56f14-109">These steps include actions to take on both the source server and the target server.</span></span> <span data-ttu-id="56f14-110">Исходным сервером является сервер, на котором создаются уведомления о событиях.</span><span class="sxs-lookup"><span data-stu-id="56f14-110">The source server is the server on which the event notification is being created.</span></span> <span data-ttu-id="56f14-111">Целевым сервером является сервер, получающий сообщение уведомления о событии.</span><span class="sxs-lookup"><span data-stu-id="56f14-111">The target server is the server that receives the event notification message.</span></span> <span data-ttu-id="56f14-112">Действия в каждом шаге как для исходного, так и для целевого сервера должны быть завершены перед переходом к следующему шагу.</span><span class="sxs-lookup"><span data-stu-id="56f14-112">You must complete the actions in each step for both the source server and the target server before you continue to the next step.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="56f14-113">Все сертификаты должны создаваться с допустимыми датами начала и окончания.</span><span class="sxs-lookup"><span data-stu-id="56f14-113">All certificates must be created with valid start and expiration dates.</span></span>  
  
 <span data-ttu-id="56f14-114">**Шаг 1. Задайте номер порта TCP и имя целевой службы.**</span><span class="sxs-lookup"><span data-stu-id="56f14-114">**Step 1: Establish a TCP port number and target service name.**</span></span>  
  
 <span data-ttu-id="56f14-115">Задайте порт TCP, через который как исходный, так и целевой серверы будут получать сообщения.</span><span class="sxs-lookup"><span data-stu-id="56f14-115">Establish the TCP port on which both the source server and the target server will receive messages.</span></span> <span data-ttu-id="56f14-116">Необходимо также определить имя целевой службы.</span><span class="sxs-lookup"><span data-stu-id="56f14-116">You must also determine the name of the target service.</span></span>  
  
 <span data-ttu-id="56f14-117">**Шаг 2. Настройте шифрование и совместное использование сертификата для проверки подлинности на уровне базы данных.**</span><span class="sxs-lookup"><span data-stu-id="56f14-117">**Step 2: Configure encryption and certificate sharing for database-level authentication.**</span></span>  
  
 <span data-ttu-id="56f14-118">Как на исходном, так и на целевом серверах выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="56f14-118">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="56f14-119">Исходный сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-119">Source server</span></span>|<span data-ttu-id="56f14-120">Целевой сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-120">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="56f14-121">Выберите или создайте базу данных, в которой будут содержаться уведомление о событии и главный ключ.</span><span class="sxs-lookup"><span data-stu-id="56f14-121">Choose or create a database to hold the event notification and master key.</span></span>|<span data-ttu-id="56f14-122">Выберите или создайте базу данных, в которой будет содержаться главный ключ.</span><span class="sxs-lookup"><span data-stu-id="56f14-122">Choose or create a database to hold the master key.</span></span>|  
|<span data-ttu-id="56f14-123">Если для базы данных-источника не существует главного ключа, [создайте главный ключ](/sql/t-sql/statements/create-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="56f14-123">If no master key exists for the source database, [create a master key](/sql/t-sql/statements/create-master-key-transact-sql).</span></span> <span data-ttu-id="56f14-124">Главный ключ необходим как в исходной, так и в целевой базах данных для защиты их соответствующих сертификатов.</span><span class="sxs-lookup"><span data-stu-id="56f14-124">A master key is required on both the source and target databases to help secure their respective certificates.</span></span>|<span data-ttu-id="56f14-125">Если для целевой базы данных не существует главного ключа, создайте главный ключ.</span><span class="sxs-lookup"><span data-stu-id="56f14-125">If no master key exists for the target database, create a master key.</span></span>|  
|<span data-ttu-id="56f14-126">[Создайте имя входа](/sql/t-sql/statements/create-login-transact-sql) и соответствующую [учетную запись пользователя](/sql/t-sql/statements/create-user-transact-sql) для базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="56f14-126">[Create a login](/sql/t-sql/statements/create-login-transact-sql) and a corresponding [user](/sql/t-sql/statements/create-user-transact-sql) for the source database.</span></span>|<span data-ttu-id="56f14-127">Создайте имя входа и соответствующую учетную запись пользователя для целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-127">Create a login and a corresponding user for the target database.</span></span>|  
|<span data-ttu-id="56f14-128">[Создайте сертификат](/sql/t-sql/statements/create-certificate-transact-sql) , владельцем которого является пользователь базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="56f14-128">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) that is owned by the user of the source database.</span></span>|<span data-ttu-id="56f14-129">Создайте сертификат, владельцем которого является пользователь целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-129">Create a certificate that is owned by the user of the target database.</span></span>|  
|<span data-ttu-id="56f14-130">[Создайте резервную копию сертификата](/sql/t-sql/statements/backup-certificate-transact-sql) в файле, доступ к которому может иметь целевой сервер.</span><span class="sxs-lookup"><span data-stu-id="56f14-130">[Back up the certificate](/sql/t-sql/statements/backup-certificate-transact-sql) to a file that can be accessed by the target server.</span></span>|<span data-ttu-id="56f14-131">Создайте резервную копию сертификата в файле, доступ к которому может иметь исходный сервер.</span><span class="sxs-lookup"><span data-stu-id="56f14-131">Back up the certificate to a file that can be accessed by the source server.</span></span>|  
|<span data-ttu-id="56f14-132">[Создайте учетную запись пользователя](/sql/t-sql/statements/create-user-transact-sql), задав пользователя для целевой базы данных, а также указав WITHOUT LOGIN.</span><span class="sxs-lookup"><span data-stu-id="56f14-132">[Create a user](/sql/t-sql/statements/create-user-transact-sql), specifying the user of the target database, and WITHOUT LOGIN.</span></span> <span data-ttu-id="56f14-133">Этот пользователь будет владеть сертификатом целевой базы данных, который должен быть создан из файла резервной копии.</span><span class="sxs-lookup"><span data-stu-id="56f14-133">This user will own the target database certificate to be created from the backup file.</span></span> <span data-ttu-id="56f14-134">Пользователь не должен быть сопоставлен с входным именем, т.к. единственной целью этого пользователя является владение сертификатом целевой базы данных, созданным на следующем шаге 3.</span><span class="sxs-lookup"><span data-stu-id="56f14-134">The user does not have to be mapped to a login, because the only purpose of this user is to own the target database certificate created in step 3 that follows.</span></span>|<span data-ttu-id="56f14-135">Создайте учетную запись пользователя, задав пользователя для базы данных-источника, а также указав WITHOUT LOGIN.</span><span class="sxs-lookup"><span data-stu-id="56f14-135">Create a user, specifying the user of the source database, and WITHOUT LOGIN.</span></span> <span data-ttu-id="56f14-136">Этот пользователь будет владеть сертификатом базы данных-источника, который должен быть создан из файла резервной копии.</span><span class="sxs-lookup"><span data-stu-id="56f14-136">This user will own the source database certificate to be created from the backup file.</span></span> <span data-ttu-id="56f14-137">Пользователь не должен быть сопоставлен с входным именем, т.к. единственной целью этого пользователя является владение сертификатом базы данных-источника, созданным на следующем шаге 3.</span><span class="sxs-lookup"><span data-stu-id="56f14-137">The user does not have to be mapped to a login, because the only purpose of this user is to own the source database certificate created in step 3 that follows.</span></span>|  
  
 <span data-ttu-id="56f14-138">**Шаг 3. Сделайте общими сертификаты и предоставьте разрешения для проверки подлинности на уровне базы данных.**</span><span class="sxs-lookup"><span data-stu-id="56f14-138">**Step 3: Share certificates and grant permissions for database-level authentication.**</span></span>  
  
 <span data-ttu-id="56f14-139">Как на исходном, так и на целевом серверах выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="56f14-139">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="56f14-140">Исходный сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-140">Source server</span></span>|<span data-ttu-id="56f14-141">Целевой сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-141">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="56f14-142">[Создайте сертификат](/sql/t-sql/statements/create-certificate-transact-sql) из файла резервной копии целевого сертификата, задав в качестве владельца пользователя целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-142">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) from the backup file of the target certificate, specifying the target database user as the owner.</span></span>|<span data-ttu-id="56f14-143">Создайте сертификат из файла резервной копии исходного сертификата, задав в качестве владельца пользователя базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="56f14-143">Create a certificate from the backup file of the source certificate, specifying the source database user as the owner.</span></span>|  
|<span data-ttu-id="56f14-144">[Предоставьте разрешение](/sql/t-sql/statements/grant-transact-sql) для создания уведомления о событии пользователю базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="56f14-144">[Grant permission](/sql/t-sql/statements/grant-transact-sql) to create the event notification to the source database user.</span></span> <span data-ttu-id="56f14-145">Дополнительные сведения об этом разрешении см. в разделе [CREATE EVENT NOTIFICATION (Transact-SQL)](/sql/t-sql/statements/create-event-notification-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="56f14-145">For more information about this permission, see [CREATE EVENT NOTIFICATION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-notification-transact-sql).</span></span>|<span data-ttu-id="56f14-146">Предоставьте разрешение REFERENCES пользователю целевой базы данных на существующий контракт компонента [!INCLUDE[ssSB](../../includes/sssb-md.md)] для уведомлений о событиях: `https://schemas.microsoft.com/SQL/Notifications/PostEventNotification`.</span><span class="sxs-lookup"><span data-stu-id="56f14-146">Grant REFERENCES permission to the target database user on the existing event notifications [!INCLUDE[ssSB](../../includes/sssb-md.md)] contract: `https://schemas.microsoft.com/SQL/Notifications/PostEventNotification`.</span></span>|  
|<span data-ttu-id="56f14-147">[Создайте привязку удаленной службы](/sql/t-sql/statements/create-remote-service-binding-transact-sql) к целевой службе и задайте учетные данные пользователя целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-147">[Create a remote service binding](/sql/t-sql/statements/create-remote-service-binding-transact-sql) to the target service and specify the credentials of the target database user.</span></span> <span data-ttu-id="56f14-148">Привязка удаленной службы обеспечивает то, что при помощи открытого ключа в сертификате, владельцем которого является пользователь базы данных-источника, будет осуществляться проверка подлинности сообщений, посылаемых на целевой сервер.</span><span class="sxs-lookup"><span data-stu-id="56f14-148">The remote service binding guarantees that the public key in the certificate owned by the source database user will authenticate messages that are sent to the target server.</span></span>|<span data-ttu-id="56f14-149">[Предоставьте](/sql/t-sql/statements/grant-transact-sql) разрешения CREATE QUEUE, CREATE SERVICE и CREATE SCHEMA пользователю целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-149">[Grant](/sql/t-sql/statements/grant-transact-sql) CREATE QUEUE, CREATE SERVICE, and CREATE SCHEMA permissions to the target database user.</span></span>|  
||<span data-ttu-id="56f14-150">Если вы еще не подключены к базе данных в качестве пользователя целевой базы данных, выполните это теперь.</span><span class="sxs-lookup"><span data-stu-id="56f14-150">If not already connected to the database as the target database user, do so now.</span></span>|  
||<span data-ttu-id="56f14-151">[Создайте очередь](/sql/t-sql/statements/create-queue-transact-sql) для приема сообщений с уведомлениями о событиях и [создайте службу](/sql/t-sql/statements/create-service-transact-sql) для доставки сообщений.</span><span class="sxs-lookup"><span data-stu-id="56f14-151">[Create a queue](/sql/t-sql/statements/create-queue-transact-sql) to receive the event notification messages and [create a service](/sql/t-sql/statements/create-service-transact-sql) to deliver the messages.</span></span>|  
||<span data-ttu-id="56f14-152">[Предоставьте разрешение SEND](/sql/t-sql/statements/grant-transact-sql) на целевую службу пользователю базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="56f14-152">[Grant SEND permission](/sql/t-sql/statements/grant-transact-sql) on the target service to the source database user.</span></span>|  
|<span data-ttu-id="56f14-153">Предоставьте целевому серверу идентификатор компонента service broker базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="56f14-153">Provide the service broker identifier of the source database to the target server.</span></span> <span data-ttu-id="56f14-154">Этот идентификатор можно получить, запросив столбец **service_broker_guid** представления каталога [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="56f14-154">This identifier can be obtained by querying the **service_broker_guid** column of the [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) catalog view.</span></span> <span data-ttu-id="56f14-155">Для уведомления о событии на уровне сервера используйте идентификатор компонента Service Broker базы данных **msdb**.</span><span class="sxs-lookup"><span data-stu-id="56f14-155">For a server-level event notification, use the service broker identifier of **msdb**.</span></span>|<span data-ttu-id="56f14-156">Предоставьте исходному серверу идентификатор компонента service broker целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-156">Provide the service broker identifier of the target database to the source server.</span></span>|  
  
 <span data-ttu-id="56f14-157">**Шаг 4. Создайте маршруты и настройте проверку подлинности на уровне сервера.**</span><span class="sxs-lookup"><span data-stu-id="56f14-157">**Step 4: Create routes and set up server-level authentication.**</span></span>  
  
 <span data-ttu-id="56f14-158">Как на исходном, так и на целевом серверах выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="56f14-158">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="56f14-159">Исходный сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-159">Source server</span></span>|<span data-ttu-id="56f14-160">Целевой сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-160">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="56f14-161">[Создайте маршрут](/sql/t-sql/statements/create-route-transact-sql) к целевой службе и задайте идентификатор компонента Service Broker целевой базы данных, а также согласованный номер порта TCP.</span><span class="sxs-lookup"><span data-stu-id="56f14-161">[Create a route](/sql/t-sql/statements/create-route-transact-sql) to the target service, and specify the service broker identifier of the target database and the agreed-upon TCP port number.</span></span>|<span data-ttu-id="56f14-162">Создайте маршрут к исходной службе и задайте идентификатор компонента service broker базы данных-источника, а также согласованный номер порта TCP.</span><span class="sxs-lookup"><span data-stu-id="56f14-162">Create a route to the source service, and specify the service broker identifier of the source database and the agreed-upon TCP port number.</span></span> <span data-ttu-id="56f14-163">Для задания исходной службы используйте следующую поставляемую службу: `https://schemas.microsoft.com/SQL/Notifications/EventNotificationService`.</span><span class="sxs-lookup"><span data-stu-id="56f14-163">To specify the source service, use the following supplied service: `https://schemas.microsoft.com/SQL/Notifications/EventNotificationService`.</span></span>|  
|<span data-ttu-id="56f14-164">Переключитесь на базу данных **master** для настройки проверки подлинности на уровне сервера.</span><span class="sxs-lookup"><span data-stu-id="56f14-164">Switch to the **master** database to configure server-level authentication.</span></span>|<span data-ttu-id="56f14-165">Переключитесь на базу данных **master** для настройки проверки подлинности на уровне сервера.</span><span class="sxs-lookup"><span data-stu-id="56f14-165">Switch to the **master** database to configure server-level authentication.</span></span>|  
|<span data-ttu-id="56f14-166">Если для базы данных **master** не существует главного ключа, [создайте главный ключ](/sql/t-sql/statements/create-master-key-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="56f14-166">If no master key exists for the **master** database, [create a master key](/sql/t-sql/statements/create-master-key-transact-sql).</span></span>|<span data-ttu-id="56f14-167">Если для базы данных **master** не существует главного ключа, создайте главный ключ.</span><span class="sxs-lookup"><span data-stu-id="56f14-167">If no master key exists for the **master** database, create a master key.</span></span>|  
|<span data-ttu-id="56f14-168">[Создайте сертификат](/sql/t-sql/statements/create-certificate-transact-sql) , выполняющий проверку подлинности базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-168">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) that authenticates the database.</span></span>|<span data-ttu-id="56f14-169">Создайте сертификат, выполняющий проверку подлинности базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-169">Create a certificate that authenticates the database.</span></span>|  
|<span data-ttu-id="56f14-170">[Создайте резервную копию сертификата](/sql/t-sql/statements/backup-certificate-transact-sql) в файле, доступ к которому может иметь целевой сервер.</span><span class="sxs-lookup"><span data-stu-id="56f14-170">[Back up the certificate](/sql/t-sql/statements/backup-certificate-transact-sql) to a file that can be accessed by the target server.</span></span>|<span data-ttu-id="56f14-171">Создайте резервную копию сертификата в файле, доступ к которому может иметь исходный сервер.</span><span class="sxs-lookup"><span data-stu-id="56f14-171">Back up the certificate to a file that can be accessed by the source server.</span></span>|  
|<span data-ttu-id="56f14-172">[Создайте конечную точку](/sql/t-sql/statements/create-endpoint-transact-sql)и задайте согласованный номер порта TCP, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *имя_сертификата*) и имя сертификата, выполняющего проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-172">[Create an endpoint](/sql/t-sql/statements/create-endpoint-transact-sql), and specify the agreed-upon TCP port number, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *certificate_name*), and the name of the authenticating certificate.</span></span>|<span data-ttu-id="56f14-173">Создайте конечную точку и задайте согласованный номер порта TCP, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *имя_сертификата*) и имя сертификата, выполняющего проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-173">Create an endpoint, and specify the agreed-upon TCP port number, FOR SERVICE_BROKER (AUTHENTICATION = CERTIFICATE *certificate_name*), and the name of the authenticating certificate.</span></span>|  
|<span data-ttu-id="56f14-174">[Создайте имя входа](/sql/t-sql/statements/create-login-transact-sql)и задайте входное имя целевого сервера.</span><span class="sxs-lookup"><span data-stu-id="56f14-174">[Create a login](/sql/t-sql/statements/create-login-transact-sql), and specify the login of the target server.</span></span>|<span data-ttu-id="56f14-175">Создайте имя входа и задайте входное имя исходного сервера.</span><span class="sxs-lookup"><span data-stu-id="56f14-175">Create a login, and specify the login of the source server.</span></span>|  
|<span data-ttu-id="56f14-176">[Предоставьте разрешение CONNECT](/sql/t-sql/statements/grant-transact-sql) на конечную точку для входного имени целевого средства проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-176">[Grant CONNECT permission](/sql/t-sql/statements/grant-transact-sql) on the endpoint to the target authenticator login.</span></span>|<span data-ttu-id="56f14-177">Предоставьте разрешение CONNECT на конечную точку для входного имени исходного средства проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-177">Grant CONNECT permission on the endpoint to the source authenticator login.</span></span>|  
|<span data-ttu-id="56f14-178">[Создайте учетную запись пользователя](/sql/t-sql/statements/create-user-transact-sql)и задайте входное имя целевого средства проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-178">[Create a user](/sql/t-sql/statements/create-user-transact-sql), and specify the target authenticator login.</span></span>|<span data-ttu-id="56f14-179">Создайте учетную запись пользователя и задайте входное имя исходного средства проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-179">Create a user, and specify the source authenticator login.</span></span>|  
  
 <span data-ttu-id="56f14-180">**Шаг 5. Сделайте общими сертификаты для проверки подлинности на уровне сервера и создайте уведомление о событии.**</span><span class="sxs-lookup"><span data-stu-id="56f14-180">**Step 5: Share certificates for server-level authentication and create the event notification.**</span></span>  
  
 <span data-ttu-id="56f14-181">Как на исходном, так и на целевом серверах выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="56f14-181">Complete the following actions on both the source and target servers.</span></span>  
  
|<span data-ttu-id="56f14-182">Исходный сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-182">Source server</span></span>|<span data-ttu-id="56f14-183">Целевой сервер</span><span class="sxs-lookup"><span data-stu-id="56f14-183">Target server</span></span>|  
|-------------------|-------------------|  
|<span data-ttu-id="56f14-184">[Создайте сертификат](/sql/t-sql/statements/create-certificate-transact-sql) из файла резервной копии целевого сертификата, задав в качестве владельца пользователя целевого средства проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-184">[Create a certificate](/sql/t-sql/statements/create-certificate-transact-sql) from the backup file of the target certificate, specifying the target authenticator user as the owner.</span></span>|<span data-ttu-id="56f14-185">Создайте сертификат из файла резервной копии исходного сертификата, задав в качестве владельца пользователя исходного средства проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="56f14-185">Create a certificate from the backup file of the source certificate, specifying the source authenticator user as the owner.</span></span>|  
|<span data-ttu-id="56f14-186">Переключитесь на базу данных-источник, на которой необходимо создать уведомление о событии, и если еще вы не подключены в качестве пользователя исходной базы данных, выполните это подключение.</span><span class="sxs-lookup"><span data-stu-id="56f14-186">Switch to the source database on which to create the event notification, and if you are not already connected as the source database user, do so now.</span></span>|<span data-ttu-id="56f14-187">Переключитесь на целевую базу данных для получения сообщений с уведомлениями о событиях.</span><span class="sxs-lookup"><span data-stu-id="56f14-187">Switch to the target database to receive event notification messages.</span></span>|  
|<span data-ttu-id="56f14-188">[Создайте уведомление о событии](/sql/t-sql/statements/create-event-notification-transact-sql)и задайте идентификатор компонента broker service целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="56f14-188">[Create the event notification](/sql/t-sql/statements/create-event-notification-transact-sql), and specify the broker service and identifier of the target database.</span></span>||  
  
## <a name="see-also"></a><span data-ttu-id="56f14-189">См. также:</span><span class="sxs-lookup"><span data-stu-id="56f14-189">See Also</span></span>  
 <span data-ttu-id="56f14-190">[GRANT (Transact-SQL)](/sql/t-sql/statements/grant-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-190">[GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql) </span></span>  
 <span data-ttu-id="56f14-191">[BACKUP CERTIFICATE (Transact-SQL)](/sql/t-sql/statements/backup-certificate-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-191">[BACKUP CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-certificate-transact-sql) </span></span>  
 <span data-ttu-id="56f14-192">[sys.databases (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-192">[sys.databases &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) </span></span>  
 <span data-ttu-id="56f14-193">[Иерархия средств шифрования](../security/encryption/encryption-hierarchy.md) </span><span class="sxs-lookup"><span data-stu-id="56f14-193">[Encryption Hierarchy](../security/encryption/encryption-hierarchy.md) </span></span>  
 <span data-ttu-id="56f14-194">[Реализация уведомлений о событиях](event-notifications.md) </span><span class="sxs-lookup"><span data-stu-id="56f14-194">[Implement Event Notifications](event-notifications.md) </span></span>  
 <span data-ttu-id="56f14-195">[CREATE MASTER KEY (Transact-SQL)](/sql/t-sql/statements/create-master-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-195">[CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql) </span></span>  
 <span data-ttu-id="56f14-196">[CREATE LOGIN (Transact-SQL)](/sql/t-sql/statements/create-login-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-196">[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) </span></span>  
 <span data-ttu-id="56f14-197">[CREATE USER (Transact-SQL)](/sql/t-sql/statements/create-user-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-197">[CREATE USER &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-user-transact-sql) </span></span>  
 <span data-ttu-id="56f14-198">[CREATE CERTIFICATE (Transact-SQL)](/sql/t-sql/statements/create-certificate-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-198">[CREATE CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-certificate-transact-sql) </span></span>  
 <span data-ttu-id="56f14-199">[CREATE REMOTE SERVICE BINDING (Transact-SQL)](/sql/t-sql/statements/create-remote-service-binding-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-199">[CREATE REMOTE SERVICE BINDING &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-remote-service-binding-transact-sql) </span></span>  
 <span data-ttu-id="56f14-200">[GRANT (Transact-SQL)](/sql/t-sql/statements/grant-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-200">[GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql) </span></span>  
 <span data-ttu-id="56f14-201">[CREATE ROUTE (Transact-SQL)](/sql/t-sql/statements/create-route-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-201">[CREATE ROUTE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-route-transact-sql) </span></span>  
 <span data-ttu-id="56f14-202">[CREATE QUEUE (Transact-SQL)](/sql/t-sql/statements/create-queue-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-202">[CREATE QUEUE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-queue-transact-sql) </span></span>  
 <span data-ttu-id="56f14-203">[CREATE SERVICE (Transact-SQL)](/sql/t-sql/statements/create-service-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-203">[CREATE SERVICE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-service-transact-sql) </span></span>  
 <span data-ttu-id="56f14-204">[CREATE ENDPOINT (Transact-SQL)](/sql/t-sql/statements/create-endpoint-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="56f14-204">[CREATE ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-endpoint-transact-sql) </span></span>  
 [<span data-ttu-id="56f14-205">CREATE EVENT NOTIFICATION (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="56f14-205">CREATE EVENT NOTIFICATION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-event-notification-transact-sql)  
  
  
