---
title: Новые&#39;в SQLXML 4,0 SP1 | Документация Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- registry keys [SQLXML]
- SQLNCLI, SQLXML
- what's new [SQLXML]
- SQLXML, what's new
- migrating SQLXML applications
- redistributing SQLXML
- SQL Server Native Client, SQLXML
- side-by-side installations [SQLXML]
ms.assetid: 48f7720b-1705-402d-93ce-097ff1737877
author: rothja
ms.author: jroth
ms.openlocfilehash: 880937520385fbe6ce64be3fdfcbbf7d11c73741
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729349"
---
# <a name="what39s-new-in-sqlxml-40-sp1"></a><span data-ttu-id="39435-102">Новые&#39;в SQLXML 4,0 SP1</span><span class="sxs-lookup"><span data-stu-id="39435-102">What&#39;s New in SQLXML 4.0 SP1</span></span>
  [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="39435-103">SQLXML 4.0 с пакетом обновления 1 (SP1) содержит различные обновления и улучшения.</span><span class="sxs-lookup"><span data-stu-id="39435-103">SQLXML 4.0 SP1 includes various updates and enhancements.</span></span> <span data-ttu-id="39435-104">В этом разделе содержится описание всех обновлений и предоставляются ссылки на более подробные сведения (если они доступны).</span><span class="sxs-lookup"><span data-stu-id="39435-104">This topic summarizes the updates and provides links to more detailed information, where available.</span></span> <span data-ttu-id="39435-105">SQLXML 4.0 с пакетом обновления 1 (SP1) предоставляет улучшения для поддержки новых типов данных, появившихся в [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="39435-105">SQLXML 4.0 SP1 provides additional enhancements to support the new data types introduced in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="39435-106">В этом разделе рассматриваются следующие вопросы.</span><span class="sxs-lookup"><span data-stu-id="39435-106">This topic includes the following subjects:</span></span>  
  
-   <span data-ttu-id="39435-107">Установка SQLXML 4.0 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="39435-107">Installing SQLXML 4.0 SP1</span></span>  
  
-   <span data-ttu-id="39435-108">Проблемы параллельной установки</span><span class="sxs-lookup"><span data-stu-id="39435-108">Side-by-Side Installation Issues</span></span>  
  
-   <span data-ttu-id="39435-109">SQLXML 4.0 и MSXML</span><span class="sxs-lookup"><span data-stu-id="39435-109">SQLXML 4.0 and MSXML</span></span>  
  
-   <span data-ttu-id="39435-110">Распространение SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="39435-110">Redistributing SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="39435-111">Поддержка [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] собственного клиента</span><span class="sxs-lookup"><span data-stu-id="39435-111">Support for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client</span></span>  
  
-   <span data-ttu-id="39435-112">Поддержка новых типов данных [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]</span><span class="sxs-lookup"><span data-stu-id="39435-112">Support for Data Types Introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]</span></span>  
  
-   <span data-ttu-id="39435-113">Изменения в SQLXML 4.0, относящиеся к массовой загрузке XML</span><span class="sxs-lookup"><span data-stu-id="39435-113">XML Bulk Load Changes for SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="39435-114">Изменения в SQLXML 4.0, относящиеся к разделам реестра</span><span class="sxs-lookup"><span data-stu-id="39435-114">Registry Key Changes for SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="39435-115">Проблемы переноса</span><span class="sxs-lookup"><span data-stu-id="39435-115">Migration Issues</span></span>  
  
## <a name="installing-sqlxml-40-sp1"></a><span data-ttu-id="39435-116">Установка SQLXML 4.0 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="39435-116">Installing SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="39435-117">До версии [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] компонент SQLXML 4.0 распространялся с SQL Server и входил в состав установки по умолчанию всех версий SQL Server, за исключением SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="39435-117">Before [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], SQLXML 4.0 was released with SQL Server and was part of the default installation of all SQL Server versions except for SQL Server Express.</span></span> <span data-ttu-id="39435-118">Начиная с [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], последняя версия SQLXML (SQLXML 4.0 с пакетом обновления 1 (SP1)) больше не включается в состав SQL Server.</span><span class="sxs-lookup"><span data-stu-id="39435-118">Starting with [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], the latest version of SQLXML (SQLXML 4.0 SP1) is no longer included in SQL Server.</span></span> <span data-ttu-id="39435-119">Чтобы установить SQLXML 4,0 с пакетом обновления 1 (SP1), скачайте его из [расположения установки для sqlxml 4,0 SP1](https://www.microsoft.com/download/details.aspx?id=30403).</span><span class="sxs-lookup"><span data-stu-id="39435-119">To install SQLXML 4.0 SP1, download it from [Install Location for SQLXML 4.0 SP1](https://www.microsoft.com/download/details.aspx?id=30403).</span></span>  
  
 <span data-ttu-id="39435-120">Файлы SQLXML 4.0 с пакетом обновления 1 (SP1) устанавливаются в следующий каталог:</span><span class="sxs-lookup"><span data-stu-id="39435-120">The SQLXML 4.0 SP1 files are installed in the following location:</span></span>  
  
 `%PROGRAMFILES%\SQLXML 4.0\`  
  
> [!NOTE]  
>  <span data-ttu-id="39435-121">Все необходимые настройки реестра для SQLXML 4.0 вносятся в процессе установки.</span><span class="sxs-lookup"><span data-stu-id="39435-121">All appropriate registry settings for SQLXML 4.0 are made as part of the installation process.</span></span>  
  
 <span data-ttu-id="39435-122">Чтобы обеспечить эксплуатацию 32-разрядных приложений SQLXML под управлением WOW64 в 64-разрядных операционных системах Windows, запустите 64-разрядный пакет SQLXML 4.0 с пакетом обновления 1 (SP1), имеющий имя sqlxml4.msi, который можно найти в центре загрузки.</span><span class="sxs-lookup"><span data-stu-id="39435-122">To allow 32-bit SQLXML applications to run under Windows on Windows (WOW64) on 64-bit Windows operating systems, run the 64-bit SQLXML 4.0 SP1 package, named sqlxml4.msi, which can be found on the Download Center.</span></span>  
  
#### <a name="uninstalling-sqlxml-40-sp1"></a><span data-ttu-id="39435-123">Удаление SQLXML 4.0 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="39435-123">Uninstalling SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="39435-124">Для SQLXML 3.0 с пакетом обновления 3 (SP3), SQLXML 4.0 и SQLXML 4.0 с пакетом обновления 1 (SP1) применяются общие разделы реестра.</span><span class="sxs-lookup"><span data-stu-id="39435-124">Shared registry keys exist between SQLXML 3.0 SP3, SQLXML 4.0 and SQLXML 4.0 SP1.</span></span> <span data-ttu-id="39435-125">При удалении более поздних версий SQLXML на том же компьютере, где установлен SQLXML 3.0 с пакетом обновления 3 (SP3), может потребоваться повторная установка SQLXML 3.0 с пакетом обновления 3 (SP3).</span><span class="sxs-lookup"><span data-stu-id="39435-125">If the later versions of SQLXML are uninstalled on the same computer which contains SQLXML 3.0 SP3, you might need to reinstall SQLXML 3.0 SP3.</span></span>  
  
## <a name="side-by-side-installation-issues"></a><span data-ttu-id="39435-126">Проблемы параллельной установки</span><span class="sxs-lookup"><span data-stu-id="39435-126">Side-by-Side Installation Issues</span></span>  
 <span data-ttu-id="39435-127">Процесс установки SQLXML 4.0 не удаляет файлы, установленные для прежних версий SQLXML.</span><span class="sxs-lookup"><span data-stu-id="39435-127">The installation process for SQLXML 4.0 does not remove the files that were installed by earlier versions of SQLXML.</span></span> <span data-ttu-id="39435-128">Поэтому возможно существование DLL-библиотек для нескольких различающихся версиями установок SQLXML на компьютере.</span><span class="sxs-lookup"><span data-stu-id="39435-128">Therefore, you can have DLLs for several different version-distinctive installations of SQLXML on your computer.</span></span> <span data-ttu-id="39435-129">Можно запускать установленные экземпляры параллельно.</span><span class="sxs-lookup"><span data-stu-id="39435-129">You can run the installations side-by-side.</span></span> <span data-ttu-id="39435-130">SQLXML 4.0 содержит как независимые от версии, так и зависимые от версии идентификаторы PROGID.</span><span class="sxs-lookup"><span data-stu-id="39435-130">SQLXML 4.0 includes both version-independent and version-dependent PROGIDs.</span></span> <span data-ttu-id="39435-131">Во всех рабочих приложениях должны использоваться зависимые от версии идентификаторы PROGID.</span><span class="sxs-lookup"><span data-stu-id="39435-131">All production applications should use version-dependent PROGIDs.</span></span>  
  
## <a name="sqlxml-40-sp1-and-msxml"></a><span data-ttu-id="39435-132">SQLXML 4.0 с пакетом обновления 1 (SP1) и MSXML</span><span class="sxs-lookup"><span data-stu-id="39435-132">SQLXML 4.0 SP1 and MSXML</span></span>  
 <span data-ttu-id="39435-133">SQLXML 4.0 не устанавливает MSXML.</span><span class="sxs-lookup"><span data-stu-id="39435-133">SQLXML 4.0 does not install MSXML.</span></span> <span data-ttu-id="39435-134">SQLXML 4.0 использует службы MSXML 6.0, которые устанавливаются в составе установки [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или более поздней установки.</span><span class="sxs-lookup"><span data-stu-id="39435-134">SQLXML 4.0 uses MSXML 6.0, which is installed as part of the [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later installation.</span></span>  
  
## <a name="redistributing-sqlxml-40-sp1"></a><span data-ttu-id="39435-135">Распространение SQLXML 4.0 с пакетом обновления 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="39435-135">Redistributing SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="39435-136">Предусмотрена возможность распространять SQLXML 4.0 с пакетом обновления 1 (SP1) с помощью распространяемого пакета установщика.</span><span class="sxs-lookup"><span data-stu-id="39435-136">You can distribute SQLXML 4.0 SP1 using the redistributable installer package.</span></span> <span data-ttu-id="39435-137">Один из способов установки нескольких пакетов в одном (с точки зрения пользователя) сеансе установки состоит в применении технологии построителей цепочек и загрузчиков.</span><span class="sxs-lookup"><span data-stu-id="39435-137">One way to install multiple packages in what seems to the user to be a single installation is to use chainer and bootstrapper technology.</span></span> <span data-ttu-id="39435-138">Дополнительные сведения см. в статьях Разработка пользовательского пакета загрузчика для Visual Studio 2005 и Добавление настраиваемых необходимых компонентов.</span><span class="sxs-lookup"><span data-stu-id="39435-138">For more information, see Authoring a Custom Bootstrapper Package for Visual Studio 2005 and Adding Custom Prerequisites.</span></span>  
  
 <span data-ttu-id="39435-139">Если приложение планируется использовать на платформе, отличной от той, на которой оно разрабатывалось, можно скачать из центра загрузки Майкрософт версии sqlncli.msi for x64, Itanium и x86.</span><span class="sxs-lookup"><span data-stu-id="39435-139">If your application targets a platform other than the one it was developed on, you can download versions of sqlncli.msi for x64, Itanium, and x86 from the Microsoft Download Center.</span></span>  
  
 <span data-ttu-id="39435-140">Существуют также отдельно распространяемые программы установки для MSXML 6.0 (msxml6.msi).</span><span class="sxs-lookup"><span data-stu-id="39435-140">There are also separate redistribution installation programs for MSXML 6.0 (msxml6.msi).</span></span> <span data-ttu-id="39435-141">Они находятся на установочном компакт-диске [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в следующем каталоге:</span><span class="sxs-lookup"><span data-stu-id="39435-141">These can be found on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation CD in the following location:</span></span>  
  
 `%CD%\Setup\`  
  
 <span data-ttu-id="39435-142">Эти установочные файлы можно использовать для установки MSXML 6.0 непосредственно с компакт-диска.</span><span class="sxs-lookup"><span data-stu-id="39435-142">These installation files can be used to install MSXML 6.0 directly from the CD.</span></span> <span data-ttu-id="39435-143">Их можно также использовать для свободного распространения MSXML 6.0 и SQLXML 4.0 с пакетом обновления 1 (SP1) вместе с собственными приложениями.</span><span class="sxs-lookup"><span data-stu-id="39435-143">They can also be used to freely redistribute MSXML 6.0 along with SQLXML 4.0 SP1 with your own custom applications.</span></span>  
  
 <span data-ttu-id="39435-144">Нужно также распространить собственный клиент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], если он используется с приложением как поставщик данных.</span><span class="sxs-lookup"><span data-stu-id="39435-144">You will also need to redistribute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client if you are using it as the data provider with your application.</span></span> <span data-ttu-id="39435-145">Дополнительные сведения см. в статье [Установка SQL Server Native Client](../native-client/applications/installing-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="39435-145">For more information, see [Installing SQL Server Native Client](../native-client/applications/installing-sql-server-native-client.md).</span></span>  
  
## <a name="support-for-sql-server-native-client"></a><span data-ttu-id="39435-146">Поддержка собственного клиента SQL Server</span><span class="sxs-lookup"><span data-stu-id="39435-146">Support for SQL Server Native Client</span></span>  
 <span data-ttu-id="39435-147">SQLXML 4,0 поддерживает поставщиков SQLOLEDB и [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="39435-147">SQLXML 4.0 supports both the SQLOLEDB and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client providers.</span></span> <span data-ttu-id="39435-148">Рекомендуется использовать одну и ту же версию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] поставщика собственного клиента, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] так как [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] собственный клиент разрабатывается для поддержки новых типов данных, поставляемых на сервере, таких как `Date, Time` `DateTime2` `dateTimeOffset` типы данных, и в [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] и поддерживаются [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] собственным клиентом.</span><span class="sxs-lookup"><span data-stu-id="39435-148">It is recommended that you use the same version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client provider and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] because [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is developed to support any new data types that ship in the server, such as the `Date, Time`, `DateTime2`, and `dateTimeOffset` data types in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client.</span></span>  
  
 <span data-ttu-id="39435-149">Собственный клиент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] — это технология доступа к данным, которая введена в [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="39435-149">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is a data access technology that was introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="39435-150">Она объединяет поставщика SQLOLEDB и драйвер SQLODBC в одну собственную динамическую библиотеку (DLL), а также предоставляет новую уникальную функциональность, независимую от компонентов доступа к данным MDAC и отличную от них.</span><span class="sxs-lookup"><span data-stu-id="39435-150">It combines the SQLOLEDB Provider and the SQLODBC Driver into one native dynamic link library (DLL), while also providing new functionality that is separate and distinct from the Microsoft Data Access Components (MDAC).</span></span>  
  
 <span data-ttu-id="39435-151">Технология собственного клиента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может применяться для создания новых или усовершенствования существующих приложений, которым требуется доступ к новым функциям [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], которые не поддерживаются SQLOLEDB и SQLODBC в компонентах MDAC и [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span><span class="sxs-lookup"><span data-stu-id="39435-151">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client can be used to create new applications or enhance existing applications that need to take advantage of features introduced in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that are not supported by SQLOLEDB and SQLODBC in MDAC and [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span></span> <span data-ttu-id="39435-152">Например, собственный клиент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] необходим для клиентских функций SQLXML, таких как FOR XML, чтобы использовать тип данных `xml`.</span><span class="sxs-lookup"><span data-stu-id="39435-152">For example, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is required for client-side SQLXML features, such as FOR XML, to use the `xml` data type.</span></span> <span data-ttu-id="39435-153">Дополнительные сведения см. в разделе [ФОРМАТИРОВАНИЕ XML на стороне клиента &#40;SQLXML 4,0&#41;](formatting/client-side-xml-formatting-sqlxml-4-0.md), [Использование ADO для выполнения запросов sqlxml 4,0](using-ado-to-execute-sqlxml-4-0-queries.md)и [SQL Server Native Client программировании](../native-client/sql-server-native-client-programming.md).</span><span class="sxs-lookup"><span data-stu-id="39435-153">For more information, see [Client-side XML Formatting &#40;SQLXML 4.0&#41;](formatting/client-side-xml-formatting-sqlxml-4-0.md), [Using ADO to Execute SQLXML 4.0 Queries](using-ado-to-execute-sqlxml-4-0-queries.md), and [SQL Server Native Client Programming](../native-client/sql-server-native-client-programming.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="39435-154">Между SQLXML 4.0 и SQLXML 3.0 нет полной обратной совместимости.</span><span class="sxs-lookup"><span data-stu-id="39435-154">SQLXML 4.0 is not completely backward compatible with SQLXML 3.0.</span></span> <span data-ttu-id="39435-155">В результате устранения некоторых ошибок и других функциональных изменений, особенно прекращения поддержки SQLXML ISAPI, нельзя использовать виртуальные каталоги IIS с SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="39435-155">Because of some bug fixes and other functional changes, particularly the removal of SQLXML ISAPI support, you cannot use IIS virtual directories with SQLXML 4.0.</span></span> <span data-ttu-id="39435-156">Большинство приложений будут работать с небольшими изменениями, но их необходимо проверить перед запуском в рабочей среде с SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="39435-156">Although most applications will run with minor modifications, you must test them before putting them into production with SQLXML 4.0.</span></span>  
  
## <a name="support-for-data-types-introduced-in-sql-server-2005-and-sql-server-2008"></a><span data-ttu-id="39435-157">Поддержка типов данных, появившихся в SQL Server 2005 и SQL Server 2008</span><span class="sxs-lookup"><span data-stu-id="39435-157">Support for Data Types Introduced in SQL Server 2005 and SQL Server 2008</span></span>  
 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]<span data-ttu-id="39435-158">введен `xml` тип данных, а SQLXML 4,0 поддерживает `xml` тип данных.</span><span class="sxs-lookup"><span data-stu-id="39435-158">introduced the `xml` data type, and SQLXML 4.0 supports the `xml` data type.</span></span> <span data-ttu-id="39435-159">Дополнительные сведения см. [в разделе Поддержка типов данных XML в SQLXML 4,0](xml-data-type-support-in-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="39435-159">For more information, see [xml Data Type Support in SQLXML 4.0](xml-data-type-support-in-sqlxml-4-0.md).</span></span>  
  
 <span data-ttu-id="39435-160">Примеры использования типа данных `xml` в SQLXML при сопоставлении XML-представлений, массовой загрузке XML и выполнении диаграмм обновления XML приведены в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="39435-160">For examples of how to use the `xml` data type in SQLXML when mapping XML views, bulk loading XML or executing XML updategrams, refer to examples provided in the following topics.</span></span>  
  
-   [<span data-ttu-id="39435-161">Сопоставление по умолчанию элементов и атрибутов XSD с таблицами и столбцами</span><span class="sxs-lookup"><span data-stu-id="39435-161">Default Mapping of XSD Elements and Attributes to Tables and Columns</span></span>](../sqlxml-annotated-xsd-schemas-using/default-mapping-of-xsd-elements-and-attributes-to-tables-and-columns-sqlxml-4-0.md)  
  
-   [<span data-ttu-id="39435-162">Вставка данных с помощью диаграмм обновления XML</span><span class="sxs-lookup"><span data-stu-id="39435-162">Inserting Data by Using XML Updategrams</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/updategrams/inserting-data-using-xml-updategrams-sqlxml-4-0.md)  
  
-   [<span data-ttu-id="39435-163">Примеры массовой загрузки XML-документов</span><span class="sxs-lookup"><span data-stu-id="39435-163">Examples of Bulk Loading XML Documents</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/xml-bulk-load-examples-sqlxml-4-0.md)  
  
 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]<span data-ttu-id="39435-164">появились `Date, Time` `DateTime2` типы данных **DateTimeOffset** ,, и.</span><span class="sxs-lookup"><span data-stu-id="39435-164">introduced the `Date, Time`, `DateTime2`, and **DateTimeOffset** data types.</span></span> <span data-ttu-id="39435-165">SQLXML 4.0 с пакетом обновления 1 (SP1) позволяет использовать эти четыре новых типа данных в качестве встроенных скалярных типов в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client OLE DB Provider (SQLNCLI10), который поставляется вместе с [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="39435-165">SQLXML 4.0 SP1 will enable these four new data types as built-in scalar types when used with [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client OLE DB Provider (SQLNCLI11), which ships in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
## <a name="xml-bulk-load-changes-for-sqlxml-40-sp1"></a><span data-ttu-id="39435-166">Изменения в SQLXML 4.0 с пакетом обновления 1 (SP1), относящиеся к массовой загрузке XML</span><span class="sxs-lookup"><span data-stu-id="39435-166">XML Bulk Load Changes for SQLXML 4.0 SP1</span></span>  
  
-   <span data-ttu-id="39435-167">Для SQLXML 4,0 поле переполнения SchemaGen создается с использованием `xml` типа данных.</span><span class="sxs-lookup"><span data-stu-id="39435-167">For SQLXML 4.0, the SchemaGen overflow field is created using the `xml` data type.</span></span> <span data-ttu-id="39435-168">Дополнительные сведения см. в разделе [SQL Serverная объектная модель для групповой загрузки XML](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/sql-server-xml-bulk-load-object-model-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="39435-168">For more information, see [SQL Server XML Bulk Load Object Model](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/sql-server-xml-bulk-load-object-model-sqlxml-4-0.md).</span></span>  
  
-   <span data-ttu-id="39435-169">Если ранее были созданы приложения [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic и нужно использовать SQLXML 4.0, необходимо перекомпилировать приложения со ссылкой на Xblkld4.dll.</span><span class="sxs-lookup"><span data-stu-id="39435-169">If you have previously created [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic applications and you want to use SQLXML 4.0, you must recompile the application with reference to Xblkld4.dll.</span></span>  
  
-   <span data-ttu-id="39435-170">Для приложений Visual Basic Scripting Edition необходимо зарегистрировать используемую DLL-библиотеку.</span><span class="sxs-lookup"><span data-stu-id="39435-170">For Visual Basic Scripting Edition applications, you must register the DLL you want to use.</span></span> <span data-ttu-id="39435-171">В следующем примере, если указаны независимые от версий идентификаторы PROGID, приложение зависит от последней зарегистрированной DLL-библиотеки:</span><span class="sxs-lookup"><span data-stu-id="39435-171">In the following example, if you specify version-independent PROGIDs, the application depends on the last registered DLL:</span></span>  
  
    ```  
    set objBulkLoad = CreateObject("SQLXMLBulkLoad.SQLXMLBulkLoad")   
    ```  
  
    > [!NOTE]  
    >  <span data-ttu-id="39435-172">Зависимый от версии идентификатор PROGID — SQLXMLBulkLoad.SQLXMLBulkLoad.4.0.</span><span class="sxs-lookup"><span data-stu-id="39435-172">The version-dependent PROGID is SQLXMLBulkLoad.SQLXMLBulkLoad.4.0.</span></span>  
  
## <a name="registry-key-changes-for-sqlxml-40"></a><span data-ttu-id="39435-173">Изменения в SQLXML 4.0, относящиеся к разделам реестра</span><span class="sxs-lookup"><span data-stu-id="39435-173">Registry Key Changes for SQLXML 4.0</span></span>  
 <span data-ttu-id="39435-174">В SQLXML 4.0 разделы реестра изменились по сравнению с предшествующими выпусками на следующие:</span><span class="sxs-lookup"><span data-stu-id="39435-174">In SQLXML 4.0, the registry keys have changed from the earlier releases to the following:</span></span>  
  
 <span data-ttu-id="39435-175">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\TemplateCacheSize</span><span class="sxs-lookup"><span data-stu-id="39435-175">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\TemplateCacheSize</span></span>  
  
 <span data-ttu-id="39435-176">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\SchemaCacheSize</span><span class="sxs-lookup"><span data-stu-id="39435-176">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\SchemaCacheSize</span></span>  
  
 <span data-ttu-id="39435-177">Необходимо изменить настройки, чтобы эти разделы были действительны в SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="39435-177">You must change the settings if you want these keys to be in effect for SQLXML 4.0.</span></span>  
  
 <span data-ttu-id="39435-178">Кроме того, в SQLXML 4.0 появились следующие разделы реестра:</span><span class="sxs-lookup"><span data-stu-id="39435-178">In addition, SQLXML 4.0 introduces the following registry keys:</span></span>  
  
-   `HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\ReportErrorsWithSQLInfo`  
  
     <span data-ttu-id="39435-179">По умолчанию SQLXML 4.0 возвращает собственные сведения об ошибке, предоставленные OLE DB и [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], вместо высокоуровневой ошибки (как в случае с прежними версиями SQLXML).</span><span class="sxs-lookup"><span data-stu-id="39435-179">By default, SQLXML 4.0 returns native error information provided by OLE DB and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instead of a high-level SQLXML error (as was the case in earlier versions of SQLXML).</span></span> <span data-ttu-id="39435-180">Если такое поведение нежелательно, значение типа DWORD этого раздела реестра должно быть установлено в 0 (значение по умолчанию — 1).</span><span class="sxs-lookup"><span data-stu-id="39435-180">If you do not want this behavior, the value of this registry key of type DWORD must be set to 0 (default is 1).</span></span>  
  
-   <span data-ttu-id="39435-181">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\FORXML_GenerateGUIDBraces</span><span class="sxs-lookup"><span data-stu-id="39435-181">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\FORXML_GenerateGUIDBraces</span></span>  
  
     <span data-ttu-id="39435-182">По умолчанию SQLXML возвращает значения идентификатора SQL Server GUID без заключения в фигурные скобки.</span><span class="sxs-lookup"><span data-stu-id="39435-182">By default, SQLXML return SQL Server GUID values without the enclosing braces.</span></span> <span data-ttu-id="39435-183">Если требуется, чтобы значение GUID возвращалось с фигурными скобками (например, {*some GUID*}), значение этого раздела реестра должно быть равно 1 (по умолчанию — 0).</span><span class="sxs-lookup"><span data-stu-id="39435-183">If you want the GUID value returned with the braces (for example, {*some GUID*}), value of this registry key must be set to 1 (default is 0).</span></span>  
  
-   <span data-ttu-id="39435-184">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\SQL2000CompatMode</span><span class="sxs-lookup"><span data-stu-id="39435-184">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\SQL2000CompatMode</span></span>  
  
     <span data-ttu-id="39435-185">По умолчанию, когда средство синтаксического анализа XML загружает данные, пробелы нормализуются в соответствии с правилами XML 1.0.</span><span class="sxs-lookup"><span data-stu-id="39435-185">By default, when the XML parser loads the data, white spaces are normalized according to the XML 1.0 rules.</span></span> <span data-ttu-id="39435-186">Это приводит к потере некоторых пробельных символов в данных.</span><span class="sxs-lookup"><span data-stu-id="39435-186">This results in loss of some of the white space characters in your data.</span></span> <span data-ttu-id="39435-187">Таким образом, текстовое представление данных может измениться после синтаксического анализа, хотя семантически данные остаются прежними.</span><span class="sxs-lookup"><span data-stu-id="39435-187">Thus, the textual representation of your data may not be the same after parsing, although semantically the data is the same.</span></span>  
  
     <span data-ttu-id="39435-188">Раздел представлен таким образом, что можно оставить пробельные символы в данных.</span><span class="sxs-lookup"><span data-stu-id="39435-188">This key is introduced so that you can choose to keep the white space characters in the data.</span></span> <span data-ttu-id="39435-189">Если добавить этот раздел реестра и установить его значение равным 0, пробельные символы (возврат каретки, переноса строки и табуляция) в XML-документе возвращаются закодированными для значений атрибутов.</span><span class="sxs-lookup"><span data-stu-id="39435-189">If you add this registry key and set its value to 0, white space characters (LF, CR, and tab) in the XML are returned encoded in case of attribute values.</span></span> <span data-ttu-id="39435-190">Для значений элементов возвращается закодированным только символ возврата каретки.</span><span class="sxs-lookup"><span data-stu-id="39435-190">In case of element values, only CR is returned encoded.</span></span>  
  
     <span data-ttu-id="39435-191">Пример:</span><span class="sxs-lookup"><span data-stu-id="39435-191">For example:</span></span>  
  
    ```  
    CREATE TABLE T( Col1 int, Col2 nvarchar(100));  
    GO  
    -- Insert data with tab, line feed and carriage return).  
    INSERT INTO T VALUES (1, 'This is a tab    . This is a line feed and CR   
     more text');  
    GO  
    -- Test this query (without the registry key).  
    SELECT * FROM T   
    FOR XML AUTO;  
    -- This is the result (no encoding of special characters).  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
      <T Col1="1"   
         Col2="This is a tab    . This is a line feed and CR   
     more text"/>  
    </r>  
    -- Now add registry key with value 0 and execute the query again.  
    -- Note the encoding for carriage return, line-feed and tab in the attribute value.  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
      <T Col1="1"   
         Col2="This is a tab    . This is a line feed and CR   
     more text"/>  
    </r>  
  
    -- Update the query and specify ELEMENTS directive  
    SELECT * FROM T  
    FOR XML AUTO, ELEMENTS  
    -- Only the carriage return is returned encoded.  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
       <T>  
          <Col1>1</Col1>  
          <Col2>This is a tab    . This is a line feed and CR   
     more text</Col2>  
       </T>  
    </r>  
    ```  
  
## <a name="migration-issues"></a><span data-ttu-id="39435-192">Проблемы переноса</span><span class="sxs-lookup"><span data-stu-id="39435-192">Migration Issues</span></span>  
 <span data-ttu-id="39435-193">Ниже перечислены проблемы, которые могут повлиять на перенос прежних приложений SQLXML на SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="39435-193">The following are issues that could impact migration of your legacy SQLXML applications to SQLXML 4.0.</span></span>  
  
### <a name="ado-and-sqlxml-40-queries"></a><span data-ttu-id="39435-194">Запросы ADO и SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="39435-194">ADO and SQLXML 4.0 Queries</span></span>  
 <span data-ttu-id="39435-195">В предыдущих версиях SQLXML выполнение запросов на основе URL-адресов поддерживалось с помощью виртуальных каталогов IIS и ISAPI-фильтра SQLXML.</span><span class="sxs-lookup"><span data-stu-id="39435-195">In earlier versions of SQLXML, support for URL-based query execution using IIS virtual directories and the SQLXML ISAPI filter was provided.</span></span> <span data-ttu-id="39435-196">Для приложений, использующих SQLXML 4.0, эта функция больше не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="39435-196">For applications that use SQLXML 4.0, this support is no longer available.</span></span>  
  
 <span data-ttu-id="39435-197">Вместо этого запросы, шаблоны и диаграммы обновления SQLXML могут выполняться с помощью расширений SQLXML для объектов данных ActiveX (ADO), появившихся в компонентах доступа к данным MDAC 2.6 и более поздних.</span><span class="sxs-lookup"><span data-stu-id="39435-197">Instead, SQLXML queries, templates, and updategrams can be executed by using the SQLXML extensions to ActiveX Data Objects (ADO) first introduced in Microsoft Data Access Components (MDAC) 2.6 and later.</span></span>  
  
 <span data-ttu-id="39435-198">Дополнительные сведения см. [в разделе Использование ADO для выполнения запросов SQLXML 4,0](using-ado-to-execute-sqlxml-4-0-queries.md).</span><span class="sxs-lookup"><span data-stu-id="39435-198">For more information, see [Using ADO to Execute SQLXML 4.0 Queries](using-ado-to-execute-sqlxml-4-0-queries.md).</span></span>  
  
### <a name="supportability-for-sqlxml-30-isapi-and-data-types-introduced-in-sql-server-2005"></a><span data-ttu-id="39435-199">Поддержка SQLXML 3.0 ISAPI и новых типов данных в SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="39435-199">Supportability for SQLXML 3.0 ISAPI and Data Types Introduced in SQL Server 2005</span></span>  
 <span data-ttu-id="39435-200">Поскольку поддержка ISAPI была удалена из SQLXML 4,0, если для решения требуются расширенные функции ввода данных, [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] такие как [тип данных XML](/sql/t-sql/xml/xml-transact-sql) или [определяемые пользователем типы данных](../../relational-databases/clr-integration-database-objects-user-defined-types/clr-user-defined-types.md) и веб-доступ, необходимо использовать другое решение, например [управляемые классы SQLXML](../sqlxml-annotated-xsd-schemas-xpath-queries/net-framework-classes/sqlxml-4-0-net-framework-support-managed-classes.md) или обработчик HTTP другого типа, например собственные веб-службы с поддержкой XML для SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="39435-200">Because ISAPI support has been removed from SQLXML 4.0, if your solution requires the enhanced data typing features introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] such as the [xml data type](/sql/t-sql/xml/xml-transact-sql) or [user-defined data types (UDTs)](../../relational-databases/clr-integration-database-objects-user-defined-types/clr-user-defined-types.md) and Web-based access, you will need to use another solution such as [SQLXML managed classes](../sqlxml-annotated-xsd-schemas-xpath-queries/net-framework-classes/sqlxml-4-0-net-framework-support-managed-classes.md) or another type of HTTP handler, such as Native XML Web Services for SQL Server 2005.</span></span>  
  
 <span data-ttu-id="39435-201">Кроме того, если эти расширения типов не требуются, можно продолжать использовать SQLXML 3,0 для подключения [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] установки.</span><span class="sxs-lookup"><span data-stu-id="39435-201">Alternately, if you do not require these type extensions, you can continue to use SQLXML 3.0 to connect to [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] installations.</span></span> <span data-ttu-id="39435-202">Средства поддержки ISAPI, реализованные в SQLXML 3.0, будут работать с более поздними версиями, но не поддерживают и не распознают тип данных `xml` и определяемые пользователем типы данных, поддержка которых появилась в [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="39435-202">The SQLXML 3.0 ISAPI support will work against these later versions but does not support or recognize the `xml` data type or UDT type support introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span>  
  
### <a name="xml-bulk-load-security-changes-for-temporary-files"></a><span data-ttu-id="39435-203">Изменения в массовой загрузке XML для временных файлов</span><span class="sxs-lookup"><span data-stu-id="39435-203">XML Bulk Load Security Changes for Temporary Files</span></span>  
 <span data-ttu-id="39435-204">Для SQLXML 4.0 и [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] разрешения на файл массовой загрузки XML предоставляются пользователю, выполняющему операцию массовой загрузки.</span><span class="sxs-lookup"><span data-stu-id="39435-204">For SQLXML 4.0 and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], XML Bulk Load file permissions are granted to the user executing the bulk load operation.</span></span> <span data-ttu-id="39435-205">Разрешения на чтение и запись наследуются из файловой системы.</span><span class="sxs-lookup"><span data-stu-id="39435-205">Read and Write permissions are inherited from the file system.</span></span> <span data-ttu-id="39435-206">В прежних выпусках SQLXML и SQL Server, массовая загрузка XML на основе SQLXML создавала временные файлы, которые не были защищены и могли быть считаны любым пользователем.</span><span class="sxs-lookup"><span data-stu-id="39435-206">In previous releases of SQLXML and SQL Server, XML Bulk Load under SQLXML would create temporary files that were not secured and could be readable by anyone.</span></span>  
  
### <a name="migration-issues-for-client-side-for-xml"></a><span data-ttu-id="39435-207">Проблемы миграции для FOR XML на клиентской стороне</span><span class="sxs-lookup"><span data-stu-id="39435-207">Migration Issues for Client-Side FOR XML</span></span>  
 <span data-ttu-id="39435-208">Из-за изменений в подсистеме выполнения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может возвращать различные значения в метаданных для базовой таблицы, которые будут возвращаться при выполнении запроса FOR XML [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="39435-208">Due to changes in the execution engine, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might return different values in the metadata for a base table than would be returned if the FOR XML query was executed under [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)].</span></span> <span data-ttu-id="39435-209">Если это происходит, форматирование результатов запроса FOR XML на стороне клиента будут иными, в зависимости о версии, на которой работал запрос.</span><span class="sxs-lookup"><span data-stu-id="39435-209">In cases where this occurs, client-side formatting of the FOR XML query results will have differing output depending on which version the query is run against.</span></span>  
  
 <span data-ttu-id="39435-210">Если запрос FOR XML выполняется на клиентской стороне с помощью SQLXML 3.0 над столбцом данных типа `xml`, данные в результатах будут возвращены как строка с полным преобразованием в сущность.</span><span class="sxs-lookup"><span data-stu-id="39435-210">If a FOR XML query is executed client-side using SQLXML 3.0 over an `xml` data type column, the data in the results will come back as a fully entitized string.</span></span> <span data-ttu-id="39435-211">В SQLXML 4.0, если собственный клиент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (SQLNCLI11) указан как поставщик, данные возвращаются как XML.</span><span class="sxs-lookup"><span data-stu-id="39435-211">In SQLXML 4.0, if the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client (SQLNCLI11) is specified as the provider, the data will be returned as XML.</span></span>  
  
  
