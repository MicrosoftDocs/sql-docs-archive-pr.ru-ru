---
title: Обновление приложения с переходом от SQL Server 2005 Native Client | Документы Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, updating applications
ms.assetid: 1e1e570c-7f14-4e16-beab-c328e3fbdaa8
author: rothja
ms.author: jroth
ms.openlocfilehash: 6db02837b854d237607eba7583d204a4860906b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738237"
---
# <a name="updating-an-application-from-sql-server-2005-native-client"></a><span data-ttu-id="a63b7-102">Обновление приложения с переходом от собственного клиента SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="a63b7-102">Updating an Application from SQL Server 2005 Native Client</span></span>
  <span data-ttu-id="a63b7-103">В этом разделе рассматриваются критические изменения в собственном клиенте [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в сравнении с собственным клиентом [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a63b7-103">This topic discusses the breaking changes in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client since [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="a63b7-104">При обновлении с компонентов доступа к данным MDAC к собственному клиенту [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] могут возникнуть определенные изменения в работе.</span><span class="sxs-lookup"><span data-stu-id="a63b7-104">When you upgrade from Microsoft Data Access Components (MDAC) to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, you might also see some behavior differences.</span></span> <span data-ttu-id="a63b7-105">Дополнительные сведения см. [в статье обновление приложения для SQL Server Native Client из MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span><span class="sxs-lookup"><span data-stu-id="a63b7-105">For more information, see [Updating an Application to SQL Server Native Client from MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="a63b7-106">Native Client 9.0 поставляется в составе [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a63b7-106">Native Client 9.0 shipped with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="a63b7-107">Native Client 10.0 поставляется в составе [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a63b7-107">Native Client 10.0 shipped with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  <span data-ttu-id="a63b7-108">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 10.5 поставляется в составе [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a63b7-108">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.5 shipped with [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span> <span data-ttu-id="a63b7-109">Клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 11.0 поставляется в составе [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] и [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a63b7-109">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 11.0 shipped with [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] and [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span>  
  
|<span data-ttu-id="a63b7-110">Изменения в поведении собственного клиента SQL Server, начиная с версии [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a63b7-110">Changed behavior in SQL Server Native Client Since [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span></span>|<span data-ttu-id="a63b7-111">Описание</span><span class="sxs-lookup"><span data-stu-id="a63b7-111">Description</span></span>|  
|------------------------------------------------------------------------------------|-----------------|  
|<span data-ttu-id="a63b7-112">OLE DB дополняет данные только до заданного масштаба.</span><span class="sxs-lookup"><span data-stu-id="a63b7-112">OLE DB pads only to the defined scale.</span></span>|<span data-ttu-id="a63b7-113">Что касается преобразований, при которых преобразованные данные передаются на сервер, то собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (начиная с версии [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) дополняет данные завершающими нулями только до максимальной длины значений `datetime`.</span><span class="sxs-lookup"><span data-stu-id="a63b7-113">For conversions where converted data is sent to the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) pads trailing zeros in data only up to the maximum length of `datetime` values.</span></span> <span data-ttu-id="a63b7-114">Собственный клиент SQL Server версии 9.0 дополнял данные до 9 разрядов.</span><span class="sxs-lookup"><span data-stu-id="a63b7-114">SQL Server Native Client 9.0 padded to 9 digits.</span></span>|  
|<span data-ttu-id="a63b7-115">Проверьте DBTYPE_DBTIMESTAMP для ICommandWithParameter::SetParameterInfo.</span><span class="sxs-lookup"><span data-stu-id="a63b7-115">Validate DBTYPE_DBTIMESTAMP for ICommandWithParameter::SetParameterInfo.</span></span>|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="a63b7-116">Собственный клиент (начиная с [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ) реализует OLE DB требование для *BScale* в Икоммандвиспараметер:: SetParameterInfo для задания точности доли секунды для DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="a63b7-116">Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) implements the OLE DB requirement for *bScale* in ICommandWithParameter::SetParameterInfo to be set to the fractional seconds' precision for DBTYPE_DBTIMESTAMP.</span></span>|  
|<span data-ttu-id="a63b7-117">`sp_columns`Хранимая процедура теперь возвращает значение **"No** " вместо **"No"** для IS_NULLABLE столбца.</span><span class="sxs-lookup"><span data-stu-id="a63b7-117">The `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for the IS_NULLABLE column.</span></span>|<span data-ttu-id="a63b7-118">Начиная с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственного клиента 10,0 ( [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ), `sp_columns` хранимая процедура теперь возвращает **"No** " вместо **"No"** для IS_NULLABLE столбца.</span><span class="sxs-lookup"><span data-stu-id="a63b7-118">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]), `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for an IS_NULLABLE column.</span></span>|  
|<span data-ttu-id="a63b7-119">SQLSetDescRec, SQLBindParameter и SQLBindCol теперь выполняют проверку согласованности.</span><span class="sxs-lookup"><span data-stu-id="a63b7-119">SQLSetDescRec, SQLBindParameter, and SQLBindCol now perform consistency checking.</span></span>|<span data-ttu-id="a63b7-120">До [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственного клиента 10,0 установка SQL_DESC_DATA_PTR не вызывала проверку согласованности для любого типа дескриптора в SQLSetDescRec, SQLBindParameter или SQLBindCol.</span><span class="sxs-lookup"><span data-stu-id="a63b7-120">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, setting SQL_DESC_DATA_PTR did not cause a consistency check for any descriptor type in SQLSetDescRec, SQLBindParameter, or SQLBindCol.</span></span>|  
|<span data-ttu-id="a63b7-121">Теперь Склкопидеск проверяет согласованность дескриптора.</span><span class="sxs-lookup"><span data-stu-id="a63b7-121">SQLCopyDesc now does descriptor consistency checking.</span></span>|<span data-ttu-id="a63b7-122">До [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственного клиента 10,0 склкопидеск не выполнял проверку согласованности, когда поле SQL_DESC_DATA_PTR было задано для конкретной записи.</span><span class="sxs-lookup"><span data-stu-id="a63b7-122">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLCopyDesc did not do a consistency check when the SQL_DESC_DATA_PTR field was set on a particular record.</span></span>|  
|<span data-ttu-id="a63b7-123">SQLGetDescRec больше не выполняет проверку согласованности дескрипторов.</span><span class="sxs-lookup"><span data-stu-id="a63b7-123">SQLGetDescRec no longer does a descriptor consistency check.</span></span>|<span data-ttu-id="a63b7-124">До [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственного клиента 10,0 SQLGetDescRec выполнил проверку согласованности дескрипторов при задании поля SQL_DESC_DATA_PTR.</span><span class="sxs-lookup"><span data-stu-id="a63b7-124">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLGetDescRec performed a descriptor consistency check when the SQL_DESC_DATA_PTR field was set.</span></span> <span data-ttu-id="a63b7-125">Этого не требовалось по спецификации ODBC, и собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] версии 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) и более поздних версий уже не проводит эту проверку согласованности.</span><span class="sxs-lookup"><span data-stu-id="a63b7-125">This was not required by the ODBC specification and in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) and later versions, this consistency check is no longer performed.</span></span>|  
|<span data-ttu-id="a63b7-126">При выходе значения даты за пределы диапазона теперь происходит возврат другого значения ошибки.</span><span class="sxs-lookup"><span data-stu-id="a63b7-126">Different error returned when date is out of range.</span></span>|<span data-ttu-id="a63b7-127">Что касается типа `datetime`, то при выходе даты за пределы диапазона допустимых значений собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (начиная с версии [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) возвращает номер ошибки, отличный от возвращаемого в предыдущих версиях.</span><span class="sxs-lookup"><span data-stu-id="a63b7-127">For the `datetime` type, a different error number will be returned by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) for an out-of-range date than was returned in earlier versions.</span></span><br /><br /> <span data-ttu-id="a63b7-128">В частности, собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] версии 9.0 возвращал ошибку 22007 для всех выходящих за пределы диапазона значений года при преобразовании строки в тип `datetime`, а собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] версии 10.0 (начиная с версии [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) возвращает ошибку 22008, если дата находится в пределах допустимого диапазона для типа `datetime2`, но за пределами диапазона, поддерживаемого типами `datetime` и `smalldatetime`.</span><span class="sxs-lookup"><span data-stu-id="a63b7-128">Specifically, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 returned 22007 for all out of range year values in string conversions to `datetime`, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client beginning with version 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) returns 22008 when the date is within the range supported by `datetime2` but outside the range supported by `datetime` or `smalldatetime`.</span></span>|  
|<span data-ttu-id="a63b7-129">В значении `datetime` усекаются доли секунды, а округление не происходит, если при округлении изменится значение дня.</span><span class="sxs-lookup"><span data-stu-id="a63b7-129">`datetime` value truncates fractional seconds and not round if rounding will change the day.</span></span>|<span data-ttu-id="a63b7-130">До появления собственного клиента версии 10.0 для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] клиент, передавая данные типа `datetime` на сервер, округлял их до ближайшей 1/300-й доли секунды.</span><span class="sxs-lookup"><span data-stu-id="a63b7-130">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the client behavior for `datetime` values sent to the server is to round them to nearest 1/300th of a second.</span></span> <span data-ttu-id="a63b7-131">Начиная с собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] версии 10.0, в этой ситуации происходит усечение долей секунды, если округление приводит к изменению значения дня.</span><span class="sxs-lookup"><span data-stu-id="a63b7-131">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, this scenario causes a truncation of fractional seconds if rounding changes the day.</span></span>|  
|<span data-ttu-id="a63b7-132">Возможно усечение секунд в значениях типа `datetime`.</span><span class="sxs-lookup"><span data-stu-id="a63b7-132">Possible trunction of seconds for `datetime` value.</span></span>|<span data-ttu-id="a63b7-133">В приложении, построенном с помощью собственного клиента [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] (или более поздних версий), при подключении к серверу [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 (или более ранней версии) будут усекаться секунды и доли секунды в части отправленных на сервер данных, относящейся ко времени, если выполняется привязка к столбцу типа datetime с идентификатором типа DBTYPE_DBTIMESTAMP (OLE DB) или SQL_TIMESTAMP (ODBC) и масштабом 0.</span><span class="sxs-lookup"><span data-stu-id="a63b7-133">An application built with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (or later) that connects to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 server will truncate seconds and fractional seconds for time portion of data sent to the server if you bind to a datetime column with a type identifier of DBTYPE_DBTIMESTAMP (OLE DB) or SQL_TIMESTAMP (ODBC) and a scale of 0.</span></span><br /><br /> <span data-ttu-id="a63b7-134">Пример:</span><span class="sxs-lookup"><span data-stu-id="a63b7-134">For example:</span></span><br /><br /> <span data-ttu-id="a63b7-135">Входные данные: 1994-08-21 21:21:36.000</span><span class="sxs-lookup"><span data-stu-id="a63b7-135">Input data: 1994-08-21 21:21:36.000</span></span><br /><br /> <span data-ttu-id="a63b7-136">Вставляемые данные: 1994-08-21 21:21:00.000</span><span class="sxs-lookup"><span data-stu-id="a63b7-136">Inserted data: 1994-08-21 21:21:00.000</span></span>|  
|<span data-ttu-id="a63b7-137">Преобразование данных OLE DB из типа DBTYPE_DBTIME в DBTYPE_DATE больше не вызывает изменения значения дня.</span><span class="sxs-lookup"><span data-stu-id="a63b7-137">OLE DB data conversion from DBTYPE_DBTIME to DBTYPE_DATE no longer can cause the day to change.</span></span>|<span data-ttu-id="a63b7-138">До появления собственного клиента версии 10.0 для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], если часть времени для значения DBTYPE_DATE отстояла от полуночи не более чем на полсекунды, то применение кода преобразования OLE DB приводило к изменению дня.</span><span class="sxs-lookup"><span data-stu-id="a63b7-138">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, if the time part of a DBTYPE_DATE was within a half second of midnight, OLE DB conversion code caused the day to change.</span></span> <span data-ttu-id="a63b7-139">Начиная с собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] версии 10.0, день не изменяется (доли секунды усекаются, а не округляются).</span><span class="sxs-lookup"><span data-stu-id="a63b7-139">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the day will not change (fractional seconds are truncated and not rounded).</span></span>|  
|<span data-ttu-id="a63b7-140">Изменения преобразования IBCPSession::BCColFmt.</span><span class="sxs-lookup"><span data-stu-id="a63b7-140">IBCPSession::BCColFmt conversion changes.</span></span>|<span data-ttu-id="a63b7-141">Начиная с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственного клиента 10,0 при использовании IBCPSession:: бкоколфмт для преобразования SQLDATETIME или SQLDATETIME в строковый тип экспортируется дробное значение.</span><span class="sxs-lookup"><span data-stu-id="a63b7-141">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, when you use IBCPSession::BCOColFmt to convert SQLDATETIME or SQLDATETIME to a string type, a fractional value is exported.</span></span> <span data-ttu-id="a63b7-142">Например, при преобразовании типа SQLDATETIME в тип SQLNVARCHARMAX более ранние версии собственного клиента для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] возвращали следующее:</span><span class="sxs-lookup"><span data-stu-id="a63b7-142">For example, when converting type SQLDATETIME to type SQLNVARCHARMAX, earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client returned</span></span><br /><br /> <span data-ttu-id="a63b7-143">1989-02-01 00:00:00.</span><span class="sxs-lookup"><span data-stu-id="a63b7-143">1989-02-01 00:00:00.</span></span> <span data-ttu-id="a63b7-144">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] версии 10.0 и более поздних версий возвращает 1989-02-01 00:00:00.0000000.</span><span class="sxs-lookup"><span data-stu-id="a63b7-144">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 and later versions return 1989-02-01 00:00:00.0000000.</span></span>|  
|<span data-ttu-id="a63b7-145">Размер пересылаемых данных должен соответствовать длине, заданной параметром SQL_LEN_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="a63b7-145">Size of data sent must match length specified in SQL_LEN_DATA_AT_EXEC.</span></span>|<span data-ttu-id="a63b7-146">При использовании параметра SQL_LEN_DATA_AT_EXEC размер данных должен соответствовать длине, заданной параметром SQL_LEN_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="a63b7-146">When using SQL_LEN_DATA_AT_EXEC, the size of the data must match the length that you specified with SQL_LEN_DATA_AT_EXEC.</span></span> <span data-ttu-id="a63b7-147">Можно использовать параметр SQL_DATA_AT_EXEC, но SQL_LEN_DATA_AT_EXEC дает некоторый выигрыш в производительности.</span><span class="sxs-lookup"><span data-stu-id="a63b7-147">You can use SQL_DATA_AT_EXEC but there are potential performance benefits to using SQL_LEN_DATA_AT_EXEC.</span></span>|  
|<span data-ttu-id="a63b7-148">В пользовательских приложениях, в которых используется API BCP, теперь могут обнаруживаться предупреждающие сообщения.</span><span class="sxs-lookup"><span data-stu-id="a63b7-148">Custom applications that use the BCP API can now see a warning.</span></span>|<span data-ttu-id="a63b7-149">API BCP выдает предупреждающее сообщение, если длина данных превышает заданную длину для полей всех типов.</span><span class="sxs-lookup"><span data-stu-id="a63b7-149">The BCP API will generate a warning message if data length is greater than the specified length for a field for all types.</span></span> <span data-ttu-id="a63b7-150">Раньше это предупреждение выдавалось только для символьных типов, но не для всех типов.</span><span class="sxs-lookup"><span data-stu-id="a63b7-150">Previously, this warning was only given for character types, but will not be issued for all types.</span></span>|  
|<span data-ttu-id="a63b7-151">Вставка пустой строки в объект типа `sql_variant`, привязанный как тип даты и времени, вызывает ошибку.</span><span class="sxs-lookup"><span data-stu-id="a63b7-151">Inserting an empty string into a `sql_variant` bound as a date/time type generates an error.</span></span>|<span data-ttu-id="a63b7-152">В собственном клиенте версии 9.0 для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] вставка пустой строки в объект типа `sql_variant`, привязанный как тип даты и времени, не вызывала ошибки.</span><span class="sxs-lookup"><span data-stu-id="a63b7-152">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, inserting an empty string into a `sql_variant` bound as a date/time type did not generate an error.</span></span> <span data-ttu-id="a63b7-153">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] версии 10.0 (или более поздних версий) в этом случае совершенно обоснованно возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="a63b7-153">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 (and later) correctly generates an error in this situation.</span></span>|  
|<span data-ttu-id="a63b7-154">Более строгая проверка параметров типа SQL_C_TYPE _TIMESTAMP и DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="a63b7-154">Stricter SQL_C_TYPE _TIMESTAMP and DBTYPE_DBTIMESTAMP parameter validation.</span></span>|<span data-ttu-id="a63b7-155">Перед [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] собственным клиентом `datetime` значения округляются в соответствии с масштабом `datetime` `smalldatetime` столбцов и [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a63b7-155">Prior to [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client, `datetime` values were rounded to fit the scale of `datetime` and `smalldatetime` columns by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a63b7-156">Теперь в собственном клиенте [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] (и более поздних версиях) применяются более строгие правила проверки, определенные в базовой спецификации ODBC для долей секунды.</span><span class="sxs-lookup"><span data-stu-id="a63b7-156">[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (and later) applies the stricter validation rules that are defined in the ODBC core specification for fractional seconds.</span></span> <span data-ttu-id="a63b7-157">Если значение параметра не удается преобразовать в тип SQL с помощью масштаба, заданного или подразумеваемого клиентской привязкой, без усечения конечных разрядов, то возвращается ошибка.</span><span class="sxs-lookup"><span data-stu-id="a63b7-157">If a parameter value cannot be converted to the SQL type by using the scale specified or implied by the client binding without truncation of trailing digits, an error is returned.</span></span>|  
|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="a63b7-158">может возвращать различные результаты при выполнении триггера.</span><span class="sxs-lookup"><span data-stu-id="a63b7-158">might return different results when a trigger runs.</span></span>|<span data-ttu-id="a63b7-159">Изменения, внесенные в [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], могут привести к тому, что приложение получит другие результаты при выполнении инструкции, вызвавшей выполнение триггера при действующем параметре `NOCOUNT OFF`.</span><span class="sxs-lookup"><span data-stu-id="a63b7-159">Changes introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] might cause an application to have different results returned from a statement that caused a trigger to run when `NOCOUNT OFF` was in effect.</span></span> <span data-ttu-id="a63b7-160">В такой ситуации в приложении может возникнуть ошибка.</span><span class="sxs-lookup"><span data-stu-id="a63b7-160">In this situation, your application might generate an error.</span></span> <span data-ttu-id="a63b7-161">Чтобы устранить эту ошибку, задайте `NOCOUNT ON` в триггере или вызовите SQLMoreResults, чтобы перейти к следующему результату.</span><span class="sxs-lookup"><span data-stu-id="a63b7-161">To resolve this error, set `NOCOUNT ON` in the trigger or call SQLMoreResults to advance to the next result.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="a63b7-162">См. также:</span><span class="sxs-lookup"><span data-stu-id="a63b7-162">See Also</span></span>  
 [<span data-ttu-id="a63b7-163">Программирование собственного клиента SQL Server</span><span class="sxs-lookup"><span data-stu-id="a63b7-163">SQL Server Native Client Programming</span></span>](../sql-server-native-client-programming.md)  
  
  
