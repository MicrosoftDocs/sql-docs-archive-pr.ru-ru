---
title: Обновление приложения для SQL Server Native Client из MDAC | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- SQLNCLI, vs. MDAC
- SQL Server Native Client, vs. MDAC
- data access [SQL Server Native Client], vs. MDAC
- SQL Server Native Client, updating applications
ms.assetid: 2860efdd-c59a-4deb-8a0e-5124a8f4e6dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 804f4340f3ca9a381f28507e0516d5f2e7d913a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738234"
---
# <a name="updating-an-application-to-sql-server-native-client-from-mdac"></a><span data-ttu-id="abc0b-102">Обновление приложения с переходом от компонентов MDAC к собственному клиенту SQL Server</span><span class="sxs-lookup"><span data-stu-id="abc0b-102">Updating an Application to SQL Server Native Client from MDAC</span></span>
  <span data-ttu-id="abc0b-103">Между собственным клиентом [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и компонентами доступа к данным MDAC существует несколько различий; начиная с Windows Vista, компоненты доступа к данным стали называться компонентами доступа к данным Windows, или Windows DAC.</span><span class="sxs-lookup"><span data-stu-id="abc0b-103">There are a number of differences between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and Microsoft Data Access Components (MDAC; starting with Windows Vista, the data access components are now called Windows Data Access Components, or Windows DAC).</span></span> <span data-ttu-id="abc0b-104">Хотя обе программы реализуют собственный доступ к базам данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] использует новые функции [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] особым образом, обеспечивая в то же время обратную совместимость с ранними версиями.</span><span class="sxs-lookup"><span data-stu-id="abc0b-104">Although both provide native data access to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has been specifically designed to expose the new features of [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], while at the same time maintaining backward compatibility with earlier versions.</span></span>  
  
 <span data-ttu-id="abc0b-105">Приведенные в этом разделе сведения помогут вам обновить приложения компонентов MDAC (или выделенное административное соединение Windows) до текущей версии собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], который входит в состав [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-105">The information in this topic helps update your MDAC (or Windows DAC) application to be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that was included in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="abc0b-106">Сведения о том, как обеспечить актуальность этого приложения с помощью версии [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, поставляемой в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] , см. в разделе [обновление приложения с SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="abc0b-106">To help you make this application be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that shipped in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], see [Updating an Application from SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span></span>  
  
 <span data-ttu-id="abc0b-107">Кроме того, в компоненты MDAC входят компоненты для использования OLE DB, ODBC и объектов ADO, а собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] реализует только интерфейсы OLE DB и ODBC (хотя объекты ADO могут использовать функции собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="abc0b-107">In addition, although MDAC contains components for using OLE DB, ODBC, and ActiveX Data Objects (ADO), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client only implements OLE DB and ODBC (although ADO can access the functionality of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span></span>  
  
 <span data-ttu-id="abc0b-108">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и компоненты MDAC различаются также в следующих областях.</span><span class="sxs-lookup"><span data-stu-id="abc0b-108">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC differ in the other following areas:</span></span>  
  
-   <span data-ttu-id="abc0b-109">Пользователи, использующие объекты ADO для доступа к поставщику собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], могут иметь в своем распоряжении меньше функций фильтрации, чем при доступе к поставщику SQL OLE DB.</span><span class="sxs-lookup"><span data-stu-id="abc0b-109">Users who use ADO to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client provider may find less filtering functionality than when they accessed a SQL OLE DB provider.</span></span>  
  
-   <span data-ttu-id="abc0b-110">Если в приложении ADO используется собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и предпринимается попытка обновить вычисляемый столбец, то появляется сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="abc0b-110">If an ADO application uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and attempts to update a computed column, an error will be reported.</span></span> <span data-ttu-id="abc0b-111">При использовании компонентов MDAC обновление было бы принято, но пропущено.</span><span class="sxs-lookup"><span data-stu-id="abc0b-111">With MDAC the update was accepted but ignored.</span></span>  
  
-   <span data-ttu-id="abc0b-112">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] является одним автономным файлом DLL.</span><span class="sxs-lookup"><span data-stu-id="abc0b-112">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is a single self-contained dynamic link library (DLL) file.</span></span> <span data-ttu-id="abc0b-113">Количество интерфейсов с открытым доступом сведено к минимуму, чтобы упростить распространение, а также повысить уровень безопасности.</span><span class="sxs-lookup"><span data-stu-id="abc0b-113">The publicly exposed interfaces have been kept to a minimum, both to ease distribution, as well as to limit security exposure.</span></span>  
  
-   <span data-ttu-id="abc0b-114">Поддерживаются только интерфейсы OLE DB и ODBC.</span><span class="sxs-lookup"><span data-stu-id="abc0b-114">Only OLE DB and ODBC interfaces are supported.</span></span>  
  
-   <span data-ttu-id="abc0b-115">Поставщик OLE DB и драйвер ODBC собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] имеют имена, отличные от тех, которые используются в компонентах MDAC.</span><span class="sxs-lookup"><span data-stu-id="abc0b-115">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and ODBC driver names are different from those used with MDAC.</span></span>  
  
-   <span data-ttu-id="abc0b-116">Доступные для пользователя функции, предоставляемые компонентами MDAC, можно использовать при работе с собственным клиентом [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-116">User-accessible functionality supplied by MDAC components is available when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="abc0b-117">К ним помимо прочего относится создание пулов соединений, поддержка ADO и поддержка клиентских курсоров.</span><span class="sxs-lookup"><span data-stu-id="abc0b-117">This includes, but is not limited to, the following: connection pooling, ADO support, and client cursor support.</span></span> <span data-ttu-id="abc0b-118">При использовании любой из этих функций собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] обеспечивает только связь с базой данных.</span><span class="sxs-lookup"><span data-stu-id="abc0b-118">When any of these features are used, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supplies only database connectivity.</span></span> <span data-ttu-id="abc0b-119">Компоненты MDAC предоставляют такие функции, как трассировка, элементы управления в интерфейсе управления и счетчики производительности.</span><span class="sxs-lookup"><span data-stu-id="abc0b-119">MDAC provides functionality such as tracing, management controls, and performance counters.</span></span>  
  
-   <span data-ttu-id="abc0b-120">Приложения могут использовать основные службы OLE DB в сочетании с собственным клиентом [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], однако при использовании ядра курсора OLE DB в них должен быть установлен параметр совместимости типов данных во избежание потенциальных проблем, которые могут возникнуть в связи с тем, что в ядре курсора отсутствуют сведения о новых типах данных [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-120">Applications can use OLE DB core services with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but if using the OLE DB cursor engine, they should use the data type compatibility option to avoid any potential problems that might arise because the cursor engine has no knowledge of the new [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] data types.</span></span>  
  
-   <span data-ttu-id="abc0b-121">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] поддерживает доступ к базам данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] предыдущих версий.</span><span class="sxs-lookup"><span data-stu-id="abc0b-121">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports access to previous [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   <span data-ttu-id="abc0b-122">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] не содержит средств интеграции с XML.</span><span class="sxs-lookup"><span data-stu-id="abc0b-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not contain XML integration.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="abc0b-123">Собственный клиент поддерживает SELECT... ДЛЯ запросов FOR XML, но не поддерживает другие функции XML.</span><span class="sxs-lookup"><span data-stu-id="abc0b-123">Native Client supports SELECT ... FOR XML queries, but does not support any other XML functionality.</span></span> <span data-ttu-id="abc0b-124">Однако собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] поддерживает тип данных `xml`, представленный в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-124">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does support the `xml` data type introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
-   <span data-ttu-id="abc0b-125">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] поддерживает настройку сетевых библиотек на стороне клиента с использованием только атрибутов строки соединения.</span><span class="sxs-lookup"><span data-stu-id="abc0b-125">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports configuring client-side network libraries using only connection string attributes.</span></span> <span data-ttu-id="abc0b-126">Если требуется провести более сложную настройку сетевых библиотек, необходимо использовать диспетчер конфигурации [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-126">If you need more complete network library configuration, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   <span data-ttu-id="abc0b-127">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] несовместим с odbcbcp.dll.</span><span class="sxs-lookup"><span data-stu-id="abc0b-127">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is not compatible with odbcbcp.dll.</span></span> <span data-ttu-id="abc0b-128">Приложения, использующие API ODBC и **bcp** , должны быть перестроены для связи с sqlncli11. lib, чтобы использовать [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственный клиент.</span><span class="sxs-lookup"><span data-stu-id="abc0b-128">Applications that use both ODBC and **bcp** APIs must be rebuilt to link with sqlncli11.lib in order to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="abc0b-129">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] не поддерживается из поставщика Microsoft OLE DB для ODBC (MSDASQL).</span><span class="sxs-lookup"><span data-stu-id="abc0b-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is not supported from the Microsoft OLE DB provider for ODBC (MSDASQL).</span></span> <span data-ttu-id="abc0b-130">При использовании драйвера MDAC SQLODBC вместе с MSDASQL или драйвера MDAC SQLODBC вместе с ADO используйте OLE DB в собственном клиенте [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-130">If you are using the MDAC SQLODBC driver with MSDASQL or MDAC SQLODBC driver with ADO, use OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client..</span></span>  
  
-   <span data-ttu-id="abc0b-131">Строки подключения MDAC позволяют использовать логическое значение ( `true` ) для ключевого слова **Trusted_Connection** .</span><span class="sxs-lookup"><span data-stu-id="abc0b-131">MDAC connection strings allow a Boolean value (`true`) for the **Trusted_Connection** keyword.</span></span> <span data-ttu-id="abc0b-132">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Строка подключения собственного клиента должна иметь значение `yes` или **нет**.</span><span class="sxs-lookup"><span data-stu-id="abc0b-132">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client connection string must use `yes` or **no**.</span></span>  
  
-   <span data-ttu-id="abc0b-133">Незначительные изменения внесены в предупреждения и ошибки.</span><span class="sxs-lookup"><span data-stu-id="abc0b-133">Minor changes have occurred to warnings and errors.</span></span> <span data-ttu-id="abc0b-134">Теперь в передаваемых собственному клиенту [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] предупреждениях и ошибках, которые возвращаются сервером, сохраняется такая же степень серьезности.</span><span class="sxs-lookup"><span data-stu-id="abc0b-134">Warnings and errors returned by the server now retain the same severity when passed to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="abc0b-135">Следует тщательно протестировать приложение, если его работа зависит от перехвата определенных предупреждений и ошибок.</span><span class="sxs-lookup"><span data-stu-id="abc0b-135">You should ensure you have thoroughly tested your application if you depend on trapping particular warnings and errors.</span></span>  
  
-   <span data-ttu-id="abc0b-136">Проверка ошибок в собственном клиенте [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] строже, чем в компонентах MDAC, а это означает, что некоторые приложения, которые не полностью соответствуют спецификациям ODBC и OLE DB, могут работать по-разному.</span><span class="sxs-lookup"><span data-stu-id="abc0b-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has stricter error checking than MDAC, which means that some applications that do not conform strictly to the ODBC and OLE DB specifications may behave differently.</span></span> <span data-ttu-id="abc0b-137">Например, поставщик SQLOLEDB не применяет правило, в соответствии с которым имена параметров должны начинаться с " \@ " для параметров результата, но [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственный клиент OLE DB поставщика.</span><span class="sxs-lookup"><span data-stu-id="abc0b-137">For example, the SQLOLEDB provider did not enforce the rule that parameter names must start with '\@' for result parameters, but the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does.</span></span>  
  
-   <span data-ttu-id="abc0b-138">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и компоненты MDAC по-разному реагируют на разрыв соединения.</span><span class="sxs-lookup"><span data-stu-id="abc0b-138">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client behaves differently from MDAC in regards to failed connections.</span></span> <span data-ttu-id="abc0b-139">Например, компоненты MDAC возвращают кэшированные значения свойств разорванного соединения, тогда как собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] сообщает вызывающему приложению об ошибке.</span><span class="sxs-lookup"><span data-stu-id="abc0b-139">For example, MDAC returns cached property values for a connection that has failed, whereas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client reports an error to the calling application.</span></span>  
  
-   <span data-ttu-id="abc0b-140">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] не формирует события Visual Studio Analyzer, вместо них он формирует события трассировки Windows.</span><span class="sxs-lookup"><span data-stu-id="abc0b-140">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not generate Visual Studio Analyzer events, but instead generates Windows tracing events.</span></span>  
  
-   <span data-ttu-id="abc0b-141">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] невозможно использовать с системным монитором.</span><span class="sxs-lookup"><span data-stu-id="abc0b-141">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client cannot be used with perfmon.</span></span> <span data-ttu-id="abc0b-142">Системный монитор — это средство Windows, которое можно использовать только для файлов DSN, которые используют драйвер MDAC SQLODBC, входящий в Windows.</span><span class="sxs-lookup"><span data-stu-id="abc0b-142">Perfmon is a Windows tool that can only be used with DSNs that use the MDAC SQLODBC driver included with Windows.</span></span>  
  
-   <span data-ttu-id="abc0b-143">Если собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] подключен к [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версий, то возврат ошибки сервера 16947 осуществляется в виде SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="abc0b-143">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is connected to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions, server error 16947 is returned as a SQL_ERROR.</span></span> <span data-ttu-id="abc0b-144">Эта ошибка возникает, если при выполнении позиционированного обновления или удаления не удается обновить или удалить строку.</span><span class="sxs-lookup"><span data-stu-id="abc0b-144">This error occurs when a positioned update or delete fails to update or delete a row.</span></span> <span data-ttu-id="abc0b-145">При использовании компонентов MDAC для соединения с любой версией [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ошибка сервера 16947 возвращается в виде предупреждения (SQL_SUCCESS_WITH_INFO).</span><span class="sxs-lookup"><span data-stu-id="abc0b-145">With MDAC when connecting to any version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], server error 16947 is returned as a warning (SQL_SUCCESS_WITH_INFO).</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="abc0b-146">Собственный клиент реализует интерфейс **идбдатасаурцеадмин** , который является необязательным OLE DB интерфейсом, который ранее не был реализован, но реализуется только метод **креатедатасаурце** этого необязательного интерфейса.</span><span class="sxs-lookup"><span data-stu-id="abc0b-146">Native Client implements the **IDBDataSourceAdmin** interface, which is an optional OLE DB interface that was not previously implemented, but only the **CreateDataSource** method of this optional interface is implemented.</span></span> [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
-   <span data-ttu-id="abc0b-147">Поставщик OLE DB собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] возвращает синонимы в наборах строк схемы TABLES и TABLE_INFO, при этом параметру TABLE_TYPE присваивается значение SYNONYM.</span><span class="sxs-lookup"><span data-stu-id="abc0b-147">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns synonyms in the TABLES and TABLE_INFO schema rowsets, with TABLE_TYPE set to SYNONYM.</span></span>  
  
-   <span data-ttu-id="abc0b-148">Возвращаемые значения типа данных,,,, `varchar(max)` `nvarchar(max)` `varbinary(max)` `xml` `udt` или других типов больших объектов не могут возвращаться в клиентские версии, предшествующие [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="abc0b-148">Return values of data type `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, `xml`, `udt`, or other large object types can not be returned to client versions earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="abc0b-149">Если эти типы должны служить в качестве возвращаемых значений, необходимо использовать собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-149">If you wish to use these types as return values, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="abc0b-150">Компоненты MDAC позволяют выполнять следующие инструкции при запуске ручных или неявных транзакций, а собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] — нет.</span><span class="sxs-lookup"><span data-stu-id="abc0b-150">MDAC allows the following statements to be executed at the start of manual and implicit transactions, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not.</span></span> <span data-ttu-id="abc0b-151">Они должны выполняться в режиме автоматической фиксации.</span><span class="sxs-lookup"><span data-stu-id="abc0b-151">They must be executed in autocommit mode.</span></span>  
  
    -   <span data-ttu-id="abc0b-152">Все полнотекстовые операции (операции DDL с индексом и каталогом)</span><span class="sxs-lookup"><span data-stu-id="abc0b-152">All full-text operations (index and catalog DDL)</span></span>  
  
    -   <span data-ttu-id="abc0b-153">Все операции с базой данных (создание базы данных, изменение базы данных, удаление базы данных)</span><span class="sxs-lookup"><span data-stu-id="abc0b-153">All database operations (create database, alter database, drop database)</span></span>  
  
    -   <span data-ttu-id="abc0b-154">Перенастройка</span><span class="sxs-lookup"><span data-stu-id="abc0b-154">Reconfigure</span></span>  
  
    -   <span data-ttu-id="abc0b-155">Shutdown</span><span class="sxs-lookup"><span data-stu-id="abc0b-155">Shutdown</span></span>  
  
    -   <span data-ttu-id="abc0b-156">Завершить</span><span class="sxs-lookup"><span data-stu-id="abc0b-156">Kill</span></span>  
  
    -   <span data-ttu-id="abc0b-157">Резервное копирование</span><span class="sxs-lookup"><span data-stu-id="abc0b-157">Backup</span></span>  
  
-   <span data-ttu-id="abc0b-158">При подключении приложений MDAC к [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] типы данных, представленные в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], будут отображаться как типы данных, совместимые с [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="abc0b-158">When MDAC applications connect to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the data types introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] will appear as [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)]-compatible data types as shown in the following table.</span></span>  
  
    |<span data-ttu-id="abc0b-159">Тип SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="abc0b-159">SQL Server 2005 type</span></span>|<span data-ttu-id="abc0b-160">Тип SQL Server 2000</span><span class="sxs-lookup"><span data-stu-id="abc0b-160">SQL Server 2000 type</span></span>|  
    |--------------------------|--------------------------|  
    |`varchar(max)`|`text`|  
    |`nvarchar(max)`|`ntext`|  
    |`varbinary(max)`|`image`|  
    |`udt`|`varbinary`|  
    |`xml`|`ntext`|  
  
     <span data-ttu-id="abc0b-161">Это сопоставление типов затрагивает значения, возвращаемые для метаданных столбцов.</span><span class="sxs-lookup"><span data-stu-id="abc0b-161">This type mapping affects the values returned for column metadata.</span></span> <span data-ttu-id="abc0b-162">Например, `text` максимальный размер столбца 2 147 483 647, но [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственный клиент ODBC сообщает максимальный размер `varchar(max)` столбцов как SQL_SS_LENGTH_UNLIMITED, а [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственный клиент OLE DB сообщает максимальный размер `varchar(max)` столбцов в виде 2 147 483 647 или-1 в зависимости от платформы.</span><span class="sxs-lookup"><span data-stu-id="abc0b-162">For example, a `text` column has a maximum size of 2,147,483,647, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC reports the maximum size of `varchar(max)` columns as SQL_SS_LENGTH_UNLIMITED, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB reports the maximum size of `varchar(max)` columns as 2,147,483,647 or -1, depending on platform.</span></span>  
  
-   <span data-ttu-id="abc0b-163">В собственном клиенте [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в целях обеспечения обратной совместимости допускается неоднозначность в строках соединений (например, некоторые ключевые слова могут быть указаны несколько раз, а также может допускаться использование конфликтующих ключевых слов; при этом разрешение конфликтов происходит с учетом позиции или приоритета).</span><span class="sxs-lookup"><span data-stu-id="abc0b-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client allows ambiguity in connection strings (for example, some keywords may be specified more than once, and conflicting keywords may be allowed with resolution based on position or precedence) for reasons of backward compatibility.</span></span> <span data-ttu-id="abc0b-164">В следующих версиях собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] неоднозначность в строках соединения может стать недопустимой.</span><span class="sxs-lookup"><span data-stu-id="abc0b-164">Future releases of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client might not allow ambiguity in connection strings.</span></span> <span data-ttu-id="abc0b-165">При изменении приложения для работы с собственным клиентом [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] необходимо предусмотреть устранение любых зависимостей от неоднозначности строки соединения.</span><span class="sxs-lookup"><span data-stu-id="abc0b-165">It is good practice when modifying applications to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to eliminate any dependency on connection string ambiguity.</span></span>  
  
-   <span data-ttu-id="abc0b-166">При запуске транзакций с помощью вызова ODBC или OLE DB собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и компоненты MDAC ведут себя по-разному; при работе с собственным клиентом [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] транзакции запускаются немедленно, а при использовании компонентов MDAC запуск транзакций происходит только после первого доступа к базе данных.</span><span class="sxs-lookup"><span data-stu-id="abc0b-166">If you use an ODBC or OLE DB call to start transactions, there is a difference in behavior between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC; transactions will begin immediately with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but transactions will begin after the first database access using MDAC.</span></span> <span data-ttu-id="abc0b-167">Это может повлиять на поведение хранимых процедур и пакетов, так как [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] требует \@ \@ , чтобы значение TRANCOUNT совпадало после завершения выполнения пакета или хранимой процедуры, как это было при запуске пакета или хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="abc0b-167">This can affect the behavior of stored procedures and batches because [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires \@\@TRANCOUNT to be the same after a batch or stored procedure finishes execution as it was when the batch or stored procedure started.</span></span>  
  
-   <span data-ttu-id="abc0b-168">При использовании [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственного клиента ITransactionLocal:: BeginTransaction приведет к немедленному запуску транзакции.</span><span class="sxs-lookup"><span data-stu-id="abc0b-168">With [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ITransactionLocal::BeginTransaction will cause a transaction to be started immediately.</span></span> <span data-ttu-id="abc0b-169">При использовании компонентов MDAC запуск транзакции задерживается до выполнения приложением инструкции, которой требуется транзакция в неявном режиме.</span><span class="sxs-lookup"><span data-stu-id="abc0b-169">With MDAC the transaction start was delayed until the application executed a statement which required a transaction in implicit transaction mode.</span></span> <span data-ttu-id="abc0b-170">Дополнительные сведения см. в разделе [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="abc0b-170">For more information, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span>  
  
-   <span data-ttu-id="abc0b-171">При использовании [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвера собственного клиента с System. Data. ODBC могут возникнуть ошибки, чтобы получить доступ к [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] серверу, предоставляющему новые, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] специфичные типы данных или функции.</span><span class="sxs-lookup"><span data-stu-id="abc0b-171">You might encounter errors when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver with System.Data.Odbc to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] server computer that exposes new, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific data types or features.</span></span> <span data-ttu-id="abc0b-172">System. Data. ODBC предоставляет универсальную реализацию ODBC и впоследствии не предоставляет функции или расширения, относящиеся к поставщику.</span><span class="sxs-lookup"><span data-stu-id="abc0b-172">System.Data.Odbc provides a generic ODBC implementation and subsequently does not expose vendor specific functionality or extensions.</span></span> <span data-ttu-id="abc0b-173">(Элемент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Драйвер собственного клиента обновляется для встроенной поддержки новейших [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] функций.) Чтобы обойти эту проблему, можно либо вернуться к компоненту MDAC, либо перейти на System. Data. SqlClient.</span><span class="sxs-lookup"><span data-stu-id="abc0b-173">(The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver is updated to natively support the latest [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features.) To workaround this issue, you can either revert to MDAC, or migrate to System.Data.SqlClient.</span></span>  
  
 <span data-ttu-id="abc0b-174">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и MDAC поддерживают уровень изоляции транзакций read committed при использовании управления версиями строк, однако изоляцию транзакций моментальных снимков поддерживает только собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="abc0b-174">Both [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC support read committed transaction isolation using row versioning, but only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports snapshot transaction isolation.</span></span> <span data-ttu-id="abc0b-175">(С точки зрения программирования уровень изоляции транзакций READ COMMITTED с управлением версиями строк представляет собой то же, что и транзакция READ COMMITTED.)</span><span class="sxs-lookup"><span data-stu-id="abc0b-175">(In programming terms, read committed transaction isolation using row versioning is the same as read-committed transaction.).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="abc0b-176">См. также:</span><span class="sxs-lookup"><span data-stu-id="abc0b-176">See Also</span></span>  
 [<span data-ttu-id="abc0b-177">Построение приложений с использованием SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="abc0b-177">Building Applications with SQL Server Native Client</span></span>](building-applications-with-sql-server-native-client.md)  
  
  
