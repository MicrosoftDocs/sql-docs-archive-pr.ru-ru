---
title: Выполнение операций массового копирования | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656382"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="ba9f2-102">Выполнение операций массового копирования</span><span class="sxs-lookup"><span data-stu-id="ba9f2-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="ba9f2-103">Функция массового копирования [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] поддерживает передачу больших объемов данных в таблицу или представление [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] или из них.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="ba9f2-104">Данные можно также передать путем указания инструкции SELECT.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="ba9f2-105">Данные можно передавать между [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и файлом данных операционной системы, таким как ASCII-файл.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="ba9f2-106">Файлы данных могут иметь различные форматы. Формат определяется для массового копирования в файле форматирования.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="ba9f2-107">По желанию данные можно загрузить в переменные программы и передать в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с помощью функций и методов массового копирования.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="ba9f2-108">Пример приложения, демонстрирующий эту функцию, см. в разделе [Массовое копирование данных с использованием IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="ba9f2-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="ba9f2-109">Приложение обычно использует массовое копирование одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="ba9f2-110">Массовое копирование из таблицы, представления или результирующего набора инструкции Transact-SQL в файл данных, куда данные помещаются в том же формате, что и в таблице или представлении.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="ba9f2-111">Такой файл называется файлом данных собственного режима.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="ba9f2-112">Массовое копирование из таблицы, представления или результирующего набора инструкции Transact-SQL в файл данных, куда данные помещаются в формате, отличном от формата в таблице или представлении.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="ba9f2-113">В этом случае создается отдельный файл форматирования, который определяет характеристики (тип данных, позицию, длину, признак конца и т. д.) каждого столбца, когда он помещается в файл данных.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="ba9f2-114">Если все столбцы преобразуются в символьный формат, результирующий файл называется файлом данных символьного режима.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="ba9f2-115">Массовое копирование из файлов данных в таблицу или представление.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="ba9f2-116">При необходимости файл форматирования используется для определения макета файла данных.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="ba9f2-117">Загрузите данные в переменные программы, а затем выполните импорт данных в таблицу или представление с помощью функций массового копирования для массового копирования по строке за раз.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="ba9f2-118">Файлы данных, используемые функциями массового копирования, не приходится создавать при помощи другой программы массового копирования.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="ba9f2-119">Любая другая система может создать файл данных и файл форматирования в соответствии с определениями массового копирования. Эти файлы можно затем использовать в программе массового копирования [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для импорта данных в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ba9f2-120">Например, можно экспортировать данные из электронной таблицы в файл с разделителями-символами табуляции, построить файл форматирования, описывающий файл с разделителями-символами табуляции, а затем использовать функции массового копирования для быстрого импорта данных в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ba9f2-121">Файлы данных, созданные при массовом копировании, можно также импортировать в другие приложения.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="ba9f2-122">Например, можно использовать функции массового копирования для экспорта данных из таблицы или представления в файл с разделителями-символами табуляции, который затем можно загрузить в электронную таблицу.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="ba9f2-123">Программисты, пишущие приложения, использующие функции массового копирования, должны следовать основным правилам для обеспечения хорошей производительности массового копирования.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="ba9f2-124">Дополнительные сведения о поддержке операций массового копирования в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]см. в разделе [Массовый импорт и экспорт данных (SQL Server)](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="ba9f2-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="ba9f2-125">Ограничения</span><span class="sxs-lookup"><span data-stu-id="ba9f2-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="ba9f2-126">Определяемый пользователем тип данных CLR должен быть привязан как двоичные данные.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="ba9f2-127">Даже если файл форматирования указывает SQLCHAR как тип данных для целевого столбца определяемого пользователем типа, программа bcp будет рассматривать данные как двоичные.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="ba9f2-128">Нельзя использовать инструкцию SET FMTONLY OFF с операциями массового копирования.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="ba9f2-129">Ее использование может стать причиной завершения операции массового копирования с ошибкой или получению непредвиденных результатов.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="ba9f2-130">Поставщик OLE DB для собственного клиента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ba9f2-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="ba9f2-131">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Поставщик OLE DB собственного клиента реализует два метода для выполнения операций с массовым копированием [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] базы данных.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="ba9f2-132">Первый метод предусматривает использование интерфейса [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) для операций массового копирования, работающих с памятью, а второй предусматривает использование интерфейса [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) для операций массового копирования, работающих с файлами.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="ba9f2-133">Использование операций массового копирования, работающих с памятью</span><span class="sxs-lookup"><span data-stu-id="ba9f2-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="ba9f2-134">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Поставщик OLE DB собственного клиента реализует интерфейс **IRowsetFastLoad** для предоставления поддержки [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] операций с массовым копированием на основе памяти.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="ba9f2-135">В интерфейсе **IRowsetFastLoad** реализованы методы [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) и [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="ba9f2-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="ba9f2-136">Включение сеанса для метода IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="ba9f2-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="ba9f2-137">Потребитель уведомляет поставщик OLE DB собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] о необходимости массового копирования путем установки для свойства источника данных SSPROP_ENABLEFASTLOAD, зависящего от поставщика OLE DB для собственного клиента OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], значения VARIANT_TRUE.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="ba9f2-138">При задании свойства на источник данных потребитель создает сеанс поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="ba9f2-139">Новый сеанс позволяет потребителю получить доступ к интерфейсу **IRowsetFastLoad**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ba9f2-140">Если для инициализации источника данных используется интерфейс **IDataInitialize**, то необходимо задать свойство SSPROP_IRowsetFastLoad в параметре *rgPropertySets* метода **IOpenRowset::OpenRowset**. В противном случае вызов метода **OpenRowset** возвращает ошибку E_NOINTERFACE.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="ba9f2-141">Включение сеанса для массового копирования ограничивает поддержку интерфейсов в сеансе со стороны поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="ba9f2-142">Сеанс с включенным массовым копированием предоставляет только следующие интерфейсы:</span><span class="sxs-lookup"><span data-stu-id="ba9f2-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="ba9f2-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="ba9f2-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="ba9f2-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="ba9f2-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="ba9f2-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="ba9f2-148">Чтобы отключить создание набора строк с включенным массовым копированием и вернуть сеанс поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] к обычной обработке, задайте для свойства SSPROP_ENABLEFASTLOAD значение VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="ba9f2-149">Наборы строк IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="ba9f2-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="ba9f2-150">Наборы строк для массового копирования поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] доступны только для записи, но они предоставляют интерфейсы, позволяющие потребителю определить структуру таблицы [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="ba9f2-151">Для набора строк поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с включенным массовым копированием предоставлены следующие интерфейсы:</span><span class="sxs-lookup"><span data-stu-id="ba9f2-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="ba9f2-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="ba9f2-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="ba9f2-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="ba9f2-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="ba9f2-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="ba9f2-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="ba9f2-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="ba9f2-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="ba9f2-159">Свойства SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS и SSPROP_FASTLOADKEEPIDENTITY, зависящие от поставщика, управляют режимом работы набора строк для массового копирования поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="ba9f2-160">Свойства указываются в члене *ргпропертиес* элемента параметра _rgPropertySets_**IOpenRowset**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="ba9f2-161">Идентификатор свойства</span><span class="sxs-lookup"><span data-stu-id="ba9f2-161">Property ID</span></span>|<span data-ttu-id="ba9f2-162">Описание</span><span class="sxs-lookup"><span data-stu-id="ba9f2-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="ba9f2-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="ba9f2-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="ba9f2-164">Столбец: нет</span><span class="sxs-lookup"><span data-stu-id="ba9f2-164">Column: No</span></span><br /><br /> <span data-ttu-id="ba9f2-165">Ч/З Чтение/запись</span><span class="sxs-lookup"><span data-stu-id="ba9f2-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="ba9f2-166">Тип: VT_BOOL.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="ba9f2-167">Значение по умолчанию: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ba9f2-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="ba9f2-168">Описание. Поддерживает значения идентификаторов, указанные объектом-получателем.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="ba9f2-169">VARIANT_FALSE: значения для столбца идентификаторов в таблице [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] формируются [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ba9f2-170">Любое значение, привязанное к столбцу, игнорируется [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] поставщиком собственного клиента OLE DB.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="ba9f2-171">VARIANT_TRUE: потребитель привязывает метод доступа, предоставляющий значение, к столбцу идентификаторов [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="ba9f2-172">Свойство идентификатора недоступно для столбцов, допускающих значение NULL, так что потребитель предоставляет уникальное значение для каждого вызова **IRowsetFastLoad::Insert**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="ba9f2-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="ba9f2-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="ba9f2-174">Столбец: нет</span><span class="sxs-lookup"><span data-stu-id="ba9f2-174">Column: No</span></span><br /><br /> <span data-ttu-id="ba9f2-175">Ч/З Чтение/запись</span><span class="sxs-lookup"><span data-stu-id="ba9f2-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="ba9f2-176">Тип: VT_BOOL.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="ba9f2-177">Значение по умолчанию: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ba9f2-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="ba9f2-178">Описание. Поддерживает значение NULL для столбцов с ограничением DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="ba9f2-179">Затрагивает только столбцы [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], которые допускают значение NULL и к которым применено ограничение DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="ba9f2-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] вставляет значение по умолчанию для столбца при вставке потребителем поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] строки, содержащей значение NULL для столбца.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="ba9f2-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] вставляет значение NULL для значения столбца при вставке потребителем поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] строки, содержащей значение NULL для столбца.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="ba9f2-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="ba9f2-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="ba9f2-183">Столбец: нет</span><span class="sxs-lookup"><span data-stu-id="ba9f2-183">Column: No</span></span><br /><br /> <span data-ttu-id="ba9f2-184">Ч/З Чтение/запись</span><span class="sxs-lookup"><span data-stu-id="ba9f2-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="ba9f2-185">Тип: VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="ba9f2-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="ba9f2-186">По умолчанию: нет</span><span class="sxs-lookup"><span data-stu-id="ba9f2-186">Default: none</span></span><br /><br /> <span data-ttu-id="ba9f2-187">Описание. Это свойство похоже на параметр **-h** "*hint*[,...*n*]" программы **bcp**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="ba9f2-188">Следующие строки можно использовать в качестве параметров при массовом копировании данных в таблицу.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="ba9f2-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): порядок сортировки данных в файле данных.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="ba9f2-190">Производительность массового копирования увеличивается, если загружаемый файл данных упорядочен по кластеризованному индексу таблицы.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="ba9f2-191">**ROWS_PER_BATCH** = *bb*: Количество строк данных в каждом пакете (значение *bb*).</span><span class="sxs-lookup"><span data-stu-id="ba9f2-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="ba9f2-192">Сервер оптимизирует массовую загрузку в соответствии со значением *bb*.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="ba9f2-193">По умолчанию значение аргумента **ROWS_PER_BATCH** неизвестно.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="ba9f2-194">**KILOBYTES_PER_BATCH** = *cc*: количество килобайт (KБ) данных в каждом пакете (значение cc).</span><span class="sxs-lookup"><span data-stu-id="ba9f2-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="ba9f2-195">По умолчанию значение **KILOBYTES_PER_BATCH** неизвестно.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="ba9f2-196">**TABLOCK**: блокировка уровня таблицы запрашивается на время операции массового копирования.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="ba9f2-197">Применение этого параметра значительно повышает производительность, так как удержание блокировки только в течение операции массового копирования уменьшает вероятность конфликтов блокировок в таблице.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="ba9f2-198">Таблица может загружаться одновременно несколькими клиентами, если она не содержит индексов и указан параметр **TABLOCK**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="ba9f2-199">По умолчанию работа блокировки определяется параметром таблицы **table lock on bulk load**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="ba9f2-200">**CHECK_CONSTRAINTS**: любые ограничения на *имя_таблицы* проверяются на протяжении операции массового копирования.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="ba9f2-201">По умолчанию ограничения не учитываются.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="ba9f2-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] использует управление версиями строк для триггеров. Версии строк сохраняются в хранилище версий базы данных **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="ba9f2-203">Поэтому оптимизации массовой записи в журнал доступны даже при включенных триггерах.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="ba9f2-204">Перед массовым импортом пакета с большим количеством строк с включенными триггерами, возможно, придется увеличить размер базы данных **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="ba9f2-205">Использование операций массового копирования, работающих с файлами</span><span class="sxs-lookup"><span data-stu-id="ba9f2-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="ba9f2-206">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Поставщик OLE DB собственного клиента реализует интерфейс **IBCPSession** для предоставления поддержки [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] операций файлового копирования на основе файлов.</span><span class="sxs-lookup"><span data-stu-id="ba9f2-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="ba9f2-207">В интерфейсе **IBCPSession** реализованы методы [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) и [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="ba9f2-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="ba9f2-208">Драйвер ODBC для собственного клиента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ba9f2-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="ba9f2-209">Драйвер ODBC для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] обеспечивает такую же поддержку операций массового копирования, которые были частью предыдущих версий драйвера ODBC [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ba9f2-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="ba9f2-210">Сведения об операциях с массовым копированием с помощью [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвера ODBC для собственного клиента см. в разделе [выполнение операций с массовым копированием &#40;&#41;ODBC ](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="ba9f2-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ba9f2-211">См. также:</span><span class="sxs-lookup"><span data-stu-id="ba9f2-211">See Also</span></span>  
 <span data-ttu-id="ba9f2-212">[Компоненты собственного клиента SQL Server](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="ba9f2-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="ba9f2-213">[Свойства источника данных &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="ba9f2-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="ba9f2-214">[Массовый импорт и экспорт данных (SQL Server)](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="ba9f2-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="ba9f2-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="ba9f2-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="ba9f2-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="ba9f2-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="ba9f2-217">[Оптимизация производительности массового импорта данных](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="ba9f2-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
