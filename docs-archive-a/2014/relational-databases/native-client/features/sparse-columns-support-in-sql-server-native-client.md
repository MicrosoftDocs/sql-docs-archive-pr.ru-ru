---
title: Поддержка разреженных столбцов в SQL Server Native Client | Документация Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- sparse columns, ODBC
- sparse columns, SQL Server Native Client
- sparse columns, OLE DB
ms.assetid: aee5ed81-7e23-42e4-92d3-2da7844d9bc3
author: rothja
ms.author: jroth
ms.openlocfilehash: 5c53210088f184ad4c56b71c03954b39fd83a497
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656376"
---
# <a name="sparse-columns-support-in-sql-server-native-client"></a><span data-ttu-id="6f4b4-102">Поддержка разреженных столбцов в собственном клиенте SQL Server</span><span class="sxs-lookup"><span data-stu-id="6f4b4-102">Sparse Columns Support in SQL Server Native Client</span></span>
  <span data-ttu-id="6f4b4-103">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] поддерживает разреженные столбцы.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports sparse columns.</span></span> <span data-ttu-id="6f4b4-104">Дополнительные сведения о разреженных столбцах в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]см. в статьях [Использование разреженных столбцов](../../tables/use-sparse-columns.md) и [Использование наборов столбцов](../../tables/use-column-sets.md).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-104">For more information about sparse columns in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Use Sparse Columns](../../tables/use-sparse-columns.md) and [Use Column Sets](../../tables/use-column-sets.md).</span></span>  
  
 <span data-ttu-id="6f4b4-105">Дополнительные сведения о поддержке разреженных столбцов в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственном клиенте см. в разделе [Поддержка разреженных СТОЛБЦОВ &#40;ODBC&#41;](../odbc/sparse-columns-support-odbc.md) и [разреженные столбцы поддерживают &#40;OLE DB&#41;](../ole-db/sparse-columns-support-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-105">For more information about sparse column support in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Sparse Columns Support &#40;ODBC&#41;](../odbc/sparse-columns-support-odbc.md) and [Sparse Columns Support &#40;OLE DB&#41;](../ole-db/sparse-columns-support-ole-db.md).</span></span>  
  
 <span data-ttu-id="6f4b4-106">Сведения о примерах приложений, которые демонстрируют эту функцию, см. в разделе [Образцы программирования для SQL Server](https://msftdpprodsamples.codeplex.com/).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-106">For information about sample applications that demonstrate this feature, see [SQL Server Data Programming Samples](https://msftdpprodsamples.codeplex.com/).</span></span>  
  
## <a name="user-scenarios-for-sparse-columns-and-sql-server-native-client"></a><span data-ttu-id="6f4b4-107">Пользовательские сценарии для разреженных столбцов и собственный клиент SQL Server</span><span class="sxs-lookup"><span data-stu-id="6f4b4-107">User Scenarios for Sparse Columns and SQL Server Native Client</span></span>  
 <span data-ttu-id="6f4b4-108">Следующая таблица содержит обычные пользовательские сценарии работы с разреженными столбцами для пользователей собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f4b4-108">The following table summarizes the common user scenarios for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client users with sparse columns:</span></span>  
  
|<span data-ttu-id="6f4b4-109">Сценарий</span><span class="sxs-lookup"><span data-stu-id="6f4b4-109">Scenario</span></span>|<span data-ttu-id="6f4b4-110">Поведение</span><span class="sxs-lookup"><span data-stu-id="6f4b4-110">Behavior</span></span>|  
|--------------|--------------|  
|<span data-ttu-id="6f4b4-111">**выберите \* из таблицы** или IOpenRowset::OpenRowset.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-111">**select \* from table** or IOpenRowset::OpenRowset.</span></span>|<span data-ttu-id="6f4b4-112">Возвращает все столбцы, которые не являются элементами набора разреженных столбцов `column_set` плюс XML-столбец, содержащий значения ненулевых столбцов, являющихся элементами набора разреженных столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-112">Returns all columns that are not members of the sparse `column_set`, plus an XML column that contains the values of all non-null columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="6f4b4-113">Ссылка на столбец по имени.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-113">Reference a column by name.</span></span>|<span data-ttu-id="6f4b4-114">На столбец можно ссылаться независимо от состояния разреженности или вхождения в `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-114">The column can be referenced regardless of its sparse column status or `column_set` membership.</span></span>|  
|<span data-ttu-id="6f4b4-115">Доступ к столбцам-элементам `column_set` через вычисляемый XML-столбец.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-115">Access `column_set` member columns through a computed XML column.</span></span>|<span data-ttu-id="6f4b4-116">К столбцам, являющимся элементами `column_set`, можно получить доступ при помощи выборки `column_set` по имени; эти столбцы могут содержать значения, вставленные и обновленные при обновлении XML в столбце `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-116">Columns that are members of the sparse `column_set` can be accessed by selecting the `column_set` by name and can have values inserted and updated by updating the XML in the `column_set` column.</span></span><br /><br /> <span data-ttu-id="6f4b4-117">Значение должно соответствовать схеме для столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-117">The value must conform to the schema for `column_set` columns.</span></span>|  
|<span data-ttu-id="6f4b4-118">Получение метаданных для всех столбцов в таблице с помощью SQLColumns с шаблоном поиска столбца NULL или "%" (ODBC); или с помощью набора строк схемы DBSCHEMA_COLUMNS без ограничений по столбцам (OLE DB).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-118">Retrieve metadata for all columns in a table through SQLColumns with a column search pattern of NULL or '%' (ODBC); or through the DBSCHEMA_COLUMNS schema rowset with no column restriction (OLE DB).</span></span>|<span data-ttu-id="6f4b4-119">Возвращает строку для всех столбцов, не входящих в `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-119">Returns a row for all columns that are not members of a `column_set`.</span></span> <span data-ttu-id="6f4b4-120">Если таблица содержит разреженный `column_set`, для него будет возвращена строка.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-120">If the table has a sparse `column_set`, a row will be returned for it.</span></span><br /><br /> <span data-ttu-id="6f4b4-121">Обратите внимание, что при этом не возвращаются метаданные для столбцов, являющихся элементами `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-121">Note that this does not return metadata for columns that are members of a `column_set`.</span></span>|  
|<span data-ttu-id="6f4b4-122">Получение данных для всех столбцов, независимо от разреженности или вхождения в `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-122">Retrieve metadata for all columns, regardless of sparseness or membership in a `column_set`.</span></span> <span data-ttu-id="6f4b4-123">В этом случае может вернуться очень большое число строк.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-123">This might return a very large number of rows.</span></span>|<span data-ttu-id="6f4b4-124">Задайте для поля дескриптор SQL_SOPT_SS_NAME_SCOPE значение SQL_SS_NAME_SCOPE_EXTENDED и вызовите [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) (ODBC).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-124">Set the descriptor field SQL_SOPT_SS_NAME_SCOPE to SQL_SS_NAME_SCOPE_EXTENDED and call [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) (ODBC).</span></span><br /><br /> <span data-ttu-id="6f4b4-125">Вызовите метод IDBSchemaRowset:: GetSchema для набора строк схемы DBSCHEMA_COLUMNS_EXTENDED (OLE DB).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-125">Call IDBSchemaRowset::GetRowset for the DBSCHEMA_COLUMNS_EXTENDED schema rowset (OLE DB).</span></span><br /><br /> <span data-ttu-id="6f4b4-126">Этот сценарий невозможен в приложении, которое использует собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] более ранней версии, чем [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f4b4-126">This scenario is not possible from an application that uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client from a release earlier than [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="6f4b4-127">Однако такое приложение может непосредственно запрашивать системные представления.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-127">However, such an application could query system views directly.</span></span>|  
|<span data-ttu-id="6f4b4-128">Получение метаданных только для столбцов, являющихся элементами `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-128">Retrieve metadata only for columns that are members of a `column_set`.</span></span> <span data-ttu-id="6f4b4-129">В этом случае может вернуться очень большое число строк.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-129">This might return a very large number of rows.</span></span>|<span data-ttu-id="6f4b4-130">Задайте для поля дескриптор SQL_SOPT_SS_NAME_SCOPE значение SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET и вызовите SQLColumns (ODBC).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-130">Set the descriptor field SQL_SOPT_SS_NAME_SCOPE to SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET and call SQLColumns (ODBC).</span></span><br /><br /> <span data-ttu-id="6f4b4-131">Вызовите метод IDBSchemaRowset:: GetSchema для набора строк схемы DBSCHEMA_SPARSE_COLUMN_SET (OLE DB).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-131">Call IDBSchemaRowset::GetRowset for the DBSCHEMA_SPARSE_COLUMN_SET schema rowset (OLE DB).</span></span><br /><br /> <span data-ttu-id="6f4b4-132">Этот сценарий невозможен в приложении, которое использует собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] более ранней версии, чем [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f4b4-132">This scenario is not possible from an application that uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client from a release earlier than [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="6f4b4-133">Однако такое приложение может запрашивать системные представления.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-133">However, such an application could query system views.</span></span>|  
|<span data-ttu-id="6f4b4-134">Определение, является ли столбец разреженным.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-134">Determine whether a column is sparse.</span></span>|<span data-ttu-id="6f4b4-135">Просмотрите столбец SS_IS_SPARSE результирующего набора SQLColumns (ODBC).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-135">Consult the SS_IS_SPARSE column of the SQLColumns result set (ODBC).</span></span><br /><br /> <span data-ttu-id="6f4b4-136">Обратитесь к столбцу SS_IS_SPARSE результирующего набора строк схемы DBSCHEMA_COLUMNS (ODBC).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-136">Consult the SS_IS_SPARSE column of the DBSCHEMA_COLUMNS schema rowset (OLE DB).</span></span><br /><br /> <span data-ttu-id="6f4b4-137">Этот сценарий невозможен в приложении, которое использует собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] более ранней версии, чем [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f4b4-137">This scenario is not possible from an application that uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client from a release earlier than [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="6f4b4-138">Однако такое приложение может запрашивать системные представления.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-138">However, such an application could query system views.</span></span>|  
|<span data-ttu-id="6f4b4-139">Определение, является ли столбец элементом `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-139">Determine if a column is a `column_set`.</span></span>|<span data-ttu-id="6f4b4-140">Просмотрите столбец SS_IS_COLUMN_SET результирующего набора SQLColumns.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-140">Consult the SS_IS_COLUMN_SET column of the SQLColumns result set.</span></span> <span data-ttu-id="6f4b4-141">Или обратитесь к конкретному атрибуту столбца [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] SQL_CA_SS_IS_COLUMN_SET (ODBC).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-141">Or, consult the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] specific column attribute SQL_CA_SS_IS_COLUMN_SET (ODBC).</span></span><br /><br /> <span data-ttu-id="6f4b4-142">Обратитесь к столбцу SS_IS_COLUMN_SET набора строк схемы DBSCHEMA_COLUMNS.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-142">Consult the SS_IS_COLUMN_SET column of the DBSCHEMA_COLUMNS schema rowset.</span></span> <span data-ttu-id="6f4b4-143">Или просмотрите *dwFlags*, возвращенный IColumnsinfo::GetColumnInfo или DBCOLUMNFLAGS в наборе строк, возвращаемом IColumnsRowset::GetColumnsRowset.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-143">Or, consult *dwFlags* returned by IColumnsinfo::GetColumnInfo or DBCOLUMNFLAGS in the rowset returned by IColumnsRowset::GetColumnsRowset.</span></span> <span data-ttu-id="6f4b4-144">Для столбцов `column_set` будет установлен DBCOLUMNFLAGS_SS_ISCOLUMNSET (OLE DB).</span><span class="sxs-lookup"><span data-stu-id="6f4b4-144">For `column_set` columns, DBCOLUMNFLAGS_SS_ISCOLUMNSET will be set (OLE DB).</span></span><br /><br /> <span data-ttu-id="6f4b4-145">Этот сценарий невозможен в приложении, которое использует собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] более ранней версии, чем [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f4b4-145">This scenario is not possible from an application that uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client from a release earlier than [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="6f4b4-146">Однако такое приложение может запрашивать системные представления.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-146">However, such an application could query system views.</span></span>|  
|<span data-ttu-id="6f4b4-147">Импорт и экспорт разреженных столбцов программой BCP для таблиц без `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-147">Import and export of sparse columns by BCP for a table with no `column_set`.</span></span>|<span data-ttu-id="6f4b4-148">Отличий от предыдущих версий собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в поведении нет.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-148">No change in behavior from previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>|  
|<span data-ttu-id="6f4b4-149">Импорт и экспорт разреженных столбцов программой BCP для таблиц с `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-149">Import and export of sparse columns by BCP for a table with a `column_set`.</span></span>|<span data-ttu-id="6f4b4-150">Объект `column_set` импортируется и экспортируется так же, как XML, то есть как если бы он был `varbinary(max)` привязан к двоичному типу, или как, `nvarchar(max)` если он привязан как `char` тип или **WCHAR** .</span><span class="sxs-lookup"><span data-stu-id="6f4b4-150">The `column_set` is imported and exported in the same way as XML; that is, as `varbinary(max)` if bound as a binary type, or as `nvarchar(max)` if bound as a `char` or **wchar** type.</span></span><br /><br /> <span data-ttu-id="6f4b4-151">Столбцы, являющиеся элементами набора разреженных столбцов `column_set`, не экспортируются как отдельные столбцы, они экспортируются только в составе значения столбца `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-151">Columns that are members of the sparse `column_set` are not exported as distinct columns; they are only exported in the value of the `column_set`.</span></span>|  
|<span data-ttu-id="6f4b4-152">Поведение `queryout` для программы BCP.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-152">`queryout` behavior for BCP.</span></span>|<span data-ttu-id="6f4b4-153">Отличий от предыдущих версий собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в обработке столбцов с явно заданными именами нет.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-153">No change in the handling of explicitly named columns from previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span><br /><br /> <span data-ttu-id="6f4b4-154">Сценарии, задействующие импорт и экспорт между таблицами с различными схемами, могут потребовать специальной обработки.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-154">Scenarios involving import and export between tables with different schemas may require special handling.</span></span><br /><br /> <span data-ttu-id="6f4b4-155">Дополнительные сведения о программе BCP см. в подразделе «Поддержка массового копирования (BCP) для разреженных столбцов» далее в данном разделе.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-155">For more information about BCP, see Bulk Copy (BCP) Support for Sparse Columns, later in this topic.</span></span>|  
  
## <a name="down-level-client-behavior"></a><span data-ttu-id="6f4b4-156">Работа в клиентах низкого уровня</span><span class="sxs-lookup"><span data-stu-id="6f4b4-156">Down-Level Client Behavior</span></span>  
 <span data-ttu-id="6f4b4-157">Клиенты нижнего уровня будут возвращать метаданные только для столбцов, которые не являются членами разреженности `column_set` для SQLColumns и DBSCHMA_COLUMNS.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-157">Down-level clients will return metadata only for columns that are not members of the sparse `column_set` for SQLColumns and DBSCHMA_COLUMNS.</span></span> <span data-ttu-id="6f4b4-158">Дополнительные OLE DB наборы строк схемы, появившиеся в [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] собственном клиенте, будут недоступны, и изменения в SQLColumns в ODBC с помощью SQL_SOPT_SS_NAME_SCOPE не будут.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-158">The additional OLE DB schema rowsets introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client will not be available, nor will the modifications to SQLColumns in ODBC via SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="6f4b4-159">Клиенты низкого уровня могут получить доступ к столбцам, являющимся элементами набора разреженных столбцов `column_set`, по имени; столбец `column_set` будет доступен как XML-столбец для клиентов [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f4b4-159">Down-level clients can access columns that are members of the sparse `column_set` by name, and the `column_set` column will be accessible as an XML column to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] clients.</span></span>  
  
## <a name="bulk-copy-bcp-support-for-sparse-columns"></a><span data-ttu-id="6f4b4-160">Поддержка массового копирования (BCP) для разреженных столбцов</span><span class="sxs-lookup"><span data-stu-id="6f4b4-160">Bulk Copy (BCP) Support for Sparse Columns</span></span>  
 <span data-ttu-id="6f4b4-161">Нет изменений в API-интерфейсе программы BCP ни в ODBC, ни в OLE DB для разреженных столбцов или функций для столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-161">There are no changes to the BCP API in either ODBC or OLE DB for the sparse columns or `column_set` features.</span></span>  
  
 <span data-ttu-id="6f4b4-162">Если таблица содержит набор `column_set`, то разреженные столбцы не обрабатываются как различные столбцы.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-162">If a table has a `column_set`, sparse columns are not handled as distinct columns.</span></span> <span data-ttu-id="6f4b4-163">Значения всех разреженных столбцов включаются в значение `column_set` , которое экспортируется таким же образом, как и XML-столбец, то есть как если бы он был `varbinary(max)` связан как двоичный тип, или как, если он `nvarchar(max)` привязан как `char` тип или **WCHAR** .</span><span class="sxs-lookup"><span data-stu-id="6f4b4-163">The values of all sparse columns are included in the value of the `column_set`, which is exported in the same way as an XML column; that is, as `varbinary(max)` if bound as a binary type, or as `nvarchar(max)` if bound as a `char` or **wchar** type).</span></span> <span data-ttu-id="6f4b4-164">При импорте значение `column_set` должно соответствовать схеме столбца `column_set`.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-164">On import, the `column_set` value must conform to the schema of the `column_set`.</span></span>  
  
 <span data-ttu-id="6f4b4-165">Для операций `queryout` нет изменений в способе обработки столбцов, на которые имеются явные ссылки.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-165">For `queryout` operations, there is no change to the way explicitly referenced columns are handled.</span></span> <span data-ttu-id="6f4b4-166">Поведение столбцов `column_set` совпадает с поведением XML-столбцов, и разреженность не имеет значения для обработки именованных разреженных столбцов.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-166">`column_set` columns have the same behavior as XML columns and sparseness has no effect on the handling of named sparse columns.</span></span>  
  
 <span data-ttu-id="6f4b4-167">Однако, если `queryout` используется для экспорта и пользователь ссылается по имени на разреженные столбцы, являющиеся элементами набора разреженных столбцов, нельзя осуществить импорт напрямую в таблицу такой же структуры.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-167">However, if `queryout` is used for export and you reference sparse columns that are members of the sparse column set by name, you cannot perform a direct import into a similarly structured table.</span></span> <span data-ttu-id="6f4b4-168">Это происходит потому, что BCP использует метаданные, согласованные с операцией \*\* \* SELECT\*\* для импорта, и не может сопоставлять `column_set` столбцы элементов с этими метаданными.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-168">This is because BCP uses metadata consistent with a **select \*** operation for the import and is unable to match `column_set` member columns with this metadata.</span></span> <span data-ttu-id="6f4b4-169">Для отдельного импорта каждого столбца, входящего в набор разреженных столбцов `column_set`, необходимо определить представление для таблицы, которая ссылается на необходимые столбцы набора `column_set`, и выполнить операцию импорта при помощи этого представления.</span><span class="sxs-lookup"><span data-stu-id="6f4b4-169">To import `column_set` member columns individually, you must define a view on the table that references the desired `column_set` columns, and you must perform the import operation using the view.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6f4b4-170">См. также:</span><span class="sxs-lookup"><span data-stu-id="6f4b4-170">See Also</span></span>  
 [<span data-ttu-id="6f4b4-171">Программирование собственного клиента SQL Server</span><span class="sxs-lookup"><span data-stu-id="6f4b4-171">SQL Server Native Client Programming</span></span>](../sql-server-native-client-programming.md)  
  
