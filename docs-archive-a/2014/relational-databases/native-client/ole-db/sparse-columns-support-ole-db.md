---
title: Поддержка разреженных столбцов (OLE DB) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 918574b3-c62e-4937-9e5f-37310dedc8f9
author: rothja
ms.author: jroth
ms.openlocfilehash: 2d40964b3c433b35b5ab9af2637389a022cc3961
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656362"
---
# <a name="sparse-columns-support-ole-db"></a><span data-ttu-id="b8db7-102">Поддержка разреженных столбцов (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b8db7-102">Sparse Columns Support (OLE DB)</span></span>
  <span data-ttu-id="b8db7-103">В этом разделе приводятся сведения о поддержке разреженных столбцов поставщиком OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b8db7-103">This topic provides information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB support for sparse columns.</span></span> <span data-ttu-id="b8db7-104">Дополнительные сведения о разреженных столбцах см. [в разделе Поддержка разреженных столбцов в SQL Server Native Client](../features/sparse-columns-support-in-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="b8db7-104">For more information about sparse columns, see [Sparse Columns Support in SQL Server Native Client](../features/sparse-columns-support-in-sql-server-native-client.md).</span></span> <span data-ttu-id="b8db7-105">Например, [отображение метаданных столбца и каталога для разреженных столбцов (OLE DB)](../../native-client-ole-db-how-to/display-column-and-catalog-metadata-for-sparse-columns-ole-db.md)</span><span class="sxs-lookup"><span data-stu-id="b8db7-105">For a sample, see [Display Column and Catalog Metadata for Sparse Columns &#40;OLE DB&#41;](../../native-client-ole-db-how-to/display-column-and-catalog-metadata-for-sparse-columns-ole-db.md).</span></span>  
  
## <a name="ole-db-statement-metadata"></a><span data-ttu-id="b8db7-106">Метаданные инструкции OLE DB</span><span class="sxs-lookup"><span data-stu-id="b8db7-106">OLE DB Statement Metadata</span></span>  
 <span data-ttu-id="b8db7-107">В версии [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] появилось новое значение DBCOLUMNFLAGS_SS_ISCOLUMNSET флага DBCOLUMNFLAGS.</span><span class="sxs-lookup"><span data-stu-id="b8db7-107">Beginning with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], a new DBCOLUMNFLAGS flag value, DBCOLUMNFLAGS_SS_ISCOLUMNSET, is available.</span></span> <span data-ttu-id="b8db7-108">Это значение должно задаваться для столбцов со значениями `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-108">This value should be set for columns that are `column_set` values.</span></span> <span data-ttu-id="b8db7-109">Флаг DBCOLUMNFLAGS можно получить с помощью параметра *dwFlags* IColumnsInfo::GetColumnsInfo и столбца DBCOLUMN_FLAGS набора строк, возвращаемого IColumnsRowset::GetColumnsRowset.</span><span class="sxs-lookup"><span data-stu-id="b8db7-109">The DBCOLUMNFLAGS flag can be retrieved through the *dwFlags* parameter of IColumnsInfo::GetColumnsInfo and the DBCOLUMN_FLAGS column of the rowset returned by IColumnsRowset::GetColumnsRowset.</span></span>  
  
## <a name="ole-db-catalog-metadata"></a><span data-ttu-id="b8db7-110">Метаданные каталога OLE DB</span><span class="sxs-lookup"><span data-stu-id="b8db7-110">OLE DB Catalog Metadata</span></span>  
 <span data-ttu-id="b8db7-111">В DBSCHEMA_COLUMNS были добавлены два дополнительных столбца, специфичных для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b8db7-111">Two additional [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific columns have been added to DBSCHEMA_COLUMNS.</span></span>  
  
|<span data-ttu-id="b8db7-112">Имя столбца</span><span class="sxs-lookup"><span data-stu-id="b8db7-112">Column name</span></span>|<span data-ttu-id="b8db7-113">Тип данных</span><span class="sxs-lookup"><span data-stu-id="b8db7-113">Data type</span></span>|<span data-ttu-id="b8db7-114">Значения/комментарии</span><span class="sxs-lookup"><span data-stu-id="b8db7-114">Value/comments</span></span>|  
|-----------------|---------------|---------------------|  
|<span data-ttu-id="b8db7-115">SS_IS_SPARSE</span><span class="sxs-lookup"><span data-stu-id="b8db7-115">SS_IS_SPARSE</span></span>|<span data-ttu-id="b8db7-116">DBTYPE_BOOL</span><span class="sxs-lookup"><span data-stu-id="b8db7-116">DBTYPE_BOOL</span></span>|<span data-ttu-id="b8db7-117">Если столбец является разреженным, то значение VARIANT_TRUE. В противном случае — значение VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="b8db7-117">If the column is a sparse column, this has the value VARIANT_TRUE; otherwise, VARIANT_FALSE.</span></span>|  
|<span data-ttu-id="b8db7-118">SS_IS_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="b8db7-118">SS_IS_COLUMN_SET</span></span>|<span data-ttu-id="b8db7-119">DBTYPE_BOOL</span><span class="sxs-lookup"><span data-stu-id="b8db7-119">DBTYPE_BOOL</span></span>|<span data-ttu-id="b8db7-120">Если столбец является разреженным столбцом `column_set`, то значение VARIANT_TRUE. В противном случае — значение VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="b8db7-120">If the column is the sparse `column_set` column, this has the value VARIANT_TRUE; otherwise, VARIANT_FALSE.</span></span>|  
  
 <span data-ttu-id="b8db7-121">Кроме этого, были добавлены два дополнительных набора строк схемы.</span><span class="sxs-lookup"><span data-stu-id="b8db7-121">Two additional schema rowsets have also been added.</span></span> <span data-ttu-id="b8db7-122">Эти наборы строк имеют ту же структуру, что и DBSCHEMA_COLUMNS, но возвращают другое содержимое.</span><span class="sxs-lookup"><span data-stu-id="b8db7-122">These rowsets have the same structure as DBSCHEMA_COLUMNS but return different content.</span></span> <span data-ttu-id="b8db7-123">DBSCHEMA_COLUMNS_EXTENDED возвращает все столбцы, независимо от членства в `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-123">DBSCHEMA_COLUMNS_EXTENDED returns all columns regardless of `column_set` membership.</span></span> <span data-ttu-id="b8db7-124">DBSCHEMA_SPARSE_COLUMN_SET возвращает только те столбцы, которые являются членами разреженного `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-124">DBSCHEMA_SPARSE_COLUMN_SET returns only columns that are members of the sparse `column_set`.</span></span>  
  
## <a name="ole-db-datatypecompatibility-behavior"></a><span data-ttu-id="b8db7-125">Поведение OLE DB DataTypeCompatibility</span><span class="sxs-lookup"><span data-stu-id="b8db7-125">OLE DB DataTypeCompatibility Behavior</span></span>  
 <span data-ttu-id="b8db7-126">Поведение с `DataTypeCompatibility=80` (в строке соединения) согласовано с [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] следующим образом.</span><span class="sxs-lookup"><span data-stu-id="b8db7-126">Behavior with `DataTypeCompatibility=80` (in the connection string) is consistent with a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] client, as follows:</span></span>  
  
-   <span data-ttu-id="b8db7-127">Новые наборы строк схемы невидимы; для них нет строк в наборе строк схемы.</span><span class="sxs-lookup"><span data-stu-id="b8db7-127">The new schema rowsets are not visible, and there are no rows for them in the schema rowsets rowset.</span></span>  
  
-   <span data-ttu-id="b8db7-128">Новые столбцы в наборе строк COLUMNS невидимы.</span><span class="sxs-lookup"><span data-stu-id="b8db7-128">New columns in the COLUMNS rowset are not visible.</span></span>  
  
-   <span data-ttu-id="b8db7-129">DBCOLUMNFLAGS_SS_ISCOLUMNSET не устанавливается для столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-129">DBCOLUMNFLAGS_SS_ISCOLUMNSET is not set for `column_set` columns.</span></span>  
  
-   <span data-ttu-id="b8db7-130">DBCOMPUTEMODE_NOTCOMPUTED устанавливается для столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-130">DBCOMPUTEMODE_NOTCOMPUTED is set for `column_set` columns.</span></span>  
  
## <a name="ole-db-support-for-sparse-columns"></a><span data-ttu-id="b8db7-131">Поддержка разреженных столбцов в OLE DB</span><span class="sxs-lookup"><span data-stu-id="b8db7-131">OLE DB Support for Sparse Columns</span></span>  
 <span data-ttu-id="b8db7-132">Для поддержки разреженных столбцов были изменены следующие интерфейсы OLE DB в собственном клиенте [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b8db7-132">The following OLE DB interfaces were modified in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to support sparse columns:</span></span>  
  
|<span data-ttu-id="b8db7-133">Тип или функция-элемент</span><span class="sxs-lookup"><span data-stu-id="b8db7-133">Type or member function</span></span>|<span data-ttu-id="b8db7-134">Описание</span><span class="sxs-lookup"><span data-stu-id="b8db7-134">Description</span></span>|  
|-----------------------------|-----------------|  
|<span data-ttu-id="b8db7-135">IColumnsInfo::GetColumnsInfo</span><span class="sxs-lookup"><span data-stu-id="b8db7-135">IColumnsInfo::GetColumnsInfo</span></span>|<span data-ttu-id="b8db7-136">DBCOLUMNFLAGS_SS_ISCOLUMNSET задано новое значение флага DBCOLUMNFLAGS для `column_set` столбцов в *dwFlags*.</span><span class="sxs-lookup"><span data-stu-id="b8db7-136">A new DBCOLUMNFLAGS flag value DBCOLUMNFLAGS_SS_ISCOLUMNSET is set for `column_set` columns in *dwFlags*.</span></span><br /><br /> <span data-ttu-id="b8db7-137">Значение DBCOLUMNFLAGS_WRITE устанавливается для столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-137">DBCOLUMNFLAGS_WRITE is set for `column_set` columns.</span></span>|  
|<span data-ttu-id="b8db7-138">IColumsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="b8db7-138">IColumsRowset::GetColumnsRowset</span></span>|<span data-ttu-id="b8db7-139">Новое значение DBCOLUMNFLAGS_SS_ISCOLUMNSET флага DBCOLUMNFLAGS задается для столбцов `column_set` в DBCOLUMN_FLAGS.</span><span class="sxs-lookup"><span data-stu-id="b8db7-139">A new DBCOLUMNFLAGS flag value, DBCOLUMNFLAGS_SS_ISCOLUMNSET, is set for `column_set` columns in DBCOLUMN_FLAGS.</span></span><br /><br /> <span data-ttu-id="b8db7-140">DBCOLUMN_COMPUTEMODE устанавливается в значение DBCOMPUTEMODE_DYNAMIC для столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-140">DBCOLUMN_COMPUTEMODE is set to DBCOMPUTEMODE_DYNAMIC for `column_set` columns.</span></span>|  
|<span data-ttu-id="b8db7-141">IDBSchemaRowset::GetSchemaRowset</span><span class="sxs-lookup"><span data-stu-id="b8db7-141">IDBSchemaRowset::GetSchemaRowset</span></span>|<span data-ttu-id="b8db7-142">DBSCHEMA_COLUMNS возвращает два новых столбца: SS_IS_COLUMN_SET и SS_IS_SPARSE.</span><span class="sxs-lookup"><span data-stu-id="b8db7-142">DBSCHEMA_COLUMNS returns two new columns: SS_IS_COLUMN_SET and SS_IS_SPARSE.</span></span><br /><br /> <span data-ttu-id="b8db7-143">DBSCHEMA_COLUMNS возвращает только те столбцы, которые не являются членами `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-143">DBSCHEMA_COLUMNS returns only columns that are not members of a `column_set`.</span></span><br /><br /> <span data-ttu-id="b8db7-144">Добавлены два новых набора строк схемы: DBSCHEMA_COLUMNS_EXTENDED возвратит все столбцы независимо от их разреженности `column_set` .</span><span class="sxs-lookup"><span data-stu-id="b8db7-144">Two new schema rowsets have been added: DBSCHEMA_COLUMNS_EXTENDED will return all columns regardless of sparseness of `column_set` membership.</span></span> <span data-ttu-id="b8db7-145">DBSCHEMA_SPARSE_COLUMN_SET возвращает только те столбцы, которые являются членами столбца `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-145">DBSCHEMA_SPARSE_COLUMN_SET returns only columns that are members of a `column_set`.</span></span> <span data-ttu-id="b8db7-146">Новые наборы строк содержат те же столбцы и ограничения, что и DBSCHEMA_COLUMNS.</span><span class="sxs-lookup"><span data-stu-id="b8db7-146">These new rowsets have the same columns and restrictions as DBSCHEMA_COLUMNS.</span></span>|  
|<span data-ttu-id="b8db7-147">IDBSchemaRowset::GetSchemas</span><span class="sxs-lookup"><span data-stu-id="b8db7-147">IDBSchemaRowset::GetSchemas</span></span>|<span data-ttu-id="b8db7-148">Метод IDBSchemaRowset::GetSchemas включает идентификаторы GUID для новых наборов строк DBSCHEMA_COLUMNS_EXTENDED и DBSCHEMA_SPARSE_COLUMN_SET в списке доступных наборов строк схемы.</span><span class="sxs-lookup"><span data-stu-id="b8db7-148">IDBSchemaRowset::GetSchemas includes the GUIDs for the new rowsets DBSCHEMA_COLUMNS_EXTENDED and DBSCHEMA_SPARSE_COLUMN_SET in the list of available schema rowsets.</span></span>|  
|<span data-ttu-id="b8db7-149">ICommand::Execute</span><span class="sxs-lookup"><span data-stu-id="b8db7-149">ICommand::Execute</span></span>|<span data-ttu-id="b8db7-150">Если используется **SELECT \* из** *таблицы* , то возвращаются все столбцы, не являющиеся членами РАЗРЕЖЕННОСТИ `column_set` , а также XML-столбец, содержащий значения всех столбцов, отличных от NULL, которые являются элементами разреженного `column_set` , если они есть.</span><span class="sxs-lookup"><span data-stu-id="b8db7-150">If **select \* from** *table* is used, it returns all columns that are not members of the sparse `column_set`, plus an XML column that contains values of all non-null columns that are members of the sparse `column_set`, if present.</span></span>|  
|<span data-ttu-id="b8db7-151">IOpenRowset::OpenRowset</span><span class="sxs-lookup"><span data-stu-id="b8db7-151">IOpenRowset::OpenRowset</span></span>|<span data-ttu-id="b8db7-152">IOpenRowset::OpenRowset возвращает набор строк с теми же столбцами, что и ICommand::Execute, с запросом **select \*** в той же таблице.</span><span class="sxs-lookup"><span data-stu-id="b8db7-152">IOpenRowset::OpenRowset returns a rowset with the same columns as ICommand::Execute, with a **select \*** query on the same table.</span></span>|  
|<span data-ttu-id="b8db7-153">ITableDefinition</span><span class="sxs-lookup"><span data-stu-id="b8db7-153">ITableDefinition</span></span>|<span data-ttu-id="b8db7-154">Этот интерфейс не изменился для разреженных столбцов или столбцов `column_set`.</span><span class="sxs-lookup"><span data-stu-id="b8db7-154">There is no change to this interface for sparse columns or for `column_set` columns.</span></span> <span data-ttu-id="b8db7-155">Приложения, которым необходимо изменить схему, должны выполнить соответствующий код [!INCLUDE[tsql](../../../includes/tsql-md.md)] напрямую.</span><span class="sxs-lookup"><span data-stu-id="b8db7-155">Applications that have to make schema modifications must execute the appropriate [!INCLUDE[tsql](../../../includes/tsql-md.md)] directly.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b8db7-156">См. также:</span><span class="sxs-lookup"><span data-stu-id="b8db7-156">See Also</span></span>  
 [<span data-ttu-id="b8db7-157">SQL Server Native Client (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b8db7-157">SQL Server Native Client &#40;OLE DB&#41;</span></span>](sql-server-native-client-ole-db.md)  
  
  
