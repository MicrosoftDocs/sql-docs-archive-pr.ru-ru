---
title: Большие определяемые пользователем типы данных CLR (OLE DB) | Документация Майкрософт
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- large CLR user-defined types [OLE DB]
ms.assetid: 4bf12058-0534-42ca-a5ba-b1c23b24d90f
author: rothja
ms.author: jroth
ms.openlocfilehash: 62384b2be5fda767ba306c0e9321fd27b8239f10
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87730589"
---
# <a name="large-clr-user-defined-types-ole-db"></a><span data-ttu-id="2ea0c-102">Большие определяемые пользователем типы данных CLR (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-102">Large CLR User-Defined Types (OLE DB)</span></span>
  <span data-ttu-id="2ea0c-103">В этом разделе описываются изменения OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], связанные с поддержкой больших определяемых пользователем типов данных среды CLR.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-103">This topic discusses the changes to OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to support large common language runtime (CLR) user-defined types (UDTs).</span></span>  
  
 <span data-ttu-id="2ea0c-104">Дополнительные сведения о поддержке больших определяемых пользователем типов CLR в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] собственном клиенте см. в разделе [типы больших пользовательских данных CLR](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="2ea0c-104">For more information about support for large CLR UDTs in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Large CLR User-Defined Types](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span></span> <span data-ttu-id="2ea0c-105">Пример см. в статье [об использовании больших определяемых пользователем типов CLR в OLE DB](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="2ea0c-105">For a sample, see [Use Large CLR UDTs &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span></span>  
  
## <a name="data-format"></a><span data-ttu-id="2ea0c-106">Формат данных</span><span class="sxs-lookup"><span data-stu-id="2ea0c-106">Data Format</span></span>  
 <span data-ttu-id="2ea0c-107">Собственный клиент [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] использует значение ~0 для представления значений с неограниченным размером типа больших объектов.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-107">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client uses ~0 to represent the length of values that are of unlimited size for large object (LOB) types.</span></span> <span data-ttu-id="2ea0c-108">Значение ~0 также представляет размер определяемых пользователем типов данных CLR, превышающий 8 000 байт.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-108">~0 also represents the size of CLR UDTs that are larger than 8,000 bytes.</span></span>  
  
 <span data-ttu-id="2ea0c-109">В следующей таблице показано сопоставление типов данных в параметрах и наборах строк.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-109">The following table shows data type mapping in parameters and rowsets:</span></span>  
  
|<span data-ttu-id="2ea0c-110">Тип данных SQL Server</span><span class="sxs-lookup"><span data-stu-id="2ea0c-110">SQL Server data type</span></span>|<span data-ttu-id="2ea0c-111">Тип данных OLE DB</span><span class="sxs-lookup"><span data-stu-id="2ea0c-111">OLE DB data type</span></span>|<span data-ttu-id="2ea0c-112">Организация памяти</span><span class="sxs-lookup"><span data-stu-id="2ea0c-112">Memory layout</span></span>|<span data-ttu-id="2ea0c-113">Значение</span><span class="sxs-lookup"><span data-stu-id="2ea0c-113">Value</span></span>|  
|--------------------------|----------------------|-------------------|-----------|  
|<span data-ttu-id="2ea0c-114">определяемый пользователем тип среды CLR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-114">CLR UDT</span></span>|<span data-ttu-id="2ea0c-115">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-115">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-116">BYTE[](массив байтов\)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-116">BYTE[](byte array\)</span></span>|<span data-ttu-id="2ea0c-117">132 (oledb.h)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-117">132 (oledb.h)</span></span>|  
  
 <span data-ttu-id="2ea0c-118">Значения определяемых пользователем типов представляются в виде массивов байт.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-118">UDT values are represented as byte arrays.</span></span> <span data-ttu-id="2ea0c-119">Поддерживается преобразование данных в шестнадцатеричные строки и из шестнадцатеричных строк.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-119">Conversions to and from hex strings are supported.</span></span> <span data-ttu-id="2ea0c-120">Литеральные значения представляются в виде шестнадцатеричных строк с префиксом «0x».</span><span class="sxs-lookup"><span data-stu-id="2ea0c-120">Literal values are represented as hex strings with a prefix of "0x".</span></span> <span data-ttu-id="2ea0c-121">Шестнадцатеричная строка является текстовым представлением двоичных данных с основанием 16.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-121">A hex string is the textual representation of binary data in base 16.</span></span> <span data-ttu-id="2ea0c-122">Например, при преобразовании из серверного типа `varbinary(10)` в тип DBTYPE_STR получается шестнадцатеричное представление длиной в 20 символов, в котором каждая пара символов представляет один байт.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-122">A example is a conversion from server type `varbinary(10)` to DBTYPE_STR, which results in hexadecimal representation of 20 characters where every pair of characters represents a single byte.</span></span>  
  
## <a name="parameter-properties"></a><span data-ttu-id="2ea0c-123">Свойства параметра</span><span class="sxs-lookup"><span data-stu-id="2ea0c-123">Parameter Properties</span></span>  
 <span data-ttu-id="2ea0c-124">Набор свойств DBPROPSET_SQLSERVERPARAMETER поддерживает определяемый пользователем тип через OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-124">The DBPROPSET_SQLSERVERPARAMETER property set supports UDTs through OLE DB.</span></span> <span data-ttu-id="2ea0c-125">Дополнительные сведения см. в статье [Использование пользовательских типов](../features/using-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="2ea0c-125">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="column-properties"></a><span data-ttu-id="2ea0c-126">Свойства столбца</span><span class="sxs-lookup"><span data-stu-id="2ea0c-126">Column Properties</span></span>  
 <span data-ttu-id="2ea0c-127">Набор свойств DBPROPSET_SQLSERVERCOLUMN поддерживает создание таблиц через OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-127">The DBPROPSET_SQLSERVERCOLUMN property set supports the creation of tables through OLE DB.</span></span> <span data-ttu-id="2ea0c-128">Дополнительные сведения см. в статье [Использование пользовательских типов](../features/using-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="2ea0c-128">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="data-type-mapping-in-itabledefinitioncreatetable"></a><span data-ttu-id="2ea0c-129">Сопоставление типов данных в методе ITableDefinition::CreateTable</span><span class="sxs-lookup"><span data-stu-id="2ea0c-129">Data Type Mapping in ITableDefinition::CreateTable</span></span>  
 <span data-ttu-id="2ea0c-130">Следующие сведения используются в `DBCOLUMNDESC` структурах, используемых ITableDefinition:: CreateTable, если требуются столбцы определяемого пользователем типа:</span><span class="sxs-lookup"><span data-stu-id="2ea0c-130">The following information is used in `DBCOLUMNDESC` structures used by ITableDefinition::CreateTable when UDT columns are required:</span></span>  
  
|<span data-ttu-id="2ea0c-131">Тип данных OLE DB (*wType*)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-131">OLE DB data type (*wType*)</span></span>|<span data-ttu-id="2ea0c-132">*pwszTypeName*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-132">*pwszTypeName*</span></span>|<span data-ttu-id="2ea0c-133">Тип данных SQL Server</span><span class="sxs-lookup"><span data-stu-id="2ea0c-133">SQL Server data type</span></span>|<span data-ttu-id="2ea0c-134">*rgPropertySets*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-134">*rgPropertySets*</span></span>|  
|----------------------------------|--------------------|--------------------------|----------------------|  
|<span data-ttu-id="2ea0c-135">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-135">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-136">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="2ea0c-136">Ignored</span></span>|<span data-ttu-id="2ea0c-137">(UDT)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-137">UDT</span></span>|<span data-ttu-id="2ea0c-138">Должен включать набор свойств DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-138">Must include a DBPROPSET_SQLSERVERCOLUMN property set.</span></span>|  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="2ea0c-139">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="2ea0c-139">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="2ea0c-140">В структуру DBPARAMINFO через **prgParamInfo** возвращаются указанные ниже сведения.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-140">Information returned in the DBPARAMINFO structure through **prgParamInfo** is as follows:</span></span>  
  
|<span data-ttu-id="2ea0c-141">Тип параметра</span><span class="sxs-lookup"><span data-stu-id="2ea0c-141">Parameter type</span></span>|<span data-ttu-id="2ea0c-142">*wType*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-142">*wType*</span></span>|<span data-ttu-id="2ea0c-143">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-143">*ulParamSize*</span></span>|<span data-ttu-id="2ea0c-144">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-144">*bPrecision*</span></span>|<span data-ttu-id="2ea0c-145">*bScale*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-145">*bScale*</span></span>|<span data-ttu-id="2ea0c-146">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="2ea0c-146">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="2ea0c-147">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-147">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-148">(длина не более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-148">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-149">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="2ea0c-149">"DBTYPE_UDT"</span></span>|<span data-ttu-id="2ea0c-150">*n*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-150">*n*</span></span>|<span data-ttu-id="2ea0c-151">неопределенный</span><span class="sxs-lookup"><span data-stu-id="2ea0c-151">undefined</span></span>|<span data-ttu-id="2ea0c-152">неопределенный</span><span class="sxs-lookup"><span data-stu-id="2ea0c-152">undefined</span></span>|<span data-ttu-id="2ea0c-153">clear</span><span class="sxs-lookup"><span data-stu-id="2ea0c-153">clear</span></span>|  
|<span data-ttu-id="2ea0c-154">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-154">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-155">(длина более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-155">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-156">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="2ea0c-156">"DBTYPE_UDT"</span></span>|<span data-ttu-id="2ea0c-157">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-157">~0</span></span>|<span data-ttu-id="2ea0c-158">неопределенный</span><span class="sxs-lookup"><span data-stu-id="2ea0c-158">undefined</span></span>|<span data-ttu-id="2ea0c-159">неопределенный</span><span class="sxs-lookup"><span data-stu-id="2ea0c-159">undefined</span></span>|<span data-ttu-id="2ea0c-160">set</span><span class="sxs-lookup"><span data-stu-id="2ea0c-160">set</span></span>|  
  
## <a name="icommandwithparameterssetparameterinfo"></a><span data-ttu-id="2ea0c-161">ICommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="2ea0c-161">ICommandWithParameters::SetParameterInfo</span></span>  
 <span data-ttu-id="2ea0c-162">Сведения, предоставленные в структуре DBPARAMBINDINFO, должны соответствовать следующим требованиям.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-162">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="2ea0c-163">Тип параметра</span><span class="sxs-lookup"><span data-stu-id="2ea0c-163">Parameter type</span></span>|<span data-ttu-id="2ea0c-164">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-164">*pwszDataSourceType*</span></span>|<span data-ttu-id="2ea0c-165">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-165">*ulParamSize*</span></span>|<span data-ttu-id="2ea0c-166">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-166">*bPrecision*</span></span>|<span data-ttu-id="2ea0c-167">*bScale*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-167">*bScale*</span></span>|<span data-ttu-id="2ea0c-168">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="2ea0c-168">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|--------------------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="2ea0c-169">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-169">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-170">(длина не более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-170">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-171">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-171">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-172">*n*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-172">*n*</span></span>|<span data-ttu-id="2ea0c-173">не учитывается</span><span class="sxs-lookup"><span data-stu-id="2ea0c-173">ignored</span></span>|<span data-ttu-id="2ea0c-174">не учитывается</span><span class="sxs-lookup"><span data-stu-id="2ea0c-174">ignored</span></span>|<span data-ttu-id="2ea0c-175">Должен быть задан, если параметр передается с помощью DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-175">Must be set if the parameter is to be passed using DBTYPE_IUNKNOWN.</span></span>|  
|<span data-ttu-id="2ea0c-176">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-176">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-177">(длина более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-177">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-178">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-178">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-179">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-179">~0</span></span>|<span data-ttu-id="2ea0c-180">не учитывается</span><span class="sxs-lookup"><span data-stu-id="2ea0c-180">ignored</span></span>|<span data-ttu-id="2ea0c-181">не учитывается</span><span class="sxs-lookup"><span data-stu-id="2ea0c-181">ignored</span></span>|<span data-ttu-id="2ea0c-182">не учитывается</span><span class="sxs-lookup"><span data-stu-id="2ea0c-182">ignored</span></span>|  
  
## <a name="isscommandwithparameters"></a><span data-ttu-id="2ea0c-183">ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="2ea0c-183">ISSCommandWithParameters</span></span>  
 <span data-ttu-id="2ea0c-184">Чтобы вернуть и задать свойства параметров, определенные в разделе "Свойства параметров", приложения используют интерфейс **ISSCommandWithParameters**.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-184">Applications use **ISSCommandWithParameters** to get and set the parameter properties defined in the Parameter Properties section.</span></span>  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="2ea0c-185">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="2ea0c-185">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="2ea0c-186">Возвращаются следующие столбцы.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-186">Columns returned are as follows:</span></span>  
  
|<span data-ttu-id="2ea0c-187">Тип столбца</span><span class="sxs-lookup"><span data-stu-id="2ea0c-187">Column type</span></span>|<span data-ttu-id="2ea0c-188">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-188">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="2ea0c-189">DBCOLUMN_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-189">DBCOLUMN_COLUMNSIZE</span></span>|<span data-ttu-id="2ea0c-190">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="2ea0c-190">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="2ea0c-191">DBCOLUMN_SCALE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-191">DBCOLUMN_SCALE</span></span>|<span data-ttu-id="2ea0c-192">DBCOLUMN_FLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="2ea0c-192">DBCOLUMN_FLAGS_ISLONG</span></span>|<span data-ttu-id="2ea0c-193">DBCOLUMNS_ISSEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-193">DBCOLUMNS_ISSEARCHABLE</span></span>|<span data-ttu-id="2ea0c-194">DBCOLUMN_OCTETLENGTH</span><span class="sxs-lookup"><span data-stu-id="2ea0c-194">DBCOLUMN_OCTETLENGTH</span></span>|  
|-----------------|--------------------|--------------------------|-------------------------|---------------------|-----------------------------|-----------------------------|---------------------------|  
|<span data-ttu-id="2ea0c-195">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-195">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-196">(длина не более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-196">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-197">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-197">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-198">*n*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-198">*n*</span></span>|<span data-ttu-id="2ea0c-199">NULL</span><span class="sxs-lookup"><span data-stu-id="2ea0c-199">NULL</span></span>|<span data-ttu-id="2ea0c-200">NULL</span><span class="sxs-lookup"><span data-stu-id="2ea0c-200">NULL</span></span>|<span data-ttu-id="2ea0c-201">Очистить</span><span class="sxs-lookup"><span data-stu-id="2ea0c-201">Clear</span></span>|<span data-ttu-id="2ea0c-202">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-202">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="2ea0c-203">n</span><span class="sxs-lookup"><span data-stu-id="2ea0c-203">n</span></span>|  
|<span data-ttu-id="2ea0c-204">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-204">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-205">(длина более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-205">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-206">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-206">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-207">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-207">~0</span></span>|<span data-ttu-id="2ea0c-208">NULL</span><span class="sxs-lookup"><span data-stu-id="2ea0c-208">NULL</span></span>|<span data-ttu-id="2ea0c-209">NULL</span><span class="sxs-lookup"><span data-stu-id="2ea0c-209">NULL</span></span>|<span data-ttu-id="2ea0c-210">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="2ea0c-210">Set</span></span>|<span data-ttu-id="2ea0c-211">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-211">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="2ea0c-212">0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-212">0</span></span>|  
  
 <span data-ttu-id="2ea0c-213">Для определяемых пользователем типов определяются также следующие столбцы.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-213">The following columns are also defined for UDTs:</span></span>  
  
|<span data-ttu-id="2ea0c-214">Идентификатор столбца</span><span class="sxs-lookup"><span data-stu-id="2ea0c-214">Column Identifier</span></span>|<span data-ttu-id="2ea0c-215">Type</span><span class="sxs-lookup"><span data-stu-id="2ea0c-215">Type</span></span>|<span data-ttu-id="2ea0c-216">Описание</span><span class="sxs-lookup"><span data-stu-id="2ea0c-216">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="2ea0c-217">DBCOLUMN_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-217">DBCOLUMN_UDT_CATALOGNAME</span></span>|<span data-ttu-id="2ea0c-218">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-218">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-219">Для столбцов определяемого пользователем типа — имя каталога, в котором определен тип, определяемый пользователем.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-219">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="2ea0c-220">DBCOLUMN_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-220">DBCOLUMN_UDT_SCHEMANAME</span></span>|<span data-ttu-id="2ea0c-221">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-221">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-222">Для столбцов определяемого пользователем типа — имя схемы, в которой определен тип, определяемый пользователем.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-222">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="2ea0c-223">DBCOLUMN_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-223">DBCOLUMN_UDT_NAME</span></span>|<span data-ttu-id="2ea0c-224">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-224">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-225">Для столбцов определяемого пользователем типа — однокомпонентное имя типа.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-225">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="2ea0c-226">DBCOLUMN_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-226">DBCOLUMN_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="2ea0c-227">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-227">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-228">Для столбцов определяемого пользователем типа — полное имя типа.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-228">For UDT columns, the full type name of the UDT.</span></span> <span data-ttu-id="2ea0c-229">Полное имя типа сборки позволяет создать экземпляр объекта этого типа с помощью метода Type.GetType.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-229">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="2ea0c-230">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="2ea0c-230">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="2ea0c-231">В структуру DBCOLUMNINFO возвращаются следующие сведения.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-231">The information returned in the DBCOLUMNINFO structure is as follows:</span></span>  
  
|<span data-ttu-id="2ea0c-232">Тип параметра</span><span class="sxs-lookup"><span data-stu-id="2ea0c-232">Parameter type</span></span>|<span data-ttu-id="2ea0c-233">*wType*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-233">*wType*</span></span>|<span data-ttu-id="2ea0c-234">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-234">*ulColumnSize*</span></span>|<span data-ttu-id="2ea0c-235">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-235">*bPrecision*</span></span>|<span data-ttu-id="2ea0c-236">*bScale*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-236">*bScale*</span></span>|<span data-ttu-id="2ea0c-237">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-237">*dwFlags*</span></span><br /><br /> <span data-ttu-id="2ea0c-238">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="2ea0c-238">DBCOLUMNFLAGS_ISLONG</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------|  
|<span data-ttu-id="2ea0c-239">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-239">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-240">(длина не более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-240">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-241">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-241">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-242">*n*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-242">*n*</span></span>|<span data-ttu-id="2ea0c-243">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-243">~0</span></span>|<span data-ttu-id="2ea0c-244">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-244">~0</span></span>|<span data-ttu-id="2ea0c-245">Очистить</span><span class="sxs-lookup"><span data-stu-id="2ea0c-245">Clear</span></span>|  
|<span data-ttu-id="2ea0c-246">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-246">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-247">(длина более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-247">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-248">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-248">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-249">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-249">~0</span></span>|<span data-ttu-id="2ea0c-250">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-250">~0</span></span>|<span data-ttu-id="2ea0c-251">~0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-251">~0</span></span>|<span data-ttu-id="2ea0c-252">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="2ea0c-252">Set</span></span>|  
  
## <a name="columns-rowset-schema-rowsets"></a><span data-ttu-id="2ea0c-253">Набор строк COLUMNS (наборы строк схемы)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-253">COLUMNS Rowset (Schema Rowsets)</span></span>  
 <span data-ttu-id="2ea0c-254">Для определяемых пользователем типов возвращаются значения следующих столбцов.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-254">The following column values are returned for UDT types:</span></span>  
  
|<span data-ttu-id="2ea0c-255">Тип столбца</span><span class="sxs-lookup"><span data-stu-id="2ea0c-255">Column type</span></span>|<span data-ttu-id="2ea0c-256">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-256">DATA_TYPE</span></span>|<span data-ttu-id="2ea0c-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="2ea0c-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span></span>|<span data-ttu-id="2ea0c-258">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="2ea0c-258">CHARACTER_OCTET_LENGTH</span></span>|  
|-----------------|----------------|-----------------------------------------|------------------------------|  
|<span data-ttu-id="2ea0c-259">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-259">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-260">(длина не более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-260">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-261">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-261">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-262">Очистить</span><span class="sxs-lookup"><span data-stu-id="2ea0c-262">Clear</span></span>|<span data-ttu-id="2ea0c-263">*n*</span><span class="sxs-lookup"><span data-stu-id="2ea0c-263">*n*</span></span>|  
|<span data-ttu-id="2ea0c-264">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-264">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-265">(длина более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-265">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-266">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-266">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-267">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="2ea0c-267">Set</span></span>|<span data-ttu-id="2ea0c-268">0</span><span class="sxs-lookup"><span data-stu-id="2ea0c-268">0</span></span>|  
  
 <span data-ttu-id="2ea0c-269">Для определяемых пользователем типов определяются также следующие дополнительные столбцы.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-269">The following additional columns are defined for UDTs:</span></span>  
  
|<span data-ttu-id="2ea0c-270">Идентификатор столбца</span><span class="sxs-lookup"><span data-stu-id="2ea0c-270">Column identifier</span></span>|<span data-ttu-id="2ea0c-271">Type</span><span class="sxs-lookup"><span data-stu-id="2ea0c-271">Type</span></span>|<span data-ttu-id="2ea0c-272">Описание</span><span class="sxs-lookup"><span data-stu-id="2ea0c-272">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="2ea0c-273">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-273">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="2ea0c-274">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-274">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-275">Для столбцов определяемого пользователем типа — имя каталога, в котором определен тип, определяемый пользователем.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-275">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="2ea0c-276">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-276">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="2ea0c-277">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-277">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-278">Для столбцов определяемого пользователем типа — имя схемы, в которой определен тип, определяемый пользователем.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-278">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="2ea0c-279">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-279">SS_UDT_NAME</span></span>|<span data-ttu-id="2ea0c-280">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-280">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-281">Для столбцов определяемого пользователем типа — однокомпонентное имя типа.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-281">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="2ea0c-282">SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="2ea0c-282">SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="2ea0c-283">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-283">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-284">Для столбцов определяемого пользователем типа — полное имя типа.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-284">For UDT columns, this is the full type name of the UDT.</span></span> <span data-ttu-id="2ea0c-285">Полное имя типа сборки позволяет создать экземпляр объекта этого типа с помощью метода Type.GetType.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-285">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
 <span data-ttu-id="2ea0c-286">Что касается набора строк PROCEDURE_PARAMETERS, DATA_TYPE содержит те же значения, что и набор строк схемы COLUMNS, а TYPE_NAME содержит определяемые пользователем типы.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-286">Regarding the PROCEDURE_PARAMETERS rowset, DATA_TYPE contains the same values as the COLUMNS schema rowset and TYPE_NAME contains UDT.</span></span> <span data-ttu-id="2ea0c-287">Такие же дополнительные столбцы также определены.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-287">The same additional columns are also defined.</span></span>  
  
 <span data-ttu-id="2ea0c-288">Определяемые пользователем типы не появятся в наборе строк схемы PROVIDER_TYPES.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-288">User-defined types will not appear in the PROVIDER_TYPES schema rowset.</span></span>  
  
## <a name="bindings-and-conversions"></a><span data-ttu-id="2ea0c-289">Привязки и преобразования</span><span class="sxs-lookup"><span data-stu-id="2ea0c-289">Bindings and Conversions</span></span>  
  
|<span data-ttu-id="2ea0c-290">Привязка типов данных</span><span class="sxs-lookup"><span data-stu-id="2ea0c-290">Binding data tpe</span></span>|<span data-ttu-id="2ea0c-291">Определяемый пользователем тип к серверному типу</span><span class="sxs-lookup"><span data-stu-id="2ea0c-291">UDT to server</span></span>|<span data-ttu-id="2ea0c-292">Тип, не определяемый пользователем, к серверному типу</span><span class="sxs-lookup"><span data-stu-id="2ea0c-292">Non-UDT to server</span></span>|<span data-ttu-id="2ea0c-293">Серверный тип к определяемому пользователем типу</span><span class="sxs-lookup"><span data-stu-id="2ea0c-293">UDT from server</span></span>|<span data-ttu-id="2ea0c-294">Серверный тип к типу, не определяемому пользователем</span><span class="sxs-lookup"><span data-stu-id="2ea0c-294">Non-UDT from server</span></span>|  
|----------------------|-------------------|------------------------|---------------------|--------------------------|  
|<span data-ttu-id="2ea0c-295">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-295">DBTYPE_UDT</span></span>|<span data-ttu-id="2ea0c-296">Поддерживается (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-296">Supported (5)</span></span>|<span data-ttu-id="2ea0c-297">Ошибка (1)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-297">Error (1)</span></span>|<span data-ttu-id="2ea0c-298">Поддерживается (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-298">Supported (5)</span></span>|<span data-ttu-id="2ea0c-299">Ошибка (4)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-299">Error (4)</span></span>|  
|<span data-ttu-id="2ea0c-300">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="2ea0c-300">DBTYPE_BYTES</span></span>|<span data-ttu-id="2ea0c-301">Поддерживается (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-301">Supported (5)</span></span>|<span data-ttu-id="2ea0c-302">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-302">N/A</span></span>|<span data-ttu-id="2ea0c-303">Поддерживается (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-303">Supported (5)</span></span>|<span data-ttu-id="2ea0c-304">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-304">N/A</span></span>|  
|<span data-ttu-id="2ea0c-305">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-305">DBTYPE_WSTR</span></span>|<span data-ttu-id="2ea0c-306">Поддерживается (2), (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-306">Supported (2), (5)</span></span>|<span data-ttu-id="2ea0c-307">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-307">N/A</span></span>|<span data-ttu-id="2ea0c-308">Поддерживается (3), (5), (6)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-308">Supported (3), (5), (6)</span></span>|<span data-ttu-id="2ea0c-309">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-309">N/A</span></span>|  
|<span data-ttu-id="2ea0c-310">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-310">DBTYPE_BSTR</span></span>|<span data-ttu-id="2ea0c-311">Поддерживается (2), (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-311">Supported (2), (5)</span></span>|<span data-ttu-id="2ea0c-312">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-312">N/A</span></span>|<span data-ttu-id="2ea0c-313">Поддерживается (3), (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-313">Supported (3), (5)</span></span>|<span data-ttu-id="2ea0c-314">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-314">N/A</span></span>|  
|<span data-ttu-id="2ea0c-315">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-315">DBTYPE_STR</span></span>|<span data-ttu-id="2ea0c-316">Поддерживается (2), (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-316">Supported (2), (5)</span></span>|<span data-ttu-id="2ea0c-317">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-317">N/A</span></span>|<span data-ttu-id="2ea0c-318">Поддерживается (3), (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-318">Supported (3), (5)</span></span>|<span data-ttu-id="2ea0c-319">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-319">N/A</span></span>|  
|<span data-ttu-id="2ea0c-320">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="2ea0c-320">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="2ea0c-321">Поддерживается (6)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-321">Supported (6)</span></span>|<span data-ttu-id="2ea0c-322">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-322">N/A</span></span>|<span data-ttu-id="2ea0c-323">Поддерживается (6)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-323">Supported (6)</span></span>|<span data-ttu-id="2ea0c-324">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-324">N/A</span></span>|  
|<span data-ttu-id="2ea0c-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="2ea0c-326">Поддерживается (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-326">Supported  (5)</span></span>|<span data-ttu-id="2ea0c-327">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-327">N/A</span></span>|<span data-ttu-id="2ea0c-328">Поддерживается (3), (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-328">Supported (3), (5)</span></span>|<span data-ttu-id="2ea0c-329">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-329">N/A</span></span>|  
|<span data-ttu-id="2ea0c-330">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-330">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="2ea0c-331">Поддерживается (2), (5)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-331">Supported (2), (5)</span></span>|<span data-ttu-id="2ea0c-332">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-332">N/A</span></span>|<span data-ttu-id="2ea0c-333">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-333">N/A</span></span>|<span data-ttu-id="2ea0c-334">Недоступно</span><span class="sxs-lookup"><span data-stu-id="2ea0c-334">N/A</span></span>|  
  
### <a name="key-to-symbols"></a><span data-ttu-id="2ea0c-335">Расшифровка символов</span><span class="sxs-lookup"><span data-stu-id="2ea0c-335">Key to Symbols</span></span>  
  
|<span data-ttu-id="2ea0c-336">Символ</span><span class="sxs-lookup"><span data-stu-id="2ea0c-336">Symbol</span></span>|<span data-ttu-id="2ea0c-337">Значение</span><span class="sxs-lookup"><span data-stu-id="2ea0c-337">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="2ea0c-338">1</span><span class="sxs-lookup"><span data-stu-id="2ea0c-338">1</span></span>|<span data-ttu-id="2ea0c-339">Если серверный тип, отличный от DBTYPE_UDT, указан с помощью метода **ICommandWithParameters::SetParameterInfo**, а тип метода доступа — DBTYPE_UDT, то при выполнении инструкции возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-339">If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed.</span></span>  <span data-ttu-id="2ea0c-340">Будет возвращена ошибка DB_E_ERRORSOCCURRED, и состояние параметра будет DBSTATUS_E_BADACCESSOR.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-340">The error will be DB_E_ERRORSOCCURRED and the parameter status will be DBSTATUS_E_BADACCESSOR.</span></span><br /><br /> <span data-ttu-id="2ea0c-341">Ошибкой является указание параметра определяемого пользователем типа для серверного параметра, тип которого отличен от определяемого пользователем типа.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-341">It is an error to specify a parameter of type UDT for a server parameter that is not a UDT.</span></span>|  
|<span data-ttu-id="2ea0c-342">2</span><span class="sxs-lookup"><span data-stu-id="2ea0c-342">2</span></span>|<span data-ttu-id="2ea0c-343">Данные преобразуются из шестнадцатеричной строки в двоичные данные.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-343">Data is converted from hex string to binary data.</span></span>|  
|<span data-ttu-id="2ea0c-344">3</span><span class="sxs-lookup"><span data-stu-id="2ea0c-344">3</span></span>|<span data-ttu-id="2ea0c-345">Данные преобразуются из двоичных данных в шестнадцатеричную строку.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-345">Data is converted from binary data to hex string.</span></span>|  
|<span data-ttu-id="2ea0c-346">4</span><span class="sxs-lookup"><span data-stu-id="2ea0c-346">4</span></span>|<span data-ttu-id="2ea0c-347">При использовании метода **CreateAccessor** или **GetNextRows** может быть выполнена проверка.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-347">Validation can happen when using **CreateAccessor** or **GetNextRows**.</span></span> <span data-ttu-id="2ea0c-348">Ошибка DB_E_ERRORSOCCURRED.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-348">The error is DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="2ea0c-349">Состояние привязки установлено в значение DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-349">Binding status is set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>|  
|<span data-ttu-id="2ea0c-350">5</span><span class="sxs-lookup"><span data-stu-id="2ea0c-350">5</span></span>|<span data-ttu-id="2ea0c-351">Может использоваться BY_REF.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-351">BY_REF may be used.</span></span>|  
|<span data-ttu-id="2ea0c-352">6</span><span class="sxs-lookup"><span data-stu-id="2ea0c-352">6</span></span>|<span data-ttu-id="2ea0c-353">Параметры определяемого пользователем типа могут быть привязаны в структуре DBBINDING как DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-353">UDT parameters can be bound as DBTYPE_IUNKNOWN in the DBBINDING.</span></span> <span data-ttu-id="2ea0c-354">Привязка к DBTYPE_IUNKNOWN показывает, что приложению необходимо обработать данные в виде потока с помощью интерфейса ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-354">Binding to DBTYPE_IUNKNOWN indicates that the application wants to process the data as a stream using the ISequentialStream interface.</span></span> <span data-ttu-id="2ea0c-355">Если потребитель указывает *wType* в привязке как тип DBTYPE_IUNKNOWN, а соответствующий столбец или выходной параметр хранимой процедуры является определяемым пользователем типом, SQL Server Native Client возвратит ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-355">When a consumer specifies *wType* in a binding as type DBTYPE_IUNKNOWN, and the corresponding column or output parameter of the stored procedure is a UDT, SQL Server Native Client will return ISequentialStream.</span></span> <span data-ttu-id="2ea0c-356">Для входного параметра SQL Server Native Client запрашивает интерфейс для интерфейса ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-356">For an input parameter, SQL Server Native Client will query for the for the ISequentialStream interface.</span></span><br /><br /> <span data-ttu-id="2ea0c-357">В случае больших определяемых пользователем типов можно не привязывать длину данных определяемого пользователем типа при использовании привязки DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-357">You can choose to not bind the length of UDT data while using DBTYPE_IUNKNOWN binding, in the case of large UDTs.</span></span> <span data-ttu-id="2ea0c-358">Однако для маленьких определяемых пользователем типов необходимо выполнять привязку длины.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-358">However, the length must be bound for small UDTs.</span></span> <span data-ttu-id="2ea0c-359">Для параметра DBTYPE_UDT можно указать большой определяемый пользователем тип, если выполняется одно или более из следующих условий.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-359">A DBTYPE_UDT parameter can be specified as a large UDT if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="2ea0c-360">-   *улпарампарамсизе* имеет значение ~ 0.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-360">-   *ulParamParamSize* is ~0.</span></span><br /><span data-ttu-id="2ea0c-361">-DBPARAMFLAGS_ISLONG задается в структуре DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-361">-   DBPARAMFLAGS_ISLONG is set in the DBPARAMBINDINFO struct.</span></span><br /><br /> <span data-ttu-id="2ea0c-362">Для строковых данных привязка DBTYPE_IUNKNOWN разрешена только для больших определяемых пользователем типов.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-362">For row data, DBTYPE_IUNKNOWN binding is only allowed for large UDTs.</span></span> <span data-ttu-id="2ea0c-363">Чтобы проверить, содержит ли столбец данные большого определяемого пользователем типа, примените метод IColumnsInfo::GetColumnInfo к интерфейсу IColumnsInfo объекта Rowset или Command.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-363">You can find out whether a column is a large UDT type by using the IColumnsInfo::GetColumnInfo method on a Rowset or Command object's IColumnsInfo interface.</span></span> <span data-ttu-id="2ea0c-364">Столбец DBTYPE_UDT имеет большой определяемый пользователь тип, если выполняется по крайней мере одно из следующих условий.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-364">A DBTYPE_UDT column is a large UDT column if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="2ea0c-365">-DBCOLUMNFLAGS_ISLONG флаг установлен для элемента *dwFlags* структуры DBCOLUMNINFO</span><span class="sxs-lookup"><span data-stu-id="2ea0c-365">-   DBCOLUMNFLAGS_ISLONG flag is set on *dwFlags* member of DBCOLUMNINFO structure</span></span><br /><span data-ttu-id="2ea0c-366">-   *ulColumnSize* член DBCOLUMNINFO имеет значение ~ 0.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-366">-   *ulColumnSize* member of DBCOLUMNINFO is ~0.</span></span>|  
  
 <span data-ttu-id="2ea0c-367">Типы DBTYPE_NULL и DBTYPE_EMPTY могут быть привязаны только для входных параметров. Они не могут быть привязаны для выходных параметров или результатов.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-367">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters, but not for output parameters or results.</span></span> <span data-ttu-id="2ea0c-368">Если они привязаны для входных параметров, состояние должно быть установлено в значение DBSTATUS_S_ISNULL для типа DBTYPE_NULL или DBSTATUS_S_DEFAULT для типа DBTYPE_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-368">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL for DBTYPE_NULL or DBSTATUS_S_DEFAULT for DBTYPE_EMPTY.</span></span> <span data-ttu-id="2ea0c-369">DBTYPE_BYREF невозможно использовать с типом DBTYPE_NULL или DBTYPE_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-369">DBTYPE_BYREF cannot be used with DBTYPE_NULL or DBTYPE_EMPTY.</span></span>  
  
 <span data-ttu-id="2ea0c-370">Тип DBTYPE_UDT может также быть преобразован в тип DBTYPE_EMPTY или DBTYPE_NULL.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-370">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL.</span></span> <span data-ttu-id="2ea0c-371">Однако типы DBTYPE_NULL и DBTYPE_EMPTY невозможно преобразовать в тип DBTYPE_UDT.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-371">However, DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="2ea0c-372">Это правило обеспечивает согласование с DBTYPE_BYTES.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-372">This is consistent with DBTYPE_BYTES.</span></span> <span data-ttu-id="2ea0c-373">Чтобы обрабатывать пользовательские типы как параметры, используется интерфейс **ISSCommandWithParameters**.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-373">**ISSCommandWithParameters** is used to process UDTs as parameters.</span></span>  
  
 <span data-ttu-id="2ea0c-374">Преобразования данных, выполняемые основными службами OLE DB (**IDataConvert**), неприменимы к типу DBTYPE_UDT.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-374">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span>  
  
 <span data-ttu-id="2ea0c-375">Другие привязки не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-375">No other bindings are supported.</span></span>  
  
## <a name="comparability-for-irowsetfind"></a><span data-ttu-id="2ea0c-376">Сравнимость для IRowsetFind</span><span class="sxs-lookup"><span data-stu-id="2ea0c-376">Comparability for IRowsetFind</span></span>  
 <span data-ttu-id="2ea0c-377">Для определяемых пользователем типов поддерживаются только следующие сравнения:</span><span class="sxs-lookup"><span data-stu-id="2ea0c-377">For UDT types, only the following comparisons are supported:</span></span>  
  
-   <span data-ttu-id="2ea0c-378">EQ</span><span class="sxs-lookup"><span data-stu-id="2ea0c-378">EQ</span></span>  
  
-   <span data-ttu-id="2ea0c-379">NE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-379">NE</span></span>  
  
-   <span data-ttu-id="2ea0c-380">IGNORE</span><span class="sxs-lookup"><span data-stu-id="2ea0c-380">IGNORE</span></span>  
  
 <span data-ttu-id="2ea0c-381">При попытке любого другого сравнения возвращается ошибка DB_E_BADCOMPAREOP.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-381">If any other comparison is attempted DB_E_BADCOMPAREOP is returned.</span></span>  
  
## <a name="bcp-support-for-udts"></a><span data-ttu-id="2ea0c-382">Поддержка программы bcp для определяемых пользователем типов</span><span class="sxs-lookup"><span data-stu-id="2ea0c-382">BCP Support for UDTs</span></span>  
 <span data-ttu-id="2ea0c-383">Значения определяемых пользователем типов можно импортировать и экспортировать только в виде символьных и двоичных значений.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-383">UDT values can be imported and exported only as character or binary values.</span></span>  
  
## <a name="down-level-client-behavior-for-udts"></a><span data-ttu-id="2ea0c-384">Поведение клиентов низкого уровня с определяемыми пользователем типами</span><span class="sxs-lookup"><span data-stu-id="2ea0c-384">Down-level Client Behavior for UDTs</span></span>  
 <span data-ttu-id="2ea0c-385">Определяемые пользователем типы проходят сопоставление типов с клиентами низкого уровня, как показано далее.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-385">UDTs are subject to type mapping with down-level clients, as follows:</span></span>  
  
|<span data-ttu-id="2ea0c-386">Версия клиента</span><span class="sxs-lookup"><span data-stu-id="2ea0c-386">Client version</span></span>|<span data-ttu-id="2ea0c-387">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-387">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-388">(длина не более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-388">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="2ea0c-389">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="2ea0c-389">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="2ea0c-390">(длина более 8 000 байт)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-390">(length greater than 8,000 bytes)</span></span>|  
|--------------------|------------------------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="2ea0c-391">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="2ea0c-391">SQL Server 2005</span></span>|<span data-ttu-id="2ea0c-392">(UDT)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-392">UDT</span></span>|<span data-ttu-id="2ea0c-393">varbinary(max)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-393">varbinary(max)</span></span>|  
|<span data-ttu-id="2ea0c-394">SQL Server 2008 и более поздние версии</span><span class="sxs-lookup"><span data-stu-id="2ea0c-394">SQL Server 2008 and later</span></span>|<span data-ttu-id="2ea0c-395">(UDT)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-395">UDT</span></span>|<span data-ttu-id="2ea0c-396">(UDT)</span><span class="sxs-lookup"><span data-stu-id="2ea0c-396">UDT</span></span>|  
  
 <span data-ttu-id="2ea0c-397">Если `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) имеет значение «80», то большие определяемые пользователем типы представляются всем клиентам так же, как клиентам низкого уровня.</span><span class="sxs-lookup"><span data-stu-id="2ea0c-397">When `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) is set to "80", large UDT types appear to clients in the same way that they appear for down-level clients.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2ea0c-398">См. также:</span><span class="sxs-lookup"><span data-stu-id="2ea0c-398">See Also</span></span>  
 [<span data-ttu-id="2ea0c-399">Большие определяемые пользователем типы данных CLR</span><span class="sxs-lookup"><span data-stu-id="2ea0c-399">Large CLR User-Defined Types</span></span>](../features/large-clr-user-defined-types.md)  
  
  
