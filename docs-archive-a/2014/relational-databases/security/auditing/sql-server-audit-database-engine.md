---
title: Подсистема аудита SQL Server (ядро СУБД) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
f1_keywords:
- audit
helpviewer_keywords:
- SQL Server Audit
- audits [SQL Server], SQL Server Audit
ms.assetid: 0c1fca2e-f22b-4fe8-806f-c87806664f00
author: VanMSFT
ms.author: vanto
ms.openlocfilehash: 2f4f291e5dc4aaa8a240757713cc65bd2a6a8230
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656286"
---
# <a name="sql-server-audit-database-engine"></a><span data-ttu-id="05309-102">Подсистема аудита SQL Server (Database Engine)</span><span class="sxs-lookup"><span data-stu-id="05309-102">SQL Server Audit (Database Engine)</span></span>
  <span data-ttu-id="05309-103">*Аудит* экземпляра среды [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] или отдельной базы данных включает в себя отслеживание и протоколирование событий, происходящих в компоненте [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="05309-103">*Auditing* an instance of the [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] or an individual database involves tracking and logging events that occur on the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> <span data-ttu-id="05309-104">Аудит среды[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] позволяет проводить аудит сервера, который может включать в себя спецификации аудита сервера для событий на уровне сервера, а также спецификации аудита базы данных для событий на уровне базы данных.</span><span class="sxs-lookup"><span data-stu-id="05309-104">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit lets you create server audits, which can contain server audit specifications for server level events, and database audit specifications for database level events.</span></span> <span data-ttu-id="05309-105">События аудита могут записываться в журналы событий или файлы аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-105">Audited events can be written to the event logs or to audit files.</span></span>  
  
 <span data-ttu-id="05309-106">В [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]доступно несколько уровней аудита, применение которых зависит от существующих требований или стандартов установки.</span><span class="sxs-lookup"><span data-stu-id="05309-106">There are several levels of auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], depending on government or standards requirements for your installation.</span></span> <span data-ttu-id="05309-107">Подсистема аудита[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] предоставляет средства и процессы, необходимые для включения, хранения и просмотра аудитов на различных объектах серверов и баз данных.</span><span class="sxs-lookup"><span data-stu-id="05309-107">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit provides the tools and processes you must have to enable, store, and view audits on various server and database objects.</span></span>  
  
 <span data-ttu-id="05309-108">Группы действий аудита сервера можно записывать для всего экземпляра, а также группы действий аудита базы данных либо действия аудита базы данных для каждой базы данных.</span><span class="sxs-lookup"><span data-stu-id="05309-108">You can record server audit action groups per-instance, and either database audit action groups or database audit actions per database.</span></span> <span data-ttu-id="05309-109">Событие аудита будет происходить каждый раз при обнаружении действия, подлежащего аудиту.</span><span class="sxs-lookup"><span data-stu-id="05309-109">The audit event will occur every time that the auditable action is encountered.</span></span>  
  
 <span data-ttu-id="05309-110">Аудит на уровне сервера поддерживается во всех выпусках [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-110">All editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] support server level audits.</span></span> <span data-ttu-id="05309-111">Аудит на уровне базы банных доступен только в выпусках Enterprise Edition, Developer Edition и Evaluation Edition.</span><span class="sxs-lookup"><span data-stu-id="05309-111">Database level auditing is limited to Enterprise, Developer, and Evaluation editions.</span></span> <span data-ttu-id="05309-112">Дополнительные сведения см. [в разделе функции, поддерживаемые различными Выпусками SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="05309-112">For more information, see [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="sql-server-audit-components"></a><span data-ttu-id="05309-113">Компоненты подсистемы аудита SQL Server</span><span class="sxs-lookup"><span data-stu-id="05309-113">SQL Server Audit Components</span></span>  
 <span data-ttu-id="05309-114">*Аудит* — это сочетание в едином пакете нескольких элементов для определенной группы действий сервера или базы данных.</span><span class="sxs-lookup"><span data-stu-id="05309-114">An *audit* is the combination of several elements into a single package for a specific group of server actions or database actions.</span></span> <span data-ttu-id="05309-115">Компоненты подсистемы аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] совместно формируют выходные данные, называемые аудитом, аналогично тому, как определение отчета в сочетании с элементами графики и данных формирует отчет.</span><span class="sxs-lookup"><span data-stu-id="05309-115">The components of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit combine to produce an output that is called an audit, just as a report definition combined with graphics and data elements produces a report.</span></span>  
  
 <span data-ttu-id="05309-116">Подсистема аудита[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] использует *расширенные события* для создания аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-116">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit uses *Extended Events* to help create an audit.</span></span> <span data-ttu-id="05309-117">Дополнительные сведения о расширенных событиях см. в разделе [Расширенные события](../../extended-events/extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="05309-117">For more information about Extended Events, see [Extended Events](../../extended-events/extended-events.md).</span></span>  
  
### <a name="sql-server-audit"></a><span data-ttu-id="05309-118">подсистема аудита SQL Server</span><span class="sxs-lookup"><span data-stu-id="05309-118">SQL Server Audit</span></span>  
 <span data-ttu-id="05309-119">Объект *Подсистема аудита SQL Server* объединяет отдельные экземпляры действий или групп действий уровня сервера или базы данных, за которыми нужно проводить наблюдение.</span><span class="sxs-lookup"><span data-stu-id="05309-119">The *SQL Server Audit* object collects a single instance of server or database-level actions and groups of actions to monitor.</span></span> <span data-ttu-id="05309-120">Аудит работает на уровне экземпляра [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-120">The audit is at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance level.</span></span> <span data-ttu-id="05309-121">На одном экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] может существовать несколько аудитов.</span><span class="sxs-lookup"><span data-stu-id="05309-121">You can have multiple audits per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="05309-122">При определении аудита задается место для вывода результатов.</span><span class="sxs-lookup"><span data-stu-id="05309-122">When you define an audit, you specify the location for the output of the results.</span></span> <span data-ttu-id="05309-123">Оно называется назначением аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-123">This is the audit destination.</span></span> <span data-ttu-id="05309-124">Аудит создается в *отключенном* состоянии и не выполняет автоматический аудит никаких действий.</span><span class="sxs-lookup"><span data-stu-id="05309-124">The audit is created in a *disabled* state, and does not automatically audit any actions.</span></span> <span data-ttu-id="05309-125">После включения аудита назначение аудита начинает получать от него данные.</span><span class="sxs-lookup"><span data-stu-id="05309-125">After the audit is enabled, the audit destination receives data from the audit.</span></span>  
  
### <a name="server-audit-specification"></a><span data-ttu-id="05309-126">Спецификация аудита сервера</span><span class="sxs-lookup"><span data-stu-id="05309-126">Server Audit Specification</span></span>  
 <span data-ttu-id="05309-127">Объект *Спецификация аудита сервера* принадлежит аудиту.</span><span class="sxs-lookup"><span data-stu-id="05309-127">The *Server Audit Specification* object belongs to an audit.</span></span> <span data-ttu-id="05309-128">Для каждого аудита вы можете создать один объект спецификации аудита сервера, поскольку они оба создаются в области экземпляра [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-128">You can create one server audit specification per audit, because both are created at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance scope.</span></span>  
  
 <span data-ttu-id="05309-129">Спецификация аудита сервера собирает множество групп действий уровня сервера, вызываемых компонентом расширенных событий.</span><span class="sxs-lookup"><span data-stu-id="05309-129">The server audit specification collects many server-level action groups raised by the Extended Events feature.</span></span> <span data-ttu-id="05309-130">В спецификацию аудита сервера можно включить *группы действий аудита* .</span><span class="sxs-lookup"><span data-stu-id="05309-130">You can include *audit action groups* in a server audit specification.</span></span> <span data-ttu-id="05309-131">Группы действий аудита — это стандартные группы действий, являющиеся атомарными событиями, происходящими в компоненте [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="05309-131">Audit action groups are predefined groups of actions, which are atomic events occurring in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> <span data-ttu-id="05309-132">Эти действия передаются аудиту, который регистрирует их в целевом объекте.</span><span class="sxs-lookup"><span data-stu-id="05309-132">These actions are sent to the audit, which records them in the target.</span></span>  
  
 <span data-ttu-id="05309-133">Группы действий аудита уровня базы данных описываются в разделе [Действия и группы действий подсистемы аудита SQL Server](sql-server-audit-action-groups-and-actions.md).</span><span class="sxs-lookup"><span data-stu-id="05309-133">Server-level audit action groups are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="database-audit-specification"></a><span data-ttu-id="05309-134">Спецификация аудита базы данных</span><span class="sxs-lookup"><span data-stu-id="05309-134">Database Audit Specification</span></span>  
 <span data-ttu-id="05309-135">Объект *Спецификация аудита базы данных* также принадлежит подсистеме аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-135">The *Database Audit Specification* object also belongs to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit.</span></span> <span data-ttu-id="05309-136">Для каждого аудита каждой базы данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] можно создать одну спецификацию аудита базы данных.</span><span class="sxs-lookup"><span data-stu-id="05309-136">You can create one database audit specification per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database per audit.</span></span>  
  
 <span data-ttu-id="05309-137">Спецификация аудита базы данных включает действия аудита уровня базы данных, вызываемые компонентом расширенных событий.</span><span class="sxs-lookup"><span data-stu-id="05309-137">The database audit specification collects database-level audit actions raised by the Extended Events feature.</span></span> <span data-ttu-id="05309-138">В спецификацию аудита базы данных можно добавлять либо группы действий аудита, либо события аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-138">You can add either audit action groups or audit events to a database audit specification.</span></span> <span data-ttu-id="05309-139">*События аудита* — это атомарные события, аудит которых может производиться ядром [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-139">*Audit events* are the atomic actions that can be audited by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine.</span></span> <span data-ttu-id="05309-140">*Группы действий аудита* — это стандартные группы действий.</span><span class="sxs-lookup"><span data-stu-id="05309-140">*Audit action groups* are predefined groups of actions.</span></span> <span data-ttu-id="05309-141">Они расположены в области базы данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-141">Both are at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database scope.</span></span> <span data-ttu-id="05309-142">Эти действия передаются аудиту, который регистрирует их в целевом объекте.</span><span class="sxs-lookup"><span data-stu-id="05309-142">These actions are sent to the audit, which records them in the target.</span></span> <span data-ttu-id="05309-143">Не включайте объекты области сервера, такие как системные представления, в пользовательскую спецификацию аудита базы данных.</span><span class="sxs-lookup"><span data-stu-id="05309-143">Do not include server-scoped objects, such as the system views, in a user database audit specification.</span></span>  
  
 <span data-ttu-id="05309-144">Группы действий подсистемы аудита уровня базы данных и действия подсистемы аудита описываются в разделе [Действия и группы действий подсистемы аудита SQL Server](sql-server-audit-action-groups-and-actions.md).</span><span class="sxs-lookup"><span data-stu-id="05309-144">Database-level audit action groups and audit actions are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="target"></a><span data-ttu-id="05309-145">Назначение</span><span class="sxs-lookup"><span data-stu-id="05309-145">Target</span></span>  
 <span data-ttu-id="05309-146">Результаты аудита отправляются цели, которая может быть файлом, журналом событий безопасности Windows или журналом событий приложений Windows.</span><span class="sxs-lookup"><span data-stu-id="05309-146">The results of an audit are sent to a target, which can be a file, the Windows Security event log, or the Windows Application event log.</span></span> <span data-ttu-id="05309-147">Журналы необходимо периодически просматривать и архивировать, чтобы у цели оставалось достаточно места для создания дополнительных записей.</span><span class="sxs-lookup"><span data-stu-id="05309-147">Logs must be reviewed and archived periodically to make sure that the target has sufficient space to write additional records.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="05309-148">Любой прошедший проверку пользователь может осуществлять чтение и запись в журнале событий приложений.</span><span class="sxs-lookup"><span data-stu-id="05309-148">Any authenticated user can read and write to the Windows Application event log.</span></span> <span data-ttu-id="05309-149">Для работы с журналом событий приложений необходимо меньше разрешений, чем для работы с журналом событий безопасности Windows; журнал событий приложений менее защищен, чем журнал событий безопасности Windows.</span><span class="sxs-lookup"><span data-stu-id="05309-149">The Application event log requires lower permissions than the Windows Security event log and is less secure than the Windows Security event log.</span></span>  
  
 <span data-ttu-id="05309-150">Для записи в журнал событий безопасности Windows необходимо добавить в политику [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Создание аудитов безопасности **учетную запись службы** .</span><span class="sxs-lookup"><span data-stu-id="05309-150">Writing to the Windows Security log requires the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account to be added to the **Generate security audits** policy.</span></span> <span data-ttu-id="05309-151">По умолчанию в эту политику входят учетные записи «Локальная система», «Локальная служба» и «Сетевая служба».</span><span class="sxs-lookup"><span data-stu-id="05309-151">By default, the Local System, Local Service, and Network Service are part of this policy.</span></span> <span data-ttu-id="05309-152">Этот параметр можно настроить с помощью оснастки политики безопасности (secpol.msc).</span><span class="sxs-lookup"><span data-stu-id="05309-152">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="05309-153">Кроме того, политика безопасности **Аудит доступа к объектам** должна быть включена для регистрации как **успешных** , так и **неуспешных**действий.</span><span class="sxs-lookup"><span data-stu-id="05309-153">Additionally, the **Audit object access** security policy must be enabled for both **Success** and **Failure**.</span></span> <span data-ttu-id="05309-154">Этот параметр можно настроить с помощью оснастки политики безопасности (secpol.msc).</span><span class="sxs-lookup"><span data-stu-id="05309-154">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="05309-155">В [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] или Windows Server 2008 можно задать более детализированную политику, **созданную приложением** , из командной строки с помощью программы политики аудита ( `AuditPol.exe)` .</span><span class="sxs-lookup"><span data-stu-id="05309-155">In [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] or Windows Server 2008, you can set the more granular **application generated** policy from the command line by using the audit policy program (`AuditPol.exe)`.</span></span> <span data-ttu-id="05309-156">Дополнительные сведения по включению функции записи в журнал безопасности Windows см. в разделе [Запись событий подсистемы аудита SQL Server в журнал безопасности](write-sql-server-audit-events-to-the-security-log.md).</span><span class="sxs-lookup"><span data-stu-id="05309-156">For more information about the steps to enable writing to the Windows Security log, see [Write SQL Server Audit Events to the Security Log](write-sql-server-audit-events-to-the-security-log.md).</span></span> <span data-ttu-id="05309-157">Дополнительные сведения о программе Auditpol.exe см. в статье базы знаний 921469 [Использование групповой политики для детальной настройки аудита безопасности](https://support.microsoft.com/kb/921469/).</span><span class="sxs-lookup"><span data-stu-id="05309-157">For more information about the Auditpol.exe program, see Knowledge Base article 921469, [How to use Group Policy to configure detailed security auditing](https://support.microsoft.com/kb/921469/).</span></span> <span data-ttu-id="05309-158">Журналы событий Windows являются глобальными для операционной системы Windows.</span><span class="sxs-lookup"><span data-stu-id="05309-158">The Windows event logs are global to the Windows operating system.</span></span> <span data-ttu-id="05309-159">Дополнительные сведения о журналах событий Windows см. в разделе [Общие сведения о средстве просмотра событий](https://go.microsoft.com/fwlink/?LinkId=101455).</span><span class="sxs-lookup"><span data-stu-id="05309-159">For more information about the Windows event logs, see [Event Viewer Overview](https://go.microsoft.com/fwlink/?LinkId=101455).</span></span> <span data-ttu-id="05309-160">Если для аудита необходимы более точные разрешения, используйте назначение «двоичный файл».</span><span class="sxs-lookup"><span data-stu-id="05309-160">If you need more precise permissions on the audit, use the binary file target.</span></span>  
  
 <span data-ttu-id="05309-161">Если данные аудита сохраняются в файл, то для предотвращения подмены можно ограничить доступ к файлу следующим образом.</span><span class="sxs-lookup"><span data-stu-id="05309-161">When you are saving audit information to a file, to help prevent tampering, you can restrict access to the file location in the following ways:</span></span>  
  
-   <span data-ttu-id="05309-162">Учетная запись службы [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] должна обладать разрешением на чтение и запись.</span><span class="sxs-lookup"><span data-stu-id="05309-162">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service Account must have both Read and Write permission.</span></span>  
  
-   <span data-ttu-id="05309-163">Администраторам аудита обычно требуется разрешение на чтение и запись.</span><span class="sxs-lookup"><span data-stu-id="05309-163">Audit Administrators typically require Read and Write permission.</span></span> <span data-ttu-id="05309-164">Здесь подразумевается, что администраторы аудита — это учетные записи Windows, предназначенные для администрирования файлов аудита, в том числе копирования их в другие общие папки, резервного копирования и других операций.</span><span class="sxs-lookup"><span data-stu-id="05309-164">This assumes that the Audit Administrators are Windows accounts for administration of audit files, such as: copying them to different shares, backing them up, and so on.</span></span>  
  
-   <span data-ttu-id="05309-165">Агенты чтения аудита должны иметь разрешение только для чтения файлов аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-165">Audit Readers that are authorized to read audit files must have Read permission.</span></span>  
  
 <span data-ttu-id="05309-166">Даже если запись в файл выполняется компонентом [!INCLUDE[ssDE](../../../includes/ssde-md.md)] , другие пользователи Windows могут прочитать файл аудита, если имеют нужное разрешение.</span><span class="sxs-lookup"><span data-stu-id="05309-166">Even when the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] is writing to a file, other Windows users can read the audit file if they have permission.</span></span> <span data-ttu-id="05309-167">Компонент [!INCLUDE[ssDE](../../../includes/ssde-md.md)] не получает монопольную блокировку, запрещающую операции чтения.</span><span class="sxs-lookup"><span data-stu-id="05309-167">The [!INCLUDE[ssDE](../../../includes/ssde-md.md)] does not take an exclusive lock that prevents read operations.</span></span>  
  
 <span data-ttu-id="05309-168">Поскольку компонент [!INCLUDE[ssDE](../../../includes/ssde-md.md)] может получать доступ к файлу, то имена входа [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , имеющие разрешение CONTROL SERVER, могут использовать компонент [!INCLUDE[ssDE](../../../includes/ssde-md.md)] для доступа к файлам аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-168">Because the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] can access the file, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logins that have CONTROL SERVER permission can use the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] to access the audit files.</span></span> <span data-ttu-id="05309-169">Чтобы зарегистрировать пользователей, читающих файлы аудита, определите аудит в функции master.sys.fn_get_audit_file.</span><span class="sxs-lookup"><span data-stu-id="05309-169">To record any user that is reading the audit file, define an audit on master.sys.fn_get_audit_file.</span></span> <span data-ttu-id="05309-170">В результате будут записаны имена входа с разрешением CONTROL SERVER, которые получали доступ к файлу аудита через [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="05309-170">This records the logins with CONTROL SERVER permission that have accessed the audit file through [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="05309-171">Если администратор аудита скопирует файл в другое место (в целях архивирования или по другой причине), то список управления доступом к новому месту следует сократить до следующего набора разрешений:</span><span class="sxs-lookup"><span data-stu-id="05309-171">If an Audit Administrator copies the file to a different location (for archive purposes, and so on), the ACLs on the new location should be reduced to the following permissions:</span></span>  
  
-   <span data-ttu-id="05309-172">администратор аудита — чтение и запись;</span><span class="sxs-lookup"><span data-stu-id="05309-172">Audit Administrator - Read / Write</span></span>  
  
-   <span data-ttu-id="05309-173">агент чтения аудита — только чтение.</span><span class="sxs-lookup"><span data-stu-id="05309-173">Audit Reader - Read</span></span>  
  
 <span data-ttu-id="05309-174">Рекомендуется создавать отчеты аудита в отдельном экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], например в экземпляре [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)], к которому будут иметь доступ только администраторы аудита и агенты чтения аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-174">We recommend that you generate audit reports from a separate instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such as an instance of [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)], to which only Audit Administrators or Audit Readers have access.</span></span> <span data-ttu-id="05309-175">Использование отдельного экземпляра компонента [!INCLUDE[ssDE](../../../includes/ssde-md.md)] для составления отчетов помогает предотвратить несанкционированный доступ пользователей к записям аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-175">By using a separate instance of the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] for reporting, you can help prevent unauthorized users from obtaining access to the audit record.</span></span>  
  
 <span data-ttu-id="05309-176">Можно обеспечить дополнительную защиту от несанкционированного доступа путем шифрования папки, в которой хранится файл аудита, с применением шифрования диска Windows BitLocker или шифрованной файловой системы Windows (EFS).</span><span class="sxs-lookup"><span data-stu-id="05309-176">You can offer additional protection against unauthorized access by encrypting the folder in which the audit file is stored by using Windows BitLocker Drive Encryption or Windows Encrypting File System.</span></span>  
  
 <span data-ttu-id="05309-177">Дополнительные сведения о записях аудита, записываемых в целевое назначение, см. в разделе [Записи подсистемы аудита SQL Server](sql-server-audit-records.md).</span><span class="sxs-lookup"><span data-stu-id="05309-177">For more information about the audit records that are written to the target, see [SQL Server Audit Records](sql-server-audit-records.md).</span></span>  
  
## <a name="overview-of-using-sql-server-audit"></a><span data-ttu-id="05309-178">Общие сведения об использовании подсистемы аудита SQL Server</span><span class="sxs-lookup"><span data-stu-id="05309-178">Overview of Using SQL Server Audit</span></span>  
 <span data-ttu-id="05309-179">Для определения аудита можно использовать среду [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-179">You can use [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)] to define an audit.</span></span> <span data-ttu-id="05309-180">После создания и включения аудита он начнет вести записи в целевое назначение.</span><span class="sxs-lookup"><span data-stu-id="05309-180">After the audit is created and enabled, the target will receive entries.</span></span>  
  
 <span data-ttu-id="05309-181">Просматривать журналы событий Windows можно с помощью программы **Средство просмотра событий** в Windows.</span><span class="sxs-lookup"><span data-stu-id="05309-181">You can read the Windows event logs by using the **Event Viewer** utility in Windows.</span></span> <span data-ttu-id="05309-182">Для чтения целевых файлов можно использовать **Средство просмотра журнала** в [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] или функцию [fn_read_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="05309-182">For file targets, you can use either the **Log File Viewer** in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or the [fn_get_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) function to read the target file.</span></span>  
  
 <span data-ttu-id="05309-183">Обычно процесс создания и использования аудита происходит следующим образом.</span><span class="sxs-lookup"><span data-stu-id="05309-183">The general process for creating and using an audit is as follows.</span></span>  
  
1.  <span data-ttu-id="05309-184">Создайте аудит и определите цель.</span><span class="sxs-lookup"><span data-stu-id="05309-184">Create an audit and define the target.</span></span>  
  
2.  <span data-ttu-id="05309-185">Создается либо спецификация аудита сервера, либо спецификация аудита базы данных, которая сопоставляет аудит.</span><span class="sxs-lookup"><span data-stu-id="05309-185">Create either a server audit specification or database audit specification that maps to the audit.</span></span> <span data-ttu-id="05309-186">Включается спецификация аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-186">Enable the audit specification.</span></span>  
  
3.  <span data-ttu-id="05309-187">Включите аудит.</span><span class="sxs-lookup"><span data-stu-id="05309-187">Enable the audit.</span></span>  
  
4.  <span data-ttu-id="05309-188">Производится считывание событий аудита с помощью **Просмотр событий**Windows, **Средства просмотра журнала**или функции fn_get_audit_file.</span><span class="sxs-lookup"><span data-stu-id="05309-188">Read the audit events by using the Windows **Event Viewer**, **Log File Viewe**r, or the fn_get_audit_file function.</span></span>  
  
 <span data-ttu-id="05309-189">Дополнительные сведения об аудите см. в разделах [Создание аудита сервера и спецификации аудита сервера](create-a-server-audit-and-server-audit-specification.md) и [Создание спецификации аудита для сервера и базы данных](create-a-server-audit-and-database-audit-specification.md).</span><span class="sxs-lookup"><span data-stu-id="05309-189">For more information, see [Create a Server Audit and Server Audit Specification](create-a-server-audit-and-server-audit-specification.md) and [Create a Server Audit and Database Audit Specification](create-a-server-audit-and-database-audit-specification.md).</span></span>  
  
## <a name="considerations"></a><span data-ttu-id="05309-190">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="05309-190">Considerations</span></span>  
 <span data-ttu-id="05309-191">В случае ошибки при инициализации аудита сервер не будет запущен.</span><span class="sxs-lookup"><span data-stu-id="05309-191">In the case of a failure during audit initiation, the server will not start.</span></span> <span data-ttu-id="05309-192">В этом случае его можно запустить, если в командную строку включить параметр **-f**.</span><span class="sxs-lookup"><span data-stu-id="05309-192">In this case, the server can be started by using the **-f** option at the command line.</span></span>  
  
 <span data-ttu-id="05309-193">Если ошибка аудита вызывает отключение сервера или не дает ему запуститься, поскольку для аудита был задан режим ON_FAILURE=SHUTDOWN, то в журнал будет записано событие MSG_AUDIT_FORCED_SHUTDOWN.</span><span class="sxs-lookup"><span data-stu-id="05309-193">When an audit failure causes the server to shut down or not to start because ON_FAILURE=SHUTDOWN is specified for the audit, the MSG_AUDIT_FORCED_SHUTDOWN event will be written to the log.</span></span> <span data-ttu-id="05309-194">Поскольку выключение происходит при первом возникновении этого события, это событие будет записано один раз.</span><span class="sxs-lookup"><span data-stu-id="05309-194">Because the shutdown will occur on the first encounter of this setting, the event will be written one time.</span></span> <span data-ttu-id="05309-195">Это событие записывается после получения сообщения об ошибке, означающего, что аудит вызвал отключение.</span><span class="sxs-lookup"><span data-stu-id="05309-195">This event is written after the failure message for the audit causing the shutdown.</span></span> <span data-ttu-id="05309-196">Администратор может обойти завершения работы, вызываемые аудитом, запустив [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в однопользовательском режиме с использованием флага **-m**.</span><span class="sxs-lookup"><span data-stu-id="05309-196">An administrator can bypass audit-induced shutdowns by starting [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in Single User mode using the **-m** flag.</span></span> <span data-ttu-id="05309-197">При запуске в однопользовательском режиме будет произведено изменение настроек любого аудита, запускающегося в этом сеансе, для которого было задано условие ON_FAILURE=SHUTDOWN. Такие аудиты будут запускаться с условием ON_FAILURE=CONTINUE.</span><span class="sxs-lookup"><span data-stu-id="05309-197">If you start in Single User mode, you will downgrade any audit where ON_FAILURE=SHUTDOWN is specified to run in that session as ON_FAILURE=CONTINUE.</span></span> <span data-ttu-id="05309-198">Если [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] запускается с использованием флага **-m**, то в журнал ошибок будет записано сообщение MSG_AUDIT_SHUTDOWN_BYPASSED.</span><span class="sxs-lookup"><span data-stu-id="05309-198">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is started by using the **-m** flag, the MSG_AUDIT_SHUTDOWN_BYPASSED message will be written to the error log.</span></span>  
  
 <span data-ttu-id="05309-199">Дополнительные сведения о параметрах запуска службы см. в разделе [Параметры запуска службы Database Engine](../../../database-engine/configure-windows/database-engine-service-startup-options.md).</span><span class="sxs-lookup"><span data-stu-id="05309-199">For more information about service startup options, see [Database Engine Service Startup Options](../../../database-engine/configure-windows/database-engine-service-startup-options.md).</span></span>  
  
### <a name="attaching-a-database-with-an-audit-defined"></a><span data-ttu-id="05309-200">Присоединение базы данных с определенным аудитом</span><span class="sxs-lookup"><span data-stu-id="05309-200">Attaching a Database with an Audit Defined</span></span>  
 <span data-ttu-id="05309-201">При присоединении базы данных, имеющей спецификацию аудита с идентификатором GUID, который не существует на сервере, такая спецификация аудита получит состояние *потерянная* .</span><span class="sxs-lookup"><span data-stu-id="05309-201">Attaching a database that has an audit specification and specifies a GUID that does not exist on the server will cause an *orphaned* audit specification.</span></span> <span data-ttu-id="05309-202">Поскольку в экземпляре сервера не существует аудита с совпадающим идентификатором GUID, события аудита записываться не будут.</span><span class="sxs-lookup"><span data-stu-id="05309-202">Because an audit with a matching GUID does not exist on the server instance, no audit events will be recorded.</span></span> <span data-ttu-id="05309-203">Исправить эту ситуацию можно, используя команду ALTER DATABASE AUDIT SPECIFICATION для присоединения потерянной спецификации аудита к существующему аудиту сервера.</span><span class="sxs-lookup"><span data-stu-id="05309-203">To correct this situation, use the ALTER DATABASE AUDIT SPECIFICATION command to connect the orphaned audit specification to an existing server audit.</span></span> <span data-ttu-id="05309-204">Также можно использовать команду CREATE SERVER AUDIT для создания на сервере нового аудита с указанным идентификатором GUID.</span><span class="sxs-lookup"><span data-stu-id="05309-204">Or, use the CREATE SERVER AUDIT command to create a new server audit with the specified GUID.</span></span>  
  
 <span data-ttu-id="05309-205">Базу данных, для которой была задана спецификация аудита, можно присоединить к другому выпуску [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , не поддерживающему подсистему аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , например [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] , но запись событий аудита производиться не будет.</span><span class="sxs-lookup"><span data-stu-id="05309-205">You can attach a database that has an audit specification defined on it to another edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that does not support [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit, such as [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] but it will not record audit events.</span></span>  
  
### <a name="database-mirroring-and-sql-server-audit"></a><span data-ttu-id="05309-206">Зеркальное отображение баз данных и подсистема аудита SQL Server</span><span class="sxs-lookup"><span data-stu-id="05309-206">Database Mirroring and SQL Server Audit</span></span>  
 <span data-ttu-id="05309-207">Если для базы данных определена спецификация аудита базы данных и используется зеркальное отображение базы данных, то в нее будет включена спецификация аудита базы данных.</span><span class="sxs-lookup"><span data-stu-id="05309-207">A database that has a database audit specification defined and that uses database mirroring will include the database audit specification.</span></span> <span data-ttu-id="05309-208">Для правильной работы на зеркальном экземпляре SQL необходимо выполнить настройку следующих элементов.</span><span class="sxs-lookup"><span data-stu-id="05309-208">To work correctly on the mirrored SQL instance, the following items must be configured:</span></span>  
  
-   <span data-ttu-id="05309-209">Чтобы спецификация аудита базы данных могла создавать записи аудита, на зеркальном сервере должен присутствовать аудит с тем же идентификатором GUID.</span><span class="sxs-lookup"><span data-stu-id="05309-209">The mirror server must have an audit with the same GUID to enable the database audit specification to write audit records.</span></span> <span data-ttu-id="05309-210">Это можно настроить с помощью команды создать аудит с идентификатором GUID `=` \* \<GUID from source Server Audit*> .</span><span class="sxs-lookup"><span data-stu-id="05309-210">This can be configured by using the command CREATE AUDIT WITH GUID`=`\*\<GUID from source Server Audit*>.</span></span>  
  
-   <span data-ttu-id="05309-211">При использовании в качестве цели двоичного файла учетная запись службы зеркального сервера должна обладать необходимыми разрешениями на место назначения, куда производится запись аудиторского следа.</span><span class="sxs-lookup"><span data-stu-id="05309-211">For binary file targets, the mirror server service account must have appropriate permissions to the location where the audit trail is being written.</span></span>  
  
-   <span data-ttu-id="05309-212">При использовании в качестве целей журналов событий Windows политика безопасности на компьютере, на котором расположен зеркальный сервер, должна разрешать учетной записи службы доступ к журналу событий безопасности или приложений.</span><span class="sxs-lookup"><span data-stu-id="05309-212">For Windows event log targets, the security policy on the computer where the mirror server is located must allow for service account access to the security or application event log.</span></span>  
  
### <a name="auditing-administrators"></a><span data-ttu-id="05309-213">Администраторы аудита</span><span class="sxs-lookup"><span data-stu-id="05309-213">Auditing Administrators</span></span>  
 <span data-ttu-id="05309-214">Члены `sysadmin` предопределенной роли сервера определяются как пользователь **dbo** в каждой базе данных.</span><span class="sxs-lookup"><span data-stu-id="05309-214">Members of the `sysadmin` fixed server role are identified as the **dbo** user in each database.</span></span> <span data-ttu-id="05309-215">Действия аудита администраторов выполняются как действия аудита пользователя **dbo** .</span><span class="sxs-lookup"><span data-stu-id="05309-215">To audit actions of the administrators, audit the actions of the **dbo** user.</span></span>  
  
## <a name="creating-and-managing-audits-with-transact-sql"></a><span data-ttu-id="05309-216">Создание аудита и работа с ним на Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="05309-216">Creating and Managing Audits with Transact-SQL</span></span>  
 <span data-ttu-id="05309-217">Для реализации всех аспектов аудита среды [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] можно использовать инструкции DDL, представления каталогов и динамические административные представления и функции.</span><span class="sxs-lookup"><span data-stu-id="05309-217">You can use DDL statements, dynamic management views and functions, and catalog views to implement all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>  
  
### <a name="data-definition-language-statements"></a><span data-ttu-id="05309-218">Инструкции языка определения данных DDL</span><span class="sxs-lookup"><span data-stu-id="05309-218">Data Definition Language Statements</span></span>  
 <span data-ttu-id="05309-219">Чтобы создать, изменить или удалить спецификацию аудита, можно использовать следующие инструкции DDL.</span><span class="sxs-lookup"><span data-stu-id="05309-219">You can use the following DDL statements to create, alter, and drop audit specifications:</span></span>  
  
|||  
|-|-|  
|[<span data-ttu-id="05309-220">ALTER AUTHORIZATION</span><span class="sxs-lookup"><span data-stu-id="05309-220">ALTER AUTHORIZATION</span></span>](/sql/t-sql/statements/alter-authorization-transact-sql)|[<span data-ttu-id="05309-221">CREATE SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="05309-221">CREATE SERVER AUDIT</span></span>](/sql/t-sql/statements/create-server-audit-transact-sql)|  
|[<span data-ttu-id="05309-222">ALTER DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="05309-222">ALTER DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-database-audit-specification-transact-sql)|[<span data-ttu-id="05309-223">CREATE SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="05309-223">CREATE SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-server-audit-specification-transact-sql)|  
|[<span data-ttu-id="05309-224">ALTER SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="05309-224">ALTER SERVER AUDIT</span></span>](/sql/t-sql/statements/alter-server-audit-specification-transact-sql)|[<span data-ttu-id="05309-225">DROP DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="05309-225">DROP DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-database-encryption-key-transact-sql)|  
|[<span data-ttu-id="05309-226">ALTER SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="05309-226">ALTER SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-server-audit-transact-sql)|[<span data-ttu-id="05309-227">DROP SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="05309-227">DROP SERVER AUDIT</span></span>](/sql/t-sql/statements/drop-server-audit-transact-sql)|  
|[<span data-ttu-id="05309-228">CREATE DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="05309-228">CREATE DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-database-audit-specification-transact-sql)|[<span data-ttu-id="05309-229">DROP SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="05309-229">DROP SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-server-audit-specification-transact-sql)|  
  
### <a name="dynamic-views-and-functions"></a><span data-ttu-id="05309-230">Динамические представления и функции</span><span class="sxs-lookup"><span data-stu-id="05309-230">Dynamic Views and Functions</span></span>  
 <span data-ttu-id="05309-231">В следующей таблице перечисляются динамические представления и функции, которые можно использовать в подсистеме аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-231">The following table lists the dynamic views and function that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Auditing.</span></span>  
  
|<span data-ttu-id="05309-232">Динамические представления и функции</span><span class="sxs-lookup"><span data-stu-id="05309-232">Dynamic views and functions</span></span>|<span data-ttu-id="05309-233">Описание</span><span class="sxs-lookup"><span data-stu-id="05309-233">Description</span></span>|  
|---------------------------------|-----------------|  
|[<span data-ttu-id="05309-234">sys.dm_audit_actions</span><span class="sxs-lookup"><span data-stu-id="05309-234">sys.dm_audit_actions</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-actions-transact-sql)|<span data-ttu-id="05309-235">Возвращает строку для каждого действия аудита, которое может быть зарегистрировано в журнале аудита, и каждой группы действий аудита, которая может быть настроена в составе аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-235">Returns a row for every audit action that can be reported in the audit log and every audit action group that can be configured as part of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>|  
|[<span data-ttu-id="05309-236">sys.dm_server_audit_status</span><span class="sxs-lookup"><span data-stu-id="05309-236">sys.dm_server_audit_status</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-server-audit-status-transact-sql)|<span data-ttu-id="05309-237">Предоставляет сведения о текущем состоянии аудита.</span><span class="sxs-lookup"><span data-stu-id="05309-237">Provides information about the current state of the audit.</span></span>|  
|[<span data-ttu-id="05309-238">sys.dm_audit_class_type_map</span><span class="sxs-lookup"><span data-stu-id="05309-238">sys.dm_audit_class_type_map</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-class-type-map-transact-sql)|<span data-ttu-id="05309-239">Возвращает таблицу, которая сопоставляет поле class_type в журнале аудита с полем class_desc в представлении sys.dm_audit_actions.</span><span class="sxs-lookup"><span data-stu-id="05309-239">Returns a table that maps the class_type field in the audit log to the class_desc field in sys.dm_audit_actions.</span></span>|  
|[<span data-ttu-id="05309-240">fn_get_audit_file</span><span class="sxs-lookup"><span data-stu-id="05309-240">fn_get_audit_file</span></span>](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql)|<span data-ttu-id="05309-241">Возвращает сведения из файла аудита, созданного аудитом сервера.</span><span class="sxs-lookup"><span data-stu-id="05309-241">Returns information from an audit file created by a server audit.</span></span>|  
  
### <a name="catalog-views"></a><span data-ttu-id="05309-242">Представления каталога</span><span class="sxs-lookup"><span data-stu-id="05309-242">Catalog Views</span></span>  
 <span data-ttu-id="05309-243">В следующей таблице перечисляются представления каталога, которые можно использовать в подсистеме аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-243">The following table lists the catalog views that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] auditing.</span></span>  
  
|<span data-ttu-id="05309-244">Представления каталога</span><span class="sxs-lookup"><span data-stu-id="05309-244">Catalog views</span></span>|<span data-ttu-id="05309-245">Описание</span><span class="sxs-lookup"><span data-stu-id="05309-245">Description</span></span>|  
|-------------------|-----------------|  
|[<span data-ttu-id="05309-246">sys.database_ audit_specifications</span><span class="sxs-lookup"><span data-stu-id="05309-246">sys.database_ audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specifications-transact-sql)|<span data-ttu-id="05309-247">Содержит сведения о спецификациях аудита базы данных в аудите [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="05309-247">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="05309-248">sys.database_audit_specification_details</span><span class="sxs-lookup"><span data-stu-id="05309-248">sys.database_audit_specification_details</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specification-details-transact-sql)|<span data-ttu-id="05309-249">Содержит сведения о спецификациях аудита базы данных в аудите [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на экземпляре сервера для всех баз данных.</span><span class="sxs-lookup"><span data-stu-id="05309-249">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance for all databases.</span></span>|  
|[<span data-ttu-id="05309-250">sys.server_audits</span><span class="sxs-lookup"><span data-stu-id="05309-250">sys.server_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audits-transact-sql)|<span data-ttu-id="05309-251">Содержит по одной строке для каждого аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="05309-251">Contains one row for each [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit in a server instance.</span></span>|  
|[<span data-ttu-id="05309-252">sys.server_audit_specifications</span><span class="sxs-lookup"><span data-stu-id="05309-252">sys.server_audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specifications-transact-sql)|<span data-ttu-id="05309-253">Содержит сведения о спецификациях аудита сервера в подсистеме аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="05309-253">Contains information about the server audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="05309-254">sys.server_audit_specifications_details</span><span class="sxs-lookup"><span data-stu-id="05309-254">sys.server_audit_specifications_details</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specification-details-transact-sql)|<span data-ttu-id="05309-255">Содержит сведения об элементах (действиях) спецификации аудита сервера в подсистеме аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="05309-255">Contains information about the server audit specification details (actions) in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="05309-256">sys.server_file_audits</span><span class="sxs-lookup"><span data-stu-id="05309-256">sys.server_file_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-file-audits-transact-sql)|<span data-ttu-id="05309-257">Содержит расширенные сведения о типах аудита файлов в подсистеме аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="05309-257">Contains stores extended information about the file audit type in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
  
## <a name="permissions"></a><span data-ttu-id="05309-258">Разрешения</span><span class="sxs-lookup"><span data-stu-id="05309-258">Permissions</span></span>  
 <span data-ttu-id="05309-259">У каждой функции и команды подсистемы аудита [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] существуют индивидуальные требования к разрешениям.</span><span class="sxs-lookup"><span data-stu-id="05309-259">Each feature and command for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit has individual permission requirements.</span></span>  
  
 <span data-ttu-id="05309-260">Чтобы создать, изменить или удалить аудит сервера или спецификацию аудита сервера, участникам на уровне сервера требуется разрешение ALTER ANY SERVER AUDIT или CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="05309-260">To create, alter, or drop a Server Audit or Server Audit Specification, server principals require the ALTER ANY SERVER AUDIT or the CONTROL SERVER permission.</span></span> <span data-ttu-id="05309-261">Чтобы создать, изменить или удалить спецификацию аудита базы данных, участникам базы данных требуется разрешение ALTER ANY DATABASE AUDIT либо разрешение ALTER или CONTROL на эту базу данных.</span><span class="sxs-lookup"><span data-stu-id="05309-261">To create, alter, or drop a Database Audit Specification, database principals require the ALTER ANY DATABASE AUDIT permission or the ALTER or CONTROL permission on the database.</span></span> <span data-ttu-id="05309-262">Кроме того, участникам необходимо разрешение на подключение к базе данных либо разрешение ALTER ANY SERVER AUDIT или CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="05309-262">In addition, principals must have permission to connect to the database, or ALTER ANY SERVER AUDIT or CONTROL SERVER permissions.</span></span>  
  
 <span data-ttu-id="05309-263">Если не указано обратное, для просмотра представлений каталога у участника должно быть следующее:</span><span class="sxs-lookup"><span data-stu-id="05309-263">Unless otherwise specified, viewing catalog views requires a principal to have one of the following:</span></span>  
  
-   <span data-ttu-id="05309-264">членство в предопределенной роли сервера sysadmin;</span><span class="sxs-lookup"><span data-stu-id="05309-264">Membership in the sysadmin fixed server role.</span></span>  
  
-   <span data-ttu-id="05309-265">разрешение CONTROL SERVER;</span><span class="sxs-lookup"><span data-stu-id="05309-265">The CONTROL SERVER permission.</span></span>  
  
-   <span data-ttu-id="05309-266">разрешение VIEW SERVER STATE;</span><span class="sxs-lookup"><span data-stu-id="05309-266">The VIEW SERVER STATE permission.</span></span>  
  
-   <span data-ttu-id="05309-267">разрешение ALTER ANY AUDIT;</span><span class="sxs-lookup"><span data-stu-id="05309-267">The ALTER ANY AUDIT permission.</span></span>  
  
-   <span data-ttu-id="05309-268">разрешение VIEW AUDIT STATE (предоставляет участнику только доступ к представлению каталога sys.server_audits).</span><span class="sxs-lookup"><span data-stu-id="05309-268">The VIEW AUDIT STATE permission (gives only the principal access to the sys.server_audits catalog view).</span></span>  
  
 <span data-ttu-id="05309-269">Чтобы использовать динамические административные представления, участник должен обладать разрешениями VIEW SERVER STATE или ALTER ANY AUDIT.</span><span class="sxs-lookup"><span data-stu-id="05309-269">A principal must have the VIEW SERVER STATE or ALTER ANY AUDIT permission to use the Dynamic Management Views.</span></span>  
  
 <span data-ttu-id="05309-270">Дополнительные сведения о предоставлении прав и разрешений см. в разделе [GRANT (Transact-SQL)](/sql/t-sql/statements/grant-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="05309-270">For more information about how to grant rights and permissions, see [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="05309-271">Члены роли sysadmin могут изменять любой компонент аудита; члены роли db_owner могут изменять спецификации аудита в базе данных.</span><span class="sxs-lookup"><span data-stu-id="05309-271">Principals in the sysadmin role can tamper with any audit component and those in the db_owner role can tamper with audit specifications in a database.</span></span> <span data-ttu-id="05309-272">Подсистема аудита[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] выполнит проверку наличия у имени входа, пытающегося выполнить создание или изменение спецификации аудита (хотя бы разрешения ALTER ANY DATABASE AUDIT).</span><span class="sxs-lookup"><span data-stu-id="05309-272">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit will validate that a logon that creates or alters an audit specification has at least the ALTER ANY DATABASE AUDIT permission.</span></span> <span data-ttu-id="05309-273">Однако при присоединении базы данных проверка не производится.</span><span class="sxs-lookup"><span data-stu-id="05309-273">However, it does no validation when you attach a database.</span></span> <span data-ttu-id="05309-274">Следует считать, что спецификации аудита базы данных настолько надежны, насколько надежны участники, имеющие роли sysadmin или db_owner.</span><span class="sxs-lookup"><span data-stu-id="05309-274">You should assume all Database Audit Specifications are only as trustworthy as those principals in the sysadmin or db_owner role.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="05309-275">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="05309-275">Related Tasks</span></span>  
 [<span data-ttu-id="05309-276">Создание аудита сервера и спецификации аудита сервера</span><span class="sxs-lookup"><span data-stu-id="05309-276">Create a Server Audit and Server Audit Specification</span></span>](create-a-server-audit-and-server-audit-specification.md)  
  
 [<span data-ttu-id="05309-277">Создание спецификации аудита для сервера и базы данных</span><span class="sxs-lookup"><span data-stu-id="05309-277">Create a Server Audit and Database Audit Specification</span></span>](create-a-server-audit-and-database-audit-specification.md)  
  
 [<span data-ttu-id="05309-278">Просмотр журнала подсистемы аудита SQL Server</span><span class="sxs-lookup"><span data-stu-id="05309-278">View a SQL Server Audit Log</span></span>](view-a-sql-server-audit-log.md)  
  
 [<span data-ttu-id="05309-279">Запись событий подсистемы аудита SQL Server в журнал безопасности</span><span class="sxs-lookup"><span data-stu-id="05309-279">Write SQL Server Audit Events to the Security Log</span></span>](write-sql-server-audit-events-to-the-security-log.md)  
  
## <a name="topics-closely-related-to-auditing"></a><span data-ttu-id="05309-280">Темы, тесно связанные с аудитом</span><span class="sxs-lookup"><span data-stu-id="05309-280">Topics Closely Related to Auditing</span></span>  
 [<span data-ttu-id="05309-281">Свойства сервера (страница "Безопасность")</span><span class="sxs-lookup"><span data-stu-id="05309-281">Server Properties &#40;Security Page&#41;</span></span>](../../../database-engine/configure-windows/server-properties-security-page.md)  
 <span data-ttu-id="05309-282">Описывает, как включить аудит входа в систему для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="05309-282">Explains how to turn on login auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="05309-283">Записи аудита хранятся в журнале приложений Windows.</span><span class="sxs-lookup"><span data-stu-id="05309-283">The audit records are stored in the Windows application log.</span></span>  
  
 [<span data-ttu-id="05309-284">Параметр конфигурации сервера "c2 audit mode"</span><span class="sxs-lookup"><span data-stu-id="05309-284">c2 audit mode Server Configuration Option</span></span>](../../../database-engine/configure-windows/c2-audit-mode-server-configuration-option.md)  
 <span data-ttu-id="05309-285">Описывается режим аудита в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], соответствующий стандарту безопасности С2.</span><span class="sxs-lookup"><span data-stu-id="05309-285">Explains the C2 security compliance auditing mode in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 [<span data-ttu-id="05309-286">Категория событий Security Audit (приложение SQL Server Profiler)</span><span class="sxs-lookup"><span data-stu-id="05309-286">Security Audit Event Category &#40;SQL Server Profiler&#41;</span></span>](../../../relational-databases/event-classes/security-audit-event-category-sql-server-profiler.md)  
 <span data-ttu-id="05309-287">Описываются события аудита, которые можно использовать в приложении [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span><span class="sxs-lookup"><span data-stu-id="05309-287">Explains the audit events you can use in [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="05309-288">Дополнительные сведения см. в разделе [Start SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md).</span><span class="sxs-lookup"><span data-stu-id="05309-288">For more information, see [SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md).</span></span>  
  
 [<span data-ttu-id="05309-289">Трассировка SQL</span><span class="sxs-lookup"><span data-stu-id="05309-289">SQL Trace</span></span>](../../sql-trace/sql-trace.md)  
 <span data-ttu-id="05309-290">Объясняется, как в пользовательских приложениях можно использовать приложение трассировки SQL вместо приложения [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler.</span><span class="sxs-lookup"><span data-stu-id="05309-290">Explains how SQL Trace can be used from within your own applications to create traces manually, instead of using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler.</span></span>  
  
 [<span data-ttu-id="05309-291">Триггеры DDL</span><span class="sxs-lookup"><span data-stu-id="05309-291">DDL Triggers</span></span>](../../triggers/ddl-triggers.md)  
 <span data-ttu-id="05309-292">Объясняется, как можно использовать триггеры языка DDL для отслеживания изменения в базах данных.</span><span class="sxs-lookup"><span data-stu-id="05309-292">Explains how you can use Data Definition Language (DDL) triggers to track changes to your databases.</span></span>  
  
 [<span data-ttu-id="05309-293">Microsoft TechNet: технический центр SQL Server: безопасность и защита SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="05309-293">Microsoft TechNet: SQL Server TechCenter: SQL Server 2005 Security and Protection</span></span>](https://go.microsoft.com/fwlink/?LinkId=101152)  
 <span data-ttu-id="05309-294">Содержит актуальные сведения о безопасности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="05309-294">Provides up-to-date information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="05309-295">См. также:</span><span class="sxs-lookup"><span data-stu-id="05309-295">See Also</span></span>  
 <span data-ttu-id="05309-296">[Действия и группы действий подсистемы аудита SQL Server](sql-server-audit-action-groups-and-actions.md) </span><span class="sxs-lookup"><span data-stu-id="05309-296">[SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md) </span></span>  
 [<span data-ttu-id="05309-297">Записи подсистемы аудита SQL Server</span><span class="sxs-lookup"><span data-stu-id="05309-297">SQL Server Audit Records</span></span>](sql-server-audit-records.md)  
  
  
