---
title: Расширенное управление ключами | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- Key Management
- Extensible Key Management
- EKM, described
ms.assetid: 9bfaf500-2d1e-4c02-b041-b8761a9e695b
author: jaszymas
ms.author: jaszymas
ms.openlocfilehash: 4fc9b002b57f8118494709f8fe27a8b19ce28d8e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87732498"
---
# <a name="extensible-key-management-ekm"></a><span data-ttu-id="f5827-102">Расширенное управление ключами (Extensible Key Management)</span><span class="sxs-lookup"><span data-stu-id="f5827-102">Extensible Key Management (EKM)</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="f5827-103">наряду с *расширенным управлением ключами* (EKM) предусматривает возможность шифрования данных с применением поставщика *Microsoft Cryptographic API* (MSCAPI) для шифрования и создания ключа.</span><span class="sxs-lookup"><span data-stu-id="f5827-103">provides data encryption capabilities together with *Extensible Key Management* (EKM), using the *Microsoft Cryptographic API* (MSCAPI) provider for encryption and key generation.</span></span> <span data-ttu-id="f5827-104">Ключи шифрования для шифрования данных и ключей создаются в контейнерах временных ключей и перед сохранением в базе данных должны быть экспортированы из поставщика.</span><span class="sxs-lookup"><span data-stu-id="f5827-104">Encryption keys for data and key encryption are created in transient key containers, and they must be exported from a provider before they are stored in the database.</span></span> <span data-ttu-id="f5827-105">Благодаря этому подходу управление ключами, содержащее иерархию ключей шифрования и резервирование ключей, может быть обработано [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f5827-105">This approach enables key management that includes an encryption key hierarchy and key backup, to be handled by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="f5827-106">При растущих требованиях к соответствию нормативным документам и соблюдению конфиденциальности данных компании используют шифрование в качестве решения, обеспечивающего «глубинную защиту».</span><span class="sxs-lookup"><span data-stu-id="f5827-106">With the growing demand for regulatory compliance and concern for data privacy, organizations are taking advantage of encryption as a way to provide a "defense in depth" solution.</span></span> <span data-ttu-id="f5827-107">Использование средств по управлению шифрованием, предусмотренных только в базах данных, часто оказывается нецелесообразным.</span><span class="sxs-lookup"><span data-stu-id="f5827-107">This approach is often impractical using only database encryption management tools.</span></span> <span data-ttu-id="f5827-108">Поставщики оборудования поставляют продукты, в которых управление ключами компании осуществляется при помощи *аппаратных модулей безопасности* (HSM).</span><span class="sxs-lookup"><span data-stu-id="f5827-108">Hardware vendors provide products that address enterprise key management by using *Hardware Security Modules* (HSM).</span></span> <span data-ttu-id="f5827-109">В устройствах, оборудованных аппаратными модулями безопасности, ключи шифрования встроены в оборудование или в программные модули.</span><span class="sxs-lookup"><span data-stu-id="f5827-109">HSM devices store encryption keys on hardware or software modules.</span></span> <span data-ttu-id="f5827-110">Это решение является более безопасным, поскольку ключи шифрования хранятся отдельно от зашифрованных данных.</span><span class="sxs-lookup"><span data-stu-id="f5827-110">This is a more secure solution because the encryption keys do not reside with encryption data.</span></span>  
  
 <span data-ttu-id="f5827-111">Некоторые поставщики предлагают аппаратные модули безопасности как для управления ключами, так и для ускорения шифрования.</span><span class="sxs-lookup"><span data-stu-id="f5827-111">A number of vendors offer HSM for both key management and encryption acceleration.</span></span> <span data-ttu-id="f5827-112">В устройствах с аппаратными модулями безопасности в роли посредника между приложением и аппаратным модулем выступают интерфейсы оборудования с серверной обработкой.</span><span class="sxs-lookup"><span data-stu-id="f5827-112">HSM devices use hardware interfaces with a server process as an intermediary between an application and an HSM.</span></span> <span data-ttu-id="f5827-113">В своих модулях производители также реализуют поставщики MSCAPI, представленные в качестве оборудования или программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="f5827-113">Vendors also implement MSCAPI providers over their modules, which might be hardware or software.</span></span> <span data-ttu-id="f5827-114">Часто интерфейсы MSCAPI реализуют только подмножество функций, предлагаемых аппаратными модулями.</span><span class="sxs-lookup"><span data-stu-id="f5827-114">MSCAPI often offers only a subset of the functionality that is offered by an HSM.</span></span> <span data-ttu-id="f5827-115">Поставщики также могут предложить программное обеспечение для управления аппаратными модулями безопасности, настройки ключей и доступа к ключам.</span><span class="sxs-lookup"><span data-stu-id="f5827-115">Vendors can also provide management software for HSM, key configuration, and key access.</span></span>  
  
 <span data-ttu-id="f5827-116">Реализации аппаратных модулей безопасности от разных поставщиков отличаются друг от друга. Чтобы использовать их с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , необходим общий интерфейс.</span><span class="sxs-lookup"><span data-stu-id="f5827-116">HSM implementations vary from vendor to vendor, and to use them with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires a common interface.</span></span> <span data-ttu-id="f5827-117">Несмотря на то, что в MSCAPI такой интерфейс предусмотрен, в нем реализована только часть возможностей аппаратных модулей.</span><span class="sxs-lookup"><span data-stu-id="f5827-117">Although the MSCAPI provides this interface, it supports only a subset of the HSM features.</span></span> <span data-ttu-id="f5827-118">У этого интерфейса есть и другие ограничения, например отсутствие собственных средств для хранения симметричных ключей, отсутствие сеансоориентированной поддержки.</span><span class="sxs-lookup"><span data-stu-id="f5827-118">It also has other limitations, such as the inability to natively persist symmetric keys, and a lack of session-oriented support.</span></span>  
  
 <span data-ttu-id="f5827-119">Расширенное управление ключами [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] позволяет сторонним поставщикам расширенного управления ключами и поставщикам аппаратных модулей безопасности регистрировать свои модули в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f5827-119">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Extensible Key Management enables third-party EKM/HSM vendors to register their modules in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="f5827-120">После регистрации пользователи [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] могут использовать ключи шифрования, хранимые в модулях расширенного управления ключами.</span><span class="sxs-lookup"><span data-stu-id="f5827-120">When registered, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] users can use the encryption keys stored on EKM modules.</span></span> <span data-ttu-id="f5827-121">Таким образом, в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] доступны расширенные возможности шифрования, поддерживаемые этими модулями, такие как массовое шифрование и расшифровка, а также функции управления ключами, например устаревание или смена ключей.</span><span class="sxs-lookup"><span data-stu-id="f5827-121">This enables [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to access the advanced encryption features these modules support such as bulk encryption and decryption, and key management functions such as key aging and key rotation.</span></span>  
  
 <span data-ttu-id="f5827-122">При выполнении [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на виртуальной машине Azure [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] может использовать ключи, хранящиеся в [хранилище ключей Azure](https://go.microsoft.com/fwlink/?LinkId=521401).</span><span class="sxs-lookup"><span data-stu-id="f5827-122">When running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in an Azure VM, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can use keys stored in the [Azure Key Vault](https://go.microsoft.com/fwlink/?LinkId=521401).</span></span> <span data-ttu-id="f5827-123">Дополнительные сведения см. в разделе [Расширенное управление ключами с помощью хранилища ключей Azure (SQL Server)](extensible-key-management-using-azure-key-vault-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f5827-123">For more information, see [Extensible Key Management Using Azure Key Vault &#40;SQL Server&#41;](extensible-key-management-using-azure-key-vault-sql-server.md).</span></span>  
  
## <a name="ekm-configuration"></a><span data-ttu-id="f5827-124">Конфигурация расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-124">EKM Configuration</span></span>  
 <span data-ttu-id="f5827-125">Расширенное управление ключами поддерживается не во всех выпусках [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f5827-125">Extensible Key Management is not available in every edition of [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="f5827-126">Перечень функций, поддерживаемых в разных выпусках [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], см. в разделе [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="f5827-126">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
 <span data-ttu-id="f5827-127">По умолчанию расширенное управление ключами отключено.</span><span class="sxs-lookup"><span data-stu-id="f5827-127">By default, Extensible Key Management is off.</span></span> <span data-ttu-id="f5827-128">Чтобы включить его, воспользуйтесь командой sp_configure с параметрами, приведенными в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="f5827-128">To enable this feature, use the sp_configure command that has the following option and value, as in the following example:</span></span>  
  
```  
sp_configure 'show advanced', 1  
GO  
RECONFIGURE  
GO  
sp_configure 'EKM provider enabled', 1  
GO  
RECONFIGURE  
GO  
```  
  
> [!NOTE]  
>  <span data-ttu-id="f5827-129">Если команда sp_configure вызывается в выпусках [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , не поддерживающих расширенное управление ключами, то возникнет ошибка.</span><span class="sxs-lookup"><span data-stu-id="f5827-129">If you use the sp_configure command for this option on editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that do not support EKM, you will receive an error.</span></span>  
  
 <span data-ttu-id="f5827-130">Чтобы отключить эту функцию, задайте значение **0**.</span><span class="sxs-lookup"><span data-stu-id="f5827-130">To disable the feature, set the value to **0**.</span></span> <span data-ttu-id="f5827-131">Дополнительные сведения о настройке параметров сервера см. в разделе [sp_configure (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f5827-131">For more information about how to set server options, see [sp_configure &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span></span>  
  
## <a name="how-to-use-ekm"></a><span data-ttu-id="f5827-132">Использование расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-132">How to Use EKM</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="f5827-133">Расширенное управление ключами включает ключи шифрования, защищающие файлы базы данных, хранимые на внешних устройствах, таких как смарт-карты, USB-устройства, модули расширенного управления ключами и аппаратные модули безопасности.</span><span class="sxs-lookup"><span data-stu-id="f5827-133">Extensible Key Management enables the encryption keys that protect the database files to be stored in an off-box device such as a smartcard, USB device, or EKM/HSM module.</span></span> <span data-ttu-id="f5827-134">Предусмотрена также защита данных от администраторов базы данных (за исключением членов группы sysadmin).</span><span class="sxs-lookup"><span data-stu-id="f5827-134">This also enables data protection from database administrators (except members of the sysadmin group).</span></span> <span data-ttu-id="f5827-135">Данные могут быть зашифрованы при помощи ключей шифрования, доступ к которым имеет только пользователь базы данных на внешнем модуле расширенного управления ключами или аппаратного модуля безопасности.</span><span class="sxs-lookup"><span data-stu-id="f5827-135">Data can be encrypted by using encryption keys that only the database user has access to on the external EKM/HSM module.</span></span>  
  
 <span data-ttu-id="f5827-136">Расширенное управление ключами дает следующие преимущества.</span><span class="sxs-lookup"><span data-stu-id="f5827-136">Extensible Key Management also provides the following benefits:</span></span>  
  
-   <span data-ttu-id="f5827-137">Дополнительная проверка подлинности (включая разграничение обязанностей).</span><span class="sxs-lookup"><span data-stu-id="f5827-137">Additional authorization check (enabling separation of duties).</span></span>  
  
-   <span data-ttu-id="f5827-138">Более высокая производительность аппаратного шифрования или расшифровки.</span><span class="sxs-lookup"><span data-stu-id="f5827-138">Higher performance for hardware-based encryption/decryption.</span></span>  
  
-   <span data-ttu-id="f5827-139">Внешнее создание ключей шифрования.</span><span class="sxs-lookup"><span data-stu-id="f5827-139">External encryption key generation.</span></span>  
  
-   <span data-ttu-id="f5827-140">Внешнее хранение ключей шифрования (физическое разделение данных и ключей.)</span><span class="sxs-lookup"><span data-stu-id="f5827-140">External encryption key storage (physical separation of data and keys).</span></span>  
  
-   <span data-ttu-id="f5827-141">Получение ключей шифрования.</span><span class="sxs-lookup"><span data-stu-id="f5827-141">Encryption key retrieval.</span></span>  
  
-   <span data-ttu-id="f5827-142">Внешнее хранение ключей шифрования (разрешает смену ключа шифрования).</span><span class="sxs-lookup"><span data-stu-id="f5827-142">External encryption key retention (enables encryption key rotation).</span></span>  
  
-   <span data-ttu-id="f5827-143">Упрощенное восстановление ключа шифрования.</span><span class="sxs-lookup"><span data-stu-id="f5827-143">Easier encryption key recovery.</span></span>  
  
-   <span data-ttu-id="f5827-144">Управление распространением ключей шифрования.</span><span class="sxs-lookup"><span data-stu-id="f5827-144">Manageable encryption key distribution.</span></span>  
  
-   <span data-ttu-id="f5827-145">Безопасное освобождение ключей шифрования.</span><span class="sxs-lookup"><span data-stu-id="f5827-145">Secure encryption key disposal.</span></span>  
  
 <span data-ttu-id="f5827-146">Расширенное управление ключами можно использовать для сочетания имени пользователя и пароля, а также других методов, определяемых драйвером расширенного управления ключами.</span><span class="sxs-lookup"><span data-stu-id="f5827-146">You can use Extensible Key Management for a username and password combination or other methods defined by the EKM driver.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="f5827-147">Службе технической поддержки [!INCLUDE[msCoName](../../../includes/msconame-md.md)] для устранения неполадок может потребоваться ключ шифрования от поставщика расширенного управления ключами.</span><span class="sxs-lookup"><span data-stu-id="f5827-147">For troubleshooting, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] technical support might require the encryption key from the EKM provider.</span></span> <span data-ttu-id="f5827-148">Кроме того, при работе над устранением проблем может потребоваться доступ к средствам или процессам, предоставляемым поставщиком.</span><span class="sxs-lookup"><span data-stu-id="f5827-148">You might also need to access vendor tools or processes to help resolve an issue.</span></span>  
  
### <a name="authentication-with-an-ekm-device"></a><span data-ttu-id="f5827-149">Проверка подлинности на устройстве расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-149">Authentication with an EKM Device</span></span>  
 <span data-ttu-id="f5827-150">Модуль расширенного управления ключами может поддерживать несколько типов проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="f5827-150">An EKM module can support more than one type of authentication.</span></span> <span data-ttu-id="f5827-151">Каждый поставщик предоставляет [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]только один тип проверки подлинности, то есть если в модуле поддерживается проверка подлинности Basic или Other, то использоваться может только одна из них, но не обе.</span><span class="sxs-lookup"><span data-stu-id="f5827-151">Each provider exposes only one type of authentication to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], that is if the module supports Basic or Other authentication types, it exposes one or the other, but not both.</span></span>  
  
#### <a name="ekm-device-specific-basic-authentication-using-usernamepassword"></a><span data-ttu-id="f5827-152">Определяемая устройством расширенного управления ключами обычная проверка подлинности при помощи имени пользователя и пароля</span><span class="sxs-lookup"><span data-stu-id="f5827-152">EKM Device-Specific Basic Authentication Using username/password</span></span>  
 <span data-ttu-id="f5827-153">Для тех модулей расширенного управления ключами, в которых поддерживается обычная проверка подлинности на основе пары *имя пользователя/пароль*, в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] предусмотрена прозрачная проверка подлинности с использованием учетных данных.</span><span class="sxs-lookup"><span data-stu-id="f5827-153">For those EKM modules that support Basic authentication using a *username/password* pair, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provides transparent authentication using credentials.</span></span> <span data-ttu-id="f5827-154">Дополнительные сведения об учетных данных см. в статье [Учетные данные (компонент Database Engine)](../authentication-access/credentials-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="f5827-154">For more information about credentials, see [Credentials &#40;Database Engine&#41;](../authentication-access/credentials-database-engine.md).</span></span>  
  
 <span data-ttu-id="f5827-155">Чтобы получить доступ к модулю расширенного управления ключами на основе имени входа, можно создать для поставщика расширенного управления ключами учетные данные и сопоставить их с именем входа (для учетных записей как Windows, так и [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="f5827-155">A credential can be created for an EKM provider and mapped to a login (both Windows and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] accounts) to access an EKM module on per-login basis.</span></span> <span data-ttu-id="f5827-156">Поле *Identify* учетных данных содержит имя пользователя; в поле *secret* содержится пароль для подключения к модулю расширенного управления ключами.</span><span class="sxs-lookup"><span data-stu-id="f5827-156">The *Identify* field of the credential contains the username; the *secret* field contains a password to connect to an EKM module.</span></span>  
  
 <span data-ttu-id="f5827-157">При отсутствии учетных данных для поставщика расширенного управления ключами, сопоставленных с именем входа, используются учетные данные, сопоставленные с учетной записью службы [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f5827-157">If there is no login mapped credential for the EKM provider, the credential mapped to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account is used.</span></span>  
  
 <span data-ttu-id="f5827-158">Имени входа может быть сопоставлено несколько учетных данных, если они используются для отдельных поставщиков расширенного управления ключами.</span><span class="sxs-lookup"><span data-stu-id="f5827-158">A login can have multiple credentials mapped to it, as long as they are used for distinctive EKM providers.</span></span> <span data-ttu-id="f5827-159">У каждого поставщика расширенного управления ключами может быть только один набор учетных данных, сопоставленных одному имени входа.</span><span class="sxs-lookup"><span data-stu-id="f5827-159">There must be only one mapped credential per EKM provider per login.</span></span> <span data-ttu-id="f5827-160">Одни и те же учетные данные могут быть сопоставлены нескольким именам входа.</span><span class="sxs-lookup"><span data-stu-id="f5827-160">The same credential can be mapped to other logins.</span></span>  
  
#### <a name="other-types-of-ekm-device-specific-authentication"></a><span data-ttu-id="f5827-161">Другие виды проверки подлинности, зависящей от устройства расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-161">Other Types of EKM Device-Specific Authentication</span></span>  
 <span data-ttu-id="f5827-162">В модулях расширенного управления ключами, проверка подлинности в которых отличается от Windows или сочетания *пользователь/пароль* , проверка подлинности должна осуществляться независимо от [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f5827-162">For EKM modules that have authentication other than Windows or *user/password* combinations, authentication must be performed independently from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
### <a name="encryption-and-decryption-by-an-ekm-device"></a><span data-ttu-id="f5827-163">Шифрование и расшифровка при помощи устройства расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-163">Encryption and Decryption by an EKM Device</span></span>  
 <span data-ttu-id="f5827-164">Следующие функции и возможности позволяют зашифровать и расшифровать данные при помощи симметричных и асимметричных ключей.</span><span class="sxs-lookup"><span data-stu-id="f5827-164">You can use the following functions and features to encrypt and decrypt data by using symmetric and asymmetric keys:</span></span>  
  
|<span data-ttu-id="f5827-165">Функция или характеристика</span><span class="sxs-lookup"><span data-stu-id="f5827-165">Function or feature</span></span>|<span data-ttu-id="f5827-166">Справочник</span><span class="sxs-lookup"><span data-stu-id="f5827-166">Reference</span></span>|  
|-------------------------|---------------|  
|<span data-ttu-id="f5827-167">Шифрование симметричным ключом</span><span class="sxs-lookup"><span data-stu-id="f5827-167">Symmetric key encryption</span></span>|[<span data-ttu-id="f5827-168">CREATE SYMMETRIC KEY (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="f5827-168">CREATE SYMMETRIC KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-symmetric-key-transact-sql)|  
|<span data-ttu-id="f5827-169">Шифрование асимметричным ключом</span><span class="sxs-lookup"><span data-stu-id="f5827-169">Asymmetric Key encryption</span></span>|[<span data-ttu-id="f5827-170">CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="f5827-170">CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-asymmetric-key-transact-sql)|  
|<span data-ttu-id="f5827-171">EncryptByKey(key_guid, 'cleartext', ...)</span><span class="sxs-lookup"><span data-stu-id="f5827-171">EncryptByKey(key_guid, 'cleartext', ...)</span></span>|[<span data-ttu-id="f5827-172">ENCRYPTBYKEY (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="f5827-172">ENCRYPTBYKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/encryptbykey-transact-sql)|  
|<span data-ttu-id="f5827-173">DecryptByKey(ciphertext, ...)</span><span class="sxs-lookup"><span data-stu-id="f5827-173">DecryptByKey(ciphertext, ...)</span></span>|[<span data-ttu-id="f5827-174">DECRYPTBYKEY (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="f5827-174">DECRYPTBYKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/decryptbykey-transact-sql)|  
|<span data-ttu-id="f5827-175">EncryptByAsmKey(key_guid, 'cleartext')</span><span class="sxs-lookup"><span data-stu-id="f5827-175">EncryptByAsmKey(key_guid, 'cleartext')</span></span>|[<span data-ttu-id="f5827-176">ENCRYPTBYASYMKEY (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="f5827-176">ENCRYPTBYASYMKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/encryptbyasymkey-transact-sql)|  
|<span data-ttu-id="f5827-177">DecryptByAsmKey(ciphertext)</span><span class="sxs-lookup"><span data-stu-id="f5827-177">DecryptByAsmKey(ciphertext)</span></span>|[<span data-ttu-id="f5827-178">DECRYPTBYASYMKEY (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="f5827-178">DECRYPTBYASYMKEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/decryptbyasymkey-transact-sql)|  
  
#### <a name="database-keys-encryption-by-ekm-keys"></a><span data-ttu-id="f5827-179">Шифрование ключей базы данных при помощи ключей расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-179">Database Keys Encryption by EKM Keys</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="f5827-180">при помощи ключей расширенного управления ключами можно шифровать другие ключи базы данных.</span><span class="sxs-lookup"><span data-stu-id="f5827-180">can use EKM keys to encrypt other keys in a database.</span></span> <span data-ttu-id="f5827-181">В устройстве расширенного управления ключами можно создать и использовать как симметричные, так и асимметричные ключи.</span><span class="sxs-lookup"><span data-stu-id="f5827-181">You can create and use both symmetric and asymmetric keys on an EKM device.</span></span> <span data-ttu-id="f5827-182">Асимметричные ключи расширенного управления ключами позволяют зашифровать собственные (отличные от расширенного управления ключами) симметричные ключи.</span><span class="sxs-lookup"><span data-stu-id="f5827-182">You can encrypt native (non-EKM) symmetric keys with EKM asymmetric keys.</span></span>  
  
 <span data-ttu-id="f5827-183">В следующем примере показано создание симметричного ключа базы данных и его шифрование при помощи ключа из модуля расширенного управления ключами.</span><span class="sxs-lookup"><span data-stu-id="f5827-183">The following example creates a database symmetric key and encrypts it using a key on an EKM module.</span></span>  
  
```  
CREATE SYMMETRIC KEY Key1  
WITH ALGORITHM = AES_256  
ENCRYPTION BY EKM_AKey1;  
GO  
--Open database key  
OPEN SYMMETRIC KEY Key1  
DECRYPTION BY EKM_AKey1  
```  
  
 <span data-ttu-id="f5827-184">Дополнительные сведения о базе данных и ключах серверов в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] см. в статье [Ключи шифрования базы данных и SQL Server (компонент Database Engine)](sql-server-and-database-encryption-keys-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="f5827-184">For more information about Database and Server Keys in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [SQL Server and Database Encryption Keys &#40;Database Engine&#41;](sql-server-and-database-encryption-keys-database-engine.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f5827-185">Зашифровать один ключ расширенного управления ключами при помощи другого ключа расширенного управления ключами невозможно.</span><span class="sxs-lookup"><span data-stu-id="f5827-185">You cannot encrypt one EKM key with another EKM key.</span></span>  
>   
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="f5827-186">не поддерживает модули подписания и асимметричные ключи, сформированные из поставщика расширенного управления ключами.</span><span class="sxs-lookup"><span data-stu-id="f5827-186">does not support signing modules with asymmetric keys generated from EKM provider.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="f5827-187">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="f5827-187">Related Tasks</span></span>  
 [<span data-ttu-id="f5827-188">Включенный параметр конфигурации сервера поставщика расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-188">EKM provider enabled Server Configuration Option</span></span>](../../../database-engine/configure-windows/ekm-provider-enabled-server-configuration-option.md)  
  
 [<span data-ttu-id="f5827-189">Включение TDE с помощью расширенного управления ключами</span><span class="sxs-lookup"><span data-stu-id="f5827-189">Enable TDE Using EKM</span></span>](enable-tde-on-sql-server-using-ekm.md)  
  
 [<span data-ttu-id="f5827-190">Расширенное управление ключами с помощью хранилища ключей Azure (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="f5827-190">Extensible Key Management Using Azure Key Vault &#40;SQL Server&#41;</span></span>](extensible-key-management-using-azure-key-vault-sql-server.md)  
  
## <a name="see-also"></a><span data-ttu-id="f5827-191">См. также:</span><span class="sxs-lookup"><span data-stu-id="f5827-191">See Also</span></span>  
 <span data-ttu-id="f5827-192">[CREATE CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-cryptographic-provider-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-192">[CREATE CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-cryptographic-provider-transact-sql) </span></span>  
 <span data-ttu-id="f5827-193">[DROP CRYPTOGRAPHIC PROVIDER (Transact-SQL)](/sql/t-sql/statements/drop-cryptographic-provider-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-193">[DROP CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-cryptographic-provider-transact-sql) </span></span>  
 <span data-ttu-id="f5827-194">[ALTER CRYPTOGRAPHIC PROVIDER (Transact-SQL)](/sql/t-sql/statements/alter-cryptographic-provider-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-194">[ALTER CRYPTOGRAPHIC PROVIDER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-cryptographic-provider-transact-sql) </span></span>  
 <span data-ttu-id="f5827-195">[sys.cryptographic_providers (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-cryptographic-providers-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-195">[sys.cryptographic_providers &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-cryptographic-providers-transact-sql) </span></span>  
 <span data-ttu-id="f5827-196">[sys.dm_cryptographic_provider_sessions (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-sessions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-196">[sys.dm_cryptographic_provider_sessions &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-sessions-transact-sql) </span></span>  
 <span data-ttu-id="f5827-197">[sys.dm_cryptographic_provider_properties (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-properties-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-197">[sys.dm_cryptographic_provider_properties &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-properties-transact-sql) </span></span>  
 <span data-ttu-id="f5827-198">[sys.dm_cryptographic_provider_algorithms (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-algorithms-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-198">[sys.dm_cryptographic_provider_algorithms &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-algorithms-transact-sql) </span></span>  
 <span data-ttu-id="f5827-199">[sys.dm_cryptographic_provider_keys (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-keys-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-199">[sys.dm_cryptographic_provider_keys &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-cryptographic-provider-keys-transact-sql) </span></span>  
 <span data-ttu-id="f5827-200">[sys.credentials (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-credentials-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-200">[sys.credentials &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-credentials-transact-sql) </span></span>  
 <span data-ttu-id="f5827-201">[CREATE CREDENTIAL (Transact-SQL)](/sql/t-sql/statements/create-credential-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-201">[CREATE CREDENTIAL &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-credential-transact-sql) </span></span>  
 <span data-ttu-id="f5827-202">[ALTER LOGIN (Transact-SQL)](/sql/t-sql/statements/alter-login-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-202">[ALTER LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-login-transact-sql) </span></span>  
 <span data-ttu-id="f5827-203">[CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-asymmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-203">[CREATE ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-asymmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="f5827-204">[ALTER ASYMMETRIC KEY (Transact-SQL)](/sql/t-sql/statements/alter-asymmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-204">[ALTER ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-asymmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="f5827-205">[DROP ASYMMETRIC KEY (Transact-SQL)](/sql/t-sql/statements/drop-asymmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-205">[DROP ASYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-asymmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="f5827-206">[CREATE SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-206">[CREATE SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="f5827-207">[ALTER SYMMETRIC KEY (Transact-SQL)](/sql/t-sql/statements/alter-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-207">[ALTER SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="f5827-208">[DROP SYMMETRIC KEY (Transact-SQL)](/sql/t-sql/statements/drop-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-208">[DROP SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="f5827-209">[OPEN SYMMETRIC KEY (Transact-SQL)](/sql/t-sql/statements/open-symmetric-key-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f5827-209">[OPEN SYMMETRIC KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/open-symmetric-key-transact-sql) </span></span>  
 <span data-ttu-id="f5827-210">[Резервное копирование и восстановление ключей шифрования служб Reporting Services](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-210">[Back Up and Restore Reporting Services Encryption Keys](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span></span>  
 <span data-ttu-id="f5827-211">[Удаление и повторное создание ключей шифрования (диспетчер конфигурации служб SSRS)](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-211">[Delete and Re-create Encryption Keys  &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span></span>  
 <span data-ttu-id="f5827-212">[Добавление и удаление ключей шифрования для масштабного развертывания (диспетчер конфигурации служб SSRS)](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-212">[Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span></span>  
 <span data-ttu-id="f5827-213">[Создание резервной копии главного ключа службы](service-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-213">[Back Up the Service Master Key](service-master-key.md) </span></span>  
 <span data-ttu-id="f5827-214">[Восстановление главного ключа службы](restore-the-service-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-214">[Restore the Service Master Key](restore-the-service-master-key.md) </span></span>  
 <span data-ttu-id="f5827-215">[Создание главного ключа базы данных](create-a-database-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-215">[Create a Database Master Key](create-a-database-master-key.md) </span></span>  
 <span data-ttu-id="f5827-216">[Создание резервной копии главного ключа базы данных](back-up-a-database-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-216">[Back Up a Database Master Key](back-up-a-database-master-key.md) </span></span>  
 <span data-ttu-id="f5827-217">[Восстановление главного ключа базы данных](restore-a-database-master-key.md) </span><span class="sxs-lookup"><span data-stu-id="f5827-217">[Restore a Database Master Key](restore-a-database-master-key.md) </span></span>  
 [<span data-ttu-id="f5827-218">Создание идентичных симметричных ключей на двух серверах</span><span class="sxs-lookup"><span data-stu-id="f5827-218">Create Identical Symmetric Keys on Two Servers</span></span>](create-identical-symmetric-keys-on-two-servers.md)  
  
  
