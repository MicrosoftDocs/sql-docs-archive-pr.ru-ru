---
title: Включение и настройка FILESTREAM | Документация Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.technology: filestream
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- FILESTREAM [SQL Server], enabling
ms.assetid: 78737e19-c65b-48d9-8fa9-aa6f1e1bce73
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: f6c0e505bd32636d045519b36e439bc21c7079d6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87654361"
---
# <a name="enable-and-configure-filestream"></a>Включение и настройка FILESTREAM
  Перед началом использования хранилища FILESTREAM его необходимо включить в экземпляре компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)]. В этом разделе описано, как включить FILESTREAM с помощью диспетчера конфигурации SQL Server.  
  
> [!NOTE]  
>  Нельзя включить функцию FILESTREAM в 32-разрядной версии [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], запущенной в 64-разрядной операционной системе.  
  
##  <a name="enabling-filestream"></a><a name="enabling"></a> Включение FILESTREAM  
  
#### <a name="to-enable-and-change-filestream-settings"></a>Включение и изменение параметров FILESTREAM  
  
1.  В меню **Пуск** последовательно выберите пункты **Все программы**, [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], **Средства настройки**и щелкните **Диспетчер конфигурации SQL Server**.  
  
2.  В списке служб щелкните правой кнопкой мыши **Службы SQL Server**и выберите команду **Открыть**.  
  
3.  В оснастке **Диспетчер конфигурации SQL Server** найдите экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , в котором нужно включить FILESTREAM.  
  
4.  Щелкните правой кнопкой мыши экземпляр и выберите пункт **Свойства**.  
  
5.  В диалоговом окне **Свойства SQL Server** перейдите на вкладку **FILESTREAM** .  
  
6.  Установите флажок **Разрешить FILESTREAM при доступе через Transact-SQL** .  
  
7.  Если нужно считывать и записывать данные FILESTREAM из Windows, установите флажок **Разрешить FILESTREAM при потоковом доступе файлового ввода-вывода**. Введите имя общего ресурса Windows в поле **Имя общего ресурса Windows** .  
  
8.  Если удаленные клиенты должны иметь доступ к данным FILESTREAM, хранящимся в этом общем ресурсе, установите флажок **Разрешить удаленным клиентам потоковый доступ к данным FILESTREAM**.  
  
9. Нажмите кнопку **Применить**.  
  
10. В среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]нажмите кнопку **Создать запрос** , чтобы открыть редактор запросов.  
  
11. В редакторе запросов введите следующий код [!INCLUDE[tsql](../../includes/tsql-md.md)] :  
  
    ```sql  
    EXEC sp_configure filestream_access_level, 2  
    RECONFIGURE  
    ```  
  
12. Нажмите кнопку **Выполнить**.  
  
13. Перезапустите службу [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  

  
##  <a name="best-practices"></a><a name="best"></a> Рекомендации  
  
###  <a name="physical-configuration-and-maintenance"></a><a name="config"></a>Физическая конфигурация и обслуживание  
 При использовании томов хранилища FILESTREAM обратите внимание на следующие рекомендации.  
  
-   Отключите короткие имена файлов на компьютерах с FILESTREAM. Короткие имена файлов создаются гораздо дольше. Отключить короткие имена файлов можно с помощью программы Windows **fsutil** .  
  
-   Регулярно выполняйте дефрагментацию на компьютерах с FILESTREAM.  
  
-   Используйте файловую систему NTFS с кластерами по 64 килобайт. На сжатых томах должна быть файловая система NTFS с кластерами по 4 килобайта.  
  
-   Отключите индексирование на томах FILESTREAM и установите параметр **disablelastaccess** . **Для этого**воспользуйтесь программой **fsutil** Windows.  
  
-   Отключите антивирусное сканирование на томах FILESTREAM, если оно не является необходимым. Если антивирусное сканирование необходимо, не настраивайте политики автоматического удаления зараженных файлов.  
  
-   Настройте уровень отказоустойчивости и производительности RAID в соответствии с требованиями приложения.  
  
||||||  
|-|-|-|-|-|  
|Уровень RAID|Производительность записи|Производительность чтения|Отказоустойчивость|Remarks|  
|RAID 5|Нормальный|Нормальный|Высокая|Производительность лучше, чем у диска или JBOD, но хуже, чем у RAID 0 или RAID 5 с чередованием.|  
|RAID 0|Высокая|Высокая|None||  
|RAID 5 + чередование|Высокая|Высокая|Высокая|Самый дорогостоящий вариант.|  
  

  
###  <a name="physical-database-design"></a><a name="database"></a>Структура физической базы данных  
 При проектировании базы данных FILESTREAM следует учитывать следующие рекомендации.  
  
-   Столбцы FILESTREAM должны сопровождаться соответствующим `uniqueidentifier` столбцом ROWGUID. Кроме того, типам таблиц также должен соответствовать уникальный индекс. Как правило, этот индекс не является кластеризованным. Если бизнес-логика базы данных требует использовать кластеризованный индекс, следует убедиться, что значения, которые хранятся в индексе, не являются случайными. Случайные значения приведут к переупорядочению индекса при каждом добавлении или удалении строки в таблице.  
  
-   По соображениям производительности файловые группы и контейнеры FILESTREAM находятся на томах, отличных от тех, где находится операционная система, база данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , журнал [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , база данных tempdb или файл подкачки.  
  
-   Управление местом на диске и соответствующие политики не поддерживаются FILESTREAM напрямую. Однако можно управлять местом и применять политики косвенно путем присвоения каждой файловой группы FILESTREAM отдельному тому с последующим применением функций управления данного тома.  
  
  
