---
title: Метаданные параметров и наборов строк | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- metadata [OLE DB]
ms.assetid: 31b318a4-20e7-4db0-b367-eb9938859029
author: rothja
ms.author: jroth
ms.openlocfilehash: f3bddb4d83a8904b3def70853fe1e6614dd48d9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87730634"
---
# <a name="parameter-and-rowset-metadata"></a><span data-ttu-id="c68f6-102">Метаданные параметров и наборов строк</span><span class="sxs-lookup"><span data-stu-id="c68f6-102">Parameter and Rowset Metadata</span></span>
  <span data-ttu-id="c68f6-103">В этом разделе приведены сведения о следующем типе и элементах типа, связанных с усовершенствованиями даты и времени OLE DB.</span><span class="sxs-lookup"><span data-stu-id="c68f6-103">This topic provides information about the following type and type members, related to the OLE DB date and time enhancements.</span></span>  
  
-   <span data-ttu-id="c68f6-104">Структура DBBINDING</span><span class="sxs-lookup"><span data-stu-id="c68f6-104">DBBINDING structure</span></span>  
  
-   `ICommandWithParameters::GetParameterInfo`  
  
-   `ICommandWithParameters::SetParameterInfo`  
  
-   `IColumnsRowset::GetColumnsRowset`  
  
-   `IColumnsInfo::GetColumnInfo`  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="c68f6-105">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="c68f6-105">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="c68f6-106">Следующие сведения возвращаются в структуре DBPARAMINFO с помощью *prgParamInfo*:</span><span class="sxs-lookup"><span data-stu-id="c68f6-106">The following information is returned in the DBPARAMINFO structure through *prgParamInfo*:</span></span>  
  
|<span data-ttu-id="c68f6-107">Тип параметра</span><span class="sxs-lookup"><span data-stu-id="c68f6-107">Parameter Type</span></span>|<span data-ttu-id="c68f6-108">*wType*</span><span class="sxs-lookup"><span data-stu-id="c68f6-108">*wType*</span></span>|<span data-ttu-id="c68f6-109">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="c68f6-109">*ulParamSize*</span></span>|<span data-ttu-id="c68f6-110">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="c68f6-110">*bPrecision*</span></span>|<span data-ttu-id="c68f6-111">*bScale*</span><span class="sxs-lookup"><span data-stu-id="c68f6-111">*bScale*</span></span>|<span data-ttu-id="c68f6-112">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="c68f6-112">*dwFlags*</span></span><br /><br /> <span data-ttu-id="c68f6-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="c68f6-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="c68f6-114">Дата</span><span class="sxs-lookup"><span data-stu-id="c68f6-114">date</span></span>|<span data-ttu-id="c68f6-115">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="c68f6-115">DBTYPE_DBDATE</span></span>|<span data-ttu-id="c68f6-116">6</span><span class="sxs-lookup"><span data-stu-id="c68f6-116">6</span></span>|<span data-ttu-id="c68f6-117">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-117">10</span></span>|<span data-ttu-id="c68f6-118">0</span><span class="sxs-lookup"><span data-stu-id="c68f6-118">0</span></span>|<span data-ttu-id="c68f6-119">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-119">Clear</span></span>|  
|<span data-ttu-id="c68f6-120">time</span><span class="sxs-lookup"><span data-stu-id="c68f6-120">time</span></span>|<span data-ttu-id="c68f6-121">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="c68f6-121">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="c68f6-122">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-122">10</span></span>|<span data-ttu-id="c68f6-123">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="c68f6-123">8, 10..16</span></span>|<span data-ttu-id="c68f6-124">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-124">0..7</span></span>|<span data-ttu-id="c68f6-125">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-125">Set</span></span>|  
|<span data-ttu-id="c68f6-126">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="c68f6-126">smalldatetime</span></span>|<span data-ttu-id="c68f6-127">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-127">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-128">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-128">16</span></span>|<span data-ttu-id="c68f6-129">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-129">16</span></span>|<span data-ttu-id="c68f6-130">0</span><span class="sxs-lookup"><span data-stu-id="c68f6-130">0</span></span>|<span data-ttu-id="c68f6-131">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-131">Clear</span></span>|  
|<span data-ttu-id="c68f6-132">DATETIME</span><span class="sxs-lookup"><span data-stu-id="c68f6-132">datetime</span></span>|<span data-ttu-id="c68f6-133">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-133">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-134">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-134">16</span></span>|<span data-ttu-id="c68f6-135">23</span><span class="sxs-lookup"><span data-stu-id="c68f6-135">23</span></span>|<span data-ttu-id="c68f6-136">3</span><span class="sxs-lookup"><span data-stu-id="c68f6-136">3</span></span>|<span data-ttu-id="c68f6-137">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-137">Clear</span></span>|  
|<span data-ttu-id="c68f6-138">datetime2</span><span class="sxs-lookup"><span data-stu-id="c68f6-138">datetime2</span></span>|<span data-ttu-id="c68f6-139">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-139">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-140">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-140">16</span></span>|<span data-ttu-id="c68f6-141">19, 21.27</span><span class="sxs-lookup"><span data-stu-id="c68f6-141">19,21..27</span></span>|<span data-ttu-id="c68f6-142">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-142">0..7</span></span>|<span data-ttu-id="c68f6-143">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-143">Set</span></span>|  
|<span data-ttu-id="c68f6-144">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="c68f6-144">datetimeoffset</span></span>|<span data-ttu-id="c68f6-145">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="c68f6-145">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="c68f6-146">20</span><span class="sxs-lookup"><span data-stu-id="c68f6-146">20</span></span>|<span data-ttu-id="c68f6-147">26, 28.34</span><span class="sxs-lookup"><span data-stu-id="c68f6-147">26,28..34</span></span>|<span data-ttu-id="c68f6-148">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-148">0..7</span></span>|<span data-ttu-id="c68f6-149">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-149">Set</span></span>|  
  
 <span data-ttu-id="c68f6-150">Обратите внимание, что в некоторых случаях диапазоны значений не являются непрерывными.</span><span class="sxs-lookup"><span data-stu-id="c68f6-150">Notice that in some cases value ranges are not continuous.</span></span> <span data-ttu-id="c68f6-151">Это следствие добавления десятичной запятой, когда точность в долях секунды выше нуля.</span><span class="sxs-lookup"><span data-stu-id="c68f6-151">This is due to the addition of a decimal point when fractional precision is greater than zero.</span></span>  
  
 <span data-ttu-id="c68f6-152">Параметр DBPARAMFLAGS_SS_ISVARIABLESCALE допустим только при соединении с сервером [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (или более поздней версией).</span><span class="sxs-lookup"><span data-stu-id="c68f6-152">DBPARAMFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="c68f6-153">DBPARAMFLAGS_SS_ISVARIABLESCALE никогда не задается при соединении с серверами низкого уровня.</span><span class="sxs-lookup"><span data-stu-id="c68f6-153">DBPARAMFLAGS_SS_ISVARIABLESCALE is never set when connected to down-level servers.</span></span>  
  
## <a name="icommandwithparameterssetparameterinfo-and-implied-parameter-types"></a><span data-ttu-id="c68f6-154">Метод ICommandWithParameters::SetParameterInfo и неявные типы параметров</span><span class="sxs-lookup"><span data-stu-id="c68f6-154">ICommandWithParameters::SetParameterInfo and Implied Parameter Types</span></span>  
 <span data-ttu-id="c68f6-155">Сведения, предоставленные в структуре DBPARAMBINDINFO, должны соответствовать следующим требованиям.</span><span class="sxs-lookup"><span data-stu-id="c68f6-155">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="c68f6-156">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="c68f6-156">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="c68f6-157">(зависит от поставщика)</span><span class="sxs-lookup"><span data-stu-id="c68f6-157">(provider specific)</span></span>|<span data-ttu-id="c68f6-158">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="c68f6-158">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="c68f6-159">(OLE DB, обычный)</span><span class="sxs-lookup"><span data-stu-id="c68f6-159">(OLE DB generic)</span></span>|<span data-ttu-id="c68f6-160">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="c68f6-160">*ulParamSize*</span></span>|<span data-ttu-id="c68f6-161">*bScale*</span><span class="sxs-lookup"><span data-stu-id="c68f6-161">*bScale*</span></span>|  
|----------------------------------------------------|-------------------------------------------------|-------------------|--------------|  
||<span data-ttu-id="c68f6-162">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="c68f6-162">DBTYPE_DATE</span></span>|<span data-ttu-id="c68f6-163">6</span><span class="sxs-lookup"><span data-stu-id="c68f6-163">6</span></span>|<span data-ttu-id="c68f6-164">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="c68f6-164">Ignored</span></span>|  
|<span data-ttu-id="c68f6-165">Дата</span><span class="sxs-lookup"><span data-stu-id="c68f6-165">date</span></span>|<span data-ttu-id="c68f6-166">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="c68f6-166">DBTYPE_DBDATE</span></span>|<span data-ttu-id="c68f6-167">6</span><span class="sxs-lookup"><span data-stu-id="c68f6-167">6</span></span>|<span data-ttu-id="c68f6-168">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="c68f6-168">Ignored</span></span>|  
||<span data-ttu-id="c68f6-169">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="c68f6-169">DBTYPE_DBTIME</span></span>|<span data-ttu-id="c68f6-170">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-170">10</span></span>|<span data-ttu-id="c68f6-171">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="c68f6-171">Ignored</span></span>|  
|<span data-ttu-id="c68f6-172">time</span><span class="sxs-lookup"><span data-stu-id="c68f6-172">time</span></span>|<span data-ttu-id="c68f6-173">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="c68f6-173">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="c68f6-174">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-174">10</span></span>|<span data-ttu-id="c68f6-175">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-175">0..7</span></span>|  
|<span data-ttu-id="c68f6-176">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="c68f6-176">smalldatetime</span></span>||<span data-ttu-id="c68f6-177">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-177">16</span></span>|<span data-ttu-id="c68f6-178">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="c68f6-178">Ignored</span></span>|  
|<span data-ttu-id="c68f6-179">DATETIME</span><span class="sxs-lookup"><span data-stu-id="c68f6-179">datetime</span></span>||<span data-ttu-id="c68f6-180">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-180">16</span></span>|<span data-ttu-id="c68f6-181">Не учитывается</span><span class="sxs-lookup"><span data-stu-id="c68f6-181">Ignored</span></span>|  
|<span data-ttu-id="c68f6-182">datetime2 или DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-182">datetime2 or DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-183">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-183">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-184">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-184">16</span></span>|<span data-ttu-id="c68f6-185">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-185">0..7</span></span>|  
|<span data-ttu-id="c68f6-186">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="c68f6-186">datetimeoffset</span></span>|<span data-ttu-id="c68f6-187">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="c68f6-187">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="c68f6-188">20</span><span class="sxs-lookup"><span data-stu-id="c68f6-188">20</span></span>|<span data-ttu-id="c68f6-189">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-189">0..7</span></span>|  
  
 <span data-ttu-id="c68f6-190">Параметр *bPrecision* не учитывается.</span><span class="sxs-lookup"><span data-stu-id="c68f6-190">The *bPrecision* parameter is ignored.</span></span>  
  
 <span data-ttu-id="c68f6-191">Значение «DBPARAMFLAGS_SS_ISVARIABLESCALE» не учитывается при отправке данных на сервер.</span><span class="sxs-lookup"><span data-stu-id="c68f6-191">"DBPARAMFLAGS_SS_ISVARIABLESCALE" is ignored when sending data to the server.</span></span> <span data-ttu-id="c68f6-192">Приложения могут принудительно использовать унаследованные типы потоков табличных данных за счет применения имен типов «`datetime`» и «`smalldatetime`», характерных для поставщика.</span><span class="sxs-lookup"><span data-stu-id="c68f6-192">Applications can force the use of legacy tabular-data stream (TDS) types by using the provider-specific type names "`datetime`" and "`smalldatetime`".</span></span> <span data-ttu-id="c68f6-193">При подключении к [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] серверам (или более поздней версии) `datetime2` будет использоваться формат "", и при необходимости произойдет неявное преобразование сервера, если имя типа — " `datetime2` " или "DBTYPE_DBTIMESTAMP".</span><span class="sxs-lookup"><span data-stu-id="c68f6-193">When connected to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) servers, "`datetime2`" format will be used and an implicit server conversion will occur, if necessary, when the type name is "`datetime2`" or "DBTYPE_DBTIMESTAMP".</span></span> <span data-ttu-id="c68f6-194">*bScale* игнорируется, если используются имена типов " `datetime` " или "", определенные поставщиком `smalldatetime` .</span><span class="sxs-lookup"><span data-stu-id="c68f6-194">*bScale* is ignored if the provider specific type names "`datetime`" or "`smalldatetime`" are used.</span></span> <span data-ttu-id="c68f6-195">В противном случае аппикатионс должен убедиться, что *bScale* задан правильно.</span><span class="sxs-lookup"><span data-stu-id="c68f6-195">Otherwise, appications must ensure that *bScale* is set correctly.</span></span> <span data-ttu-id="c68f6-196">Приложения, обновленные с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] помощью MDAC и Native Client с [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] , используют "DBTYPE_DBTIMESTAMP", будут завершаться ошибкой, если они не устанавливают *bScale* правильно.</span><span class="sxs-lookup"><span data-stu-id="c68f6-196">Applications upgraded from MDAC and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] that use "DBTYPE_DBTIMESTAMP" will fail if they do not set *bScale* correctly.</span></span> <span data-ttu-id="c68f6-197">При соединении с экземплярами сервера версии ниже [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] значение параметра *bScale*, отличное от 0 или 3 с именем "DBTYPE_DBTIMESTAMP", является ошибкой. В этом случае будет возвращено E_FAIL.</span><span class="sxs-lookup"><span data-stu-id="c68f6-197">When connected to server instances earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], a *bScale* value other than 0 or 3 with "DBTYPE_DBTIMESTAMP" is an error and E_FAIL will be returned.</span></span>  
  
 <span data-ttu-id="c68f6-198">Если ICommandWithParameters:: SetParameterInfo не вызывается, поставщик имплес тип сервера из типа привязки, как указано в IAccessor:: CreateAccessor следующим образом:</span><span class="sxs-lookup"><span data-stu-id="c68f6-198">When ICommandWithParameters::SetParameterInfo is not called, the provider imples the server type from the binding type as specified in IAccessor::CreateAccessor as follows:</span></span>  
  
|<span data-ttu-id="c68f6-199">Тип привязки</span><span class="sxs-lookup"><span data-stu-id="c68f6-199">Binding Type</span></span>|<span data-ttu-id="c68f6-200">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="c68f6-200">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="c68f6-201">(зависит от поставщика)</span><span class="sxs-lookup"><span data-stu-id="c68f6-201">(provider specific)</span></span>|  
|------------------|----------------------------------------------------|  
|<span data-ttu-id="c68f6-202">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="c68f6-202">DBTYPE_DATE</span></span>|<span data-ttu-id="c68f6-203">datetime2(0)</span><span class="sxs-lookup"><span data-stu-id="c68f6-203">datetime2(0)</span></span>|  
|<span data-ttu-id="c68f6-204">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="c68f6-204">DBTYPE_DBDATE</span></span>|<span data-ttu-id="c68f6-205">Дата</span><span class="sxs-lookup"><span data-stu-id="c68f6-205">date</span></span>|  
|<span data-ttu-id="c68f6-206">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="c68f6-206">DBTYPE_DBTIME</span></span>|<span data-ttu-id="c68f6-207">time(0)</span><span class="sxs-lookup"><span data-stu-id="c68f6-207">time(0)</span></span>|  
|<span data-ttu-id="c68f6-208">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="c68f6-208">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="c68f6-209">time(7)</span><span class="sxs-lookup"><span data-stu-id="c68f6-209">time(7)</span></span>|  
|<span data-ttu-id="c68f6-210">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-210">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-211">datetime2(7)</span><span class="sxs-lookup"><span data-stu-id="c68f6-211">datetime2(7)</span></span>|  
|<span data-ttu-id="c68f6-212">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="c68f6-212">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="c68f6-213">datetimeoffset(7)</span><span class="sxs-lookup"><span data-stu-id="c68f6-213">datetimeoffset(7)</span></span>|  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="c68f6-214">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="c68f6-214">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="c68f6-215">Функция `IColumnsRowset::GetColumnsRowset` возвращает следующие столбцы.</span><span class="sxs-lookup"><span data-stu-id="c68f6-215">`IColumnsRowset::GetColumnsRowset` returns the following columns:</span></span>  
  
|<span data-ttu-id="c68f6-216">Тип столбца</span><span class="sxs-lookup"><span data-stu-id="c68f6-216">Column Type</span></span>|<span data-ttu-id="c68f6-217">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="c68f6-217">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="c68f6-218">DBCOLUM_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="c68f6-218">DBCOLUM_COLUMNSIZE</span></span>|<span data-ttu-id="c68f6-219">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="c68f6-219">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="c68f6-220">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span><span class="sxs-lookup"><span data-stu-id="c68f6-220">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span></span>|<span data-ttu-id="c68f6-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="c68f6-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span></span>|  
|-----------------|--------------------|-------------------------|-------------------------|--------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="c68f6-222">Дата</span><span class="sxs-lookup"><span data-stu-id="c68f6-222">date</span></span>|<span data-ttu-id="c68f6-223">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="c68f6-223">DBTYPE_DBDATE</span></span>|<span data-ttu-id="c68f6-224">6</span><span class="sxs-lookup"><span data-stu-id="c68f6-224">6</span></span>|<span data-ttu-id="c68f6-225">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-225">10</span></span>|<span data-ttu-id="c68f6-226">0</span><span class="sxs-lookup"><span data-stu-id="c68f6-226">0</span></span>|<span data-ttu-id="c68f6-227">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-227">Clear</span></span>|  
|<span data-ttu-id="c68f6-228">time</span><span class="sxs-lookup"><span data-stu-id="c68f6-228">time</span></span>|<span data-ttu-id="c68f6-229">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="c68f6-229">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="c68f6-230">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-230">10</span></span>|<span data-ttu-id="c68f6-231">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="c68f6-231">8, 10..16</span></span>|<span data-ttu-id="c68f6-232">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-232">0..7</span></span>|<span data-ttu-id="c68f6-233">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-233">Set</span></span>|  
|<span data-ttu-id="c68f6-234">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="c68f6-234">smalldatetime</span></span>|<span data-ttu-id="c68f6-235">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-235">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-236">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-236">16</span></span>|<span data-ttu-id="c68f6-237">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-237">16</span></span>|<span data-ttu-id="c68f6-238">0</span><span class="sxs-lookup"><span data-stu-id="c68f6-238">0</span></span>|<span data-ttu-id="c68f6-239">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-239">Clear</span></span>|  
|<span data-ttu-id="c68f6-240">DATETIME</span><span class="sxs-lookup"><span data-stu-id="c68f6-240">datetime</span></span>|<span data-ttu-id="c68f6-241">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-241">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-242">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-242">16</span></span>|<span data-ttu-id="c68f6-243">23</span><span class="sxs-lookup"><span data-stu-id="c68f6-243">23</span></span>|<span data-ttu-id="c68f6-244">3</span><span class="sxs-lookup"><span data-stu-id="c68f6-244">3</span></span>|<span data-ttu-id="c68f6-245">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-245">Clear</span></span>|  
|<span data-ttu-id="c68f6-246">datetime2</span><span class="sxs-lookup"><span data-stu-id="c68f6-246">datetime2</span></span>|<span data-ttu-id="c68f6-247">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-247">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-248">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-248">16</span></span>|<span data-ttu-id="c68f6-249">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="c68f6-249">19, 21..27</span></span>|<span data-ttu-id="c68f6-250">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-250">0..7</span></span>|<span data-ttu-id="c68f6-251">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-251">Set</span></span>|  
|<span data-ttu-id="c68f6-252">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="c68f6-252">datetimeoffset</span></span>|<span data-ttu-id="c68f6-253">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="c68f6-253">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="c68f6-254">20</span><span class="sxs-lookup"><span data-stu-id="c68f6-254">20</span></span>|<span data-ttu-id="c68f6-255">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="c68f6-255">26, 28..34</span></span>|<span data-ttu-id="c68f6-256">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-256">0..7</span></span>|<span data-ttu-id="c68f6-257">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-257">Set</span></span>|  
  
 <span data-ttu-id="c68f6-258">В DBCOLUMN_FLAGS, DBCOLUMNFLAGS_ISFIXEDLENGTH всегда имеет значение TRUE для типов даты-времени, а следующие флаги всегда имеют значение FALSE.</span><span class="sxs-lookup"><span data-stu-id="c68f6-258">In DBCOLUMN_FLAGS, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="c68f6-259">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="c68f6-259">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="c68f6-260">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="c68f6-260">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="c68f6-261">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="c68f6-261">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="c68f6-262">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="c68f6-262">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="c68f6-263">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="c68f6-263">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="c68f6-264">DBCOLUMNFLAGS_ISROWVER</span><span class="sxs-lookup"><span data-stu-id="c68f6-264">DBCOLUMNFLAGS_ISROWVER</span></span>  
  
-   <span data-ttu-id="c68f6-265">DBCOLUMNFLAGS_MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="c68f6-265">DBCOLUMNFLAGS_MAYDEFER</span></span>  
  
 <span data-ttu-id="c68f6-266">Остальные флаги (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE и DBCOLUMNFLAGS_WRITEUNKNOWN) можно задать в зависимости от того, как определен столбец, а также от фактического запроса.</span><span class="sxs-lookup"><span data-stu-id="c68f6-266">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set, depending on how the column is defined and the actual query.</span></span>  
  
 <span data-ttu-id="c68f6-267">В DBCOLUMN_FLAGS новый флаг DBCOLUMNFLAGS_SS_ISVARIABLESCALE внедрен, чтобы приложения могли определять тип сервера столбцов, где DBCOLUMN_TYPE является DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="c68f6-267">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in DBCOLUMN_FLAGS to allow an application to determine the server type of columns, where DBCOLUMN_TYPE is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="c68f6-268">Также должен использоваться флаг DBCOLUMN_SCALE или DBCOLUMN_DATETIMEPRECISION для указания типа сервера.</span><span class="sxs-lookup"><span data-stu-id="c68f6-268">DBCOLUMN_SCALE or DBCOLUMN_DATETIMEPRECISION must also be used to identify the server type.</span></span>  
  
 <span data-ttu-id="c68f6-269">Флаг DBCOLUMNFLAGS_SS_ISVARIABLESCALE допустим только при соединении с сервером [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (или более поздней версией).</span><span class="sxs-lookup"><span data-stu-id="c68f6-269">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="c68f6-270">При соединении с серверами низкого уровня флаг DBCOLUMNFLAGS_SS_ISVARIABLESCALE остается неопределенным.</span><span class="sxs-lookup"><span data-stu-id="c68f6-270">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is undefined when connected to down-level servers.</span></span>  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="c68f6-271">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="c68f6-271">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="c68f6-272">Структура DBCOLUMNINFO возвращает следующие данные.</span><span class="sxs-lookup"><span data-stu-id="c68f6-272">DBCOLUMNINFO structure returns the following information:</span></span>  
  
|<span data-ttu-id="c68f6-273">Тип параметра</span><span class="sxs-lookup"><span data-stu-id="c68f6-273">Parameter Type</span></span>|<span data-ttu-id="c68f6-274">*wType*</span><span class="sxs-lookup"><span data-stu-id="c68f6-274">*wType*</span></span>|<span data-ttu-id="c68f6-275">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="c68f6-275">*ulColumnSize*</span></span>|<span data-ttu-id="c68f6-276">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="c68f6-276">*bPrecision*</span></span>|<span data-ttu-id="c68f6-277">*bScale*</span><span class="sxs-lookup"><span data-stu-id="c68f6-277">*bScale*</span></span>|<span data-ttu-id="c68f6-278">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="c68f6-278">*dwFlags*</span></span><br /><br /> <span data-ttu-id="c68f6-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="c68f6-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="c68f6-280">Дата</span><span class="sxs-lookup"><span data-stu-id="c68f6-280">date</span></span>|<span data-ttu-id="c68f6-281">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="c68f6-281">DBTYPE_DBDATE</span></span>|<span data-ttu-id="c68f6-282">6</span><span class="sxs-lookup"><span data-stu-id="c68f6-282">6</span></span>|<span data-ttu-id="c68f6-283">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-283">10</span></span>|<span data-ttu-id="c68f6-284">0</span><span class="sxs-lookup"><span data-stu-id="c68f6-284">0</span></span>|<span data-ttu-id="c68f6-285">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-285">Clear</span></span>|  
|<span data-ttu-id="c68f6-286">time(1..7)</span><span class="sxs-lookup"><span data-stu-id="c68f6-286">time(1..7)</span></span>|<span data-ttu-id="c68f6-287">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="c68f6-287">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="c68f6-288">10</span><span class="sxs-lookup"><span data-stu-id="c68f6-288">10</span></span>|<span data-ttu-id="c68f6-289">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="c68f6-289">8, 10..16</span></span>|<span data-ttu-id="c68f6-290">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-290">0..7</span></span>|<span data-ttu-id="c68f6-291">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-291">Set</span></span>|  
|<span data-ttu-id="c68f6-292">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="c68f6-292">smalldatetime</span></span>|<span data-ttu-id="c68f6-293">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-293">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-294">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-294">16</span></span>|<span data-ttu-id="c68f6-295">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-295">16</span></span>|<span data-ttu-id="c68f6-296">0</span><span class="sxs-lookup"><span data-stu-id="c68f6-296">0</span></span>|<span data-ttu-id="c68f6-297">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-297">Clear</span></span>|  
|<span data-ttu-id="c68f6-298">DATETIME</span><span class="sxs-lookup"><span data-stu-id="c68f6-298">datetime</span></span>|<span data-ttu-id="c68f6-299">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-299">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-300">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-300">16</span></span>|<span data-ttu-id="c68f6-301">23</span><span class="sxs-lookup"><span data-stu-id="c68f6-301">23</span></span>|<span data-ttu-id="c68f6-302">3</span><span class="sxs-lookup"><span data-stu-id="c68f6-302">3</span></span>|<span data-ttu-id="c68f6-303">Очистить</span><span class="sxs-lookup"><span data-stu-id="c68f6-303">Clear</span></span>|  
|<span data-ttu-id="c68f6-304">datetime2</span><span class="sxs-lookup"><span data-stu-id="c68f6-304">datetime2</span></span>|<span data-ttu-id="c68f6-305">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c68f6-305">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="c68f6-306">16</span><span class="sxs-lookup"><span data-stu-id="c68f6-306">16</span></span>|<span data-ttu-id="c68f6-307">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="c68f6-307">19, 21..27</span></span>|<span data-ttu-id="c68f6-308">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-308">0..7</span></span>|<span data-ttu-id="c68f6-309">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-309">Set</span></span>|  
|<span data-ttu-id="c68f6-310">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="c68f6-310">datetimeoffset</span></span>|<span data-ttu-id="c68f6-311">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="c68f6-311">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="c68f6-312">20</span><span class="sxs-lookup"><span data-stu-id="c68f6-312">20</span></span>|<span data-ttu-id="c68f6-313">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="c68f6-313">26, 28..34</span></span>|<span data-ttu-id="c68f6-314">0..7</span><span class="sxs-lookup"><span data-stu-id="c68f6-314">0..7</span></span>|<span data-ttu-id="c68f6-315">Присвойте параметру</span><span class="sxs-lookup"><span data-stu-id="c68f6-315">Set</span></span>|  
  
 <span data-ttu-id="c68f6-316">В *dwFlags* флаг DBCOLUMNFLAGS_ISFIXEDLENGTH всегда имеет значение TRUE для типов даты и времени, а следующие флаги всегда имеют значение FALSE:</span><span class="sxs-lookup"><span data-stu-id="c68f6-316">In *dwFlags*, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="c68f6-317">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="c68f6-317">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="c68f6-318">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="c68f6-318">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="c68f6-319">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="c68f6-319">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="c68f6-320">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="c68f6-320">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="c68f6-321">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="c68f6-321">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="c68f6-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="c68f6-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span></span>  
  
 <span data-ttu-id="c68f6-323">Остальные флаги (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE и DBCOLUMNFLAGS_WRITEUNKNOWN) можно задавать.</span><span class="sxs-lookup"><span data-stu-id="c68f6-323">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set.</span></span>  
  
 <span data-ttu-id="c68f6-324">В *dwFlags* предусмотрен новый флаг DBCOLUMNFLAGS_SS_ISVARIABLESCALE, чтобы приложения могли определять тип сервера столбцов, где *wType* является DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="c68f6-324">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in *dwFlags* to allow an application to determine the server type of columns, where *wType* is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="c68f6-325">Кроме того, для определения типа сервера необходимо использовать *bScale*.</span><span class="sxs-lookup"><span data-stu-id="c68f6-325">*bScale* must also be used to identify the server type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c68f6-326">См. также:</span><span class="sxs-lookup"><span data-stu-id="c68f6-326">See Also</span></span>  
 [<span data-ttu-id="c68f6-327">Метаданные (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="c68f6-327">Metadata &#40;OLE DB&#41;</span></span>](../../database-engine/dev-guide/metadata-ole-db.md)  
  
  
