---
title: Влияние параметров ISO | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ISO options (ODBC)
- ODBC applications, ISO options
- ODBC applications, statements
- SQL Server Native Client ODBC driver, ISO options
- statements [ODBC], ISO options
ms.assetid: 813f1397-fa0b-45ec-a718-e13fe2fb88ac
author: rothja
ms.author: jroth
ms.openlocfilehash: 79deff1d77f4020aa7484629bac78d360ed7691f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655126"
---
# <a name="effects-of-iso-options"></a><span data-ttu-id="ffa78-102">Действие параметров ISO</span><span class="sxs-lookup"><span data-stu-id="ffa78-102">Effects of ISO Options</span></span>
  <span data-ttu-id="ffa78-103">Стандарт ODBC близок к стандарту ISO, а приложения ODBC ожидают стандартного поведения от драйвера ODBC.</span><span class="sxs-lookup"><span data-stu-id="ffa78-103">The ODBC standard is closely matched to the ISO standard, and ODBC applications expect standard behavior from an ODBC driver.</span></span> <span data-ttu-id="ffa78-104">Чтобы обеспечить более тесное соответствие поведения, определенного в стандарте ODBC, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвер ODBC для собственного клиента всегда использует любые параметры ISO, доступные в версии SQL Server, с которой он подключается.</span><span class="sxs-lookup"><span data-stu-id="ffa78-104">To make its behavior conform more closely with that defined in the ODBC standard, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver always uses any ISO options available in the version of SQL Server with which it connects.</span></span>  
  
 <span data-ttu-id="ffa78-105">Когда [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвер ODBC для собственного клиента подключается к экземпляру [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , сервер обнаруживает, что клиент использует [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвер ODBC собственного клиента и устанавливает несколько параметров в.</span><span class="sxs-lookup"><span data-stu-id="ffa78-105">When the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver connects to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the server detects that the client is using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver and sets several options on.</span></span>  
  
 <span data-ttu-id="ffa78-106">Драйвер сам формирует эти инструкции; ODBC-приложение не посылает для этого никаких запросов.</span><span class="sxs-lookup"><span data-stu-id="ffa78-106">The driver issues these statements itself; the ODBC application does nothing to request them.</span></span> <span data-ttu-id="ffa78-107">Установка этих параметров позволяет ODBC-приложениям, использующим драйвер, иметь лучшую переносимость, поскольку в этом случае поведение сервера более соответствует стандарту ISO.</span><span class="sxs-lookup"><span data-stu-id="ffa78-107">Setting these options allows ODBC applications using the driver to be more portable because the server behavior then matches the ISO standard.</span></span>  
  
 <span data-ttu-id="ffa78-108">Приложения на основе DB-Library обычно не вызывают включение этих параметров.</span><span class="sxs-lookup"><span data-stu-id="ffa78-108">DB-Library-based applications generally do not turn these options on.</span></span> <span data-ttu-id="ffa78-109">Сайты, отслеживающие различные поведения клиентов ODBC или DB-Library при выполнении одной и той же инструкции SQL, не предполагают, что это указывает на проблему с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвером ODBC для собственного клиента.</span><span class="sxs-lookup"><span data-stu-id="ffa78-109">Sites observing different behavior between ODBC or DB-Library clients when running the same SQL statement should not assume this points to a problem with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="ffa78-110">Они должны сначала перезапустить инструкцию в среде DB-Library с теми же параметрами SET, которые использовались [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвером ODBC для собственного клиента.</span><span class="sxs-lookup"><span data-stu-id="ffa78-110">They should first rerun the statement in the DB-Library environment with the same SET options as would be used by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span>  
  
 <span data-ttu-id="ffa78-111">Поскольку пользователи и приложения могут в любое время включать и выключать параметры из набора SET, разработчики хранимых процедур и триггеров должны проводить тестирование своих процедур и триггеров как со включенными, так и с отключенными параметрами из этого набора.</span><span class="sxs-lookup"><span data-stu-id="ffa78-111">Because SET options can be turned on and off at any time by users and applications, developers of stored procedures and triggers should also take care to test their procedures and triggers with the SET options listed above turned both on and off.</span></span> <span data-ttu-id="ffa78-112">Это гарантирует, что триггеры и процедуры будут правильно работать независимо от того, какие параметры конкретное соединение установит при вызове триггера или процедуры.</span><span class="sxs-lookup"><span data-stu-id="ffa78-112">This ensures that the procedures and triggers work correctly regardless of which options a particular connection may have set on when they invoke the procedure or trigger.</span></span> <span data-ttu-id="ffa78-113">Если для работы триггера или хранимой процедуры требуется конкретное значение одного из этих параметров, инструкцию SET следует выполнить в начале триггера или хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="ffa78-113">Triggers or stored procedures that require a particular setting for one of these options should issue a SET statement at the start of the trigger or stored procedure.</span></span> <span data-ttu-id="ffa78-114">Она сохраняет силу только до завершения триггера или хранимой процедуры; после этого восстанавливается первоначальное значение параметра.</span><span class="sxs-lookup"><span data-stu-id="ffa78-114">This SET statement remains in effect only for the execution of the trigger or stored procedure; when the procedure or trigger ends, the original setting is restored.</span></span>  
  
 <span data-ttu-id="ffa78-115">При подключении к экземпляру [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] устанавливается также четвертый параметр SET, CONCAT_NULL_YIELDS_NULL.</span><span class="sxs-lookup"><span data-stu-id="ffa78-115">When connected to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], a fourth SET option, CONCAT_NULL_YIELDS_NULL, is also set on.</span></span> <span data-ttu-id="ffa78-116">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Драйвер ODBC для собственного клиента не устанавливает эти параметры в случае, если ансинпв = No указано в источнике данных или в [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) или [SQLBrowseConnect](../../native-client-odbc-api/sqlbrowseconnect.md).</span><span class="sxs-lookup"><span data-stu-id="ffa78-116">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver does not set these options on if AnsiNPW=NO is specified in the data source or on either [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) or [SQLBrowseConnect](../../native-client-odbc-api/sqlbrowseconnect.md).</span></span>  
  
 <span data-ttu-id="ffa78-117">Как и параметры ISO, указанные ранее, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвер ODBC для собственного клиента не включает параметр QUOTED_IDENTIFIER on, если куотедид = No указано в источнике данных или в **SQLDriverConnect** или **SQLBrowseConnect**.</span><span class="sxs-lookup"><span data-stu-id="ffa78-117">Like the ISO options noted earlier, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver does not turn the QUOTED_IDENTIFIER option on if QuotedID=NO is specified in the data source or on either **SQLDriverConnect** or **SQLBrowseConnect**.</span></span>  
  
 <span data-ttu-id="ffa78-118">Чтобы драйвер мог узнавать текущие значения параметров SET, ODBC-приложения не должны задавать эти параметры с помощью инструкции языка [!INCLUDE[tsql](../../../includes/tsql-md.md)] SET.</span><span class="sxs-lookup"><span data-stu-id="ffa78-118">To allow the driver to know the current state of SET options, ODBC applications should not use the [!INCLUDE[tsql](../../../includes/tsql-md.md)] SET statement to set these options.</span></span> <span data-ttu-id="ffa78-119">Они могут задавать их только через параметры источника данных или соединения.</span><span class="sxs-lookup"><span data-stu-id="ffa78-119">They should only set these options using either the data source or the connection options.</span></span> <span data-ttu-id="ffa78-120">Если приложение запускает инструкции SET, то инструкции SQL, создаваемые драйвером, могут быть неверными.</span><span class="sxs-lookup"><span data-stu-id="ffa78-120">If the application issues SET statements, the driver can generate incorrect SQL statements.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ffa78-121">См. также:</span><span class="sxs-lookup"><span data-stu-id="ffa78-121">See Also</span></span>  
 <span data-ttu-id="ffa78-122">[Исполнение инструкций &#40;ODBC&#41;](executing-statements-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="ffa78-122">[Executing Statements &#40;ODBC&#41;](executing-statements-odbc.md) </span></span>  
 <span data-ttu-id="ffa78-123">[SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) </span><span class="sxs-lookup"><span data-stu-id="ffa78-123">[SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) </span></span>  
 [<span data-ttu-id="ffa78-124">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="ffa78-124">SQLBrowseConnect</span></span>](../../native-client-odbc-api/sqlbrowseconnect.md)  
  
  
