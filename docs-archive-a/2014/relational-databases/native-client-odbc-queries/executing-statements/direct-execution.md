---
title: Прямое выполнение | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC applications, statements
- direct execution [ODBC]
- SQLExecDirect function
- statements [ODBC], direct execution
ms.assetid: fa36e1af-ed98-4abc-97c1-c4cc5d227b29
author: rothja
ms.author: jroth
ms.openlocfilehash: 29153f3e4e9265e87feb0e23ba9ae97118691e95
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87655125"
---
# <a name="direct-execution"></a><span data-ttu-id="ec444-102">Прямое выполнение</span><span class="sxs-lookup"><span data-stu-id="ec444-102">Direct Execution</span></span>
  <span data-ttu-id="ec444-103">Прямое выполнение — это наиболее распространенный способ выполнения инструкции.</span><span class="sxs-lookup"><span data-stu-id="ec444-103">Direct execution is the most basic way to execute a statement.</span></span> <span data-ttu-id="ec444-104">Приложение создает строку символов, содержащую [!INCLUDE[tsql](../../../includes/tsql-md.md)] инструкцию, и отправляет ее для выполнения с помощью функции **SQLExecDirect** .</span><span class="sxs-lookup"><span data-stu-id="ec444-104">An application builds a character string containing a [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement and submits it for execution using the **SQLExecDirect** function.</span></span> <span data-ttu-id="ec444-105">Когда инструкция достигает сервера, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] компилирует ее в план выполнения и немедленно запускает план.</span><span class="sxs-lookup"><span data-stu-id="ec444-105">When the statement reaches the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] compiles it into an execution plan and then immediately runs the execution plan.</span></span>  
  
 <span data-ttu-id="ec444-106">Прямое выполнение обычно используется приложениями, которые создают и выполняют инструкции во время выполнения, и является наиболее эффективным методом для инструкций, которые будут выполняться одновременно.</span><span class="sxs-lookup"><span data-stu-id="ec444-106">Direct execution is commonly used by applications that build and execute statements at run time and is the most efficient method for statements that will be executed a single time.</span></span> <span data-ttu-id="ec444-107">Недостатком многих баз данных является то, что SQL-инструкция должна анализироваться и компилироваться при каждом выполнении, что увеличивает нагрузку при неоднократном использовании данной процедуры.</span><span class="sxs-lookup"><span data-stu-id="ec444-107">Its drawback with many databases is that the SQL statement must be parsed and compiled each time it is executed, which adds overhead if the statement is executed multiple times.</span></span>  
  
 <span data-ttu-id="ec444-108">В [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] значительно повышена производительность прямого выполнения часто выполняемых инструкций в многопользовательских средах, а использование SQLExecDirect с маркерами параметров для часто используемых инструкций SQL может приблизить их эффективность к эффективности выполнения после подготовки.</span><span class="sxs-lookup"><span data-stu-id="ec444-108">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] significantly improves the performance of direct execution of commonly executed statements in multiuser environments and using SQLExecDirect with parameter markers for commonly executed SQL statements can approach the efficiency of prepared execution.</span></span>  
  
 <span data-ttu-id="ec444-109">При подключении к экземпляру [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] драйвер ODBC для собственного клиента использует [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) для передачи инструкции SQL или пакета, указанного в **SQLExecDirect**.</span><span class="sxs-lookup"><span data-stu-id="ec444-109">When connected to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver uses [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) to transmit the SQL statement or batch specified on **SQLExecDirect**.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="ec444-110">имеет логику, позволяющую быстро определить, совпадает ли инструкция SQL или пакет, выполненный с **sp_executesql** , с инструкцией или пакетом, создавшим план выполнения, который уже существует в памяти.</span><span class="sxs-lookup"><span data-stu-id="ec444-110">has logic to quickly determine if an SQL statement or batch executed with **sp_executesql** matches the statement or batch that generated an execution plan that already exists in memory.</span></span> <span data-ttu-id="ec444-111">В случае совпадения [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] повторно использует существующий план, а не компилирует новый.</span><span class="sxs-lookup"><span data-stu-id="ec444-111">If a match is made, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] simply reuses the existing plan rather than compile a new plan.</span></span> <span data-ttu-id="ec444-112">Это означает, что часто выполняемые инструкции SQL, выполняемые с помощью **SQLExecDirect** в системе с большим количеством пользователей, получат преимущество от многих преимуществ повторного использования планов, которые были доступны только для хранимых процедур в предыдущих версиях [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ec444-112">This means that commonly executed SQL statements executed with **SQLExecDirect** in a system with many users will benefit from many of the plan-reuse benefits that were only available to stored procedures in earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="ec444-113">Данное преимущество работает только в случае одновременного выполнения одной инструкции или пакета SQL несколькими пользователями.</span><span class="sxs-lookup"><span data-stu-id="ec444-113">This benefit of reusing execution plans only works when several users are executing the same SQL statement or batch.</span></span> <span data-ttu-id="ec444-114">Следуйте этим соглашениям по написанию кода для повышения вероятности того, что инструкции SQL, выполняемые различными клиентами, будут достаточно похожи, чтобы повторно использовать планы выполнения.</span><span class="sxs-lookup"><span data-stu-id="ec444-114">Follow these coding conventions to increase the probability that the SQL statements executed by different clients are similar enough to be able to reuse execution plans:</span></span>  
  
-   <span data-ttu-id="ec444-115">Не включайте константы данных в инструкции SQL. Вместо этого используйте маркеры параметров, привязанные к переменным программы.</span><span class="sxs-lookup"><span data-stu-id="ec444-115">Do not include data constants in the SQL statements; instead use parameter markers bound to program variables.</span></span> <span data-ttu-id="ec444-116">Дополнительные сведения см. [в разделе Использование параметров инструкции](../using-statement-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="ec444-116">For more information, see [Using Statement Parameters](../using-statement-parameters.md).</span></span>  
  
-   <span data-ttu-id="ec444-117">Используйте полные имена объектов.</span><span class="sxs-lookup"><span data-stu-id="ec444-117">Use fully qualified object names.</span></span> <span data-ttu-id="ec444-118">Планы выполнения не будут использоваться повторно при неполных именах объектов.</span><span class="sxs-lookup"><span data-stu-id="ec444-118">Execution plans are not reused if object names are not qualified.</span></span>  
  
-   <span data-ttu-id="ec444-119">Соединения приложения по возможности должны использовать стандартный набор параметров соединений и инструкций.</span><span class="sxs-lookup"><span data-stu-id="ec444-119">Have application connections as possible use a common set of connection and statement options.</span></span> <span data-ttu-id="ec444-120">Планы выполнения, созданные для соединения с одним набором параметров (например ANSI_NULLS), не используются для соединения, имеющего другой набор параметров.</span><span class="sxs-lookup"><span data-stu-id="ec444-120">Execution plans generated for a connection with one set of options (such as ANSI_NULLS) are not reused for a connection having another set of options.</span></span> <span data-ttu-id="ec444-121">Драйвер ODBC собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и поставщик OLE DB собственного клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] имеют одинаковые установки по умолчанию для этих параметров.</span><span class="sxs-lookup"><span data-stu-id="ec444-121">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider both have the same default settings for these options.</span></span>  
  
 <span data-ttu-id="ec444-122">Если все инструкции, выполняемые с **SQLExecDirect** , кодируются с использованием этих соглашений, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] может повторно использовать планы выполнения при возникновении возможной сделки.</span><span class="sxs-lookup"><span data-stu-id="ec444-122">If all statements executed with **SQLExecDirect** are coded using these conventions, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can reuse execution plans when the opportunity arises.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ec444-123">См. также:</span><span class="sxs-lookup"><span data-stu-id="ec444-123">See Also</span></span>  
 [<span data-ttu-id="ec444-124">Исполнение инструкций &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="ec444-124">Executing Statements &#40;ODBC&#41;</span></span>](executing-statements-odbc.md)  
  
  
