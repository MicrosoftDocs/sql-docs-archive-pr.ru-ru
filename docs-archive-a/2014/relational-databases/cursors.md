---
title: Курсоры | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- results [SQL Server], cursors
- Transact-SQL cursors, about cursors
- cursors [SQL Server]
- data access [SQL Server], cursors
- result sets [SQL Server], cursors
- requesting cursors
- cursors [SQL Server], about cursors
ms.assetid: e668b40c-bd4d-4415-850d-20fc4872ee72
author: rothja
ms.author: jroth
ms.openlocfilehash: 055482a8cf64527f58ed983b449121a99960f566
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668902"
---
# <a name="cursors"></a><span data-ttu-id="0edd3-102">Курсоры</span><span class="sxs-lookup"><span data-stu-id="0edd3-102">Cursors</span></span>
  <span data-ttu-id="0edd3-103">Операции в реляционной базе данных выполняются над множеством строк.</span><span class="sxs-lookup"><span data-stu-id="0edd3-103">Operations in a relational database act on a complete set of rows.</span></span> <span data-ttu-id="0edd3-104">Например, набор строк, возвращаемый инструкцией SELECT, содержит все строки, которые удовлетворяют условиям, указанным в предложении WHERE инструкции.</span><span class="sxs-lookup"><span data-stu-id="0edd3-104">For example, the set of rows returned by a SELECT statement consists of all the rows that satisfy the conditions in the WHERE clause of the statement.</span></span> <span data-ttu-id="0edd3-105">Такой полный набор строк, возвращаемых инструкцией, называется результирующим набором.</span><span class="sxs-lookup"><span data-stu-id="0edd3-105">This complete set of rows returned by the statement is known as the result set.</span></span> <span data-ttu-id="0edd3-106">Приложения, особенно интерактивные, не всегда эффективно работают с результирующим набором как с единым целым.</span><span class="sxs-lookup"><span data-stu-id="0edd3-106">Applications, especially interactive online applications, cannot always work effectively with the entire result set as a unit.</span></span> <span data-ttu-id="0edd3-107">Им нужен механизм, позволяющий обрабатывать одну строку или небольшое их число за один раз.</span><span class="sxs-lookup"><span data-stu-id="0edd3-107">These applications need a mechanism to work with one row or a small block of rows at a time.</span></span> <span data-ttu-id="0edd3-108">Курсоры являются расширением результирующих наборов, которые предоставляют такой механизм.</span><span class="sxs-lookup"><span data-stu-id="0edd3-108">Cursors are an extension to result sets that provide that mechanism.</span></span>  
  
 <span data-ttu-id="0edd3-109">Курсоры позволяют усовершенствовать обработку результатов:</span><span class="sxs-lookup"><span data-stu-id="0edd3-109">Cursors extend result processing by:</span></span>  
  
-   <span data-ttu-id="0edd3-110">позиционируясь на отдельные строки результирующего набора;</span><span class="sxs-lookup"><span data-stu-id="0edd3-110">Allowing positioning at specific rows of the result set.</span></span>  
  
-   <span data-ttu-id="0edd3-111">получая одну или несколько строк от текущей позиции в результирующем наборе;</span><span class="sxs-lookup"><span data-stu-id="0edd3-111">Retrieving one row or block of rows from the current position in the result set.</span></span>  
  
-   <span data-ttu-id="0edd3-112">поддерживая изменение данных в строках в текущей позиции результирующего набора;</span><span class="sxs-lookup"><span data-stu-id="0edd3-112">Supporting data modifications to the rows at the current position in the result set.</span></span>  
  
-   <span data-ttu-id="0edd3-113">поддерживая разные уровни видимости изменений, сделанных другими пользователями для данных, представленных в результирующем наборе;</span><span class="sxs-lookup"><span data-stu-id="0edd3-113">Supporting different levels of visibility to changes made by other users to the database data that is presented in the result set.</span></span>  
  
-   <span data-ttu-id="0edd3-114">предоставляя инструкциям [!INCLUDE[tsql](../includes/tsql-md.md)] в скриптах, хранимых процедурах и триггерах доступ к данным результирующего набора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-114">Providing [!INCLUDE[tsql](../includes/tsql-md.md)] statements in scripts, stored procedures, and triggers access to the data in a result set.</span></span>  
  
## <a name="concepts"></a><span data-ttu-id="0edd3-115">Основные понятия</span><span class="sxs-lookup"><span data-stu-id="0edd3-115">Concepts</span></span>  
 <span data-ttu-id="0edd3-116">Реализации курсоров</span><span class="sxs-lookup"><span data-stu-id="0edd3-116">Cursor Implementations</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="0edd3-117">поддерживает три способа реализации курсоров.</span><span class="sxs-lookup"><span data-stu-id="0edd3-117">supports three cursor implementations.</span></span>  
  
 <span data-ttu-id="0edd3-118">курсоры Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="0edd3-118">Transact-SQL cursors</span></span>  
 <span data-ttu-id="0edd3-119">Основаны на синтаксисе DECLARE CURSOR и в основном используются в скриптах, хранимых процедурах и триггерах [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0edd3-119">Are based on the DECLARE CURSOR syntax and are used mainly in [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, stored procedures, and triggers.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="0edd3-120">реализуются на сервере и управляются инструкциями [!INCLUDE[tsql](../includes/tsql-md.md)] , отправляемыми от клиента серверу.</span><span class="sxs-lookup"><span data-stu-id="0edd3-120">cursors are implemented on the server and are managed by [!INCLUDE[tsql](../includes/tsql-md.md)] statements sent from the client to the server.</span></span> <span data-ttu-id="0edd3-121">Они также могут содержаться в пакетах, хранимых процедурах или триггерах.</span><span class="sxs-lookup"><span data-stu-id="0edd3-121">They may also be contained in batches, stored procedures, or triggers.</span></span>  
  
 <span data-ttu-id="0edd3-122">Серверные курсоры интерфейса прикладного программирования (API)</span><span class="sxs-lookup"><span data-stu-id="0edd3-122">Application programming interface (API) server cursors</span></span>  
 <span data-ttu-id="0edd3-123">Поддерживают функции курсоров API в OLE DB и ODBC.</span><span class="sxs-lookup"><span data-stu-id="0edd3-123">Support the API cursor functions in OLE DB and ODBC.</span></span> <span data-ttu-id="0edd3-124">Курсоры API реализуются на сервере.</span><span class="sxs-lookup"><span data-stu-id="0edd3-124">API server cursors are implemented on the server.</span></span> <span data-ttu-id="0edd3-125">Всякий раз, когда клиентское приложение вызывает функцию курсора API, поставщик OLE DB или драйвер ODBC для собственного клиента [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] передает требование на сервер для выполнения действия в отношении серверного курсора API.</span><span class="sxs-lookup"><span data-stu-id="0edd3-125">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client OLE DB provider or ODBC driver transmits the request to the server for action against the API server cursor.</span></span>  
  
 <span data-ttu-id="0edd3-126">Клиентские курсоры</span><span class="sxs-lookup"><span data-stu-id="0edd3-126">Client cursors</span></span>  
 <span data-ttu-id="0edd3-127">Реализуются внутренне драйвером ODBC для собственного клиента [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] и DLL, реализующим API-интерфейс ADO.</span><span class="sxs-lookup"><span data-stu-id="0edd3-127">Are implemented internally by the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver and by the DLL that implements the ADO API.</span></span> <span data-ttu-id="0edd3-128">Клиентские курсоры реализуются посредством кэширования всех строк результирующего набора на клиенте.</span><span class="sxs-lookup"><span data-stu-id="0edd3-128">Client cursors are implemented by caching all the result set rows on the client.</span></span> <span data-ttu-id="0edd3-129">Каждый раз, когда клиентское приложение вызывает функцию курсора API, драйвер ODBC для собственного клиента [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] или ADO DLL выполняет операцию курсора на строках результирующего набора, кэшированных на клиенте.</span><span class="sxs-lookup"><span data-stu-id="0edd3-129">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver or the ADO DLL performs the cursor operation on the result set rows cached on the client.</span></span>  
  
 <span data-ttu-id="0edd3-130">Типы курсоров</span><span class="sxs-lookup"><span data-stu-id="0edd3-130">Type of Cursors</span></span>  
 <span data-ttu-id="0edd3-131">Однонаправленный</span><span class="sxs-lookup"><span data-stu-id="0edd3-131">Forward-only</span></span>  
 <span data-ttu-id="0edd3-132">Курсор последовательного доступа не поддерживает прокрутку, он поддерживает только последовательную выборку строк от начала курсора до его конца.</span><span class="sxs-lookup"><span data-stu-id="0edd3-132">A forward-only cursor does not support scrolling; it supports only fetching the rows serially from the start to the end of the cursor.</span></span> <span data-ttu-id="0edd3-133">Строки нельзя получить из базы данных, пока они не будут выбраны.</span><span class="sxs-lookup"><span data-stu-id="0edd3-133">The rows are not retrieved from the database until they are fetched.</span></span> <span data-ttu-id="0edd3-134">Результаты всех инструкций INSERT, UPDATE и DELETE, влияющих на строки результирующего набора (выполненных текущим пользователем или зафиксированных другими пользователями), отображаются как строки, выбранные из курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-134">The effects of all INSERT, UPDATE, and DELETE statements made by the current user or committed by other users that affect rows in the result set are visible as the rows are fetched from the cursor.</span></span>  
  
 <span data-ttu-id="0edd3-135">Так как курсор не может быть прокручен назад, большинство изменений, сделанных в строках базы данных после извлечения сроки, не видны через курсор.</span><span class="sxs-lookup"><span data-stu-id="0edd3-135">Because the cursor cannot be scrolled backward, most changes made to rows in the database after the row was fetched are not visible through the cursor.</span></span> <span data-ttu-id="0edd3-136">Если значение, использованное для определения положения строки в результирующем наборе, модифицируется, например в случае обновления столбца, входящего в кластеризованный индекс, то значение видимо через курсор.</span><span class="sxs-lookup"><span data-stu-id="0edd3-136">In cases where a value used to determine the location of the row within the result set is modified, such as updating a column covered by a clustered index, the modified value is visible through the cursor.</span></span>  
  
 <span data-ttu-id="0edd3-137">Хотя в моделях курсоров API базы данных курсор последовательного доступа рассматривается как курсор отдельного типа, в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] принят другой подход.</span><span class="sxs-lookup"><span data-stu-id="0edd3-137">Although the database API cursor models consider a forward-only cursor to be a distinct type of cursor, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] does not.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="0edd3-138">принимает однонаправленность и возможность прокрутки курсоров как параметры, которые могут быть применены к статическим, управляемым набором ключей и динамическим курсорам.</span><span class="sxs-lookup"><span data-stu-id="0edd3-138">considers both forward-only and scroll as options that can be applied to static, keyset-driven, and dynamic cursors.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="0edd3-139">курсоры поддерживают однонаправленные статические, управляемые набором ключей и динамические курсоры.</span><span class="sxs-lookup"><span data-stu-id="0edd3-139">cursors support forward-only static, keyset-driven, and dynamic cursors.</span></span> <span data-ttu-id="0edd3-140">Модели курсора API базы данных предполагают, что статические, управляемые набором ключей и динамические курсоры всегда могут быть прокручены.</span><span class="sxs-lookup"><span data-stu-id="0edd3-140">The database API cursor models assume that static, keyset-driven, and dynamic cursors are always scrollable.</span></span> <span data-ttu-id="0edd3-141">Если атрибут или свойство курсора API базы данных установлены в значение «однонаправленный», [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] реализует это как однонаправленный динамический курсор.</span><span class="sxs-lookup"><span data-stu-id="0edd3-141">When a database API cursor attribute or property is set to forward-only, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] implements this as a forward-only dynamic cursor.</span></span>  
  
 <span data-ttu-id="0edd3-142">Статические</span><span class="sxs-lookup"><span data-stu-id="0edd3-142">Static</span></span>  
 <span data-ttu-id="0edd3-143">Полный результирующий набор статического курсора создается в базе данных **tempdb** при открытии курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-143">The complete result set of a static cursor is built in **tempdb** when the cursor is opened.</span></span> <span data-ttu-id="0edd3-144">Статический курсор всегда отображает результирующий набор точно в том виде, в котором он был при открытии курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-144">A static cursor always displays the result set as it was when the cursor was opened.</span></span> <span data-ttu-id="0edd3-145">Статическими курсорами обнаруживаются лишь некоторые изменения или не обнаруживаются вовсе, но при этом в процессе прокрутки такие курсоры потребляют сравнительно мало ресурсов.</span><span class="sxs-lookup"><span data-stu-id="0edd3-145">Static cursors detect few or no changes, but consume relatively few resources while scrolling.</span></span>  
  
 <span data-ttu-id="0edd3-146">Курсор не отражает изменения в базе данных, влияющие на вхождение в результирующий набор или изменяющие значения в столбцах строк, составляющих набор строк.</span><span class="sxs-lookup"><span data-stu-id="0edd3-146">The cursor does not reflect any changes made in the database that affect either the membership of the result set or changes to the values in the columns of the rows that make up the result set.</span></span> <span data-ttu-id="0edd3-147">Статический курсор не отображает новые строки, вставленные в базу данных после открытия курсора, даже если они соответствуют критериям поиска инструкции SELECT курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-147">A static cursor does not display new rows inserted in the database after the cursor was opened, even if they match the search conditions of the cursor SELECT statement.</span></span> <span data-ttu-id="0edd3-148">Если входящие в результирующий набор строки обновляются другими пользователями, то новые значения данных в статическом курсоре не отображаются.</span><span class="sxs-lookup"><span data-stu-id="0edd3-148">If rows making up the result set are updated by other users, the new data values are not displayed in the static cursor.</span></span> <span data-ttu-id="0edd3-149">Статический курсор продолжает отображать строки, удаленные из базы данных после открытия курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-149">The static cursor displays rows deleted from the database after the cursor was opened.</span></span> <span data-ttu-id="0edd3-150">Операции UPDATE, INSERT и DELETE не отображаются в статическом курсоре (до тех пор, пока курсор не будет закрыт и открыт повторно), не отображаются даже изменения, сделанные в том же соединении, в котором был открыт курсор.</span><span class="sxs-lookup"><span data-stu-id="0edd3-150">No UPDATE, INSERT, or DELETE operations are reflected in a static cursor (unless the cursor is closed and reopened), not even modifications made using the same connection that opened the cursor.</span></span>  
  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="0edd3-151">статические курсоры всегда доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="0edd3-151">static cursors are always read-only.</span></span>  
  
 <span data-ttu-id="0edd3-152">Так как результирующий набор статического курсора хранится в рабочей таблице базы данных **tempdb**, то размер строк результирующего набора не может превышать максимальный размер строк таблицы [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0edd3-152">Because the result set of a static cursor is stored in a work table in **tempdb**, the size of the rows in the result set cannot exceed the maximum row size for a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] table.</span></span>  
  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="0edd3-153">использует для описания статических курсоров термин «нечувствительный».</span><span class="sxs-lookup"><span data-stu-id="0edd3-153">uses the term insensitive for static cursors.</span></span> <span data-ttu-id="0edd3-154">Некоторые интерфейсы API баз данных называют их курсорами моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="0edd3-154">Some database APIs identify them as snapshot cursors.</span></span>  
  
 <span data-ttu-id="0edd3-155">Keyset</span><span class="sxs-lookup"><span data-stu-id="0edd3-155">Keyset</span></span>  
 <span data-ttu-id="0edd3-156">Членство и порядок строк в курсоре, управляемом набором ключей, являются фиксированными при открытии курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-156">The membership and order of rows in a keyset-driven cursor are fixed when the cursor is opened.</span></span> <span data-ttu-id="0edd3-157">Такие курсоры управляются с помощью набора уникальных идентификаторов — ключей.</span><span class="sxs-lookup"><span data-stu-id="0edd3-157">Keyset-driven cursors are controlled by a set of unique identifiers, keys, known as the keyset.</span></span> <span data-ttu-id="0edd3-158">Ключи создаются из набора столбцов, который уникально идентифицирует строки результирующего набора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-158">The keys are built from a set of columns that uniquely identify the rows in the result set.</span></span> <span data-ttu-id="0edd3-159">Набор ключей — это набор ключевых значений всех строк, попадающих под действие инструкции SELECT на момент открытия курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-159">The keyset is the set of the key values from all the rows that qualified for the SELECT statement at the time the cursor was opened.</span></span> <span data-ttu-id="0edd3-160">Набор ключей, управляющий курсором, создается в базе данных **tempdb** при открытии курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-160">The keyset for a keyset-driven cursor is built in **tempdb** when the cursor is opened.</span></span>  
  
 <span data-ttu-id="0edd3-161">Динамический</span><span class="sxs-lookup"><span data-stu-id="0edd3-161">Dynamic</span></span>  
 <span data-ttu-id="0edd3-162">Динамические курсоры — это противоположность статических курсоров.</span><span class="sxs-lookup"><span data-stu-id="0edd3-162">Dynamic cursors are the opposite of static cursors.</span></span> <span data-ttu-id="0edd3-163">Динамические курсоры отражают все изменения строк в результирующем наборе при прокрутке курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-163">Dynamic cursors reflect all changes made to the rows in their result set when scrolling through the cursor.</span></span> <span data-ttu-id="0edd3-164">Значения типа данных, порядок и членство строк в результирующем наборе могут меняться для каждой выборки.</span><span class="sxs-lookup"><span data-stu-id="0edd3-164">The data values, order, and membership of the rows in the result set can change on each fetch.</span></span> <span data-ttu-id="0edd3-165">Все инструкции UPDATE, INSERT и DELETE, выполняемые пользователями, видимы посредством курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-165">All UPDATE, INSERT, and DELETE statements made by all users are visible through the cursor.</span></span> <span data-ttu-id="0edd3-166">Обновление видимы сразу, если они сделаны посредством курсора с помощью либо API-функции (например, **SQLSetPos** ), либо предложения WHERE CURRENT OF [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0edd3-166">Updates are visible immediately if they are made through the cursor using either an API function such as **SQLSetPos** or the [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE CURRENT OF clause.</span></span> <span data-ttu-id="0edd3-167">Обновления, сделанные вне курсора, не видны до момента фиксации, если только уровень изоляции транзакций с курсорами не имеет значение READ UNCOMMITTED.</span><span class="sxs-lookup"><span data-stu-id="0edd3-167">Updates made outside the cursor are not visible until they are committed, unless the cursor transaction isolation level is set to read uncommitted.</span></span> <span data-ttu-id="0edd3-168">В планах динамических курсоров никогда не используются пространственные индексы.</span><span class="sxs-lookup"><span data-stu-id="0edd3-168">Dynamic cursor plans never use spatial indexes.</span></span>  
  
## <a name="requesting-a-cursor"></a><span data-ttu-id="0edd3-169">Запрос курсора</span><span class="sxs-lookup"><span data-stu-id="0edd3-169">Requesting a Cursor</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="0edd3-170">поддерживает два метода запроса курсоров.</span><span class="sxs-lookup"><span data-stu-id="0edd3-170">supports two methods for requesting a cursor:</span></span>  
  
-   [!INCLUDE[tsql](../includes/tsql-md.md)]  
  
     <span data-ttu-id="0edd3-171">Язык [!INCLUDE[tsql](../includes/tsql-md.md)] поддерживает синтаксис для использования курсоров, созданных в соответствии с синтаксисом курсоров ISO.</span><span class="sxs-lookup"><span data-stu-id="0edd3-171">The [!INCLUDE[tsql](../includes/tsql-md.md)] language supports a syntax for using cursors modeled after the ISO cursor syntax.</span></span>  
  
-   <span data-ttu-id="0edd3-172">API-функции курсоров базы данных.</span><span class="sxs-lookup"><span data-stu-id="0edd3-172">Database application programming interface (API) cursor functions</span></span>  
  
     [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="0edd3-173">поддерживает функциональность курсоров для следующих API-интерфейсов баз данных:</span><span class="sxs-lookup"><span data-stu-id="0edd3-173">supports the cursor functionality of these database APIs:</span></span>  
  
    -   <span data-ttu-id="0edd3-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object);</span><span class="sxs-lookup"><span data-stu-id="0edd3-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object)</span></span>  
  
    -   <span data-ttu-id="0edd3-175">OLE DB</span><span class="sxs-lookup"><span data-stu-id="0edd3-175">OLE DB</span></span>  
  
    -   <span data-ttu-id="0edd3-176">открытый интерфейс доступа к базам данных (ODBC).</span><span class="sxs-lookup"><span data-stu-id="0edd3-176">ODBC (Open Database Connectivity)</span></span>  
  
 <span data-ttu-id="0edd3-177">Оба этих способа никогда не должны использоваться в приложении одновременно.</span><span class="sxs-lookup"><span data-stu-id="0edd3-177">An application should never mix these two methods of requesting a cursor.</span></span> <span data-ttu-id="0edd3-178">Приложение, применяющее API-интерфейс для определения режима работы курсоров, не может затем выполнить инструкцию [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR для запроса нового курсора [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0edd3-178">An application that has used the API to specify cursor behaviors should not then execute a [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR statement to also request a [!INCLUDE[tsql](../includes/tsql-md.md)] cursor.</span></span> <span data-ttu-id="0edd3-179">Инструкция DECLARE CURSOR может использоваться только в том случае, если все атрибуты API-курсоров будут установлены в значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0edd3-179">An application should only execute DECLARE CURSOR if it has set all the API cursor attributes back to their defaults.</span></span>  
  
 <span data-ttu-id="0edd3-180">Если не был запрошен ни [!INCLUDE[tsql](../includes/tsql-md.md)] , ни API-курсор, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] целиком возвращает по умолчанию результирующий набор приложению (это называется результирующим набором по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="0edd3-180">If neither a [!INCLUDE[tsql](../includes/tsql-md.md)] nor API cursor has been requested, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] defaults to returning a complete result set, known as a default result set, to the application.</span></span>  
  
## <a name="cursor-process"></a><span data-ttu-id="0edd3-181">Обработка курсоров</span><span class="sxs-lookup"><span data-stu-id="0edd3-181">Cursor Process</span></span>  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="0edd3-182">и API-курсоры имеют различный синтаксис, но для всех курсоров [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] используется одинаковый цикл обработки.</span><span class="sxs-lookup"><span data-stu-id="0edd3-182">cursors and API cursors have different syntax, but the following general process is used with all [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cursors:</span></span>  
  
1.  <span data-ttu-id="0edd3-183">Связать курсор с результирующим набором инструкции [!INCLUDE[tsql](../includes/tsql-md.md)] и задать его характеристики (например возможность обновления строк).</span><span class="sxs-lookup"><span data-stu-id="0edd3-183">Associate a cursor with the result set of a [!INCLUDE[tsql](../includes/tsql-md.md)] statement, and define characteristics of the cursor, such as whether the rows in the cursor can be updated.</span></span>  
  
2.  <span data-ttu-id="0edd3-184">Выполнить инструкцию [!INCLUDE[tsql](../includes/tsql-md.md)] для заполнения курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-184">Execute the [!INCLUDE[tsql](../includes/tsql-md.md)] statement to populate the cursor.</span></span>  
  
3.  <span data-ttu-id="0edd3-185">Получить в курсор необходимые строки.</span><span class="sxs-lookup"><span data-stu-id="0edd3-185">Retrieve the rows in the cursor you want to see.</span></span> <span data-ttu-id="0edd3-186">Операция получения в курсор одной и более строк называется выборкой.</span><span class="sxs-lookup"><span data-stu-id="0edd3-186">The operation to retrieve one row or one block of rows from a cursor is called a fetch.</span></span> <span data-ttu-id="0edd3-187">Выполнение серии выборок для получения строк в прямом или обратном направлении называется прокруткой.</span><span class="sxs-lookup"><span data-stu-id="0edd3-187">Performing a series of fetches to retrieve rows in either a forward or backward direction is called scrolling.</span></span>  
  
4.  <span data-ttu-id="0edd3-188">При необходимости выполнить операции изменения (обновления или удаления) строки в текущей позиции курсора.</span><span class="sxs-lookup"><span data-stu-id="0edd3-188">Optionally, perform modification operations (update or delete) on the row at the current position in the cursor.</span></span>  
  
5.  <span data-ttu-id="0edd3-189">Закрыть курсор.</span><span class="sxs-lookup"><span data-stu-id="0edd3-189">Close the cursor.</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="0edd3-190">См. также</span><span class="sxs-lookup"><span data-stu-id="0edd3-190">Related Content</span></span>  
 <span data-ttu-id="0edd3-191">[Режимы работы курсоров](native-client-odbc-cursors/cursor-behaviors.md) [Способы реализации курсоров](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span><span class="sxs-lookup"><span data-stu-id="0edd3-191">[Cursor Behaviors](native-client-odbc-cursors/cursor-behaviors.md) [How Cursors Are Implemented](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0edd3-192">См. также:</span><span class="sxs-lookup"><span data-stu-id="0edd3-192">See Also</span></span>  
 <span data-ttu-id="0edd3-193">[ОБЪЯВИТь курсор &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="0edd3-193">[DECLARE CURSOR &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span></span>  
 <span data-ttu-id="0edd3-194">[Курсоры (Transact-SQL)](/sql/t-sql/language-elements/cursors-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="0edd3-194">[Cursors &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span></span>  
 <span data-ttu-id="0edd3-195">[Функции курсора &#40;&#41;Transact-SQL](/sql/t-sql/functions/cursor-functions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="0edd3-195">[Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql) </span></span>  
 [<span data-ttu-id="0edd3-196">Хранимые процедуры курсора (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="0edd3-196">Cursor Stored Procedures &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/cursor-stored-procedures-transact-sql)  
  
  
