---
title: Восстановление резервной копии базы данных (SQL Server Management Studio) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
f1_keywords:
- sql12.swb.locatebackupfileazure.f1
- sql12.swb.specifybackup.f1
helpviewer_keywords:
- full backups [SQL Server]
- database restores [SQL Server], full backups
- backing up databases [SQL Server], full backups
- database backups [SQL Server], full backups
- restoring databases [SQL Server], full backups
ms.assetid: 24b3311d-5ce0-4581-9a05-5c7c726c7b21
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 82c3c7191ab686550885ebdc050f5fb1ac818cb9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666689"
---
# <a name="restore-a-database-backup-sql-server-management-studio"></a>Восстановление резервной копии базы данных (среда SQL Server Management Studio)
  Этот раздел содержит сведения о восстановлении полной резервной копии базы данных.  
  
> [!IMPORTANT]  
>  Перед восстановлением базы данных в среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] по модели полного восстановления или модели восстановления с неполным протоколированием необходимо выполнить резервное копирование журнала активных транзакций (известного как заключительный фрагмент журнала). Дополнительные сведения см. в статье [Создание резервной копии журнала транзакций (SQL Server)](back-up-a-transaction-log-sql-server.md)). Чтобы восстановить зашифрованную базу данных, необходимо иметь доступ к сертификату или асимметричному ключу, который использовался для шифрования базы данных. Без сертификата или асимметричного ключа восстановить базу данных нельзя. Поэтому сертификат, используемый для шифрования ключа шифрования базы данных, должен храниться в течение всего времени, пока есть необходимость в резервной копии. Дополнительные сведения см. в статье [SQL Server Certificates and Asymmetric Keys](../security/sql-server-certificates-and-asymmetric-keys.md).  
  
 Обратите внимание, что, если восстановить базы данных [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или более поздней версии на сервер [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], эти базы данных будут автоматически обновлены. Как правило, база данных сразу становится доступной. Однако если база данных [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] содержит полнотекстовые индексы, то в процессе обновления будет произведен их импорт, сброс или перестроение, в зависимости от установленного значения свойства сервера **Режим обновления полнотекстового каталога** . Если при обновлении выбран режим **Импортировать** или **Перестроить**, то полнотекстовые индексы во время обновления будут недоступны. В зависимости от объема индексируемых данных процесс импорта может занять несколько часов, а перестроение — в несколько (до десяти) раз больше. Обратите внимание, что если при обновлении выбран режим **Импортировать**, а полнотекстовый каталог недоступен, то связанные с ним полнотекстовые индексы будут перестроены. Сведения о просмотре и изменении параметра **Режим обновления полнотекстового поиска** см. в статье [Наблюдение за полнотекстовым поиском для экземпляра сервера и управление им](../search/manage-and-monitor-full-text-search-for-a-server-instance.md).  
  
### <a name="to-restore-a-full-database-backup"></a>Восстановление полной резервной копии базы данных  
  
1.  После подключения к соответствующему экземпляру компонента [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] в обозревателе объектов разверните дерево сервера, щелкнув имя сервера.  
  
2.  Разверните узел **Базы данных**. В зависимости от типа восстанавливаемой базы данных выберите пользовательскую базу данных или раскройте узел **Системные базы данных**и выберите системную базу данных.  
  
3.  Щелкните правой кнопкой мыши базу данных, наведите указатель на пункт **задачи**, выберите пункт **восстановить**, а затем выберите пункт **база данных**, после чего откроется диалоговое окно **Восстановление базы данных** .  
  
4.  Чтобы указать источник и расположение восстанавливаемых резервных наборов данных, используйте страницу **Общие** , раздел **Источник** . Выберите один из следующих вариантов.  
  
    -   **База данных**  
  
         Выберите из раскрывающегося списка базу данных для восстановления. Данный список содержит только базы данных, резервное копирование которых было выполнено в соответствии с журналом резервного копирования **msdb** .  
  
    > [!NOTE]  
    >  Если резервная копия была получена с другого сервера, на целевом сервере не будет журнала резервного копирования для указанной базы данных. В этом случае щелкните пункт **Устройство** , чтобы вручную указать файл или устройство для восстановления.  
  
    -   **Устройство**  
  
         Нажмите кнопку обзора ( **...** ), после чего откроется диалоговое окно **Выбор устройств резервного копирования** . В окне **Тип носителя резервной копии** выберите один из перечисленных типов устройств. Чтобы выбрать одно или несколько устройств в окне **Носитель резервной копии** , нажмите кнопку **Добавить**.  
  
         После добавления нужных устройств в списке **Носитель резервной копии** нажмите кнопку **ОК** для возвращения на страницу **Общие** .  
  
         В списке **Источник: Устройство: База данных** выберите имя базы данных, из которой нужно восстановить резервные копии.  
  
        > [!NOTE]  
        >  Данный список доступен, только если выбран параметр **Устройство** . Будут выбраны только те базы данных, резервные копии которых доступны на выбранном устройстве.  
  
         **Носитель резервной копии**  
         Выберите носитель для операции восстановления: **файл**, **Лента**, **URL-адрес**или **устройство резервного копирования**. Параметр **Лента** появляется только в случае, если на компьютере установлен ленточный накопитель, а параметр **Устройство резервного копирования** — только в случае, если имеется хотя бы одно устройство резервного копирования.  
  
         **Расположение резервной копии**  
         Просмотрите, добавьте или удалите носители для операции восстановления. Список может содержать до 64 файлов, лент или устройств резервного копирования.  
  
         **Добавление**  
         Добавляет расположение устройства резервного копирования в список **Расположение резервной копии** . В зависимости от типа носителя данных, выбранного в поле **Носитель резервной копии** , при нажатии на кнопку **Добавить** открывается одно из следующих диалоговых окон.  
  
        |Тип носителя данных|.|Описание|  
        |----------------|----------------|-----------------|  
        |**Файл**|**Локальный файл резервной копии**|В данном диалоговом окне можно выбрать локальный файл из дерева или указать удаленный файл, используя его полное имя в формате UNC. Дополнительные сведения см. в разделе [Устройства резервного копирования (SQL Server)](backup-devices-sql-server.md).|  
        |**Устройство**|**Выбор устройства резервного копирования**|В данном диалоговом окне из списка можно выбрать логические устройства резервного копирования, определенные на экземпляре сервера.|  
        |**Лента**|**Выбор ленты с резервной копией**|В данном диалоговом окне из списка можно выбрать ленточные накопители, физически подключенные к компьютеру, на котором запущен экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].|  
        |**URL-адрес**|Откроются два диалоговых окна в следующем порядке.<br /><br /> 1) **Подключение к службе хранилища Azure**<br /><br /> 2. **Размещение файла резервной копии в Azure**|В диалоговом окне **Подключение к службе хранилища Azure** выберите существующие учетные данные SQL, в которых хранятся имя учетной записи хранения Azure и сведения о ключах доступа, либо создайте новые учетные данные SQL, указав имя учетной записи хранения и сведения о ключе доступа к хранилищу. Дополнительные сведения см. [в статье подключение к службе хранилища Azure &#40;восстановление&#41;](connect-to-microsoft-azure-storage-restore.md).<br /><br /> В диалоговом окне **Локальный файл резервной копии** можно выбрать файл из списка контейнеров, отображаемого в рамке слева.|  
  
         Если список полон, то кнопка **Добавить** будет недоступна.  
  
         **Удалить**  
         Удаляет один или несколько выбранных файлов, лент или устройств резервного копирования.  
  
         **Contents**  
         Отображает содержимое носителя выбранного файла, ленты или устройства резервного копирования.  
  
5.  В разделе **Назначение** , в поле **База данных** автоматически появится имя базы данных для восстановления. Для изменения имени базы данных введите новое имя в окно **База данных** .  
  
6.  В поле **Восстановить до** оставьте значение по умолчанию **До последней выбранной резервной копии** или щелкните **Временную шкалу** , чтобы перейти в диалоговое окно **Временная шкала резервной копии** и выбрать вручную конкретное пороговое время восстановления. Дополнительные сведения о назначении конкретного момента времени см. в разделе [Backup Timeline](backup-timeline.md).  
  
7.  В сетке **Резервные наборы данных для восстановления** выберите нужные резервные наборы. В этой сетке отображаются резервные копии, доступные в указанном месте. По умолчанию предлагается план восстановления. Чтобы переопределить предложенный план восстановления, можно изменить выбранные элементы в сетке. Выбор всех резервных копий, которые зависят от восстановления более ранних копий, отменяется автоматически, как только отменяется выбор более ранних копий. Дополнительные сведения о столбцах сетки **Резервные наборы данных для восстановления** см. в статье [Восстановление базы данных (страница "Общие")](../../integration-services/general-page-of-integration-services-designers-options.md).  
  
8.  При необходимости нажмите кнопку **Файлы** на панели **Выбор страницы** и перейдите в диалоговое окно **Файлы** . Отсюда можно восстановить базу данных в новое расположение, определив новое место восстановления для каждого файла в сетке **Восстановить файлы базы данных как** . Дополнительные сведения об этой сетке см. в разделе [Восстановление базы данных (страница "Файлы")](restore-database-files-page.md).  
  
9. Чтобы просмотреть или выбрать дополнительные параметры, на странице **Параметры** на панели **Параметры восстановления** вберите любой из следующих параметров, если он подходит к данной ситуации.  
  
    1.  Параметры `WITH` (необязательно)  
  
        -   **Перезаписать существующую базу данных (WITH REPLACE)**  
  
        -   **Сохранить параметры репликации (WITH KEEP_REPLICATION)**  
  
        -   **Ограничить доступ к восстановленной базе данных (WITH RESTRICTED_USER)**  
  
    2.  Выберите параметр в поле **Состояние восстановления** . В данном окне определяется состояние базы данных после операции восстановления.  
  
        -   По умолчанию установлена схема**RESTORE WITH RECOVERY** , при этом база данных находится в готовом состоянии для использования путем отката незафиксированных транзакций. Невозможно восстановить дополнительные журналы транзакций. Выберите данный параметр, если выполняется восстановление всех необходимых резервных копий.  
  
        -   Схема**RESTORE WITH NORECOVERY** оставляет базу данных в нерабочем состоянии и не выполняет откат незафиксированных транзакций. Можно восстановить дополнительные журналы транзакций. База данных не может быть использована, пока не будет восстановлена.  
  
        -   Схема**RESTORE WITH STANDBY** оставляет базу данных в режиме только для чтения. С помощью данного параметра можно отменить незафиксированные транзакции и сохранить отмененные действия в резервном файле, чтобы результаты восстановления можно было отменить.  
  
    3.  Настройка **Создать резервную копию заключительного фрагмента журнала перед восстановлением** будет выбрана, если это необходимо для указанного вами момента времени. Нет необходимости изменять данную настройку, однако вы можете выбрать резервное копирование заключительного фрагмента журнала, даже если выполнение этого не требуется. имя файла? Если первый резервный набор данных на странице **Общие** находится в Azure, то будет также создана резервная копия заключительного фрагмента журнала в том же контейнере хранилища.  
  
    4.  Если имеются активные соединения с базой данных, то операция восстановления может завершиться ошибкой. Проверьте окно **Закрыть существующие соединения** и убедитесь, что все активные соединения между [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] и базой данных закрыты. Этот параметр переводит базу данных в однопользовательский режим перед началом выполнения процедуры восстановления, а затем возвращает в многопользовательский режим после ее завершения.  
  
    5.  Установите флажок **Выдавать запрос перед восстановлением каждой резервной копии** , если хотите отследить каждую операцию восстановления. Обычно это не требуется, за исключением случаев, если необходимо наблюдать за состоянием операции восстановления базы данных большого объема.  
  
     Дополнительные сведения об этих параметрах восстановления см. в разделе [Восстановление базы данных (страница "Параметры")](restore-database-options-page.md).  
  
10. [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
## <a name="see-also"></a>См. также:  
 [Создание резервной копии журнала транзакций (SQL Server)](back-up-a-transaction-log-sql-server.md)   
 [Создание полной резервной копии базы данных (SQL Server)](create-a-full-database-backup-sql-server.md)   
 [Восстановление базы данных в новое место (SQL Server)](restore-a-database-to-a-new-location-sql-server.md)   
 [Восстановление резервной копии журнала транзакций (SQL Server)](restore-a-transaction-log-backup-sql-server.md)   
 [RESTORE (Transact-SQL)](/sql/t-sql/statements/restore-statements-transact-sql)   
 [Восстановление базы данных (страница "Параметры")](restore-database-options-page.md)   
 [Восстановление базы данных (страница "Общие")](../../integration-services/general-page-of-integration-services-designers-options.md)  
  
  
