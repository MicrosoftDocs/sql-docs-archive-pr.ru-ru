---
title: Зеркальные наборы носителей резервных копий | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- recovery [SQL Server], mirrored backups
- mirrored media sets [SQL Server]
- backup mirrors [SQL Server]
- duplicate backup copies
- interchangeable backup copies [SQL Server]
- media sets [SQL Server], mirrored backup media sets
- backup media [SQL Server], mirrored media
ms.assetid: 05a0b8d1-3585-4f77-972f-69d1c0d4aa9b
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: ce3513c67a0087dd00021de75f360b19819b46db
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668389"
---
# <a name="mirrored-backup-media-sets-sql-server"></a><span data-ttu-id="ac383-102">Зеркальные наборы носителей резервных копий (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ac383-102">Mirrored Backup Media Sets (SQL Server)</span></span>
    
> [!NOTE]  
>  <span data-ttu-id="ac383-103">Зеркальные наборы носителей резервной копии поддерживаются только в выпуске [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Enterprise.</span><span class="sxs-lookup"><span data-stu-id="ac383-103">Mirrored backup media sets are supported only in the Enterprise edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="ac383-104">Зеркальное отображение набора носителей повышает надежность резервного копирования за счет уменьшения влияния сбоев в работе устройства резервного копирования на сохранность резервной копии.</span><span class="sxs-lookup"><span data-stu-id="ac383-104">Mirroring a media set increases backup reliability by reducing the impact of backup-device malfunctions.</span></span> <span data-ttu-id="ac383-105">Эти сбои имеют особо серьезное значение, поскольку резервные копии являются последней линией обороны перед потерей данных.</span><span class="sxs-lookup"><span data-stu-id="ac383-105">These malfunctions are very serious because backups are the last line of defense against data loss.</span></span> <span data-ttu-id="ac383-106">По мере роста баз данных в объеме увеличивается вероятность того, что сбой в работе устройства резервного копирования или носителя сделает резервную копию невосстановимой.</span><span class="sxs-lookup"><span data-stu-id="ac383-106">As databases grow, the probability increases that a failure of a backup device or media will make a backup nonrestorable.</span></span> <span data-ttu-id="ac383-107">Зеркальное отображение носителей резервных копий повышает надежность резервных копий за счет избыточности.</span><span class="sxs-lookup"><span data-stu-id="ac383-107">Mirroring backup media increases the reliability of backups by providing redundancy.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ac383-108">Общие сведения о наборах носителей см. в разделе [Наборы носителей, семейства носителей и резервные наборы данных (SQL Server)](media-sets-media-families-and-backup-sets-sql-server.md)Enterprise.</span><span class="sxs-lookup"><span data-stu-id="ac383-108">For information about media sets in general, see [Media Sets, Media Families, and Backup Sets &#40;SQL Server&#41;](media-sets-media-families-and-backup-sets-sql-server.md).</span></span>  
  
 <span data-ttu-id="ac383-109">**В этом разделе.**</span><span class="sxs-lookup"><span data-stu-id="ac383-109">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="ac383-110">Общие сведения о зеркальных наборах носителей</span><span class="sxs-lookup"><span data-stu-id="ac383-110">Overview of Mirrored Media Sets</span></span>](#OverviewofMirroredMediaSets)  
  
-   [<span data-ttu-id="ac383-111">Требования к оборудованию для зеркальных резервных копий</span><span class="sxs-lookup"><span data-stu-id="ac383-111">Hardware Requirements for Backup Mirrors</span></span>](#HardwareReqs)  
  
-   [<span data-ttu-id="ac383-112">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="ac383-112">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="overview-of-mirrored-media-sets"></a><a name="OverviewofMirroredMediaSets"></a> <span data-ttu-id="ac383-113">Общие сведения о зеркальных наборах носителей</span><span class="sxs-lookup"><span data-stu-id="ac383-113">Overview of Mirrored Media Sets</span></span>  
 <span data-ttu-id="ac383-114">Зеркальное отображение носителей является свойством набора носителей.</span><span class="sxs-lookup"><span data-stu-id="ac383-114">Media mirroring is a property of the media set.</span></span> <span data-ttu-id="ac383-115">*Зеркальный набор носителей* состоит из нескольких копий (*зеркал*) набора носителей.</span><span class="sxs-lookup"><span data-stu-id="ac383-115">A *mirrored media set* consists of multiple copies (*mirrors*) of the media set.</span></span> <span data-ttu-id="ac383-116">Набор носителей состоит из одной или нескольких семейств носителей, каждое из которых соответствует устройству резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="ac383-116">A media set contains one or more media families, each of which corresponds to a backup device.</span></span> <span data-ttu-id="ac383-117">Например, если предложение TO инструкции BACKUP DATABASE содержит три устройства, то BACKUP распределяет данные между трех семейств носителей, по одной на устройство.</span><span class="sxs-lookup"><span data-stu-id="ac383-117">For example, if the TO clause of a BACKUP DATABASE statement lists three devices, BACKUP spreads the data among three media families, one per device.</span></span> <span data-ttu-id="ac383-118">Количество семейств носителей и зеркал определяется при создании набора носителей (при помощи инструкции BACKUP DATABASE с параметром WITH FORMAT).</span><span class="sxs-lookup"><span data-stu-id="ac383-118">The number of media families and mirrors is defined when the media set is created (by a BACKUP DATABASE statement that specifies WITH FORMAT).</span></span>  
  
 <span data-ttu-id="ac383-119">Зеркальный набор носителей может иметь от двух до четырех зеркал.</span><span class="sxs-lookup"><span data-stu-id="ac383-119">A mirrored media set possesses from two to four mirrors.</span></span> <span data-ttu-id="ac383-120">Каждое зеркало содержит все семейства носителей набора носителей.</span><span class="sxs-lookup"><span data-stu-id="ac383-120">Each mirror contains all the media families in the media set.</span></span> <span data-ttu-id="ac383-121">Для зеркал необходимо одинаковое количество устройств, по одному на семейство носителей.</span><span class="sxs-lookup"><span data-stu-id="ac383-121">The mirrors require the same number of devices, one per media family.</span></span> <span data-ttu-id="ac383-122">Для каждого зеркала необходимо отдельное устройство резервного копирования для каждого семейства носителей.</span><span class="sxs-lookup"><span data-stu-id="ac383-122">Each mirror requires a separate backup device for each media family.</span></span> <span data-ttu-id="ac383-123">Например, зеркальный набор носителей, содержащий четыре семейства носителей с тремя зеркалами, должен иметь двенадцать устройств резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="ac383-123">For example, a mirrored media set that consists of four media families with three mirrors requires twelve backup devices.</span></span> <span data-ttu-id="ac383-124">Все эти устройства должны быть эквивалентными.</span><span class="sxs-lookup"><span data-stu-id="ac383-124">All of these devices must be equivalent.</span></span> <span data-ttu-id="ac383-125">Например, накопители на магнитной ленте должны быть одинаковой модели и сделанными одним производителем.</span><span class="sxs-lookup"><span data-stu-id="ac383-125">For example, tape drives that have the same model number from the same manufacturer.</span></span>  
  
 <span data-ttu-id="ac383-126">На рисунке ниже показан пример зеркального набора носителей, состоящий из двух семейств носителей с двумя зеркалами.</span><span class="sxs-lookup"><span data-stu-id="ac383-126">The following illustration shows an example of a mirrored media set that consists of two media families with two mirrors.</span></span> <span data-ttu-id="ac383-127">Каждое семейство носителей содержит три тома, резервное копирование которых производится однократно на каждом зеркале.</span><span class="sxs-lookup"><span data-stu-id="ac383-127">Each media family contains three media volumes, which are backed up one time per mirror.</span></span>  
  
 <span data-ttu-id="ac383-128">![Зеркальный набор носителей: два семейства с двумя зеркальными копиями](../../database-engine/media/bnr-backup-media-mirror.gif "Зеркальный набор носителей: два семейства с двумя зеркальными копиями")</span><span class="sxs-lookup"><span data-stu-id="ac383-128">![Mirrored media set: two families with two mirrors](../../database-engine/media/bnr-backup-media-mirror.gif "Mirrored media set: two families with two mirrors")</span></span>  
  
 <span data-ttu-id="ac383-129">Соответствующие тома на зеркалах имеют идентичное содержимое.</span><span class="sxs-lookup"><span data-stu-id="ac383-129">Corresponding volumes on the mirrors have identical contents.</span></span> <span data-ttu-id="ac383-130">Это делает их взаимозаменяемыми при восстановлении.</span><span class="sxs-lookup"><span data-stu-id="ac383-130">This makes them interchangeable at restore time.</span></span> <span data-ttu-id="ac383-131">Например, на предыдущем рисунке третий том носителя tape2 является взаимозаменяемым с третьим томом носителя tape0.</span><span class="sxs-lookup"><span data-stu-id="ac383-131">For example, in the previous illustration, the third volume of tape2 is interchangeable with the third volume of tape0.</span></span>  
  
 <span data-ttu-id="ac383-132">Компонент [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] посредством синхронизации записей на устройствах обеспечивает идентичность содержимого на зеркально отображенных носителях.</span><span class="sxs-lookup"><span data-stu-id="ac383-132">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] guarantees that the mirrored media have identical contents by synchronizing writes to the devices.</span></span> <span data-ttu-id="ac383-133">Окончание заполнения любого из зеркал означает, что заполнены все зеркала.</span><span class="sxs-lookup"><span data-stu-id="ac383-133">When any one of the mirrors fills, all the mirrors are spanned at one time.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ac383-134">Зеркальный набор данных не может быть неявно разбит (разделен) удалением зеркала.</span><span class="sxs-lookup"><span data-stu-id="ac383-134">A mirrored media set cannot be implicitly broken (split) by removing a mirror.</span></span> <span data-ttu-id="ac383-135">Если какой-либо из накопителей на магнитной ленте или диск в зеркале поврежден или переформатирован, зеркало более непригодно для дополнительных резервных копий.</span><span class="sxs-lookup"><span data-stu-id="ac383-135">If any tape or disk in a mirror is damaged or reformatted, the mirror is no longer usable for additional backups.</span></span> <span data-ttu-id="ac383-136">Если хотя бы одно полное зеркало остается нетронутым, данные с набора носителей могут быть считаны.</span><span class="sxs-lookup"><span data-stu-id="ac383-136">If at least one full mirror remains intact, the media set can be read.</span></span> <span data-ttu-id="ac383-137">Если в каждом зеркале утрачено данное семейство носителей, набор носителей бесполезен.</span><span class="sxs-lookup"><span data-stu-id="ac383-137">If every mirror loses a given media family, the media set is useless.</span></span>  
  
 <span data-ttu-id="ac383-138">Операции резервного копирования и восстановления предъявляют разные требования на предмет обязательности наличия всех зеркал.</span><span class="sxs-lookup"><span data-stu-id="ac383-138">Backup and restore operations impose different requirements on whether all the mirrors must be present.</span></span> <span data-ttu-id="ac383-139">При выполнении операции резервного копирования для записи (то есть создания или расширения) зеркального набора носителей требуется наличие всех зеркал.</span><span class="sxs-lookup"><span data-stu-id="ac383-139">For a backup operation to write (that is, to create or extend) a mirrored media set, all the mirrors must be present.</span></span> <span data-ttu-id="ac383-140">При восстановлении из копии на зеркальном наборе носителей, напротив, можно указать по одному зеркалу для каждого семейства носителей.</span><span class="sxs-lookup"><span data-stu-id="ac383-140">In contrast, when you are restoring a backup from a mirrored media set, you can specify only a single mirror for each media family.</span></span> <span data-ttu-id="ac383-141">Восстановление можно осуществлять с меньшего числа устройств, чем число имеющихся семейств носителей, но каждое семейство носителей обрабатывается лишь один раз.</span><span class="sxs-lookup"><span data-stu-id="ac383-141">You can restore from fewer devices than families, but each media family is processed only one time.</span></span> <span data-ttu-id="ac383-142">Но в случае ошибок наличие других зеркальных носителей позволяет быстро устранить некоторые проблемы восстановления.</span><span class="sxs-lookup"><span data-stu-id="ac383-142">In the presence of errors, however, having the other mirrors enables some restore problems to be resolved quickly.</span></span> <span data-ttu-id="ac383-143">Поврежденный том носителя можно заменить соответствующим томом с другого зеркала.</span><span class="sxs-lookup"><span data-stu-id="ac383-143">You can substitute a damaged media volume with the corresponding volume from another mirror.</span></span> <span data-ttu-id="ac383-144">Так происходит потому, что RESTORE и RESTORE VERIFYONLY поддерживают замену поврежденного носителя соответствующим томом носителя резервной копии с другого зеркала.</span><span class="sxs-lookup"><span data-stu-id="ac383-144">This is because RESTORE and RESTORE VERIFYONLY support substitution of damaged media with the corresponding backup-media volume from another mirror.</span></span>  
  
##  <a name="hardware-requirements-for-backup-mirrors"></a><a name="HardwareReqs"></a> <span data-ttu-id="ac383-145">Требования к оборудованию для зеркальных резервных копий</span><span class="sxs-lookup"><span data-stu-id="ac383-145">Hardware Requirements for Backup Mirrors</span></span>  
 <span data-ttu-id="ac383-146">Зеркальное отображение применяется к дискам и накопителям на магнитной ленте (на дисках не поддерживается использование дополнительных лент).</span><span class="sxs-lookup"><span data-stu-id="ac383-146">Mirroring applies both to disk and tape (disks do not support continuation tapes).</span></span> <span data-ttu-id="ac383-147">Все устройства резервного копирования для отдельной операции резервного копирования или восстановления должны быть одного типа — диск или накопитель на магнитной ленте.</span><span class="sxs-lookup"><span data-stu-id="ac383-147">All backup devices for a single backup or restore operation must be of the same type, disk or tape.</span></span>  
  
 <span data-ttu-id="ac383-148">В рамках этих двух классов следует использовать сходные устройства, имеющие одни и те же свойства.</span><span class="sxs-lookup"><span data-stu-id="ac383-148">Within these broader classes, you must use similar devices that have the same properties.</span></span> <span data-ttu-id="ac383-149">При недостаточной степени сходства устройств выдается сообщение об ошибке (3212).</span><span class="sxs-lookup"><span data-stu-id="ac383-149">Insufficiently similar devices generate an error message (3212).</span></span> <span data-ttu-id="ac383-150">Во избежание возможной несовместимости устройств используйте устройства, являющиеся равноценными, то есть только носители одной модели от одного производителя.</span><span class="sxs-lookup"><span data-stu-id="ac383-150">To avoid the risk of a device mismatch, use devices that are equivalent, such as, only drives with the same model number from the same manufacturer.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="ac383-151">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="ac383-151">Related Tasks</span></span>  
 <span data-ttu-id="ac383-152">**Создание резервных копий на зеркальных устройствах резервного копирования**</span><span class="sxs-lookup"><span data-stu-id="ac383-152">**To back up to mirrored backup devices**</span></span>  
  
-   [<span data-ttu-id="ac383-153">Создание резервной копии на зеркальном наборе носителей (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="ac383-153">Back Up to a Mirrored Media Set &#40;Transact-SQL&#41;</span></span>](back-up-to-a-mirrored-media-set-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="ac383-154">См. также:</span><span class="sxs-lookup"><span data-stu-id="ac383-154">See Also</span></span>  
 <span data-ttu-id="ac383-155">[Возможные ошибки носителей во время резервного копирования и восстановления (SQL Server)](possible-media-errors-during-backup-and-restore-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="ac383-155">[Possible Media Errors During Backup and Restore &#40;SQL Server&#41;](possible-media-errors-during-backup-and-restore-sql-server.md) </span></span>  
 <span data-ttu-id="ac383-156">[RESTORE VERIFYONLY (Transact-SQL)](/sql/t-sql/statements/restore-statements-verifyonly-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ac383-156">[RESTORE VERIFYONLY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-verifyonly-transact-sql) </span></span>  
 <span data-ttu-id="ac383-157">[Устройства резервного копирования (SQL Server)](backup-devices-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="ac383-157">[Backup Devices &#40;SQL Server&#41;](backup-devices-sql-server.md) </span></span>  
 [<span data-ttu-id="ac383-158">Наборы носителей, семейства носителей и резервные наборы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ac383-158">Media Sets, Media Families, and Backup Sets &#40;SQL Server&#41;</span></span>](media-sets-media-families-and-backup-sets-sql-server.md)  
  
  
