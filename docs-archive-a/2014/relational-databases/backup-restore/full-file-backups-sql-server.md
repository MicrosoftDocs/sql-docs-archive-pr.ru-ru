---
title: Полные резервные копии файлов (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- full backups [SQL Server]
- backing up [SQL Server], files or filegroups
- backups [SQL Server], files or filegroups
- full recovery model [SQL Server], full file backups
- file backups [SQL Server], full
- files [SQL Server], backing up
- filegroups [SQL Server], backing up
- file backups [SQL Server]
ms.assetid: a716bf8d-0c5a-490d-aadd-597b3b0fac0c
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: e2e45dc68afa4d464aa3931075a1c1b3be792e6f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666705"
---
# <a name="full-file-backups-sql-server"></a><span data-ttu-id="eae4f-102">полные резервные копии файлов (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="eae4f-102">Full File Backups (SQL Server)</span></span>
  <span data-ttu-id="eae4f-103">Сведения, приведенные в этом разделе, относятся только к тем базам данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , которые содержат несколько файлов или файловых групп.</span><span class="sxs-lookup"><span data-stu-id="eae4f-103">This topic is relevant for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases that contain multiple files or filegroups.</span></span>  
  
 <span data-ttu-id="eae4f-104">Резервные копии файлов базы данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] можно создавать и восстанавливать по отдельности.</span><span class="sxs-lookup"><span data-stu-id="eae4f-104">The files in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database can be backed up and restored individually.</span></span> <span data-ttu-id="eae4f-105">Кроме того, можно указать всю файловую группу, а не каждый файл по отдельности.</span><span class="sxs-lookup"><span data-stu-id="eae4f-105">Also, you can specify a whole filegroup instead of specifying each constituent file individually.</span></span> <span data-ttu-id="eae4f-106">Обратите внимание, что если какой-либо файл файловой группы находится в режиме «вне сети» (например во время его восстановления), то вся файловая группа переводится в режим «вне сети», и создать ее резервную копию будет невозможно.</span><span class="sxs-lookup"><span data-stu-id="eae4f-106">Note that if any file in a filegroup is offline (for example, because the file is being restored), the whole filegroup is offline and cannot be backed up.</span></span>  
  
 <span data-ttu-id="eae4f-107">Резервные копии файловых групп, доступных только для чтения, могут совмещаться с частичными резервными копиями.</span><span class="sxs-lookup"><span data-stu-id="eae4f-107">File backups of read-only filegroups can be combined with partial backups.</span></span> <span data-ttu-id="eae4f-108">Частичные резервные копии включают все файловые группы, доступные для чтения и записи, и при необходимости одну или несколько файловых групп, доступных только для чтения.</span><span class="sxs-lookup"><span data-stu-id="eae4f-108">Partial backups include all the read/write filegroups and, optionally, one or more read-only filegroups.</span></span> <span data-ttu-id="eae4f-109">Дополнительные сведения см. в разделе [Частичные резервные копии (SQL Server)](partial-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="eae4f-109">For more information, see [Partial Backups &#40;SQL Server&#41;](partial-backups-sql-server.md).</span></span>  
  
 <span data-ttu-id="eae4f-110">Резервная копия файла может служить *базовой копией для разностного копирования* для разностных резервных копий файлов.</span><span class="sxs-lookup"><span data-stu-id="eae4f-110">A file backup can serve as the *differential base* for differential file backups.</span></span> <span data-ttu-id="eae4f-111">Дополнительные сведения см. в разделе [Разностные резервные копии (SQL Server)](differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="eae4f-111">For more information, see [Differential Backups &#40;SQL Server&#41;](differential-backups-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eae4f-112">Полная резервная копия обычно называется просто *резервной копией файлов*кроме тех случаев, когда она явно соотносится с *разностной резервной копией файлов*.</span><span class="sxs-lookup"><span data-stu-id="eae4f-112">Full file backups are typically called *file backups*, except when they are being explicitly compared with *differential file backups*.</span></span>  
  
 <span data-ttu-id="eae4f-113">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="eae4f-113">**In This Topic:**</span></span>  
  
-   [<span data-ttu-id="eae4f-114">Преимущества резервных копий файлов</span><span class="sxs-lookup"><span data-stu-id="eae4f-114">Benefits of File Backups</span></span>](#Benefits)  
  
-   [<span data-ttu-id="eae4f-115">Недостатки резервных копий файлов</span><span class="sxs-lookup"><span data-stu-id="eae4f-115">Disadvantages of File Backups</span></span>](#Disadvantages)  
  
-   [<span data-ttu-id="eae4f-116">Общие сведения о резервных копиях файлов</span><span class="sxs-lookup"><span data-stu-id="eae4f-116">Overview of File Backups</span></span>](#Overview)  
  
-   [<span data-ttu-id="eae4f-117">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="eae4f-117">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="benefits-of-file-backups"></a><a name="Benefits"></a> <span data-ttu-id="eae4f-118">Преимущества резервных копий файлов</span><span class="sxs-lookup"><span data-stu-id="eae4f-118">Benefits of File Backups</span></span>  
 <span data-ttu-id="eae4f-119">Резервные копии файлов обладают следующими преимуществами по сравнению с полными резервными копиями базы данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-119">File backups offer the following advantages over database backups:</span></span>  
  
-   <span data-ttu-id="eae4f-120">Использование резервных копий файлов может ускорить восстановление, ограничив его восстановлением только поврежденных файлов, а не всей базы данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-120">Using file backups can increase the speed of recovery by letting you restore only damaged files, without restoring the rest of the database.</span></span>  
  
     <span data-ttu-id="eae4f-121">Например, если база данных состоит из нескольких файлов, размещенных на различных дисках, и на одном из них происходит сбой, то восстановить данные нужно будет только на этом диске.</span><span class="sxs-lookup"><span data-stu-id="eae4f-121">For example, if a database consists of several files that are located on different disks and one disk fails, only the file on the failed disk has to be restored.</span></span> <span data-ttu-id="eae4f-122">Поврежденный файл можно быстро восстановить. Эта операция выполняется быстрее, чем при восстановлении всей базы данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-122">The damaged file can be quickly restored, and recovery is faster than it would be for an entire database.</span></span>  
  
-   <span data-ttu-id="eae4f-123">Резервные копии файлов обладают улучшенной гибкостью при выполнении по расписанию и облегчают работу с носителями по сравнению с полными резервными копиями баз данных; последние становятся неудобными для очень больших баз данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-123">File backups increase flexibility in scheduling and media handling over full database backups, which for very large databases can become unmanageable.</span></span> <span data-ttu-id="eae4f-124">Большая гибкость при работе с резервными копиями файлов и файловых групп может оказаться полезной также для больших баз данных, содержащих данные с различными параметрами обновления.</span><span class="sxs-lookup"><span data-stu-id="eae4f-124">The increased flexibility of file or filegroup backups is also useful for large databases that contain data that has varying update characteristics.</span></span>  
  
##  <a name="disadvantages-of-file-backups"></a><a name="Disadvantages"></a> <span data-ttu-id="eae4f-125">Недостатки резервных копий файлов</span><span class="sxs-lookup"><span data-stu-id="eae4f-125">Disadvantages of File Backups</span></span>  
  
-   <span data-ttu-id="eae4f-126">Главным недостатком резервных копий файлов по сравнению с резервным копированием всей базы данных являются дополнительные сложности в администрировании.</span><span class="sxs-lookup"><span data-stu-id="eae4f-126">The primary disadvantage of file backups compared to full database backups is the additional administrative complexity.</span></span> <span data-ttu-id="eae4f-127">Обслуживание полного набора таких резервных копий и их отслеживание может оказаться трудоемкой задачей, потери времени на которую способны перевесить издержки расхода дискового пространства на полные резервные копии баз данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-127">Maintaining and keeping track of a complete set of these backups can be a time-consuming task that might outweigh the space requirements of full database backups.</span></span>  
  
-   <span data-ttu-id="eae4f-128">Сбой носителя может привести к невозможности восстановления всей базы данных, если для поврежденного файла не будет существовать резервной копии.</span><span class="sxs-lookup"><span data-stu-id="eae4f-128">A media failure can make a complete database unrecoverable if a damaged file lacks a backup.</span></span> <span data-ttu-id="eae4f-129">Поэтому необходимо обслуживать полный набор резервных копий файлов, поэтому как для полной модели восстановления, так и для модели с неполным протоколированием одна или несколько резервных копий журнала минимально охватывают интервал между первым и последним полным резервным копированием.</span><span class="sxs-lookup"><span data-stu-id="eae4f-129">You must therefore maintain a complete set of file backups, and, for the full/bulk-logged recovery model, one or more log backups covering minimally the interval between the first full file backup and last full file backup.</span></span>  
  
##  <a name="overview-of-file-backups"></a><a name="Overview"></a> <span data-ttu-id="eae4f-130">Общие сведения о резервных копиях файлов</span><span class="sxs-lookup"><span data-stu-id="eae4f-130">Overview of File Backups</span></span>  
 <span data-ttu-id="eae4f-131">Полное резервное копирование позволяет сохранить все данные, содержащиеся в одной или нескольких файлах или файловых группах.</span><span class="sxs-lookup"><span data-stu-id="eae4f-131">A full file backup backs up all the data in one or more files or filegroups.</span></span> <span data-ttu-id="eae4f-132">По умолчанию резервные копии файлов содержат достаточное количество записей журнала для наката файла в конце операции резервного копирования файлов.</span><span class="sxs-lookup"><span data-stu-id="eae4f-132">By default, file backups contain enough log records to roll forward the file to the end of the backup operation.</span></span>  
  
 <span data-ttu-id="eae4f-133">Создать резервную копию файла или файловой группы, доступную только для чтения, одинаковую для каждой модели восстановления.</span><span class="sxs-lookup"><span data-stu-id="eae4f-133">Backing up a read-only file or filegroup is the same for every recovery model.</span></span> <span data-ttu-id="eae4f-134">При модели полного восстановления полный набор резервных копий файлов совместно с количеством резервных копий журнала, достаточным для охвата всех резервных копий файлов, эквивалентен полной резервной копии базы данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-134">Under the full recovery model, a complete set of full file backups, together with enough log backups to span all the file backups, is the equivalent of a full database backup.</span></span>  
  
 <span data-ttu-id="eae4f-135">Одновременно может выполняться лишь одна операция резервного копирования файлов.</span><span class="sxs-lookup"><span data-stu-id="eae4f-135">Only one file backup operation can occur at a time.</span></span> <span data-ttu-id="eae4f-136">Можно создать резервные копии нескольких файлов за одну операцию, но это может увеличить время восстановления, если нужно восстановить всего один файл.</span><span class="sxs-lookup"><span data-stu-id="eae4f-136">You can back up multiple files in one operation, but this might extend the recovery time if you only have to restore a single file.</span></span> <span data-ttu-id="eae4f-137">Причина этого заключается в необходимости считывания всей резервной копии в поиске нужного файла.</span><span class="sxs-lookup"><span data-stu-id="eae4f-137">This is because to locate that file, the whole backup is read.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eae4f-138">Отдельные файлы могут быть восстановлены из резервной копии базы данных, однако поиск и восстановление файла из резервной копии базы данных займет больше времени, чем из резервной копии файла.</span><span class="sxs-lookup"><span data-stu-id="eae4f-138">Individual files can be restored from a database backup; however, locating and restoring a file takes longer from a database backup than from a file backup.</span></span>  
  
### <a name="file-backups-and-the-simple-recovery-model"></a><span data-ttu-id="eae4f-139">Резервные копии файлов и простая модель восстановления</span><span class="sxs-lookup"><span data-stu-id="eae4f-139">File Backups and the Simple Recovery Model</span></span>  
 <span data-ttu-id="eae4f-140">В простой модели восстановления резервные копии файлов для чтения и записи должны создаваться вместе.</span><span class="sxs-lookup"><span data-stu-id="eae4f-140">Under the simple recovery model, read/write files must all be backed up together.</span></span> <span data-ttu-id="eae4f-141">Это гарантирует восстановление базы данных до согласованного момента времени.</span><span class="sxs-lookup"><span data-stu-id="eae4f-141">This makes sure that the database can be restored to a consistent point in time.</span></span> <span data-ttu-id="eae4f-142">Вместо того чтобы указывать каждый файл или файловую группу для чтения и записи, воспользуйтесь параметром READ_WRITE_FILEGROUPS.</span><span class="sxs-lookup"><span data-stu-id="eae4f-142">Instead of individually specifying each read/write file or filegroup, use the READ_WRITE_FILEGROUPS option.</span></span> <span data-ttu-id="eae4f-143">Этот параметр создает резервные копии всех файловых групп, доступных для чтения и записи, в базе данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-143">This option backs up all the read/write filegroups in the database.</span></span> <span data-ttu-id="eae4f-144">С помощью параметра READ_WRITE_FILEGROUPS создаются так называемой частичной резервной копией.</span><span class="sxs-lookup"><span data-stu-id="eae4f-144">A backup that is created by specifying READ_WRITE_FILEGROUPS is known as a partial backup.</span></span> <span data-ttu-id="eae4f-145">Дополнительные сведения см. в разделе [Частичные резервные копии (SQL Server)](partial-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="eae4f-145">For more information, see [Partial Backups &#40;SQL Server&#41;](partial-backups-sql-server.md).</span></span>  
  
### <a name="file-backups-and-the-full-recovery-model"></a><span data-ttu-id="eae4f-146">Резервные копии файлов и модель полного восстановления</span><span class="sxs-lookup"><span data-stu-id="eae4f-146">File Backups and the Full Recovery Model</span></span>  
 <span data-ttu-id="eae4f-147">В модели полного восстановления необходимо выполнять резервное копирование журналов транзакций отдельно от остальной части стратегии резервирования данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-147">Under the full recovery model, you must back up the transaction log, regardless of the rest of your backup strategy.</span></span> <span data-ttu-id="eae4f-148">Полный набор резервных копий файлов вместе с резервными копиями журналов, которых достаточно для охвата всех резервных копий файлов с момента первого копирования, эквивалентен полной резервной копии базы данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-148">A complete set of full file backups, together with enough log backups to span all the file backups from the start of the first file backup, is the equivalent of a full database backup.</span></span>  
  
 <span data-ttu-id="eae4f-149">Восстановить базу данных лишь из файла и резервных копий журналов может оказаться сложно.</span><span class="sxs-lookup"><span data-stu-id="eae4f-149">Restoring a database using just file and log backups can be complex.</span></span> <span data-ttu-id="eae4f-150">Поэтому лучше выполнить полное резервное копирование базы данных, а затем начать резервное копирование журнала, чем сразу создавать резервную копию файлов.</span><span class="sxs-lookup"><span data-stu-id="eae4f-150">Therefore, if it is possible, it is a best practice to perform a full database backup and start the log backups before the first file backup.</span></span> <span data-ttu-id="eae4f-151">На следующем рисунке показана стратегия, согласно которой создается полная резервная копия базы данных (за время t1) вскоре после создания базы данных (за время t0).</span><span class="sxs-lookup"><span data-stu-id="eae4f-151">The following illustration shows a strategy in which a full database backup is taken (at time t1) soon after the database is created (at time t0).</span></span> <span data-ttu-id="eae4f-152">Эта первая резервная копия базы данных позволяет начать резервное копирование журнала транзакций.</span><span class="sxs-lookup"><span data-stu-id="eae4f-152">This first database backup enables transaction log backups to start.</span></span> <span data-ttu-id="eae4f-153">Резервное копирование журнала транзакций запланировано через определенные промежутки времени.</span><span class="sxs-lookup"><span data-stu-id="eae4f-153">Transaction log backups are scheduled to occur at set intervals.</span></span> <span data-ttu-id="eae4f-154">Резервные копии файлов создаются через некоторый интервал времени, оптимально соответствующий требованиям предприятия.</span><span class="sxs-lookup"><span data-stu-id="eae4f-154">File backups occur at whatever interval best meets the business requirements for the database.</span></span> <span data-ttu-id="eae4f-155">На данном рисунке показана каждая из четырех файловых групп, резервное копирование которых происходит одновременно.</span><span class="sxs-lookup"><span data-stu-id="eae4f-155">This illustration shows each of the four filegroups being backed up one at a time.</span></span> <span data-ttu-id="eae4f-156">Порядок, в котором оно производится (группы A, C, B, A), отражает требования предприятия к базе данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-156">The order in which they are backed up (A, C, B, A) reflects the business requirements of the database.</span></span>  
  
 <span data-ttu-id="eae4f-157">![Стратегия, объединяющая резервное копирование баз данных, файлов и журналов](../../database-engine/media/bnr-rmfull-3-fulldb-filegrps-log-backups.gif "Стратегия, объединяющая резервное копирование баз данных, файлов и журналов")</span><span class="sxs-lookup"><span data-stu-id="eae4f-157">![Strategy combining database, file, and log backups](../../database-engine/media/bnr-rmfull-3-fulldb-filegrps-log-backups.gif "Strategy combining database, file, and log backups")</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eae4f-158">При использовании модели полного восстановления необходимо выполнить накат всех журналов транзакций во время восстановления резервной копии файла для записи и чтения, чтобы обеспечить согласованность состояния файла с остальной частью базы данных.</span><span class="sxs-lookup"><span data-stu-id="eae4f-158">Under the full recovery model, you must roll forward the transaction log when restoring a read/write file backup to make sure that the file is consistent with the rest of the database.</span></span> <span data-ttu-id="eae4f-159">Чтобы избежать необходимости наката большого количества резервных копий журналов транзакций, следует чаще создавать разностные резервные копии файлов.</span><span class="sxs-lookup"><span data-stu-id="eae4f-159">To avoid rolling forward a lot of transaction log backups, consider using differential file backups.</span></span> <span data-ttu-id="eae4f-160">Дополнительные сведения см. в разделе [Разностные резервные копии (SQL Server)](differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="eae4f-160">For more information, see [Differential Backups &#40;SQL Server&#41;](differential-backups-sql-server.md).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="eae4f-161">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="eae4f-161">Related Tasks</span></span>  
 <span data-ttu-id="eae4f-162">**Создание резервных копий файла или файловой группы**</span><span class="sxs-lookup"><span data-stu-id="eae4f-162">**To create a file or filegroup backup**</span></span>  
  
-   [<span data-ttu-id="eae4f-163">Резервное копирование файлов и файловых групп (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="eae4f-163">Back Up Files and Filegroups &#40;SQL Server&#41;</span></span>](back-up-files-and-filegroups-sql-server.md)  
  
-   <span data-ttu-id="eae4f-164"><xref:Microsoft.SqlServer.Management.Smo.Backup.SqlBackup%2A> (SMO)</span><span class="sxs-lookup"><span data-stu-id="eae4f-164"><xref:Microsoft.SqlServer.Management.Smo.Backup.SqlBackup%2A> (SMO)</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eae4f-165">Резервные копии файлов не поддерживаются мастером планов обслуживания.</span><span class="sxs-lookup"><span data-stu-id="eae4f-165">File backups are not supported by the Maintenance Plan Wizard.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="eae4f-166">См. также:</span><span class="sxs-lookup"><span data-stu-id="eae4f-166">See Also</span></span>  
 <span data-ttu-id="eae4f-167">[BACKUP (Transact-SQL)](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="eae4f-167">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 <span data-ttu-id="eae4f-168">[Общие сведения о резервном копировании (SQL Server)](backup-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="eae4f-168">[Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md) </span></span>  
 <span data-ttu-id="eae4f-169">[Резервное копирование и восстановление: взаимодействие и совместимость &#40;SQL Server&#41;](backup-and-restore-interoperability-and-coexistence-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="eae4f-169">[Backup and Restore: Interoperability and Coexistence &#40;SQL Server&#41;](backup-and-restore-interoperability-and-coexistence-sql-server.md) </span></span>  
 <span data-ttu-id="eae4f-170">[Разностные резервные копии (SQL Server)](differential-backups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="eae4f-170">[Differential Backups &#40;SQL Server&#41;](differential-backups-sql-server.md) </span></span>  
 <span data-ttu-id="eae4f-171">[Восстановление файлов (простая модель восстановления)](file-restores-simple-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="eae4f-171">[File Restores &#40;Simple Recovery Model&#41;](file-restores-simple-recovery-model.md) </span></span>  
 <span data-ttu-id="eae4f-172">[Восстановления файлов (модель полного восстановления)](file-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="eae4f-172">[File Restores &#40;Full Recovery Model&#41;](file-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="eae4f-173">[Восстановление в сети (SQL Server)](online-restore-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="eae4f-173">[Online Restore &#40;SQL Server&#41;](online-restore-sql-server.md) </span></span>  
 [<span data-ttu-id="eae4f-174">Поэтапное восстановление (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="eae4f-174">Piecemeal Restores &#40;SQL Server&#41;</span></span>](piecemeal-restores-sql-server.md)  
  
  
