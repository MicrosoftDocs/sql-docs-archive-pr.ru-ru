---
title: Полные резервные копии файлов (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- full backups [SQL Server]
- backing up [SQL Server], files or filegroups
- backups [SQL Server], files or filegroups
- full recovery model [SQL Server], full file backups
- file backups [SQL Server], full
- files [SQL Server], backing up
- filegroups [SQL Server], backing up
- file backups [SQL Server]
ms.assetid: a716bf8d-0c5a-490d-aadd-597b3b0fac0c
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: e2e45dc68afa4d464aa3931075a1c1b3be792e6f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666705"
---
# <a name="full-file-backups-sql-server"></a>полные резервные копии файлов (SQL Server)
  Сведения, приведенные в этом разделе, относятся только к тем базам данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , которые содержат несколько файлов или файловых групп.  
  
 Резервные копии файлов базы данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] можно создавать и восстанавливать по отдельности. Кроме того, можно указать всю файловую группу, а не каждый файл по отдельности. Обратите внимание, что если какой-либо файл файловой группы находится в режиме «вне сети» (например во время его восстановления), то вся файловая группа переводится в режим «вне сети», и создать ее резервную копию будет невозможно.  
  
 Резервные копии файловых групп, доступных только для чтения, могут совмещаться с частичными резервными копиями. Частичные резервные копии включают все файловые группы, доступные для чтения и записи, и при необходимости одну или несколько файловых групп, доступных только для чтения. Дополнительные сведения см. в разделе [Частичные резервные копии (SQL Server)](partial-backups-sql-server.md).  
  
 Резервная копия файла может служить *базовой копией для разностного копирования* для разностных резервных копий файлов. Дополнительные сведения см. в разделе [Разностные резервные копии (SQL Server)](differential-backups-sql-server.md).  
  
> [!NOTE]  
>  Полная резервная копия обычно называется просто *резервной копией файлов*кроме тех случаев, когда она явно соотносится с *разностной резервной копией файлов*.  
  
 **В этом разделе:**  
  
-   [Преимущества резервных копий файлов](#Benefits)  
  
-   [Недостатки резервных копий файлов](#Disadvantages)  
  
-   [Общие сведения о резервных копиях файлов](#Overview)  
  
-   [Связанные задачи](#RelatedTasks)  
  
##  <a name="benefits-of-file-backups"></a><a name="Benefits"></a> Преимущества резервных копий файлов  
 Резервные копии файлов обладают следующими преимуществами по сравнению с полными резервными копиями базы данных.  
  
-   Использование резервных копий файлов может ускорить восстановление, ограничив его восстановлением только поврежденных файлов, а не всей базы данных.  
  
     Например, если база данных состоит из нескольких файлов, размещенных на различных дисках, и на одном из них происходит сбой, то восстановить данные нужно будет только на этом диске. Поврежденный файл можно быстро восстановить. Эта операция выполняется быстрее, чем при восстановлении всей базы данных.  
  
-   Резервные копии файлов обладают улучшенной гибкостью при выполнении по расписанию и облегчают работу с носителями по сравнению с полными резервными копиями баз данных; последние становятся неудобными для очень больших баз данных. Большая гибкость при работе с резервными копиями файлов и файловых групп может оказаться полезной также для больших баз данных, содержащих данные с различными параметрами обновления.  
  
##  <a name="disadvantages-of-file-backups"></a><a name="Disadvantages"></a> Недостатки резервных копий файлов  
  
-   Главным недостатком резервных копий файлов по сравнению с резервным копированием всей базы данных являются дополнительные сложности в администрировании. Обслуживание полного набора таких резервных копий и их отслеживание может оказаться трудоемкой задачей, потери времени на которую способны перевесить издержки расхода дискового пространства на полные резервные копии баз данных.  
  
-   Сбой носителя может привести к невозможности восстановления всей базы данных, если для поврежденного файла не будет существовать резервной копии. Поэтому необходимо обслуживать полный набор резервных копий файлов, поэтому как для полной модели восстановления, так и для модели с неполным протоколированием одна или несколько резервных копий журнала минимально охватывают интервал между первым и последним полным резервным копированием.  
  
##  <a name="overview-of-file-backups"></a><a name="Overview"></a> Общие сведения о резервных копиях файлов  
 Полное резервное копирование позволяет сохранить все данные, содержащиеся в одной или нескольких файлах или файловых группах. По умолчанию резервные копии файлов содержат достаточное количество записей журнала для наката файла в конце операции резервного копирования файлов.  
  
 Создать резервную копию файла или файловой группы, доступную только для чтения, одинаковую для каждой модели восстановления. При модели полного восстановления полный набор резервных копий файлов совместно с количеством резервных копий журнала, достаточным для охвата всех резервных копий файлов, эквивалентен полной резервной копии базы данных.  
  
 Одновременно может выполняться лишь одна операция резервного копирования файлов. Можно создать резервные копии нескольких файлов за одну операцию, но это может увеличить время восстановления, если нужно восстановить всего один файл. Причина этого заключается в необходимости считывания всей резервной копии в поиске нужного файла.  
  
> [!NOTE]  
>  Отдельные файлы могут быть восстановлены из резервной копии базы данных, однако поиск и восстановление файла из резервной копии базы данных займет больше времени, чем из резервной копии файла.  
  
### <a name="file-backups-and-the-simple-recovery-model"></a>Резервные копии файлов и простая модель восстановления  
 В простой модели восстановления резервные копии файлов для чтения и записи должны создаваться вместе. Это гарантирует восстановление базы данных до согласованного момента времени. Вместо того чтобы указывать каждый файл или файловую группу для чтения и записи, воспользуйтесь параметром READ_WRITE_FILEGROUPS. Этот параметр создает резервные копии всех файловых групп, доступных для чтения и записи, в базе данных. С помощью параметра READ_WRITE_FILEGROUPS создаются так называемой частичной резервной копией. Дополнительные сведения см. в разделе [Частичные резервные копии (SQL Server)](partial-backups-sql-server.md).  
  
### <a name="file-backups-and-the-full-recovery-model"></a>Резервные копии файлов и модель полного восстановления  
 В модели полного восстановления необходимо выполнять резервное копирование журналов транзакций отдельно от остальной части стратегии резервирования данных. Полный набор резервных копий файлов вместе с резервными копиями журналов, которых достаточно для охвата всех резервных копий файлов с момента первого копирования, эквивалентен полной резервной копии базы данных.  
  
 Восстановить базу данных лишь из файла и резервных копий журналов может оказаться сложно. Поэтому лучше выполнить полное резервное копирование базы данных, а затем начать резервное копирование журнала, чем сразу создавать резервную копию файлов. На следующем рисунке показана стратегия, согласно которой создается полная резервная копия базы данных (за время t1) вскоре после создания базы данных (за время t0). Эта первая резервная копия базы данных позволяет начать резервное копирование журнала транзакций. Резервное копирование журнала транзакций запланировано через определенные промежутки времени. Резервные копии файлов создаются через некоторый интервал времени, оптимально соответствующий требованиям предприятия. На данном рисунке показана каждая из четырех файловых групп, резервное копирование которых происходит одновременно. Порядок, в котором оно производится (группы A, C, B, A), отражает требования предприятия к базе данных.  
  
 ![Стратегия, объединяющая резервное копирование баз данных, файлов и журналов](../../database-engine/media/bnr-rmfull-3-fulldb-filegrps-log-backups.gif "Стратегия, объединяющая резервное копирование баз данных, файлов и журналов")  
  
> [!NOTE]  
>  При использовании модели полного восстановления необходимо выполнить накат всех журналов транзакций во время восстановления резервной копии файла для записи и чтения, чтобы обеспечить согласованность состояния файла с остальной частью базы данных. Чтобы избежать необходимости наката большого количества резервных копий журналов транзакций, следует чаще создавать разностные резервные копии файлов. Дополнительные сведения см. в разделе [Разностные резервные копии (SQL Server)](differential-backups-sql-server.md).  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> Связанные задачи  
 **Создание резервных копий файла или файловой группы**  
  
-   [Резервное копирование файлов и файловых групп (SQL Server)](back-up-files-and-filegroups-sql-server.md)  
  
-   <xref:Microsoft.SqlServer.Management.Smo.Backup.SqlBackup%2A> (SMO)  
  
> [!NOTE]  
>  Резервные копии файлов не поддерживаются мастером планов обслуживания.  
  
## <a name="see-also"></a>См. также:  
 [BACKUP (Transact-SQL)](/sql/t-sql/statements/backup-transact-sql)   
 [Общие сведения о резервном копировании (SQL Server)](backup-overview-sql-server.md)   
 [Резервное копирование и восстановление: взаимодействие и совместимость &#40;SQL Server&#41;](backup-and-restore-interoperability-and-coexistence-sql-server.md)   
 [Разностные резервные копии (SQL Server)](differential-backups-sql-server.md)   
 [Восстановление файлов (простая модель восстановления)](file-restores-simple-recovery-model.md)   
 [Восстановления файлов (модель полного восстановления)](file-restores-full-recovery-model.md)   
 [Восстановление в сети (SQL Server)](online-restore-sql-server.md)   
 [Поэтапное восстановление (SQL Server)](piecemeal-restores-sql-server.md)  
  
  
