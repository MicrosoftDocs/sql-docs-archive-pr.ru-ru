---
title: Наборы носителей, семейства носителей и резервные наборы данных (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- media sets [SQL Server], about media sets
- backup media [SQL Server], about backup media
- backups [SQL Server], media sets
- media sets [SQL Server]
- media headers [SQL Server]
- backup sets [SQL Server], about backup sets
- backup media [SQL Server], media sets
- backups [SQL Server], media families
- backup media [SQL Server], media families
- media families [SQL Server]
- backups [SQL Server], backup sets
- backup sets [SQL Server]
ms.assetid: 2b8f19a2-ee9d-4120-b194-fbcd2076a489
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 853451ea5a7c43cd073fdf75703b3c4651b442d0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666703"
---
# <a name="media-sets-media-families-and-backup-sets-sql-server"></a><span data-ttu-id="c56c0-102">Наборы носителей, семейства носителей и резервные наборы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c56c0-102">Media Sets, Media Families, and Backup Sets (SQL Server)</span></span>
  <span data-ttu-id="c56c0-103">В настоящем разделе приведена основная терминология, касающаяся носителей резервных копий для резервного копирования и восстановления в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Он предназначен для читателей, впервые знакомящихся с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c56c0-103">This topic introduces the basic backup-media terminology of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backup and restore and is intended for readers who are new to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="c56c0-104">В этом разделе приведено описание формата, используемого в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для носителей резервных копий, соответствия между носителями резервных копий и устройствами резервного копирования, организации резервных копий на носителях резервных копий, а также даны некоторые соображения, касающиеся наборов носителей и семейств носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-104">This topic describes the format that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses for backup media, the correspondence between backup media and backup devices, the organization of backups on backup media, and several considerations for media sets and media families.</span></span> <span data-ttu-id="c56c0-105">Кроме того, в этом разделе описаны шаги инициализации или форматирования носителей резервных копий перед их использованием впервые или использованием для замены старого набора носителей новым набором носителей, а также показано, как перезаписать старые резервные наборы в наборе носителей и как добавить новые резервные наборы к набору носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-105">The topic also describes the steps initializing or formatting backup media before you use it for the first time or replace an old media set with a new media set, how to overwrite old backup sets in a media set, and how to append new backup sets to a media set.</span></span>

> [!NOTE]
>  <span data-ttu-id="c56c0-106">Дополнительные сведения о SQL Server резервного копирования в службу хранилища BLOB-объектов Azure см. в статье [SQL Server резервное копирование и восстановление с помощью службы хранилища BLOB-объектов Azure](sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service.md).</span><span class="sxs-lookup"><span data-stu-id="c56c0-106">For more information on SQL Server backup to the Azure Blob storage service,, see, [SQL Server Backup and Restore with Azure Blob Storage Service](sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service.md).</span></span>


##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="c56c0-107">Термины и определения</span><span class="sxs-lookup"><span data-stu-id="c56c0-107">Terms and Definitions</span></span>
 <span data-ttu-id="c56c0-108">набор носителей Упорядоченный набор носителей данных резервной копии в виде определенного количества ленточных устройств или дисков, на которые может быть записана одна или несколько операций резервного копирования, с использованием фиксированного типа и номера устройств резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-108">media set An ordered collection of backup media, tapes or disk files, to which one or more backup operations have written using a fixed type and number of backup devices.</span></span>

 <span data-ttu-id="c56c0-109">семейство носителей Резервные копии, созданные на одном устройстве без зеркального отображения или на наборе устройств с зеркальным отображением в наборе носителей</span><span class="sxs-lookup"><span data-stu-id="c56c0-109">media family Backups created on a single nonmirrored device or a set of mirrored devices in a media set</span></span>

 <span data-ttu-id="c56c0-110">резервный набор данных Содержимое резервной копии добавляется на набор носителей при успешной операции резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-110">backup set The backup content that is added to a media set by a successful backup operation.</span></span>


##  <a name="overview-of-media-sets-media-families-and-backup-sets"></a><a name="OvMediaSetsFamiliesBackupSets"></a><span data-ttu-id="c56c0-111">Общие сведения о наборах носителей, семействах носителей и резервных наборах</span><span class="sxs-lookup"><span data-stu-id="c56c0-111">Overview of Media Sets, Media Families, and Backup Sets</span></span>
 <span data-ttu-id="c56c0-112">Резервные копии на наборе из одного или более носителей резервных копий образуют отдельный набор носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-112">The backups on a set of one or more backup media compose a single media set.</span></span> <span data-ttu-id="c56c0-113">*Набор носителей* — упорядоченная коллекция *носителей резервных копий*, лент или дисковых файлов либо больших двоичных объектов Azure, на которые производили запись одна или несколько операций резервного копирования, получая доступ по фиксированному типу и номеру устройства.</span><span class="sxs-lookup"><span data-stu-id="c56c0-113">A *media set* is an ordered collection of *backup media*, tapes or disk files, or Azure Blobs, to which one or more backup operations have written using a fixed type and number of backup devices.</span></span> <span data-ttu-id="c56c0-114">Данный набор носителей использует накопители на магнитной ленте или дисковые накопители либо большие двоичные объекты Azure, но не сочетание двух или нескольких типов носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-114">A given media set uses tape drives, or disk drives or Azure blobs, but not a combination of two or more.</span></span> <span data-ttu-id="c56c0-115">Например, устройства резервного копирования, объединенные в набор носителей, могут включать в себя три ленточных накопителя с именами `\\.\TAPE0`, `\\.\TAPE1`и `\\.\TAPE2`.</span><span class="sxs-lookup"><span data-stu-id="c56c0-115">For example, the backup devices associated with a media set might be three tape drives named `\\.\TAPE0`, `\\.\TAPE1`, and `\\.\TAPE2`.</span></span> <span data-ttu-id="c56c0-116">Этот набор содержит только ленточные носители, имеющие не менее трех лент (по одной на ленточный накопитель).</span><span class="sxs-lookup"><span data-stu-id="c56c0-116">That media set contains only tapes, starting with a minimum of three tapes (one per drive).</span></span> <span data-ttu-id="c56c0-117">Тип и номер устройства резервного копирования присваиваются при создании набора носителей и не могут меняться.</span><span class="sxs-lookup"><span data-stu-id="c56c0-117">The type and number of backup devices are established when a media set is created, and they cannot be changed.</span></span> <span data-ttu-id="c56c0-118">Однако при необходимости, между операциями резервного копирования и восстановления можно заменить устройство на другое устройство аналогичного типа.</span><span class="sxs-lookup"><span data-stu-id="c56c0-118">However, if necessary, between backup and restore operations a given device can be replaced with a device of the same type.</span></span>

 <span data-ttu-id="c56c0-119">Набор носителей создается на носителе резервной копии во время операции резервного копирования при форматировании носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-119">A media set is created on the backup media during a backup operation by formatting the backup media.</span></span> <span data-ttu-id="c56c0-120">Дополнительные сведения см. в подразделе [Создание нового набора носителей](#CreatingMediaSet)ниже в данном разделе.</span><span class="sxs-lookup"><span data-stu-id="c56c0-120">For more information, see [Creating a New Media Set](#CreatingMediaSet), later in this topic.</span></span> <span data-ttu-id="c56c0-121">После форматирования каждый файл или лента содержат заголовок носителя и готовы к записи данных.</span><span class="sxs-lookup"><span data-stu-id="c56c0-121">After formatting, each file or tape contains a media header for the media set and is ready to receive backup content.</span></span> <span data-ttu-id="c56c0-122">После формирования заголовка операция резервного копирования продолжает создавать резервную копию указанных данных на все заданные устройства резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-122">With the header in place, the backup operation proceeds to back up the specified data to the backup media on all of the backup devices specified for the operation.</span></span>

> [!NOTE]
>  <span data-ttu-id="c56c0-123">Для предотвращения потери данных в случае повреждения носителя (ленты или файла на диске), наборы носителей можно сделать зеркальными.</span><span class="sxs-lookup"><span data-stu-id="c56c0-123">Media sets can be mirrored to protect against a damaged media volume (a tape or disk file).</span></span> <span data-ttu-id="c56c0-124">Дополнительные сведения см. в подразделе [Зеркальные наборы носителей резервных копий (SQL Server)](mirrored-backup-media-sets-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c56c0-124">For more information, see [Mirrored Backup Media Sets &#40;SQL Server&#41;](mirrored-backup-media-sets-sql-server.md).</span></span>

 [!INCLUDE[ssEnterpriseEd10](../../includes/sskatmai-md.md)]<span data-ttu-id="c56c0-125">или более поздней версии может считывать сжатые резервные копии.</span><span class="sxs-lookup"><span data-stu-id="c56c0-125">or later can read compressed backups.</span></span> <span data-ttu-id="c56c0-126">Дополнительные сведения см. в разделе [Сжатие резервных копий (SQL Server)](backup-compression-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c56c0-126">For more information, see [Backup Compression &#40;SQL Server&#41;](backup-compression-sql-server.md).</span></span>


### <a name="media-families"></a><span data-ttu-id="c56c0-127">Семейства носителей</span><span class="sxs-lookup"><span data-stu-id="c56c0-127">Media Families</span></span>
 <span data-ttu-id="c56c0-128">Резервные копии, созданные на отдельном устройстве, не имеющем зеркального отображения, или на наборе устройств с зеркальным копированием, принадлежащем одному набору носителей, образуют *семейство носителей*.</span><span class="sxs-lookup"><span data-stu-id="c56c0-128">Backups created on a single nonmirrored device or a set of mirrored devices in a media set constitute a *media family*.</span></span> <span data-ttu-id="c56c0-129">Количество устройств резервного копирования, используемых в наборе носителей, определяет количество семейств носителей в наборе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-129">The number of backup devices used for the media set determines the number of media families in a media set.</span></span> <span data-ttu-id="c56c0-130">Например, если набор носителей использует два незеркальных устройства резервного копирования, этот набор носителей содержит два семейства носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-130">For example, if a media set uses two nonmirrored backup devices, the media set contains two media families.</span></span>

> [!NOTE]
>  <span data-ttu-id="c56c0-131">В зеркальном наборе носителей каждое семейство носителей является зеркальным.</span><span class="sxs-lookup"><span data-stu-id="c56c0-131">In a mirrored media set, each media family is mirrored.</span></span> <span data-ttu-id="c56c0-132">Например, если шесть устройств резервного копирования формируют набор носителей, в котором используются два зеркала, этот набор содержит три семейства носителей, каждое из которых содержит по две резервных копии данных.</span><span class="sxs-lookup"><span data-stu-id="c56c0-132">For example, if six backup devices are used to format a media set, where two mirrors are used, there are three media families, each containing two equivalent copies of backup data.</span></span> <span data-ttu-id="c56c0-133">Дополнительные сведения о зеркальных наборах носителей резервных копий см. в разделе [Зеркальные наборы носителей резервных копий (SQL Server)](mirrored-backup-media-sets-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c56c0-133">For more information about mirrored media sets, see [Mirrored Backup Media Sets &#40;SQL Server&#41;](mirrored-backup-media-sets-sql-server.md).</span></span>

 <span data-ttu-id="c56c0-134">Каждой ленте или диску в семействе носителей присваивается *порядковый номер носителя*.</span><span class="sxs-lookup"><span data-stu-id="c56c0-134">Each tape or disk in a media family is assigned a *media sequence number*.</span></span> <span data-ttu-id="c56c0-135">Порядковый номер носителя для диска всегда равен 1.</span><span class="sxs-lookup"><span data-stu-id="c56c0-135">The media sequence number of a disk is always 1.</span></span> <span data-ttu-id="c56c0-136">Для семейства ленточных носителей порядковый номер исходной ленты равен 1, вторая лента получает номер 2 и т. д.</span><span class="sxs-lookup"><span data-stu-id="c56c0-136">In a tape media family, the sequence number of the initial tape is 1, the sequence number of the second tape is 2, and so forth.</span></span> <span data-ttu-id="c56c0-137">Дополнительные сведения см. в разделе [Использование наборов и семейств носителей](#ConsiderationsForMediaSetFamilies).</span><span class="sxs-lookup"><span data-stu-id="c56c0-137">For more information, see [Using Media Sets and Families](#ConsiderationsForMediaSetFamilies).</span></span>

#### <a name="the-media-header"></a><span data-ttu-id="c56c0-138">Заголовок носителя</span><span class="sxs-lookup"><span data-stu-id="c56c0-138">The Media Header</span></span>
 <span data-ttu-id="c56c0-139">Каждый том носителя резервной копии (дисковый файл или лента) содержит заголовок носителя, который создается первой операцией резервного копирования, использующей эту ленту или диск.</span><span class="sxs-lookup"><span data-stu-id="c56c0-139">Every volume of backup media (disk file or tape) contains a media header that is created when by the first backup operation that uses the tape (or disk).</span></span> <span data-ttu-id="c56c0-140">Заголовок остается без изменений, пока носитель не будет отформатирован повторно.</span><span class="sxs-lookup"><span data-stu-id="c56c0-140">That header remains intact until the media is reformatted.</span></span>

 <span data-ttu-id="c56c0-141">Заголовок носителя содержит все сведения, необходимые, чтобы идентифицировать носитель (файл или ленту) и его место в семействе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-141">The media header contains all of the information required to identify the media (disk file or tape) and its place within the media family to which it belongs.</span></span> <span data-ttu-id="c56c0-142">Эти данные включают:</span><span class="sxs-lookup"><span data-stu-id="c56c0-142">This information includes:</span></span>

-   <span data-ttu-id="c56c0-143">Имя носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-143">The name of the media.</span></span>

     <span data-ttu-id="c56c0-144">Имя носителя не является обязательным, но рекомендуется постоянно использовать имена носителей, чтобы однозначно их различать.</span><span class="sxs-lookup"><span data-stu-id="c56c0-144">The media name is optionally, but we recommend consistently using media names that clearly identify your media.</span></span> <span data-ttu-id="c56c0-145">Имя присваивается носителю во время форматирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-145">A media name is assigned by whoever formats the media.</span></span>

-   <span data-ttu-id="c56c0-146">Уникальный идентификатор набора носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-146">The unique identification number of the media set.</span></span>

-   <span data-ttu-id="c56c0-147">Количество семейств носителей в этом наборе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-147">The number of media families in the media set.</span></span>

-   <span data-ttu-id="c56c0-148">Порядковый номер семейства носителей, содержащего данный носитель.</span><span class="sxs-lookup"><span data-stu-id="c56c0-148">The sequence number of the media family containing this media.</span></span>

-   <span data-ttu-id="c56c0-149">Уникальный идентификатор семейства носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-149">The unique identification number for the media family.</span></span>

-   <span data-ttu-id="c56c0-150">Порядковый номер носителя в семействе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-150">The sequence number of this media in the media family.</span></span> <span data-ttu-id="c56c0-151">Для дискового файла это значение всегда равно 1.</span><span class="sxs-lookup"><span data-stu-id="c56c0-151">For a disk file, this value is always 1.</span></span>

-   <span data-ttu-id="c56c0-152">Содержит ли описание этого носителя метку MTF или описание носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-152">Whether the media description contains an MTF media label or a media description.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="c56c0-153">Все носители, используемые для операции резервного копирования или восстановления, используют стандартный формат резервного копирования с именем [!INCLUDE[msCoName](../../includes/ssnoversion-md.md)] сохраняет все метки носителей MTF, записанные другим приложением, но не записывают метки носителей MTF.</span><span class="sxs-lookup"><span data-stu-id="c56c0-153">All media that is used for a backup or restore operation use a standard backup format called [!INCLUDE[msCoName](../../includes/ssnoversion-md.md)] preserves any MTF media label written by another application but does not write MTF media labels.</span></span>

-   <span data-ttu-id="c56c0-154">Метка носителя в формате [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Tape Format или описание носителя (в свободной форме).</span><span class="sxs-lookup"><span data-stu-id="c56c0-154">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Tape Format media label or the media description (in free-form text).</span></span>

-   <span data-ttu-id="c56c0-155">Название программы резервного копирования, записавшей метку.</span><span class="sxs-lookup"><span data-stu-id="c56c0-155">The name of the backup software that wrote the label.</span></span>

-   <span data-ttu-id="c56c0-156">Уникальный идентификатор поставщика программного обеспечения, с помощью которого отформатирован носитель.</span><span class="sxs-lookup"><span data-stu-id="c56c0-156">The unique vendor identification number of the software vendor that formatted the media.</span></span>

-   <span data-ttu-id="c56c0-157">Дата и время записи метки.</span><span class="sxs-lookup"><span data-stu-id="c56c0-157">The date and time the label was written.</span></span>

-   <span data-ttu-id="c56c0-158">Количество зеркал в наборе (от 1 до 4); 1 является признаком того, что устройство не является зеркальным.</span><span class="sxs-lookup"><span data-stu-id="c56c0-158">The number of mirrors in the set (1-4); 1 indicates an unmirrored device.</span></span>

 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="c56c0-159">позволяет обрабатывать носители, отформатированные в более ранних версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c56c0-159">can process media formatted by earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>

### <a name="backup-sets"></a><span data-ttu-id="c56c0-160">Резервные наборы данных</span><span class="sxs-lookup"><span data-stu-id="c56c0-160">Backup Sets</span></span>
 <span data-ttu-id="c56c0-161">При успешном завершении операции резервного копирования к набору носителей добавляется один *резервный набор данных* .</span><span class="sxs-lookup"><span data-stu-id="c56c0-161">A successful backup operation adds a single *backup set* to the media set.</span></span> <span data-ttu-id="c56c0-162">Резервный набор данных описывается в терминах набора носителей, на котором создан этот резервный набор.</span><span class="sxs-lookup"><span data-stu-id="c56c0-162">The backup set is described in terms of the media set to which the backup belongs.</span></span> <span data-ttu-id="c56c0-163">Если носитель резервной копии состоит только из одного семейства носителей, это семейство содержит весь резервный набор данных.</span><span class="sxs-lookup"><span data-stu-id="c56c0-163">If the backup media consists of only one media family, that family contains the entire backup set.</span></span> <span data-ttu-id="c56c0-164">Если носитель резервной копии состоит из нескольких семейств носителей, резервный набор данных распределяется между ними.</span><span class="sxs-lookup"><span data-stu-id="c56c0-164">If the backup media consists of multiple media families, the backup set is distributed among them.</span></span> <span data-ttu-id="c56c0-165">На каждом носителе резервный набор данных содержит заголовок со своим описанием.</span><span class="sxs-lookup"><span data-stu-id="c56c0-165">On each medium, the backup set contains a header that describes the backup set.</span></span>

 <span data-ttu-id="c56c0-166">В следующем примере показана инструкция [!INCLUDE[tsql](../../includes/tsql-md.md)] , с помощью которой создается набор носителей с именем `MyAdvWorks_MediaSet_1` для базы данных [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] , использующий три накопителя на магнитных лентах в качестве устройств резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-166">The following example shows a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that creates a media set called `MyAdvWorks_MediaSet_1` for the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database using three tape drives as backup devices:</span></span>

```
BACKUP DATABASE AdventureWorks2012
TO TAPE = '\\.\tape0', TAPE = '\\.\tape1', TAPE = '\\.\tape2'
WITH 
   FORMAT,
   MEDIANAME = 'MyAdvWorks_MediaSet_1'
```

 <span data-ttu-id="c56c0-167">В случае успешного выполнения данной операции резервного копирования будет создан новый набор носителей, содержащий заголовок, и один резервный набор данных, распределенный на трех магнитных лентах.</span><span class="sxs-lookup"><span data-stu-id="c56c0-167">If successful, this backup operation results in a new media set containing a new media header and one backup set spread across three tapes.</span></span> <span data-ttu-id="c56c0-168">Результаты представлены на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="c56c0-168">The following figure illustrates these results:</span></span>

 <span data-ttu-id="c56c0-169">![Заголовок носителя и первый набор резервных копий на трех лентах](../../database-engine/media/bnr-mediaset-new.gif "Заголовок носителя и первый набор резервных копий на трех лентах")</span><span class="sxs-lookup"><span data-stu-id="c56c0-169">![Media header and first backup set on 3 tapes](../../database-engine/media/bnr-mediaset-new.gif "Media header and first backup set on 3 tapes")</span></span>

 <span data-ttu-id="c56c0-170">Как правило, после создания набора носителей все последующие операции резервного копирования добавляют резервные наборы данных к этому набору носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-170">Typically, after a media set is created, subsequent backup operations, one after another, append their backup sets to the media set.</span></span> <span data-ttu-id="c56c0-171">Все носители, используемые резервным набором данных, составляют набор носителей независимо от числа вовлеченных в операцию носителей или устройств резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-171">All of the media used by a backup set make up the media set, regardless of the number of media or backup devices involved.</span></span> <span data-ttu-id="c56c0-172">Резервные наборы данных последовательно нумеруются согласно их позиции в наборе носителей, что позволяет указывать резервный набор для восстановления.</span><span class="sxs-lookup"><span data-stu-id="c56c0-172">Backup sets are sequentially numbered by their position in the media set, allowing you to specify which backup set to restore.</span></span>

 <span data-ttu-id="c56c0-173">Каждая последующая операция резервного копирования требует одно и то же количество и тип резервных устройств.</span><span class="sxs-lookup"><span data-stu-id="c56c0-173">Every backup operation to a media set must write to the same number and type of backup devices.</span></span> <span data-ttu-id="c56c0-174">Содержимое каждой последующей резервной копии распределяется между носителями всех используемых устройств резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-174">With multiple devices, as with the first backup set, the content of every subsequent backup set is distributed among the backup media on all of the devices.</span></span> <span data-ttu-id="c56c0-175">Продолжая приведенный выше пример, при проведении второй операции резервного копирования (разностное резервное копирование) данные добавляются на тот же набор носителей:</span><span class="sxs-lookup"><span data-stu-id="c56c0-175">To continue the above example, a second backup operation (a differential backup) appends information to the same media set:</span></span>

```
BACKUP DATABASE AdventureWorks2012
TO TAPE = '\\.\tape0', TAPE = '\\.\tape1', TAPE = '\\.\tape2'
WITH 
   NOINIT,
   MEDIANAME = 'AdventureWorksMediaSet1',
   DIFFERENTIAL
```

> [!NOTE]
>  <span data-ttu-id="c56c0-176">Параметр NOINIT используется по умолчанию, но включен для ясности.</span><span class="sxs-lookup"><span data-stu-id="c56c0-176">The NOINIT option is the default, but is included for clarity.</span></span>

 <span data-ttu-id="c56c0-177">В случае успешного выполнения второй операции резервного копирования запись второго резервного набора данных на набор носителей производится со следующим распределением содержимого резервной копии.</span><span class="sxs-lookup"><span data-stu-id="c56c0-177">If the second backup operation succeeds, it writes a second backup set to the media set, with the following distribution of backup content:</span></span>

 <span data-ttu-id="c56c0-178">![Второй набор резервных копий, распределенный между тремя лентами набора носителей](../../database-engine/media/bnr-mediaset-appendedto.gif "Второй набор резервных копий, распределенный между тремя лентами набора носителей")</span><span class="sxs-lookup"><span data-stu-id="c56c0-178">![Second backup set spread across 3 media-set tapes](../../database-engine/media/bnr-mediaset-appendedto.gif "Second backup set spread across 3 media-set tapes")</span></span>

 <span data-ttu-id="c56c0-179">При восстановлении резервных копий можно использовать параметр FILE, чтобы указать, какие резервные копии использовать.</span><span class="sxs-lookup"><span data-stu-id="c56c0-179">When you are restoring backups, you can use you the FILE option to specify which backups you want to use.</span></span> <span data-ttu-id="c56c0-180">В следующем примере показано, как использовать предложения FILE **=** _номер_файла_резервного_набора_ при восстановлении полной резервной копии базы данных [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] , за которой следует разностная резервная копия на том же наборе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-180">The following example shows the use of FILE **=**_backup_set_file_number_ clauses when restoring a full database backup of the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database followed by a differential database backup on the same media set.</span></span> <span data-ttu-id="c56c0-181">Этот набор содержит три ленточных носителя, находящихся в накопителях на магнитной ленте `\\.\tape0`, `tape1`и `tape2`.</span><span class="sxs-lookup"><span data-stu-id="c56c0-181">The media set uses three backup tapes, which are on tape drives `\\.\tape0`, `tape1`, and `tape2`.</span></span>

```
RESTORE DATABASE AdventureWorks2012 FROM TAPE = '\\.\tape0', TAPE = '\\.\tape1', TAPE = '\\.\tape2'
   WITH 
   MEDIANAME = 'AdventureWorksMediaSet1',
   FILE=1, 
   NORECOVERY;
RESTORE DATABASE AdventureWorks2012 FROM TAPE = '\\.\tape0', TAPE = '\\.\tape1', TAPE = '\\.\tape2' 
   WITH 
   MEDIANAME = 'AdventureWorksMediaSet1',
   FILE=2, 
   RECOVERY;
GO
```

 <span data-ttu-id="c56c0-182">Дополнительные сведения о таблицах журнала, содержащих данные о наборах носителей и их семействах, см. в разделе [Журнал и сведения о заголовке резервной копии (SQL Server)](backup-history-and-header-information-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c56c0-182">For information about the history tables that store information about media sets and their media families and backup sets, see [Backup History and Header Information &#40;SQL Server&#41;](backup-history-and-header-information-sql-server.md).</span></span>

 <span data-ttu-id="c56c0-183">Число носителей резервной копии в наборе носителей зависит от нескольких факторов:</span><span class="sxs-lookup"><span data-stu-id="c56c0-183">The number of backup media in a media set depends on several factors:</span></span>

-   <span data-ttu-id="c56c0-184">от количества устройств резервного копирования;</span><span class="sxs-lookup"><span data-stu-id="c56c0-184">Number of backup devices</span></span>

-   <span data-ttu-id="c56c0-185">от типа устройств резервного копирования;</span><span class="sxs-lookup"><span data-stu-id="c56c0-185">Type of backup devices</span></span>

-   <span data-ttu-id="c56c0-186">от количества резервных наборов данных.</span><span class="sxs-lookup"><span data-stu-id="c56c0-186">Number of backup sets</span></span>

##  <a name="using-media-sets-and-families"></a><a name="ConsiderationsForMediaSetFamilies"></a><span data-ttu-id="c56c0-187">Использование наборов носителей и семейств</span><span class="sxs-lookup"><span data-stu-id="c56c0-187">Using Media Sets and Families</span></span>
 <span data-ttu-id="c56c0-188">В настоящем разделе обсуждаются некоторые соображения по использованию наборов носителей и семейств носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-188">This section discusses several considerations for using media sets and media families.</span></span>



###  <a name="creating-a-new-media-set"></a><a name="CreatingMediaSet"></a><span data-ttu-id="c56c0-189">Создание нового набора носителей</span><span class="sxs-lookup"><span data-stu-id="c56c0-189">Creating a New Media Set</span></span>
 <span data-ttu-id="c56c0-190">Для создания нового набора носителей необходимо форматировать носитель резервной копии (одну или несколько магнитных лент или дисковых файлов).</span><span class="sxs-lookup"><span data-stu-id="c56c0-190">To create a new media set, you must format the backup media (one or more tapes or disk files).</span></span> <span data-ttu-id="c56c0-191">В процессе форматирования резервный носитель изменяется следующим образом.</span><span class="sxs-lookup"><span data-stu-id="c56c0-191">The formatting process changes the backup media as follows:</span></span>

1.  <span data-ttu-id="c56c0-192">Удаляется старый заголовок (если он есть), фактически удаляется прежнее содержимое носителя резервной копии.</span><span class="sxs-lookup"><span data-stu-id="c56c0-192">Deletes the old header (if any), effectively deleting the previous contents of the backup media.</span></span>

     <span data-ttu-id="c56c0-193">При форматировании ленточного устройства удаляется все прежнее содержимое установленной на тот момент магнитной ленты.</span><span class="sxs-lookup"><span data-stu-id="c56c0-193">Formatting a tape device deletes all previous contents of the currently mounted tape.</span></span> <span data-ttu-id="c56c0-194">Форматирование диска затрагивает только файл, указанный для операции резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-194">Formatting a disk affects only the file that you specify for the backup operation</span></span>

2.  <span data-ttu-id="c56c0-195">Записывается новый заголовок носителя на носитель резервной копии (магнитную ленту или дисковый файл) в каждом из устройств резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-195">Writes a new media header on the backup media (tape or disk file) on each of the backup devices.</span></span>


###  <a name="backing-up-to-an-existing-media-set"></a><a name="UseExistingMediaSet"></a><span data-ttu-id="c56c0-196">Резервное копирование на существующий набор носителей</span><span class="sxs-lookup"><span data-stu-id="c56c0-196">Backing Up to an Existing Media Set</span></span>
 <span data-ttu-id="c56c0-197">При создании резервной копии на существующем наборе носителей имеются следующие два параметра:</span><span class="sxs-lookup"><span data-stu-id="c56c0-197">When you are backing up to an existing media set, you have the following two options:</span></span>

-   <span data-ttu-id="c56c0-198">Добавление к существующему резервному набору данных.</span><span class="sxs-lookup"><span data-stu-id="c56c0-198">Append to the existing backup set.</span></span>

     <span data-ttu-id="c56c0-199">Чтобы использовать доступное пространство наилучшим образом, новые резервные наборы данных обычно добавляются к существующим наборам носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-199">To make the best possible use of the available space, new backup sets typically are appended to existing media set.</span></span> <span data-ttu-id="c56c0-200">Добавление к резервной копии сохраняет любые предшествующие резервные копии.</span><span class="sxs-lookup"><span data-stu-id="c56c0-200">Appending to the backup preserves any prior backups.</span></span> <span data-ttu-id="c56c0-201">Дополнительные сведения см. в подразделе [Добавление к существующим резервным наборам](#Appending)ниже в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="c56c0-201">For more information, see [Appending to Existing Backup Sets](#Appending), later in this section.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="c56c0-202">Добавление, которое является поведением по умолчанию инструкции BACKUP, можно явно указать с помощью параметра NOINIT.</span><span class="sxs-lookup"><span data-stu-id="c56c0-202">Appending, which is the default behavior of the BACKUP, can be explicitly specified by using the NOINIT option.</span></span>

-   <span data-ttu-id="c56c0-203">Перезапись всех существующих резервных наборов данных текущими копиями с оставлением на месте текущего заголовка носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-203">Overwrite all existing backup sets with the current backup, leaving the current media header in place.</span></span>

     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="c56c0-204">имеет защиту от случайной перезаписи носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-204">backup has safeguards to prevent you from accidentally overwriting media.</span></span> <span data-ttu-id="c56c0-205">Однако резервная копия может автоматически переписать резервные наборы данных, которые достигли окончания предопределенного срока хранения.</span><span class="sxs-lookup"><span data-stu-id="c56c0-205">However, backup can automatically overwrite backup sets that have reached a predefined expiration date.</span></span>

     <span data-ttu-id="c56c0-206">При копировании на ленту может иметь смысл оставлять заголовки лент.</span><span class="sxs-lookup"><span data-stu-id="c56c0-206">For tape headers, leaving the header in place can make sense.</span></span> <span data-ttu-id="c56c0-207">Дополнительные сведения см. в подразделе [Перезапись резервных наборов](#Overwriting)ниже в данном разделе.</span><span class="sxs-lookup"><span data-stu-id="c56c0-207">For more information, see [Overwriting Backup Sets](#Overwriting), later in this section.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="c56c0-208">Перезапись существующих резервных наборов данных задается с помощью параметра INIT инструкции BACKUP.</span><span class="sxs-lookup"><span data-stu-id="c56c0-208">Overwriting existing backup sets is specified by using the INIT option of the BACKUP statement.</span></span>

####  <a name="appending-to-existing-backup-sets"></a><a name="Appending"></a><span data-ttu-id="c56c0-209">Добавление к существующим резервным наборам</span><span class="sxs-lookup"><span data-stu-id="c56c0-209">Appending to Existing Backup Sets</span></span>
 <span data-ttu-id="c56c0-210">Резервные копии одной или разных баз данных в разные моменты времени могут храниться на одном носителе.</span><span class="sxs-lookup"><span data-stu-id="c56c0-210">Backups performed at different times from the same or different databases can be stored on the same media.</span></span> <span data-ttu-id="c56c0-211">При присоединении еще одного резервного набора данных к существующим копиям на носителе предыдущее содержимое носителя остается неизменным, и новая резервная копия записывается после окончания последней.</span><span class="sxs-lookup"><span data-stu-id="c56c0-211">By appending another backup set to existing media, the previous contents of the media remain intact, and the new backup is written after the end of the last backup on the media.</span></span>

 <span data-ttu-id="c56c0-212">По умолчанию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] всегда присоединяет новую резервную копию к содержимому носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-212">By default, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] always appends new backups to media.</span></span> <span data-ttu-id="c56c0-213">Присоединение может выполняться только в конец носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-213">Appending can occur only at the end of the media.</span></span> <span data-ttu-id="c56c0-214">Например, если том содержит пять наборов резервных копий, нельзя пропустить первые три и перезаписать четвертый новым резервным набором.</span><span class="sxs-lookup"><span data-stu-id="c56c0-214">For example, if a media volume contains five backup sets, it is not possible to skip the first three backup sets to overwrite the fourth backup set with a new backup set.</span></span>

 <span data-ttu-id="c56c0-215">Если для записи резервной копии на ленту используется инструкция BACKUP WITH NOREWIND, то в конце операции лента остается открытой.</span><span class="sxs-lookup"><span data-stu-id="c56c0-215">If you use BACKUP WITH NOREWIND for a tape backup, the tape will be left open at the end of the operation.</span></span> <span data-ttu-id="c56c0-216">Это позволяет записывать последующие резервные копии на ленту без ее перемотки и последующего поиска последнего резервного набора.</span><span class="sxs-lookup"><span data-stu-id="c56c0-216">This allows you to append further backups to the tape without rewinding the tape and then scanning forward again to find the last backup set.</span></span> <span data-ttu-id="c56c0-217">Список открытых накопителей на магнитной ленте можно получить из динамического административного представления **sys.dm_io_backup_tapes**. Дополнительные сведения см. в разделе [sys.dm_io_backup_tapes (Transact-SQL)](/sql/relational-databases/system-dynamic-management-views/sys-dm-io-backup-tapes-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c56c0-217">You can find the list of open tape drives in the **sys.dm_io_backup_tapes** dynamic management view; for more information, see [sys.dm_io_backup_tapes &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-io-backup-tapes-transact-sql).</span></span>

 <span data-ttu-id="c56c0-218">Для резервных копий Microsoft Windows и резервных копий [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] могут совместно использоваться одни и те же носители, но сами эти копии не являются функционально совместимыми.</span><span class="sxs-lookup"><span data-stu-id="c56c0-218">Microsoft Windows backups and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backups can share the same media, but they are not interoperable.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="c56c0-219">не позволяет создать резервную копию данных Windows.</span><span class="sxs-lookup"><span data-stu-id="c56c0-219">backup cannot back up Windows data.</span></span>

> [!IMPORTANT]
>  [!INCLUDE[ssEnterpriseEd10](../../includes/sskatmai-md.md)]<span data-ttu-id="c56c0-220">или более поздние версии могут считывать сжатые резервные копии.</span><span class="sxs-lookup"><span data-stu-id="c56c0-220">or later versions can read compressed backups.</span></span> <span data-ttu-id="c56c0-221">Дополнительные сведения см. в разделе [Сжатие резервных копий (SQL Server)](backup-compression-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c56c0-221">For more information, see [Backup Compression &#40;SQL Server&#41;](backup-compression-sql-server.md).</span></span>


####  <a name="overwriting-backup-sets"></a><a name="Overwriting"></a><span data-ttu-id="c56c0-222">Перезапись резервных наборов данных</span><span class="sxs-lookup"><span data-stu-id="c56c0-222">Overwriting Backup Sets</span></span>
 <span data-ttu-id="c56c0-223">Перезапись существующих резервных наборов данных задается с помощью параметра INIT инструкции BACKUP.</span><span class="sxs-lookup"><span data-stu-id="c56c0-223">Overwriting of existing backup sets is specified by using the INIT option of the BACKUP statement.</span></span> <span data-ttu-id="c56c0-224">Этот параметр производит перезапись всех резервных наборов данных на носителе. Сохраняется только заголовок носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-224">This option overwrites all the backup sets on the media and preserve the media header, if any.</span></span> <span data-ttu-id="c56c0-225">Если у носителя нет заголовка, он будет создан.</span><span class="sxs-lookup"><span data-stu-id="c56c0-225">If no media header exists, one is created.</span></span>

 <span data-ttu-id="c56c0-226">При копировании на ленту может иметь смысл оставлять заголовки лент.</span><span class="sxs-lookup"><span data-stu-id="c56c0-226">For tape headers, leaving the header in place can make sense.</span></span> <span data-ttu-id="c56c0-227">При копировании на дисковые носители переписываются только файлы, используемые устройствами резервного копирования, которые указаны в операции резервного копирования; остальные файлы на дисках сохраняются неизменными.</span><span class="sxs-lookup"><span data-stu-id="c56c0-227">For disk backup media, only the files used by the backup devices specified in the backup operation are overwritten; other files on the disk are unaffected.</span></span> <span data-ttu-id="c56c0-228">При перезаписи резервных копий сохраняется каждый существующий заголовок носителя, и новая резервная копия создается в качестве первой для устройства.</span><span class="sxs-lookup"><span data-stu-id="c56c0-228">When overwriting backups, any existing media header is preserved, and the new backup is created as the first backup on the backup device.</span></span> <span data-ttu-id="c56c0-229">Если никакого заголовка у носителя нет, автоматически будет записан правильный заголовок, связанный с именем носителя и его описанием.</span><span class="sxs-lookup"><span data-stu-id="c56c0-229">If there is no existing media header, a valid media header with an associated media name and media description is written automatically.</span></span> <span data-ttu-id="c56c0-230">Если существующий заголовок носителя недопустим, операция резервного копирования завершается.</span><span class="sxs-lookup"><span data-stu-id="c56c0-230">If the existing media header is invalid, the backup operation terminates.</span></span> <span data-ttu-id="c56c0-231">Если носитель пуст, формируется новый заголовок носителя с указанными параметрами MEDIANAME, MEDIAPASSWORD и MEDIADESCRIPTION, если таковые имеются.</span><span class="sxs-lookup"><span data-stu-id="c56c0-231">If the media is empty, the new media header is generated with the given MEDIANAME, MEDIAPASSWORD, and MEDIADESCRIPTION, if any.</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="c56c0-232">Начиная с [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], параметр MEDIAPASSWORD не поддерживается при создании резервных копий.</span><span class="sxs-lookup"><span data-stu-id="c56c0-232">Beginning with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], the MEDIAPASSWORD option is discontinued for creating backups.</span></span> <span data-ttu-id="c56c0-233">Но все еще можно восстанавливать резервные копии, созданные с паролями.</span><span class="sxs-lookup"><span data-stu-id="c56c0-233">However, you can still restore backups created with passwords.</span></span>

 <span data-ttu-id="c56c0-234">Носители резервных копий не перезаписываются, если имеет место любое из следующих условий:</span><span class="sxs-lookup"><span data-stu-id="c56c0-234">Backup media is not overwritten if either of the following conditions exists:</span></span>

-   <span data-ttu-id="c56c0-235">Срок действия резервных копий на носителе еще не истек.</span><span class="sxs-lookup"><span data-stu-id="c56c0-235">The existing backups on the media have not expired.</span></span> <span data-ttu-id="c56c0-236">(При указании аргумента SKIP срок действия не проверяется.)</span><span class="sxs-lookup"><span data-stu-id="c56c0-236">(If SKIP is specified, expiration is not checked.)</span></span>

     <span data-ttu-id="c56c0-237">Дата истечения срока хранения указывает день, когда истечет срок хранения резервной копии, и она сможет быть заменена другой копией.</span><span class="sxs-lookup"><span data-stu-id="c56c0-237">The expiration date specifies the date that the backup expires and can be overwritten by another backup.</span></span> <span data-ttu-id="c56c0-238">Дату истечения срока хранения резервной копии можно указать при ее создании.</span><span class="sxs-lookup"><span data-stu-id="c56c0-238">You can specify the expiration date when a backup is created.</span></span> <span data-ttu-id="c56c0-239">По умолчанию дата истечения срока хранения определяется набором параметров **media retention** хранимой процедуры **sp_configure**.</span><span class="sxs-lookup"><span data-stu-id="c56c0-239">By default, the expiration date is determined by the **media retention** option set with **sp_configure**.</span></span> <span data-ttu-id="c56c0-240">Дополнительные сведения см. в подразделе [sp_configure &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c56c0-240">For more information, see [sp_configure &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span></span>

-   <span data-ttu-id="c56c0-241">Имя носителя, если оно указано, не соответствует имени на носителе резервной копии.</span><span class="sxs-lookup"><span data-stu-id="c56c0-241">The media name, if provided, does not match the name on the backup media.</span></span>

     <span data-ttu-id="c56c0-242">Имя носителя представляет собой описательное имя, которое используется, чтобы облегчить распознавание носителя.</span><span class="sxs-lookup"><span data-stu-id="c56c0-242">The media name is a descriptive name used for easy identification of the media.</span></span>

 <span data-ttu-id="c56c0-243">Если существует уверенность в том, что необходимо перезаписать существующий носитель (например, если известно, что резервные копии на ленте более не нужны), можно в явном виде отказаться от этих проверок.</span><span class="sxs-lookup"><span data-stu-id="c56c0-243">If you are sure you want to overwrite the existing media (for example, if you know that the backups on the tape are no longer needed), you can explicitly skip these checks.</span></span>

 <span data-ttu-id="c56c0-244">Если носитель резервной копии защищен паролем Microsoft Windows, Microsoft SQL Server не будет производить записи на этот носитель.</span><span class="sxs-lookup"><span data-stu-id="c56c0-244">If the backup media is password protected by Microsoft Windows, Microsoft SQL Server does not write to the media.</span></span> <span data-ttu-id="c56c0-245">Чтобы перезаписать защищенный паролем носитель, нужно его заново инициализировать.</span><span class="sxs-lookup"><span data-stu-id="c56c0-245">To overwrite media that is password protected, you must reinitialize the media.</span></span>


###  <a name="sequence-numbers"></a><a name="SequenceNumbers"></a><span data-ttu-id="c56c0-246">Порядковые номера</span><span class="sxs-lookup"><span data-stu-id="c56c0-246">Sequence Numbers</span></span>
 <span data-ttu-id="c56c0-247">Для нескольких семейств носителей в наборе носителей или нескольких резервных носителей в семействе носителей важен правильный порядок.</span><span class="sxs-lookup"><span data-stu-id="c56c0-247">The correct order is important for multiple media families within a media set or multiple backup media within a media family.</span></span> <span data-ttu-id="c56c0-248">Поэтому резервное копирование назначает порядковые номера следующими способами.</span><span class="sxs-lookup"><span data-stu-id="c56c0-248">Therefore, backup assigns sequence numbers in the following ways:</span></span>

-   <span data-ttu-id="c56c0-249">Последовательные семейства носителей в наборе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-249">Sequential media families within a media set</span></span>

     <span data-ttu-id="c56c0-250">Семейства носителей в наборе носителей последовательно нумеруются в соответствие с их позицией в наборе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-250">Within a media set, the media families are numbered sequentially according to their position in the media set.</span></span> <span data-ttu-id="c56c0-251">Номер семейства носителей записывается в столбец **family_sequence_number** таблицы **backupmediafamily** .</span><span class="sxs-lookup"><span data-stu-id="c56c0-251">The media-family number is recorded in the **family_sequence_number** column of the **backupmediafamily** table.</span></span>

-   <span data-ttu-id="c56c0-252">Физический носитель в семействе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-252">Physical media within a media family</span></span>

     <span data-ttu-id="c56c0-253">Порядковый номер носителя указывает на место физического носителя в семействе носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-253">A media sequence number indicates the order of the physical media within a media family.</span></span> <span data-ttu-id="c56c0-254">Порядковый номер начального носителя резервной копии равен 1.</span><span class="sxs-lookup"><span data-stu-id="c56c0-254">The sequence number is 1 for the initial backup media.</span></span> <span data-ttu-id="c56c0-255">Он обозначен цифрой 1, второй (первый дополнительный носитель) обозначен цифрой 2 и т.д.</span><span class="sxs-lookup"><span data-stu-id="c56c0-255">This is tagged with 1; the second (the first continuation tape) is tagged with 2; and so on.</span></span> <span data-ttu-id="c56c0-256">При восстановлении из резервного набора данных наличие порядковых номеров носителей позволяет гарантировать, что оператор, выполняющий восстановление, монтирует носители в правильном порядке.</span><span class="sxs-lookup"><span data-stu-id="c56c0-256">When the backup set is restored, the media sequence numbers make sure that the operator restoring the backup mounts the correct media in the correct order.</span></span>

###  <a name="multiple-devices"></a><a name="MultipleDevices"></a> <span data-ttu-id="c56c0-257">Несколько устройств</span><span class="sxs-lookup"><span data-stu-id="c56c0-257">Multiple Devices</span></span>
 <span data-ttu-id="c56c0-258">При использовании нескольких ленточных накопителей или дисковых файлов необходимо помнить о следующем.</span><span class="sxs-lookup"><span data-stu-id="c56c0-258">When you use multiple tape drives or disk files, the following considerations apply:</span></span>

-   <span data-ttu-id="c56c0-259">При резервном копировании.</span><span class="sxs-lookup"><span data-stu-id="c56c0-259">For backup:</span></span>

     <span data-ttu-id="c56c0-260">Весь набор носителей, созданный операцией резервного копирования, должен целиком использоваться всеми последующими операциями резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-260">The complete media set that is created by a backup operation must be used by all subsequent backup operations.</span></span> <span data-ttu-id="c56c0-261">Например, если в созданном наборе носителей используется два накопителя на магнитной ленте для резервного копирования, то все последующие операции резервного копирования, включающие этот набор носителей, должны использовать два устройства резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-261">For example, if a media set was created by using two tape backup devices, all subsequent backup operations that involve the same media set must use two backup devices.</span></span>

-   <span data-ttu-id="c56c0-262">При восстановлении.</span><span class="sxs-lookup"><span data-stu-id="c56c0-262">For restore:</span></span>

     <span data-ttu-id="c56c0-263">При любом восстановлении из резервных копий на диске или восстановлении «в сети», необходимо последовательно подключить все семейства носителей.</span><span class="sxs-lookup"><span data-stu-id="c56c0-263">For any restore from disk backups and for any online restore, all the all media families must be concurrently mounted.</span></span> <span data-ttu-id="c56c0-264">При восстановлении вне сети с ленточных устройств резервного копирования можно обработать семейства носителей с меньшего количества устройств резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="c56c0-264">For an offline restore from tape backups, you can process the media families from fewer backup devices.</span></span> <span data-ttu-id="c56c0-265">Каждое семейство носителей полностью обрабатывается перед тем, как начинается обработка другого.</span><span class="sxs-lookup"><span data-stu-id="c56c0-265">Each media family must be processed completely before starting to process another media family.</span></span> <span data-ttu-id="c56c0-266">Семейства носителей всегда обрабатываются параллельно, если происходит восстановление более чем с одного устройства.</span><span class="sxs-lookup"><span data-stu-id="c56c0-266">Media families are always processed in parallel, unless they are being restored with a single device.</span></span>

##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="c56c0-267">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="c56c0-267">Related Tasks</span></span>
 <span data-ttu-id="c56c0-268">**Создание нового набора носителей**</span><span class="sxs-lookup"><span data-stu-id="c56c0-268">**To create a new media set**</span></span>

-   <span data-ttu-id="c56c0-269">[Создание полной резервной копии базы данных (SQL Server)](create-a-full-database-backup-sql-server.md) (параметр **Создать резервную копию в новом наборе носителей и удалить все существующие резервные наборы данных**)</span><span class="sxs-lookup"><span data-stu-id="c56c0-269">[Create a Full Database Backup &#40;SQL Server&#41;](create-a-full-database-backup-sql-server.md) (**Back up to a new media set, and erase all existing backup sets** option)</span></span>

-   <span data-ttu-id="c56c0-270">[BACKUP (Transact-SQL)](/sql/t-sql/statements/backup-transact-sql) (параметр FORMAT)</span><span class="sxs-lookup"><span data-stu-id="c56c0-270">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) (FORMAT option)</span></span>

-   <xref:Microsoft.SqlServer.Management.Smo.Backup.FormatMedia%2A>

 <span data-ttu-id="c56c0-271">**Добавление новой резервной копии к существующим носителям**</span><span class="sxs-lookup"><span data-stu-id="c56c0-271">**To append a new backup to existing media**</span></span>

-   <span data-ttu-id="c56c0-272">[Создание полной резервной копии (SQL Server)](create-a-full-database-backup-sql-server.md) (параметр **Добавить в существующий резервный набор данных**)</span><span class="sxs-lookup"><span data-stu-id="c56c0-272">[Create a Full Database Backup &#40;SQL Server&#41;](create-a-full-database-backup-sql-server.md) (**Append to the existing backup set** option)</span></span>

-   <span data-ttu-id="c56c0-273">[BACKUP (Transact-SQL)](/sql/t-sql/statements/backup-transact-sql) (параметр NOINIT)</span><span class="sxs-lookup"><span data-stu-id="c56c0-273">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) (NOINIT option)</span></span>

 <span data-ttu-id="c56c0-274">**Перезапись существующих резервных наборов данных**</span><span class="sxs-lookup"><span data-stu-id="c56c0-274">**To overwrite existing backup sets**</span></span>

-   <span data-ttu-id="c56c0-275">[Создание полной резервной копии (SQL Server)](create-a-full-database-backup-sql-server.md) (параметр **Перезаписать все существующие резервные наборы данных**)</span><span class="sxs-lookup"><span data-stu-id="c56c0-275">[Create a Full Database Backup &#40;SQL Server&#41;](create-a-full-database-backup-sql-server.md) (**Overwrite all existing backup sets** option)</span></span>

-   <span data-ttu-id="c56c0-276">[BACKUP (Transact-SQL)](/sql/t-sql/statements/backup-transact-sql) (параметр INIT)</span><span class="sxs-lookup"><span data-stu-id="c56c0-276">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) (INIT option)</span></span>

 <span data-ttu-id="c56c0-277">**Задание даты истечения срока хранения**</span><span class="sxs-lookup"><span data-stu-id="c56c0-277">**To set the expiration date**</span></span>

-   [<span data-ttu-id="c56c0-278">Назначение срока хранения резервной копии (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c56c0-278">Set the Expiration Date on a Backup &#40;SQL Server&#41;</span></span>](set-the-expiration-date-on-a-backup-sql-server.md)

 <span data-ttu-id="c56c0-279">**Просмотр последовательности носителей и порядковых номеров семейств**</span><span class="sxs-lookup"><span data-stu-id="c56c0-279">**To view the media sequence and family sequence numbers**</span></span>

-   [<span data-ttu-id="c56c0-280">Просмотр свойств и содержимого логического устройства резервного копирования (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c56c0-280">View the Properties and Contents of a Logical Backup Device &#40;SQL Server&#41;</span></span>](view-the-properties-and-contents-of-a-logical-backup-device-sql-server.md)

-   <span data-ttu-id="c56c0-281">[backupmediafamily (Transact-SQL)](/sql/relational-databases/system-tables/backupmediafamily-transact-sql) (столбец **family_sequence_number**)</span><span class="sxs-lookup"><span data-stu-id="c56c0-281">[backupmediafamily &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupmediafamily-transact-sql) (**family_sequence_number** column)</span></span>

 <span data-ttu-id="c56c0-282">**Просмотр резервных наборов данных на конкретном устройстве резервного копирования**</span><span class="sxs-lookup"><span data-stu-id="c56c0-282">**To view the backup sets on a particular backup device**</span></span>

-   [<span data-ttu-id="c56c0-283">Просмотр файлов данных и журналов в резервном наборе данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c56c0-283">View the Data and Log Files in a Backup Set &#40;SQL Server&#41;</span></span>](view-the-data-and-log-files-in-a-backup-set-sql-server.md)

-   [<span data-ttu-id="c56c0-284">Просмотр свойств и содержимого логического устройства резервного копирования (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c56c0-284">View the Properties and Contents of a Logical Backup Device &#40;SQL Server&#41;</span></span>](view-the-properties-and-contents-of-a-logical-backup-device-sql-server.md)

-   [<span data-ttu-id="c56c0-285">RESTORE HEADERONLY (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c56c0-285">RESTORE HEADERONLY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/restore-statements-headeronly-transact-sql)

 <span data-ttu-id="c56c0-286">**Считывание заголовка носителя с устройства резервного копирования**</span><span class="sxs-lookup"><span data-stu-id="c56c0-286">**To read the media header of the media on a backup device**</span></span>

-   [<span data-ttu-id="c56c0-287">RESTORE LABELONLY (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c56c0-287">RESTORE LABELONLY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/restore-statements-labelonly-transact-sql)


## <a name="see-also"></a><span data-ttu-id="c56c0-288">См. также:</span><span class="sxs-lookup"><span data-stu-id="c56c0-288">See Also</span></span>
 <span data-ttu-id="c56c0-289">[Резервное копирование и восстановление SQL Server баз данных](back-up-and-restore-of-sql-server-databases.md) [возможные ошибки носителя во время резервного копирования и восстановления &#40;SQL Server&#41;](possible-media-errors-during-backup-and-restore-sql-server.md) [Журнал резервного копирования и сведения о заголовке &#40;](backup-history-and-header-information-sql-server.md) [SQL Server&#41;](mirrored-backup-media-sets-sql-server.md) [SQL server](/sql/t-sql/statements/backup-transact-sql) &#40;Restore SQL Server&#41;TRANSACT- [sql &#40;](/sql/t-sql/statements/restore-statements-transact-sql) REstore [REWINDONLY&#41;Transact-SQL &#40;](/sql/t-sql/statements/restore-statements-rewindonly-transact-sql) [&#41;&#40;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql)&#41;</span><span class="sxs-lookup"><span data-stu-id="c56c0-289">[Back Up and Restore of SQL Server Databases](back-up-and-restore-of-sql-server-databases.md) [Possible Media Errors During Backup and Restore &#40;SQL Server&#41;](possible-media-errors-during-backup-and-restore-sql-server.md) [Backup History and Header Information &#40;SQL Server&#41;](backup-history-and-header-information-sql-server.md) [Mirrored Backup Media Sets &#40;SQL Server&#41;](mirrored-backup-media-sets-sql-server.md) [BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) [RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql) [RESTORE REWINDONLY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-rewindonly-transact-sql) [sp_configure &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql)</span></span>


