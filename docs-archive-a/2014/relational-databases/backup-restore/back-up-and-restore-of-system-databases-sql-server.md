---
title: Резервное копирование и восстановление системных баз данных (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- system databases [SQL Server], backing up and restoring
- restoring system databases [SQL Server]
- backing up [SQL Server], system databases
- database backups [SQL Server], system databases
- servers [SQL Server], backup
ms.assetid: aef0c4fa-ba67-413d-9359-1a67682fdaab
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 51ccf1aeadcf4ab9a662cdd629a812d3ee4b82aa
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668953"
---
# <a name="back-up-and-restore-of-system-databases-sql-server"></a><span data-ttu-id="6cca4-102">Резервное копирование и восстановление системных баз данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6cca4-102">Back Up and Restore of System Databases (SQL Server)</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6cca4-103">поддерживает набор баз данных системного уровня, которые называются*системными базами данных*и жизненно важны для работы экземпляра сервера.</span><span class="sxs-lookup"><span data-stu-id="6cca4-103">maintains a set of system-level databases, s*ystem databases*, which are essential for the operation of a server instance.</span></span> <span data-ttu-id="6cca4-104">После каждого значительного обновления необходимо обязательно создавать резервные копии ряда системных баз данных:</span><span class="sxs-lookup"><span data-stu-id="6cca4-104">Several of the system databases must be backed up after every significant update.</span></span> <span data-ttu-id="6cca4-105">**msdb**, **master**и **model**.</span><span class="sxs-lookup"><span data-stu-id="6cca4-105">The system databases that you must always back up include **msdb**, **master**, and **model**.</span></span> <span data-ttu-id="6cca4-106">Если какая-нибудь из баз данных на экземпляре сервера использует репликацию, то необходимо также создавать резервную копию системной базы данных **distribution** .</span><span class="sxs-lookup"><span data-stu-id="6cca4-106">If any database uses replication on the server instance, there is a **distribution** system database that you must also back up.</span></span> <span data-ttu-id="6cca4-107">Резервные копии системных баз данных позволят восстановить систему [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в случае сбоя, например отказа жесткого диска.</span><span class="sxs-lookup"><span data-stu-id="6cca4-107">Backups of these system databases let you restore and recover the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] system in the event of system failure, such as the loss of a hard disk.</span></span>  
  
 <span data-ttu-id="6cca4-108">В следующей таблице перечислены все системные базы данных.</span><span class="sxs-lookup"><span data-stu-id="6cca4-108">The following table summarizes all of the system databases.</span></span>  
  
|<span data-ttu-id="6cca4-109">Системная база данных</span><span class="sxs-lookup"><span data-stu-id="6cca4-109">System database</span></span>|<span data-ttu-id="6cca4-110">Описание</span><span class="sxs-lookup"><span data-stu-id="6cca4-110">Description</span></span>|<span data-ttu-id="6cca4-111">Необходимость создавать резервные копии</span><span class="sxs-lookup"><span data-stu-id="6cca4-111">Are backups required?</span></span>|<span data-ttu-id="6cca4-112">Модель восстановления</span><span class="sxs-lookup"><span data-stu-id="6cca4-112">Recovery model</span></span>|<span data-ttu-id="6cca4-113">Комментарии</span><span class="sxs-lookup"><span data-stu-id="6cca4-113">Comments</span></span>|  
|---------------------|-----------------|---------------------------|--------------------|--------------|  
|[<span data-ttu-id="6cca4-114">master</span><span class="sxs-lookup"><span data-stu-id="6cca4-114">master</span></span>](../databases/master-database.md)|<span data-ttu-id="6cca4-115">База данных, в которой хранятся все системные данные [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6cca4-115">The database that records all of the system level information for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] system.</span></span>|<span data-ttu-id="6cca4-116">Да</span><span class="sxs-lookup"><span data-stu-id="6cca4-116">Yes</span></span>|<span data-ttu-id="6cca4-117">Простая</span><span class="sxs-lookup"><span data-stu-id="6cca4-117">Simple</span></span>|<span data-ttu-id="6cca4-118">Создавайте резервные копии базы данных **master** с такой частотой, которая необходима для адекватной защиты данных.</span><span class="sxs-lookup"><span data-stu-id="6cca4-118">Back up **master** as often as necessary to protect the data sufficiently for your business needs.</span></span> <span data-ttu-id="6cca4-119">Рекомендуем составить расписание регулярного резервного копирования, которое можно дополнить созданием резервных копий после значительных обновлений.</span><span class="sxs-lookup"><span data-stu-id="6cca4-119">We recommend a regular backup schedule, which you can supplement with an additional backup after a substantial update.</span></span>|  
|[<span data-ttu-id="6cca4-120">model</span><span class="sxs-lookup"><span data-stu-id="6cca4-120">model</span></span>](../databases/model-database.md)|<span data-ttu-id="6cca4-121">Шаблон для всех баз данных, создаваемых на экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6cca4-121">The template for all databases that are created on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|<span data-ttu-id="6cca4-122">Да</span><span class="sxs-lookup"><span data-stu-id="6cca4-122">Yes</span></span>|<span data-ttu-id="6cca4-123">Пользователь, настраиваемый<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="6cca4-123">User configurable<sup>1</sup></span></span>|<span data-ttu-id="6cca4-124">Резервные копии базы данных **model** создаются только в том случае, если они необходимы для предприятия (например сразу же после настройки параметров базы данных).</span><span class="sxs-lookup"><span data-stu-id="6cca4-124">Back up **model** only when necessary for your business needs; for example, immediately after customizing its database options.</span></span><br /><br /> <span data-ttu-id="6cca4-125">**Рекомендация.** Рекомендуется по мере необходимости создавать только полные резервные копии базы данных **model**.</span><span class="sxs-lookup"><span data-stu-id="6cca4-125">**Best practice:** We recommend that you create only full database backups of **model**, as required.</span></span> <span data-ttu-id="6cca4-126">Поскольку база данных **model** невелика и редко изменяется, создавать резервную копию журнала не обязательно.</span><span class="sxs-lookup"><span data-stu-id="6cca4-126">Because **model** is small and rarely changes, backing up the log is unnecessary.</span></span>|  
|[<span data-ttu-id="6cca4-127">msdb</span><span class="sxs-lookup"><span data-stu-id="6cca4-127">msdb</span></span>](../databases/msdb-database.md)|<span data-ttu-id="6cca4-128">База данных, используемая агентом [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для планирования предупреждений и заданий и для записи операторов.</span><span class="sxs-lookup"><span data-stu-id="6cca4-128">The database used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent for scheduling alerts and jobs, and for recording operators.</span></span> <span data-ttu-id="6cca4-129">База данных**msdb** также содержит такие таблицы журнала, как таблицы резервных копий и журнала восстановления.</span><span class="sxs-lookup"><span data-stu-id="6cca4-129">**msdb** also contains history tables such as the backup and restore history tables.</span></span>|<span data-ttu-id="6cca4-130">Да</span><span class="sxs-lookup"><span data-stu-id="6cca4-130">Yes</span></span>|<span data-ttu-id="6cca4-131">Простая (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="6cca4-131">Simple (default)</span></span>|<span data-ttu-id="6cca4-132">Создавайте резервную копию базы данных **msdb** после каждого ее обновления.</span><span class="sxs-lookup"><span data-stu-id="6cca4-132">Back up **msdb** whenever it is updated.</span></span>|  
|<span data-ttu-id="6cca4-133">[Resource](../databases/resource-database.md) (RDB)</span><span class="sxs-lookup"><span data-stu-id="6cca4-133">[Resource](../databases/resource-database.md) (RDB)</span></span>|<span data-ttu-id="6cca4-134">База данных только для чтения, которая содержит копии всех системных объектов, поставляемых с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="6cca4-134">A read-only database that contains copies of all system objects that ship with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>|<span data-ttu-id="6cca4-135">нет</span><span class="sxs-lookup"><span data-stu-id="6cca4-135">No</span></span>|-|<span data-ttu-id="6cca4-136">База данных **Resource** находится в файле mssqlsystemresource.mdf, в котором содержится только код.</span><span class="sxs-lookup"><span data-stu-id="6cca4-136">The **Resource** database resides in the mssqlsystemresource.mdf file, which contains only code.</span></span> <span data-ttu-id="6cca4-137">Поэтому [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не может создать резервную копию базы данных **Resource** .</span><span class="sxs-lookup"><span data-stu-id="6cca4-137">Therefore, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cannot back up the **Resource** database.</span></span><br /><br /> <span data-ttu-id="6cca4-138">Примечание. Рассматривая файл mssqlsystemresource.mdf как двоичный файл (EXE), а не файл базы данных, для создания его резервной копии можно выполнить простое резервное копирование файла или диска.</span><span class="sxs-lookup"><span data-stu-id="6cca4-138">Note: You can perform a file-based or a disk-based backup on the mssqlsystemresource.mdf file by treating the file as if it were a binary (.exe) file, instead of a database file.</span></span> <span data-ttu-id="6cca4-139">Нельзя использовать восстановление [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для резервных копий.</span><span class="sxs-lookup"><span data-stu-id="6cca4-139">But you cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] restore on the backups.</span></span> <span data-ttu-id="6cca4-140">Восстановить резервную копию файла mssqlsystemresource.mdf можно будет только вручную; при этом следует соблюдать осторожность, чтобы не перезаписать текущую базу данных **Resource** устаревшей или потенциально небезопасной версией.</span><span class="sxs-lookup"><span data-stu-id="6cca4-140">Restoring a backup copy of mssqlsystemresource.mdf can only be done manually, and you must be careful not to overwrite the current **Resource** database with an out-of-date or potentially insecure version.</span></span>|  
|[<span data-ttu-id="6cca4-141">tempdb</span><span class="sxs-lookup"><span data-stu-id="6cca4-141">tempdb</span></span>](../databases/tempdb-database.md)|<span data-ttu-id="6cca4-142">Рабочая область для хранения временных или промежуточных результирующих наборов.</span><span class="sxs-lookup"><span data-stu-id="6cca4-142">A workspace for holding temporary or intermediate result sets.</span></span> <span data-ttu-id="6cca4-143">Эта база данных создается заново при каждом запуске экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6cca4-143">This database is re-created every time an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is started.</span></span> <span data-ttu-id="6cca4-144">При отключении экземпляра сервера любые сведения, содержащиеся в базе данных **tempdb** , удаляются навсегда.</span><span class="sxs-lookup"><span data-stu-id="6cca4-144">When the server instance is shut down, any data in **tempdb** is deleted permanently.</span></span>|<span data-ttu-id="6cca4-145">нет</span><span class="sxs-lookup"><span data-stu-id="6cca4-145">No</span></span>|<span data-ttu-id="6cca4-146">Простая</span><span class="sxs-lookup"><span data-stu-id="6cca4-146">Simple</span></span>|<span data-ttu-id="6cca4-147">Создать резервную копию системной базы данных **tempdb** нельзя.</span><span class="sxs-lookup"><span data-stu-id="6cca4-147">You cannot back up the **tempdb** system database.</span></span>|  
|[<span data-ttu-id="6cca4-148">Настройка распространения</span><span class="sxs-lookup"><span data-stu-id="6cca4-148">Configure Distribution</span></span>](../replication/configure-distribution.md)|<span data-ttu-id="6cca4-149">База данных, которая существует только в том случае, если сервер настроен как распространитель репликации.</span><span class="sxs-lookup"><span data-stu-id="6cca4-149">A database that exists only if the server is configured as a replication Distributor.</span></span> <span data-ttu-id="6cca4-150">Эта база данных содержит метаданные и данные журнала для всех типов репликации, а также транзакции для репликации транзакций.</span><span class="sxs-lookup"><span data-stu-id="6cca4-150">This database stores metadata and history data for all types of replication, and transactions for transactional replication.</span></span>|<span data-ttu-id="6cca4-151">Да</span><span class="sxs-lookup"><span data-stu-id="6cca4-151">Yes</span></span>|<span data-ttu-id="6cca4-152">Простая</span><span class="sxs-lookup"><span data-stu-id="6cca4-152">Simple</span></span>|<span data-ttu-id="6cca4-153">Сведения о том, когда следует создавать резервные копии базы данных **distribution** , см. в статье [Создание резервной копии и восстановление из копий реплицируемых баз данных](../replication/administration/back-up-and-restore-replicated-databases.md).</span><span class="sxs-lookup"><span data-stu-id="6cca4-153">For information about when to back up the **distribution** database, see [Back Up and Restore Replicated Databases](../replication/administration/back-up-and-restore-replicated-databases.md).</span></span>|  
  
 <span data-ttu-id="6cca4-154"><sup>1</sup> чтобы узнать текущую модель восстановления модели, см. статью [Просмотр или изменение модели восстановления базы данных &#40;SQL Server&#41;](view-or-change-the-recovery-model-of-a-database-sql-server.md) или [sys. databases &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6cca4-154"><sup>1</sup> To learn the current recovery model of the model, see [View or Change the Recovery Model of a Database &#40;SQL Server&#41;](view-or-change-the-recovery-model-of-a-database-sql-server.md) or [sys.databases &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql).</span></span>  
  
## <a name="limitations-on-restoring-system-databases"></a><span data-ttu-id="6cca4-155">Ограничения восстановления системных баз данных</span><span class="sxs-lookup"><span data-stu-id="6cca4-155">Limitations on Restoring System Databases</span></span>  
  
-   <span data-ttu-id="6cca4-156">Системные базы данных могут быть восстановлены только из резервных копий, созданных той версией [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которая запущена на данном экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="6cca4-156">System databases can be restored only from backups that are created on the version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that the server instance is currently running.</span></span> <span data-ttu-id="6cca4-157">Например, чтобы восстановить системную базу данных на экземпляре сервера, работающем на сервере с [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] пакетом обновления 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="6cca4-157">For example, to restore a system database on a server instance that is running on [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] SP1.</span></span>  
  
-   <span data-ttu-id="6cca4-158">Для восстановления любой базы данных должен быть запущен экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6cca4-158">To restore any database, the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must be running.</span></span> <span data-ttu-id="6cca4-159">Для запуска экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] необходимо, чтобы база данных **master** была доступна и хотя бы частично пригодна к использованию.</span><span class="sxs-lookup"><span data-stu-id="6cca4-159">Startup of an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] requires that the **master** database is accessible and at least partly usable.</span></span> <span data-ttu-id="6cca4-160">Если база данных **master** непригодна к использованию, ее можно вернуть в нормальное состояние следующими способами.</span><span class="sxs-lookup"><span data-stu-id="6cca4-160">If **master** becomes unusable, you can return the database to a usable state in either of the following ways:</span></span>  
  
    -   <span data-ttu-id="6cca4-161">Восстановить базу данных **master** на основе актуальной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="6cca4-161">Restore **master** from a current database backup.</span></span>  
  
         <span data-ttu-id="6cca4-162">Если экземпляр сервера удалось запустить, базу данных **master** можно восстановить из полной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="6cca4-162">If you can start the server instance, you should be able to restore **master** from a full database backup.</span></span>  
  
    -   <span data-ttu-id="6cca4-163">Перестроить базу данных **master** с нуля.</span><span class="sxs-lookup"><span data-stu-id="6cca4-163">Rebuild **master** completely.</span></span>  
  
         <span data-ttu-id="6cca4-164">Если серьезное повреждение базы данных **master** не позволяет запустить экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], базу данных **master**нужно перестроить.</span><span class="sxs-lookup"><span data-stu-id="6cca4-164">If severe damage to **master** prevents you from starting [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you must rebuild **master**.</span></span> <span data-ttu-id="6cca4-165">Дополнительные сведения см. в разделе [Перестроение системных баз данных](../databases/system-databases.md).</span><span class="sxs-lookup"><span data-stu-id="6cca4-165">For more information, see [Rebuild System Databases](../databases/system-databases.md).</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="6cca4-166">При перестроении базы данных **master** все системные базы данных также перестраиваются.</span><span class="sxs-lookup"><span data-stu-id="6cca4-166">Rebuilding **master** rebuilds all of the system databases.</span></span>  
  
-   <span data-ttu-id="6cca4-167">В некоторых случаях для проблем, связанных с восстановлением табличного шаблона базы данных модели, может потребоваться перестроение системных баз данных или замена MDF- и LDF-файлов базы данных модели.</span><span class="sxs-lookup"><span data-stu-id="6cca4-167">Under some circumstances, problems recovering the model database may require rebuilding the system databases or replacing the mdf and ldf files for the model database.</span></span> <span data-ttu-id="6cca4-168">Дополнительные сведения см. в разделе [Перестроение системных баз данных](../databases/system-databases.md).</span><span class="sxs-lookup"><span data-stu-id="6cca4-168">For more information, see [Rebuild System Databases](../databases/system-databases.md).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="6cca4-169">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="6cca4-169">Related Tasks</span></span>  
  
-   [<span data-ttu-id="6cca4-170">Создание полной резервной копии базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6cca4-170">Create a Full Database Backup &#40;SQL Server&#41;</span></span>](create-a-full-database-backup-sql-server.md)  
  
-   [<span data-ttu-id="6cca4-171">Выполнение полного восстановления базы данных (простая модель восстановления)</span><span class="sxs-lookup"><span data-stu-id="6cca4-171">Complete Database Restores &#40;Simple Recovery Model&#41;</span></span>](complete-database-restores-simple-recovery-model.md)  
  
-   [<span data-ttu-id="6cca4-172">Восстановление базы данных master (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="6cca4-172">Restore the master Database &#40;Transact-SQL&#41;</span></span>](restore-the-master-database-transact-sql.md)  
  
-   [<span data-ttu-id="6cca4-173">Просмотр или изменение модели восстановления базы данных (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6cca4-173">View or Change the Recovery Model of a Database &#40;SQL Server&#41;</span></span>](view-or-change-the-recovery-model-of-a-database-sql-server.md)  
  
-   [<span data-ttu-id="6cca4-174">Перемещение системных баз данных</span><span class="sxs-lookup"><span data-stu-id="6cca4-174">Move System Databases</span></span>](../databases/move-system-databases.md)  
  
## <a name="see-also"></a><span data-ttu-id="6cca4-175">См. также:</span><span class="sxs-lookup"><span data-stu-id="6cca4-175">See Also</span></span>  
 <span data-ttu-id="6cca4-176">[База данных распространителя](../../relational-databases/replication/distribution-database.md) </span><span class="sxs-lookup"><span data-stu-id="6cca4-176">[Distribution Database](../../relational-databases/replication/distribution-database.md) </span></span>  
 <span data-ttu-id="6cca4-177">[База данных master](../databases/master-database.md) </span><span class="sxs-lookup"><span data-stu-id="6cca4-177">[master Database](../databases/master-database.md) </span></span>  
 <span data-ttu-id="6cca4-178">[База данных msdb](../databases/msdb-database.md) </span><span class="sxs-lookup"><span data-stu-id="6cca4-178">[msdb Database](../databases/msdb-database.md) </span></span>  
 <span data-ttu-id="6cca4-179">[База данных model](../databases/model-database.md) </span><span class="sxs-lookup"><span data-stu-id="6cca4-179">[model Database](../databases/model-database.md) </span></span>  
 <span data-ttu-id="6cca4-180">[База данных Resource](../databases/resource-database.md) </span><span class="sxs-lookup"><span data-stu-id="6cca4-180">[Resource Database](../databases/resource-database.md) </span></span>  
 [<span data-ttu-id="6cca4-181">База данных tempdb</span><span class="sxs-lookup"><span data-stu-id="6cca4-181">tempdb Database</span></span>](../databases/tempdb-database.md)  
  
  
