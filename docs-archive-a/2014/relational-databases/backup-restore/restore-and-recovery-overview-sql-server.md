---
title: Обзор процессов восстановления (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- restoring tables [SQL Server]
- backups [SQL Server], restore scenarios
- database backups [SQL Server], restore scenarios
- database restores [SQL Server]
- restoring [SQL Server]
- restores [SQL Server]
- table restores [SQL Server]
- restoring databases [SQL Server], about restoring databases
- database restores [SQL Server], scenarios
ms.assetid: e985c9a6-4230-4087-9fdb-de8571ba5a5f
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 2b8f032dce4f2eb09ef80cfa8c6333de2d563a81
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736434"
---
# <a name="restore-and-recovery-overview-sql-server"></a><span data-ttu-id="f1a75-102">Обзор процессов восстановления (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="f1a75-102">Restore and Recovery Overview (SQL Server)</span></span>
  <span data-ttu-id="f1a75-103">Чтобы восстановить базу данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] после сбоя, администратор базы данных должен восстановить набор резервных копий [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в составе логически верной и содержательной последовательности восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-103">To recover a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database from a failure, a database administrator has to restore a set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backups in a logically correct and meaningful restore sequence.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="f1a75-104">поддерживает восстановление данных из резервных копий целой базы данных, файла данных или страниц данных следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f1a75-104">restore and recovery supports restoring data from backups of a whole database, a data file, or a data page, as follows:</span></span>  
  
-   <span data-ttu-id="f1a75-105">База данных ( *полное восстановление базы данных*)</span><span class="sxs-lookup"><span data-stu-id="f1a75-105">The database (a *complete database restore*)</span></span>  
  
     <span data-ttu-id="f1a75-106">Вся база данных возвращается в прежнее состояние и восстанавливается, при этом база данных находится в режиме вне сети во время операций возврата и восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-106">The whole database is restored and recovered, and the database is offline for the duration of the restore and recovery operations.</span></span>  
  
-   <span data-ttu-id="f1a75-107">Файл данных ( *восстановление файла*)</span><span class="sxs-lookup"><span data-stu-id="f1a75-107">The data file (a *file restore*)</span></span>  
  
     <span data-ttu-id="f1a75-108">Файл данных или набор файлов данных возвращается в исходное состояние и восстанавливается.</span><span class="sxs-lookup"><span data-stu-id="f1a75-108">A data file or a set of files is restored and recovered.</span></span> <span data-ttu-id="f1a75-109">Во время восстановления файлов файловые группы, содержащие обрабатываемые файлы, автоматически переводятся в режим вне сети на время восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-109">During a file restore, the filegroups that contain the files are automatically offline for the duration of the restore.</span></span> <span data-ttu-id="f1a75-110">Любые попытки подключения и работы с файловой группой вне сети приведут к ошибке.</span><span class="sxs-lookup"><span data-stu-id="f1a75-110">Any attempt to access an offline filegroup causes an error.</span></span>  
  
-   <span data-ttu-id="f1a75-111">Страница данных ( *восстановление страницы*)</span><span class="sxs-lookup"><span data-stu-id="f1a75-111">The data page (a *page restore*)</span></span>  
  
     <span data-ttu-id="f1a75-112">При использовании модели полного восстановления или модели восстановления с неполным протоколированием можно восстановить отдельные базы данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-112">Under the full recovery model or bulk-logged recovery model, you can restore individual databases.</span></span> <span data-ttu-id="f1a75-113">Восстановление страниц может применяться для любой базы данных вне зависимости от числа файловых групп.</span><span class="sxs-lookup"><span data-stu-id="f1a75-113">Page restores can be performed on any database, regardless of the number of filegroups.</span></span>  
  
 <span data-ttu-id="f1a75-114">Резервное копирование и восстановление [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] работает во всех поддерживаемых операционных системах (и в 32-разрядных, и в 64-разрядных версиях).</span><span class="sxs-lookup"><span data-stu-id="f1a75-114">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backup and restore work across all supported operating systems, whether they are 64-bit or 32-bit systems.</span></span> <span data-ttu-id="f1a75-115">Сведения о поддерживаемых операционных системах см. в разделе [требования к оборудованию и программному обеспечению для установки SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-115">For information about the supported operating systems, see [Hardware and Software Requirements for Installing SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md).</span></span> <span data-ttu-id="f1a75-116">Сведения о поддержке резервных копий более ранних версий [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]см. в подразделе "Поддержка совместимости" раздела [RESTORE (Transact-SQL)](/sql/t-sql/statements/restore-statements-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f1a75-116">For information about support for backups from earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see the "Compatibility Support" section of [RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql).</span></span>  
  
 <span data-ttu-id="f1a75-117">**В этом разделе.**</span><span class="sxs-lookup"><span data-stu-id="f1a75-117">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="f1a75-118">Общие сведения о сценариях восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-118">Overview of Restore Scenarios</span></span>](#RestoreScenariosOv)  
  
-   [<span data-ttu-id="f1a75-119">Модели восстановления и поддерживаемые операции восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-119">Recovery Models and Supported Restore Operations</span></span>](#RMsAndSupportedRestoreOps)  
  
-   [<span data-ttu-id="f1a75-120">Ограничения для восстановления по простой модели восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-120">Restore Restrictions Under the Simple Recovery Model</span></span>](#RMsimpleScenarios)  
  
-   [<span data-ttu-id="f1a75-121">Восстановление в модели восстановления с негрупповым протоколированием</span><span class="sxs-lookup"><span data-stu-id="f1a75-121">Restore Under the Bulk-Logged Recovery Model</span></span>](#RMblogRestore)  
  
-   [<span data-ttu-id="f1a75-122">Помощник по восстановлению базы данных (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="f1a75-122">Database Recovery Advisor (SQL Server Management Studio)</span></span>](#DRA)  
  
-   [<span data-ttu-id="f1a75-123">См. также</span><span class="sxs-lookup"><span data-stu-id="f1a75-123">Related Content</span></span>](#RelatedContent)  
  
##  <a name="overview-of-restore-scenarios"></a><a name="RestoreScenariosOv"></a> <span data-ttu-id="f1a75-124">Общие сведения о сценариях восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-124">Overview of Restore Scenarios</span></span>  
 <span data-ttu-id="f1a75-125">*Сценарий восстановления* в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] — процесс восстановления данных из одной или более резервных копий и возврат в исходное состояние базы данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-125">A *restore scenario* in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is the process of restoring data from one or more backups and then recovering the database.</span></span> <span data-ttu-id="f1a75-126">Поддерживаемые сценарии восстановления зависят от модели восстановления базы данных и выпуска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f1a75-126">The supported restore scenarios depend on the recovery model of the database and the edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="f1a75-127">Следующая таблица предоставляет возможные сценарии восстановления, которые поддерживаются различными моделями восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-127">The following table introduces the possible restore scenarios that are supported for different recovery models.</span></span>  
  
|<span data-ttu-id="f1a75-128">Сценарий восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-128">Restore scenario</span></span>|<span data-ttu-id="f1a75-129">Простая модель восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-129">Under simple recovery model</span></span>|<span data-ttu-id="f1a75-130">Модель полного восстановления или модель восстановления с неполным протоколированием</span><span class="sxs-lookup"><span data-stu-id="f1a75-130">Under full/bulk-logged recovery models</span></span>|  
|----------------------|---------------------------------|----------------------------------------------|  
|<span data-ttu-id="f1a75-131">полное восстановление базы данных</span><span class="sxs-lookup"><span data-stu-id="f1a75-131">Complete database restore</span></span>|<span data-ttu-id="f1a75-132">Это базовая стратегия восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-132">This is the basic restore strategy.</span></span> <span data-ttu-id="f1a75-133">Полное восстановление базы данных может содержать простые операции возврата и восстановления из полной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="f1a75-133">A complete database restore might involve simply restoring and recovering a full database backup.</span></span> <span data-ttu-id="f1a75-134">Также полное восстановление базы данных может проводиться на основе полной резервной копии базы данных с ее последующим обновлением по журналу.</span><span class="sxs-lookup"><span data-stu-id="f1a75-134">Alternatively, a complete database restore might involve restoring a full database backup followed by restoring and recovering a differential backup.</span></span><br /><br /> <span data-ttu-id="f1a75-135">Дополнительные сведения см. в разделе [Полное восстановление базы данных (простая модель восстановления)](complete-database-restores-simple-recovery-model.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-135">For more information, see [Complete Database Restores &#40;Simple Recovery Model&#41;](complete-database-restores-simple-recovery-model.md).</span></span>|<span data-ttu-id="f1a75-136">Это базовая стратегия восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-136">This is the basic restore strategy.</span></span> <span data-ttu-id="f1a75-137">Восстановление всей базы данных включает в себя восстановление полной резервной копии, возможно, разностных резервных копий (если они есть) и восстановления всех последующих резервных копий журналов (последовательно).</span><span class="sxs-lookup"><span data-stu-id="f1a75-137">A complete database restore involve restoring a full database backup and, optionally, a differential backup (if any), followed by restoring all subsequent log backups (in sequence).</span></span> <span data-ttu-id="f1a75-138">Восстановление всей базы данных завершается восстановлением из последней резервной копии журнала и возвратом в исходное состояние (RESTORE WITH RECOVERY).</span><span class="sxs-lookup"><span data-stu-id="f1a75-138">The complete database restore is finished by recovering the last log backup and also restoring it (RESTORE WITH RECOVERY).</span></span><br /><br /> <span data-ttu-id="f1a75-139">Дополнительные сведения см. в статье [Выполнение полного восстановления базы данных (модель полного восстановления)](complete-database-restores-full-recovery-model.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-139">For more information, see [Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md)</span></span>|  
|<span data-ttu-id="f1a75-140">File restore **\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-140">File restore **\***</span></span>|<span data-ttu-id="f1a75-141">Восстановление одного или более поврежденных файлов с атрибутом «только для чтения» без восстановления всей базы данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-141">Restore one or more damaged read-only files, without restoring the entire database.</span></span> <span data-ttu-id="f1a75-142">Восстановление файла возможно только при наличии в базе данных хотя бы одной файловой группы с атрибутом «только для чтения».</span><span class="sxs-lookup"><span data-stu-id="f1a75-142">File restore is available only if the database has at least one read-only filegroup.</span></span>|<span data-ttu-id="f1a75-143">Восстановление одного или нескольких файлов без восстановления всей базы данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-143">Restores one or more files, without restoring the entire database.</span></span> <span data-ttu-id="f1a75-144">Восстановление файлов может выполняться, когда база данных находится в режиме «вне сети» или в некоторых выпусках [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]«в сети».</span><span class="sxs-lookup"><span data-stu-id="f1a75-144">File restore can be performed while the database is offline or, for some editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], while the database remains online.</span></span> <span data-ttu-id="f1a75-145">Во время восстановления файла файловые группы, содержащие обрабатываемый файл, всегда находятся в режиме вне сети.</span><span class="sxs-lookup"><span data-stu-id="f1a75-145">During a file restore, the filegroups that contain the files that are being restored are always offline.</span></span>|  
|<span data-ttu-id="f1a75-146">Восстановление страницы</span><span class="sxs-lookup"><span data-stu-id="f1a75-146">Page restore</span></span>|<span data-ttu-id="f1a75-147">Неприменимо</span><span class="sxs-lookup"><span data-stu-id="f1a75-147">Not applicable</span></span>|<span data-ttu-id="f1a75-148">Восстановление одной или нескольких поврежденных страниц.</span><span class="sxs-lookup"><span data-stu-id="f1a75-148">Restores one or more damaged pages.</span></span> <span data-ttu-id="f1a75-149">Восстановление страницы может выполняться, когда база данных находится в режиме «вне сети» или в некоторых выпусках [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]«в сети».</span><span class="sxs-lookup"><span data-stu-id="f1a75-149">Page restore can be performed while the database is offline or, for some editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], while the database remains online.</span></span> <span data-ttu-id="f1a75-150">Во время восстановления страницы всегда находятся в режиме вне сети.</span><span class="sxs-lookup"><span data-stu-id="f1a75-150">During a page restore, the pages that are being restored are always offline.</span></span><br /><br /> <span data-ttu-id="f1a75-151">Должна быть доступна непрерывная цепь резервных копий журнала вплоть до текущего файла журнала, и они должны быть применены для приведения страницы в соответствие текущему журналу.</span><span class="sxs-lookup"><span data-stu-id="f1a75-151">An unbroken chain of log backups must be available, up to the current log file, and they must all be applied to bring the page up to date with the current log file.</span></span><br /><br /> <span data-ttu-id="f1a75-152">Дополнительные сведения см. в разделе [Восстановление страниц (SQL Server)](restore-pages-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-152">For more information, see [Restore Pages &#40;SQL Server&#41;](restore-pages-sql-server.md).</span></span>|  
|<span data-ttu-id="f1a75-153">Поэтапное восстановление **\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-153">Piecemeal restore **\***</span></span>|<span data-ttu-id="f1a75-154">Поэтапное восстановление базы данных на уровне файловой группы, начиная с групп файлов, доступных для чтения и записи, вторичных файловых групп.</span><span class="sxs-lookup"><span data-stu-id="f1a75-154">Restore and recover the database in stages at the filegroup level, starting with the primary and all read/write, secondary filegroups.</span></span>|<span data-ttu-id="f1a75-155">Восстановление и перевод базы данных в режим в сети по этапам на уровне файловой группы, начиная с первичной файловой группы.</span><span class="sxs-lookup"><span data-stu-id="f1a75-155">Restore and recover the database in stages at the filegroup level, starting with the primary filegroup.</span></span>|  
  
 <span data-ttu-id="f1a75-156">**\*** Восстановление в сети поддерживается только в выпуске Enterprise Edition.</span><span class="sxs-lookup"><span data-stu-id="f1a75-156">**\*** Online restore is supported only in the Enterprise edition.</span></span>  
  
 <span data-ttu-id="f1a75-157">Независимо от способа восстановления данных, перед восстановлением базы данных [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] обеспечивает логическую согласованность всей базы данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-157">Regardless of how data is restored, before a database can be recovered, the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] guarantees that the whole database is logically consistent.</span></span> <span data-ttu-id="f1a75-158">Например, если файл был возвращен в исходное состояние, то нельзя восстановить его и вернуть в режим в сети, пока в нем не будет выполнено достаточное количество транзакций, чтобы он согласовывался с базой данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-158">For example, if you restore a file, you cannot recover it and bring it online until it has been rolled far enough forward to be consistent with the database.</span></span>  
  
### <a name="advantages-of-a-file-or-page-restore"></a><span data-ttu-id="f1a75-159">Преимущества восстановления файлов или страниц</span><span class="sxs-lookup"><span data-stu-id="f1a75-159">Advantages of a File or Page Restore</span></span>  
 <span data-ttu-id="f1a75-160">Восстановление файлов и страниц вместо восстановления всей базы данных целиком дает следующие преимущества.</span><span class="sxs-lookup"><span data-stu-id="f1a75-160">Restoring and recovering files or pages, instead of the whole database, provides the following advantages:</span></span>  
  
-   <span data-ttu-id="f1a75-161">Восстановление данных меньшего объема данных уменьшает время, затрачиваемое на копирование и восстановление.</span><span class="sxs-lookup"><span data-stu-id="f1a75-161">Restoring less data reduces the time required to copy and recover it.</span></span>  
  
-   <span data-ttu-id="f1a75-162">В среде [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] восстановление файлов или страниц позволяет другим данным в базе данных оставаться в режиме «в сети» во время операции восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-162">On [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] restoring files or pages might allow other data in the database to remain online during the restore operation.</span></span>  
  
##  <a name="recovery-models-and-supported-restore-operations"></a><a name="RMsAndSupportedRestoreOps"></a><span data-ttu-id="f1a75-163">Модели восстановления и поддерживаемые операции восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-163">Recovery Models and Supported Restore Operations</span></span>  
 <span data-ttu-id="f1a75-164">Модель восстановления определяет перечень операций, доступных при восстановлении базы данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-164">The restore operations that are available for a database depend on its recovery model.</span></span> <span data-ttu-id="f1a75-165">В следующей таблице указано, какие сценарии восстановления и в какой степени поддерживаются в каждой из моделей восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-165">The following table summarizes whether and to what extent each of the recovery models supports a given restore scenario.</span></span>  
  
|<span data-ttu-id="f1a75-166">Операция восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-166">Restore operation</span></span>|<span data-ttu-id="f1a75-167">Модель полного восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-167">Full recovery model</span></span>|<span data-ttu-id="f1a75-168">Модель восстановления с неполным протоколированием</span><span class="sxs-lookup"><span data-stu-id="f1a75-168">Bulk-logged recovery model</span></span>|<span data-ttu-id="f1a75-169">Простая модель восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-169">Simple recovery model</span></span>|  
|-----------------------|-------------------------|---------------------------------|---------------------------|  
|<span data-ttu-id="f1a75-170">Восстановление данных</span><span class="sxs-lookup"><span data-stu-id="f1a75-170">Data recovery</span></span>|<span data-ttu-id="f1a75-171">Полное восстановление (при наличии журнала).</span><span class="sxs-lookup"><span data-stu-id="f1a75-171">Complete recovery (if the log is available).</span></span>|<span data-ttu-id="f1a75-172">С некоторыми потерями данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-172">Some data-loss exposure.</span></span>|<span data-ttu-id="f1a75-173">Будут потеряны все данные с момента создания последней полной или разностной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="f1a75-173">Any data since last full or differential backup is lost.</span></span>|  
|<span data-ttu-id="f1a75-174">Восстановление на момент времени</span><span class="sxs-lookup"><span data-stu-id="f1a75-174">Point-in-time restore</span></span>|<span data-ttu-id="f1a75-175">На любое время, сохранившееся в резервных копиях журналов.</span><span class="sxs-lookup"><span data-stu-id="f1a75-175">Any time covered by the log backups.</span></span>|<span data-ttu-id="f1a75-176">Запрещено, если резервная копия журналов содержит какие-либо изменения с неполным протоколированием.</span><span class="sxs-lookup"><span data-stu-id="f1a75-176">Disallowed if the log backup contains any bulk-logged changes.</span></span>|<span data-ttu-id="f1a75-177">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="f1a75-177">Not supported.</span></span>|  
|<span data-ttu-id="f1a75-178">File restore **\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-178">File restore **\***</span></span>|<span data-ttu-id="f1a75-179">Поддерживается полностью.</span><span class="sxs-lookup"><span data-stu-id="f1a75-179">Full support.</span></span>|<span data-ttu-id="f1a75-180">Иногда. **\*\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-180">Sometimes.**\*\***</span></span>|<span data-ttu-id="f1a75-181">Только для вторичных файлов, доступных только для чтения.</span><span class="sxs-lookup"><span data-stu-id="f1a75-181">Available only for read-only secondary files.</span></span>|  
|<span data-ttu-id="f1a75-182">Page restore **\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-182">Page restore **\***</span></span>|<span data-ttu-id="f1a75-183">Поддерживается полностью.</span><span class="sxs-lookup"><span data-stu-id="f1a75-183">Full support.</span></span>|<span data-ttu-id="f1a75-184">Иногда. **\*\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-184">Sometimes.**\*\***</span></span>|<span data-ttu-id="f1a75-185">Нет.</span><span class="sxs-lookup"><span data-stu-id="f1a75-185">None.</span></span>|  
|<span data-ttu-id="f1a75-186">Поэтапное (на уровне файловой группы) восстановление **\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-186">Piecemeal (filegroup-level) restore **\***</span></span>|<span data-ttu-id="f1a75-187">Поддерживается полностью.</span><span class="sxs-lookup"><span data-stu-id="f1a75-187">Full support.</span></span>|<span data-ttu-id="f1a75-188">Иногда. **\*\***</span><span class="sxs-lookup"><span data-stu-id="f1a75-188">Sometimes.**\*\***</span></span>|<span data-ttu-id="f1a75-189">Только для вторичных файлов, доступных только для чтения.</span><span class="sxs-lookup"><span data-stu-id="f1a75-189">Available only for read-only secondary files.</span></span>|  
  
 <span data-ttu-id="f1a75-190">**\*** Доступно только в выпуске Enterprise [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="f1a75-190">**\*** Available only in the Enterprise edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>  
  
 <span data-ttu-id="f1a75-191">**\*\*** Сведения о необходимых условиях см. в подразделе [Ограничения для восстановления по простой модели восстановления](#RMsimpleScenarios)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f1a75-191">**\*\*** For the required conditions, see [Restore Restrictions Under the Simple Recovery Model](#RMsimpleScenarios), later in this topic.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="f1a75-192">Независимо от модели восстановления базы данных, резервная копия [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не может быть восстановлена на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , имеющем версию, предшествующую версии, создавшей резервную копию.</span><span class="sxs-lookup"><span data-stu-id="f1a75-192">Regardless of the recovery model of a database, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backup cannot be restored by a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that is older than the version that created the backup.</span></span>  
  
##  <a name="restore-scenarios-under-the-simple-recovery-model"></a><a name="RMsimpleScenarios"></a><span data-ttu-id="f1a75-193">Сценарии восстановления в простой модели восстановления</span><span class="sxs-lookup"><span data-stu-id="f1a75-193">Restore Scenarios Under the Simple Recovery Model</span></span>  
 <span data-ttu-id="f1a75-194">В простой модели восстановления предусмотрены следующие ограничения для операции восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-194">The simple recovery model imposes the following restrictions on restore operations:</span></span>  
  
-   <span data-ttu-id="f1a75-195">Восстановление файлов и поэтапное восстановление доступны только для вторичных файловых групп, предназначенных только для чтения.</span><span class="sxs-lookup"><span data-stu-id="f1a75-195">File restore and piecemeal restore are available only for read-only secondary filegroups.</span></span> <span data-ttu-id="f1a75-196">Дополнительные сведения об этих сценариях восстановления см. в статьях [Восстановление файлов (простая модель восстановления)](file-restores-simple-recovery-model.md) и [Поэтапное восстановление (SQL Server)](piecemeal-restores-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-196">For information about these restore scenarios, see [File Restores &#40;Simple Recovery Model&#41;](file-restores-simple-recovery-model.md) and [Piecemeal Restores &#40;SQL Server&#41;](piecemeal-restores-sql-server.md).</span></span>  
  
-   <span data-ttu-id="f1a75-197">Запрещено восстановление страниц.</span><span class="sxs-lookup"><span data-stu-id="f1a75-197">Page restore is not allowed.</span></span>  
  
-   <span data-ttu-id="f1a75-198">Запрещено восстановление до заданной точки.</span><span class="sxs-lookup"><span data-stu-id="f1a75-198">Point-in-time restore is not allowed.</span></span>  
  
 <span data-ttu-id="f1a75-199">Если приведенные выше ограничения противоречат задачам восстановления, рекомендуется использовать модель полного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-199">If any of these restrictions are inappropriate for your recovery needs, we recommend that you consider using the full recovery model.</span></span> <span data-ttu-id="f1a75-200">Дополнительные сведения см. в разделе [Общие сведения о резервном копировании (SQL Server)](backup-overview-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-200">For more information, see [Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="f1a75-201">Независимо от модели восстановления базы данных, резервная копия [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не может быть восстановлена на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , имеющем версию, предшествующую версии, создавшей резервную копию.</span><span class="sxs-lookup"><span data-stu-id="f1a75-201">Regardless of the recovery model of a database, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backup cannot be restored by a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that is older than the version that created the backup.</span></span>  
  
##  <a name="restore-under-the-bulk-logged-recovery-model"></a><a name="RMblogRestore"></a> <span data-ttu-id="f1a75-202">Восстановление в модели восстановления с неполным протоколированием</span><span class="sxs-lookup"><span data-stu-id="f1a75-202">Restore Under the Bulk-Logged Recovery Model</span></span>  
 <span data-ttu-id="f1a75-203">В этом разделе рассматриваются вопросы, относящиеся исключительно к модели восстановления с неполным протоколированием, которая разработана исключительно в дополнение к модели полного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-203">This section discusses restore considerations that are unique to bulk-logged recovery model, which is intended exclusively as a supplement to the full recovery model.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f1a75-204">Основные сведения о модели восстановления с неполным протоколированием см. в разделе [Журнал транзакций (SQL Server)](../logs/the-transaction-log-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-204">For an introduction to the bulk-logged recovery model, see [The Transaction Log &#40;SQL Server&#41;](../logs/the-transaction-log-sql-server.md).</span></span>  
  
 <span data-ttu-id="f1a75-205">В целом модель восстановления с неполным протоколированием схожа с моделью полного восстановления, поэтому все, что касается одной модели, также можно применить к другой.</span><span class="sxs-lookup"><span data-stu-id="f1a75-205">Generally, the bulk-logged recovery model is similar to the full recovery model, and the information described for the full recovery model also applies to both.</span></span> <span data-ttu-id="f1a75-206">Однако модель восстановления с неполным протоколированием влияет на восстановление к моменту времени и на оперативное восстановление.</span><span class="sxs-lookup"><span data-stu-id="f1a75-206">However, point-in-time recovery and online restore are affected by the bulk-logged recovery model.</span></span>  
  
### <a name="restrictions-for-point-in-time-recovery"></a><span data-ttu-id="f1a75-207">Ограничения для восстановления на момент времени</span><span class="sxs-lookup"><span data-stu-id="f1a75-207">Restrictions for Point-in-time Recovery</span></span>  
 <span data-ttu-id="f1a75-208">Если в модели восстановления с неполным протоколированием в резервной копии журналов содержатся изменения с неполным протоколированием, восстановление до момента времени невозможно.</span><span class="sxs-lookup"><span data-stu-id="f1a75-208">If a log backup taken under the bulk-logged recovery model contains bulk-logged changes, point-in-time recovery is not allowed.</span></span> <span data-ttu-id="f1a75-209">Попытка восстановления до момента времени из резервной копии журнала, содержащей массовые изменения, приводит к сбою операции восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-209">Trying to perform point-in-time recovery on a log backup that contains bulk changes will cause the restore operation to fail.</span></span>  
  
### <a name="restrictions-for-online-restore"></a><span data-ttu-id="f1a75-210">Ограничения восстановления в сети</span><span class="sxs-lookup"><span data-stu-id="f1a75-210">Restrictions for Online Restore</span></span>  
 <span data-ttu-id="f1a75-211">Последовательность восстановления в сети работает только при выполнении следующих условий:</span><span class="sxs-lookup"><span data-stu-id="f1a75-211">An online restore sequence works only if the following conditions are met:</span></span>  
  
-   <span data-ttu-id="f1a75-212">все необходимые резервные копии журналов должны быть сделаны до начала последовательности восстановления;</span><span class="sxs-lookup"><span data-stu-id="f1a75-212">All required log backups must have been taken before the restore sequence starts.</span></span>  
  
-   <span data-ttu-id="f1a75-213">резервные копии массовых изменений были созданы до начала последовательности восстановления в сети;</span><span class="sxs-lookup"><span data-stu-id="f1a75-213">Bulk changes must be backed before starting the online restore sequence.</span></span>  
  
-   <span data-ttu-id="f1a75-214">Если в базе данных существуют массовые изменения, все файлы должны находиться в режиме "в сети" или быть[уничтожены](remove-defunct-filegroups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-214">If bulk changes exist in the database, all files must be either online or[defunct](remove-defunct-filegroups-sql-server.md).</span></span> <span data-ttu-id="f1a75-215">(Это означает, что они больше не являются частью базы данных.)</span><span class="sxs-lookup"><span data-stu-id="f1a75-215">(This means that it is no longer part of the database.)</span></span>  
  
 <span data-ttu-id="f1a75-216">Если эти условия не выполняются, последовательность восстановления в сети завершается сбоем.</span><span class="sxs-lookup"><span data-stu-id="f1a75-216">If these conditions are not met, the online restore sequence fails.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f1a75-217">Перед тем, как начать восстановление в сети, рекомендуется переключиться к модели полного восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-217">We recommend switching to the full recovery model before starting an online restore.</span></span> <span data-ttu-id="f1a75-218">Дополнительные сведения см. в разделе [Модели восстановления (SQL Server)](recovery-models-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-218">For more information, see [Recovery Models &#40;SQL Server&#41;](recovery-models-sql-server.md).</span></span>  
  
 <span data-ttu-id="f1a75-219">Дополнительные сведения о выполнении восстановления в сети см. в разделе [Восстановление в сети (SQL Server)](online-restore-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-219">For information about how to perform an online restore, see [Online Restore &#40;SQL Server&#41;](online-restore-sql-server.md).</span></span>  
  
##  <a name="database-recovery-advisor-sql-server-management-studio"></a><a name="DRA"></a> <span data-ttu-id="f1a75-220">Помощник по восстановлению базы данных (среда SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="f1a75-220">Database Recovery Advisor (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="f1a75-221">Помощник по восстановлению базы данных облегчает создание планов восстановления, реализующих оптимально правильные последовательности восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-221">The Database Recovery Advisor facilitates constructing restore plans that implement optimal correct restore sequences.</span></span> <span data-ttu-id="f1a75-222">Решено большинство известных проблем восстановления баз данных, и внедрены предложенные клиентами усовершенствования.</span><span class="sxs-lookup"><span data-stu-id="f1a75-222">Many known database restore issues and enhancements requested by customers have been addressed.</span></span> <span data-ttu-id="f1a75-223">Основные усовершенствования, появившиеся в помощнике по восстановлению баз данных:</span><span class="sxs-lookup"><span data-stu-id="f1a75-223">Major enhancements introduced by the Database Recovery Advisor include the following:</span></span>  
  
-   <span data-ttu-id="f1a75-224">**Алгоритм плана восстановления**:  значительно улучшен алгоритм, используемый при создании планов восстановления, особенно для сложных сценариев восстановления.</span><span class="sxs-lookup"><span data-stu-id="f1a75-224">**Restore-plan algorithm:**  The algorithm used to construct restore plans has improved significantly, particularly for complex restore scenarios.</span></span> <span data-ttu-id="f1a75-225">Многие крайние случаи, включая разветвляющиеся сценарии восстановления на момент времени, обрабатываются более эффективно, чем в предыдущих версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f1a75-225">Many edge cases, including forking scenarios in point-in-time restores, are handled more efficiently than in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="f1a75-226">**Восстановление на определенный момент времени**:  помощник по восстановлению баз данных значительно упрощает восстановление базы данных до определенного момента времени.</span><span class="sxs-lookup"><span data-stu-id="f1a75-226">**Point-in-time restores:**  The Database Recovery Advisor greatly simplifies restoring a database to a given point in time.</span></span> <span data-ttu-id="f1a75-227">Визуальная временная шкала резервного копирования значительно улучшает поддержку для выполнения восстановления на момент времени.</span><span class="sxs-lookup"><span data-stu-id="f1a75-227">A visual backup timeline significantly enhances support for point-in-time restores.</span></span> <span data-ttu-id="f1a75-228">Эта визуальная временная шкала позволяет определять подходящий момент времени в качестве целевой точки восстановления для базы данных.</span><span class="sxs-lookup"><span data-stu-id="f1a75-228">This visual timeline allows you to identify a feasible point in time as the target recovery point for restoring a database.</span></span> <span data-ttu-id="f1a75-229">Временная шкала облегчает обзор разветвленного пути восстановления (пути, который покрывает вилки восстановления).</span><span class="sxs-lookup"><span data-stu-id="f1a75-229">The timeline facilitates traversing a forked recovery path (a path that spans recovery forks).</span></span> <span data-ttu-id="f1a75-230">Заданный план восстановления на момент времени автоматически включает резервные копии, относящиеся к восстановлению на целевой момент времени (дата и время).</span><span class="sxs-lookup"><span data-stu-id="f1a75-230">A given point-in-time restore plan automatically includes the backups that are relevant to the restoring to your target point in time (date and time).</span></span> <span data-ttu-id="f1a75-231">Дополнительные сведения см. в статье [Восстановление базы данных SQL Server до определенного момента времени (модель полного восстановления)](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span><span class="sxs-lookup"><span data-stu-id="f1a75-231">For more information, see [Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span></span>  
  
 <span data-ttu-id="f1a75-232">Дополнительные сведения о помощнике по восстановлению баз данных см. в блогах по управлению [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="f1a75-232">For more information, see about the Database Recovery Advisor, see the following [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Manageability blogs:</span></span>  
  
-   [<span data-ttu-id="f1a75-233">Помощник по восстановлению: общие сведения</span><span class="sxs-lookup"><span data-stu-id="f1a75-233">Recovery Advisor: An Introduction</span></span>](https://blogs.msdn.com/b/managingsql/archive/2011/07/13/recovery-advisor-an-introduction.aspx)  
  
-   [<span data-ttu-id="f1a75-234">Помощник по восстановлению: использование среды SSMS для создания и восстановления раздельных резервных копий</span><span class="sxs-lookup"><span data-stu-id="f1a75-234">Recovery Advisor: Using SSMS to create/restore split backups</span></span>](https://docs.microsoft.com/archive/blogs/managingsql/recovery-advisor-using-ssms-to-createrestore-split-backups)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="f1a75-235">См. также</span><span class="sxs-lookup"><span data-stu-id="f1a75-235">Related Content</span></span>  
 <span data-ttu-id="f1a75-236">Нет.</span><span class="sxs-lookup"><span data-stu-id="f1a75-236">None.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1a75-237">См. также:</span><span class="sxs-lookup"><span data-stu-id="f1a75-237">See Also</span></span>  
 [<span data-ttu-id="f1a75-238">Общие сведения о резервном копировании (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="f1a75-238">Backup Overview &#40;SQL Server&#41;</span></span>](backup-overview-sql-server.md)  
  
  
