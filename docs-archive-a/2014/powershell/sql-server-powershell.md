---
title: PowerShell для SQL Server | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: scripting
ms.topic: conceptual
ms.assetid: 89b70725-bbe7-4ffe-a27d-2a40005a97e7
author: stevestein
ms.author: sstein
ms.openlocfilehash: 87b4a21bf46bb27fba604c81af633576da6342c9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87731789"
---
# <a name="sql-server-powershell"></a><span data-ttu-id="64d51-102">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-102">SQL Server PowerShell</span></span>
  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="64d51-103">поддерживает Windows PowerShell — многофункциональную оболочку для работы со скриптами, позволяющую администраторам и разработчикам автоматизировать администрирование серверов и развертывание приложений.</span><span class="sxs-lookup"><span data-stu-id="64d51-103">supports Windows PowerShell, which is a powerful scripting shell that lets administrators and developers automate server administration and application deployment.</span></span> <span data-ttu-id="64d51-104">Язык Windows PowerShell поддерживает более сложные логические конструкции по сравнению со сценариями [!INCLUDE[tsql](../includes/tsql-md.md)] , что дает администраторам [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] возможность создавать надежно работающие сценарии администрирования.</span><span class="sxs-lookup"><span data-stu-id="64d51-104">The Windows PowerShell language supports more complex logic than [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, giving [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] administrators the ability to build robust administration scripts.</span></span> <span data-ttu-id="64d51-105">Сценарии Windows PowerShell также можно использовать для администрирования других серверных продуктов [!INCLUDE[msCoName](../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="64d51-105">Windows PowerShell scripts can also be used to administer other [!INCLUDE[msCoName](../includes/msconame-md.md)] server products.</span></span> <span data-ttu-id="64d51-106">В результате администраторы получают возможность использовать общий язык сценариев для разных серверов.</span><span class="sxs-lookup"><span data-stu-id="64d51-106">This gives administrators a common scripting language across servers.</span></span>  
  
## <a name="sql-server-powershell-components"></a><span data-ttu-id="64d51-107">Компоненты SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-107">SQL Server PowerShell Components</span></span>  
 <span data-ttu-id="64d51-108">В состав [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] входит модуль Windows PowerShell, называемый `sqlps`, который используется для импорта компонентов [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] в среду Windows PowerShell 2.0 или скрипт.</span><span class="sxs-lookup"><span data-stu-id="64d51-108">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provides a Windows PowerShell module named `sqlps` that is used to import the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components into a Windows PowerShell 2.0 environment or script.</span></span> <span data-ttu-id="64d51-109">Модуль `sqlps` загружает две оснастки Windows PowerShell, которые реализуют следующие объекты.</span><span class="sxs-lookup"><span data-stu-id="64d51-109">The `sqlps` module loads two Windows PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="64d51-110">Поставщик [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , который предоставляет простой механизм навигации, аналогичный путям в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="64d51-110">A [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider, which enables a simple navigation mechanism similar to file system paths.</span></span> <span data-ttu-id="64d51-111">Можно построить пути, аналогичные путям файловой системы, где диску соответствует управляющая объектная модель [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , а узлы основаны на классах объектной модели.</span><span class="sxs-lookup"><span data-stu-id="64d51-111">You can build paths similar to file system paths, where the drive is associated with a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] management object model, and the nodes are based on the object model classes.</span></span> <span data-ttu-id="64d51-112">Затем можно использовать привычные команды, такие как **cd** и **dir** , чтобы перемещаться по путям, аналогично переходу по структуре папок в окне командной строки.</span><span class="sxs-lookup"><span data-stu-id="64d51-112">You can then use familiar commands such as **cd** and **dir** to navigate the paths similar to the way you navigate folders in a command prompt window.</span></span> <span data-ttu-id="64d51-113">Для выполнения действий на узлах пути можно использовать другие команды, например **ren** или **del**.</span><span class="sxs-lookup"><span data-stu-id="64d51-113">You can use other commands, such as **ren** or **del**, to perform actions on the nodes in the path.</span></span>  
  
-   <span data-ttu-id="64d51-114">Набор командлетов, которые являются командами, используемыми в сценариях Windows PowerShell для указания действия [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="64d51-114">A set of cmdlets, which are commands used in Windows PowerShell scripts to specify a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] action.</span></span> <span data-ttu-id="64d51-115">Командлеты [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] поддерживают такие действия, как запуск скрипта **sqlcmd** , содержащего инструкции [!INCLUDE[tsql](../includes/tsql-md.md)] или XQuery.</span><span class="sxs-lookup"><span data-stu-id="64d51-115">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets support actions such as running a **sqlcmd** script containing [!INCLUDE[tsql](../includes/tsql-md.md)] or XQuery statements.</span></span>  
  
 <span data-ttu-id="64d51-116">Дополнительные сведения о Windows PowerShell см. в разделе [Руководство по началу работы с Windows PowerShell](https://msdn.microsoft.com/library/hh857337.aspx).</span><span class="sxs-lookup"><span data-stu-id="64d51-116">To learn about Windows PowerShell, see the [Windows PowerShell Getting Started Guide](https://msdn.microsoft.com/library/hh857337.aspx).</span></span>  
  
## <a name="sql-server-versions"></a><span data-ttu-id="64d51-117">SQL Server, версии</span><span class="sxs-lookup"><span data-stu-id="64d51-117">SQL Server Versions</span></span>  
 <span data-ttu-id="64d51-118">Компоненты PowerShell [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] могут использоваться для управления экземплярами [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="64d51-118">The [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components can be used to manage instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] or later.</span></span> <span data-ttu-id="64d51-119">На экземплярах [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] должен быть запущен пакет обновления 2 (SP2) или более поздние версии.</span><span class="sxs-lookup"><span data-stu-id="64d51-119">Instances of [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] must be running SP2 or later.</span></span> <span data-ttu-id="64d51-120">На экземплярах [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] должен быть запущен пакет обновления 4 (SP4) или более поздние версии.</span><span class="sxs-lookup"><span data-stu-id="64d51-120">Instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] must be running SP4 or later.</span></span> <span data-ttu-id="64d51-121">Если компоненты PowerShell [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] используются в более ранних версиях [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], то в них поддерживаются только те функции, которые доступны в этих версиях.</span><span class="sxs-lookup"><span data-stu-id="64d51-121">When the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components are used with earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], they are limited to the functionality available in those versions.</span></span>  
  
## <a name="sql-server-powershell-tasks"></a><span data-ttu-id="64d51-122">Задачи SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-122">SQL Server PowerShell Tasks</span></span>  
  
|<span data-ttu-id="64d51-123">Описание задачи</span><span class="sxs-lookup"><span data-stu-id="64d51-123">Task Description</span></span>|<span data-ttu-id="64d51-124">Раздел</span><span class="sxs-lookup"><span data-stu-id="64d51-124">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="64d51-125">Описание предпочтительного механизма для запуска компонентов [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell, открытия сеанса PowerShell и загрузки модуля `sqlps`.</span><span class="sxs-lookup"><span data-stu-id="64d51-125">Describes the preferred mechanism for running the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell components; to open a PowerShell session and load the `sqlps` module.</span></span> <span data-ttu-id="64d51-126">Модуль `sqlps` загружает в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] поставщик PowerShell, командлеты и сборки управляющих объектов SQL Server (SMO), используемые поставщиком и командлетами.</span><span class="sxs-lookup"><span data-stu-id="64d51-126">The `sqlps` module loads in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell provider and cmdlets, and the SQL Server Management Object (SMO) assemblies used by the provider and cmdlets.</span></span>|[<span data-ttu-id="64d51-127">Импорт модуля SQLPS</span><span class="sxs-lookup"><span data-stu-id="64d51-127">Import the SQLPS Module</span></span>](../database-engine/import-the-sqlps-module.md)|  
|<span data-ttu-id="64d51-128">Описание способа загрузки только сборок объектов SMO без поставщика и командлетов.</span><span class="sxs-lookup"><span data-stu-id="64d51-128">Describes how to load only the SMO assemblies without the provider or cmdlets.</span></span>|[<span data-ttu-id="64d51-129">Загрузка сборки объектов SMO в Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-129">Load the SMO Assemblies in Windows PowerShell</span></span>](load-the-smo-assemblies-in-windows-powershell.md)|  
|<span data-ttu-id="64d51-130">Описание способа запуска сеанса Windows PowerShell щелчком правой кнопкой мыши узла в **обозревателе объектов**.</span><span class="sxs-lookup"><span data-stu-id="64d51-130">Describes how to run a Windows PowerShell session by right-clicking a node in **Object Explorer**.</span></span> [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)]<span data-ttu-id="64d51-131">запускает сеанс Windows PowerShell, загружает `sqlps` модуль и задает путь поставщика SQL Server к выбранному объекту.</span><span class="sxs-lookup"><span data-stu-id="64d51-131">launches a Windows PowerShell session, loads the `sqlps` module, and sets the SQL Server provider path to the object selected.</span></span>|[<span data-ttu-id="64d51-132">Запуск Windows PowerShell из среды SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="64d51-132">Run Windows PowerShell from SQL Server Management Studio</span></span>](run-windows-powershell-from-sql-server-management-studio.md)|  
|<span data-ttu-id="64d51-133">Описание создания шагов задания агента SQL Server для запуска скрипта Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="64d51-133">Describes how to create SQL Server Agent job steps that run a Windows PowerShell script.</span></span> <span data-ttu-id="64d51-134">Пользователь может планировать выполнение заданий в указанное время или в ответ на события.</span><span class="sxs-lookup"><span data-stu-id="64d51-134">The jobs can then be scheduled to run at specific times or in response to events.</span></span>|[<span data-ttu-id="64d51-135">Использование Windows PowerShell в шагах агента SQL Server</span><span class="sxs-lookup"><span data-stu-id="64d51-135">Run Windows PowerShell Steps in SQL Server Agent</span></span>](run-windows-powershell-steps-in-sql-server-agent.md)|  
|<span data-ttu-id="64d51-136">Описание использования поставщика [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] для перемещения по иерархии объектов [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="64d51-136">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider to navigate a hierarchy of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] objects.</span></span>|[<span data-ttu-id="64d51-137">Поставщик SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-137">SQL Server PowerShell Provider</span></span>](sql-server-powershell-provider.md)|  
|<span data-ttu-id="64d51-138">Описание использования командлетов [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , содержащих действия компонента [!INCLUDE[ssDE](../includes/ssde-md.md)] , например запуск скрипта [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="64d51-138">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets that specify [!INCLUDE[ssDE](../includes/ssde-md.md)] actions such as running a [!INCLUDE[tsql](../includes/tsql-md.md)] script.</span></span>|[<span data-ttu-id="64d51-139">Использование командлетов компонента Database Engine</span><span class="sxs-lookup"><span data-stu-id="64d51-139">Use the Database Engine cmdlets</span></span>](../database-engine/use-the-database-engine-cmdlets.md)|  
|<span data-ttu-id="64d51-140">Описание способа указания идентификаторов с разделителями [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , содержащих символы, не поддерживаемые в Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="64d51-140">Describes how to specify [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] delimited identifiers that contain characters not supported by Windows PowerShell.</span></span>|[<span data-ttu-id="64d51-141">Идентификаторы SQL Server в PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-141">SQL Server Identifiers in PowerShell</span></span>](sql-server-identifiers-in-powershell.md)|  
|<span data-ttu-id="64d51-142">Описание создания подключения с проверкой подлинности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="64d51-142">Describes how to make SQL Server Authentication connections.</span></span> <span data-ttu-id="64d51-143">По умолчанию компоненты SQL Server PowerShell используют подключение с помощью проверки подлинности Windows и учетных данных процесса, в котором выполняется Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="64d51-143">By default, the SQL Server PowerShell components use Windows Authentication connections using the Windows credentials of the process running Windows PowerShell.</span></span>|[<span data-ttu-id="64d51-144">Управление проверкой подлинности в компонент Database Engine PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-144">Manage Authentication in Database Engine PowerShell</span></span>](manage-authentication-in-database-engine-powershell.md)|  
|<span data-ttu-id="64d51-145">Описание использования переменных, реализованных поставщиком SQL Server PowerShell, для управления количеством объектов, перечисляемых при использовании функции завершения по клавише TAB в Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="64d51-145">Describes how to use variables implemented by the SQL Server PowerShell provider to control how many objects are listed when using Windows PowerShell tab completion.</span></span> <span data-ttu-id="64d51-146">Это особенно полезно при работе с базами данных, содержащими большое количество объектов.</span><span class="sxs-lookup"><span data-stu-id="64d51-146">This is particularly useful when working on databases that contain large numbers of objects.</span></span>|[<span data-ttu-id="64d51-147">Управление завершением по нажатию клавиши Tab (SQL Server PowerShell)</span><span class="sxs-lookup"><span data-stu-id="64d51-147">Manage Tab Completion &#40;SQL Server PowerShell&#41;</span></span>](manage-tab-completion-sql-server-powershell.md)|  
|<span data-ttu-id="64d51-148">Описание использования командлета Get-Help для получения сведений о компонентах [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] в среде Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="64d51-148">Describes how to use Get-Help to get information about the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components in the Windows PowerShell environment.</span></span>|[<span data-ttu-id="64d51-149">Получение справок по SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="64d51-149">Get Help SQL Server PowerShell</span></span>](../database-engine/get-help-sql-server-powershell.md)|  
  
  
