---
title: Шаг 2. Добавление и настройка диспетчера соединений с неструктурированными файлами | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 9a77dd32-d8c2-4961-ad37-2a971f9d6043
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 3ba3adee2422af8b2df027f55ec84366b90ddd7b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664364"
---
# <a name="step-2-adding-and-configuring-a-flat-file-connection-manager"></a><span data-ttu-id="483db-102">Шаг 2. Добавление и настройка диспетчера соединений с неструктурированными файлами</span><span class="sxs-lookup"><span data-stu-id="483db-102">Step 2: Adding and Configuring a Flat File Connection Manager</span></span>
  <span data-ttu-id="483db-103">В этом задании к только что созданному пакету будет добавлен диспетчер соединений с неструктурированными файлами.</span><span class="sxs-lookup"><span data-stu-id="483db-103">In this task, you add a Flat File connection manager to the package that you just created.</span></span> <span data-ttu-id="483db-104">Диспетчер соединений с неструктурированными файлами позволяет пакету извлекать данные из неструктурированных файлов.</span><span class="sxs-lookup"><span data-stu-id="483db-104">A Flat File connection manager enables a package to extract data from a flat file.</span></span> <span data-ttu-id="483db-105">С помощью диспетчера соединений с неструктурированными файлами можно указать имя и расположение файла, локали и кодовую страницу, а также формат файла, включая разделители столбцов. Эти данные будут использованы при извлечении пакета из неструктурированного файла.</span><span class="sxs-lookup"><span data-stu-id="483db-105">Using the Flat File connection manager, you can specify the file name and location, the locale and code page, and the file format, including column delimiters, to apply when the package extracts data from the flat file.</span></span> <span data-ttu-id="483db-106">Кроме того, можно вручную указать тип данных для каждого столбца или в диалоговом окне **Предлагаемые типы столбцов** указать автоматическое сопоставление столбцов извлекаемых данных с типами данных в службах [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="483db-106">In addition, you can manually specify the data type for the individual columns, or use the **Suggest Column Types** dialog box to automatically map the columns of extracted data to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] data types.</span></span>  
  
 <span data-ttu-id="483db-107">Для каждого используемого формата файла необходимо создать отдельный диспетчер соединений с неструктурированными файлами.</span><span class="sxs-lookup"><span data-stu-id="483db-107">You must create a new Flat File connection manager for each file format that you work with.</span></span> <span data-ttu-id="483db-108">Так как в данном учебнике данные извлекаются из неструктурированных файлов одинакового формата, в пакет необходимо добавить только один диспетчер соединений с неструктурированными файлами.</span><span class="sxs-lookup"><span data-stu-id="483db-108">Because this tutorial extracts data from multiple flat files that have exactly the same data format, you will need to add and configure only one Flat File connection manager for your package.</span></span>  
  
 <span data-ttu-id="483db-109">В этом учебнике предстоит настроить следующие свойства диспетчера соединений с неструктурированными файлами:</span><span class="sxs-lookup"><span data-stu-id="483db-109">For this tutorial, you will configure the following properties in your Flat File connection manager:</span></span>  
  
-   <span data-ttu-id="483db-110">**Имена столбцов.** Так как в неструктурированном файле не указаны имена столбцов, диспетчер соединений с неструктурированными файлами создает имена столбцов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="483db-110">**Column names:** Because the flat file does not have column names, the Flat File connection manager creates default column names.</span></span> <span data-ttu-id="483db-111">Указанные имена по умолчанию не дают представления о содержащихся в столбцах данных.</span><span class="sxs-lookup"><span data-stu-id="483db-111">These default names are not useful for identifying what each column represents.</span></span> <span data-ttu-id="483db-112">Чтобы сделать имена по умолчанию более понятными, следует заменить их именами, взятыми из таблицы фактов, в которую производится загрузка данных из неструктурированных файлов.</span><span class="sxs-lookup"><span data-stu-id="483db-112">To make these default names more useful, you need to change the default names to names that match the fact table into which the flat file data is to be loaded.</span></span>  
  
-   <span data-ttu-id="483db-113">**Сопоставление данных.** Сопоставление типов данных, указанное для диспетчера соединений с неструктурированными файлами, используется всеми компонентами источников данных "неструктурированный файл", которые обращаются к диспетчеру соединений.</span><span class="sxs-lookup"><span data-stu-id="483db-113">**Data mappings:** The data type mappings that you specify for the Flat File connection manager will be used by all flat file data source components that reference the connection manager.</span></span> <span data-ttu-id="483db-114">Можно сопоставить типы данных вручную с помощью диспетчера соединений с неструктурированными файлами или использовать диалоговое окно **Предлагаемые типы столбцов** .</span><span class="sxs-lookup"><span data-stu-id="483db-114">You can either manually map the data types by using the Flat File connection manager, or you can use the **Suggest Column Types** dialog box.</span></span> <span data-ttu-id="483db-115">В этом учебнике предстоит просмотреть сопоставления, предложенные в диалоговом окне **Предлагаемые типы столбцов** , а затем вручную создать необходимые сопоставления в диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** .</span><span class="sxs-lookup"><span data-stu-id="483db-115">In this tutorial, you will view the mappings suggested in the **Suggest Column Types** dialog box and then manually make the necessary mappings in the **Flat File Connection Manager Editor** dialog box.</span></span>  
  
 <span data-ttu-id="483db-116">Диспетчер соединений с неструктурированными файлами предоставляет сведения о локали файла данных.</span><span class="sxs-lookup"><span data-stu-id="483db-116">The Flat File connection manager provides locale information about the data file.</span></span> <span data-ttu-id="483db-117">Если на компьютере не настроено использование региональных параметров "Английский (США)", необходимо задать дополнительные свойства в диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** .</span><span class="sxs-lookup"><span data-stu-id="483db-117">If your computer is not configured to use the regional option English (United States), you must set additional properties in the **Flat File Connection Manager Editor** dialog box.</span></span>  
  
### <a name="to-add-a-flat-file-connection-manager-to-the-ssis-package"></a><span data-ttu-id="483db-118">Добавление диспетчера соединений с неструктурированными файлами в пакет служб SSIS</span><span class="sxs-lookup"><span data-stu-id="483db-118">To add a Flat File connection manager to the SSIS package</span></span>  
  
1.  <span data-ttu-id="483db-119">Щелкните правой кнопкой мыши область **Диспетчеры соединений** и выберите команду **Создать соединение с неструктурированным файлом**.</span><span class="sxs-lookup"><span data-stu-id="483db-119">Right-click anywhere in the **Connection Managers** area, and then click **New Flat File Connection**.</span></span>  
  
2.  <span data-ttu-id="483db-120">В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** в поле **Имя диспетчера соединений**введите **Образец источника данных "неструктурированный файл"**.</span><span class="sxs-lookup"><span data-stu-id="483db-120">In the **Flat File Connection Manager Editor** dialog box, for **Connection manager name**, type **Sample Flat File Source Data**.</span></span>  
  
3.  <span data-ttu-id="483db-121">Нажмите кнопку **Обзор**.</span><span class="sxs-lookup"><span data-stu-id="483db-121">Click **Browse**.</span></span>  
  
4.  <span data-ttu-id="483db-122">В диалоговом окне **Открыть** найдите файл SampleCurrencyData.txt на компьютере.</span><span class="sxs-lookup"><span data-stu-id="483db-122">In the **Open** dialog box, locate the SampleCurrencyData.txt file on your machine.</span></span>  
  
     <span data-ttu-id="483db-123">Образцы данных включаются в состав с пакетами занятий по службам [!INCLUDE[ssIS](../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="483db-123">The sample data is included with the [!INCLUDE[ssIS](../includes/ssis-md.md)] lesson packages.</span></span> <span data-ttu-id="483db-124">Чтобы загрузить образцы данных и пакеты занятий выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="483db-124">To download the sample data and the lesson packages, do the following.</span></span>  
  
    1.  <span data-ttu-id="483db-125">Перейдите к [образцам продуктов служб Integration Services](https://go.microsoft.com/fwlink/?LinkId=275027).</span><span class="sxs-lookup"><span data-stu-id="483db-125">Navigate to [Integration Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=275027)</span></span>  
  
    2.  <span data-ttu-id="483db-126">Перейдите на вкладку **Downloads (загрузки** ).</span><span class="sxs-lookup"><span data-stu-id="483db-126">Click the **DOWNLOADS** tab.</span></span>  
  
    3.  <span data-ttu-id="483db-127">Щелкните файл SQL2012.Integration_Services.Create_Simple_ETL_Tutorial.Sample.zip.</span><span class="sxs-lookup"><span data-stu-id="483db-127">Click the  SQL2012.Integration_Services.Create_Simple_ETL_Tutorial.Sample.zip file.</span></span>  
  
5.  <span data-ttu-id="483db-128">Снимите флажок «Имена столбцов в первой строке данных».</span><span class="sxs-lookup"><span data-stu-id="483db-128">Clear the Column names in the first data row checkbox.</span></span>  
  
### <a name="to-set-locale-sensitive-properties"></a><span data-ttu-id="483db-129">Установка свойств, зависящих от локали и региональных стандартов</span><span class="sxs-lookup"><span data-stu-id="483db-129">To set locale sensitive properties</span></span>  
  
1.  <span data-ttu-id="483db-130">В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** перейдите на вкладку **Общие**.</span><span class="sxs-lookup"><span data-stu-id="483db-130">In the **Flat File Connection Manager Editor** dialog box, click **General**.</span></span>  
  
2.  <span data-ttu-id="483db-131">Задайте для параметра **язык** значение английский (США) и **кодовую страницу** 1252.</span><span class="sxs-lookup"><span data-stu-id="483db-131">Set **Locale** to English (United States) and **Code page** to 1252.</span></span>  
  
### <a name="to-rename-columns-in-the-flat-file-connection-manager"></a><span data-ttu-id="483db-132">Переименование столбцов диспетчера соединений с неструктурированными файлами</span><span class="sxs-lookup"><span data-stu-id="483db-132">To rename columns in the Flat File connection manager</span></span>  
  
1.  <span data-ttu-id="483db-133">В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** перейдите на вкладку **Дополнительно**.</span><span class="sxs-lookup"><span data-stu-id="483db-133">In the **Flat File Connection Manager Editor** dialog box, click **Advanced**.</span></span>  
  
2.  <span data-ttu-id="483db-134">На панели свойств сделайте следующие изменения.</span><span class="sxs-lookup"><span data-stu-id="483db-134">In the property pane, make the following changes:</span></span>  
  
    -   <span data-ttu-id="483db-135">Измените значение свойства имя **столбца 0** на `AverageRate` .</span><span class="sxs-lookup"><span data-stu-id="483db-135">Change the **Column 0** name property to `AverageRate`.</span></span>  
  
    -   <span data-ttu-id="483db-136">Измените значение свойства имя **столбца 1** на `CurrencyID` .</span><span class="sxs-lookup"><span data-stu-id="483db-136">Change the **Column 1** name property to `CurrencyID`.</span></span>  
  
    -   <span data-ttu-id="483db-137">Измените значение свойства имя **столбца 2** на `CurrencyDate` .</span><span class="sxs-lookup"><span data-stu-id="483db-137">Change the **Column 2** name property to `CurrencyDate`.</span></span>  
  
    -   <span data-ttu-id="483db-138">Измените значение свойства имя **столбца 3** на `EndOfDayRate` .</span><span class="sxs-lookup"><span data-stu-id="483db-138">Change the **Column 3** name property to `EndOfDayRate`.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="483db-139">По умолчанию для всех четырех столбцов указан строковый тип данных [DT_STR] со значением параметра `OutputColumnWidth`, равным 50.</span><span class="sxs-lookup"><span data-stu-id="483db-139">By default, all four of the columns are initially set to a string data type [DT_STR] with an `OutputColumnWidth` of 50.</span></span>  
  
### <a name="to-remap-column-data-types"></a><span data-ttu-id="483db-140">Сопоставление типов данных столбцов</span><span class="sxs-lookup"><span data-stu-id="483db-140">To remap column data types</span></span>  
  
1.  <span data-ttu-id="483db-141">В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** нажмите кнопку **Предложить типы**.</span><span class="sxs-lookup"><span data-stu-id="483db-141">In the **Flat File Connection Manager Editor** dialog box, click **Suggest Types**.</span></span>  
  
     [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="483db-142">автоматически предлагают большинство соответствующих типов данных на основании первых 200 строк данных.</span><span class="sxs-lookup"><span data-stu-id="483db-142">automatically suggests the most appropriate data types based on the first 200 rows of data.</span></span> <span data-ttu-id="483db-143">Можно изменить параметры предложения по большему или меньшему количеству данных, чтобы указать тип данных по умолчанию для целочисленных и логических данных или чтобы добавить пробелы в дополнение к строковым столбцам.</span><span class="sxs-lookup"><span data-stu-id="483db-143">You can also change these suggestion options to sample more or less data, to specify the default data type for integer or Boolean data, or to add spaces as padding to string columns.</span></span>  
  
     <span data-ttu-id="483db-144">На данный момент не изменяйте значения параметров в диалоговом окне **Предлагаемые типы столбцов** и нажмите кнопку **ОК** , чтобы службы [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] предложили типы данных для столбцов.</span><span class="sxs-lookup"><span data-stu-id="483db-144">For now, make no changes to the options in the **Suggest Column Types** dialog box, and click **OK** to have [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] suggest data types for columns.</span></span> <span data-ttu-id="483db-145">Вы вернетесь на панель **Дополнительно** диалогового окна **Редактор диспетчера соединений с неструктурированными файлами** , где можно просмотреть типы данных столбцов, предложенные службами [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="483db-145">This returns you to the **Advanced** pane of the **Flat File Connection Manager Editor** dialog box, where you can view the column data types suggested by [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="483db-146">(Если нажать кнопку **Отмена**, предложения в отношении метаданных столбца и используемого типа данных строки по умолчанию (DT_STR) сделаны не будут.)</span><span class="sxs-lookup"><span data-stu-id="483db-146">(If you click **Cancel**, no suggestions are made to column metadata and the default string (DT_STR) data type is used.)</span></span>  
  
     <span data-ttu-id="483db-147">В этом учебнике для данных из файла SampleCurrencyData.txt в службах [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] предлагаются типы данных, приведенные во втором столбце следующей ниже таблицы.</span><span class="sxs-lookup"><span data-stu-id="483db-147">In this tutorial, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] suggests the data types shown in the second column of the following table for the data from the SampleCurrencyData.txt file.</span></span> <span data-ttu-id="483db-148">Типы данных, требуемые для столбцов назначения, которые будут определены позже, приведены в последнем столбце следующей ниже таблицы.</span><span class="sxs-lookup"><span data-stu-id="483db-148">However, the data types that are required for the columns in the destination, which will be defined in a later step, are shown in the last column of the following table.</span></span>  
  
    |<span data-ttu-id="483db-149">Столбец неструктурированных файлов</span><span class="sxs-lookup"><span data-stu-id="483db-149">Flat File Column</span></span>|<span data-ttu-id="483db-150">Предложенный тип</span><span class="sxs-lookup"><span data-stu-id="483db-150">Suggested Type</span></span>|<span data-ttu-id="483db-151">Целевой столбец</span><span class="sxs-lookup"><span data-stu-id="483db-151">Destination Column</span></span>|<span data-ttu-id="483db-152">Тип назначения</span><span class="sxs-lookup"><span data-stu-id="483db-152">Destination Type</span></span>|  
    |----------------------|--------------------|------------------------|----------------------|  
    |<span data-ttu-id="483db-153">AverageRate</span><span class="sxs-lookup"><span data-stu-id="483db-153">AverageRate</span></span>|<span data-ttu-id="483db-154">float [DT_R4]</span><span class="sxs-lookup"><span data-stu-id="483db-154">float [DT_R4]</span></span>|<span data-ttu-id="483db-155">FactCurrency.AverageRate</span><span class="sxs-lookup"><span data-stu-id="483db-155">FactCurrency.AverageRate</span></span>|<span data-ttu-id="483db-156">FLOAT</span><span class="sxs-lookup"><span data-stu-id="483db-156">float</span></span>|  
    |<span data-ttu-id="483db-157">CurrencyID</span><span class="sxs-lookup"><span data-stu-id="483db-157">CurrencyID</span></span>|<span data-ttu-id="483db-158">string [DT_STR]</span><span class="sxs-lookup"><span data-stu-id="483db-158">string [DT_STR]</span></span>|<span data-ttu-id="483db-159">DimCurrency.CurrencyAlternateKey</span><span class="sxs-lookup"><span data-stu-id="483db-159">DimCurrency.CurrencyAlternateKey</span></span>|<span data-ttu-id="483db-160">nchar(3)</span><span class="sxs-lookup"><span data-stu-id="483db-160">nchar(3)</span></span>|  
    |<span data-ttu-id="483db-161">CurrencyDate</span><span class="sxs-lookup"><span data-stu-id="483db-161">CurrencyDate</span></span>|<span data-ttu-id="483db-162">date [DT_DATE]</span><span class="sxs-lookup"><span data-stu-id="483db-162">date [DT_DATE]</span></span>|<span data-ttu-id="483db-163">DimDate.FullDateAlternateKey</span><span class="sxs-lookup"><span data-stu-id="483db-163">DimDate.FullDateAlternateKey</span></span>|<span data-ttu-id="483db-164">Дата</span><span class="sxs-lookup"><span data-stu-id="483db-164">date</span></span>|  
    |<span data-ttu-id="483db-165">EndOfDayRate</span><span class="sxs-lookup"><span data-stu-id="483db-165">EndOfDayRate</span></span>|<span data-ttu-id="483db-166">float [DT_R4]</span><span class="sxs-lookup"><span data-stu-id="483db-166">float [DT_R4]</span></span>|<span data-ttu-id="483db-167">FactCurrency.EndOfDayRate</span><span class="sxs-lookup"><span data-stu-id="483db-167">FactCurrency.EndOfDayRate</span></span>|<span data-ttu-id="483db-168">FLOAT</span><span class="sxs-lookup"><span data-stu-id="483db-168">float</span></span>|  
  
     <span data-ttu-id="483db-169">Тип данных, предложенный для `CurrencyID` столбца, несовместим с типом данных поля в целевой таблице.</span><span class="sxs-lookup"><span data-stu-id="483db-169">The data type suggested for the `CurrencyID` column is incompatible with the data type of the field in the destination table.</span></span> <span data-ttu-id="483db-170">Поскольку тип данных типа `DimCurrency.CurrencyAlternateKey` nchar (3), `CurrencyID` должен быть изменен с string [DT_STR] на string [DT_WSTR].</span><span class="sxs-lookup"><span data-stu-id="483db-170">Because the data type of `DimCurrency.CurrencyAlternateKey` is nchar (3), `CurrencyID` must be changed from string [DT_STR] to string [DT_WSTR].</span></span> <span data-ttu-id="483db-171">Кроме того, поле `DimDate.FullDateAlternateKey` определяется как тип данных даты, поэтому `CurrencyDate` его необходимо изменить с date [DT_Date] на date [DT_DBDATE].</span><span class="sxs-lookup"><span data-stu-id="483db-171">Additionally, the field `DimDate.FullDateAlternateKey` is defined as a date data type; therefore, `CurrencyDate` needs to be changed from date [DT_Date] to database date [DT_DBDATE].</span></span>  
  
2.  <span data-ttu-id="483db-172">В списке выберите столбец CurrencyID и на панели свойств измените тип данных столбца `CurrencyID` строка [DT_STR] на строку в Юникоде [DT_WSTR].</span><span class="sxs-lookup"><span data-stu-id="483db-172">In the list, select the CurrencyID column and in the property pane, change the Data Type of column `CurrencyID` from string [DT_STR] to Unicode string [DT_WSTR].</span></span>  
  
3.  <span data-ttu-id="483db-173">На панели свойств измените тип данных столбца `CurrencyDate` с Date [DT_DATE] на Date [DT_DBDATE].</span><span class="sxs-lookup"><span data-stu-id="483db-173">In the property pane, change the data type of column `CurrencyDate` from date [DT_DATE] to database date [DT_DBDATE].</span></span>  
  
4.  <span data-ttu-id="483db-174">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="483db-174">Click **OK**.</span></span>  
  
## <a name="next-task-in-lesson"></a><span data-ttu-id="483db-175">Следующая задача занятия</span><span class="sxs-lookup"><span data-stu-id="483db-175">Next Task in Lesson</span></span>  
 [<span data-ttu-id="483db-176">Шаг 3. Добавление и настройка диспетчера подключений OLE DB</span><span class="sxs-lookup"><span data-stu-id="483db-176">Step 3: Adding and Configuring an OLE DB Connection Manager</span></span>](lesson-1-3-adding-and-configuring-an-ole-db-connection-manager.md)  
  
## <a name="see-also"></a><span data-ttu-id="483db-177">См. также:</span><span class="sxs-lookup"><span data-stu-id="483db-177">See Also</span></span>  
 <span data-ttu-id="483db-178">[Диспетчер соединений с неструктурированными файлами](connection-manager/file-connection-manager.md) </span><span class="sxs-lookup"><span data-stu-id="483db-178">[Flat File Connection Manager](connection-manager/file-connection-manager.md) </span></span>  
 [<span data-ttu-id="483db-179">Типы данных служб Integration Services</span><span class="sxs-lookup"><span data-stu-id="483db-179">Integration Services Data Types</span></span>](data-flow/integration-services-data-types.md)  
  
  
