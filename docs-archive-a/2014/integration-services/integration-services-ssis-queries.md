---
title: Запросы в службах Integration Services (SSIS) | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Query Builder [Integration Services]
- queries [Integration Services]
- statements [Integration Services]
- queries [Integration Services], about queries in packages
ms.assetid: 8822bd29-4575-46c8-92a0-1a39bc2604c1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5119ff27606ce4e43f65cc129f3caac764e78e0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664379"
---
# <a name="integration-services-ssis-queries"></a>Запросы в службах Integration Services (SSIS)
  Задача «Выполнение SQL», источник OLE DB, назначение «OLE DB» и преобразование «Уточняющий запрос» могут использовать SQL-запросы. В задаче «Выполнение SQL» инструкции SQL могут создавать, обновлять и удалять объекты базы данных и данные, запускать хранимые процедуры, выполнять инструкции SELECT. В источнике OLE DB и преобразовании «Уточняющий запрос» обычно содержатся SQL инструкции SELECT или EXEC. Последние наиболее часто выполняются хранимыми процедурами, возвращающими результирующие наборы.  
  
 Запрос может быть проанализирован для проверки его правильности. При анализе запроса, использующего соединение с [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], запрос анализируется, выполняется и результат выполнения (успешный или неуспешный) назначается результату анализа. Если запрос использует соединение с источником данных, который не является источником [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], инструкция только анализируется.  
  
 Инструкцию SQL можно ввести в конструктор напрямую или установить связь с файлом или переменной, содержащей инструкцию.  
  
## <a name="direct-input-sql"></a>Прямой ввод SQL  
 Построитель запросов доступен в пользовательском интерфейсе для задачи «Выполнение SQL», источника OLE DB, назначения OLE DB и преобразования «Уточняющий запрос». Построитель запросов дает следующие преимущества.  
  
-   Визуальная работа с командами SQL.  
  
     Построитель запросов содержит графические панели для наглядного построения запроса и текстовую панель, в котором отображается SQL-текст запроса. Можно работать в графических или текстовых панелях. Построитель запросов синхронизирует представления, поэтому текст запроса и графическое представление всегда совпадают.  
  
-   Соединение связанных таблиц.  
  
     Если к запросу добавляется более одной таблицы, построитель запросов автоматически определяет, как взаимосвязаны таблицы, и создает подходящую команду соединения.  
  
-   Запрос или обновление баз данных.  
  
     Можно использовать построитель запросов для получения данных при помощи инструкций Transact-SQL SELECT или для создания запросов, которые обновляют, добавляют или удаляют записи в базе данных.  
  
-   Просмотр и немедленное изменение результатов.  
  
     Можно выполнить запрос и работать с набором записей в сетке, которая позволяет прокручивать и изменять записи в базе данных.  
  
 Построитель запросов позволяет наглядно создавать только запросы SELECT, но можно ввести код SQL на текстовой панели для других типов инструкций, таких как DELETE и UPDATE. Графическая панель автоматически обновляется для отражения набранной инструкции SQL.  
  
 Можно также использовать прямой ввод посредством ввода запроса в диалоговом окне задачи или компонента потока данных или окне «Свойства».  
  
 Дополнительные сведения см. в статье [Query Builder](../../2014/integration-services/query-builder.md).  
  
## <a name="sql-in-files"></a>SQL в файлах  
 Инструкция SQL для задачи «Выполнение SQL» может также находиться в отдельном файле. Например, можно написать запрос при помощи средств, таких как редактор запросов в [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], сохранить запрос в файл и затем прочитать запрос из файла при запущенном пакете. Файл может содержать только SQL инструкции для выполнения и примечания. Чтобы использовать инструкцию SQL, содержащуюся в файле, необходимо указать соединение файла, определяющее имя файла и расположение. Дополнительные сведения см. в статье [File Connection Manager](connection-manager/file-connection-manager.md).  
  
## <a name="sql-in-variables"></a>SQL в переменных  
 Если источник инструкции SQL в задаче «Выполнение SQL» является переменной, указывается имя переменной, содержащей запрос. Свойство Value переменной содержит текст запроса. Свойство ValueType переменной устанавливается в строковый тип данных, и затем вводится или копируется инструкция SQL в свойство Value. Дополнительные сведения см. в разделах [Переменные в службах Integration Services (SSIS)](integration-services-ssis-variables.md) и [Использование переменных в пакетах](../../2014/integration-services/use-variables-in-packages.md).  
  
  
