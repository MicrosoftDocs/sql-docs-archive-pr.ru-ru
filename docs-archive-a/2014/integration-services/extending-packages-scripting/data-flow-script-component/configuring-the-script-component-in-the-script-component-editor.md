---
title: Настройка компонента скрипта в редакторе компонента скрипта | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- SSIS Script component
- Script Component Editor
- SSIS Script component, configuring
- Script component [Integration Services], configuring
ms.assetid: 586dd799-f383-4d6d-b1a1-f09233d14f0a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4a9925d29c7a960c46e217f1e96c0bcae4f217b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87665435"
---
# <a name="configuring-the-script-component-in-the-script-component-editor"></a>Настройка компонента скрипта в редакторе компонента скрипта
  Прежде чем приступать к написанию пользовательского кода в компоненте скрипта, необходимо выбрать тип компонента потока данных, который должен быть создан (источник, преобразование или назначение), а затем настроить метаданные и свойства компонента в окне **Редактор преобразования "скрипт"** .

## <a name="selecting-the-type-of-component-to-create"></a>Выбор типа создаваемого компонента
 При добавлении компонента скрипта на панель "Поток данных" конструктора служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] открывается диалоговое окно **Выбор типа компонента скрипта**. Компонент должен быть предварительно настроен как источник, преобразование или назначение. После начального выбора можно продолжить настройку компонента в окне **Редактор преобразования "скрипт"** .

 Чтобы установить язык скрипта по умолчанию для компонента скрипта, воспользуйтесь параметром **Язык сценариев** на странице **Общие** диалогового окна **Параметры**. Дополнительные сведения см. в разделе [General Page](../../general-page-of-integration-services-designers-options.md).

## <a name="understanding-the-two-design-time-modes"></a>Основные сведения о двух режимах времени разработки
 В конструкторе [!INCLUDE[ssIS](../../../includes/ssis-md.md)] у компонента Script есть два режима: режим конструирования метаданных и режим конструирования кода.

 При открытии окна **Редактор преобразования "скрипт"** компонент переходит в режим конструктора метаданных. В этом режиме можно выбрать входные столбцы, а также добавить или настроить выходы и выходные столбцы, но нельзя писать код. После настройки метаданных компонента можно переключиться в режим конструктора кода для создания скрипта.

 После переключения в режим конструктора кода путем нажатия кнопки **Изменить скрипт** компонент скрипта блокирует внесение дополнительных изменений в метаданные, а затем автоматически формирует код базовых классов на основе метаданных входов и выходов. После завершения автоматического формирования кода появляется возможность вводить пользовательский код. В разрабатываемом коде используются автоматически сформированные базовые классы для обработки входных строк, доступа к буферам и столбцам в буферах, а также для получения диспетчеров соединений и переменных из пакета; при этом все объекты рассматриваются как строго типизированные.

 После ввода пользовательского кода в режиме конструктора кода можно переключиться обратно в режим конструктора метаданных. Это не приводит к удалению введенного кода, но последующие изменения в метаданных вызывают повторное формирование базового класса. В дальнейшем проверка компонента может окончиться неудачей из-за того, что объекты, на которые имеются ссылки в пользовательском коде, больше не существуют или, возможно, были изменены. В этом случае необходимо исправить код вручную, чтобы можно было успешно скомпилировать его для повторно сформированного базового класса.

## <a name="configuring-the-component-in-metadata-design-mode"></a>Настройка компонента в режиме конструктора метаданных
 В режиме конструктора метаданных можно выбирать входные столбцы, а также добавлять и настраивать выходы и выходные столбцы, но возможность писать код не предусмотрена. После настройки конфигурации метаданных компонента переключитесь в режим конструктора кода для написания скрипта.

 Свойства, которые необходимо настроить в пользовательском редакторе, зависят от выбранной области применения компонента скрипта. Компонент скрипта можно настроить как источник, преобразование или назначение. В зависимости от того, как компонент используется, он поддерживает либо вход, либо выход, либо и вход и выход одновременно. Пользовательский код, который должен быть написан, применяется для обработки входных и выходных строк и столбцов.

### <a name="inputs-columns-page-of-the-script-transformation-editor"></a>Страница «Входные столбцы» окна «Редактор преобразования "Скрипт"»
 Страница **Входные столбцы** окна **Редактор преобразования "скрипт"** отображается для преобразований и назначений, но не для источников. На этой странице выбираются доступные входные столбцы, которые необходимо сделать доступными для пользовательского скрипта, а также указывается тип доступа для них: только для чтения или для чтения и записи.

 В проекте кода, создаваемого на основе этих метаданных, элемент проекта BufferWrapper содержит класс для каждого входа и этот класс включает свойства типизированного метода доступа для каждого выбранного входного столбца. Например, если выбрать целочисленный столбец **CustomerID** и столбец String **CustomerName** из входных данных с именем `CustomerInput` , то элемент проекта BufferWrapper будет содержать `CustomerInput` класс, производный от <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> , а `CustomerInput` класс будет предоставлять целочисленное свойство с именем **CustomerID** и строковое свойство с именем **CustomerName**. Благодаря наличию такого соглашения появляется возможность писать код с проверкой соответствия типов, подобный следующему:

```vb
Dim currentCustomerID as Integer = CustomerInput.CustomerID
Dim currentCustomerName as String = CustomerInput.CustomerName
```

 Дополнительные сведения о том, как настраивать входные столбцы для конкретного типа компонента потока данных, см. в соответствующем примере в разделе [Разработка компонентов скрипта определенных типов](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).

### <a name="inputs-and-outputs-page-of-the-script-transformation-editor"></a>Страница «Входы и выходы» окна «Редактор преобразования "Скрипт"»
 Страница **Входы и выходы** окна **Редактор преобразования "скрипт"** отображается для источников, преобразований и назначений. На этой странице можно добавлять, удалять и настраивать входы, выходы и выходные столбцы, которые нужно использовать в пользовательском скрипте, с учетом следующих ограничений.

-   При использовании в качестве источника компонент скрипта не имеет входов и поддерживает несколько выходов.

-   При использовании в качестве преобразования компонент скрипта поддерживает один вход и несколько выходов.

-   При использовании в качестве назначения компонент скрипта поддерживает один вход и не имеет выходов.

 В проекте кода, создаваемом на основе этих метаданных, элемент проекта BufferWrapper содержит класс для каждого входа и выхода. Например, если создается выход с именем `CustomerOutput` , элемент проекта BufferWrapper будет содержать `CustomerOutput` класс, производный от <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> , а `CustomerOutput` класс будет содержать свойства типизированного метода доступа для каждого созданного выходного столбца.

 Настраивать выходные столбцы можно только на странице **Входы и выходы**. Входные столбцы для преобразований и назначений можно выбрать на странице **Входные столбцы**. Свойства типизированного метода доступа, созданные для разработчика в элементе проекта BufferWrapper, будут доступны только для записи для выходных столбцов. Свойства метода доступа для входных столбцов будут доступны только для чтения или для чтения и записи в зависимости от области применения, выбранной для каждого столбца на странице **Входные столбцы**.

 Дополнительные сведения о настройке входов и выходов для конкретного типа компонента потока данных см. в соответствующем примере в разделе [Разработка компонентов скрипта определенных типов](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).

> [!NOTE]
>  Хотя нельзя непосредственно настроить выход в качестве вывода ошибок в компоненте скрипта для автоматической обработки ошибочных строк, но можно воспроизвести функциональные возможности вывода ошибок путем создания дополнительного выхода и использования скрипта для направления строк в этот выход при соответствующих условиях. Дополнительные сведения см. в разделе [Имитация вывода ошибок для компонента скрипта](../../data-flow/transformations/script-component.md).

#### <a name="exclusiongroup-and-synchronousinputid-properties-of-outputs"></a>Свойства ExclusionGroup и SynchronousInputID выходов
 Свойство `ExclusionGroup` имеет ненулевое значение только в преобразованиях с синхронными выходами, где в коде выполняется фильтрация или ветвление, а каждая строка направляется в один из выходов, имеющих одно и то же ненулевое значение `ExclusionGroup`. Например, преобразование может направлять строки либо в выход по умолчанию, либо в вывод ошибок. При создании дополнительных выходов для этого сценария необходимо задать в качестве значения свойства `SynchronousInputID` целое число, которое совпадает со значением `ID` на входе компонента.

 Свойство `SynchronousInputID` имеет ненулевое значение только в преобразованиях с синхронными выходами. Если это свойство равно нулю, выход является асинхронным. Для синхронного выхода, при использовании которого строки передаются в выбранный выход или выходы без добавления каких-либо новых строк, это свойство должно содержать значение `ID` входа компонента.

> [!NOTE]
>  Когда **Редактор преобразования «Скрипт** » создает первый выход, редактор задает `SynchronousInputID` для свойства выходных данных значение `ID` из входных данных компонента. Однако при создании последующих выходов редактор задает для свойства `SynchronousInputID` этих выходов значение равное нулю.
> 
>  Если вы создаете компонент с синхронными выходами, для каждого выхода должно быть `SynchronousInputID` задано свойство для `ID` входных данных компонента. Поэтому для каждого выхода, созданного редактором вслед за первым выходом, необходимо изменить значение свойства `SynchronousInputID` с нуля на значение `ID` входа компонента.
> 
>  Если создается компонент с асинхронными выходами, то для каждого выхода необходимо задать значение свойства `SynchronousInputID`, равное нулю. Таким образом, значение первого выхода должно `SynchronousInputID` изменяться от значения `ID` входных данных компонента до нуля.

 Пример направления строк в один или два синхронных выхода в компоненте скрипта см. в разделе [Создание синхронного преобразования с помощью компонента скрипта](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).

### <a name="object-names-in-generated-script"></a>Имена объектов в созданном скрипте
 Компонент скрипта анализирует имена входов и выходов, а также имена столбцов во входах и выходах, после чего на основе этих имен создает классы и свойства в элементе проекта BufferWrapper. Если найденные имена включают символы, не принадлежащие к категориям Юникода `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter` или `DecimalDigitLetter`, эти недопустимые символы удаляются из создаваемых имен. Например, удаляются пробелы, поэтому два входных столбца с именами **FirstName** и [**First Name**] интерпретируются как имеющие имя столбца **FirstName**, что приводит к получению непредсказуемых результатов. Чтобы избежать такой ситуации, имена входов и выходов и имена входных и выходных столбцов, используемых в компоненте скрипта, должны содержать только символы из категорий Юникода, перечисленных в этом разделе.

### <a name="script-page-of-the-script-transformation-editor"></a>Страница «Скрипт» окна «Редактор преобразования "Скрипт"»
 На странице **Скрипт** окна **Редактор задачи "скрипт"** можно присвоить уникальное имя и описание задаче "Скрипт". Можно также присваивать значения для следующих свойств.

> [!NOTE]
>  В [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] и более поздних версиях все скрипты предварительно скомпилированы. В предыдущих версиях приходилось указывать, должна ли была выполняться предварительная компиляция скриптов, задавая для задачи свойство `Precompile`.

#### <a name="validateexternalmetadata-property"></a>Свойство ValidateExternalMetadata
 Логическое значение свойства `ValidateExternalMetadata` указывает, должна ли в компоненте выполняться проверка по отношению к внешним источникам данных во время разработки или эту проверку следует отложить до времени выполнения. По умолчанию это свойство имеет значение `True`; иными словами, внешние метаданные проверяются и во время разработки, и во время выполнения. Может потребоваться установить значение этого свойства равным, `False` Если внешний источник данных недоступен во время разработки: например, когда пакет скачивает источник или создает назначение только во время выполнения.

#### <a name="readonlyvariables-and-readwritevariables-properties"></a>Свойства ReadOnlyVariables и ReadWriteVariables
 Можно вводить разделенные запятыми списки существующих переменных в качестве значений этих свойств, чтобы обеспечить доступ к переменным только для чтения или для чтения и записи в коде компонента скрипта. Доступ к переменным в коде осуществляется с помощью свойств <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> и <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> автоматически сформированного базового класса. Дополнительные сведения см. в разделе [Использование переменных в компоненте скрипта](using-variables-in-the-script-component.md).

> [!NOTE]
>  В именах переменных учитывается регистр букв.

#### <a name="scriptlanguage"></a>ScriptLanguage
 В качестве языка программирования для компонента «Скрипт» можно выбрать [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic или [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#.

#### <a name="edit-script-button"></a>Кнопка «Изменить скрипт»
 После нажатия кнопки **Изменить скрипт** открывается интегрированная среда разработки средств [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] для приложений (VSTA), в которой вы создаете пользовательский скрипт. Дополнительные сведения см. в разделе [Кодирование и отладка компонента скрипта](coding-and-debugging-the-script-component.md).

### <a name="connection-managers-page-of-the-script-transformation-editor"></a>Страница «Диспетчеры соединений» окна «Редактор преобразования "Скрипт"»
 На странице **Диспетчеры соединений** окна **Редактор преобразования "скрипт"** можно добавлять и удалять диспетчеры соединений, предназначенные для применения в пользовательском скрипте. Обычно необходимость ссылаться на диспетчеры соединений возникает при создании компонента источника или назначения.

 В проекте кода, который будет создан на основе этих метаданных, элемент проекта `ComponentWrapper` содержит класс коллекции `Connections`, имеющий свойство типизированного метода доступа для каждого выбранного диспетчера соединений. Каждое свойство типизированного метода доступа имеет такое же имя, что и сам диспетчер соединений, и возвращает ссылку на диспетчер соединений как экземпляр <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>. Например, если на странице **Диспетчеры соединений** редактора добавлен диспетчер подключений с именем `MyADONETConnection`, можно получить ссылку на этот диспетчер подключений в скрипте с помощью следующего кода:

```vb
Dim myADONETConnectionManager As IDTSConnectionManager100 = _
    Me.Connections.MyADONETConnection
```

 Дополнительные сведения см. в разделе [Соединение с источниками данных в компоненте скрипта](connecting-to-data-sources-in-the-script-component.md).

![Значок Integration Services (маленький)](../../media/dts-16.gif "Значок служб Integration Services (маленький)")  **следит за обновлениями Integration Services**<br /> Чтобы загрузить новейшую документацию, статьи, образцы и видеоматериалы корпорации Майкрософт, а также лучшие решения участников сообщества, посетите страницу служб [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] на сайте MSDN:<br /><br /> [Посетить страницу «Службы Integration Services» на сайте MSDN](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> Чтобы получать автоматические уведомления об этих обновлениях, подпишитесь на RSS-каналы, предлагаемые на этой странице.

## <a name="see-also"></a>См. также:
 [Кодирование и отладка компонента скрипта](coding-and-debugging-the-script-component.md)


