---
title: Настройка компонента скрипта в редакторе компонента скрипта | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- SSIS Script component
- Script Component Editor
- SSIS Script component, configuring
- Script component [Integration Services], configuring
ms.assetid: 586dd799-f383-4d6d-b1a1-f09233d14f0a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4a9925d29c7a960c46e217f1e96c0bcae4f217b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87665435"
---
# <a name="configuring-the-script-component-in-the-script-component-editor"></a><span data-ttu-id="0aa9f-102">Настройка компонента скрипта в редакторе компонента скрипта</span><span class="sxs-lookup"><span data-stu-id="0aa9f-102">Configuring the Script Component in the Script Component Editor</span></span>
  <span data-ttu-id="0aa9f-103">Прежде чем приступать к написанию пользовательского кода в компоненте скрипта, необходимо выбрать тип компонента потока данных, который должен быть создан (источник, преобразование или назначение), а затем настроить метаданные и свойства компонента в окне **Редактор преобразования "скрипт"** .</span><span class="sxs-lookup"><span data-stu-id="0aa9f-103">Before you write custom code in the Script component, you must select the type of data flow component that you want to create-source, transformation, or destination-and then configure the component's metadata and properties in the **Script Transformation Editor**.</span></span>

## <a name="selecting-the-type-of-component-to-create"></a><span data-ttu-id="0aa9f-104">Выбор типа создаваемого компонента</span><span class="sxs-lookup"><span data-stu-id="0aa9f-104">Selecting the Type of Component to Create</span></span>
 <span data-ttu-id="0aa9f-105">При добавлении компонента скрипта на панель "Поток данных" конструктора служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] открывается диалоговое окно **Выбор типа компонента скрипта**.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-105">When you add a Script component to the Data Flow pane of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears.</span></span> <span data-ttu-id="0aa9f-106">Компонент должен быть предварительно настроен как источник, преобразование или назначение.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-106">You preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="0aa9f-107">После начального выбора можно продолжить настройку компонента в окне **Редактор преобразования "скрипт"** .</span><span class="sxs-lookup"><span data-stu-id="0aa9f-107">After you make this initial selection, you can continue to configure the component in the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="0aa9f-108">Чтобы установить язык скрипта по умолчанию для компонента скрипта, воспользуйтесь параметром **Язык сценариев** на странице **Общие** диалогового окна **Параметры**.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-108">To set the default script language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="0aa9f-109">Дополнительные сведения см. в разделе [General Page](../../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-109">For more information, see [General Page](../../general-page-of-integration-services-designers-options.md).</span></span>

## <a name="understanding-the-two-design-time-modes"></a><span data-ttu-id="0aa9f-110">Основные сведения о двух режимах времени разработки</span><span class="sxs-lookup"><span data-stu-id="0aa9f-110">Understanding the Two Design-Time Modes</span></span>
 <span data-ttu-id="0aa9f-111">В конструкторе [!INCLUDE[ssIS](../../../includes/ssis-md.md)] у компонента Script есть два режима: режим конструирования метаданных и режим конструирования кода.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-111">In [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata design mode and code design mode.</span></span>

 <span data-ttu-id="0aa9f-112">При открытии окна **Редактор преобразования "скрипт"** компонент переходит в режим конструктора метаданных.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-112">When you open the **Script Transformation Editor**, the component enters metadata design mode.</span></span> <span data-ttu-id="0aa9f-113">В этом режиме можно выбрать входные столбцы, а также добавить или настроить выходы и выходные столбцы, но нельзя писать код.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-113">In this mode, you can select input columns, and add or configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="0aa9f-114">После настройки метаданных компонента можно переключиться в режим конструктора кода для создания скрипта.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-114">After you have configured the component's metadata, you can switch to code design mode to write the script.</span></span>

 <span data-ttu-id="0aa9f-115">После переключения в режим конструктора кода путем нажатия кнопки **Изменить скрипт** компонент скрипта блокирует внесение дополнительных изменений в метаданные, а затем автоматически формирует код базовых классов на основе метаданных входов и выходов.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-115">When you switch to code design mode by clicking **Edit Script**, the Script component locks metadata to prevent additional changes, and then automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="0aa9f-116">После завершения автоматического формирования кода появляется возможность вводить пользовательский код.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-116">After the autogenerated code is complete, you will be able to enter your custom code.</span></span> <span data-ttu-id="0aa9f-117">В разрабатываемом коде используются автоматически сформированные базовые классы для обработки входных строк, доступа к буферам и столбцам в буферах, а также для получения диспетчеров соединений и переменных из пакета; при этом все объекты рассматриваются как строго типизированные.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-117">Your code uses the auto-generated base classes to process input rows, to access buffers and columns in the buffers, and to retrieve connection managers and variables from the package, all as strongly-typed objects.</span></span>

 <span data-ttu-id="0aa9f-118">После ввода пользовательского кода в режиме конструктора кода можно переключиться обратно в режим конструктора метаданных.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-118">After entering your custom code in code design mode, you can switch back to metadata design mode.</span></span> <span data-ttu-id="0aa9f-119">Это не приводит к удалению введенного кода, но последующие изменения в метаданных вызывают повторное формирование базового класса.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-119">This does not delete any code that you have entered; however, subsequent changes to the metadata cause the base class to be regenerated.</span></span> <span data-ttu-id="0aa9f-120">В дальнейшем проверка компонента может окончиться неудачей из-за того, что объекты, на которые имеются ссылки в пользовательском коде, больше не существуют или, возможно, были изменены.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-120">Afterward, your component may fail validation because objects referenced by your custom code may no longer exist or may have been modified.</span></span> <span data-ttu-id="0aa9f-121">В этом случае необходимо исправить код вручную, чтобы можно было успешно скомпилировать его для повторно сформированного базового класса.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-121">In this case, you must fix your code manually so that it can be compiled successfully against the regenerated base class.</span></span>

## <a name="configuring-the-component-in-metadata-design-mode"></a><span data-ttu-id="0aa9f-122">Настройка компонента в режиме конструктора метаданных</span><span class="sxs-lookup"><span data-stu-id="0aa9f-122">Configuring the Component in Metadata Design Mode</span></span>
 <span data-ttu-id="0aa9f-123">В режиме конструктора метаданных можно выбирать входные столбцы, а также добавлять и настраивать выходы и выходные столбцы, но возможность писать код не предусмотрена.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-123">In metadata design mode, you can select input columns, and add and configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="0aa9f-124">После настройки конфигурации метаданных компонента переключитесь в режим конструктора кода для написания скрипта.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-124">After you have configured the component's metadata, switch to code design mode to write the script.</span></span>

 <span data-ttu-id="0aa9f-125">Свойства, которые необходимо настроить в пользовательском редакторе, зависят от выбранной области применения компонента скрипта.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-125">The properties that you must configure in the custom editor depend on the usage of the Script component.</span></span> <span data-ttu-id="0aa9f-126">Компонент скрипта можно настроить как источник, преобразование или назначение.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-126">The Script component can be configured as a source, a transformation, or a destination.</span></span> <span data-ttu-id="0aa9f-127">В зависимости от того, как компонент используется, он поддерживает либо вход, либо выход, либо и вход и выход одновременно.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-127">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="0aa9f-128">Пользовательский код, который должен быть написан, применяется для обработки входных и выходных строк и столбцов.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-128">The custom code that you will write processes the input and output rows and columns.</span></span>

### <a name="inputs-columns-page-of-the-script-transformation-editor"></a><span data-ttu-id="0aa9f-129">Страница «Входные столбцы» окна «Редактор преобразования "Скрипт"»</span><span class="sxs-lookup"><span data-stu-id="0aa9f-129">Inputs Columns Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="0aa9f-130">Страница **Входные столбцы** окна **Редактор преобразования "скрипт"** отображается для преобразований и назначений, но не для источников.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-130">The **Input Columns** page of the **Script Transformation Editor** is displayed for transformations and destinations, but not for sources.</span></span> <span data-ttu-id="0aa9f-131">На этой странице выбираются доступные входные столбцы, которые необходимо сделать доступными для пользовательского скрипта, а также указывается тип доступа для них: только для чтения или для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-131">On this page, you select the available input columns that you want to make available to your custom script, and specify read-only or read/write access to them.</span></span>

 <span data-ttu-id="0aa9f-132">В проекте кода, создаваемого на основе этих метаданных, элемент проекта BufferWrapper содержит класс для каждого входа и этот класс включает свойства типизированного метода доступа для каждого выбранного входного столбца.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-132">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input, and this class contains typed accessor properties for each input column selected.</span></span> <span data-ttu-id="0aa9f-133">Например, если выбрать целочисленный столбец **CustomerID** и столбец String **CustomerName** из входных данных с именем `CustomerInput` , то элемент проекта BufferWrapper будет содержать `CustomerInput` класс, производный от <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> , а `CustomerInput` класс будет предоставлять целочисленное свойство с именем **CustomerID** и строковое свойство с именем **CustomerName**.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-133">For example, if you select an integer **CustomerID** column and a string **CustomerName** column from an input named `CustomerInput`, the BufferWrapper project item will contain a `CustomerInput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerInput` class will expose an integer property named **CustomerID** and a string property named **CustomerName**.</span></span> <span data-ttu-id="0aa9f-134">Благодаря наличию такого соглашения появляется возможность писать код с проверкой соответствия типов, подобный следующему:</span><span class="sxs-lookup"><span data-stu-id="0aa9f-134">This convention makes it possible to write code with type-checking like the following:</span></span>

```vb
Dim currentCustomerID as Integer = CustomerInput.CustomerID
Dim currentCustomerName as String = CustomerInput.CustomerName
```

 <span data-ttu-id="0aa9f-135">Дополнительные сведения о том, как настраивать входные столбцы для конкретного типа компонента потока данных, см. в соответствующем примере в разделе [Разработка компонентов скрипта определенных типов](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-135">For more information about how to configure input columns for a specific type of data flow component, see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

### <a name="inputs-and-outputs-page-of-the-script-transformation-editor"></a><span data-ttu-id="0aa9f-136">Страница «Входы и выходы» окна «Редактор преобразования "Скрипт"»</span><span class="sxs-lookup"><span data-stu-id="0aa9f-136">Inputs and Outputs Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="0aa9f-137">Страница **Входы и выходы** окна **Редактор преобразования "скрипт"** отображается для источников, преобразований и назначений.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-137">The **Input and Outputs** page of the **Script Transformation Editor** is displayed for sources, transformations, and destinations.</span></span> <span data-ttu-id="0aa9f-138">На этой странице можно добавлять, удалять и настраивать входы, выходы и выходные столбцы, которые нужно использовать в пользовательском скрипте, с учетом следующих ограничений.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-138">On this page, you add, remove, and configure inputs, outputs, and output columns that you want to use in your custom script, within the following limitations:</span></span>

-   <span data-ttu-id="0aa9f-139">При использовании в качестве источника компонент скрипта не имеет входов и поддерживает несколько выходов.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-139">When used as a source, the Script component has no input and supports multiple outputs.</span></span>

-   <span data-ttu-id="0aa9f-140">При использовании в качестве преобразования компонент скрипта поддерживает один вход и несколько выходов.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-140">When used as a transformation, the Script component supports one input and multiple outputs.</span></span>

-   <span data-ttu-id="0aa9f-141">При использовании в качестве назначения компонент скрипта поддерживает один вход и не имеет выходов.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-141">When used as a destination, the Script component supports one input and has no outputs.</span></span>

 <span data-ttu-id="0aa9f-142">В проекте кода, создаваемом на основе этих метаданных, элемент проекта BufferWrapper содержит класс для каждого входа и выхода.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-142">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input and output.</span></span> <span data-ttu-id="0aa9f-143">Например, если создается выход с именем `CustomerOutput` , элемент проекта BufferWrapper будет содержать `CustomerOutput` класс, производный от <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> , а `CustomerOutput` класс будет содержать свойства типизированного метода доступа для каждого созданного выходного столбца.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-143">For example, if you create an output named `CustomerOutput`, the BufferWrapper project item will contain a `CustomerOutput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerOutput` class will contain typed accessor properties for each output column created.</span></span>

 <span data-ttu-id="0aa9f-144">Настраивать выходные столбцы можно только на странице **Входы и выходы**.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-144">You can configure output columns only on the **Input and Outputs** page.</span></span> <span data-ttu-id="0aa9f-145">Входные столбцы для преобразований и назначений можно выбрать на странице **Входные столбцы**.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-145">You can select input columns for transformations and destinations on the **Input Columns** page.</span></span> <span data-ttu-id="0aa9f-146">Свойства типизированного метода доступа, созданные для разработчика в элементе проекта BufferWrapper, будут доступны только для записи для выходных столбцов.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-146">The typed accessor properties created for you in the BufferWrapper project item will be write-only for output columns.</span></span> <span data-ttu-id="0aa9f-147">Свойства метода доступа для входных столбцов будут доступны только для чтения или для чтения и записи в зависимости от области применения, выбранной для каждого столбца на странице **Входные столбцы**.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-147">The accessor properties for input columns will be read-only or read/write depending on the usage type that you have selected for each column on the **Input Columns** page.</span></span>

 <span data-ttu-id="0aa9f-148">Дополнительные сведения о настройке входов и выходов для конкретного типа компонента потока данных см. в соответствующем примере в разделе [Разработка компонентов скрипта определенных типов](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-148">For more information about configuring inputs and outputs for a specific type of data flow component see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="0aa9f-149">Хотя нельзя непосредственно настроить выход в качестве вывода ошибок в компоненте скрипта для автоматической обработки ошибочных строк, но можно воспроизвести функциональные возможности вывода ошибок путем создания дополнительного выхода и использования скрипта для направления строк в этот выход при соответствующих условиях.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-149">Although you cannot directly configure an output as an error output in the Script component for automatic handling of error rows, you can reproduce the functionality of an error output by creating an additional output and using script to direct rows to this output when appropriate.</span></span> <span data-ttu-id="0aa9f-150">Дополнительные сведения см. в разделе [Имитация вывода ошибок для компонента скрипта](../../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-150">For more information, see [Simulating an Error Output for the Script Component](../../data-flow/transformations/script-component.md).</span></span>

#### <a name="exclusiongroup-and-synchronousinputid-properties-of-outputs"></a><span data-ttu-id="0aa9f-151">Свойства ExclusionGroup и SynchronousInputID выходов</span><span class="sxs-lookup"><span data-stu-id="0aa9f-151">ExclusionGroup and SynchronousInputID Properties of Outputs</span></span>
 <span data-ttu-id="0aa9f-152">Свойство `ExclusionGroup` имеет ненулевое значение только в преобразованиях с синхронными выходами, где в коде выполняется фильтрация или ветвление, а каждая строка направляется в один из выходов, имеющих одно и то же ненулевое значение `ExclusionGroup`.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-152">The `ExclusionGroup` property has a non-zero value only in transformations with synchronous outputs, where your code performs filtering or branching and directs each row to one of the outputs that share the same non-zero `ExclusionGroup` value.</span></span> <span data-ttu-id="0aa9f-153">Например, преобразование может направлять строки либо в выход по умолчанию, либо в вывод ошибок.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-153">For example, the transformation can direct rows either to the default output or to an error output.</span></span> <span data-ttu-id="0aa9f-154">При создании дополнительных выходов для этого сценария необходимо задать в качестве значения свойства `SynchronousInputID` целое число, которое совпадает со значением `ID` на входе компонента.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-154">When you create additional outputs for this scenario, make sure to set the value of the `SynchronousInputID` property to the integer that matches the `ID` of the component's input.</span></span>

 <span data-ttu-id="0aa9f-155">Свойство `SynchronousInputID` имеет ненулевое значение только в преобразованиях с синхронными выходами.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-155">The `SynchronousInputID` property has a non-zero value only in transformations with synchronous outputs.</span></span> <span data-ttu-id="0aa9f-156">Если это свойство равно нулю, выход является асинхронным.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-156">If the value of this property is zero, it means that the output is asynchronous.</span></span> <span data-ttu-id="0aa9f-157">Для синхронного выхода, при использовании которого строки передаются в выбранный выход или выходы без добавления каких-либо новых строк, это свойство должно содержать значение `ID` входа компонента.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-157">For a synchronous output, where rows are passed through to the selected output or outputs without adding any new rows, this property should contain the `ID` of the component's input.</span></span>

> [!NOTE]
>  <span data-ttu-id="0aa9f-158">Когда **Редактор преобразования «Скрипт** » создает первый выход, редактор задает `SynchronousInputID` для свойства выходных данных значение `ID` из входных данных компонента.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-158">When the **Script Transformation Editor** creates the first output, the editor sets the `SynchronousInputID` property of the output to the `ID` of the component's input.</span></span> <span data-ttu-id="0aa9f-159">Однако при создании последующих выходов редактор задает для свойства `SynchronousInputID` этих выходов значение равное нулю.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-159">However, when the editor creates subsequent outputs, the editor sets the `SynchronousInputID` properties of those outputs to zero.</span></span>
> 
>  <span data-ttu-id="0aa9f-160">Если вы создаете компонент с синхронными выходами, для каждого выхода должно быть `SynchronousInputID` задано свойство для `ID` входных данных компонента.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-160">If you are creating a component with synchronous outputs, each output must have its `SynchronousInputID` property set to the `ID` of the component's input.</span></span> <span data-ttu-id="0aa9f-161">Поэтому для каждого выхода, созданного редактором вслед за первым выходом, необходимо изменить значение свойства `SynchronousInputID` с нуля на значение `ID` входа компонента.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-161">Therefore, each output that the editor creates after the first output must have its `SynchronousInputID` value changed from zero to the `ID` of the component's input.</span></span>
> 
>  <span data-ttu-id="0aa9f-162">Если создается компонент с асинхронными выходами, то для каждого выхода необходимо задать значение свойства `SynchronousInputID`, равное нулю.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-162">If you are creating a component with asynchronous outputs, each output must have its `SynchronousInputID` property set to zero.</span></span> <span data-ttu-id="0aa9f-163">Таким образом, значение первого выхода должно `SynchronousInputID` изменяться от значения `ID` входных данных компонента до нуля.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-163">Therefore, the first output must have its `SynchronousInputID` value changed from the `ID` of the component's input to zero.</span></span>

 <span data-ttu-id="0aa9f-164">Пример направления строк в один или два синхронных выхода в компоненте скрипта см. в разделе [Создание синхронного преобразования с помощью компонента скрипта](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-164">For an example of directing rows to one of two synchronous outputs in the Script component, see [Creating a Synchronous Transformation with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).</span></span>

### <a name="object-names-in-generated-script"></a><span data-ttu-id="0aa9f-165">Имена объектов в созданном скрипте</span><span class="sxs-lookup"><span data-stu-id="0aa9f-165">Object Names in Generated Script</span></span>
 <span data-ttu-id="0aa9f-166">Компонент скрипта анализирует имена входов и выходов, а также имена столбцов во входах и выходах, после чего на основе этих имен создает классы и свойства в элементе проекта BufferWrapper.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-166">The Script component parses the names of inputs and outputs, and parse the names of columns in the inputs and outputs, and based on these names generates classes and properties in the BufferWrapper project item.</span></span> <span data-ttu-id="0aa9f-167">Если найденные имена включают символы, не принадлежащие к категориям Юникода `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter` или `DecimalDigitLetter`, эти недопустимые символы удаляются из создаваемых имен.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-167">If the found names include characters that do not belong to the Unicode categories `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter`, or `DecimalDigitLetter`, the invalid characters are dropped in the generated names.</span></span> <span data-ttu-id="0aa9f-168">Например, удаляются пробелы, поэтому два входных столбца с именами **FirstName** и [**First Name**] интерпретируются как имеющие имя столбца **FirstName**, что приводит к получению непредсказуемых результатов.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-168">For example, spaces are dropped, therefore two input columns that have the names **FirstName** and [**First Name**] are both interpreted as having the column name **FirstName**, with unpredictable results.</span></span> <span data-ttu-id="0aa9f-169">Чтобы избежать такой ситуации, имена входов и выходов и имена входных и выходных столбцов, используемых в компоненте скрипта, должны содержать только символы из категорий Юникода, перечисленных в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-169">To avoid this situation, the names of inputs and outputs and of input and output columns used by the Script component should contain only characters in the Unicode categories listed in this section.</span></span>

### <a name="script-page-of-the-script-transformation-editor"></a><span data-ttu-id="0aa9f-170">Страница «Скрипт» окна «Редактор преобразования "Скрипт"»</span><span class="sxs-lookup"><span data-stu-id="0aa9f-170">Script Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="0aa9f-171">На странице **Скрипт** окна **Редактор задачи "скрипт"** можно присвоить уникальное имя и описание задаче "Скрипт".</span><span class="sxs-lookup"><span data-stu-id="0aa9f-171">On the **Script** page of the **Script Task Editor**, you assign a unique name and a description for the Script task.</span></span> <span data-ttu-id="0aa9f-172">Можно также присваивать значения для следующих свойств.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-172">You can also assign values for the following properties.</span></span>

> [!NOTE]
>  <span data-ttu-id="0aa9f-173">В [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] и более поздних версиях все скрипты предварительно скомпилированы.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-173">In [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions, all scripts are precompiled.</span></span> <span data-ttu-id="0aa9f-174">В предыдущих версиях приходилось указывать, должна ли была выполняться предварительная компиляция скриптов, задавая для задачи свойство `Precompile`.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-174">In previous versions, you specified whether scripts were precompiled by setting a `Precompile` property for the task.</span></span>

#### <a name="validateexternalmetadata-property"></a><span data-ttu-id="0aa9f-175">Свойство ValidateExternalMetadata</span><span class="sxs-lookup"><span data-stu-id="0aa9f-175">ValidateExternalMetadata Property</span></span>
 <span data-ttu-id="0aa9f-176">Логическое значение свойства `ValidateExternalMetadata` указывает, должна ли в компоненте выполняться проверка по отношению к внешним источникам данных во время разработки или эту проверку следует отложить до времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-176">The Boolean value of the `ValidateExternalMetadata` property specifies whether the component should perform validation against external data sources at design time, or whether it should postpone validation until run time.</span></span> <span data-ttu-id="0aa9f-177">По умолчанию это свойство имеет значение `True`; иными словами, внешние метаданные проверяются и во время разработки, и во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-177">By default, the value of this property is `True`; that is, the external metadata is validated both at design time and at run time.</span></span> <span data-ttu-id="0aa9f-178">Может потребоваться установить значение этого свойства равным, `False` Если внешний источник данных недоступен во время разработки: например, когда пакет скачивает источник или создает назначение только во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-178">You may want to set the value of this property to `False` when an external data source is not available at design time: for example, when the package downloads the source or creates the destination only at run time.</span></span>

#### <a name="readonlyvariables-and-readwritevariables-properties"></a><span data-ttu-id="0aa9f-179">Свойства ReadOnlyVariables и ReadWriteVariables</span><span class="sxs-lookup"><span data-stu-id="0aa9f-179">ReadOnlyVariables and ReadWriteVariables Properties</span></span>
 <span data-ttu-id="0aa9f-180">Можно вводить разделенные запятыми списки существующих переменных в качестве значений этих свойств, чтобы обеспечить доступ к переменным только для чтения или для чтения и записи в коде компонента скрипта.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-180">You can enter comma-delimited lists of existing variables as the values of these properties to make the variables available for read-only or read/write access within the Script component code.</span></span> <span data-ttu-id="0aa9f-181">Доступ к переменным в коде осуществляется с помощью свойств <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> и <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> автоматически сформированного базового класса.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-181">Variables are accessed in code through the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> and <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> properties of the autogenerated base class.</span></span> <span data-ttu-id="0aa9f-182">Дополнительные сведения см. в разделе [Использование переменных в компоненте скрипта](using-variables-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-182">For more information, see [Using Variables in the Script Component](using-variables-in-the-script-component.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="0aa9f-183">В именах переменных учитывается регистр букв.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-183">Variable names are case-sensitive.</span></span>

#### <a name="scriptlanguage"></a><span data-ttu-id="0aa9f-184">ScriptLanguage</span><span class="sxs-lookup"><span data-stu-id="0aa9f-184">ScriptLanguage</span></span>
 <span data-ttu-id="0aa9f-185">В качестве языка программирования для компонента «Скрипт» можно выбрать [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic или [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-185">You can select either [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# as the programming language for the Script component.</span></span>

#### <a name="edit-script-button"></a><span data-ttu-id="0aa9f-186">Кнопка «Изменить скрипт»</span><span class="sxs-lookup"><span data-stu-id="0aa9f-186">Edit Script Button</span></span>
 <span data-ttu-id="0aa9f-187">После нажатия кнопки **Изменить скрипт** открывается интегрированная среда разработки средств [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] для приложений (VSTA), в которой вы создаете пользовательский скрипт.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-187">The **Edit Script** button opens the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE in which you write your custom script.</span></span> <span data-ttu-id="0aa9f-188">Дополнительные сведения см. в разделе [Кодирование и отладка компонента скрипта](coding-and-debugging-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-188">For more information, see [Coding and Debugging the Script Component](coding-and-debugging-the-script-component.md).</span></span>

### <a name="connection-managers-page-of-the-script-transformation-editor"></a><span data-ttu-id="0aa9f-189">Страница «Диспетчеры соединений» окна «Редактор преобразования "Скрипт"»</span><span class="sxs-lookup"><span data-stu-id="0aa9f-189">Connection Managers Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="0aa9f-190">На странице **Диспетчеры соединений** окна **Редактор преобразования "скрипт"** можно добавлять и удалять диспетчеры соединений, предназначенные для применения в пользовательском скрипте.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-190">On the **Connection Managers** page of the **Script Transformation Editor**, you add and remove connection managers that you want to use in your custom script.</span></span> <span data-ttu-id="0aa9f-191">Обычно необходимость ссылаться на диспетчеры соединений возникает при создании компонента источника или назначения.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-191">Normally you need to reference connection managers when you create a source or destination component.</span></span>

 <span data-ttu-id="0aa9f-192">В проекте кода, который будет создан на основе этих метаданных, элемент проекта `ComponentWrapper` содержит класс коллекции `Connections`, имеющий свойство типизированного метода доступа для каждого выбранного диспетчера соединений.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-192">In the code project that will be generated based on this metadata, the `ComponentWrapper` project item contains a `Connections` collection class that has a typed accessor property for each selected connection manager.</span></span> <span data-ttu-id="0aa9f-193">Каждое свойство типизированного метода доступа имеет такое же имя, что и сам диспетчер соединений, и возвращает ссылку на диспетчер соединений как экземпляр <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-193">Each typed accessor property has the same name as the connection manager itself and returns a reference to the connection manager as an instance of <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span></span> <span data-ttu-id="0aa9f-194">Например, если на странице **Диспетчеры соединений** редактора добавлен диспетчер подключений с именем `MyADONETConnection`, можно получить ссылку на этот диспетчер подключений в скрипте с помощью следующего кода:</span><span class="sxs-lookup"><span data-stu-id="0aa9f-194">For example, if you have added a connection manager named `MyADONETConnection` on the **Connection Managers** page of the editor, you can obtain a reference to the connection manager in your script by using the following code:</span></span>

```vb
Dim myADONETConnectionManager As IDTSConnectionManager100 = _
    Me.Connections.MyADONETConnection
```

 <span data-ttu-id="0aa9f-195">Дополнительные сведения см. в разделе [Соединение с источниками данных в компоненте скрипта](connecting-to-data-sources-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0aa9f-195">For more information, see [Connecting to Data Sources in the Script Component](connecting-to-data-sources-in-the-script-component.md).</span></span>

<span data-ttu-id="0aa9f-196">![Значок Integration Services (маленький)](../../media/dts-16.gif "Значок служб Integration Services (маленький)")  **следит за обновлениями Integration Services**</span><span class="sxs-lookup"><span data-stu-id="0aa9f-196">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="0aa9f-197">Чтобы загрузить новейшую документацию, статьи, образцы и видеоматериалы корпорации Майкрософт, а также лучшие решения участников сообщества, посетите страницу служб [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] на сайте MSDN:</span><span class="sxs-lookup"><span data-stu-id="0aa9f-197">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="0aa9f-198">Посетить страницу «Службы Integration Services» на сайте MSDN</span><span class="sxs-lookup"><span data-stu-id="0aa9f-198">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="0aa9f-199">Чтобы получать автоматические уведомления об этих обновлениях, подпишитесь на RSS-каналы, предлагаемые на этой странице.</span><span class="sxs-lookup"><span data-stu-id="0aa9f-199">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="0aa9f-200">См. также:</span><span class="sxs-lookup"><span data-stu-id="0aa9f-200">See Also</span></span>
 [<span data-ttu-id="0aa9f-201">Кодирование и отладка компонента скрипта</span><span class="sxs-lookup"><span data-stu-id="0aa9f-201">Coding and Debugging the Script Component</span></span>](coding-and-debugging-the-script-component.md)


