---
title: Обработчики событий в службах Integration Services (SSIS) | Документы Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services packages, events
- run-time [Integration Services]
- SQL Server Integration Services packages, events
- event handlers [Integration Services], about event handlers
- events [Integration Services]
- packages [Integration Services], events
- event handlers [Integration Services]
- SSIS packages, events
- containers [Integration Services], events
- events [Integration Services], about events
ms.assetid: 6f60cf93-35dc-431c-908d-2049c4ab66ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 78bcd6579aa8306c89fd9530fad3557ac57f102a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664386"
---
# <a name="integration-services-ssis-event-handlers"></a><span data-ttu-id="b345d-102">Обработчики событий в службах Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="b345d-102">Integration Services (SSIS) Event Handlers</span></span>
  <span data-ttu-id="b345d-103">Во время выполнения исполняемых объектов (пакетов, контейнеров «цикл по каждому элементу», «цикл по элементам», последовательности и узлы задач) возникают события.</span><span class="sxs-lookup"><span data-stu-id="b345d-103">At run time, executables (packages and Foreach Loop, For Loop, Sequence, and task host containers) raise events.</span></span> <span data-ttu-id="b345d-104">Например, в случае ошибки возникает событие OnError.</span><span class="sxs-lookup"><span data-stu-id="b345d-104">For example, an OnError event is raised when an error occurs.</span></span> <span data-ttu-id="b345d-105">Можно создать пользовательские обработчики событий для этих событий, чтобы расширить функциональность пакетов и упростить управление пакетами во время их выполнения.</span><span class="sxs-lookup"><span data-stu-id="b345d-105">You can create custom event handlers for these events to extend package functionality and make packages easier to manage at run time.</span></span> <span data-ttu-id="b345d-106">Обработчики событий могут выполнять следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="b345d-106">Event handlers can perform tasks such as the following:</span></span>

-   <span data-ttu-id="b345d-107">Очистка временного хранилища данных, когда пакет или задача прекращает выполнение.</span><span class="sxs-lookup"><span data-stu-id="b345d-107">Clean up temporary data storage when a package or task finishes running.</span></span>

-   <span data-ttu-id="b345d-108">Получение сведений о системе для слежения за доступностью ресурса перед запуском пакета.</span><span class="sxs-lookup"><span data-stu-id="b345d-108">Retrieve system information to assess resource availability before a package runs.</span></span>

-   <span data-ttu-id="b345d-109">Обновление данных в таблице, когда уточняющий запрос в ссылочной таблице закончился неудачей.</span><span class="sxs-lookup"><span data-stu-id="b345d-109">Refresh data in a table when a lookup in a reference table fails.</span></span>

-   <span data-ttu-id="b345d-110">Отправка сообщения по электронной почте при возникновении ошибки или предупреждения или при неудачном завершении задачи.</span><span class="sxs-lookup"><span data-stu-id="b345d-110">Send an e-mail message when an error or a warning occurs or when a task fails.</span></span>

 <span data-ttu-id="b345d-111">Если у события нет обработчика, событие передается контейнеру выше по иерархии контейнеров пакета.</span><span class="sxs-lookup"><span data-stu-id="b345d-111">If an event has no event handler, the event is raised to the next container up the container hierarchy in a package.</span></span> <span data-ttu-id="b345d-112">Если у этого контейнера есть обработчик, он выполняется в ответ на событие.</span><span class="sxs-lookup"><span data-stu-id="b345d-112">If this container has an event handler, the event handler runs in response to the event.</span></span> <span data-ttu-id="b345d-113">Если нет, то событие передается контейнеру выше в иерархии контейнеров.</span><span class="sxs-lookup"><span data-stu-id="b345d-113">If not, the event is raised to the next container up the container hierarchy.</span></span>

 <span data-ttu-id="b345d-114">Следующая диаграмма приводит простой пакет, имеющий контейнер «цикл по элементам», который, в свою очередь, содержит задачу «Выполнение SQL».</span><span class="sxs-lookup"><span data-stu-id="b345d-114">The following diagram shows a simple package that has a For Loop container that contains one Execute SQL task.</span></span>

 <span data-ttu-id="b345d-115">![Пакет, контейнер For Loop, сервер задач, задача "Выполнение SQL"](media/mw-dts-eventhandlerpkg.gif "Пакет, контейнер For Loop, сервер задач, задача "Выполнение SQL"")</span><span class="sxs-lookup"><span data-stu-id="b345d-115">![Package, For Loop, task host, and Execute SQL task](media/mw-dts-eventhandlerpkg.gif "Package, For Loop, task host, and Execute SQL task")</span></span>

 <span data-ttu-id="b345d-116">Только у пакета имеется обработчик для события `OnError`.</span><span class="sxs-lookup"><span data-stu-id="b345d-116">Only the package has an event handler, for its `OnError` event.</span></span> <span data-ttu-id="b345d-117">Когда ошибка происходит во время выполнения задачи «Выполнение SQL», то запускается обработчик события `OnError` данного пакета.</span><span class="sxs-lookup"><span data-stu-id="b345d-117">If an error occurs when the Execute SQL task runs, the `OnError` event handler for the package runs.</span></span> <span data-ttu-id="b345d-118">Следующая диаграмма показывает последовательность вызовов, вследствие которой выполняется обработчик события `OnError` данного пакета.</span><span class="sxs-lookup"><span data-stu-id="b345d-118">The following diagram shows the sequence of calls that causes the `OnError` event handler for the package to execute.</span></span>

 <span data-ttu-id="b345d-119">![Поток обработчиков событий](media/mw-dts-eventhandlers.gif "Поток обработчиков событий")</span><span class="sxs-lookup"><span data-stu-id="b345d-119">![Event handler flow](media/mw-dts-eventhandlers.gif "Event handler flow")</span></span>

 <span data-ttu-id="b345d-120">Обработчики событий являются элементами коллекции обработчиков событий, и эта коллекция включена во все контейнеры.</span><span class="sxs-lookup"><span data-stu-id="b345d-120">Event handlers are members of an event handler collection, and all containers include this collection.</span></span> <span data-ttu-id="b345d-121">Если пакет создается при помощи конструктора служб [!INCLUDE[ssIS](../includes/ssis-md.md)] , то можно видеть элементы коллекции обработчиков событий в папке **Обработчики событий** на вкладке **Обозреватель пакетов** конструктора служб [!INCLUDE[ssIS](../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b345d-121">If you create the package using [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, you can see the members of the event handler collections in the **Event Handlers** folders on the **Package Explorer** tab of [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer.</span></span>

 <span data-ttu-id="b345d-122">Можно настроить контейнер обработчика событий следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b345d-122">You can configure the event handler container in the following ways:</span></span>

-   <span data-ttu-id="b345d-123">Укажите имя и описание для обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="b345d-123">Specify a name and description for the event handler.</span></span>

-   <span data-ttu-id="b345d-124">Укажите, следует ли запускать обработчик событий, следует ли считать выполнение пакета неудачным в случае неудачи выполнения обработчика событий, а также укажите максимальное число ошибок, после которого обработчик считается неудачно завершенным.</span><span class="sxs-lookup"><span data-stu-id="b345d-124">Indicate whether the event handler runs, whether the package fails if the event handler fails, and the number of errors that can occur before the event handler fails.</span></span>

-   <span data-ttu-id="b345d-125">Укажите результат выполнения, который будет возвращен вместо действительного результата, возвращаемого обработчиком событий во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b345d-125">Specify an execution result to return instead of the actual execution result that the event handler returns at run time.</span></span>

-   <span data-ttu-id="b345d-126">Укажите параметр преобразования обработчика события.</span><span class="sxs-lookup"><span data-stu-id="b345d-126">Specify the transaction option for the event handler.</span></span>

-   <span data-ttu-id="b345d-127">Укажите режим создания журнала, используемого обработчиком событий.</span><span class="sxs-lookup"><span data-stu-id="b345d-127">Specify the logging mode that the event handler uses.</span></span>

## <a name="event-handler-content"></a><span data-ttu-id="b345d-128">Содержимое обработчика событий</span><span class="sxs-lookup"><span data-stu-id="b345d-128">Event Handler Content</span></span>
 <span data-ttu-id="b345d-129">Создание обработчика событий сходно с построением пакета: у обработчика есть задачи и контейнеры, которые по порядку включаются в поток управления, и обработчик также может включать в себя потоки данных.</span><span class="sxs-lookup"><span data-stu-id="b345d-129">Creating an event handler is similar to building a package; an event handler has tasks and containers, which are sequenced into a control flow, and an event handler can also include data flows.</span></span> <span data-ttu-id="b345d-130">Конструктор служб [!INCLUDE[ssIS](../includes/ssis-md.md)] содержит вкладку **Обработчики событий** для создания пользовательских обработчиков событий.</span><span class="sxs-lookup"><span data-stu-id="b345d-130">The [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer includes the **Event Handlers** tab for creating custom event handlers.</span></span> <span data-ttu-id="b345d-131">Дополнительные сведения см. в разделе [обработчики событий пакетов служб SSIS](integration-services-ssis-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="b345d-131">For more information, see [SSIS Package Event Handlers](integration-services-ssis-event-handlers.md).</span></span>

 <span data-ttu-id="b345d-132">Обработчики событий также могут быть созданы программно.</span><span class="sxs-lookup"><span data-stu-id="b345d-132">You can also create event handlers programmatically.</span></span> <span data-ttu-id="b345d-133">Дополнительные сведения см. в статье [Программная обработка событий](building-packages-programmatically/handling-events-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="b345d-133">For more information, see [Handling Events Programmatically](building-packages-programmatically/handling-events-programmatically.md).</span></span>

## <a name="run-time-events"></a><span data-ttu-id="b345d-134">События времени выполнения</span><span class="sxs-lookup"><span data-stu-id="b345d-134">Run-Time Events</span></span>
 <span data-ttu-id="b345d-135">В следующей таблице перечисляются обработчики событий, предоставляемые службами [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] , и описываются события времени выполнения, в случае которых обработчик запускается.</span><span class="sxs-lookup"><span data-stu-id="b345d-135">The following table lists the event handlers that [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] provides, and describes the run-time events that cause the event handler to run.</span></span>

|<span data-ttu-id="b345d-136">Обработчик событий</span><span class="sxs-lookup"><span data-stu-id="b345d-136">Event handler</span></span>|<span data-ttu-id="b345d-137">Событие</span><span class="sxs-lookup"><span data-stu-id="b345d-137">Event</span></span>|
|-------------------|-----------|
|`OnError`|<span data-ttu-id="b345d-138">Обработчик для события `OnError`.</span><span class="sxs-lookup"><span data-stu-id="b345d-138">The event handler for the `OnError` event.</span></span> <span data-ttu-id="b345d-139">Событие вызывается исполняемым объектом при возникновении ошибки.</span><span class="sxs-lookup"><span data-stu-id="b345d-139">This event is raised by an executable when an error occurs.</span></span>|
|<span data-ttu-id="b345d-140">**OnExecStatusChanged**</span><span class="sxs-lookup"><span data-stu-id="b345d-140">**OnExecStatusChanged**</span></span>|<span data-ttu-id="b345d-141">Обработчик события **OnExecStatusChanged** .</span><span class="sxs-lookup"><span data-stu-id="b345d-141">The event handler for the **OnExecStatusChanged** event.</span></span> <span data-ttu-id="b345d-142">Событие вызывается исполняемым объектом при изменении его состояния выполнения.</span><span class="sxs-lookup"><span data-stu-id="b345d-142">This event is raised by an executable when its execution status changes.</span></span>|
|<span data-ttu-id="b345d-143">**OnInformation**</span><span class="sxs-lookup"><span data-stu-id="b345d-143">**OnInformation**</span></span>|<span data-ttu-id="b345d-144">Обработчик события **OnInformation** .</span><span class="sxs-lookup"><span data-stu-id="b345d-144">The event handler for the **OnInformation** event.</span></span> <span data-ttu-id="b345d-145">Это событие вызывается во время проверки и выполнения исполняемого объекта для передачи данных.</span><span class="sxs-lookup"><span data-stu-id="b345d-145">This event is raised during the validation and execution of an executable to report information.</span></span> <span data-ttu-id="b345d-146">Событие передает только данные; ошибки и предупреждения не передаются.</span><span class="sxs-lookup"><span data-stu-id="b345d-146">This event conveys information only, no errors or warnings.</span></span>|
|<span data-ttu-id="b345d-147">**OnPostExecute**</span><span class="sxs-lookup"><span data-stu-id="b345d-147">**OnPostExecute**</span></span>|<span data-ttu-id="b345d-148">Обработчик события **OnPostExecute** .</span><span class="sxs-lookup"><span data-stu-id="b345d-148">The event handler for the **OnPostExecute** event.</span></span> <span data-ttu-id="b345d-149">Событие вызывается исполняемым объектом сразу после выполнения.</span><span class="sxs-lookup"><span data-stu-id="b345d-149">This event is raised by an executable immediately after it has finished running.</span></span>|
|<span data-ttu-id="b345d-150">**OnPostValidate**</span><span class="sxs-lookup"><span data-stu-id="b345d-150">**OnPostValidate**</span></span>|<span data-ttu-id="b345d-151">Обработчик события **OnPostValidate** .</span><span class="sxs-lookup"><span data-stu-id="b345d-151">The event handler for the **OnPostValidate** event.</span></span> <span data-ttu-id="b345d-152">Событие вызывается исполняемым объектом после завершения проверки.</span><span class="sxs-lookup"><span data-stu-id="b345d-152">This event is raised by an executable when its validation is finished.</span></span>|
|<span data-ttu-id="b345d-153">**OnPreExecute**</span><span class="sxs-lookup"><span data-stu-id="b345d-153">**OnPreExecute**</span></span>|<span data-ttu-id="b345d-154">Обработчик события **OnPreExecute** .</span><span class="sxs-lookup"><span data-stu-id="b345d-154">The event handler for the **OnPreExecute** event.</span></span> <span data-ttu-id="b345d-155">Событие вызывается исполняемым объектом непосредственно перед его запуском.</span><span class="sxs-lookup"><span data-stu-id="b345d-155">This event is raised by an executable immediately before it runs.</span></span>|
|<span data-ttu-id="b345d-156">**OnPreValidate**</span><span class="sxs-lookup"><span data-stu-id="b345d-156">**OnPreValidate**</span></span>|<span data-ttu-id="b345d-157">Обработчик события **OnPreValidate** .</span><span class="sxs-lookup"><span data-stu-id="b345d-157">The event handler for the **OnPreValidate** event.</span></span> <span data-ttu-id="b345d-158">Событие вызывается исполняемым объектом в начале проверки.</span><span class="sxs-lookup"><span data-stu-id="b345d-158">This event is raised by an executable when its validation starts.</span></span>|
|<span data-ttu-id="b345d-159">**OnProgress**</span><span class="sxs-lookup"><span data-stu-id="b345d-159">**OnProgress**</span></span>|<span data-ttu-id="b345d-160">Обработчик события **OnProgress** .</span><span class="sxs-lookup"><span data-stu-id="b345d-160">The event handler for the **OnProgress** event.</span></span> <span data-ttu-id="b345d-161">Событие вызывается исполняемым объектом в процессе выполнения.</span><span class="sxs-lookup"><span data-stu-id="b345d-161">This event is raised by an executable when measurable progress is made by the executable.</span></span>|
|<span data-ttu-id="b345d-162">**OnQueryCancel**</span><span class="sxs-lookup"><span data-stu-id="b345d-162">**OnQueryCancel**</span></span>|<span data-ttu-id="b345d-163">Обработчик события **OnQueryCancel** .</span><span class="sxs-lookup"><span data-stu-id="b345d-163">The event handler for the **OnQueryCancel** event.</span></span> <span data-ttu-id="b345d-164">Событие вызывается исполняемым объектом, чтобы установить, следует ли ему прекратить выполнение.</span><span class="sxs-lookup"><span data-stu-id="b345d-164">This event is raised by an executable to determine whether it should stop running.</span></span>|
|<span data-ttu-id="b345d-165">**OnTaskFailed**</span><span class="sxs-lookup"><span data-stu-id="b345d-165">**OnTaskFailed**</span></span>|<span data-ttu-id="b345d-166">Обработчик события **OnTaskFailed** .</span><span class="sxs-lookup"><span data-stu-id="b345d-166">The event handler for the **OnTaskFailed** event.</span></span> <span data-ttu-id="b345d-167">Событие вызывается неудачно завершившейся задачей.</span><span class="sxs-lookup"><span data-stu-id="b345d-167">This event is raised by a task when it fails.</span></span>|
|<span data-ttu-id="b345d-168">**OnVariableValueChanged**</span><span class="sxs-lookup"><span data-stu-id="b345d-168">**OnVariableValueChanged**</span></span>|<span data-ttu-id="b345d-169">Обработчик события **OnVariableValueChanged** .</span><span class="sxs-lookup"><span data-stu-id="b345d-169">The event handler for the **OnVariableValueChanged** event.</span></span> <span data-ttu-id="b345d-170">Событие вызывается исполняемым объектом при изменении значения переменной.</span><span class="sxs-lookup"><span data-stu-id="b345d-170">This event is raised by an executable when the value of a variable changes.</span></span> <span data-ttu-id="b345d-171">Событие вызывается исполняемым объектом, в котором определена переменная.</span><span class="sxs-lookup"><span data-stu-id="b345d-171">The event is raised by the executable on which the variable is defined.</span></span> <span data-ttu-id="b345d-172">Это событие не возникает, если свойству **RaiseChangeEvent** для переменной присвоено значение `False` .</span><span class="sxs-lookup"><span data-stu-id="b345d-172">This event is not raised if you set the **RaiseChangeEvent** property for the variable to `False`.</span></span> <span data-ttu-id="b345d-173">Дополнительные сведения см. в разделе [Переменные служб Integration Services (SSIS)](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="b345d-173">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>|
|<span data-ttu-id="b345d-174">**OnWarning**</span><span class="sxs-lookup"><span data-stu-id="b345d-174">**OnWarning**</span></span>|<span data-ttu-id="b345d-175">Обработчик события **OnWarning** .</span><span class="sxs-lookup"><span data-stu-id="b345d-175">The event handler for the **OnWarning** event.</span></span> <span data-ttu-id="b345d-176">Событие вызывается исполняемым объектом при возникновении предупреждения.</span><span class="sxs-lookup"><span data-stu-id="b345d-176">This event is raised by an executable when a warning occurs.</span></span>|

## <a name="configuration-of-an-event-handler"></a><span data-ttu-id="b345d-177">Настройка обработчика событий</span><span class="sxs-lookup"><span data-stu-id="b345d-177">Configuration of an Event Handler</span></span>
 <span data-ttu-id="b345d-178">Задать свойства можно в окне **Свойства** среды [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] или программными средствами.</span><span class="sxs-lookup"><span data-stu-id="b345d-178">You can set properties in the **Properties** window of [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] or programmatically.</span></span>

 <span data-ttu-id="b345d-179">Дополнительные сведения о настройке свойств этих свойств в [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)]см. в разделе [Задание свойств задач или контейнеров](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span><span class="sxs-lookup"><span data-stu-id="b345d-179">For information about how to set these properties in [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], see [Set the Properties of a Task or Container](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span></span>

 <span data-ttu-id="b345d-180">Дополнительные сведения о настройке этих свойств программными средствами см. в разделе <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="b345d-180">For information about programmatically setting these properties, see <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="b345d-181">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="b345d-181">Related Tasks</span></span>
 <span data-ttu-id="b345d-182">Сведения о том, как добавить обработчик событий в пакет, см. в разделе [Добавление к пакету обработчик событий](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span><span class="sxs-lookup"><span data-stu-id="b345d-182">For information about how to add an event handler to a package, see [Add an Event Handler to a Package](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span></span>


