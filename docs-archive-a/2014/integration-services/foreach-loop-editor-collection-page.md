---
title: Редактор циклов по каждому элементу (страница «Коллекция») | Документация Майкрософт
ms.custom: ''
ms.date: 08/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.foreachloopcontainer.collection.f1
ms.assetid: 95a19dde-61ca-4d9b-aa3d-131fa4264296
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a90ce0c8971c57ef90b502cfde298605a73c253d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87752271"
---
# <a name="foreach-loop-editor-collection-page"></a>Редактор циклов по каждому элементу (страница «Коллекция»)
  Страница **Коллекция** в диалоговом окне **Редактор циклов по каждому элементу** используется для указания типа перечислителя и его настройки.  
  
 Дополнительные сведения о контейнере "цикл по каждому элементу" и его настройке см. в разделах [Контейнер "цикл по каждому элементу"](control-flow/foreach-loop-container.md) и [Настройка контейнера "цикл по каждому элементу"](../../2014/integration-services/configure-a-foreach-loop-container.md).  
  
## <a name="static-options"></a>Статические параметры  
 **Перечислитель**  
 Выберите тип перечислителя из списка. Это свойство имеет параметры, указанные в следующей таблице.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Перечислитель с циклом по каждому файлу**|Перечисляет файлы. При выборе этого значения в разделе **Перечислитель с циклом по каждому файлу**отображаются динамические параметры.|  
|**Перечислитель элементов Foreach**|Перечисляет значения в элементе. При выборе этого значения в разделе **Перечислитель элементов Foreach**отображаются динамические параметры.|  
|**Перечислитель ADO Foreach**|Перечисляет таблицы или строки в таблицах. При выборе этого значения в разделе **Перечислитель ADO по каждой строке**отображаются динамические параметры.|  
|**Перечислитель Foreach ADO.NET набора строк схемы**|Перечисляет строки схемы. При выборе этого значения в разделе **Перечислитель ADO.NET по информации о схеме**отображаются динамические параметры.|  
|**Перечислитель Foreach из переменной**|Перечисляет значения в переменной. При выборе этого значения в разделе **Перечислитель Foreach из переменной**отображаются динамические параметры.|  
|**Перечислитель Foreach NodeList**|Перечисляет узлы в XML-документе. При выборе этого значения в разделе **Перечислитель Foreach Nodelist**отображаются динамические параметры.|  
|**Перечислитель по объектам SMO**|Перечисляет объекты SMO. При выборе этого значения в разделе **Перечислитель по объектам SMO**отображаются динамические параметры.|  
|**Перечислитель по большим двоичным объектам Azure**|Перечисляет файлы больших двоичных объектов в указанном расположении больших двоичных объектов. При выборе этого значения в разделе **Перечислитель по большим двоичным объектам Azure**отображаются динамические параметры.|  
|**Перечислитель с циклом по каждому файлу ADLS**|Перечислите файлы в ADLS с помощью фильтров. При выборе этого значения в разделе **Перечислитель с циклом по каждому файлу ADLS** отображаются динамические параметры.|
  
 **Выражения**  
 Щелкните или разверните узел **Выражения** , чтобы посмотреть список существующих выражений свойств. Нажмите кнопку с многоточием **(…)** , чтобы добавить выражение свойства для свойства перечислителя или изменить и оценить существующее выражение свойства.  
  
 **См. также:**  подробные сведения о [выражениях служб Integration Services &#40;SSIS&#41;](expressions/integration-services-ssis-expressions.md), о [редактор выражений свойств](expressions/property-expressions-editor.md) и о [построителе выражений](expressions/expression-builder.md).  
  
## <a name="enumerator-dynamic-options"></a>Динамические параметры перечислителя  
  
### <a name="enumerator--foreach-file-enumerator"></a>Перечислитель = перечислитель с циклом по каждому файлу  
 Используйте перечислитель с циклом по каждому файлу для перечисления файлов в папке. Например: если цикл по каждому элементу включает задачу «Выполнение SQL», то можно использовать перечислитель с циклом по каждому файлу для перечисления файлов, содержащих инструкции SQL, которые выполняются задачей «Выполнение SQL». Перечислитель может быть настроен для обработки вложенных папок.  
  
 Содержимое папок и подпапок, которые перечисляются перечислителем с циклом по каждому файлу, может изменяться во время цикла, потому что внешние процессы или задачи добавляют, переименовывают или удаляют файлы во время выполнения цикла. Это означает, что могут возникнуть некоторые непредвиденные ситуации.  
  
-   Если файлы удаляются, одна задача в цикле по каждому элементу может работать с набором файлов, отличным от файлов, используемых последующими задачами.  
  
-   Если файлы переименовываются и внешний процесс автоматически добавляет файлы для замены переименованных файлов, то цикл по каждому элементу может работать дважды над одним и тем же содержимым файла.  
  
-   Если файлы добавляются, то могут быть трудности с определением того, для каких файлов цикл по каждому элементу выполнил работу.  
  
 **Папка**  
 Укажите путь к корневой папке для перечисления.  
  
 **Обзор**  
 Используйте обзор, чтобы установить месторасположение корневой папки.  
  
 **Файлы**  
 Укажите файлы для перечисления.  
  
> [!NOTE]  
>  Используйте символы-шаблоны (*), чтобы указать файлы, которые необходимо включить в коллекцию. Например, чтобы включить файлы с именами, содержащими abc, используйте фильтр \*abc\*.  
>   
>  При указании расширения имени файла перечислитель возвращает также файлы, имеющие такое же расширение и добавленные в конец символы (Точно так же себя ведет команда **dir** операционной системы, которая также проверяет имена файлов в формате 8.3 на предмет обратной совместимости.) Это поведение перечислителя может привести к непредвиденным результатам. Например, при перечислении только файлов Excel 2003 указывается «*.xls». Однако перечислитель возвратит также файлы Excel 2007, поскольку они имеют расширение XLSX.  
>   
>  Можно указать файлы, включаемые в коллекцию, с помощью выражения. Для этого разверните узел **Выражения** на странице **Коллекция**, выберите свойство **FileSpec** и нажмите кнопку с многоточием (…), чтобы добавить выражение свойства. Дополнительные сведения о динамическом выборе указанных файлов см. в разделе [SSIS-динамическое задание файла mask: FileSpec](https://rajsudeep.blogspot.com/2010/09/ssisdynamically-set-file-mask-filespec.html)  
  
 **Полностью заданный**  
 Выберите этот параметр, чтобы получить путь с полной спецификацией к именам файлов. Если в параметрах файлов заданы символы-шаблоны, возвращаемый полный путь соответствует этому фильтру.  
  
 **Только имя**  
 Выберите, чтобы получить только имена файлов. Если в параметрах файлов заданы символы-шаблоны, возвращаемые имена файлов соответствуют этому фильтру.  
  
 **Имя и расширение**  
 Выберите, чтобы получить имена файлов и их расширения. Если в параметрах файлов заданы символы-шаблоны, возвращаемые имена и расширения файлов соответствуют этому фильтру.  
  
 **Просмотр вложенных папок**  
 Выберите, чтобы включить вложенные папки в перечисление.  
  
### <a name="enumerator--foreach-item-enumerator"></a>Перечислитель = перечислитель по каждому элементу  
 Используйте перечислитель по каждому элементу для перечисления элементов в коллекции. Элементы в коллекции определяются указанием столбцов и значений столбцов. Столбцы в строке определяют элемент. Например: элемент, определяющий исполняемые объекты для запуска задачей «Выполнение процесса» и рабочий каталог этой задачи, содержит два столбца; один предназначен для указания имен исполняемых объектов, другой — для указания рабочего каталога. Количество строк определяет число повторений цикла. Если таблица содержит 10 строк, значит, цикл повторяется 10 раз.  
  
 Чтобы обновить свойства задачи «Выполнение процесса», можно сопоставить переменные с элементами столбцов с помощью индекса столбца. Первый столбец, определенный в перечислителе элементов, имеет значение индекса 0, второй столбец — 1 и так далее. Значения переменных обновляются при каждом повторении цикла. Свойства `Executable` и `WorkingDirectory` задачи «Выполнение процесса» могут затем быть обновлены при помощи выражений свойств, использующих данные переменные.  
  
 **Задание элементов в коллекции "Цикл по каждому элементу"**  
 Задайте значение для каждого столбца в таблице.  
  
> [!NOTE]  
>  Новая строка автоматически добавляется к таблице после ввода значений в столбцы строки.  
  
> [!NOTE]  
>  Если предоставленные значения несовместимы с типом данных столбца, текст выделяется красным цветом.  
  
 **Тип данных столбца**  
 Перечисляет тип данных активного столбца.  
  
 **Удалить**  
 Выберите элемент и нажмите **Удалить** , чтобы удалить его из списка.  
  
 **Столбцы**  
 Нажмите, чтобы настроить тип данных столбца в элементе.  
  
 **См. также:** [Справочник по пользовательскому интерфейсу диалогового окна "Столбцы For Each Item"](../../2014/integration-services/for-each-item-columns-dialog-box-ui-reference.md)  
  
### <a name="enumerator--foreach-ado-enumerator"></a>Перечислитель = перечислитель ADO по каждой строке  
 Перечислитель ADO по каждой строке можно использовать для перечисления строк или таблиц в объекте ADO или ADO.NET, который хранится в переменной. Например: если цикл по каждому элементу включает задачу «Скрипт», которая записывает набор данных в переменную, можно использовать перечислитель ADO по каждой строке для перечисления строк в наборе данных. Если переменная содержит набор данных ADO.NET, то перечислитель может быть настроен на перечисление строк в нескольких таблицах или на перечисление самих таблиц.  
  
 **Переменная источника объекта ADO**  
 Выберите пользовательскую переменную из списка или щелкните \<**New variable...**> для создания переменной.  
  
> [!NOTE]  
>  Переменная должна иметь тип данных Object; в противном случае возникнет ошибка.  
  
 **См. также:** подробные сведения о [переменных в службах Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) и о [добавлении переменной](../../2014/integration-services/add-variable.md).  
  
 **Строки в первой таблице**  
 Выберите для перечисления только строк в первой таблице.  
  
 **Строки во всех таблицах (только набор данных ADO.NET)**  
 Выберите для перечисления строк во всех таблицах. Данный параметр доступен, только если все объекты для перечисления являются элементами одного набора данных ADO.NET.  
  
 **Все таблицы (только для наборов данных ADO.NET)**  
 Выберите для перечисления только таблиц.  
  
### <a name="enumerator--foreach-adonet-schema-rowset-enumerator"></a>Перечислитель = перечислитель по набору строк схемы ADO.NET  
 Перечислитель по набору строк схемы ADO.NET можно использовать для перечисления схем для указанного источника данных. Например: если цикл по каждому элементу включает задачу «Выполнение SQL», то можно использовать перечислитель по каждому набору строк схемы ADO.NET для перечисления схем, таких как столбцы базы данных **AdventureWorks** , а задачу «Выполнение SQL» — для извлечения разрешений схемы.  
  
 **Соединение**  
 Выберите в списке диспетчер подключений ADO.NET или щелкните \<**New connection...**>, чтобы создать его.  
  
> [!IMPORTANT]  
>  Диспетчер соединений ADO.NET должен использовать поставщика данных .NET для OLE DB. При соединении с SQL Server рекомендуемым поставщиком данных является собственный клиент [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , находящийся в области **Поставщики .NET для OleDb** диалогового окна **Диспетчер соединений** .  
  
 **См. также:** подробные сведения о [диспетчере подключений ADO](connection-manager/ado-connection-manager.md) и о [настройке диспетчера подключений ADO.NET](configure-ado-net-connection-manager.md).  
  
 **Схема**  
 Выберите схему для перечисления.  
  
 **Задать ограничения**  
 Задайте ограничения, которые необходимо применить к указанной схеме.  
  
 **См. также:** [Диалоговое окно "Ограничения схемы"](../../2014/integration-services/schema-restrictions-dialog-box.md)  
  
### <a name="enumerator--foreach-from-variable-enumerator"></a>Перечислитель = перечислитель по объекту из переменной  
 Перечислитель по объекту из переменной можно использовать для перечисления перечисляемых объектов в указанной переменной. Например: если цикл по каждому элементу включает задачу «Выполнение SQL», которая запускает запрос и сохраняет результаты в переменной, то можно использовать перечислитель по объекту из переменной для перечисления результатов запросов.  
  
 **Переменная**  
 Выберите переменную в списке или щелкните \<**New variable...**> для создания переменной.  
  
 **См. также:** подробные сведения о [переменных в службах Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) и о [добавлении переменной](../../2014/integration-services/add-variable.md).  
  
### <a name="enumerator--foreach-nodelist-enumerator"></a>Перечислитель = перечислитель по набору узлов  
 Перечислитель по набору узлов можно использовать для перечисления набора XML-узлов, которые являются результатом применения выражения XPath к XML-файлу. Например: если цикл по каждому элементу включает задачу «Скрипт», то перечислитель по набору узлов можно использовать для передачи от XML-файла к задаче «Скрипт» значения, которое удовлетворяет критерию выражения XPath.  
  
 Выражение XPath, применяемое к XML-файлу, является внешней операцией XPath, сохраненной в свойстве OuterXPathString. Если тип перечисления XPath имеет значение `ElementCollection` , перечислитель Foreach nodeList может применить внутреннее выражение XPath, хранящееся в свойстве InnerXPathString, к коллекции элементов.  
  
 Дополнительные сведения по работе с XML-документами и данными см. в разделе «[Employing XML in the .NET Framework](https://go.microsoft.com/fwlink/?LinkId=56214)» в библиотеке MSDN.  
  
 **DocumentSourceType**  
 Выберите тип источника XML-документа. Это свойство имеет параметры, указанные в следующей таблице.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Прямой ввод**|Задайте источник для XML-документа.|  
|**Соединение с файлом**|Выберите файл, содержащий XML-документ.|  
|**Переменная**|В качестве источника задайте переменную, содержащую XML-документ.|  
  
 **DocumentSource**  
 Если параметр **DocumentSourceType** имеет значение **Прямой ввод**, укажите код XML или нажмите кнопку с многоточием (…), чтобы указать XML с помощью диалогового окна **Редактор исходного текста документа**.  
  
 Если **DocumentSourceType** имеет значение **Соединение с файлом**, выберите диспетчер подключения файлов или щелкните \<**New connection...**>, чтобы создать его.  
  
 **См. также:** подробные сведения о [диспетчере файловых подключений](connection-manager/file-connection-manager.md) и о [редакторе диспетчера файловых подключений](../../2014/integration-services/file-connection-manager-editor.md).  
  
 Если **DocumentSourceType** имеет значение **Переменная**, выберите существующую переменную или щелкните \<**New variable...**>, чтобы создать ее.  
  
 **См. также:** подробные сведения о [переменных служб Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) и о [добавлении переменной](../../2014/integration-services/add-variable.md).  
  
 **EnumerationType**  
 Выберите тип перечисления из списка. Это свойство имеет параметры, указанные в следующей таблице.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Navigator**|Перечисление с помощью компонента XPathNavigator.|  
|**Node**|Перечисление узлов, возвращенных операцией XPath.|  
|**NodeText**|Перечисление текстовых узлов, возвращенных операцией XPath.|  
|`ElementCollection`|Перечисление узлов элементов, возвращенных операцией XPath.|  
  
 **OuterXPathStringSourceType**  
 Выберите тип источника строки XPath. Это свойство имеет параметры, указанные в следующей таблице.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Прямой ввод**|Задайте источник для XML-документа.|  
|**Соединение с файлом**|Выберите файл, содержащий XML-документ.|  
|**Переменная**|В качестве источника задайте переменную, содержащую XML-документ.|  
  
 `OuterXPathString`  
 Если **OuterXPathStringSourceType** имеет значение **Прямой ввод**, укажите строку XPath.  
  
 Если **OuterXPathStringSourceType** имеет значение **Соединение с файлом**, выберите диспетчер подключения файлов или щелкните \<**New connection...**>, чтобы создать его.  
  
 **См. также:** подробные сведения о [диспетчере файловых подключений](connection-manager/file-connection-manager.md) и о [редакторе диспетчера файловых подключений](../../2014/integration-services/file-connection-manager-editor.md).  
  
 Если **OuterXPathStringSourceType** имеет значение **Переменная**, выберите существующую переменную или щелкните \<**New variable...**>, чтобы создать ее.  
  
 **См. также:** подробные сведения о [переменных служб Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) и о [добавлении переменной](../../2014/integration-services/add-variable.md).  
  
 **InnerElementType**  
 Если **EnumerationType** имеет значение `ElementCollection` , выберите тип внутреннего элемента в списке.  
  
 **InnerXPathStringSourceType**  
 Выбрать тип источника внутренней строки XPath. Это свойство имеет параметры, указанные в следующей таблице.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Прямой ввод**|Задайте источник для XML-документа.|  
|**Соединение с файлом**|Выберите файл, содержащий XML-документ.|  
|**Переменная**|В качестве источника задайте переменную, содержащую XML-документ.|  
  
 `InnerXPathString`  
 Если **InnerXPathStringSourceType** имеет значение **Прямой ввод**, укажите строку XPath.  
  
 Если **InnerXPathStringSourceType** имеет значение **Соединение с файлом**, выберите диспетчер подключения файлов или щелкните \<**New connection...**>, чтобы создать его.  
  
 **См. также:** подробные сведения о [диспетчере файловых подключений](connection-manager/file-connection-manager.md) и о [редакторе диспетчера файловых подключений](../../2014/integration-services/file-connection-manager-editor.md).  
  
 Если **InnerXPathStringSourceType** имеет значение **Переменная**, выберите существующую переменную или щелкните \<**New variable...**>, чтобы создать ее.  
  
 **См. также:** подробные сведения о [переменных служб Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) и о [добавлении переменной](../../2014/integration-services/add-variable.md).  
  
### <a name="enumerator--foreach-smo-enumerator"></a>Перечислитель = перечислитель по объектам SMO  
 Перечислитель по объектам SMO используется для перечисления объектов SMO. Например: если цикл по каждому элементу включает задачу «Выполнение SQL», то перечислитель по объектам SMO можно использовать для перечисления таблиц в базе данных **AdventureWorks** и выполнения запросов, которые подсчитывают количество строк в каждой таблице.  
  
 **Соединение**  
 Выберите существующий диспетчер подключений ADO.NET или создайте его, щелкнув пункт \<**New connection...**>.  
  
 См. также подробные сведения о [диспетчере подключений ADO.NET](connection-manager/ado-net-connection-manager.md) и о [настройке диспетчера подключений ADO.NET](configure-ado-net-connection-manager.md).  
  
 **Перечислить**  
 Укажите объект SMO для перечисления.  
  
 **Обзор**  
 Выберите перечисление SMO.  
  
 **См. также:** [Диалоговое окно "Выбор перечисления SMO"](../../2014/integration-services/select-smo-enumeration-dialog-box.md)  
  
### <a name="enumerator--foreach-azure-blob-enumerator"></a>Перечислитель = перечислитель по большим двоичным объектам Azure  
 **Перечислитель больших двоичных объектов Azure**позволяет пакету SSIS перечислять файлы больших двоичных объектов в указанном расположении больших двоичных объектов. Имя перечисленного файла большого двоичного объекта может храниться в переменной и использоваться в задачах в контейнере цикла Foreach.  
  
 **Диспетчер подключений службы хранилища Azure**  
 Выберите существующий диспетчер подключений службы хранилища Azure или создайте новый, который ссылается на учетную запись хранения Azure.  
  
 См. также подробные сведения о [диспетчере подключений службы хранилища Azure](connection-manager/azure-storage-connection-manager.md).  
  
 **Имя контейнера больших двоичных объектов**  
 Укажите имя контейнера больших двоичных объектов, который содержит перечисляемые файлы больших двоичных объектов.  
  
 **Каталог больших двоичных объектов**  
 Укажите каталог больших двоичных объектов, который содержит перечисляемые файлы больших двоичных объектов. Каталог больших двоичных объектов — это виртуальная иерархическая структура.  
  
 **Фильтр по именам для больших двоичных объектов**  
 Укажите фильтр по именам для перечисления файлов по определенному шаблону имен. Пример: MySheet*.xls\* будет включать такие файлы, как MySheet001.xls и MySheetABC.xlsx.  
  
 **Фильтр по диапазону времени для больших двоичных объектов "от-до"**  
 Укажите фильтр по диапазону времени. Файлы, измененные после **TimeRangeFrom** и до **TimeRangeTo** , будут перечислены.  
### <a name="enumerator--foreach-adls-file-enumerator"></a> Перечислитель — перечислитель с циклом по каждому файлу ADLS  
**Перечислитель файлов ADLS** позволяет ПАКЕТУ служб SSIS перечислять файлы в ADLS с фильтрами. Косая черта ( `/` ) — полный путь к перечисленным файлам может храниться в переменной и использоваться в задачах внутри контейнера «цикл по каждому элементу».
  
**AzureDataLakeConnection**  
Задает диспетчер подключений Azure Data Lake или создает новый, который ссылается на учетную запись ADLS.   
  
**AzureDataLakeDirectory**  
Указывает каталог ADLS для поиска.
  
**FileNamePattern**  
Задает фильтр имен файлов. Будут перечислены только те файлы, имя которых совпадает с указанным шаблоном. Поддерживаются подстановочные знаки `*` и `?`. 
  
**SearchRecursively**  
Указывает, следует ли выполнять рекурсивный поиск в указанном каталоге.  
  
## <a name="external-resources"></a>Внешние ресурсы  
  
-   Запись в блоге [Службы SSIS для перечислителя по набору узлов](https://go.microsoft.com/fwlink/?LinkId=220671)на сайте bidn.com.  
  
-   Запись блога, [службы SSIS — динамически задаются файловая маска: FileSpec](https://rajsudeep.blogspot.com/2010/09/ssisdynamically-set-file-mask-filespec.html).  
  
## <a name="see-also"></a>См. также:  
 [Справочник по сообщениям об ошибках служб Integration Services](../../2014/integration-services/integration-services-error-and-message-reference.md)   
 [Редактор циклов по каждому элементу &#40;страница "Общие"&#41;](general-page-of-integration-services-designers-options.md)   
 [Редактор циклов по каждому элементу &#40;страница сопоставления переменных&#41;](../../2014/integration-services/foreach-loop-editor-variable-mappings-page.md)   
 [Страница «Выражения»](expressions/expressions-page.md)   
 [Контейнер «цикл по элементам»](control-flow/for-loop-container.md)  
  
  
