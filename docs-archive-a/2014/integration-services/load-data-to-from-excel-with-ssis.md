---
title: Импорт из Excel или экспорт в Excel с помощью SSIS | Документы Майкрософт
description: Сведения о том, как импортировать или экспортировать данные Excel с помощью служб SQL Server Integration Services (SSIS), а также о необходимых компонентах, известных проблемах и ограничениях.
ms.date: 04/10/2018
ms.prod: sql-server-2014
ms.prod_service: integration-services
ms.reviewer: ''
ms.custom: ''
ms.technology: integration-services
ms.topic: conceptual
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 58b0165925e73d0eb72b118113bc354338741a0e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664326"
---
# <a name="import-data-from-excel-or-export-data-to-excel-with-sql-server-integration-services-ssis"></a><span data-ttu-id="d9905-103">Импорт данных из Excel или экспорт данных в Excel с помощью служб SQL Server Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="d9905-103">Import data from Excel or export data to Excel with SQL Server Integration Services (SSIS)</span></span>

<span data-ttu-id="d9905-104">В этой статье описывается порядок импорта данных из приложения Excel или экспорта данных в него с помощью служб SQL Server Integration Services (SSIS).</span><span class="sxs-lookup"><span data-stu-id="d9905-104">This article describes how to import data from Excel or export data to Excel with SQL Server Integration Services (SSIS).</span></span> <span data-ttu-id="d9905-105">Кроме того, здесь описываются необходимые условия, ограничения и известные проблемы.</span><span class="sxs-lookup"><span data-stu-id="d9905-105">The article also describes prerequisites, limitations, and known issues.</span></span>

<span data-ttu-id="d9905-106">Чтобы импортировать данные из приложения Excel или экспортировать данные в него, можно создать пакет SSIS и использовать диспетчер соединений Excel, а также источник или назначение Excel.</span><span class="sxs-lookup"><span data-stu-id="d9905-106">You can import data from Excel or export data to Excel by creating an SSIS package and using the Excel Connection Manager and the Excel Source or the Excel Destination.</span></span> <span data-ttu-id="d9905-107">Кроме того, вы можете использовать для этих целей мастер импорта и экспорта SQL Server, который построен на основе служб SSIS.</span><span class="sxs-lookup"><span data-stu-id="d9905-107">You can also use the SQL Server Import and Export Wizard, which is built on SSIS.</span></span>

<span data-ttu-id="d9905-108">В этой статье содержатся три набора информации, которые необходимы для успешной работы с приложением Excel из служб SSIS, а также для понимания и устранения распространенных проблем:</span><span class="sxs-lookup"><span data-stu-id="d9905-108">This article contains the three sets of information you need to use Excel successfully from SSIS or to understand and troubleshoot common problems:</span></span>
1.  <span data-ttu-id="d9905-109">Необходимые [файлы](#files-you-need).</span><span class="sxs-lookup"><span data-stu-id="d9905-109">[The files you need](#files-you-need).</span></span>
2.  <span data-ttu-id="d9905-110">Сведения, которые необходимо предоставить при загрузке данных в приложение Excel или из него.</span><span class="sxs-lookup"><span data-stu-id="d9905-110">The information you have to provide when you load data from or to Excel.</span></span>
    -   <span data-ttu-id="d9905-111">[Укажите Excel](#specify-excel) в качестве источника данных.</span><span class="sxs-lookup"><span data-stu-id="d9905-111">[Specify Excel](#specify-excel) as your data source.</span></span>
    -   <span data-ttu-id="d9905-112">Укажите [имя файла Excel и путь к нему](#excel-file).</span><span class="sxs-lookup"><span data-stu-id="d9905-112">Provide the [Excel file name and path](#excel-file).</span></span>
    -   <span data-ttu-id="d9905-113">Выберите [версию Excel](#excel-version).</span><span class="sxs-lookup"><span data-stu-id="d9905-113">Select the [Excel version](#excel-version).</span></span>
    -   <span data-ttu-id="d9905-114">Укажите, содержит ли [первая строка имена столбцов](#first-row).</span><span class="sxs-lookup"><span data-stu-id="d9905-114">Specify whether the [first row contains column names](#first-row).</span></span>
    -   <span data-ttu-id="d9905-115">Укажите [лист или диапазон, который содержит данные](#sheets-ranges).</span><span class="sxs-lookup"><span data-stu-id="d9905-115">Provide the [worksheet or range that contains the data](#sheets-ranges).</span></span>
3.  <span data-ttu-id="d9905-116">Известные проблемы и ограничения.</span><span class="sxs-lookup"><span data-stu-id="d9905-116">Known issues and limitations.</span></span>
    -   <span data-ttu-id="d9905-117">Проблемы с [типами данных](#issues-types).</span><span class="sxs-lookup"><span data-stu-id="d9905-117">Issues with [data types](#issues-types).</span></span>
    -   <span data-ttu-id="d9905-118">Проблемы с [импортом](#issues-importing).</span><span class="sxs-lookup"><span data-stu-id="d9905-118">Issues with [importing](#issues-importing).</span></span>
    -   <span data-ttu-id="d9905-119">Проблемы с [экспортом](#issues-exporting).</span><span class="sxs-lookup"><span data-stu-id="d9905-119">Issues with [exporting](#issues-exporting).</span></span>

## <a name="get-the-files-you-need-to-connect-to-excel"></a><a name="files-you-need"></a> <span data-ttu-id="d9905-120">Получение файлов, необходимых для подключения к Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-120">Get the files you need to connect to Excel</span></span>

<span data-ttu-id="d9905-121">Прежде чем импортировать данные из приложения Excel или экспортировать данные в него, вам может потребоваться скачать компоненты подключений для Excel, если они еще не установлены.</span><span class="sxs-lookup"><span data-stu-id="d9905-121">Before you can import data from Excel or export data to Excel, you may have to download the connectivity components for Excel if they're not already installed.</span></span> <span data-ttu-id="d9905-122">По умолчанию компоненты подключений для Excel не устанавливаются.</span><span class="sxs-lookup"><span data-stu-id="d9905-122">The connectivity components for Excel are not installed by default.</span></span>

<span data-ttu-id="d9905-123">Скачать последнюю версию компонентов подключения для Excel можно на следующей странице: [Распространяемый пакет ядра СУБД Microsoft Access 2016](https://www.microsoft.com/download/details.aspx?id=54920).</span><span class="sxs-lookup"><span data-stu-id="d9905-123">Download the latest version of the connectivity components for Excel here: [Microsoft Access Database Engine 2016 Redistributable](https://www.microsoft.com/download/details.aspx?id=54920).</span></span>
  
<span data-ttu-id="d9905-124">Последняя версия компонентов позволяет открывать файлы, созданные в более ранних версиях Excel.</span><span class="sxs-lookup"><span data-stu-id="d9905-124">The latest version of the components can open files created by earlier versions of Excel.</span></span>

<span data-ttu-id="d9905-125">Обратите внимание, что необходимо скачать *распространяемый пакет* ядра СУБД Access 2016, а не *среду выполнения* Microsoft Access 2016.</span><span class="sxs-lookup"><span data-stu-id="d9905-125">Make sure that you download the Access Database Engine 2016 *Redistributable* and not the Microsoft Access 2016 *Runtime*.</span></span>

<span data-ttu-id="d9905-126">Если на компьютере уже установлена 32-разрядная версия Office, необходимо установить 32-разрядную версию компонентов.</span><span class="sxs-lookup"><span data-stu-id="d9905-126">If the computer already has a 32-bit version of Office, then you have to install the 32-bit version of the components.</span></span> <span data-ttu-id="d9905-127">Кроме того, следует выполнять пакет служб SSIS в 32-разрядном режиме или 32-разрядную версию мастера импорта и экспорта.</span><span class="sxs-lookup"><span data-stu-id="d9905-127">You also have to ensure that you run the SSIS package in 32-bit mode, or run the 32-bit version of the Import and Export Wizard.</span></span>

<span data-ttu-id="d9905-128">Если у вас есть подписка на Office 365, при запуске программы установки может появиться сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="d9905-128">If you have an Office 365 subscription, you may see an error message when you run the installer.</span></span> <span data-ttu-id="d9905-129">Это сообщение свидетельствует о том, что невозможно установить скачанные компоненты вместе с компонентами Office, полученными с помощью технологии "нажми и работай".</span><span class="sxs-lookup"><span data-stu-id="d9905-129">The error indicates that you can't install the download side by side with Office click-to-run components.</span></span> <span data-ttu-id="d9905-130">Чтобы обойти это сообщение, запустите установку в тихом режиме. Для этого откройте окно командной строки и запустите скачанный EXE-файл с параметром `/quiet`.</span><span class="sxs-lookup"><span data-stu-id="d9905-130">To bypass this error message, run the installation in quiet mode by opening a Command Prompt window and running the .EXE file that you downloaded with the `/quiet` switch.</span></span> <span data-ttu-id="d9905-131">Пример:</span><span class="sxs-lookup"><span data-stu-id="d9905-131">For example:</span></span>

`C:\Users\<user name>\Downloads\AccessDatabaseEngine.exe /quiet`

<span data-ttu-id="d9905-132">При возникновении проблем с установкой распространяемого пакета версии 2016 установите вместо него распространяемый пакет версии 2010 со следующей страницы: [Распространяемый пакет ядра СУБД Microsoft Access 2010](https://www.microsoft.com/download/details.aspx?id=13255).</span><span class="sxs-lookup"><span data-stu-id="d9905-132">If you have trouble installing the 2016 redistributable, install the 2010 redistributable instead from here: [Microsoft Access Database Engine 2010 Redistributable](https://www.microsoft.com/download/details.aspx?id=13255).</span></span> <span data-ttu-id="d9905-133">(Для Excel 2013 распространяемый пакет не предусмотрен.)</span><span class="sxs-lookup"><span data-stu-id="d9905-133">(There is no redistributable for Excel 2013.)</span></span>

## <a name="specify-excel"></a><a name="specify-excel"></a> <span data-ttu-id="d9905-134">Указание Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-134">Specify Excel</span></span>

<span data-ttu-id="d9905-135">Сначала необходимо указать, что вам требуется установить подключение к Excel.</span><span class="sxs-lookup"><span data-stu-id="d9905-135">The first step is to indicate that you want to connect to Excel.</span></span>

### <a name="in-ssis"></a><span data-ttu-id="d9905-136">В службах SSIS</span><span class="sxs-lookup"><span data-stu-id="d9905-136">In SSIS</span></span>
<span data-ttu-id="d9905-137">В службах SSIS создайте диспетчер соединений Excel для подключения к файлу источника или назначения Excel.</span><span class="sxs-lookup"><span data-stu-id="d9905-137">In SSIS, create an Excel Connection Manager to connect to the Excel source or destination file.</span></span> <span data-ttu-id="d9905-138">Создать диспетчер соединений можно несколькими способами:</span><span class="sxs-lookup"><span data-stu-id="d9905-138">There are several ways to create the connection manager:</span></span>

-   <span data-ttu-id="d9905-139">Щелкните правой кнопкой в области **Диспетчеры соединений** и выберите команду **Создать соединение**.</span><span class="sxs-lookup"><span data-stu-id="d9905-139">In the **Connection Managers** area, right-click and select **New connection**.</span></span> <span data-ttu-id="d9905-140">В диалоговом окне **Добавление диспетчера соединений со службами SSIS** выберите **EXCEL** и затем **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="d9905-140">In the **Add SSIS Connection Manager** dialog box, select **EXCEL** and then **Add**.</span></span>
 
-   <span data-ttu-id="d9905-141">В меню **Службы SSIS** выберите **Создать соединение**.</span><span class="sxs-lookup"><span data-stu-id="d9905-141">On the **SSIS** menu, select **New connection**.</span></span> <span data-ttu-id="d9905-142">В диалоговом окне **Добавление диспетчера соединений со службами SSIS** выберите **EXCEL** и затем **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="d9905-142">In the **Add SSIS Connection Manager** dialog box, select **EXCEL** and then **Add**.</span></span>

-   <span data-ttu-id="d9905-143">Диспетчер соединений необходимо создавать в то время, как вы настраиваете **источник Excel** или **назначение Excel** на странице **Диспетчер соединений** в **редакторе источника Excel** или в **редакторе назначения Excel**.</span><span class="sxs-lookup"><span data-stu-id="d9905-143">Create the connection manager at the same time that you configure the **Excel Source** or the **Excel Destination** on the **Connection manager** page of the **Excel Source Editor** or of the **Excel Destination Editor**.</span></span>

### <a name="in-the-sql-server-import-and-export-wizard"></a><span data-ttu-id="d9905-144">В мастере импорта и экспорта SQL Server</span><span class="sxs-lookup"><span data-stu-id="d9905-144">In the SQL Server Import and Export Wizard</span></span>
<span data-ttu-id="d9905-145">В мастере импорта и экспорта на странице **Выбор источника данных** или **Выбор назначения** выберите **Microsoft Excel** в списке **Источник данных**.</span><span class="sxs-lookup"><span data-stu-id="d9905-145">In the Import and Export Wizard, on the **Choose a Data Source** or **Choose a Destination** page, select **Microsoft Excel** in the **Data source** list.</span></span>

<span data-ttu-id="d9905-146">Если вы не видите Excel в списке источников данных, убедитесь, что используется 32-разрядная версия мастера.</span><span class="sxs-lookup"><span data-stu-id="d9905-146">If you don't see Excel in the list of data sources, make sure you're running the 32-bit wizard.</span></span> <span data-ttu-id="d9905-147">Компоненты подключений для Excel обычно представляют собой 32-разрядные файлы и не отображаются в 64-разрядной версии мастера.</span><span class="sxs-lookup"><span data-stu-id="d9905-147">The Excel connectivity components are typically 32-bit files and aren't visible in the 64-bit wizard.</span></span>

## <a name="excel-file-and-file-path"></a><a name="excel-file"></a> <span data-ttu-id="d9905-148">Файл Excel и путь к нему</span><span class="sxs-lookup"><span data-stu-id="d9905-148">Excel file and file path</span></span>

<span data-ttu-id="d9905-149">В первую очередь необходимо предоставить имя файла Excel и путь к нему.</span><span class="sxs-lookup"><span data-stu-id="d9905-149">The first piece of info to provide is the path and file name for the Excel file.</span></span> <span data-ttu-id="d9905-150">Это можно сделать в **редакторе диспетчера соединений Excel** в пакете служб SSIS либо на странице **Выбор источника данных** или **Выбор назначения** в мастере импорта и экспорта.</span><span class="sxs-lookup"><span data-stu-id="d9905-150">You provide this info in the **Excel Connection Manager Editor** in an SSIS package, or on the **Choose a Data Source** or **Choose a Destination** page of the Import and Export Wizard.</span></span>

<span data-ttu-id="d9905-151">Введите имя файла и путь к нему в следующем формате:</span><span class="sxs-lookup"><span data-stu-id="d9905-151">Enter the path and file name in the following format:</span></span>

-   <span data-ttu-id="d9905-152">Для файла на локальном компьютере: **C:\\TestData.xlsx**.</span><span class="sxs-lookup"><span data-stu-id="d9905-152">For a file on the local computer, **C:\\TestData.xlsx**.</span></span>

-   <span data-ttu-id="d9905-153">Для файла в общей сетевой папке: **\\\\Sales\\Data\\TestData.xlsx**.</span><span class="sxs-lookup"><span data-stu-id="d9905-153">For a file on a network share, **\\\\Sales\\Data\\TestData.xlsx**.</span></span>

<span data-ttu-id="d9905-154">Также можно нажать кнопку **Обзор** и выбрать электронную таблицу в диалоговом окне **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="d9905-154">Or, click **Browse** to locate the spreadsheet by using the **Open** dialog box.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="d9905-155">Подключить защищенный паролем файл Excel нельзя.</span><span class="sxs-lookup"><span data-stu-id="d9905-155">You can't connect to a password-protected Excel file.</span></span>

## <a name="excel-version"></a><a name="excel-version"></a> <span data-ttu-id="d9905-156">Версия Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-156">Excel version</span></span>

<span data-ttu-id="d9905-157">Далее следует предоставить сведения о версии файла Excel.</span><span class="sxs-lookup"><span data-stu-id="d9905-157">The second piece of info to provide is the version of the Excel file.</span></span> <span data-ttu-id="d9905-158">Это можно сделать в **редакторе диспетчера соединений Excel** в пакете служб SSIS либо на странице **Выбор источника данных** или **Выбор назначения** в мастере импорта и экспорта.</span><span class="sxs-lookup"><span data-stu-id="d9905-158">You provide this info in the **Excel Connection Manager Editor** in an SSIS package, or on the **Choose a Data Source** or **Choose a Destination** page of the Import and Export Wizard.</span></span>

<span data-ttu-id="d9905-159">Выберите версию Microsoft Excel, в которой был создан файл, или другую совместимую версию.</span><span class="sxs-lookup"><span data-stu-id="d9905-159">Select the version of Microsoft Excel that was used to create the file, or another compatible version.</span></span> <span data-ttu-id="d9905-160">Например, если вам не удалось установить компоненты подключений для версии 2016, вы можете установить компоненты для версии 2010 и выбрать в этом списке вариант **Microsoft Excel 2007-2010**.</span><span class="sxs-lookup"><span data-stu-id="d9905-160">For example, if you had trouble installing the 2016 connectivity components, you can install the 2010 components and select **Microsoft Excel 2007-2010** in this list.</span></span>

<span data-ttu-id="d9905-161">Если у вас установлены старые версии компонентов подключений, вы не сможете выбрать более новые версии Excel в этом списке.</span><span class="sxs-lookup"><span data-stu-id="d9905-161">You may not be able to select newer Excel versions in the list if you only have older versions of the connectivity components installed.</span></span> <span data-ttu-id="d9905-162">Список **Версия Excel** содержит все версии Excel, поддерживаемые службами SSIS.</span><span class="sxs-lookup"><span data-stu-id="d9905-162">The **Excel version** list includes all the versions of Excel supported by SSIS.</span></span> <span data-ttu-id="d9905-163">Наличие элементов в этом списке не означает, что необходимые компоненты подключений были установлены.</span><span class="sxs-lookup"><span data-stu-id="d9905-163">The presence of items in this list does not indicate that the required connectivity components are installed.</span></span> <span data-ttu-id="d9905-164">Например, вариант **Microsoft Excel 2016** будет присутствовать в этом списке даже в том случае, если у вас не установлены компоненты подключений для версии 2016.</span><span class="sxs-lookup"><span data-stu-id="d9905-164">For example, **Microsoft Excel 2016** appears in the list even if you have not installed the 2016 connectivity components.</span></span>

## <a name="first-row-has-column-names"></a><a name="first-row"></a> <span data-ttu-id="d9905-165">Первая строка содержит имена столбцов</span><span class="sxs-lookup"><span data-stu-id="d9905-165">First row has column names</span></span>

<span data-ttu-id="d9905-166">Если вы импортируете данные из Excel, далее необходимо указать, содержит ли первая строка данных имена столбцов.</span><span class="sxs-lookup"><span data-stu-id="d9905-166">If you're importing data from Excel, the next step is to indicate whether the first row of the data contains column names.</span></span> <span data-ttu-id="d9905-167">Это можно сделать в **редакторе диспетчера соединений Excel** в пакете служб SSIS или на странице **Выбор источника данных** в мастере импорта и экспорта.</span><span class="sxs-lookup"><span data-stu-id="d9905-167">You provide this info in the **Excel Connection Manager Editor** in an SSIS package, or on the **Choose a Data Source** page of the Import and Export Wizard.</span></span>

-   <span data-ttu-id="d9905-168">Если этот параметр отключен, поскольку в данных источника отсутствуют имена столбцов, мастер будет использовать в качестве заголовков столбцов значения F1, F2 и т. д.</span><span class="sxs-lookup"><span data-stu-id="d9905-168">If you disable this option because the source data doesn't contain column names, the wizard uses F1, F2, and so forth, as column headings.</span></span>
-   <span data-ttu-id="d9905-169">Если данные содержат имена столбцов, но этот параметр отключен, мастер импортирует строку имен столбцов как первую строку данных.</span><span class="sxs-lookup"><span data-stu-id="d9905-169">If the data contains column names, but you disable this option, the wizard imports the column names as the first row of data.</span></span>
-   <span data-ttu-id="d9905-170">Если данные не содержат имена столбцов, но этот параметр включен, мастер использует первую строку данных источника как имена столбцов.</span><span class="sxs-lookup"><span data-stu-id="d9905-170">If the data does not contain column names, but you enable this option, the wizard uses the first row of source data as the column names.</span></span> <span data-ttu-id="d9905-171">В этом случае первая строка в данных источника не включается в сами данные.</span><span class="sxs-lookup"><span data-stu-id="d9905-171">In this case, the first row of source data is no longer included in the data itself.</span></span>

<span data-ttu-id="d9905-172">Если вы экспортируете данные из Excel и включили этот параметр, первая строка экспортированных данных будет включать имена столбцов.</span><span class="sxs-lookup"><span data-stu-id="d9905-172">If you're exporting data from Excel, and you enable this option, the first row of exported data includes the column names.</span></span>

## <a name="worksheets-and-ranges"></a><a name="sheets-ranges"></a> <span data-ttu-id="d9905-173">Листы и диапазоны</span><span class="sxs-lookup"><span data-stu-id="d9905-173">Worksheets and ranges</span></span>

<span data-ttu-id="d9905-174">В качестве источника или назначения для данных можно использовать три типа объектов Excel: лист, именованный диапазон или неименованный диапазон ячеек, который задается с помощью адреса.</span><span class="sxs-lookup"><span data-stu-id="d9905-174">There are three types of Excel objects that you can use as the source or destination for your data: a worksheet, a named range, or an unnamed range of cells that you specify with its address.</span></span>

-   <span data-ttu-id="d9905-175">**Лист**</span><span class="sxs-lookup"><span data-stu-id="d9905-175">**Worksheet.**</span></span> <span data-ttu-id="d9905-176">Чтобы указать лист, добавьте в конец имени листа символ `$` и окружите строку разделителями, например **[Листt1$]** .</span><span class="sxs-lookup"><span data-stu-id="d9905-176">To specify a worksheet, append the `$` character to the end of the sheet name and add delimiters around the string - for example, **[Sheet1$]**.</span></span> <span data-ttu-id="d9905-177">Также можно выполнить поиск имени, заканчивающегося символом `$`, в списке существующих таблиц и представлений.</span><span class="sxs-lookup"><span data-stu-id="d9905-177">Or, look for a name that ends with the `$` character in the list of existing tables and views.</span></span>

-   <span data-ttu-id="d9905-178">**Именованный диапазон**</span><span class="sxs-lookup"><span data-stu-id="d9905-178">**Named range.**</span></span> <span data-ttu-id="d9905-179">Чтобы указать именованный диапазон, используйте имя диапазона, например **Мой_диапазон**.</span><span class="sxs-lookup"><span data-stu-id="d9905-179">To specify a named range, provide the range name - for example, **MyDataRange**.</span></span> <span data-ttu-id="d9905-180">Также можно выполнить поиск имени, не заканчивающегося символом `$`, в списке существующих таблиц и представлений.</span><span class="sxs-lookup"><span data-stu-id="d9905-180">Or, look for a name that does not end with the `$` character in the list of existing tables and views.</span></span>
    
-   <span data-ttu-id="d9905-181">**Неименованный диапазон**</span><span class="sxs-lookup"><span data-stu-id="d9905-181">**Unnamed range.**</span></span> <span data-ttu-id="d9905-182">Чтобы указать диапазон ячеек, которым не были заданы имена, добавьте символ $ после имени листа, добавьте спецификацию диапазона и окружите строку разделителями, например **[Лист1$A1:B4]** .</span><span class="sxs-lookup"><span data-stu-id="d9905-182">To specify a range of cells that you haven't named, append the $ character to the end of the sheet name, add the range specification, and add delimiters around the string - for example, **[Sheet1$A1:B4]**.</span></span>

<span data-ttu-id="d9905-183">Чтобы выбрать или указать тип объекта Excel, который вы хотите использовать в качестве источника или назначения для данных, выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="d9905-183">To select or specify the type of Excel object that you want to use as the source or destination for your data, do one of the following things:</span></span>

### <a name="in-ssis"></a><span data-ttu-id="d9905-184">В службах SSIS</span><span class="sxs-lookup"><span data-stu-id="d9905-184">In SSIS</span></span>

<span data-ttu-id="d9905-185">В службах SSIS на странице **Диспетчер соединений** в **редакторе источника Excel** или **редакторе назначения Excel** выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="d9905-185">In SSIS, on the **Connection manager** page of the **Excel Source Editor** or of the **Excel Destination Editor**, do one of the following things:</span></span>

-   <span data-ttu-id="d9905-186">Чтобы использовать **лист** или **именованный диапазон**, выберите **Таблица или представление** в разделе **Режим доступа к данным**.</span><span class="sxs-lookup"><span data-stu-id="d9905-186">To use a **worksheet** or a **named range**, select **Table or view** as the **Data access mode**.</span></span> <span data-ttu-id="d9905-187">Затем выберите лист или именованный диапазон в списке **Имя листа Excel**.</span><span class="sxs-lookup"><span data-stu-id="d9905-187">Then, in the **Name of the Excel sheet** list, select the worksheet or named range.</span></span>

-   <span data-ttu-id="d9905-188">Чтобы использовать **неименованный диапазон**, который задается по адресу, выберите **Команда SQL** в разделе **Режим доступа к данным**.</span><span class="sxs-lookup"><span data-stu-id="d9905-188">To use an **unnamed range** that you specify with its address, select **SQL command** as the **Data access mode**.</span></span> <span data-ttu-id="d9905-189">Затем в поле **Текст команды SQL** введите запрос, аналогичный представленному ниже примеру:</span><span class="sxs-lookup"><span data-stu-id="d9905-189">Then, in the **SQL command text** field, enter a query like the following example:</span></span>

    ```sql
    SELECT * FROM [Sheet1$A1:B5]
    ```

### <a name="in-the-sql-server-import-and-export-wizard"></a><span data-ttu-id="d9905-190">В мастере импорта и экспорта SQL Server</span><span class="sxs-lookup"><span data-stu-id="d9905-190">In the SQL Server Import and Export Wizard</span></span>
<span data-ttu-id="d9905-191">В мастере импорта и экспорта выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="d9905-191">In the Import and Export Wizard, do one of the following things:</span></span>

-   <span data-ttu-id="d9905-192">При **импорте** из Excel выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="d9905-192">When you're **importing** from Excel, do one of the following things:</span></span>

    -   <span data-ttu-id="d9905-193">Чтобы использовать **лист** или **именованный диапазон**, на странице **Выбор копирования таблицы или запроса** выберите **Скопировать данные из одной или нескольких таблиц или представлений**.</span><span class="sxs-lookup"><span data-stu-id="d9905-193">To use a **worksheet** or a **named range**, on the **Specify table copy or query** page, select **Copy data from one or more tables or views**.</span></span> <span data-ttu-id="d9905-194">Затем на странице **Выбор исходных таблиц и представлений** в столбце **Источник** укажите исходные листы и именованные диапазоны.</span><span class="sxs-lookup"><span data-stu-id="d9905-194">Then, on the **Select Source Tables and Views** page, in the **Source** column, select the source worksheets and named ranges.</span></span>

    -   <span data-ttu-id="d9905-195">Чтобы использовать **неименованный диапазон**, который задается по адресу, на странице **Выбор копирования таблицы или запроса** выберите **Написать запрос, указывающий данные для передачи**.</span><span class="sxs-lookup"><span data-stu-id="d9905-195">To use an **unnamed range** that you specify with its address, on the **Specify table copy or query** page, select **Write a query to specify the data to transfer**.</span></span> <span data-ttu-id="d9905-196">Затем на странице **Определение исходного запроса** введите запрос, аналогичный показанному ниже:</span><span class="sxs-lookup"><span data-stu-id="d9905-196">Then, on the **Provide a Source Query** page, provide a query similar to the following example:</span></span>

        ```sql
        SELECT * FROM [Sheet1$A1:B5]
        ```

-   <span data-ttu-id="d9905-197">При **экспорте** в Excel выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="d9905-197">When you're **exporting** to Excel, do one of the following things:</span></span>

    -   <span data-ttu-id="d9905-198">Чтобы использовать **лист** или **именованный диапазон**, на странице **Выбор исходных таблиц и представлений** в столбце **Назначение** выберите целевые листы и именованные диапазоны.</span><span class="sxs-lookup"><span data-stu-id="d9905-198">To use a **worksheet** or a **named range**, on the **Select Source Tables and Views** page, in the **Destination** column, select the destination worksheets and named ranges.</span></span>

    -   <span data-ttu-id="d9905-199">Чтобы использовать **неименованный диапазон**, который задается по адресу, на странице **Выбор исходных таблиц и представлений** в столбце **Назначение** укажите диапазон в следующем формате без использования разделителей: `Sheet1$A1:B5`.</span><span class="sxs-lookup"><span data-stu-id="d9905-199">To use an **unnamed range** that you specify with its address, on the **Select Source Tables and Views** page, in the **Destination** column, enter the range in the following format without delimiters: `Sheet1$A1:B5`.</span></span> <span data-ttu-id="d9905-200">Мастер автоматически добавит разделители.</span><span class="sxs-lookup"><span data-stu-id="d9905-200">The wizard adds the delimiters.</span></span>

<span data-ttu-id="d9905-201">После выбора или ввода объектов Excel для импорта или экспорта вы также можете выполнить следующие действия на странице **Выбор исходных таблиц и представлений** мастера:</span><span class="sxs-lookup"><span data-stu-id="d9905-201">After you select or enter the Excel objects to import or export, you can also do the following things on the **Select Source Tables and Views** page of the wizard:</span></span>

-   <span data-ttu-id="d9905-202">Проверить сопоставления столбцов между источником и назначением, выбрав команду **Изменить сопоставления**.</span><span class="sxs-lookup"><span data-stu-id="d9905-202">Review column mappings between source and destination by selecting **Edit Mappings**.</span></span>

-   <span data-ttu-id="d9905-203">Выполнить предварительный просмотр данных, чтобы убедиться в правильности выбора, с помощью команды **Предварительный просмотр**.</span><span class="sxs-lookup"><span data-stu-id="d9905-203">Preview sample data to make sure it's what you expect by selecting **Preview**.</span></span>

## <a name="issues-with-data-types"></a><a name="issues-types"></a><span data-ttu-id="d9905-204">Проблемы с типами данных</span><span class="sxs-lookup"><span data-stu-id="d9905-204">Issues with data types</span></span>

### <a name="data-types"></a><span data-ttu-id="d9905-205">Типы данных</span><span class="sxs-lookup"><span data-stu-id="d9905-205">Data types</span></span>

<span data-ttu-id="d9905-206">Драйвер Excel распознает только ограниченный набор типов данных.</span><span class="sxs-lookup"><span data-stu-id="d9905-206">The Excel driver recognizes only a limited set of data types.</span></span> <span data-ttu-id="d9905-207">Например, все числовые столбцы воспринимаются как тип double (DT_R8), а все строковые столбцы (кроме столбцов типа memo) воспринимаются как строки в Юникоде длиной 255 символов (DT_WSTR).</span><span class="sxs-lookup"><span data-stu-id="d9905-207">For example, all numeric columns are interpreted as doubles (DT_R8), and all string columns (other than memo columns) are interpreted as 255-character Unicode strings (DT_WSTR).</span></span> <span data-ttu-id="d9905-208">Службы SSIS сопоставляют типы данных Excel следующим образом:</span><span class="sxs-lookup"><span data-stu-id="d9905-208">SSIS maps the Excel data types as follows:</span></span>

-   <span data-ttu-id="d9905-209">Числовой — с плавающей запятой двойной точности (DT_R8)</span><span class="sxs-lookup"><span data-stu-id="d9905-209">Numeric - double-precision float (DT_R8)</span></span>

-   <span data-ttu-id="d9905-210">Денежный — денежный (DT_CY)</span><span class="sxs-lookup"><span data-stu-id="d9905-210">Currency - currency (DT_CY)</span></span>

-   <span data-ttu-id="d9905-211">Логический — логический (DT_BOOL)</span><span class="sxs-lookup"><span data-stu-id="d9905-211">Boolean - Boolean (DT_BOOL)</span></span>

-   <span data-ttu-id="d9905-212">Дата и время — datetime (DT_DATE)</span><span class="sxs-lookup"><span data-stu-id="d9905-212">Date/time - datetime (DT_DATE)</span></span>

-   <span data-ttu-id="d9905-213">Строковый — строка в Юникоде длиной в 255 символов (DT_WSTR)</span><span class="sxs-lookup"><span data-stu-id="d9905-213">String - Unicode string, length 255 (DT_WSTR)</span></span>

-   <span data-ttu-id="d9905-214">Memo — текстовый поток в Юникоде (DT_NTEXT)</span><span class="sxs-lookup"><span data-stu-id="d9905-214">Memo - Unicode text stream (DT_NTEXT)</span></span>

### <a name="data-type-and-length-conversions"></a><span data-ttu-id="d9905-215">Преобразования типов данных и длины по умолчанию</span><span class="sxs-lookup"><span data-stu-id="d9905-215">Data type and length conversions</span></span>

<span data-ttu-id="d9905-216">В службах SSIS неявное преобразование типов данных не выполняется.</span><span class="sxs-lookup"><span data-stu-id="d9905-216">SSIS does not implicitly convert data types.</span></span> <span data-ttu-id="d9905-217">В результате, возможно, потребуется использовать преобразование "Производный столбец" или "Преобразование данных" для явного преобразования данных Excel до их загрузки в назначение, отличное от Excel, либо для преобразования данных из источника, отличного от Excel, до их загрузки в назначение Excel.</span><span class="sxs-lookup"><span data-stu-id="d9905-217">As a result, you may have to use Derived Column or Data Conversion transformations to convert Excel data explicitly before loading it into a destination other than Excel, or to convert data from a source other than Excel before loading it into an Excel destination.</span></span>

<span data-ttu-id="d9905-218">Ниже приведены некоторые примеры преобразований, которые могут потребоваться:</span><span class="sxs-lookup"><span data-stu-id="d9905-218">Here are some examples of the conversions that may be required:</span></span>  
  
-   <span data-ttu-id="d9905-219">Преобразование между строковыми столбцами Excel в Юникоде и строковыми столбцами в формате с конкретными кодовыми страницами, отличными от Юникода.</span><span class="sxs-lookup"><span data-stu-id="d9905-219">Conversion between Unicode Excel string columns and non-Unicode string columns with specific codepage.</span></span>
  
-   <span data-ttu-id="d9905-220">Преобразование между строковыми столбцами Excel длиной в 255 символов и строковыми столбцами другой длины.</span><span class="sxs-lookup"><span data-stu-id="d9905-220">Conversion between 255-character Excel string columns and string columns of different lengths.</span></span>
  
-   <span data-ttu-id="d9905-221">Преобразование между числовыми столбцами Excel с плавающей запятой двойной точности и числовыми столбцами других типов.</span><span class="sxs-lookup"><span data-stu-id="d9905-221">Conversion between double-precision Excel numeric columns and numeric columns of other types.</span></span>

> [!TIP]
> <span data-ttu-id="d9905-222">Если вы используете мастер импорта и экспорта и вам требуется выполнить некоторые из этих преобразований данных, мастер выполнит настройку необходимых преобразований автоматически.</span><span class="sxs-lookup"><span data-stu-id="d9905-222">If you're using the Import and Export Wizard, and your data requires some of these conversions, the wizard configures the necessary conversions for you.</span></span> <span data-ttu-id="d9905-223">В результате, даже если вам требуется использовать пакет служб SSIS, часто бывает полезно создать первичный пакет с помощью мастера импорта и экспорта.</span><span class="sxs-lookup"><span data-stu-id="d9905-223">As a result, even when you want to use an SSIS package, it may be useful to create the initial package by using the Import and Export Wizard.</span></span> <span data-ttu-id="d9905-224">В таком случае мастер создаст и настроит диспетчеры соединений, источники, преобразования и назначения автоматически.</span><span class="sxs-lookup"><span data-stu-id="d9905-224">Let the wizard create and configure connection managers, sources, transformations, and destinations for you.</span></span>

## <a name="issues-with-importing"></a><a name="issues-importing"></a> <span data-ttu-id="d9905-225">Проблемы с импортом</span><span class="sxs-lookup"><span data-stu-id="d9905-225">Issues with importing</span></span>

### <a name="empty-rows"></a><span data-ttu-id="d9905-226">Пустые строки</span><span class="sxs-lookup"><span data-stu-id="d9905-226">Empty rows</span></span>

<span data-ttu-id="d9905-227">Если в качестве источника указан лист или диапазон, драйвер считывает *непрерывный* блок ячеек, начиная с первой непустой ячейки в верхнем левом углу листа или диапазона.</span><span class="sxs-lookup"><span data-stu-id="d9905-227">When you specify a worksheet or a named range as the source, the driver reads the *contiguous* block of cells starting with the first non-empty cell in the upper-left corner of the worksheet or range.</span></span> <span data-ttu-id="d9905-228">В результате данные могут начинаться не со строки 1, однако в данных источника не должны присутствовать пустые строки.</span><span class="sxs-lookup"><span data-stu-id="d9905-228">As a result, your data doesn't have to start in row 1, but you can't have empty rows in the source data.</span></span> <span data-ttu-id="d9905-229">Например, пустые строки не допускаются между заголовками столбцов и строками данных, а также после названия в верхней части листа.</span><span class="sxs-lookup"><span data-stu-id="d9905-229">For example, you can't have an empty row between the column headers and the data rows, or a title followed by empty rows at the top of the worksheet.</span></span>

<span data-ttu-id="d9905-230">Если над данными располагаются пустые строки, вы не сможете выполнить их запрос в качестве листа.</span><span class="sxs-lookup"><span data-stu-id="d9905-230">If there are empty rows above your data, you can't query the data as a worksheet.</span></span> <span data-ttu-id="d9905-231">В Excel необходимо выбрать диапазон данных, присвоить ему имя и выполнить запрос к именованному диапазону, а не к листу.</span><span class="sxs-lookup"><span data-stu-id="d9905-231">In Excel, you have to select your range of data and assign a name to the range, and then query the named range instead of the worksheet.</span></span>

### <a name="missing-values"></a><span data-ttu-id="d9905-232">Отсутствующие значения</span><span class="sxs-lookup"><span data-stu-id="d9905-232">Missing values</span></span>

<span data-ttu-id="d9905-233">Драйвер Excel считывает определенное количество строк (по умолчанию 8 строк) в указанном источнике для определения типа данных каждого столбца.</span><span class="sxs-lookup"><span data-stu-id="d9905-233">The Excel driver reads a certain number of rows (by default, eight rows) in the specified source to guess at the data type of each column.</span></span> <span data-ttu-id="d9905-234">Если столбец содержит смешанные типы данных, особенно если числовые данные смешаны с текстовыми данными, драйвер принимает решение в пользу того типа данных, которого больше, и возвращает значения NULL в ячейки, содержащие данные другого типа.</span><span class="sxs-lookup"><span data-stu-id="d9905-234">When a column appears to contain mixed data types, especially numeric data mixed with text data, the driver decides in favor of the majority data type, and returns null values for cells that contain data of the other type.</span></span> <span data-ttu-id="d9905-235">(В случае равенства преимущество получает числовой тип.) Большинство параметров форматирования ячеек в листе Excel не затрагивает это определение типа данных.</span><span class="sxs-lookup"><span data-stu-id="d9905-235">(In a tie, the numeric type wins.) Most cell formatting options in the Excel worksheet do not seem to affect this data type determination.</span></span>

<span data-ttu-id="d9905-236">Можно изменить поведение драйвера Excel, указав режим импорта для импорта всех значений в виде текста.</span><span class="sxs-lookup"><span data-stu-id="d9905-236">You can modify this behavior of the Excel driver by specifying Import Mode to import all values as text.</span></span> <span data-ttu-id="d9905-237">Чтобы указать режим импорта, добавьте `IMEX=1` к значению **расширенных свойств** в строке соединения диспетчера соединений с Excel в окне "Свойства".</span><span class="sxs-lookup"><span data-stu-id="d9905-237">To specify Import Mode, add `IMEX=1` to the value of **Extended Properties** in the connection string of the Excel connection manager in the Properties window.</span></span> 

### <a name="truncated-text"></a><span data-ttu-id="d9905-238">Усеченный текст</span><span class="sxs-lookup"><span data-stu-id="d9905-238">Truncated text</span></span>

<span data-ttu-id="d9905-239">Когда драйвер определяет, что столбец Excel содержит текстовые данные, он выбирает тип данных (строковый или memo) на основании самого длинного значения.</span><span class="sxs-lookup"><span data-stu-id="d9905-239">When the driver determines that an Excel column contains text data, the driver selects the data type (string or memo) based on the longest value that it samples.</span></span> <span data-ttu-id="d9905-240">Если драйвер не обнаруживает значений длиннее 255 символов в выбираемых строках, он считает, что столбец является строковым с длиной 255 символов, а не столбцом типа memo.</span><span class="sxs-lookup"><span data-stu-id="d9905-240">If the driver does not discover any values longer than 255 characters in the rows that it samples, it treats the column as a 255-character string column instead of a memo column.</span></span> <span data-ttu-id="d9905-241">Поэтому значения длиннее 255 символов могут быть усечены.</span><span class="sxs-lookup"><span data-stu-id="d9905-241">Therefore, values longer than 255 characters may be truncated.</span></span>

<span data-ttu-id="d9905-242">Чтобы импортировать данные из столбца типа memo без усечения, можно воспользоваться любым из двух способов:</span><span class="sxs-lookup"><span data-stu-id="d9905-242">To import data from a memo column without truncation, you have two options:</span></span>

-   <span data-ttu-id="d9905-243">Убедитесь, что столбец типа memo как минимум в одной из выбранных строк содержит значение длиной более 255 символов.</span><span class="sxs-lookup"><span data-stu-id="d9905-243">Make sure that the memo column in at least one of the sampled rows contains a value longer than 255 characters</span></span>

-   <span data-ttu-id="d9905-244">Увеличьте число строк в выборке драйвера, чтобы включить такую строку.</span><span class="sxs-lookup"><span data-stu-id="d9905-244">Increase the number of rows sampled by the driver to include such a row.</span></span> <span data-ttu-id="d9905-245">Чтобы увеличить количество строк, включаемых в выборку, достаточно увеличить значение **TypeGuessRows** в следующем разделе реестра:</span><span class="sxs-lookup"><span data-stu-id="d9905-245">You can increase the number of rows sampled by increasing the value of **TypeGuessRows** under the following registry key:</span></span>

| <span data-ttu-id="d9905-246">Версия распространяемого компонента</span><span class="sxs-lookup"><span data-stu-id="d9905-246">Redistributable components version</span></span> | <span data-ttu-id="d9905-247">Раздел реестра</span><span class="sxs-lookup"><span data-stu-id="d9905-247">Registry key</span></span> |
|---|---|
| <span data-ttu-id="d9905-248">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="d9905-248">Excel 2016</span></span> | <span data-ttu-id="d9905-249">HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Access Connectivity Engine\Engines\Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-249">HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Access Connectivity Engine\Engines\Excel</span></span> |
| <span data-ttu-id="d9905-250">Excel 2010</span><span class="sxs-lookup"><span data-stu-id="d9905-250">Excel 2010</span></span> | <span data-ttu-id="d9905-251">HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\14.0\Access Connectivity Engine\Engines\Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-251">HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\14.0\Access Connectivity Engine\Engines\Excel</span></span> |
| | |

## <a name="issues-with-exporting"></a><a name="issues-exporting"></a> <span data-ttu-id="d9905-252">Проблемы с экспортом</span><span class="sxs-lookup"><span data-stu-id="d9905-252">Issues with exporting</span></span>

### <a name="create-a-new-destination-file"></a><span data-ttu-id="d9905-253">Создание нового файла назначения</span><span class="sxs-lookup"><span data-stu-id="d9905-253">Create a new destination file</span></span>

#### <a name="in-ssis"></a><span data-ttu-id="d9905-254">В службах SSIS</span><span class="sxs-lookup"><span data-stu-id="d9905-254">In SSIS</span></span>

<span data-ttu-id="d9905-255">Создайте диспетчер соединений Excel с именем создаваемого файла Excel и путем к нему.</span><span class="sxs-lookup"><span data-stu-id="d9905-255">Create an Excel Connection Manager with the path and file name of the new Excel file that you want to create.</span></span> <span data-ttu-id="d9905-256">Затем в **редакторе назначения Excel** в разделе **Имя листа Excel** выберите **Создать**, чтобы создать лист назначения.</span><span class="sxs-lookup"><span data-stu-id="d9905-256">Then, in the **Excel Destination Editor**, for **Name of the Excel sheet**, select **New** to create the destination worksheet.</span></span> <span data-ttu-id="d9905-257">В этот момент службы SSIS создают новый файл Excel с указанным листом.</span><span class="sxs-lookup"><span data-stu-id="d9905-257">At this point, SSIS creates the new Excel file with the specified worksheet.</span></span>

#### <a name="in-the-sql-server-import-and-export-wizard"></a><span data-ttu-id="d9905-258">В мастере импорта и экспорта SQL Server</span><span class="sxs-lookup"><span data-stu-id="d9905-258">In the SQL Server Import and Export Wizard</span></span>

<span data-ttu-id="d9905-259">На странице **Выбор назначения** нажмите кнопку **Обзор**.</span><span class="sxs-lookup"><span data-stu-id="d9905-259">On the **Choose a Destination** page, select **Browse**.</span></span> <span data-ttu-id="d9905-260">В диалоговом окне **Открыть** перейдите в папку, в которой требуется создать новый файл Excel, укажите имя этого файла и выберите **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="d9905-260">In the **Open** dialog box, navigate to the folder where you want the new Excel file to be created, provide a name for the new file, and then select **Open**.</span></span>

### <a name="export-to-a-large-enough-range"></a><span data-ttu-id="d9905-261">Экспорт в достаточно большой диапазон</span><span class="sxs-lookup"><span data-stu-id="d9905-261">Export to a large enough range</span></span>

<span data-ttu-id="d9905-262">При указании диапазона в качестве назначения появится сообщение об ошибке, если диапазон содержит меньше *столбцов*, чем в данных источника.</span><span class="sxs-lookup"><span data-stu-id="d9905-262">When you specify a range as the destination, an error occurs if the range has fewer *columns* than the source data.</span></span> <span data-ttu-id="d9905-263">Если же указываемый диапазон содержит меньше *строк*, чем данные источника, мастер продолжит записывать строки без ошибки и расширит определение диапазона для соответствия новому числу строк.</span><span class="sxs-lookup"><span data-stu-id="d9905-263">However, if the range that you specify has fewer *rows* than the source data, the wizard continues writing rows without error and extends the range definition to match the new number of rows.</span></span>

### <a name="export-long-text-values"></a><span data-ttu-id="d9905-264">Экспорт длинных текстовых значений</span><span class="sxs-lookup"><span data-stu-id="d9905-264">Export long text values</span></span>

<span data-ttu-id="d9905-265">Чтобы успешно сохранять в столбцы Excel строки, имеющие длину более 255 символов, драйвер должен распознать тип данных целевого столбца как **memo** , а не как **string**.</span><span class="sxs-lookup"><span data-stu-id="d9905-265">Before you can successfully save strings longer than 255 characters to an Excel column, the driver must recognize the data type of the destination column as **memo** and not **string**.</span></span>

-   <span data-ttu-id="d9905-266">Если в существующей целевой таблице уже содержатся строки данных, то в столбце типа memo в первых нескольких строках, которые проверит драйвер, должен содержаться, по крайней мере, один экземпляр значения, имеющего длину более 255 символов.</span><span class="sxs-lookup"><span data-stu-id="d9905-266">If an existing destination table already contains rows of data, then the first few rows that are sampled by the driver must contain at least one instance of a value longer than 255 characters in the memo column.</span></span>

-   <span data-ttu-id="d9905-267">Если новая целевая таблица создается во время проектирования пакета, во время выполнения или с помощью мастера импорта и экспорта, в инструкции `CREATE TABLE` необходимо использовать LONGTEXT (или один из его синонимов) в качестве типа данных для целевого столбца типа memo.</span><span class="sxs-lookup"><span data-stu-id="d9905-267">If a new destination table is created during package design or at run time or by the Import and Export Wizard, then the `CREATE TABLE` statement must use LONGTEXT (or one of its synonyms) as the data type of the destination memo column.</span></span> <span data-ttu-id="d9905-268">В мастере проверьте инструкцию `CREATE TABLE` и при необходимости измените ее, нажав кнопку **Изменить SQL** рядом с параметром **Создать целевую таблицу** на странице **Сопоставления столбцов**.</span><span class="sxs-lookup"><span data-stu-id="d9905-268">In the wizard, check the `CREATE TABLE` statement and revise it, if necessary, by clicking **Edit SQL** next to the **Create destination table** option on the **Column Mappings** page.</span></span>

## <a name="related-content"></a><span data-ttu-id="d9905-269">См. также</span><span class="sxs-lookup"><span data-stu-id="d9905-269">Related content</span></span>

<span data-ttu-id="d9905-270">Дополнительные сведения о компонентах и процедурах, описываемых в этой статье, см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="d9905-270">For more information about the components and procedures described in this article, see the following articles:</span></span>

### <a name="about-ssis"></a><span data-ttu-id="d9905-271">Сведения о службах SSIS</span><span class="sxs-lookup"><span data-stu-id="d9905-271">About SSIS</span></span>
[<span data-ttu-id="d9905-272">Диспетчер подключений Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-272">Excel Connection Manager</span></span>](connection-manager/excel-connection-manager.md)  
[<span data-ttu-id="d9905-273">Источник Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-273">Excel Source</span></span>](data-flow/excel-source.md)  
[<span data-ttu-id="d9905-274">Назначение «Excel»</span><span class="sxs-lookup"><span data-stu-id="d9905-274">Excel Destination</span></span>](data-flow/excel-destination.md)  
[<span data-ttu-id="d9905-275">Просмотр файлов и таблиц Excel с помощью контейнера «цикл по каждому элементу»</span><span class="sxs-lookup"><span data-stu-id="d9905-275">Loop through Excel Files and Tables by Using a Foreach Loop Container</span></span>](control-flow/loop-through-excel-files-and-tables-by-using-a-foreach-loop-container.md)  
[<span data-ttu-id="d9905-276">Работа с файлами Excel в задаче «Скрипт»</span><span class="sxs-lookup"><span data-stu-id="d9905-276">Working with Excel Files with the Script Task</span></span>](extending-packages-scripting-task-examples/working-with-excel-files-with-the-script-task.md)

### <a name="about-the-sql-server-import-and-export-wizard"></a><span data-ttu-id="d9905-277">Сведения о мастере импорта и экспорта SQL Server</span><span class="sxs-lookup"><span data-stu-id="d9905-277">About the SQL Server Import and Export Wizard</span></span>
[<span data-ttu-id="d9905-278">Подключение к источнику данных Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-278">Connect to an Excel Data Source</span></span>](/sql/integration-services/import-export-data/connect-to-an-excel-data-source-sql-server-import-and-export-wizard)  
[<span data-ttu-id="d9905-279">Приступая к работе с простым примером мастера импорта и экспорта</span><span class="sxs-lookup"><span data-stu-id="d9905-279">Get started with this simple example of the Import and Export Wizard</span></span>](/sql/integration-services/import-export-data/get-started-with-this-simple-example-of-the-import-and-export-wizard)

### <a name="other-articles"></a><span data-ttu-id="d9905-280">Другие статьи</span><span class="sxs-lookup"><span data-stu-id="d9905-280">Other articles</span></span>
[<span data-ttu-id="d9905-281">Импорт данных в SQL Server или базу данных Azure из Excel</span><span class="sxs-lookup"><span data-stu-id="d9905-281">Import data from Excel to SQL Server or Azure SQL Database</span></span>](/sql/relational-databases/import-export/import-data-from-excel-to-sql)  

