---
title: Обновление пакетов служб Integration Services | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services, migrating
- migrating packages [Integration Services]
ms.assetid: 68dbdf81-032c-4a73-99f6-41420e053980
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5a6ca4f80b25a8cc4628da4382c1aae971c74bf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664403"
---
# <a name="upgrade-integration-services-packages"></a><span data-ttu-id="3523b-102">Обновление пакетов служб Integration Services</span><span class="sxs-lookup"><span data-stu-id="3523b-102">Upgrade Integration Services Packages</span></span>
  <span data-ttu-id="3523b-103">При обновлении экземпляра служб [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] до текущего выпуска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] существующие [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] пакеты не обновляются автоматически до формата пакета, используемого в текущем выпуске [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3523b-103">When you upgrade an instance of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], your existing [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] packages are not automatically upgraded to the package format that the current release [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] uses.</span></span> <span data-ttu-id="3523b-104">Необходимо будет выбрать метод обновления и обновить эти пакеты вручную.</span><span class="sxs-lookup"><span data-stu-id="3523b-104">You will have to select an upgrade method and manually upgrade your packages.</span></span>  
  
 <span data-ttu-id="3523b-105">При обновлении [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] пакета [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] переносит скрипты в любой задаче скрипта и компоненте скрипта в [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] средства для приложений (VSTA).</span><span class="sxs-lookup"><span data-stu-id="3523b-105">When you upgrade a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] migrates the scripts in any Script task and Script component to [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA).</span></span> <span data-ttu-id="3523b-106">В скрипты [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] в задачах скриптов или компонентах скриптов используются [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] для приложений (VSA).</span><span class="sxs-lookup"><span data-stu-id="3523b-106">In [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the scripts in Script tasks or Script components used [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] for Applications (VSA).</span></span> <span data-ttu-id="3523b-107">Дополнительные сведения об изменениях, которые может потребоваться внести в скрипт перед выполнением миграции, а также об ошибках их преобразования см. в разделе [Миграция скриптов в VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-107">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>  
  
 <span data-ttu-id="3523b-108">Сведения об обновлении пакетов при преобразовании проекта в модель развертывания проекта см. в разделе [Deploy Projects to Integration Services Server](../deploy-projects-to-integration-services-server.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-108">For information on upgrading packages when you convert a project to the project deployment model, see [Deploy Projects to Integration Services Server](../deploy-projects-to-integration-services-server.md).</span></span>  
  
## <a name="sql-server-2000-data-transformation-services-packages"></a><span data-ttu-id="3523b-109">Пакеты служб DTS в SQL Server 2000</span><span class="sxs-lookup"><span data-stu-id="3523b-109">SQL Server 2000 Data Transformation Services Packages</span></span>  
 <span data-ttu-id="3523b-110">В текущем выпуске поддержка миграции или выполнения пакетов служб DTS прекращена [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3523b-110">Support for migrating or running Data Transformation Services (DTS) packages has been discontinued in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="3523b-111">Следующие функциональные возможности служб DTS более не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="3523b-111">The following DTS functionality has been discontinued.</span></span>  
  
-   <span data-ttu-id="3523b-112">Среда выполнения DTS</span><span class="sxs-lookup"><span data-stu-id="3523b-112">DTS runtime</span></span>  
  
-   <span data-ttu-id="3523b-113">API-интерфейс служб DTS</span><span class="sxs-lookup"><span data-stu-id="3523b-113">DTS API</span></span>  
  
-   <span data-ttu-id="3523b-114">Мастер миграции пакетов служб DTS, выполняющий перенос пакетов DTS в следующую версию служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3523b-114">Package Migration Wizard for migrating DTS packages to the next version of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span></span>  
  
-   <span data-ttu-id="3523b-115">Поддержка обслуживания пакета служб DTS в среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3523b-115">Support for DTS package maintenance in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span></span>  
  
-   <span data-ttu-id="3523b-116">Задача «Выполнение пакета служб DTS 2000»</span><span class="sxs-lookup"><span data-stu-id="3523b-116">Execute DTS 2000 Package task</span></span>  
  
-   <span data-ttu-id="3523b-117">Сканирование пакетов DTS, выполняемое помощником по обновлению.</span><span class="sxs-lookup"><span data-stu-id="3523b-117">Upgrade Advisor scan of DTS packages.</span></span>  
  
 <span data-ttu-id="3523b-118">Для миграции пакетов служб DTS доступны следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="3523b-118">The following options are available for migrating DTS packages.</span></span>  
  
-   <span data-ttu-id="3523b-119">Переместите пакеты в службы [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] или [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], а затем обновите их до версии [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3523b-119">Migrate the packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], and then upgrade the packages to [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="3523b-120">Дополнительные сведения о миграции пакетов служб DTS в [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] и [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)]см. в разделах [Миграция пакетов служб DTS](https://go.microsoft.com/fwlink/?LinkId=251870) (2005) и [Миграция пакетов служб DTS](https://go.microsoft.com/fwlink/?LinkId=251871) (2008).</span><span class="sxs-lookup"><span data-stu-id="3523b-120">For information about migrating DTS packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] and [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], see [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251870) (2005) and [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251871) (2008).</span></span>  
  
-   <span data-ttu-id="3523b-121">Повторно создайте пакеты служб DTS с помощью [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3523b-121">Recreate the DTS packages by using [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="3523b-122">Сведения о новых функциях [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] см. в разделе [Новые возможности (службы Integration Services)](../what-s-new-in-integration-services-in-sql-server-2016.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-122">For information about the new features in [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)], see [What's New &#40;Integration Services&#41;](../what-s-new-in-integration-services-in-sql-server-2016.md).</span></span> <span data-ttu-id="3523b-123">Общие сведения о структуре пакетов [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] см. в разделе [Пакеты служб Integration Services (SSIS)](../integration-services-ssis-packages.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-123">For an overview of the structure of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [Integration Services &#40;SSIS&#41; Packages](../integration-services-ssis-packages.md).</span></span>  
  
## <a name="selecting-an-upgrade-method"></a><span data-ttu-id="3523b-124">Выбор метода обновления</span><span class="sxs-lookup"><span data-stu-id="3523b-124">Selecting an Upgrade Method</span></span>  
 <span data-ttu-id="3523b-125">Можно использовать различные методы обновления пакетов [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3523b-125">You can use various methods to upgrade [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages.</span></span> <span data-ttu-id="3523b-126">Для некоторых из этих методов обновление лишь временное.</span><span class="sxs-lookup"><span data-stu-id="3523b-126">For some of these methods, the upgrade is only temporary.</span></span> <span data-ttu-id="3523b-127">Для других — обновление постоянное.</span><span class="sxs-lookup"><span data-stu-id="3523b-127">For others, the upgrade is permanent.</span></span> <span data-ttu-id="3523b-128">В следующей таблице описан каждый из этих методов и указано, является обновление временным или постоянным.</span><span class="sxs-lookup"><span data-stu-id="3523b-128">The following table describes each of these methods and whether the upgrade is temporary or permanent.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3523b-129">При запуске пакета [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] с помощью программы **dtexec** (dtexec.exe), которая устанавливается с текущим выпуском [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the tempилиary package upgrade increases the execution time.</span><span class="sxs-lookup"><span data-stu-id="3523b-129">When you run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package using the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the temporary package upgrade increases the execution time.</span></span> <span data-ttu-id="3523b-130">Степень увеличения времени выполнения пакета зависит от размера пакета.</span><span class="sxs-lookup"><span data-stu-id="3523b-130">The rate of increase in package execution time varies depending on the size of the package.</span></span> <span data-ttu-id="3523b-131">Во избежание увеличения времени выполнения рекомендуется обновить пакет перед тем, как запускать его.</span><span class="sxs-lookup"><span data-stu-id="3523b-131">To avoid an increase in the execution time, it is recommended that you upgrade the package before running it.</span></span>  
  
|<span data-ttu-id="3523b-132">Метод обновления</span><span class="sxs-lookup"><span data-stu-id="3523b-132">Upgrade Method</span></span>|<span data-ttu-id="3523b-133">Тип обновления</span><span class="sxs-lookup"><span data-stu-id="3523b-133">Type of Upgrade</span></span>|  
|--------------------|---------------------|  
|<span data-ttu-id="3523b-134">Для запуска пакета **dtexec** (dtexec.exe), которая устанавливается с текущим выпуском [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] используйте программу [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3523b-134">Use the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package.</span></span><br /><br /> <span data-ttu-id="3523b-135">Дополнительные сведения см. в статье [dtexec Utility](../packages/dtexec-utility.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-135">For more information, see [dtexec Utility](../packages/dtexec-utility.md).</span></span>|<span data-ttu-id="3523b-136">Результаты обновления пакета являются временными.</span><span class="sxs-lookup"><span data-stu-id="3523b-136">The package upgrade is temporary.</span></span> <span data-ttu-id="3523b-137">Для пакета [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] миграция скриптов является временной.</span><span class="sxs-lookup"><span data-stu-id="3523b-137">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is temporary.</span></span><br /><br /> <span data-ttu-id="3523b-138">Изменения не могут быть сохранены.</span><span class="sxs-lookup"><span data-stu-id="3523b-138">The changes cannot be saved.</span></span>|  
|<span data-ttu-id="3523b-139">Откройте файл пакета [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3523b-139">Open a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package file in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="3523b-140">Обновление пакета постоянное, если пакет сохранен; в противном случае временное, если пакет не сохранен.</span><span class="sxs-lookup"><span data-stu-id="3523b-140">The package upgrade is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span><br /><br /> <span data-ttu-id="3523b-141">Для пакетов [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] миграция скриптов является постоянной, если пакет сохранен; если пакет не сохранен, она является временной.</span><span class="sxs-lookup"><span data-stu-id="3523b-141">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span>|  
|<span data-ttu-id="3523b-142">Добавьте пакет [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] в существующий проект в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3523b-142">Add a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package to an existing project in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="3523b-143">Результаты обновления пакета остаются постоянными.</span><span class="sxs-lookup"><span data-stu-id="3523b-143">The package upgrade is permanent.</span></span> <span data-ttu-id="3523b-144">Для пакета [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] постоянной является миграция скриптов.</span><span class="sxs-lookup"><span data-stu-id="3523b-144">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="3523b-145">Откройте файл проекта [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] или [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] в среде [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]и используйте мастер обновления пакетов служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] , чтобы обновить несколько пакетов в проекте.</span><span class="sxs-lookup"><span data-stu-id="3523b-145">Open a [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] project file in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], and then use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade multiple packages in the project.</span></span><br /><br /> <span data-ttu-id="3523b-146">Дополнительные сведения см. в разделах [Обновление пакетов служб Integration Services с помощью мастера обновления пакетов служб SSIS](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) и [Справка F1 мастера обновления пакетов служб SSIS](../ssis-package-upgrade-wizard-f1-help.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-146">For more information, see [Upgrade Integration Services Packages Using the SSIS Package Upgrade Wizard](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) and [SSIS Package Upgrade Wizard F1 Help](../ssis-package-upgrade-wizard-f1-help.md).</span></span>|<span data-ttu-id="3523b-147">Результаты обновления пакета остаются постоянными.</span><span class="sxs-lookup"><span data-stu-id="3523b-147">The package upgrade is permanent.</span></span> <span data-ttu-id="3523b-148">Для пакета [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] постоянной является миграция скриптов.</span><span class="sxs-lookup"><span data-stu-id="3523b-148">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="3523b-149">Для запуска пакета <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> для обновления одного или нескольких пакетов [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3523b-149">Use the <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> method to upgrade one or more [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages.</span></span>|<span data-ttu-id="3523b-150">Результаты обновления пакета остаются постоянными.</span><span class="sxs-lookup"><span data-stu-id="3523b-150">The package upgrade is permanent.</span></span> <span data-ttu-id="3523b-151">Для пакета [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] постоянной является миграция скриптов.</span><span class="sxs-lookup"><span data-stu-id="3523b-151">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
  
## <a name="custom-applications-and-custom-components"></a><span data-ttu-id="3523b-152">Пользовательские приложения и компоненты</span><span class="sxs-lookup"><span data-stu-id="3523b-152">Custom Applications and Custom Components</span></span>  
 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] <span data-ttu-id="3523b-153">не будут работать с текущим выпуском [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3523b-153">custom components will not work with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="3523b-154">Текущий выпуск средств [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] позволяет запускать пакеты, содержащие пользовательские компоненты [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] и службы [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)][!INCLUDE[ssIS](../../includes/ssis-md.md)], и управлять ими.</span><span class="sxs-lookup"><span data-stu-id="3523b-154">You can use the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tools to run and manage packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)][!INCLUDE[ssIS](../../includes/ssis-md.md)] custom components.</span></span> <span data-ttu-id="3523b-155">Были добавлены 4 правила перенаправления привязки к следующим файлам, чтобы помочь перенаправлять сборки среды выполнения от версии 10.0.0.0 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) до версии 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="3523b-155">We added four binding redirection rules to the following files to help redirect the runtime assemblies from version 10.0.0.0 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span>  
  
-   <span data-ttu-id="3523b-156">DTExec.exe.config</span><span class="sxs-lookup"><span data-stu-id="3523b-156">DTExec.exe.config</span></span>  
  
-   <span data-ttu-id="3523b-157">dtshost.exe.config</span><span class="sxs-lookup"><span data-stu-id="3523b-157">dtshost.exe.config</span></span>  
  
-   <span data-ttu-id="3523b-158">DTSWizard.exe.config</span><span class="sxs-lookup"><span data-stu-id="3523b-158">DTSWizard.exe.config</span></span>  
  
-   <span data-ttu-id="3523b-159">DTUtil.exe.config</span><span class="sxs-lookup"><span data-stu-id="3523b-159">DTUtil.exe.config</span></span>  
  
-   <span data-ttu-id="3523b-160">DTExecUI.exe.config</span><span class="sxs-lookup"><span data-stu-id="3523b-160">DTExecUI.exe.config</span></span>  
  
 <span data-ttu-id="3523b-161">Чтобы использовать [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] для проектирования пакетов, включающих [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] и [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] пользовательские компоненты, необходимо изменить файл devenv.exe.config, расположенный в папке *\<drive>* : \Program Files\Microsoft Visual Studio 10.0 \ Common7\IDE.</span><span class="sxs-lookup"><span data-stu-id="3523b-161">To use [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] to design packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] custom components, you need to modify the devenv.exe.config file that is located at *\<drive>*:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE.</span></span>  
  
 <span data-ttu-id="3523b-162">Чтобы эти пакеты работали с клиентскими приложениями, созданными для среды выполнения [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], включите правила переадресации в разделе файла \*.exe.config для исполняемого файла.</span><span class="sxs-lookup"><span data-stu-id="3523b-162">To use these packages with customer applications that are built with the runtime for [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], include redirection rules in the configuration section of the \*.exe.config file for the executable.</span></span> <span data-ttu-id="3523b-163">Правила перенаправляют сборки среды выполнения на версию 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="3523b-163">The rules redirect the runtime assemblies to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span> <span data-ttu-id="3523b-164">Дополнительные сведения о перенаправлении версии сборки см. в разделе [Элемент \<assemblyBinding> для \<runtime>](https://msdn.microsoft.com/library/twy1dw1e.aspx).</span><span class="sxs-lookup"><span data-stu-id="3523b-164">For more information about assembly version redirection, see [\<assemblyBinding> Element for \<runtime>](https://msdn.microsoft.com/library/twy1dw1e.aspx).</span></span>  
  
### <a name="locating-the-assemblies"></a><span data-ttu-id="3523b-165">Нахождение сборок</span><span class="sxs-lookup"><span data-stu-id="3523b-165">Locating the Assemblies</span></span>  
 <span data-ttu-id="3523b-166">В [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]сборки служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] были обновлены до .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="3523b-166">In [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies were upgraded to .NET 4.0.</span></span> <span data-ttu-id="3523b-167">Существует отдельный глобальный кэш сборок для .NET 4, расположенный в папке *\<drive>* :\Windows\Microsoft.NET\assembly.</span><span class="sxs-lookup"><span data-stu-id="3523b-167">There is a separate global assembly cache for .NET 4, located in *\<drive>*:\Windows\Microsoft.NET\assembly.</span></span> <span data-ttu-id="3523b-168">Там вы можете найти все сборки [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , обычно в папке GAC_MSIL.</span><span class="sxs-lookup"><span data-stu-id="3523b-168">You can find all of the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies under this path, usually in the GAC_MSIL folder.</span></span>  
  
 <span data-ttu-id="3523b-169">Как и в предыдущих версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], основные DLL-файлы расширения служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] также находятся в каталоге *\<drive>* :\Program Files\Microsoft SQL Server\100\SDK\Assemblies.</span><span class="sxs-lookup"><span data-stu-id="3523b-169">As in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the core [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] extensibility .dll files are also located at *\<drive>*:\Program Files\Microsoft SQL Server\100\SDK\Assemblies.</span></span>  
  
## <a name="understanding-sql-server-package-upgrade-results"></a><span data-ttu-id="3523b-170">Основные сведения о результатах обновления пакетов SQL Server</span><span class="sxs-lookup"><span data-stu-id="3523b-170">Understanding SQL Server Package Upgrade Results</span></span>  
 <span data-ttu-id="3523b-171">В процессе обновления пакетов большинство компонентов и функций в пакетах [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] успешно преобразуются в соответствующие объекты из текущего выпуска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3523b-171">During the package upgrade process, most components and features in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages convert seamlessly to their counterparts in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3523b-172">Однако существует несколько компонентов и функций, которые не будут обновлены или на результаты обновления которых следует обратить внимание.</span><span class="sxs-lookup"><span data-stu-id="3523b-172">However, there are several components and features that either will not be upgraded or have upgrade results of which you should be aware.</span></span> <span data-ttu-id="3523b-173">В следующей таблице приведены эти компоненты и функции.</span><span class="sxs-lookup"><span data-stu-id="3523b-173">The following table identifies these components and features.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3523b-174">Чтобы определить, в каких пакетах возникли неполадки, перечисленные в таблице, запустите помощник по обновлению.</span><span class="sxs-lookup"><span data-stu-id="3523b-174">To identify which packages have the issues listed in this table, run Upgrade Advisor.</span></span> <span data-ttu-id="3523b-175">Дополнительные сведения см. в разделе [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-175">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
|<span data-ttu-id="3523b-176">Компонент или функция</span><span class="sxs-lookup"><span data-stu-id="3523b-176">Component or Feature</span></span>|<span data-ttu-id="3523b-177">Результаты обновления</span><span class="sxs-lookup"><span data-stu-id="3523b-177">Upgrade Results</span></span>|  
|--------------------------|---------------------|  
|<span data-ttu-id="3523b-178">Строки подключения</span><span class="sxs-lookup"><span data-stu-id="3523b-178">Connection strings</span></span>|<span data-ttu-id="3523b-179">Для пакетов [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] изменились имена некоторых поставщиков, из-за чего в строках подключения требуется указывать другие значения.</span><span class="sxs-lookup"><span data-stu-id="3523b-179">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages, the names of certain providers have changed and require different values in the connection strings.</span></span> <span data-ttu-id="3523b-180">Чтобы обновить строки подключения, выполните одну из следующих процедур.</span><span class="sxs-lookup"><span data-stu-id="3523b-180">To update the connection strings, use one of the following procedures:</span></span><br /><br /> <span data-ttu-id="3523b-181">— Используйте [!INCLUDE[ssIS](../../includes/ssis-md.md)] Мастер обновления пакетов служб, чтобы обновить пакет, и выберите параметр **Обновить строки подключения, чтобы использовать новые имена поставщиков** .</span><span class="sxs-lookup"><span data-stu-id="3523b-181">-Use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade the package, and select the **Update connection strings to use new provider names** option.</span></span><br /><br /> <span data-ttu-id="3523b-182">— [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] На странице Общие диалогового окна Параметры выберите параметр **Обновить строки подключения, чтобы использовать новые имена поставщиков** .</span><span class="sxs-lookup"><span data-stu-id="3523b-182">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], on the General page of the Options dialog box, select the **Update connection strings to use new provider names** option.</span></span> <span data-ttu-id="3523b-183">Дополнительные сведения об этом параметре см. на [странице Общие](../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-183">For more information about this option, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span><br /><br /> <span data-ttu-id="3523b-184">— В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] откройте пакет и вручную измените текст свойства ConnectionString.</span><span class="sxs-lookup"><span data-stu-id="3523b-184">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], open the package and manually change the text of the ConnectionString property.</span></span><br /><br /> <span data-ttu-id="3523b-185">Примечание. Нельзя применять предыдущие процедуры для обновления строки подключения, если она хранится в файле конфигурации или файле источника данных либо если выражение устанавливает свойство `ConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="3523b-185">Note: You cannot use the previous procedures to update a connection string when the connection string is stored in either a configuration file or a data source file, or when an expression sets the `ConnectionString` property.</span></span> <span data-ttu-id="3523b-186">В таком случае, чтобы обновить строки соединения, необходимо вручную обновить файл конфигурации или выражение.</span><span class="sxs-lookup"><span data-stu-id="3523b-186">To update the connection string in these cases, you must manually update the file or the expression.</span></span><br /><br /> <span data-ttu-id="3523b-187">Дополнительные сведения о доступных источниках данных см. в разделе [Источники данных](../connection-manager/data-sources.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-187">For more information about data sources, see [Data Sources](../connection-manager/data-sources.md).</span></span>|  
|<span data-ttu-id="3523b-188">Преобразование «Уточняющий запрос»</span><span class="sxs-lookup"><span data-stu-id="3523b-188">Lookup transformation</span></span>|<span data-ttu-id="3523b-189">При обновлении пакетов [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] преобразование "Уточняющий запрос" автоматически обновляется до текущего выпуска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3523b-189">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically upgrades the Lookup transformation to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="3523b-190">Однако у текущего выпуска этого компонента есть некоторые дополнительные возможности.</span><span class="sxs-lookup"><span data-stu-id="3523b-190">However, the current release of this component has some additional capabilities of which you might want to take advantage.</span></span><br /><br /> <span data-ttu-id="3523b-191">Дополнительные сведения см. в разделе [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-191">For more information, see [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).</span></span>|  
|<span data-ttu-id="3523b-192">Задача «Скрипт» и компонент скрипта</span><span class="sxs-lookup"><span data-stu-id="3523b-192">Script task and Script component</span></span>|<span data-ttu-id="3523b-193">Для пакетов [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] в процессе обновления пакета скрипты из задачи и компонента скрипта автоматически переносятся из VSA в VSTA.</span><span class="sxs-lookup"><span data-stu-id="3523b-193">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically migrates scripts in the Script task and Script component from VSA to VSTA.</span></span><br /><br /> <span data-ttu-id="3523b-194">Дополнительные сведения об изменениях, которые может потребоваться внести в скрипт перед выполнением миграции, а также об ошибках их преобразования см. в разделе [Миграция скриптов в VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span><span class="sxs-lookup"><span data-stu-id="3523b-194">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>|  
  
### <a name="scripts-that-depend-on-adodbdll"></a><span data-ttu-id="3523b-195">Скрипты, зависящие от ADODB.dll</span><span class="sxs-lookup"><span data-stu-id="3523b-195">Scripts that Depend on ADODB.dll</span></span>  
 <span data-ttu-id="3523b-196">Скрипты задачи «Скрипт» и компонента «Скрипт», которые явно ссылаются на файл ADODB.dll, могут не выполняться или не обновляться на компьютерах, на которых не установлена среда [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3523b-196">Script Task and Script Component scripts that explicitly reference ADODB.dll may not upgrade or run on machines without [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] installed.</span></span> <span data-ttu-id="3523b-197">Чтобы обновить эти скрипты задачи "Скрипт" и компонента скрипта, рекомендуется удалить зависимость от файла ADODB.dll.</span><span class="sxs-lookup"><span data-stu-id="3523b-197">In order to upgrade these Script Task or Script Component scripts, it is recommended that you remove the dependency on ADODB.dll.</span></span>  <span data-ttu-id="3523b-198">Ado.Net — это рекомендуемая альтернатива для такого управляемого кода, как скрипты VB и C#.</span><span class="sxs-lookup"><span data-stu-id="3523b-198">Ado.Net is the recommended alternative for managed code such as VB and C# scripts.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="3523b-199">Внешние ресурсы</span><span class="sxs-lookup"><span data-stu-id="3523b-199">External Resources</span></span>  
  
-   <span data-ttu-id="3523b-200">Техническая статья [5 советов для беспроблемного обновления служб SSIS до версии SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=235321)на сайте msdn.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="3523b-200">Technical article, [5 Tips for a Smooth SSIS Upgrade to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=235321), on msdn.microsoft.com.</span></span>  
  
-   <span data-ttu-id="3523b-201">Запись в блоге [Использование существующих пользовательских расширений служб SSIS и приложений в Denali](https://go.microsoft.com/fwlink/?LinkId=238157)на blogs.msdn.com.</span><span class="sxs-lookup"><span data-stu-id="3523b-201">Blog entry, [Making your Existing Custom SSIS Extensions and Applications Work in Denali](https://go.microsoft.com/fwlink/?LinkId=238157), on blogs.msdn.com.</span></span>  
  
-   <span data-ttu-id="3523b-202">Веб-трансляция [Обновление пакетов служб SSIS в SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674)на channel9.msdn.com.</span><span class="sxs-lookup"><span data-stu-id="3523b-202">Webcast, [Upgrading SSIS Packages to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674), on channel9.msdn.com.</span></span>  
  
  
