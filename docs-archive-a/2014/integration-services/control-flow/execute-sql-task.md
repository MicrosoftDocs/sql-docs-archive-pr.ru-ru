---
title: Задача "Выполнение SQL" | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.executesqltask.f1
helpviewer_keywords:
- Transact-SQL statements, SSIS
- statements [Integration Services]
- batches [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: bebb2e8c-0410-43b2-ac2f-6fc80c8f2e9e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e77b9f442ae8478c57d5b0e68955b541eda38aff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729709"
---
# <a name="execute-sql-task"></a><span data-ttu-id="61ea0-102">Задача "Выполнение SQL"</span><span class="sxs-lookup"><span data-stu-id="61ea0-102">Execute SQL Task</span></span>
  <span data-ttu-id="61ea0-103">Задача «Выполнение SQL» выполняет инструкции SQL или хранимые процедуры из пакета.</span><span class="sxs-lookup"><span data-stu-id="61ea0-103">The Execute SQL task runs SQL statements or stored procedures from a package.</span></span> <span data-ttu-id="61ea0-104">Задача может содержать одну инструкцию SQL или несколько инструкций, запускаемых последовательно.</span><span class="sxs-lookup"><span data-stu-id="61ea0-104">The task can contain either a single SQL statement or multiple SQL statements that run sequentially.</span></span> <span data-ttu-id="61ea0-105">Задача «Выполнение SQL» может быть использована для следующих целей:</span><span class="sxs-lookup"><span data-stu-id="61ea0-105">You can use the Execute SQL task for the following purposes:</span></span>  
  
-   <span data-ttu-id="61ea0-106">усечение таблицы или представления в процессе подготовки для вставки данных;</span><span class="sxs-lookup"><span data-stu-id="61ea0-106">Truncate a table or view in preparation for inserting data.</span></span>  
  
-   <span data-ttu-id="61ea0-107">создание, изменение и удаление объектов базы данных, таких как таблицы и представления;</span><span class="sxs-lookup"><span data-stu-id="61ea0-107">Create, alter, and drop database objects such as tables and views.</span></span>  
  
-   <span data-ttu-id="61ea0-108">повторное создание таблиц фактов и таблиц измерений перед загрузкой данных;</span><span class="sxs-lookup"><span data-stu-id="61ea0-108">Re-create fact and dimension tables before loading data into them.</span></span>  
  
-   <span data-ttu-id="61ea0-109">выполнение хранимых процедур;</span><span class="sxs-lookup"><span data-stu-id="61ea0-109">Run stored procedures.</span></span> <span data-ttu-id="61ea0-110">Если инструкция SQL вызывает хранимую процедуру, возвращающую результаты из временной таблицы, используйте параметр WITH RESULT SETS для определения метаданных набора результатов.</span><span class="sxs-lookup"><span data-stu-id="61ea0-110">If the SQL statement invokes a stored procedure that returns results from a temporary table, use the WITH RESULT SETS option to define metadata for the result set.</span></span>  
  
-   <span data-ttu-id="61ea0-111">сохранение набора строк, возвращенного в переменную из запроса.</span><span class="sxs-lookup"><span data-stu-id="61ea0-111">Save the rowset returned from a query into a variable.</span></span>  
  
 <span data-ttu-id="61ea0-112">Задача «Выполнение SQL» может использоваться в сочетании с контейнерами «цикл по каждому элементу» и «цикл по элементам» для выполнения нескольких инструкций SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-112">The Execute SQL task can be used in combination with the Foreach Loop and For Loop containers to run multiple SQL statements.</span></span> <span data-ttu-id="61ea0-113">Эти контейнеры выполняют повторяющиеся потоки управления в пакете и могут запускать задачу «Выполнение SQL» повторно.</span><span class="sxs-lookup"><span data-stu-id="61ea0-113">These containers implement repeating control flows in a package and they can run the Execute SQL task repeatedly.</span></span> <span data-ttu-id="61ea0-114">Например, с помощью контейнера «цикл по каждому элементу» пакет может перечислять файлы в папке и повторно запускать задачу «Выполнение SQL» с инструкциями SQL из каждого файла.</span><span class="sxs-lookup"><span data-stu-id="61ea0-114">For example, using the Foreach Loop container, a package can enumerate files in a folder and run an Execute SQL task repeatedly to execute the SQL statement stored in each file.</span></span>  
  
## <a name="connecting-to-a-data-source"></a><span data-ttu-id="61ea0-115">Подключение к источнику данных</span><span class="sxs-lookup"><span data-stu-id="61ea0-115">Connecting to a Data Source</span></span>  
 <span data-ttu-id="61ea0-116">Задача «Выполнение SQL» может использовать разные типы диспетчеров соединений для подключения к источнику данных, где требуется выполнить инструкцию SQL или хранимую процедуру.</span><span class="sxs-lookup"><span data-stu-id="61ea0-116">The Execute SQL task can use different types of connection managers to connect to the data source where it runs the SQL statement or stored procedure.</span></span> <span data-ttu-id="61ea0-117">Задача может использовать типы соединений, перечисленные в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="61ea0-117">The task can use the connection types listed in the following table.</span></span>  
  
|<span data-ttu-id="61ea0-118">Тип соединений</span><span class="sxs-lookup"><span data-stu-id="61ea0-118">Connection type</span></span>|<span data-ttu-id="61ea0-119">Диспетчер соединений</span><span class="sxs-lookup"><span data-stu-id="61ea0-119">Connection manager</span></span>|  
|---------------------|------------------------|  
|<span data-ttu-id="61ea0-120">EXCEL</span><span class="sxs-lookup"><span data-stu-id="61ea0-120">EXCEL</span></span>|[<span data-ttu-id="61ea0-121">Диспетчер подключений Excel</span><span class="sxs-lookup"><span data-stu-id="61ea0-121">Excel Connection Manager</span></span>](../connection-manager/excel-connection-manager.md)|  
|<span data-ttu-id="61ea0-122">OLE DB</span><span class="sxs-lookup"><span data-stu-id="61ea0-122">OLE DB</span></span>|[<span data-ttu-id="61ea0-123">Диспетчер соединений OLE DB</span><span class="sxs-lookup"><span data-stu-id="61ea0-123">OLE DB Connection Manager</span></span>](../connection-manager/ole-db-connection-manager.md)|  
|<span data-ttu-id="61ea0-124">ODBC</span><span class="sxs-lookup"><span data-stu-id="61ea0-124">ODBC</span></span>|[<span data-ttu-id="61ea0-125">Диспетчер подключений ODBC</span><span class="sxs-lookup"><span data-stu-id="61ea0-125">ODBC Connection Manager</span></span>](../connection-manager/odbc-connection-manager.md)|  
|<span data-ttu-id="61ea0-126">ADO</span><span class="sxs-lookup"><span data-stu-id="61ea0-126">ADO</span></span>|[<span data-ttu-id="61ea0-127">Диспетчер подключений объектов данных ActiveX</span><span class="sxs-lookup"><span data-stu-id="61ea0-127">ADO Connection Manager</span></span>](../connection-manager/ado-connection-manager.md)|  
|<span data-ttu-id="61ea0-128">ADO.NET</span><span class="sxs-lookup"><span data-stu-id="61ea0-128">ADO.NET</span></span>|[<span data-ttu-id="61ea0-129">Диспетчер подключений ADO.NET</span><span class="sxs-lookup"><span data-stu-id="61ea0-129">ADO.NET Connection Manager</span></span>](../connection-manager/ado-net-connection-manager.md)|  
|<span data-ttu-id="61ea0-130">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="61ea0-130">SQLMOBILE</span></span>|[<span data-ttu-id="61ea0-131">Диспетчер подключений SQL Server Compact Edition</span><span class="sxs-lookup"><span data-stu-id="61ea0-131">SQL Server Compact Edition Connection Manager</span></span>](../connection-manager/sql-server-compact-edition-connection-manager.md)|  
  
## <a name="creating-sql-statements"></a><span data-ttu-id="61ea0-132">Создание инструкций SQL</span><span class="sxs-lookup"><span data-stu-id="61ea0-132">Creating SQL Statements</span></span>  
 <span data-ttu-id="61ea0-133">Источником инструкций SQL для этой задачи может быть свойство задачи, которое содержит инструкцию, соединение с файлом, содержащим инструкции, или имя переменной, хранящей инструкцию.</span><span class="sxs-lookup"><span data-stu-id="61ea0-133">The source of the SQL statements used by this task can be a task property that contains a statement, a connection to a file that contains one or multiple statements, or the name of a variable that contains a statement.</span></span> <span data-ttu-id="61ea0-134">Для написания инструкций SQL необходимо использовать разновидность языка SQL, используемую системой управления базой данных-источником (СУБД).</span><span class="sxs-lookup"><span data-stu-id="61ea0-134">The SQL statements must be written in the dialect of the source database management system (DBMS).</span></span> <span data-ttu-id="61ea0-135">Дополнительные сведения см. в разделе [Запросы в службах Integration Services (SSIS)](../integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-135">For more information, see [Integration Services &#40;SSIS&#41; Queries](../integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="61ea0-136">Если инструкции SQL хранятся в файле, задача использует диспетчер подключения файлов для подключения к файлу.</span><span class="sxs-lookup"><span data-stu-id="61ea0-136">If the SQL statements are stored in a file, the task uses a File connection manager to connect to the file.</span></span> <span data-ttu-id="61ea0-137">Дополнительные сведения см. в статье [File Connection Manager](../connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-137">For more information, see [File Connection Manager](../connection-manager/file-connection-manager.md).</span></span>  
  
 <span data-ttu-id="61ea0-138">В конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] можно использовать диалоговое окно **Редактор задачи «Выполнение SQL»** для ввода инструкций SQL или **построитель запросов**— графический пользовательский интерфейс для создания запросов SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-138">In [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, you can use the **Execute SQL Task Editor** dialog box to type SQL statements, or use **Query Builder**, a graphical user interface for creating SQL queries.</span></span> <span data-ttu-id="61ea0-139">Дополнительные сведения см. в разделе [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) и [построитель запросов](../query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-139">For more information, see [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) and [Query Builder](../query-builder.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="61ea0-140">Задача «Выполнение SQL» не может провести синтаксический анализ допустимых инструкций SQL, созданных за ее пределами.</span><span class="sxs-lookup"><span data-stu-id="61ea0-140">Valid SQL statements written outside the Execute SQL task may not be parsed successfully by the Execute SQL task.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="61ea0-141">Задача «Выполнение SQL» использует значение перечисления `RecognizeAll` ParseMode.</span><span class="sxs-lookup"><span data-stu-id="61ea0-141">The Execute SQL Task uses the `RecognizeAll` ParseMode enumeration value.</span></span> <span data-ttu-id="61ea0-142">Дополнительные сведения см. в разделе [Пространство имен ManagedBatchParser](https://go.microsoft.com/fwlink/?LinkId=223617).</span><span class="sxs-lookup"><span data-stu-id="61ea0-142">For more information, see [ManagedBatchParser Namespace](https://go.microsoft.com/fwlink/?LinkId=223617).</span></span>  
  
## <a name="sending-multiple-statements-in-a-batch"></a><span data-ttu-id="61ea0-143">Отправка нескольких инструкций в пакете</span><span class="sxs-lookup"><span data-stu-id="61ea0-143">Sending Multiple Statements in a Batch</span></span>  
 <span data-ttu-id="61ea0-144">Если в задачу «Выполнение SQL» включить несколько инструкций, их можно сгруппировать и запускать как пакет.</span><span class="sxs-lookup"><span data-stu-id="61ea0-144">If you include multiple statements in an Execute SQL task, you can group them and run them as a batch.</span></span> <span data-ttu-id="61ea0-145">Для обозначения окончания пакета используется команда GO.</span><span class="sxs-lookup"><span data-stu-id="61ea0-145">To signal the end of a batch, use the GO command.</span></span> <span data-ttu-id="61ea0-146">Все инструкции SQL, находящиеся между двумя командами GO, отправляются в одном пакете поставщику OLE DB для выполнения.</span><span class="sxs-lookup"><span data-stu-id="61ea0-146">All the SQL statements between two GO commands are sent in a batch to the OLE DB provider to be run.</span></span> <span data-ttu-id="61ea0-147">Команда SQL может содержать несколько пакетов, разделенных командами GO.</span><span class="sxs-lookup"><span data-stu-id="61ea0-147">The SQL command can include multiple batches separated by GO commands.</span></span>  
  
 <span data-ttu-id="61ea0-148">Существуют ограничения на тип инструкций SQL, которые могут объединяться в пакеты.</span><span class="sxs-lookup"><span data-stu-id="61ea0-148">There are restrictions on the kinds of SQL statements that you can group in a batch.</span></span> <span data-ttu-id="61ea0-149">Дополнительные сведения см. в разделе [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-149">For more information, see [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span></span>  
  
 <span data-ttu-id="61ea0-150">Если задача «Выполнение SQL» выполняет пакет инструкций SQL, к пакету применяются следующие правила:</span><span class="sxs-lookup"><span data-stu-id="61ea0-150">If the Execute SQL task runs a batch of SQL statements, the following rules apply to the batch:</span></span>  
  
-   <span data-ttu-id="61ea0-151">Только одна инструкция может возвращать результирующий набор. Эта инструкция должна быть первой в пакете.</span><span class="sxs-lookup"><span data-stu-id="61ea0-151">Only one statement can return a result set and it must be the first statement in the batch.</span></span>  
  
-   <span data-ttu-id="61ea0-152">Если в результирующем наборе содержатся связанные столбцы, запросы должны возвращать такое же количество столбцов.</span><span class="sxs-lookup"><span data-stu-id="61ea0-152">If the result set uses result bindings, the queries must return the same number of columns.</span></span> <span data-ttu-id="61ea0-153">Если запросы возвращают разное количество столбцов, происходит сбой выполнения задачи.</span><span class="sxs-lookup"><span data-stu-id="61ea0-153">If the queries return a different number of columns, the task fails.</span></span> <span data-ttu-id="61ea0-154">Тем не менее, даже в случае сбоя выполнения задачи ее запросы, такие как DELETE или INSERT могут быть выполнены успешно.</span><span class="sxs-lookup"><span data-stu-id="61ea0-154">However, even if the task fails, the queries that it runs, such as DELETE or INSERT queries, may succeed.</span></span>  
  
-   <span data-ttu-id="61ea0-155">Если в результирующих связываниях участвуют имена столбцов, запросы должны возвращать столбцы с такими же именами, как в результирующем наборе, используемом задачей.</span><span class="sxs-lookup"><span data-stu-id="61ea0-155">If the result bindings use column names, the query must return columns that have the same names as the result set names that are used in the task.</span></span> <span data-ttu-id="61ea0-156">Если столбцы отсутствуют, происходит сбой выполнения задачи.</span><span class="sxs-lookup"><span data-stu-id="61ea0-156">If the columns are missing, the task fails.</span></span>  
  
-   <span data-ttu-id="61ea0-157">Если в задаче используются связывания параметров, у всех запросов в пакете должны быть одинаковые типы параметров и их количество.</span><span class="sxs-lookup"><span data-stu-id="61ea0-157">If the task uses parameter binding, all the queries in the batch must have the same number and types of parameters.</span></span>  
  
## <a name="running-parameterized-sql-commands"></a><span data-ttu-id="61ea0-158">Выполнение параметризованных команд SQL</span><span class="sxs-lookup"><span data-stu-id="61ea0-158">Running Parameterized SQL Commands</span></span>  
 <span data-ttu-id="61ea0-159">В инструкциях SQL и хранимых процедурах часто используются входные параметры, выходные параметры и коды возврата.</span><span class="sxs-lookup"><span data-stu-id="61ea0-159">SQL statements and stored procedures frequently use input parameters, output parameters, and return codes.</span></span> <span data-ttu-id="61ea0-160">Задача «Выполнение SQL» поддерживает типы параметров `Input`, `Output` и `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="61ea0-160">The Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="61ea0-161">Используйте тип `Input` для входных параметров, `Output` — для выходных и `ReturnValue` — для кодов возврата.</span><span class="sxs-lookup"><span data-stu-id="61ea0-161">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="61ea0-162">В задаче «Выполнение SQL» параметры могут использоваться, только если их поддерживает поставщик данных.</span><span class="sxs-lookup"><span data-stu-id="61ea0-162">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="61ea0-163">Дополнительные сведения об использовании параметров в задаче "Выполнение SQL" и ее кодах возврата см. в разделе [Параметры и коды возврата в задаче "Выполнение SQL"](execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-163">For information on using parameters and return codes in the Execute SQL task, see [Parameters and Return Codes in the Execute SQL Task](execute-sql-task.md).</span></span>  
  
## <a name="specifying-a-result-set-type"></a><span data-ttu-id="61ea0-164">Указание типа результирующего набора</span><span class="sxs-lookup"><span data-stu-id="61ea0-164">Specifying a Result Set Type</span></span>  
 <span data-ttu-id="61ea0-165">В зависимости от команды SQL задаче «Выполнение SQL» может быть возвращен (или не возвращен) результирующий набор.</span><span class="sxs-lookup"><span data-stu-id="61ea0-165">Depending on the type of SQL command, a result set may or may not be returned to the Execute SQL task.</span></span> <span data-ttu-id="61ea0-166">Например, инструкция SELECT обычно возвращает результирующий набор, а инструкция INSERT нет.</span><span class="sxs-lookup"><span data-stu-id="61ea0-166">For example, a SELECT statement typically returns a result set, but an INSERT statement does not.</span></span> <span data-ttu-id="61ea0-167">Результирующий набор инструкции SELECT может не содержать ни одной строки, содержать одну строку или несколько строк.</span><span class="sxs-lookup"><span data-stu-id="61ea0-167">The result set from a SELECT statement can contain zero rows, one row, or many rows.</span></span> <span data-ttu-id="61ea0-168">Хранимые процедуры возвращают целочисленные значения, называемые кодом возврата, который отражает состояние выполнения процедуры.</span><span class="sxs-lookup"><span data-stu-id="61ea0-168">Stored procedures can also return an integer value, called a return code, that indicates the execution status of the procedure.</span></span> <span data-ttu-id="61ea0-169">В этом случае результирующий набор состоит из одной строки.</span><span class="sxs-lookup"><span data-stu-id="61ea0-169">In that case, the result set consists of a single row.</span></span>  
  
 <span data-ttu-id="61ea0-170">Дополнительные сведения о получении результирующих наборов команд SQL в задаче "Выполнение SQL" см. в разделе [Результирующие наборы в задаче "Выполнение SQL"](../result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-170">For information on retrieving result sets from SQL commands in the Execute SQL task, see [Result Sets in the Execute SQL Task](../result-sets-in-the-execute-sql-task.md).</span></span>  
  
## <a name="troubleshooting-the-execute-sql-task"></a><span data-ttu-id="61ea0-171">Устранение неполадок, связанных с задачей «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="61ea0-171">Troubleshooting the Execute SQL Task</span></span>  
 <span data-ttu-id="61ea0-172">Вызовы, сделанные задачей «Выполнение SQL» к внешним источникам данных, можно записывать в журнал.</span><span class="sxs-lookup"><span data-stu-id="61ea0-172">You can log the calls that the Execute SQL task makes to external data providers.</span></span> <span data-ttu-id="61ea0-173">Эта новая возможность протоколирования может быть использована для устранения неполадок, связанных с командами SQL, которые выполняются задачей «Выполнение SQL».</span><span class="sxs-lookup"><span data-stu-id="61ea0-173">You can use this logging capability to troubleshoot the SQL commands that the Execute SQL task runs.</span></span> <span data-ttu-id="61ea0-174">Чтобы протоколировать вызовы, которые задача «Выполнение SQL» формирует к внешнему поставщику данных, необходимо разрешить ведение журнала пакета и выбрать событие **Диагностика** на уровне пакета.</span><span class="sxs-lookup"><span data-stu-id="61ea0-174">To log the calls that the Execute SQL task makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="61ea0-175">Дополнительные сведения см. в разделе [Инструменты устранения неполадок при выполнении пакетов](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-175">For more information, see [Troubleshooting Tools for Package Execution](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
 <span data-ttu-id="61ea0-176">Иногда команда SQL или хранимая процедура возвращает несколько результирующих наборов.</span><span class="sxs-lookup"><span data-stu-id="61ea0-176">Sometimes a SQL command or stored procedure returns multiple result sets.</span></span> <span data-ttu-id="61ea0-177">Эти результирующие наборы включают не только наборы строк, которые являются результатом запросов `SELECT`, но и отдельные значения, являющиеся результатом ошибок инструкций `RAISERROR` или `PRINT`.</span><span class="sxs-lookup"><span data-stu-id="61ea0-177">These result sets include not only rowsets that are the result of `SELECT` queries, but single values that are the result of errors of `RAISERROR` or `PRINT` statements.</span></span> <span data-ttu-id="61ea0-178">От типа используемого диспетчера соединений зависит, пропускает ли задача ошибки в результирующих наборах, следующих за первым.</span><span class="sxs-lookup"><span data-stu-id="61ea0-178">Whether the task ignores errors in result sets that occur after the first result set depends on the type of connection manager that is used:</span></span>  
  
-   <span data-ttu-id="61ea0-179">Если используются диспетчеры соединений OLE DB и ADO, задача пропускает результирующие наборы, следующие за первым результирующим набором.</span><span class="sxs-lookup"><span data-stu-id="61ea0-179">When you use OLE DB and ADO connection managers, the task ignores the result sets that occur after the first result set.</span></span> <span data-ttu-id="61ea0-180">Поэтому задача с этими диспетчерами соединений не обрабатывает ошибку, возвращенную командой SQL или хранимой процедурой, если эта ошибка не является частью первого результирующего набора.</span><span class="sxs-lookup"><span data-stu-id="61ea0-180">Therefore, with these connection managers, the task ignores an error returned by an SQL command or a stored procedure when the error is not part of the first result set.</span></span>  
  
-   <span data-ttu-id="61ea0-181">Если используются диспетчеры соединений ODBC и ADO.NET, задача не пропускает результирующие наборы, следующие за первым результирующим набором.</span><span class="sxs-lookup"><span data-stu-id="61ea0-181">When you use ODBC and ADO.NET connection managers, the task does not ignore result sets that occur after the first result set.</span></span> <span data-ttu-id="61ea0-182">Задача с этими диспетчерами соединений завершается ошибкой, если один из результирующих наборов, следующих за первым, содержит ошибку.</span><span class="sxs-lookup"><span data-stu-id="61ea0-182">With these connection managers, the task will fail with an error when a result set other than the first result set contains an error.</span></span>  
  
### <a name="custom-log-entries"></a><span data-ttu-id="61ea0-183">Пользовательские записи журнала</span><span class="sxs-lookup"><span data-stu-id="61ea0-183">Custom Log Entries</span></span>  
 <span data-ttu-id="61ea0-184">В следующей таблице перечислены пользовательские записи журнала для задачи «Выполнение SQL».</span><span class="sxs-lookup"><span data-stu-id="61ea0-184">The following table describes the custom log entry for the Execute SQL task.</span></span> <span data-ttu-id="61ea0-185">Дополнительные сведения см. в разделах [Ведение журналов в службах Integration Services (SSIS)](../performance/integration-services-ssis-logging.md) и [Пользовательские сообщения для ведения журнала](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="61ea0-185">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="61ea0-186">Запись журнала</span><span class="sxs-lookup"><span data-stu-id="61ea0-186">Log entry</span></span>|<span data-ttu-id="61ea0-187">Описание</span><span class="sxs-lookup"><span data-stu-id="61ea0-187">Description</span></span>|  
|---------------|-----------------|  
|`ExecuteSQLExecutingQuery`|<span data-ttu-id="61ea0-188">Предоставляет сведения об этапах выполнения инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-188">Provides information about the execution phases of the SQL statement.</span></span> <span data-ttu-id="61ea0-189">Записи журнала формируются в тот момент, когда задача устанавливает соединение с базой данных, когда задача приступает к подготовке инструкции SQL, и после того, как завершается выполнение инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-189">Log entries are written when the task acquires connection to the database, when the task starts to prepare the SQL statement, and after the execution of the SQL statement is completed.</span></span> <span data-ttu-id="61ea0-190">Запись журнала для этапа подготовки содержит инструкцию SQL, которая используется задачей.</span><span class="sxs-lookup"><span data-stu-id="61ea0-190">The log entry for the prepare phase includes the SQL statement that the task uses.</span></span>|  
  
## <a name="configuring-the-execute-sql-task"></a><span data-ttu-id="61ea0-191">Настройка задачи «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="61ea0-191">Configuring the Execute SQL Task</span></span>  
 <span data-ttu-id="61ea0-192">Настроить задачу «Выполнение SQL» можно одним из следующих способов:</span><span class="sxs-lookup"><span data-stu-id="61ea0-192">You can configure the Execute SQL task in the following ways:</span></span>  
  
-   <span data-ttu-id="61ea0-193">Указать тип диспетчера соединений для подключения к базе данных.</span><span class="sxs-lookup"><span data-stu-id="61ea0-193">Specify the type of connection manager to use to connect to a database.</span></span>  
  
-   <span data-ttu-id="61ea0-194">Указать тип результирующего набора, возвращаемого инструкцией SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-194">Specify the type of result set that the SQL statement returns.</span></span>  
  
-   <span data-ttu-id="61ea0-195">Указать время ожидания для инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-195">Specify a time-out for the SQL statements.</span></span>  
  
-   <span data-ttu-id="61ea0-196">Указать источник для инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-196">Specify the source of the SQL statement.</span></span>  
  
-   <span data-ttu-id="61ea0-197">Указать, должна ли задача пропустить фазу подготовки инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="61ea0-197">Indicate whether the task skips the prepare phase for the SQL statement.</span></span>  
  
-   <span data-ttu-id="61ea0-198">При использовании типа соединения ADO необходимо указать, является ли инструкция SQL хранимой процедурой.</span><span class="sxs-lookup"><span data-stu-id="61ea0-198">If you use the ADO connection type, you must indicate whether the SQL statement is a stored procedure.</span></span> <span data-ttu-id="61ea0-199">Для других типов соединений это свойство доступно только для чтения и всегда имеет значение `false`.</span><span class="sxs-lookup"><span data-stu-id="61ea0-199">For other connection types, this property is read-only and its value is always `false`.</span></span>  
  
 <span data-ttu-id="61ea0-200">Свойства задаются программно или через конструктор служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="61ea0-200">You can set properties programmatically or through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span>  
  
 <span data-ttu-id="61ea0-201">Дополнительные сведения о свойствах, которые можно задать в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] , см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="61ea0-201">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="61ea0-202">Редактор задачи «Выполнение SQL» &#40;страница «Общие»&#41;</span><span class="sxs-lookup"><span data-stu-id="61ea0-202">Execute SQL Task Editor &#40;General Page&#41;</span></span>](../execute-sql-task-editor-general-page.md)  
  
-   [<span data-ttu-id="61ea0-203">Редактор задачи "Выполнение SQL" &#40;страница "Сопоставление параметров"&#41;</span><span class="sxs-lookup"><span data-stu-id="61ea0-203">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../execute-sql-task-editor-parameter-mapping-page.md)  
  
-   [<span data-ttu-id="61ea0-204">Редактор задачи "Выполнение SQL" &#40;страница "результирующий набор"&#41;</span><span class="sxs-lookup"><span data-stu-id="61ea0-204">Execute SQL Task Editor &#40;Result Set Page&#41;</span></span>](../execute-sql-task-editor-result-set-page.md)  
  
-   [<span data-ttu-id="61ea0-205">Страница «Выражения»</span><span class="sxs-lookup"><span data-stu-id="61ea0-205">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="61ea0-206">Дополнительные сведения об установке этих свойств в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] см. в следующем разделе:</span><span class="sxs-lookup"><span data-stu-id="61ea0-206">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="61ea0-207">Задание свойств задач или контейнеров</span><span class="sxs-lookup"><span data-stu-id="61ea0-207">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
## <a name="configuring-the-execute-sql-task-programmatically"></a><span data-ttu-id="61ea0-208">Программная настройка задачи «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="61ea0-208">Configuring the Execute SQL Task Programmatically</span></span>  
 <span data-ttu-id="61ea0-209">Дополнительные сведения об установке этих свойств программными средствами см. в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="61ea0-209">For more information about programmatically setting these properties, click the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask>  
  
## <a name="related-tasks"></a><span data-ttu-id="61ea0-210">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="61ea0-210">Related Tasks</span></span>  
  
-   [<span data-ttu-id="61ea0-211">Сопоставление параметров запроса с переменными в задаче «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="61ea0-211">Map Query Parameters to Variables in an Execute SQL Task</span></span>](../map-query-parameters-to-variables-in-an-execute-sql-task.md)  
  
-   [<span data-ttu-id="61ea0-212">Сопоставьте результирующие наборы с переменными в задаче «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="61ea0-212">Map Result Sets to Variables in an Execute SQL Task</span></span>](../map-result-sets-to-variables-in-an-execute-sql-task.md)  
  
## <a name="related-content"></a><span data-ttu-id="61ea0-213">См. также</span><span class="sxs-lookup"><span data-stu-id="61ea0-213">Related Content</span></span>  
  
-   [<span data-ttu-id="61ea0-214">Параметры и коды возврата в задаче «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="61ea0-214">Parameters and Return Codes in the Execute SQL Task</span></span>](execute-sql-task.md)  
  
-   [<span data-ttu-id="61ea0-215">Результирующие наборы в задаче "Выполнение SQL"</span><span class="sxs-lookup"><span data-stu-id="61ea0-215">Result Sets in the Execute SQL Task</span></span>](../result-sets-in-the-execute-sql-task.md)  
  
-   [<span data-ttu-id="61ea0-216">Справочник по Transact-SQL &#40;ядро СУБД&#41;</span><span class="sxs-lookup"><span data-stu-id="61ea0-216">Transact-SQL Reference &#40;Database Engine&#41;</span></span>](/sql/t-sql/language-reference)  
  
-   <span data-ttu-id="61ea0-217">Запись в блоге [Новые функции даты и времени в SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783)на сайте mssqltips.com</span><span class="sxs-lookup"><span data-stu-id="61ea0-217">Blog entry, [New Date and Time Functions in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), on mssqltips.com</span></span>  
  
  
