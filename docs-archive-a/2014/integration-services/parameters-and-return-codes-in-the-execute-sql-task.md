---
title: Параметры и коды возврата в задаче "Выполнение SQL" | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- return codes [Integration Services]
- parameters [Integration Services]
- parameterized SQL statements [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: a3ca65e8-65cf-4272-9a81-765a706b8663
author: chugugrace
ms.author: chugu
ms.openlocfilehash: cdc32e103642e086e81f6499bf56e5fbb71c3bd1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667800"
---
# <a name="parameters-and-return-codes-in-the-execute-sql-task"></a><span data-ttu-id="1d1c5-102">Параметры и коды возврата в задаче «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="1d1c5-102">Parameters and Return Codes in the Execute SQL Task</span></span>
  <span data-ttu-id="1d1c5-103">В инструкциях SQL и хранимых процедурах часто используются входные параметры `input`, выходные параметры `output` и коды возврата.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-103">SQL statements and stored procedures frequently use `input` parameters, `output` parameters, and return codes.</span></span> <span data-ttu-id="1d1c5-104">В службах [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] задача «Выполнение SQL» поддерживает типы параметров `Input`, `Output` и `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-104">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="1d1c5-105">Используйте тип `Input` для входных параметров, `Output` — для выходных и `ReturnValue` — для кодов возврата.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-105">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1d1c5-106">В задаче «Выполнение SQL» параметры могут использоваться, только если их поддерживает поставщик данных.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-106">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="1d1c5-107">Параметры команд SQL, включая запросы и хранимые процедуры, сопоставлены с пользовательскими переменными, созданными в области задачи «Выполнение SQL», в области родительского контейнера или в области пакета.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-107">Parameters in SQL commands, including queries and stored procedures, are mapped to user-defined variables that are created within the scope of the Execute SQL task, a parent container, or within the scope of the package.</span></span> <span data-ttu-id="1d1c5-108">Значения переменных можно задать во время разработки или динамически заполнить во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-108">The values of variables can be set at design time or populated dynamically at run time.</span></span> <span data-ttu-id="1d1c5-109">Также можно сопоставить параметры системным переменным.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-109">You can also map parameters to system variables.</span></span> <span data-ttu-id="1d1c5-110">Дополнительные сведения см. в разделах [Переменные в службах Integration Services (SSIS)](integration-services-ssis-variables.md) и [Системные переменные](system-variables.md).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-110">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="1d1c5-111">Однако для работы с параметрами и кодами возврата задачи «Выполнение SQL» необходимо знать больше, чем поддерживаемые задачей типы параметров и как сопоставлены эти параметры.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-111">However, working with parameters and return codes in an Execute SQL task is more than just knowing what parameter types the task supports and how these parameters will be mapped.</span></span> <span data-ttu-id="1d1c5-112">Существуют дополнительные требования и рекомендации для успешного использования параметров и кодов возврата в задаче «Выполнение SQL».</span><span class="sxs-lookup"><span data-stu-id="1d1c5-112">There are additional usage requirements and guidelines to successfully use parameters and return codes in the Execute SQL task.</span></span> <span data-ttu-id="1d1c5-113">В оставшейся части раздела приведены эти требования и рекомендации.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-113">The remainder of this topic covers these usage requirements and guidelines:</span></span>  
  
-   [<span data-ttu-id="1d1c5-114">Применение имен и маркеров параметров</span><span class="sxs-lookup"><span data-stu-id="1d1c5-114">Using parameters names and markers</span></span>](#Parameter_names_and_markers)  
  
-   [<span data-ttu-id="1d1c5-115">Использование параметров с типами данных даты и времени</span><span class="sxs-lookup"><span data-stu-id="1d1c5-115">Using parameters with date and time data types</span></span>](#Date_and_time_data_types)  
  
-   [<span data-ttu-id="1d1c5-116">Использование параметров в предложениях WHERE</span><span class="sxs-lookup"><span data-stu-id="1d1c5-116">Using parameters in WHERE clauses</span></span>](#WHERE_clauses)  
  
-   [<span data-ttu-id="1d1c5-117">Использование параметров с хранимыми процедурами</span><span class="sxs-lookup"><span data-stu-id="1d1c5-117">Using parameters with stored procedures</span></span>](#Stored_procedures)  
  
-   [<span data-ttu-id="1d1c5-118">Возвращение значений кодов возврата</span><span class="sxs-lookup"><span data-stu-id="1d1c5-118">Getting values of return codes</span></span>](#Return_codes)  
  
-   [<span data-ttu-id="1d1c5-119">Настройка параметров и кодов возврата в редакторе задачи «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="1d1c5-119">Configuring parameters and return codes in the Execute SQL Task Editor</span></span>](#Configure_parameters_and_return_codes)  
  
##  <a name="using-parameter-names-and-markers"></a><a name="Parameter_names_and_markers"></a><span data-ttu-id="1d1c5-120">Использование имен и маркеров параметров</span><span class="sxs-lookup"><span data-stu-id="1d1c5-120">Using Parameter Names and Markers</span></span>  
 <span data-ttu-id="1d1c5-121">В зависимости от типа соединения, который использует задача «Выполнение SQL», синтаксис команды SQL использует различные маркеры параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-121">Depending on the connection type that the Execute SQL task uses, the syntax of the SQL command uses different parameter markers.</span></span> <span data-ttu-id="1d1c5-122">Например, для типа диспетчера подключений [!INCLUDE[vstecado](../includes/vstecado-md.md)] требуется, чтобы команда SQL использовала маркер параметра в формате **\@varParameter**, в то время как для типа OLE DB требуется, чтобы в качестве маркера параметра использовался символ вопросительного знака (?).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-122">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type requires that the SQL command uses a parameter marker in the format **\@varParameter**, whereas OLE DB connection type requires the question mark (?) parameter marker.</span></span>  
  
 <span data-ttu-id="1d1c5-123">Имена, которые можно использовать как имена параметров в сопоставлениях между переменными и параметрами, также зависят от типа диспетчера соединений.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-123">The names that you can use as parameter names in the mappings between variables and parameters also vary by connection manager type.</span></span> <span data-ttu-id="1d1c5-124">Например, тип диспетчера подключений [!INCLUDE[vstecado](../includes/vstecado-md.md)] использует определенные пользователем имена, начинающиеся с префикса \@, в то время как для типа OLE DB требуется, чтобы в качестве имени параметра использовалось числовое значение (начинающееся с нуля).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-124">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type uses a user-defined name with a \@ prefix, whereas the OLE DB connection manager type requires that you use the numeric value of a 0-based ordinal as the parameter name.</span></span>  
  
 <span data-ttu-id="1d1c5-125">В следующей таблице подведен итог требованиям для команд SQL для различных типов диспетчеров соединений, которые может использовать задача «Выполнение SQL».</span><span class="sxs-lookup"><span data-stu-id="1d1c5-125">The following table summarizes the requirements for SQL commands for the connection manager types that the Execute SQL task can use.</span></span>  
  
|<span data-ttu-id="1d1c5-126">Тип соединений</span><span class="sxs-lookup"><span data-stu-id="1d1c5-126">Connection type</span></span>|<span data-ttu-id="1d1c5-127">Маркер параметра</span><span class="sxs-lookup"><span data-stu-id="1d1c5-127">Parameter marker</span></span>|<span data-ttu-id="1d1c5-128">Имя параметра</span><span class="sxs-lookup"><span data-stu-id="1d1c5-128">Parameter name</span></span>|<span data-ttu-id="1d1c5-129">Пример команды SQL</span><span class="sxs-lookup"><span data-stu-id="1d1c5-129">Example SQL command</span></span>|  
|---------------------|----------------------|--------------------|-------------------------|  
|<span data-ttu-id="1d1c5-130">ADO</span><span class="sxs-lookup"><span data-stu-id="1d1c5-130">ADO</span></span>|<span data-ttu-id="1d1c5-131">?</span><span class="sxs-lookup"><span data-stu-id="1d1c5-131">?</span></span>|<span data-ttu-id="1d1c5-132">Param1, Param2, …</span><span class="sxs-lookup"><span data-stu-id="1d1c5-132">Param1, Param2, ...</span></span>|<span data-ttu-id="1d1c5-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="1d1c5-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|\@\<parameter name>|\@\<parameter name>|<span data-ttu-id="1d1c5-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span><span class="sxs-lookup"><span data-stu-id="1d1c5-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span></span>|  
|<span data-ttu-id="1d1c5-135">ODBC</span><span class="sxs-lookup"><span data-stu-id="1d1c5-135">ODBC</span></span>|<span data-ttu-id="1d1c5-136">?</span><span class="sxs-lookup"><span data-stu-id="1d1c5-136">?</span></span>|<span data-ttu-id="1d1c5-137">1, 2, 3, ...</span><span class="sxs-lookup"><span data-stu-id="1d1c5-137">1, 2, 3, ...</span></span>|<span data-ttu-id="1d1c5-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="1d1c5-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|<span data-ttu-id="1d1c5-139">EXCEL и OLE DB</span><span class="sxs-lookup"><span data-stu-id="1d1c5-139">EXCEL and OLE DB</span></span>|<span data-ttu-id="1d1c5-140">?</span><span class="sxs-lookup"><span data-stu-id="1d1c5-140">?</span></span>|<span data-ttu-id="1d1c5-141">0, 1, 2, 3, ...</span><span class="sxs-lookup"><span data-stu-id="1d1c5-141">0, 1, 2, 3, ...</span></span>|<span data-ttu-id="1d1c5-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="1d1c5-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
  
### <a name="using-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="1d1c5-143">Использование параметров с ADO.NET и диспетчерами соединений ADO</span><span class="sxs-lookup"><span data-stu-id="1d1c5-143">Using Parameters with ADO.NET and ADO Connection Managers</span></span>  
 <span data-ttu-id="1d1c5-144">Диспетчеры подключений [!INCLUDE[vstecado](../includes/vstecado-md.md)] и ADO предъявляют особые требования к командам SQL, использующим параметры:</span><span class="sxs-lookup"><span data-stu-id="1d1c5-144">[!INCLUDE[vstecado](../includes/vstecado-md.md)] and ADO connection managers have specific requirements for SQL commands that use parameters:</span></span>  
  
-   <span data-ttu-id="1d1c5-145">Диспетчер соединений [!INCLUDE[vstecado](../includes/vstecado-md.md)] требует, чтобы команда SQL использовала имена параметров в качестве маркеров параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-145">[!INCLUDE[vstecado](../includes/vstecado-md.md)] connection managers require that the SQL command use parameter names as parameter markers.</span></span> <span data-ttu-id="1d1c5-146">Это означает, что переменные могут быть прямо сопоставлены с параметрами.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-146">This means that variables can be mapped directly to parameters.</span></span> <span data-ttu-id="1d1c5-147">Например, переменная `@varName` сопоставляется с параметром по имени `@parName` и предоставляет значение параметру `@parName`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-147">For example, the variable `@varName` is mapped to the parameter named `@parName` and provides a value to the parameter `@parName`.</span></span>  
  
-   <span data-ttu-id="1d1c5-148">Диспетчеры соединений ADO требуют, чтобы в команде SQL в качестве маркеров параметров использовались вопросительные знаки (?).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-148">ADO connection managers require that the SQL command use question marks (?) as parameter markers.</span></span> <span data-ttu-id="1d1c5-149">Однако в качестве имен параметров можно использовать любые имена, за исключением целых чисел.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-149">However, you can use any user-defined name, except for integer values, as parameter names.</span></span>  
  
 <span data-ttu-id="1d1c5-150">Чтобы предоставить параметрам значения, переменные сопоставляются с именами параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-150">To provide values to parameters, variables are mapped to parameter names.</span></span> <span data-ttu-id="1d1c5-151">Затем задача «Выполнение SQL» использует для загрузки значений из переменных параметры значения порядкового номера имени параметра в списке параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-151">Then, the Execute SQL task uses the ordinal value of the parameter name in the parameter list to load values from variables to parameters.</span></span>  
  
### <a name="using-parameters-with-excel-odbc-and-ole-db-connection-managers"></a><span data-ttu-id="1d1c5-152">Использование параметров с диспетчерами соединений EXCEL, ODBC и OLE DB</span><span class="sxs-lookup"><span data-stu-id="1d1c5-152">Using Parameters with EXCEL, ODBC, and OLE DB Connection Managers</span></span>  
 <span data-ttu-id="1d1c5-153">Диспетчеры соединений EXCEL, ODBC и OLE DB требуют, чтобы команды SQL использовали символы знака вопроса (?) в качестве маркеров параметров и числовые значения (начиная с нуля или с единицы) в качестве имен параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-153">EXCEL, ODBC, and OLE DB connection managers require that the SQL command use question marks (?) as parameter markers and 0-based or 1-based numeric values as parameter names.</span></span> <span data-ttu-id="1d1c5-154">Если задача «Выполнение SQL» использует диспетчер соединений ODBC, то именем параметра, сопоставляемым первому параметру в запросе, является 1. В противном случае именем параметра будет 0.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-154">If the Execute SQL task uses the ODBC connection manager, the parameter name that maps to the first parameter in the query is named 1; otherwise, the parameter is named 0.</span></span> <span data-ttu-id="1d1c5-155">Для последующих параметров числовое значение имени параметра указывает на параметр в команде SQL, которому сопоставлено это имя параметра.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-155">For subsequent parameters, the numeric value of the parameter name indicates the parameter in the SQL command that the parameter name maps to.</span></span> <span data-ttu-id="1d1c5-156">Например, параметр под именем 3 сопоставлен с третьим параметром, который представляется третьим знаком вопроса (?) в команде SQL.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-156">For example, the parameter named 3 maps to the third parameter, which is represented by the third question mark (?) in the SQL command.</span></span>  
  
 <span data-ttu-id="1d1c5-157">Чтобы предоставить параметрам значения, переменные сопоставляются с именами параметров и задача «Выполнение SQL» использует порядковое значение имени параметра для загрузки значения из переменных в параметры.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-157">To provide values to parameters, variables are mapped to parameter names and the Execute SQL task uses the ordinal value of the parameter name to load values from variables to parameters.</span></span>  
  
 <span data-ttu-id="1d1c5-158">В зависимости от поставщика, который используют диспетчеры соединений, некоторые типы данных OLE DB могут не поддерживаться.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-158">Depending on the provider that the connection manager uses, some OLE DB data types may not be supported.</span></span> <span data-ttu-id="1d1c5-159">Например, драйвер Excel распознает только ограниченный набор типов данных.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-159">For example, the Excel driver recognizes only a limited set of data types.</span></span> <span data-ttu-id="1d1c5-160">Дополнительные сведения о поведении поставщика Jet с драйвером Excel см. в разделе [Excel Source](data-flow/excel-source.md).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-160">For more information about the behavior of the Jet provider with the Excel driver, see [Excel Source](data-flow/excel-source.md).</span></span>  
  
#### <a name="using-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="1d1c5-161">Использование параметров с диспетчерами соединений OLE DB</span><span class="sxs-lookup"><span data-stu-id="1d1c5-161">Using Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="1d1c5-162">Если в задаче "Выполнение SQL" используется диспетчер соединений OLE DB, становится доступным свойство BypassPrepare задачи.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-162">When the Execute SQL task uses the OLE DB connection manager, the BypassPrepare property of the task is available.</span></span> <span data-ttu-id="1d1c5-163">Этому свойству необходимо присвоить значение `true`, если задача «Выполнение SQL» использует инструкции SQL с параметрами.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-163">You should set this property to `true` if the Execute SQL task uses SQL statements with parameters.</span></span>  
  
 <span data-ttu-id="1d1c5-164">При использовании диспетчера соединений OLE DB нельзя применять параметризованные вложенные запросы, поскольку в задаче «Выполнение SQL» нельзя получить путем анализа информацию о параметрах через поставщик OLE DB.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-164">When you use an OLE DB connection manager, you cannot use parameterized subqueries because the Execute SQL Task cannot derive parameter information through the OLE DB provider.</span></span> <span data-ttu-id="1d1c5-165">Однако можно использовать выражение, чтобы объединить значения параметров в строку запроса и задать свойство SqlStatementSource этой задачи.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-165">However, you can use an expression to concatenate the parameter values into the query string and to set the SqlStatementSource property of the task.</span></span>  
  
##  <a name="using-parameters-with-date-and-time-data-types"></a><a name="Date_and_time_data_types"></a><span data-ttu-id="1d1c5-166">Использование параметров с типами данных даты и времени</span><span class="sxs-lookup"><span data-stu-id="1d1c5-166">Using Parameters with Date and Time Data Types</span></span>  
  
### <a name="using-date-and-time-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="1d1c5-167">Использование параметров даты и времени с ADO.NET и диспетчерами соединений ADO</span><span class="sxs-lookup"><span data-stu-id="1d1c5-167">Using Date and Time Parameters with ADO.NET and ADO Connection Managers</span></span>  
 <span data-ttu-id="1d1c5-168">При считывании данных типов [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]`time` и `datetimeoffset` задача «Выполнение SQL», которая использует диспетчер соединений [!INCLUDE[vstecado](../includes/vstecado-md.md)] или ADO, имеет следующие дополнительные требования.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-168">When reading data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] types, `time` and `datetimeoffset`, an Execute SQL task that uses either an [!INCLUDE[vstecado](../includes/vstecado-md.md)] or ADO connection manager has the following additional requirements:</span></span>  
  
-   <span data-ttu-id="1d1c5-169">Для `time` данных [!INCLUDE[vstecado](../includes/vstecado-md.md)] Диспетчер соединений требует, чтобы эти данные хранились в параметре, тип параметра которого — `Input` или `Output` , а тип данных — `string` .</span><span class="sxs-lookup"><span data-stu-id="1d1c5-169">For `time` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `string`.</span></span>  
  
-   <span data-ttu-id="1d1c5-170">Для данных типа `datetimeoffset` диспетчер соединений [!INCLUDE[vstecado](../includes/vstecado-md.md)] требует, чтобы они хранились в одном из следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-170">For `datetimeoffset` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="1d1c5-171">Параметр типа `Input` имеет тип данных `string`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-171">A parameter whose parameter type is `Input` and whose data type is `string`.</span></span>  
  
    -   <span data-ttu-id="1d1c5-172">Параметр типа `Output` или `ReturnValue` имеет тип данных `datetimeoffset`, `string` или `datetime2`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-172">A parameter whose parameter type is `Output` or `ReturnValue`, and whose data type is `datetimeoffset`, `string`, or `datetime2`.</span></span> <span data-ttu-id="1d1c5-173">Если выбран параметр с типом данных `string` или `datetime2`, то службы [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] преобразуют данные в тип string или datetime2.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-173">If you select a parameter whose data type is either `string` or `datetime2`, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] converts the data to either string or datetime2.</span></span>  
  
-   <span data-ttu-id="1d1c5-174">Диспетчер соединений ADO требует, чтобы данные `time` или `datetimeoffset` хранились в параметре типа `Input` или `Output`, имеющем тип данных `adVarWchar`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-174">An ADO connection manager requires that either `time` or `datetimeoffset` data be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `adVarWchar`.</span></span>  
  
 <span data-ttu-id="1d1c5-175">Дополнительные сведения о типах данных [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] и их сопоставлении с типами данных [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] см. в разделе [Типы данных (Transact-SQL)](/sql/t-sql/data-types/data-types-transact-sql) и [Типы данных службы Integration Services](data-flow/integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-175">For more information about [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types and how they map to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) and [Integration Services Data Types](data-flow/integration-services-data-types.md).</span></span>  
  
### <a name="using-date-and-time-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="1d1c5-176">Использование параметров даты и времени с диспетчерами соединений OLE DB</span><span class="sxs-lookup"><span data-stu-id="1d1c5-176">Using Date and Time Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="1d1c5-177">При использовании диспетчера соединений OLE DB задача «Выполнение SQL» имеет особые требования по хранению данных типа данных [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]: `date`, `time`, `datetime`, `datetime2` и `datetimeoffset`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-177">When using an OLE DB connection manager, an Execute SQL task has specific storage requirements for data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, and `datetimeoffset`.</span></span> <span data-ttu-id="1d1c5-178">Эти данные необходимо хранить в параметре одного из следующих типов.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-178">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="1d1c5-179">Входной параметр типа данных NVARCHAR.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-179">An input parameter of the NVARCHAR data type.</span></span>  
  
-   <span data-ttu-id="1d1c5-180">Выходной параметр соответствующего типа данных, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-180">An output parameter of with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="1d1c5-181">Тип параметра `Output`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-181">`Output` parameter type</span></span>|<span data-ttu-id="1d1c5-182">Тип данных «date»</span><span class="sxs-lookup"><span data-stu-id="1d1c5-182">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="1d1c5-183">DBDATE</span><span class="sxs-lookup"><span data-stu-id="1d1c5-183">DBDATE</span></span>|`date`|  
    |<span data-ttu-id="1d1c5-184">DBTIME2</span><span class="sxs-lookup"><span data-stu-id="1d1c5-184">DBTIME2</span></span>|`time`|  
    |<span data-ttu-id="1d1c5-185">DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="1d1c5-185">DBTIMESTAMP</span></span>|<span data-ttu-id="1d1c5-186">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-186">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="1d1c5-187">DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="1d1c5-187">DBTIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="1d1c5-188">Если данные не хранятся в соответствующем входном или выходном параметре, выполнение пакета завершается с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-188">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
### <a name="using-date-and-time-parameters-with-odbc-connection-managers"></a><span data-ttu-id="1d1c5-189">Использование параметров даты и времени с диспетчерами соединений ODBC</span><span class="sxs-lookup"><span data-stu-id="1d1c5-189">Using Date and Time Parameters with ODBC Connection Managers</span></span>  
 <span data-ttu-id="1d1c5-190">При использовании диспетчера соединений ODBC задача «Выполнение SQL» имеет особые требования по хранению данных одного из следующих типов данных [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]: `date`, `time`, `datetime`, `datetime2` и `datetimeoffset`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-190">When using an ODBC connection manager, an Execute SQL task has specific storage requirements for data with one of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, or `datetimeoffset`.</span></span> <span data-ttu-id="1d1c5-191">Эти данные необходимо хранить в параметре одного из следующих типов.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-191">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="1d1c5-192">Входной параметр `input` типа данных SQL_WVARCHAR.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-192">An `input` parameter of the SQL_WVARCHAR data type</span></span>  
  
-   <span data-ttu-id="1d1c5-193">Выходной параметр `output` соответствующего типа данных, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-193">An `output` parameter with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="1d1c5-194">Тип параметра `Output`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-194">`Output` parameter type</span></span>|<span data-ttu-id="1d1c5-195">Тип данных «date»</span><span class="sxs-lookup"><span data-stu-id="1d1c5-195">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="1d1c5-196">SQL_DATE</span><span class="sxs-lookup"><span data-stu-id="1d1c5-196">SQL_DATE</span></span>|`date`|  
    |<span data-ttu-id="1d1c5-197">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="1d1c5-197">SQL_SS_TIME2</span></span>|`time`|  
    |<span data-ttu-id="1d1c5-198">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="1d1c5-198">SQL_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="1d1c5-199">-или-</span><span class="sxs-lookup"><span data-stu-id="1d1c5-199">-or-</span></span><br /><br /> <span data-ttu-id="1d1c5-200">SQL_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="1d1c5-200">SQL_TIMESTAMP</span></span>|<span data-ttu-id="1d1c5-201">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-201">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="1d1c5-202">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="1d1c5-202">SQL_SS_TIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="1d1c5-203">Если данные не хранятся в соответствующем входном или выходном параметре, выполнение пакета завершается с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-203">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
##  <a name="using-parameters-in-where-clauses"></a><a name="WHERE_clauses"></a><span data-ttu-id="1d1c5-204">Использование параметров в предложениях WHERE</span><span class="sxs-lookup"><span data-stu-id="1d1c5-204">Using Parameters in WHERE Clauses</span></span>  
 <span data-ttu-id="1d1c5-205">Команды SELECT, INSERT, UPDATE и DELETE часто включают в себя предложение WHERE для задания фильтров, которые определяют условия, которым должна удовлетворять каждая строка в исходной таблице, чтобы попасть под действие команды SQL.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-205">SELECT, INSERT, UPDATE, and DELETE commands frequently include WHERE clauses to specify filters that define the conditions each row in the source tables must meet to qualify for an SQL command.</span></span> <span data-ttu-id="1d1c5-206">Параметры предоставляют значения фильтра в предложениях WHERE.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-206">Parameters provide the filter values in the WHERE clauses.</span></span>  
  
 <span data-ttu-id="1d1c5-207">Можно использовать маркеры параметров для динамического предоставления значений параметрам.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-207">You can use parameter markers to dynamically provide parameter values.</span></span> <span data-ttu-id="1d1c5-208">Правила для каждого маркера параметра и имени параметра, которые могут быть использованы в инструкции SQL, зависят от типа диспетчера соединений, который используется задачей «Выполнение SQL».</span><span class="sxs-lookup"><span data-stu-id="1d1c5-208">The rules for which parameter markers and parameter names can be used in the SQL statement depend on the type of connection manager that the Execute SQL uses.</span></span>  
  
 <span data-ttu-id="1d1c5-209">В следующей таблице приведен список примеров команды SELECT для разных типов диспетчеров соединений.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-209">The following table lists examples of the SELECT command by connection manager type.</span></span> <span data-ttu-id="1d1c5-210">Те же самые правила относятся и к инструкциям INSERT, UPDATE и DELETE.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-210">The INSERT, UPDATE, and DELETE statements are similar.</span></span> <span data-ttu-id="1d1c5-211">В примерах инструкции SELECT возвращают из таблицы **Product** базы данных [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] продукты, для которых значение **ProductID** больше и меньше значений, указанных двумя параметрами.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-211">The examples use SELECT to return products from the **Product** table in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] that have a **ProductID** greater than and less than the values specified by two parameters.</span></span>  
  
|<span data-ttu-id="1d1c5-212">Тип соединений</span><span class="sxs-lookup"><span data-stu-id="1d1c5-212">Connection type</span></span>|<span data-ttu-id="1d1c5-213">Синтаксис SELECT</span><span class="sxs-lookup"><span data-stu-id="1d1c5-213">SELECT syntax</span></span>|  
|---------------------|-------------------|  
|<span data-ttu-id="1d1c5-214">EXCEL, ODBC и OLEDB</span><span class="sxs-lookup"><span data-stu-id="1d1c5-214">EXCEL, ODBC, and OLEDB</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|<span data-ttu-id="1d1c5-215">ADO</span><span class="sxs-lookup"><span data-stu-id="1d1c5-215">ADO</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|`SELECT* FROM Production.Product WHERE ProductId > @parmMinProductID AND ProductID < @parmMaxProductID`|  
  
 <span data-ttu-id="1d1c5-216">Для примеров необходимы параметры со следующими именами.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-216">The examples would require parameters that have the following names:</span></span>  
  
-   <span data-ttu-id="1d1c5-217">Диспетчеры соединений EXCEL и OLED DB используют параметры с именами 0 и 1.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-217">The EXCEL and OLED DB connection managers use the parameter names 0 and 1.</span></span> <span data-ttu-id="1d1c5-218">Для типа соединения ODBC понадобятся параметры с именами 1 и 2.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-218">The ODBC connection type uses 1 and 2.</span></span>  
  
-   <span data-ttu-id="1d1c5-219">Для типа соединения ADO можно использовать любые два имени параметра, такие как Param1 и Param2, но эти параметры должны быть сопоставлены со своими порядковыми номерами в списке параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-219">The ADO connection type could use any two parameter names, such as Param1 and Param2, but the parameters must be mapped by their ordinal position in the parameter list.</span></span>  
  
-   <span data-ttu-id="1d1c5-220">Для типа соединения [!INCLUDE[vstecado](../includes/vstecado-md.md)] используются имена параметров \@parmMinProductID и \@parmMaxProductID.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-220">The [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection type uses the parameter names \@parmMinProductID and \@parmMaxProductID.</span></span>  
  
##  <a name="using-parameters-with-stored-procedures"></a><a name="Stored_procedures"></a><span data-ttu-id="1d1c5-221">Использование параметров с хранимыми процедурами</span><span class="sxs-lookup"><span data-stu-id="1d1c5-221">Using Parameters with Stored Procedures</span></span>  
 <span data-ttu-id="1d1c5-222">В командах SQL, выполняющих хранимые процедуры, тоже может использоваться сопоставление параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-222">SQL commands that run stored procedures can also use parameter mapping.</span></span> <span data-ttu-id="1d1c5-223">Правила использования маркеров и имен параметров зависят от типа диспетчера соединений, который используется задачей «Выполнение SQL», точно так же, как и правила для параметризованных запросов.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-223">The rules for how to use parameter markers and parameter names depends on the type of connection manager that the Execute SQL uses, just like the rules for parameterized queries.</span></span>  
  
 <span data-ttu-id="1d1c5-224">В следующей таблице приведен список примеров команды EXEC для разных типов диспетчеров соединений.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-224">The following table lists examples of the EXEC command by connection manager type.</span></span> <span data-ttu-id="1d1c5-225">Примеры выполняют хранимую процедуру **uspGetBillOfMaterials** в базе данных [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1d1c5-225">The examples run the **uspGetBillOfMaterials** stored procedure in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)].</span></span> <span data-ttu-id="1d1c5-226">Хранимая процедура использует `@StartProductID` Параметры и `@CheckDate` `input` .</span><span class="sxs-lookup"><span data-stu-id="1d1c5-226">The stored procedure uses the `@StartProductID` and `@CheckDate` `input` parameters.</span></span>  
  
|<span data-ttu-id="1d1c5-227">Тип соединений</span><span class="sxs-lookup"><span data-stu-id="1d1c5-227">Connection type</span></span>|<span data-ttu-id="1d1c5-228">Синтаксис EXEC</span><span class="sxs-lookup"><span data-stu-id="1d1c5-228">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="1d1c5-229">EXCEL и OLEDB</span><span class="sxs-lookup"><span data-stu-id="1d1c5-229">EXCEL and OLEDB</span></span>|`EXEC uspGetBillOfMaterials ?, ?`|  
|<span data-ttu-id="1d1c5-230">ODBC</span><span class="sxs-lookup"><span data-stu-id="1d1c5-230">ODBC</span></span>|`{call uspGetBillOfMaterials(?, ?)}`<br /><br /> <span data-ttu-id="1d1c5-231">Дополнительные сведения о синтаксисе вызова ODBC см. в разделе [Параметры процедур](https://go.microsoft.com/fwlink/?LinkId=89462)справочника по программированию ODBC в библиотеке MSDN.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-231">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="1d1c5-232">ADO</span><span class="sxs-lookup"><span data-stu-id="1d1c5-232">ADO</span></span>|<span data-ttu-id="1d1c5-233">Если для для параметра isquerystoredprocedure задано значение `False` ,`EXEC uspGetBillOfMaterials ?, ?`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-233">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials ?, ?`</span></span><br /><br /> <span data-ttu-id="1d1c5-234">Если для для параметра isquerystoredprocedure задано значение `True` ,`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-234">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="1d1c5-235">Если для для параметра isquerystoredprocedure задано значение `False` ,`EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-235">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span></span><br /><br /> <span data-ttu-id="1d1c5-236">Если для для параметра isquerystoredprocedure задано значение `True` ,`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-236">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
  
 <span data-ttu-id="1d1c5-237">Чтобы использовать выходные параметры, синтаксис требует, чтобы ключевое слово OUTPUT следовало за каждым маркером параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-237">To use output parameters, the syntax requires that the OUTPUT keyword follow each parameter marker.</span></span> <span data-ttu-id="1d1c5-238">Например, следующий синтаксис выходного параметра является верным: `EXEC myStoredProcedure ? OUTPUT`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-238">For example, the following output parameter syntax is correct: `EXEC myStoredProcedure ? OUTPUT`.</span></span>  
  
 <span data-ttu-id="1d1c5-239">Дополнительные сведения об использовании входных и выходных параметров с хранимыми процедурами Transact-SQL см. в разделе [EXECUTE (Transact-SQL)](/sql/t-sql/language-elements/execute-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-239">For more information about using input and output parameters with Transact-SQL stored procedures, see [EXECUTE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/execute-transact-sql).</span></span>  
  
##  <a name="getting-values-of-return-codes"></a><a name="Return_codes"></a><span data-ttu-id="1d1c5-240">Получение значений кодов возврата</span><span class="sxs-lookup"><span data-stu-id="1d1c5-240">Getting Values of Return Codes</span></span>  
 <span data-ttu-id="1d1c5-241">Хранимая процедура может возвращать целочисленное значение, называемое кодом возврата, чтобы указать состояние выполнения процедуры.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-241">A stored procedure can return an integer value, called a return code, to indicate the execution status of a procedure.</span></span> <span data-ttu-id="1d1c5-242">Чтобы реализовать коды возврата в задаче «Выполнение SQL», используйте параметры типа `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-242">To implement return codes in the Execute SQL task, you use parameters of the `ReturnValue` type.</span></span>  
  
 <span data-ttu-id="1d1c5-243">В следующей таблице приведен список типов соединений с примерами команды EXEC, которая реализует коды возврата.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-243">The following table lists by connection type some examples of EXEC commands that implement return codes.</span></span> <span data-ttu-id="1d1c5-244">Все примеры используют входной параметр `input`.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-244">All examples use an `input` parameter.</span></span> <span data-ttu-id="1d1c5-245">Правила использования маркеров параметров и имен параметров одинаковы для всех типов параметров — `Input` , `Output` и `ReturnValue` .</span><span class="sxs-lookup"><span data-stu-id="1d1c5-245">The rules for how to use parameter markers and parameter names are the same for all parameter types-`Input`, `Output`, and `ReturnValue`.</span></span>  
  
 <span data-ttu-id="1d1c5-246">Некоторые типы синтаксиса не поддерживают литералы параметров.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-246">Some syntax does not support parameter literals.</span></span> <span data-ttu-id="1d1c5-247">В этом случае необходимо предоставить значение параметра с помощью переменной.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-247">In that case, you must provide the parameter value by using a variable.</span></span>  
  
|<span data-ttu-id="1d1c5-248">Тип соединений</span><span class="sxs-lookup"><span data-stu-id="1d1c5-248">Connection type</span></span>|<span data-ttu-id="1d1c5-249">Синтаксис EXEC</span><span class="sxs-lookup"><span data-stu-id="1d1c5-249">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="1d1c5-250">EXCEL и OLEDB</span><span class="sxs-lookup"><span data-stu-id="1d1c5-250">EXCEL and OLEDB</span></span>|`EXEC ? = myStoredProcedure 1`|  
|<span data-ttu-id="1d1c5-251">ODBC</span><span class="sxs-lookup"><span data-stu-id="1d1c5-251">ODBC</span></span>|`{? = call myStoredProcedure(1)}`<br /><br /> <span data-ttu-id="1d1c5-252">Дополнительные сведения о синтаксисе вызова ODBC см. в разделе [Параметры процедур](https://go.microsoft.com/fwlink/?LinkId=89462)справочника по программированию ODBC в библиотеке MSDN.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-252">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="1d1c5-253">ADO</span><span class="sxs-lookup"><span data-stu-id="1d1c5-253">ADO</span></span>|<span data-ttu-id="1d1c5-254">Если для для параметра isquerystoreprocedure задано значение `False` ,`EXEC ? = myStoredProcedure 1`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-254">If IsQueryStoreProcedure is set to `False`, `EXEC ? = myStoredProcedure 1`</span></span><br /><br /> <span data-ttu-id="1d1c5-255">Если для для параметра isquerystoreprocedure задано значение `True` ,`myStoredProcedure`</span><span class="sxs-lookup"><span data-stu-id="1d1c5-255">If IsQueryStoreProcedure is set to `True`, `myStoredProcedure`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="1d1c5-256">Для параметра Set для параметра isquerystoreprocedure задано значение `True` .</span><span class="sxs-lookup"><span data-stu-id="1d1c5-256">Set IsQueryStoreProcedure is set to `True`.</span></span><br /><br /> `myStoredProcedure`|  
  
 <span data-ttu-id="1d1c5-257">В описании синтаксиса, показанном в предыдущей таблице, задача «Выполнение SQL» использует для запуска хранимой процедуры тип источника **Прямой ввод** .</span><span class="sxs-lookup"><span data-stu-id="1d1c5-257">In the syntax shown in the previous table, the Execute SQL task uses the **Direct Input** source type to run the stored procedure.</span></span> <span data-ttu-id="1d1c5-258">Задача «Выполнение SQL» может также пользоваться для выполнения хранимой процедуры типом источника **Соединение с файлом** .</span><span class="sxs-lookup"><span data-stu-id="1d1c5-258">The Execute SQL task can also use the **File Connection** source type to run a stored procedure.</span></span> <span data-ttu-id="1d1c5-259">Независимо от того, использует ли задача «Выполнение SQL» тип источника « **прямой вход** » или « **соединение с файлом** », используйте параметр `ReturnValue` типа для реализации кода возврата.</span><span class="sxs-lookup"><span data-stu-id="1d1c5-259">Regardless of whether the Execute SQL task uses the **Direct Input** or **File Connection** source type, use a parameter of the `ReturnValue` type to implement the return code.</span></span> <span data-ttu-id="1d1c5-260">Дополнительные сведения о настройке типа источника для инструкции SQL, выполняемой задачей "Выполнение SQL", см. в разделе [Редактор задачи "Выполнение SQL" (страница "Общие")](general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-260">For more information about how to configure the source type of the SQL statement that the Execute SQL task runs, see [Execute SQL Task Editor &#40;General Page&#41;](general-page-of-integration-services-designers-options.md).</span></span>  
  
 <span data-ttu-id="1d1c5-261">Дополнительные сведения об использовании кодов возврата с хранимыми процедурами Transact-SQL см. в разделе [RETURN (Transact-SQL)](/sql/t-sql/language-elements/return-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="1d1c5-261">For more information about using return codes with Transact-SQL stored procedures, see [RETURN &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/return-transact-sql).</span></span>  
  
##  <a name="configuring-parameters-and-return-codes-in-the-execute-sql-task"></a><a name="Configure_parameters_and_return_codes"></a><span data-ttu-id="1d1c5-262">Настройка параметров и кодов возврата в задаче «Выполнение SQL»</span><span class="sxs-lookup"><span data-stu-id="1d1c5-262">Configuring Parameters and Return Codes in the Execute SQL Task</span></span>  
 <span data-ttu-id="1d1c5-263">Дополнительные сведения о свойствах параметров и кодов возврата, которые можно задать в конструкторе служб [!INCLUDE[ssIS](../includes/ssis-md.md)] , см. в следующем разделе:</span><span class="sxs-lookup"><span data-stu-id="1d1c5-263">For more information about the properties of parameters and return codes that you can set in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="1d1c5-264">Редактор задачи "Выполнение SQL" &#40;страница "Сопоставление параметров"&#41;</span><span class="sxs-lookup"><span data-stu-id="1d1c5-264">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../../2014/integration-services/execute-sql-task-editor-parameter-mapping-page.md)  
  
 <span data-ttu-id="1d1c5-265">Дополнительные сведения об установке этих свойств в конструкторе служб [!INCLUDE[ssIS](../includes/ssis-md.md)] см. в следующем разделе:</span><span class="sxs-lookup"><span data-stu-id="1d1c5-265">For more information about how to set these properties in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="1d1c5-266">Задание свойств задач или контейнеров</span><span class="sxs-lookup"><span data-stu-id="1d1c5-266">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="1d1c5-267">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="1d1c5-267">Related Tasks</span></span>  
 [<span data-ttu-id="1d1c5-268">Задание свойств задач или контейнеров</span><span class="sxs-lookup"><span data-stu-id="1d1c5-268">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-content"></a><span data-ttu-id="1d1c5-269">См. также</span><span class="sxs-lookup"><span data-stu-id="1d1c5-269">Related Content</span></span>  
  
-   <span data-ttu-id="1d1c5-270">Запись в блоге, [Хранимые процедуры с выходными параметрами](https://go.microsoft.com/fwlink/?LinkId=157786), на сайте blogs.msdn.com</span><span class="sxs-lookup"><span data-stu-id="1d1c5-270">Blog entry, [Stored procedures with output parameters](https://go.microsoft.com/fwlink/?LinkId=157786), on blogs.msdn.com</span></span>  
  
-   <span data-ttu-id="1d1c5-271">Образец CodePlex, [Параметры задачи «Выполнение SQL» и результирующие наборы](https://go.microsoft.com/fwlink/?LinkId=157863), на сайте msftisprodsamples.codeplex.com</span><span class="sxs-lookup"><span data-stu-id="1d1c5-271">CodePlex sample, [Execute SQL Parameters and Result Sets](https://go.microsoft.com/fwlink/?LinkId=157863), on msftisprodsamples.codeplex.com</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1d1c5-272">См. также:</span><span class="sxs-lookup"><span data-stu-id="1d1c5-272">See Also</span></span>  
 <span data-ttu-id="1d1c5-273">[Задача «Выполнение SQL»](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="1d1c5-273">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 [<span data-ttu-id="1d1c5-274">Результирующие наборы в задаче "Выполнение SQL"</span><span class="sxs-lookup"><span data-stu-id="1d1c5-274">Result Sets in the Execute SQL Task</span></span>](../../2014/integration-services/result-sets-in-the-execute-sql-task.md)  
  
  
