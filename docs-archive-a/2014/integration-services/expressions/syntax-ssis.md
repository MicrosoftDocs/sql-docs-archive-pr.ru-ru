---
title: Синтаксис (службы SSIS) | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- expressions [Integration Services], syntax
- syntax [Integration Services]
ms.assetid: 61c053c5-1182-4ad0-b804-51cbd19aa0ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d7be12ee5e0467e3789fbe2771d881d9ae3f25f3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87732777"
---
# <a name="syntax-ssis"></a><span data-ttu-id="64ae7-102">Синтаксис (службы SSIS)</span><span class="sxs-lookup"><span data-stu-id="64ae7-102">Syntax (SSIS)</span></span>
  <span data-ttu-id="64ae7-103">Синтаксис выражений служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] похож на синтаксис языков C и C#.</span><span class="sxs-lookup"><span data-stu-id="64ae7-103">The [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] expression syntax is similar to the syntax that the C and C# languages use.</span></span> <span data-ttu-id="64ae7-104">Выражения содержат элементы, такие как идентификаторы (столбцы и переменные), литералы, операторы и функции.</span><span class="sxs-lookup"><span data-stu-id="64ae7-104">Expressions include elements such as identifiers (columns and variables), literals, operators, and functions.</span></span> <span data-ttu-id="64ae7-105">В этом разделе обобщаются особые требования синтаксиса средства оценки выражений с точки зрения различных элементов выражений.</span><span class="sxs-lookup"><span data-stu-id="64ae7-105">This topic summarizes the unique requirements of the expression evaluator syntax as they apply to different expression elements.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="64ae7-106">В предыдущих выпусках служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]действовало ограничение в 4000 символов на результат вычисления выражения, если результат имел тип данных служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] DT_WSTR или DT_STR.</span><span class="sxs-lookup"><span data-stu-id="64ae7-106">In previous releases of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], there was a 4000-character limit on the evaluation result of an expression when the result had the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] data type DT_WSTR or DT_STR.</span></span> <span data-ttu-id="64ae7-107">Это ограничение снято.</span><span class="sxs-lookup"><span data-stu-id="64ae7-107">This limit has been removed.</span></span>  
  
 <span data-ttu-id="64ae7-108">Образцы выражений, использующих специальные операторы и функции, см. в разделах, посвященных соответствующим операторам и функциям: [Операторы (выражение служб SSIS)](operators-ssis-expression.md) и [Функции (выражение служб SSIS)](functions-ssis-expression.md).</span><span class="sxs-lookup"><span data-stu-id="64ae7-108">For sample expressions that use specific operators and functions, see the topic about each operator and function in the topics: [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md) and [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
 <span data-ttu-id="64ae7-109">Образцы выражений, использующих несколько операторов и функций так же, как идентификаторы и литералы, см. в разделе [Примеры расширенных выражений служб Integration Services](examples-of-advanced-integration-services-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="64ae7-109">For sample expressions that use multiple operators and functions as well as identifiers and literals, see [Examples of Advanced Integration Services Expressions](examples-of-advanced-integration-services-expressions.md).</span></span>  
  
 <span data-ttu-id="64ae7-110">Образец использования выражений свойств см. в разделе [Использование выражений свойств в пакетах](use-property-expressions-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="64ae7-110">For sample expressions to use in property expressions, see [Use Property Expressions in Packages](use-property-expressions-in-packages.md).</span></span>  
  
## <a name="identifiers"></a><span data-ttu-id="64ae7-111">Идентификаторы</span><span class="sxs-lookup"><span data-stu-id="64ae7-111">Identifiers</span></span>  
 <span data-ttu-id="64ae7-112">Выражения могут содержать идентификаторы столбцов и переменных.</span><span class="sxs-lookup"><span data-stu-id="64ae7-112">Expressions can include column and variable identifiers.</span></span> <span data-ttu-id="64ae7-113">Столбцы могут переноситься из источника данных или создаваться с помощью преобразований в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="64ae7-113">The columns can originate in the data source or can be created by transformations in the data flow.</span></span> <span data-ttu-id="64ae7-114">Чтобы обращаться к столбцам, в выражениях могут быть использованы идентификаторы журнала обращений и преобразований.</span><span class="sxs-lookup"><span data-stu-id="64ae7-114">Expressions can use lineage identifiers to refer to columns.</span></span> <span data-ttu-id="64ae7-115">Идентификаторами журнала обращений и преобразований являются числа, уникальным образом идентифицирующие элементы пакета.</span><span class="sxs-lookup"><span data-stu-id="64ae7-115">Lineage identifiers are numbers that uniquely identify package elements.</span></span> <span data-ttu-id="64ae7-116">Префиксы идентификаторов журнала обращений и преобразований, на которые ссылается выражение, должны содержать знак решетки (#).</span><span class="sxs-lookup"><span data-stu-id="64ae7-116">Lineage identifiers, referenced in an expression, must include the pound (#) prefix.</span></span> <span data-ttu-id="64ae7-117">Например, на идентификатор журнала обращений и преобразований 138 ссылаются с помощью #138.</span><span class="sxs-lookup"><span data-stu-id="64ae7-117">For example, the lineage identifier 138 is referenced using #138.</span></span>  
  
 <span data-ttu-id="64ae7-118">Выражения могут содержать системные переменные, которые предоставляют службы [!INCLUDE[ssIS](../../includes/ssis-md.md)] , а также пользовательские переменные.</span><span class="sxs-lookup"><span data-stu-id="64ae7-118">Expressions can include the system variables that [!INCLUDE[ssIS](../../includes/ssis-md.md)] provides and custom variables.</span></span> <span data-ttu-id="64ae7-119">Префиксы переменных, на которые ссылается выражение, должны содержать символ \@.</span><span class="sxs-lookup"><span data-stu-id="64ae7-119">Variables, when referenced in an expression, must include the \@ prefix.</span></span> <span data-ttu-id="64ae7-120">Например, ссылкой на переменную `Counter` будет \@Counter.</span><span class="sxs-lookup"><span data-stu-id="64ae7-120">For example, the `Counter` variable is referenced using \@Counter.</span></span> <span data-ttu-id="64ae7-121">Символ \@ не является частью имени переменной. Он только указывает средству оценки выражений принадлежность идентификатора к переменным.</span><span class="sxs-lookup"><span data-stu-id="64ae7-121">The \@ character is not part of the variable name; it only indicates to the expression evaluator that the identifier is a variable.</span></span> <span data-ttu-id="64ae7-122">Дополнительные сведения см. в разделе [Идентификаторы (службы SSIS)](identifiers-ssis.md).</span><span class="sxs-lookup"><span data-stu-id="64ae7-122">For more information, see [Identifiers &#40;SSIS&#41;](identifiers-ssis.md).</span></span>  
  
## <a name="literals"></a><span data-ttu-id="64ae7-123">Литералы</span><span class="sxs-lookup"><span data-stu-id="64ae7-123">Literals</span></span>  
 <span data-ttu-id="64ae7-124">Выражения могут содержать числовые, строковые и логические литералы.</span><span class="sxs-lookup"><span data-stu-id="64ae7-124">Expressions can include numeric, string, and Boolean literals.</span></span> <span data-ttu-id="64ae7-125">Строковые литералы, использующиеся в выражениях, должны быть заключены в кавычки.</span><span class="sxs-lookup"><span data-stu-id="64ae7-125">String literals used in expressions must be enclosed in quotation marks.</span></span> <span data-ttu-id="64ae7-126">Числовые и логические литералы не заключаются в кавычки.</span><span class="sxs-lookup"><span data-stu-id="64ae7-126">Numeric and Boolean literals do not take quotation marks.</span></span> <span data-ttu-id="64ae7-127">В языке выражений содержатся управляющие последовательности для часто используемых символов.</span><span class="sxs-lookup"><span data-stu-id="64ae7-127">The expression language includes escape sequences for characters that are frequently escaped.</span></span> <span data-ttu-id="64ae7-128">Дополнительные сведения см. в статье [Литералы (службы SSIS)](numeric-string-and-boolean-literals.md).</span><span class="sxs-lookup"><span data-stu-id="64ae7-128">For more information, see [Literals &#40;SSIS&#41;](numeric-string-and-boolean-literals.md).</span></span>  
  
## <a name="operators"></a><span data-ttu-id="64ae7-129">Операторы</span><span class="sxs-lookup"><span data-stu-id="64ae7-129">Operators</span></span>  
 <span data-ttu-id="64ae7-130">Средство оценки выражений предоставляет набор операторов, обеспечивающий функциональность, аналогичную набору операторов в таких языках, как Transact-SQL, C++ и C#.</span><span class="sxs-lookup"><span data-stu-id="64ae7-130">The expression evaluator provides a set of operators that provides functionality similar to the set of operators in languages such as Transact-SQL, C++, and C#.</span></span> <span data-ttu-id="64ae7-131">Однако язык выражений содержит дополнительные операторы и может использовать незнакомые символы.</span><span class="sxs-lookup"><span data-stu-id="64ae7-131">However, the expression language includes additional operators and uses different symbols than those you may be familiar with.</span></span> <span data-ttu-id="64ae7-132">Дополнительные сведения см. в статье [Операторы (выражение служб SSIS)](operators-ssis-expression.md).</span><span class="sxs-lookup"><span data-stu-id="64ae7-132">For more information, see [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md).</span></span>  
  
### <a name="namespace-resolution-operator"></a><span data-ttu-id="64ae7-133">Оператор разрешения пространства имен</span><span class="sxs-lookup"><span data-stu-id="64ae7-133">Namespace Resolution Operator</span></span>  
 <span data-ttu-id="64ae7-134">Выражения используют оператор разрешения пространства имен (::), чтобы разрешать неоднозначность переменных, имеющих одинаковые имена.</span><span class="sxs-lookup"><span data-stu-id="64ae7-134">Expressions use the namespace resolution operator (::) to disambiguate variables that have the same name.</span></span> <span data-ttu-id="64ae7-135">Оператор разрешения пространства имен позволяет определять переменную ее пространством имен, что делает возможным использование в пакете нескольких переменных с одинаковыми именами.</span><span class="sxs-lookup"><span data-stu-id="64ae7-135">By using the namespace resolution operator, you can qualify the variable with its namespace, which makes it possible to use multiple variables with the same name in a package.</span></span>  
  
#### <a name="cast-operator"></a><span data-ttu-id="64ae7-136">Оператор приведения</span><span class="sxs-lookup"><span data-stu-id="64ae7-136">Cast Operator</span></span>  
 <span data-ttu-id="64ae7-137">Оператор приведения преобразует результаты выражения, значения столбцов, значения переменных и константы из одного типа данных в другой.</span><span class="sxs-lookup"><span data-stu-id="64ae7-137">The cast operator converts expression results, column values, variable values, and constants from one data type to another.</span></span> <span data-ttu-id="64ae7-138">Оператор приведения языка выражений аналогичен оператору приведения языков C и C#.</span><span class="sxs-lookup"><span data-stu-id="64ae7-138">The cast operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="64ae7-139">В языке Transact-SQL эту функциональность обеспечивают функции CAST и CONVERT.</span><span class="sxs-lookup"><span data-stu-id="64ae7-139">In Transact-SQL, the CAST and CONVERT functions provide this functionality.</span></span> <span data-ttu-id="64ae7-140">Синтаксис оператора приведения отличается от синтаксиса функций CAST и CONVERT следующим образом.</span><span class="sxs-lookup"><span data-stu-id="64ae7-140">The syntax of the cast operator is different from ones used by CAST and CONVERT in the following ways:</span></span>  
  
-   <span data-ttu-id="64ae7-141">В качестве аргумента может использоваться выражение.</span><span class="sxs-lookup"><span data-stu-id="64ae7-141">It can use an expression as an argument.</span></span>  
  
-   <span data-ttu-id="64ae7-142">В его синтаксисе содержится ключевое слово CAST.</span><span class="sxs-lookup"><span data-stu-id="64ae7-142">Its syntax does not include the CAST keyword.</span></span>  
  
-   <span data-ttu-id="64ae7-143">В его синтаксисе содержится ключевое слово AS.</span><span class="sxs-lookup"><span data-stu-id="64ae7-143">Its syntax does not include the AS keyword.</span></span>  
  
##### <a name="conditional-operator"></a><span data-ttu-id="64ae7-144">Условный оператор</span><span class="sxs-lookup"><span data-stu-id="64ae7-144">Conditional Operator</span></span>  
 <span data-ttu-id="64ae7-145">Условный оператор на основе оценки логического выражения возвращает одно из двух выражений.</span><span class="sxs-lookup"><span data-stu-id="64ae7-145">The conditional operator returns one of two expressions, based on the evaluation of a Boolean expression.</span></span> <span data-ttu-id="64ae7-146">Условный оператор языка выражений аналогичен условному оператору языков C и C#.</span><span class="sxs-lookup"><span data-stu-id="64ae7-146">The conditional operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="64ae7-147">Аналогичная функциональность в многомерных выражениях (MDX) обеспечивается функцией IIF.</span><span class="sxs-lookup"><span data-stu-id="64ae7-147">In multidimensional expressions (MDX), the IIF function provides similar functionality.</span></span>  
  
###### <a name="logical-operators"></a><span data-ttu-id="64ae7-148">Логические операторы</span><span class="sxs-lookup"><span data-stu-id="64ae7-148">Logical Operators</span></span>  
 <span data-ttu-id="64ae7-149">Язык выражений поддерживает символ !</span><span class="sxs-lookup"><span data-stu-id="64ae7-149">The expression language supports the !</span></span> <span data-ttu-id="64ae7-150">как обозначение логической операции НЕ.</span><span class="sxs-lookup"><span data-stu-id="64ae7-150">character for the logical NOT operator.</span></span> <span data-ttu-id="64ae7-151">В Transact-SQL оператор !</span><span class="sxs-lookup"><span data-stu-id="64ae7-151">In Transact-SQL, the !</span></span> <span data-ttu-id="64ae7-152">встроен в набор реляционных операторов.</span><span class="sxs-lookup"><span data-stu-id="64ae7-152">operator is built into the set of relational operators.</span></span> <span data-ttu-id="64ae7-153">Например, в языке Transact-SQL содержатся операторы > и !>.</span><span class="sxs-lookup"><span data-stu-id="64ae7-153">For example, Transact-SQL provides the > and the !> operators.</span></span> <span data-ttu-id="64ae7-154">Язык выражений [!INCLUDE[ssIS](../../includes/ssis-md.md)] не поддерживает комбинацию оператора!</span><span class="sxs-lookup"><span data-stu-id="64ae7-154">The [!INCLUDE[ssIS](../../includes/ssis-md.md)] expression language does not support the combination of the !</span></span> <span data-ttu-id="64ae7-155">с другими операторами.</span><span class="sxs-lookup"><span data-stu-id="64ae7-155">operator and other operators.</span></span> <span data-ttu-id="64ae7-156">Например, не допускается объединение операторов !</span><span class="sxs-lookup"><span data-stu-id="64ae7-156">For example, it is not valid to combine !</span></span> <span data-ttu-id="64ae7-157">и > в оператор !>.</span><span class="sxs-lookup"><span data-stu-id="64ae7-157">and > into !>.</span></span> <span data-ttu-id="64ae7-158">Однако языком выражений поддерживается встроенная комбинация символов !=, обозначающая неравенство.</span><span class="sxs-lookup"><span data-stu-id="64ae7-158">However, the expression language does support a built-in != combination of characters for the not-equal-to comparison.</span></span>  
  
###### <a name="equality-operators"></a><span data-ttu-id="64ae7-159">Операторы равенства</span><span class="sxs-lookup"><span data-stu-id="64ae7-159">Equality Operators</span></span>  
 <span data-ttu-id="64ae7-160">Грамматика средства оценки выражений содержит оператор сравнения ==.</span><span class="sxs-lookup"><span data-stu-id="64ae7-160">The expression evaluator grammar provides the == equality operator.</span></span> <span data-ttu-id="64ae7-161">Этот оператор аналогичен оператору = языка Transact-SQL и оператору == языка C#.</span><span class="sxs-lookup"><span data-stu-id="64ae7-161">This operator is the equivalent of the = operator in Transact-SQL and the == operator in C#.</span></span>  
  
## <a name="functions"></a><span data-ttu-id="64ae7-162">Функции</span><span class="sxs-lookup"><span data-stu-id="64ae7-162">Functions</span></span>  
 <span data-ttu-id="64ae7-163">Язык выражений содержит функции даты и времени, математические и строковые функции, аналогичные функциям языка Transact-SQL и методам языка C#.</span><span class="sxs-lookup"><span data-stu-id="64ae7-163">The expression language includes date and time functions, mathematical functions, and string functions that are similar to Transact-SQL functions and C# methods.</span></span>  
  
 <span data-ttu-id="64ae7-164">Некоторые функции имеют такие же имена, что и функции языка Transact-SQL, но их функциональность в средстве оценки выражений отличается.</span><span class="sxs-lookup"><span data-stu-id="64ae7-164">A few functions have the same names as Transact-SQL functions, but have subtly different functionality in the expression evaluator.</span></span>  
  
-   <span data-ttu-id="64ae7-165">В языке Transact-SQL функция ISNULL замещает значения NULL на указанные значения, тогда как в средстве оценки выражений функция ISNULL возвращает логическое значение в результате определения того, является ли NULL значением выражения.</span><span class="sxs-lookup"><span data-stu-id="64ae7-165">In Transact-SQL, the ISNULL function replaces null values with a specified value, whereas the expression evaluator ISNULL function returns a Boolean based on whether an expression is null.</span></span>  
  
-   <span data-ttu-id="64ae7-166">В языке Transact-SQL функция ROUND содержит параметр усечения результирующего набора, тогда как аналогичная функция средства оценки выражений такого параметра не содержит.</span><span class="sxs-lookup"><span data-stu-id="64ae7-166">In Transact-SQL, the ROUND function includes an option to truncate the result set, whereas the expression evaluator ROUND function does not.</span></span>  
  
 <span data-ttu-id="64ae7-167">Дополнительные сведения см. в статье [Функции (выражение служб SSIS)](functions-ssis-expression.md).</span><span class="sxs-lookup"><span data-stu-id="64ae7-167">For more information, see [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="64ae7-168">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="64ae7-168">Related Tasks</span></span>  
 [<span data-ttu-id="64ae7-169">Использование выражения в компоненте потока данных</span><span class="sxs-lookup"><span data-stu-id="64ae7-169">Use an Expression in a Data Flow Component</span></span>](../use-an-expression-in-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="64ae7-170">См. также</span><span class="sxs-lookup"><span data-stu-id="64ae7-170">Related Content</span></span>  
  
-   <span data-ttu-id="64ae7-171">Техническая статья [Памятка выражений служб SSIS](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet)на сайте pragmaticworks.com</span><span class="sxs-lookup"><span data-stu-id="64ae7-171">Technical article, [SSIS Expression Cheat Sheet](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet), on pragmaticworks.com</span></span>  
  
-   <span data-ttu-id="64ae7-172">Техническая статья [Примеры выражений служб SSIS](https://go.microsoft.com/fwlink/?LinkId=220761)на сайте social.technet.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="64ae7-172">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>  
  
  
