---
title: Использование выражений свойств в пакетах | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- packages [Integration Services], expressions
- Integration Services packages, expressions
- SQL Server Integration Services packages, expressions
- dynamic properties
- updating package properties
- SSIS packages, expressions
- expressions [Integration Services], property expressions
- property expressions [Integration Services]
ms.assetid: a4bfc925-3ef6-431e-b1dd-7e0023d3a92d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: bb373428e91cfc8cb4b26a986da6d795ab2fea98
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666721"
---
# <a name="use-property-expressions-in-packages"></a><span data-ttu-id="0f4d7-102">Использование выражений свойств в пакетах</span><span class="sxs-lookup"><span data-stu-id="0f4d7-102">Use Property Expressions in Packages</span></span>
  <span data-ttu-id="0f4d7-103">Выражение свойства — это выражение, связанное со свойством для обеспечения динамического обновления во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-103">A property expression is an expression that is assigned to a property to enable dynamic update of the property at run time.</span></span> <span data-ttu-id="0f4d7-104">Например, выражение свойства может обновить строку «Кому», в которую задача «Отправка почты» вставляет хранящийся в переменной адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-104">For example, a property expression can update the To line that a Send Mail task uses by inserting an e-mail address that is stored in a variable.</span></span>

 <span data-ttu-id="0f4d7-105">Выражение может быть добавлено в пакет, задачу, контейнеры «цикл по каждому элементу», «цикл по элементам» и контейнер последовательности, перечислитель Foreach, обработчик событий, диспетчер соединений уровня пакета либо проекта или регистратор.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-105">An expression can be added to a package, task, Foreach Loop, For Loop, Sequence, Foreach enumerator, event handler, a package or project level connection manager, or log provider.</span></span> <span data-ttu-id="0f4d7-106">Любое свойство этих объектов, выполняющее чтение или запись, может реализовать выражение свойства.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-106">Any property of these objects that is read/write can implement a property expression.</span></span> [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="0f4d7-107">также поддерживают использование выражений свойств в некоторых пользовательских свойствах компонентов потока данных.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-107">also supports the use of property expressions in some custom properties of data flow components.</span></span> <span data-ttu-id="0f4d7-108">Переменные и элементы управления очередностью не поддерживают выражения свойств, однако они включают специальные свойства, в которых можно использовать выражения.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-108">Variables and precedence constraints do not support property expressions, but they include special properties in which you can use expressions.</span></span>

 <span data-ttu-id="0f4d7-109">Выражения свойств могут обновляться несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-109">Property expressions can be updated in different ways:</span></span>

-   <span data-ttu-id="0f4d7-110">Пользовательские переменные могут быть включены в конфигурацию пакета и затем обновлены при развертывании.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-110">User-defined variables can be included in package configurations and then updated when the package is deployed.</span></span> <span data-ttu-id="0f4d7-111">Во время выполнения выражение свойства вычисляется с использованием обновленного значения переменной.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-111">At run time, the property expression is evaluated using the updated variable value.</span></span>

-   <span data-ttu-id="0f4d7-112">Системные переменные, входящие в выражения, обновляются во время выполнения, что приводит к изменению результата вычисления свойства.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-112">System variables that are included in expressions are updated at run time, which changes the results of the property evaluation.</span></span>

-   <span data-ttu-id="0f4d7-113">Функции даты и времени вычисляются при выполнении и предоставляют обновленные значения выражениям свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-113">Date and time functions are evaluated at run time and provide the updated values to property expressions.</span></span>

-   <span data-ttu-id="0f4d7-114">Переменные в выражениях могут обновляться скриптами, которые запускаются задачей скрипта и компонентом скрипта.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-114">Variables in expressions can be updated by the scripts that the Script task and the Script component run.</span></span>

 <span data-ttu-id="0f4d7-115">Выражения строятся с использованием языка выражений [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0f4d7-115">The expressions are built using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression language.</span></span> <span data-ttu-id="0f4d7-116">Выражения могут использовать системные или пользовательские переменные вместе с операторами, функциями и приведениями типа, которые предоставляет язык выражений.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-116">The expressions can use system or user-defined variables, together with the operators, functions, and type casts that the expression language provides.</span></span>

> [!NOTE]
>  <span data-ttu-id="0f4d7-117">Имена пользовательских и системных переменных обрабатываются с учетом регистра.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-117">The names of user-defined and system variables are case-sensitive.</span></span>

 <span data-ttu-id="0f4d7-118">Дополнительные сведения см. в разделе [Выражения служб Integration Services (SSIS)](integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="0f4d7-118">For more information, see [Integration Services &#40;SSIS&#41; Expressions](integration-services-ssis-expressions.md).</span></span>

 <span data-ttu-id="0f4d7-119">Важное применение выражений свойств — это настройка конфигурации для каждого развернутого экземпляра пакета.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-119">An important use of property expressions is to customize configurations for each deployed instance of a package.</span></span> <span data-ttu-id="0f4d7-120">Это позволяет динамически обновлять свойства пакетов для разных сред.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-120">This makes it possible to dynamically update package properties for different environments.</span></span> <span data-ttu-id="0f4d7-121">Например, можно создать выражение свойства, которое присваивает переменную строке соединения диспетчера соединений, а затем обновить переменную при развертывании пакета, таким образом обеспечивая правильность строки подключения во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-121">For example, you can create a property expression that assigns a variable to the connection string of a connection manager, and then update the variable when the package is deployed, ensuring that the connection string is correct at run time.</span></span> <span data-ttu-id="0f4d7-122">Конфигурации пакетов загружаются перед вычислением выражений свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-122">Package configurations are loaded before the property expressions are evaluated.</span></span>

 <span data-ttu-id="0f4d7-123">Свойство может использовать только одно выражение свойства, а выражение свойства может применяться только к одному свойству.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-123">A property can use only one property expression and a property expression can apply only to one property.</span></span> <span data-ttu-id="0f4d7-124">Однако можно создать несколько одинаковых выражений свойств и присвоить их разным свойствам.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-124">However, you can build multiple identical property expressions and assign them to different properties.</span></span>

 <span data-ttu-id="0f4d7-125">Некоторые свойства устанавливаются с помощью значений из перечислителей.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-125">Some properties are set by using values from enumerators.</span></span> <span data-ttu-id="0f4d7-126">При ссылке на элемент перечислителя в выражении свойств необходимо использовать числовое значение, которое соответствует понятному имени элемента перечислителя.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-126">When you reference the enumerator member in a property expression, you must use the numeric value that is equivalent to the friendly name of the enumerator member.</span></span> <span data-ttu-id="0f4d7-127">Например, если выражение свойств устанавливает свойство `LoggingMode`, которое использует значение из перечисления `DTSLoggingMode`, выражение свойств должно использовать 0, 1 или 2 вместо понятных имен `Enabled`, `Disabled` или `UseParentSetting`.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-127">For example, if a property expression sets the `LoggingMode` property, which uses a value from the `DTSLoggingMode` enumeration, the property expression must use 0, 1, or 2 instead of the friendly names `Enabled`, `Disabled`, or `UseParentSetting`.</span></span> <span data-ttu-id="0f4d7-128">Дополнительные сведения см. в разделе [Использование констант-перечислителей в выражениях свойств](enumerated-constants-in-property-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="0f4d7-128">For more information, see [Enumerated Constants in Property Expressions](enumerated-constants-in-property-expressions.md).</span></span>

## <a name="property-expression-user-interface"></a><span data-ttu-id="0f4d7-129">Пользовательский интерфейс выражения свойства</span><span class="sxs-lookup"><span data-stu-id="0f4d7-129">Property Expression User Interface</span></span>
 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="0f4d7-130">предоставляют набор средств для построения и управления выражениями свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-130">provides a set of tools for building and managing property expressions.</span></span>

-   <span data-ttu-id="0f4d7-131">Страница **Выражения** , расположенная в редакторах задач, контейнерах «цикл по элементам» и «цикл по каждому элементу».</span><span class="sxs-lookup"><span data-stu-id="0f4d7-131">The **Expressions** page, found in the custom editors for tasks, the For Loop container, and the Foreach containers.</span></span> <span data-ttu-id="0f4d7-132">Страница **Выражения** позволяет редактировать выражения и просматривать список выражений свойств, используемых задачей или контейнерами «цикл по элементам» и «цикл по каждому элементу».</span><span class="sxs-lookup"><span data-stu-id="0f4d7-132">The **Expressions** page lets you edit expressions and view a list of the property expressions that a task, Foreach Loop, or For Loop uses.</span></span>

-   <span data-ttu-id="0f4d7-133">Окно **Свойства** предназначено для редактирования выражений и просмотра списка выражений свойств, используемых пакетом или объектами пакета.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-133">The **Properties** window, for editing expressions and viewing a list of the property expressions that a package or package objects use.</span></span>

-   <span data-ttu-id="0f4d7-134">Диалоговое окно **Редактор выражений свойств** служит для создания, обновления и удаления выражений свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-134">The **Property Expressions Editor** dialog box, for creating, updating, and deleting property expressions.</span></span>

-   <span data-ttu-id="0f4d7-135">Диалоговое окно **Построитель выражений** служит для построения выражений с помощью графических средств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-135">The **Expression Builder** dialog box, for building an expression using graphical tools.</span></span> <span data-ttu-id="0f4d7-136">В диалоговом окне **Построитель выражений** можно вычислить выражение для анализа без присваивания результата свойству.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-136">The **Expression Builder** dialog box can evaluate expressions for your review without assigning the evaluation result to the property.</span></span>

 <span data-ttu-id="0f4d7-137">На следующей диаграмме показан интерфейс пользователя, который используется для добавления, изменения и удаления выражений свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-137">The following diagram shows the user interfaces that you use to add, change, and remove property expressions.</span></span>

 <span data-ttu-id="0f4d7-138">![Пользовательский интерфейс для выражений свойств](../media/ssis-propertyexpressionui.gif "Пользовательский интерфейс для выражений свойств")</span><span class="sxs-lookup"><span data-stu-id="0f4d7-138">![The user interface for property expressions](../media/ssis-propertyexpressionui.gif "The user interface for property expressions")</span></span>

 <span data-ttu-id="0f4d7-139">В окне **Свойства** на странице **Выражения** нажмите кнопку обзора **(...)** на уровне коллекции **Выражения** для открытия диалогового окна **Редактор выражений свойств**.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-139">In the **Properties** window and the **Expressions** page, click the browse button **(...)** at the **Expressions** collection level to open the **Property Expressions Editor** dialog box.</span></span> <span data-ttu-id="0f4d7-140">Редактор выражений свойств позволяет сопоставлять свойства с выражением и вводить выражения свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-140">The Property Expressions Editor allows you to map a property to an expression and to type a property expression.</span></span> <span data-ttu-id="0f4d7-141">Если нужно использовать графические средства построения выражений для создания и проверки выражения, нажмите кнопку обзора **(...)** на уровне выражения для открытия диалогового окна **Построитель выражений**, создайте или внесите изменения и при желании проверьте выражение.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-141">If you want to use the graphical expression tools to create and then validate the expression, click the browse button **(...)** at the expression level to open the **Expression Builder** dialog box, and then create or modify and optionally validate the expression.</span></span>

 <span data-ttu-id="0f4d7-142">Диалоговое окно **Построитель выражений** можно также открыть из диалогового окна **Редактор выражений свойств** .</span><span class="sxs-lookup"><span data-stu-id="0f4d7-142">You can also open the **Expression Builder** dialog box from the **Property Expressions Editor** dialog box.</span></span>

#### <a name="to-work-with-property-expressions"></a><span data-ttu-id="0f4d7-143">Работа с выражениями свойств</span><span class="sxs-lookup"><span data-stu-id="0f4d7-143">To work with property expressions</span></span>

-   [<span data-ttu-id="0f4d7-144">Добавление или изменение выражение свойства</span><span class="sxs-lookup"><span data-stu-id="0f4d7-144">Add or Change a Property Expression</span></span>](add-or-change-a-property-expression.md)

### <a name="setting-property-expressions-of-data-flow-components"></a><span data-ttu-id="0f4d7-145">Установка выражений свойств для компонентов потока данных</span><span class="sxs-lookup"><span data-stu-id="0f4d7-145">Setting Property Expressions of Data Flow Components</span></span>
 <span data-ttu-id="0f4d7-146">При построении пакета в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]свойства компонентов потоков данных, которые поддерживают выражения свойств, публикуются в задаче потока данных, которой они принадлежат.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-146">If you construct a package in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], the properties of data flow components that support property expressions are exposed on the Data Flow task to which they belong.</span></span> <span data-ttu-id="0f4d7-147">Для добавления, изменения и удаления выражений свойств для компонентов потоков данных щелкните правой кнопкой мыши задачу потока данных для потока данных, которому компоненты потока данных принадлежат, и выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-147">To add, change, and remove the property expressions of data flow components, you right-click the Data Flow task for the data flow to which the data flow components belong and click **Properties**.</span></span> <span data-ttu-id="0f4d7-148">Окно свойств содержит список свойств компонентов потока данных, которые можно будет использовать в выражении свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-148">The Properties window lists the properties of data flow components with which you can use property expressions.</span></span> <span data-ttu-id="0f4d7-149">Например, для создания или изменения выражения свойства для свойства SamplingValue преобразования "Выборка строк" в потоке данных с именем SampleCustomer щелкните правой кнопкой мыши задачу потока данных для потока данных, которому принадлежит преобразование "Выборка строк", и выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-149">For example, to create or modify a property expression for the SamplingValue property of a Row Sampling transformation in a data flow named SampleCustomer, right-click the Data Flow task for the data flow to which the Row Sampling transformation belongs and click **Properties**.</span></span> <span data-ttu-id="0f4d7-150">Свойство SamplingValue отображается в окне свойств и имеет формат [SampleCustomer].[SamplingValue].</span><span class="sxs-lookup"><span data-stu-id="0f4d7-150">The SamplingValue property is listed in the Properties window, and has the format [SampleCustomer].[SamplingValue].</span></span>

 <span data-ttu-id="0f4d7-151">В окне свойств можно добавить, изменить или удалить выражения свойств для компонентов потока данных тем же самым способом, что и выражения свойств для других типов объектов служб [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0f4d7-151">In the Properties window, you add, change, and remove property expressions for data flow components in the same way as property expressions for other [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] object types.</span></span> <span data-ttu-id="0f4d7-152">Окно свойств также предоставляет доступ к различным диалоговым окнам и построителям, которые используются для добавления, изменения или удаления выражений свойств для компонентов потоков данных.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-152">The Properties window also provides access to the various dialog boxes and builders that you use to add, change, or remove property expressions for data flow components.</span></span> <span data-ttu-id="0f4d7-153">Дополнительные сведения о свойствах компонентов потока данных, которые могут быть обновлены выражениями свойств, см. в разделе [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="0f4d7-153">For more information about the properties of data flow components that can be updated by property expressions, see [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span></span>

## <a name="loading-property-expressions"></a><span data-ttu-id="0f4d7-154">Загрузка выражений свойств</span><span class="sxs-lookup"><span data-stu-id="0f4d7-154">Loading Property Expressions</span></span>
 <span data-ttu-id="0f4d7-155">Определять или управлять тем, когда загружаются выражения свойств, невозможно.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-155">You cannot specify or control when property expressions are loaded.</span></span> <span data-ttu-id="0f4d7-156">Выражения свойств вычисляются и загружаются при проверке пакета и его объектов.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-156">The property expressions are evaluated and loaded when the package and the package objects are validated.</span></span> <span data-ttu-id="0f4d7-157">Проверка производится при сохранении пакета, открытии пакета в конструкторе служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] и при запуске пакета.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-157">Validation occurs when you save the package, open the package in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, and run the package.</span></span>

 <span data-ttu-id="0f4d7-158">Поэтому обновленные значения свойств объектов пакета, которые используют выражения свойств, не будут видны в конструкторе служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] до тех пор, пока пакет не будет сохранен, запущен или заново открыт после добавления выражений свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-158">You will therefore not see the updated values of the properties of the package objects that use property expressions in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer until you save the package, run the package, or reopen the package after adding the property expressions.</span></span>

 <span data-ttu-id="0f4d7-159">Выражения свойств связаны с объектами различных типов (диспетчерами подключений, регистраторами и перечислителями); они также загружаются при вызове методов, связанных с этим типом объектов.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-159">The property expressions associated with different types of objects-connection managers, log providers, and enumerators-are also loaded when methods specific to that object type are called.</span></span> <span data-ttu-id="0f4d7-160">Например, свойства диспетчера соединений загружаются перед тем, как службы [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] создают экземпляр соединения.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-160">For example, the properties of connection managers are loaded before [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] creates an instance of the connection.</span></span>

 <span data-ttu-id="0f4d7-161">Выражения свойств загружаются после загрузки пакетов конфигурации.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-161">Property expressions are loaded after package configurations have loaded.</span></span> <span data-ttu-id="0f4d7-162">Например, вначале обновляются переменные в своей конфигурации, а затем вычисляются и загружаются выражения свойств, которые используют эти переменные.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-162">For example, variables are updated first by their configurations, and then the property expressions that use the variables are evaluated and loaded.</span></span> <span data-ttu-id="0f4d7-163">Это означает, что выражения свойств всегда используют значения переменных, которые устанавливаются конфигурациями.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-163">This means that the property expressions always use the values of variables that are set by configurations.</span></span>

> [!NOTE]
>  <span data-ttu-id="0f4d7-164">Нельзя использовать `Set` параметр служебной программы **dtexec** для заполнения выражения свойства.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-164">You cannot use the `Set` option of the **dtexec** utility to populate a property expression.</span></span>

 <span data-ttu-id="0f4d7-165">В следующей таблице показано, когда выражения свойств служб [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] вычисляются и загружаются.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-165">The following table summarizes when property expressions of [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] are evaluated and loaded.</span></span>

|<span data-ttu-id="0f4d7-166">Тип объекта</span><span class="sxs-lookup"><span data-stu-id="0f4d7-166">Object type</span></span>|<span data-ttu-id="0f4d7-167">Загрузка и вычисление</span><span class="sxs-lookup"><span data-stu-id="0f4d7-167">Load and evaluate</span></span>|
|-----------------|-----------------------|
|<span data-ttu-id="0f4d7-168">Пакеты, контейнеры последовательности, «цикл по элементам» и «цикл по каждому элементу», задачи и компоненты потоков данных</span><span class="sxs-lookup"><span data-stu-id="0f4d7-168">Package, Foreach loop, For Loop, Sequence, tasks, and data flow components</span></span>|<span data-ttu-id="0f4d7-169">После загрузки конфигураций</span><span class="sxs-lookup"><span data-stu-id="0f4d7-169">After loading configurations</span></span><br /><br /> <span data-ttu-id="0f4d7-170">Перед проверкой</span><span class="sxs-lookup"><span data-stu-id="0f4d7-170">Before validation</span></span><br /><br /> <span data-ttu-id="0f4d7-171">Перед выполнением</span><span class="sxs-lookup"><span data-stu-id="0f4d7-171">Before execution</span></span>|
|<span data-ttu-id="0f4d7-172">Диспетчеры соединений</span><span class="sxs-lookup"><span data-stu-id="0f4d7-172">Connection managers</span></span>|<span data-ttu-id="0f4d7-173">После загрузки конфигураций</span><span class="sxs-lookup"><span data-stu-id="0f4d7-173">After loading configurations</span></span><br /><br /> <span data-ttu-id="0f4d7-174">Перед проверкой</span><span class="sxs-lookup"><span data-stu-id="0f4d7-174">Before validation</span></span><br /><br /> <span data-ttu-id="0f4d7-175">Перед выполнением</span><span class="sxs-lookup"><span data-stu-id="0f4d7-175">Before execution</span></span><br /><br /> <span data-ttu-id="0f4d7-176">Перед созданием экземпляра соединения</span><span class="sxs-lookup"><span data-stu-id="0f4d7-176">Before creating a connection instance</span></span>|
|<span data-ttu-id="0f4d7-177">Регистраторы</span><span class="sxs-lookup"><span data-stu-id="0f4d7-177">Log providers</span></span>|<span data-ttu-id="0f4d7-178">После загрузки конфигураций</span><span class="sxs-lookup"><span data-stu-id="0f4d7-178">After loading configurations</span></span><br /><br /> <span data-ttu-id="0f4d7-179">Перед проверкой</span><span class="sxs-lookup"><span data-stu-id="0f4d7-179">Before validation</span></span><br /><br /> <span data-ttu-id="0f4d7-180">Перед выполнением</span><span class="sxs-lookup"><span data-stu-id="0f4d7-180">Before execution</span></span><br /><br /> <span data-ttu-id="0f4d7-181">Перед открытием журналов</span><span class="sxs-lookup"><span data-stu-id="0f4d7-181">Before opening logs</span></span>|
|<span data-ttu-id="0f4d7-182">Перечислители «по каждому элементу»</span><span class="sxs-lookup"><span data-stu-id="0f4d7-182">Foreach enumerators</span></span>|<span data-ttu-id="0f4d7-183">После загрузки конфигураций</span><span class="sxs-lookup"><span data-stu-id="0f4d7-183">After loading configurations</span></span><br /><br /> <span data-ttu-id="0f4d7-184">Перед проверкой</span><span class="sxs-lookup"><span data-stu-id="0f4d7-184">Before validation</span></span><br /><br /> <span data-ttu-id="0f4d7-185">Перед выполнением</span><span class="sxs-lookup"><span data-stu-id="0f4d7-185">Before execution</span></span><br /><br /> <span data-ttu-id="0f4d7-186">Перед каждым перечислением в цикле</span><span class="sxs-lookup"><span data-stu-id="0f4d7-186">Before each enumeration of the loop</span></span>|

## <a name="using-property-expressions-in-the-foreach-loop"></a><span data-ttu-id="0f4d7-187">Использование выражений свойств в контейнере «цикл по каждому элементу»</span><span class="sxs-lookup"><span data-stu-id="0f4d7-187">Using Property Expressions in the Foreach Loop</span></span>
 <span data-ttu-id="0f4d7-188">Часто в реализации выражения свойства полезно устанавливать значение свойства `ConnectionString` диспетчера соединений, которое используется в контейнере «цикл по каждому элементу».</span><span class="sxs-lookup"><span data-stu-id="0f4d7-188">It is frequently useful to implement a property expression to set the value of the `ConnectionString` property of connection managers that are used inside the Foreach Loop container.</span></span> <span data-ttu-id="0f4d7-189">После того как перечислитель сопоставляет свое текущее значение с переменной в каждой итерации цикла, выражение свойства может использовать значение этой переменной для динамического обновления значения свойства `ConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-189">After the enumerator maps its current value to a variable on each iteration of the loop, the property expression can use the value of this variable to update the value of the `ConnectionString` property dynamically .</span></span>

 <span data-ttu-id="0f4d7-190">При использовании выражений свойств со свойством `ConnectionString` для диспетчеров соединений с файлами, несколькими файлами, неструктурированными файлами и несколькими неструктурированными файлами, которые используют контейнер «цикл по каждому элементу», необходимо иметь в виду несколько вещей.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-190">If you want to use property expressions with the `ConnectionString` property of File, Multiple Files, Flat Files, and Multiple Flat Files connection managers that a Foreach Loop uses, there are some things that you should consider.</span></span> <span data-ttu-id="0f4d7-191">Пакет может быть настроен для одновременного запуска нескольких исполняемых объектов установкой свойства `MaxConcurrentExecutables` в значение больше 1 или в значение –1.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-191">A package can be configured to run multiple executables concurrently by setting the `MaxConcurrentExecutables` property either to a value greater than 1 or to the value -1.</span></span> <span data-ttu-id="0f4d7-192">Значение –1 определяет максимальное количество одновременно исполняемых объектов как число, равное количеству процессоров плюс два.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-192">A value of -1 allows the maximum number of concurrently running executables to equal the number of processors plus two.</span></span> <span data-ttu-id="0f4d7-193">Чтобы избежать нежелательных последствий параллельного выполнения исполняемых объектов, значение `MaxConcurrentExecutables` должно быть установлено в 1.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-193">To avoid negative consequences from the parallel execution of executables, the value `MaxConcurrentExecutables` should be set to 1.</span></span> <span data-ttu-id="0f4d7-194">Если значение `MaxConcurrentExecutables` не равно 1, то значение свойства `ConnectionString` не может быть точно определено, а результаты становятся непредсказуемыми.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-194">If `MaxConcurrentExecutables` is not set to 1, then the value of the `ConnectionString` property cannot be guaranteed and results are unpredictable.</span></span>

 <span data-ttu-id="0f4d7-195">Например, перечислители файлов контейнера «цикл по каждому элементу» возвращают имена файлов, а затем используют задачу «Выполнение SQL» для вставки этих имен в таблицу.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-195">For example, consider a Foreach Loop that enumerates files in a folder, retrieves the file names, and then uses an Execute SQL task to insert each file name into a table.</span></span> <span data-ttu-id="0f4d7-196">Если значение `MaxConcurrentExecutables` не установлено в 1, то будут возникать конфликты записи в таблицу, если два экземпляра задачи «Выполнение SQL» попытаются выполнить запись одновременно.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-196">If `MaxConcurrentExecutables` is not set to 1, then write conflicts could occur if two instances of the Execute SQL task attempted to write to the table at the same time.</span></span>

## <a name="sample-property-expressions"></a><span data-ttu-id="0f4d7-197">Образцы выражений свойств</span><span class="sxs-lookup"><span data-stu-id="0f4d7-197">Sample Property Expressions</span></span>
 <span data-ttu-id="0f4d7-198">Следующие образцы выражений показывают, как использовать системные переменные, операторы, функции и строковые литералы в выражениях свойств.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-198">The following sample expressions show how to use system variables, operators, functions, and string literals in property expressions.</span></span>

### <a name="property-expression-for-the-loggingmode-property-of-a-package"></a><span data-ttu-id="0f4d7-199">Выражения свойств для свойства LoggingMode пакета</span><span class="sxs-lookup"><span data-stu-id="0f4d7-199">Property Expression for the LoggingMode Property of a Package</span></span>
 <span data-ttu-id="0f4d7-200">Приведенное далее выражение свойства может быть использовано, чтобы установить свойство LoggingMode пакета.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-200">The following property expression can be used to set the LoggingMode property of a package.</span></span> <span data-ttu-id="0f4d7-201">Это выражение использует функции DAY и GETDATE, чтобы получить целое значение, представляющее день из даты.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-201">The expression uses the DAY and GETDATE functions to get an integer that represents the day datepart of a date.</span></span> <span data-ttu-id="0f4d7-202">Если день равен 1 или 15, журналирование включается, иначе отключается.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-202">If the day is the 1st or 15th, logging is enabled; otherwise, logging is disabled.</span></span> <span data-ttu-id="0f4d7-203">Значение 1 является целочисленным эквивалентом элемента перечислителя LoggingMode `Enabled` , а значение 2 — целочисленным эквивалентом элемента `Disabled` .</span><span class="sxs-lookup"><span data-stu-id="0f4d7-203">The value 1 is the integer equivalent of the LoggingMode enumerator member `Enabled`, and the value 2 is the integer equivalent of the member `Disabled`.</span></span> <span data-ttu-id="0f4d7-204">В выражении вместо имени элемента перечислителя необходимо использовать числовое значение.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-204">You must use the numeric value instead of the enumerator member name in the expression.</span></span>

 `DAY((DT_DBTIMESTAMP)GETDATE())==1||DAY((DT_DBTIMESTAMP)GETDATE())==15?1:2`

### <a name="property-expression-for-the-subject-of-an-e-mail-message"></a><span data-ttu-id="0f4d7-205">Выражение свойства для темы сообщения электронной почты</span><span class="sxs-lookup"><span data-stu-id="0f4d7-205">Property Expression for the Subject of an E-mail Message</span></span>
 <span data-ttu-id="0f4d7-206">Следующее выражение свойства может применяться, чтобы установить свойство Subject задачи "Отправка почты" и предоставить необходимую тему сообщения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-206">The following property expression can be used to set the Subject property of a Send Mail task and provide a useful e-mail subject.</span></span> <span data-ttu-id="0f4d7-207">Выражение использует сочетание строковых литералов, системных переменных, операторов объединения (+) и приведения, функций DATEDIFF и GETDATE.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-207">The expression uses a combination of string literals, system variables, the concatenation (+) and cast operators, and the DATEDIFF and GETDATE functions.</span></span> <span data-ttu-id="0f4d7-208">Системными переменными являются переменные `PackageName` и `StartTime` .</span><span class="sxs-lookup"><span data-stu-id="0f4d7-208">The system variables are the `PackageName` and `StartTime` variables.</span></span>

 `"PExpression-->Package: (" + @[System::PackageName] + ") Started:"+  (DT_WSTR, 30) @[System::StartTime] + " Duration:"  +  (DT_WSTR,10) (DATEDIFF( "ss", @[System::StartTime] , GETDATE()  )) + " seconds"`

 <span data-ttu-id="0f4d7-209">Если имя пакета — EmailRowCountPP и он был выполнен 4.03.2005, а время выполнения равно 9 секундам, то выражение вернет приведенную ниже строку.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-209">If the package name is EmailRowCountPP, was run on 3/4/2005, and the duration of the run was 9 seconds, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="0f4d7-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span></span>

### <a name="property-expression-for-the-message-of-an-e-mail-message"></a><span data-ttu-id="0f4d7-211">Выражения свойства для содержимого сообщения электронной почты</span><span class="sxs-lookup"><span data-stu-id="0f4d7-211">Property Expression for the Message of an E-mail Message</span></span>
 <span data-ttu-id="0f4d7-212">Приведенное далее выражение свойства может быть использовано, чтобы установить свойство MessageSource задачи "Отправка почты".</span><span class="sxs-lookup"><span data-stu-id="0f4d7-212">The following property expression can be used to set the MessageSource property of a Send Mail task.</span></span> <span data-ttu-id="0f4d7-213">Выражение использует сочетание строковых литералов, пользовательских переменных и оператора объединения (+).</span><span class="sxs-lookup"><span data-stu-id="0f4d7-213">The expression uses a combination of string literals, user-defined variables, and the concatenation (+) operator.</span></span> <span data-ttu-id="0f4d7-214">Переменные, определенные пользователем, имеют имена `nasdaqrawrows`, `nyserawrows`и `amexrawrows`.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-214">The user-defined variables are named `nasdaqrawrows`, `nyserawrows`, and `amexrawrows`.</span></span> <span data-ttu-id="0f4d7-215">Строка «\n» обозначает возврат каретки.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-215">The string "\n" indicates a carriage return.</span></span>

 `"Rows Processed: "  +   "\n" +"   NASDAQ: "  +   (dt_wstr,9)@[nasdaqrawrows]   + "\n" + "   NYSE: "  +  (dt_wstr,9)@[nyserawrows]  + "\n" + "   Amex: "  +  (dt_wstr,9)@[amexrawrows]`

 <span data-ttu-id="0f4d7-216">Если значение `nasdaqrawrows` равно 7058, значение `nyserawrows` равно 3528, а значение `amexrawrows` равно 1102, выражение вычисляется со следующим результатом.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-216">If `nasdaqrawrows` is 7058, `nyserawrows` is 3528, and `amexrawrows` is 1102, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="0f4d7-217">Обработано строк:</span><span class="sxs-lookup"><span data-stu-id="0f4d7-217">Rows Processed:</span></span>

 <span data-ttu-id="0f4d7-218">NASDAQ: 7058</span><span class="sxs-lookup"><span data-stu-id="0f4d7-218">NASDAQ: 7058</span></span>

 <span data-ttu-id="0f4d7-219">NYSE: 3528</span><span class="sxs-lookup"><span data-stu-id="0f4d7-219">NYSE: 3528</span></span>

 <span data-ttu-id="0f4d7-220">AMEX: 1102</span><span class="sxs-lookup"><span data-stu-id="0f4d7-220">AMEX: 1102</span></span>

### <a name="property-expression-for-the-executable-property-of-an-execute-process-task"></a><span data-ttu-id="0f4d7-221">Выражение свойства для исполняемого свойства задачи выполнения процесса</span><span class="sxs-lookup"><span data-stu-id="0f4d7-221">Property Expression for the Executable Property of an Execute Process Task</span></span>
 <span data-ttu-id="0f4d7-222">Приведенное далее выражение свойства может быть использовано для установки свойства Executable задачи выполнения процесса.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-222">The following property expression can be used to set the Executable property of an Execute Process task.</span></span> <span data-ttu-id="0f4d7-223">Выражение использует сочетание строковых литералов, операторов и функций.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-223">The expression uses a combination of string literals, operators, and functions.</span></span> <span data-ttu-id="0f4d7-224">Выражение использует функции DATEPART, GETDATE и условный оператор.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-224">The expression uses the DATEPART and GETDATE functions and the conditional operator.</span></span>

 `DATEPART("weekday", GETDATE()) ==2?"notepad.exe":"mspaint.exe"`

 <span data-ttu-id="0f4d7-225">Во второй день недели задача выполнения процесса запустит приложение notepad.exe, в другие дни — приложение mspaint.exe.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-225">If it is the second day in the week, the Execute Process task runs notepad.exe, otherwise the task runs mspaint.exe.</span></span>

### <a name="property-expression-for-the-connectionstring-property-of-a-flat-file-connection-manager"></a><span data-ttu-id="0f4d7-226">Выражение свойства для свойства ConnectionString диспетчера соединений с неструктурированными файлами</span><span class="sxs-lookup"><span data-stu-id="0f4d7-226">Property Expression for the ConnectionString Property of a Flat File Connection Manager</span></span>
 <span data-ttu-id="0f4d7-227">Приведенное ниже выражение свойства может быть использовано для установки свойства ConnectionString диспетчера соединений с неструктурированными файлами.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-227">The following property expression can be used to set the ConnectionString property of a Flat File connection manager.</span></span> <span data-ttu-id="0f4d7-228">Выражение использует одну пользовательскую переменную `myfilenamefull`, которая содержит путь к текстовому файлу.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-228">The expression uses a single user-defined variable, `myfilenamefull`, which contains the path to a text file.</span></span>

 `@[User::myfilenamefull]`

> [!NOTE]
>  <span data-ttu-id="0f4d7-229">К выражениям свойства диспетчеров соединений доступ возможен только посредством окна «Свойства».</span><span class="sxs-lookup"><span data-stu-id="0f4d7-229">Property expressions for connection managers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="0f4d7-230">Чтобы посмотреть свойства диспетчера соединений, необходимо выбрать диспетчер соединений в области **Диспетчеры соединений** конструктора служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , если окно свойств открыто, или щелкнуть правой кнопкой мыши диспетчер соединений и выбрать **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-230">To view the properties for a connection manager, you must select the connection manager in the **Connection Managers** area of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the connection manager and select **Properties**.</span></span>

### <a name="property-expression-for-the-configstring-property-of-a-text-file-log-provider"></a><span data-ttu-id="0f4d7-231">Выражение свойства для свойства ConfigString регистратора текстового файла</span><span class="sxs-lookup"><span data-stu-id="0f4d7-231">Property Expression for the ConfigString Property of a Text File Log Provider</span></span>
 <span data-ttu-id="0f4d7-232">Приведенное ниже выражение свойства может быть использовано для установки свойства ConfigString регистратора текстового файла.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-232">The following property expression can be used to set the ConfigString property of a Text File log provider.</span></span> <span data-ttu-id="0f4d7-233">Выражение использует одну пользовательскую переменную `varConfigString`, которая содержит имя файла для использования диспетчером подключения файлов.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-233">The expression uses a single user-defined variable, `varConfigString`, which contains the name of the File connection manager to use.</span></span> <span data-ttu-id="0f4d7-234">Диспетчер подключения файлов задает путь к текстовому файлу, в который регистрируются записи журнала.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-234">The File connection manager specifies the path of the text file to which log entries are written.</span></span>

 `@[User::varConfigString]`

> [!NOTE]
>  <span data-ttu-id="0f4d7-235">К выражениям свойства регистратора доступ возможен только посредством окна «Свойства».</span><span class="sxs-lookup"><span data-stu-id="0f4d7-235">Property expressions for log providers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="0f4d7-236">Чтобы посмотреть свойства регистратора, необходимо выбрать поставщик журнала на вкладке **Обозреватель пакетов** конструктора служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , если окно свойств открыто, или щелкнуть правой кнопкой поставщик журнала в обозревателе пакетов и выбрать **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="0f4d7-236">To view the properties of a log provider, you must select the log provider on the **Package Explorer** tab of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the log provider in Package Explorer and click **Properties**.</span></span>

## <a name="external-resources"></a><span data-ttu-id="0f4d7-237">Внешние ресурсы</span><span class="sxs-lookup"><span data-stu-id="0f4d7-237">External Resources</span></span>

-   [<span data-ttu-id="0f4d7-238">Маркер выражения и конфигурации (проект CodePlex)</span><span class="sxs-lookup"><span data-stu-id="0f4d7-238">Expression and Configuration Highlighter (CodePlex Project)</span></span>](https://go.microsoft.com/fwlink/?LinkId=146625)

-   <span data-ttu-id="0f4d7-239">Техническая статья [Примеры выражений служб SSIS](https://go.microsoft.com/fwlink/?LinkId=220761)на сайте social.technet.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="0f4d7-239">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>

## <a name="see-also"></a><span data-ttu-id="0f4d7-240">См. также:</span><span class="sxs-lookup"><span data-stu-id="0f4d7-240">See Also</span></span>
 [<span data-ttu-id="0f4d7-241">Использование переменных в пакетах</span><span class="sxs-lookup"><span data-stu-id="0f4d7-241">Use Variables in Packages</span></span>](../use-variables-in-packages.md)


