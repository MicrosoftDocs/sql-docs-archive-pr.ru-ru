---
title: Служба CDC Oracle | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 47759ddc-358d-405b-acb9-189ada76ea6d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 20299b191cb0605008e3d9a724be32feec6df734
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666201"
---
# <a name="the-oracle-cdc-service"></a>Служба CDC Oracle
  Служба CDC Oracle — это служба Windows, благодаря которой запускается программа xdbcdcsvc.exe. Служба Oracle CDC может настраиваться для запуска нескольких служб Windows на одном компьютере, каждая из которых должна иметь другое имя службы Windows. Создание нескольких служб Windows для Oracle CDC на одном компьютере обычно выполняется для достижения лучшего их разделения или в случае, если каждой из них требуется работать с другим экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
 Служба Oracle CDC создается при помощи консоли конфигурации службы Oracle CDC или определяется при помощи интерфейса командной строки, встроенного в программу xdbcdcsvc.exe. В обоих случаях каждая созданная служба Oracle CDC связана с одним [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляром (который может быть кластеризованным или зеркальным с помощью установки **AlwaysOn** ), а сведения о соединении (строка подключения и учетные данные доступа) являются частью конфигурации службы.  
  
 При запуске службы Oracle CDC выполняется попытка подключения к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , к которому она привязана, извлекается список экземпляров Oracle CDC для обработки, после чего выполняется первоначальная проверка среды. Ошибки во время запуска службы и любые сведения о запуске/останове всегда записываются в журнал событий приложения Windows. После установки соединения с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] все ошибки и сообщения записываются в таблицу **dbo.xdbcdc_trace** , расположенную в базе данных MSXDBCDC экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Одной из проверок, выполняемых во время запуска, является проверка отсутствия другой работающей службы Oracle CDC с таким же именем. Если служба с тем же именем в настоящий момент подключена с другого компьютера, служба Oracle CDC переходит к циклу ожидания, пока другая служба не отключится, перед тем как начать обрабатывать данные Oracle CDC.  
  
 Когда служба Oracle CDC Service выполняет все проверки, необходимые для запуска, выполняется проверка таблицы **dbo.xdbcdc_databases** в базе данных MSXDBCDC на наличие любых включенных экземпляров Oracle CDC. Для каждого включенного экземпляра Oracle CDC служба запускает подпроцесс для обработки этого экземпляра Oracle CDC.  
  
 При запуске экземпляра службы Oracle CDC осуществляется доступ к базе данных SQL Server CDC с именем, совпадающим с именем экземпляра CDC, и извлечение его состояния с момента предыдущего запуска. Также выполняется проверка правильности работы всех компонентов. Затем происходит возобновление обработки изменений, а также чтение журналов транзакций Oracle и запись изменений в базу данных CDC.  
  
 Служба Oracle CDC Service периодически отслеживает таблицу **dbo.xdbcdc_tables** в базе данных MSXDBCDC, чтобы определить наличие любых изменений в конфигурации экземпляра Oracle CDC. При обнаружении изменения служба Oracle CDC уведомляет экземпляр Oracle CDC о необходимости проверки экземпляра на наличие изменений. Большинство изменений в конфигурации, таких как добавление или удаление отслеживаемых экземпляров, можно применять, пока экземпляр Oracle CDC включен, но для некоторых изменений может потребоваться перезапустить экземпляр Oracle CDC.  
  
 При использовании консоли конструктора Oracle CDC изменения определяются автоматически. При обновлении конфигурации Oracle CDC непосредственно при помощи SQL необходимо вызвать следующую процедуру для того, чтобы служба Oracle CDC обнаружила изменения в конфигурации:  
  
```  
DECLARE @dbname nvarchar(128) = 'HRcdc'  
EXECUTE [MSXDBCDC].[dbo].[xdbcdc_update_config_version] @dbname  
GO  
  
```  
  
 Процесс экземпляра Oracle CDC обновляет свое состояние в системной таблице **cdc.xdbcdc_state** и записывает сведения об ошибке в таблицу **cdc.xdbcdc_trace** . Таблица **xdbcdc_state** полезна для мониторинга состояния экземпляра Oracle CDC. В ней содержатся информация о состоянии, различные счетчики (например, число изменений, прочитанных в Oracle, количество изменений, записанных в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], количество зафиксированных транзакций и текущее количество транзакций, выполняемых на лету), а также индикация задержки.  
  
 Конфигурация экземпляра Oracle CDC сохраняется в таблице **cdc.xdbcdc_config** , которая является таблицей, с которой работает консоль конструктора Oracle CDC. Поскольку вся конфигурация экземпляра Oracle CDC находится в целевом экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и в базах данных CDC, становится возможным создание скриптов развертывания [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для экземпляра Oracle CDC. Это делается с помощью консолей конфигурации службы Oracle CDC и конструктора Oracle CDC.  
  
## <a name="security-considerations"></a>Соображения безопасности  
 Ниже описываются требования безопасности, необходимые для работы со службой CDC для Oracle.  
  
### <a name="protection-of-source-oracle-data"></a>Защита исходных данных Oracle  
 Служба Oracle CDC не требует доступа к исходным данным Oracle и защищена путем обеспечения того, чтобы учетные данные интеллектуального анализа журнала не предоставляли разрешение SELECT для клиентских таблиц Oracle.  
  
### <a name="protection-of-source-oracle-change-data"></a>Защита исходной информации об изменениях Oracle  
 Службе Oracle CDC предоставляются учетные данные для интеллектуального анализа журнала, которые позволяют этой службе отслеживать изменения, вносимые в любую таблицу базы данных Oracle. Информация об изменениях не обладает такими же гранулярными разрешениями доступа, какими обладают обычные таблицы, поэтому доступ к данным изменений позволяет обойти встроенные элементы управления доступом к данным Oracle.  
  
 Исходные таблицы Oracle, отслеживание которых было выполнено, имеют в базе данных CDC пустые зеркальные таблицы с такими же схемами и именами таблиц. Данные, для которых выполнено отслеживание, сохраняются в отслеживаемых экземплярах [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и предоставляют такой же уровень защиты, который предусмотрен для изменений, полученных от базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Для получения доступа к информации об изменениях, связанной с экземпляром отслеживания, пользователю должен быть предоставлен доступ с правом выборки всех отслеживаемых столбцов в соответствующей зеркальной таблице. Кроме того, если при создании экземпляра отслеживания задана шлюзовая роль, вызывающий также должен быть членом указанной шлюзовой роли. Другие общие функции системы отслеживания измененных данных для доступа к метаданным предоставляются в распоряжение пользователей баз данных через роль public, хотя доступ к возвращенным метаданным обычно регулируется доступом с правом выборки к базовым исходным таблицам, а также членством во всех определенных шлюзовых ролях.  
  
 Это означает, что пользователи с предопределенной ролью сервера **sysadmin** или с предопределенной ролью базы данных **db_owner** имеют (по умолчанию) полный доступ к полученным данным, а дополнительный доступ можно предоставить либо путем дальнейшего назначения ролей, либо путем предоставления выделенного доступа к полученным столбцам.  
  
### <a name="protection-of-source-oracle-log-mining-credentials"></a>Защита учетных данных интеллектуального анализа исходного журнала Oracle  
 Конфигурация службы Oracle CDC, хранимая в базе данных CDC (в таблице cdc.xdbcdc_config), включает имя пользователя интеллектуального анализа журнала и связанный с ним пароль.  
  
 Пароль интеллектуального анализа журнала сохраняется в зашифрованном виде путем использования асимметричного ключа с фиксированным именем `xdbcdc_asym_key` , который создается автоматически при помощи следующей команды:  
  
```  
USE [<cdc-database-name>]  
CREATE ASYMMETRIC KEY xdbcdc_asym_key  
    WITH ALGORITHM = RSA_1024  
    ENCRYPTION BY PASSWORD = '<cdc-database-name><asym-key-password>'  
  
```  
  
 При использовании другого алгоритма этот ключ можно удалить и создать новый ключ с таким же именем, зашифрованный при помощи такого же пароля.  
  
 Пароль асимметричного ключа — это главный пароль, который сохраняется в реестре с путем **HKLM\Software\Microsoft\XDBCDCSVC\\<имя_службы>** . Этот ключ доступен только для локальных администраторов и учетной записи службы Windows для Oracle CDC. Ключ содержит зашифрованное двоичное значение **AsymmetricKeyPassword** , в котором хранится пароль асимметричного ключа. Доступ к разделу реестра необходим для доступа к учетным данным интеллектуального анализа журнала Oracle.  
  
 Для использования предложения ENCRYPTION BY PASSWORD пароль должен соответствовать требованиям политики паролей Windows для компьютера, на котором запущен экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Это делается путем выбора пароля асимметричного ключа в соответствии с этой политикой.  
  
 При утрате пароля асимметричного ключа учетные данные интеллектуального анализа журнала для каждого экземпляра Oracle CDC необходимо задать снова при помощи конструктора службы Oracle CDC.  
  
 Асимметричный ключ автоматически создается в базе данных CDC, если служба CDC обнаруживает экземпляр базы данных Oracle CDC, в которой отсутствует асимметричный ключ, или если такой ключ существует, но пароль для него не подходит.  
  
### <a name="oracle-cdc-service-windows-service-account"></a>Учетная запись службы Windows для службы Oracle CDC  
 Учетная запись службы, используемая для службы Windows для Oracle CDC, не требует каких-либо дополнительных привилегий. Учетная запись должна использовать API собственного клиента Native Client Oracle и API источника данных ODBC собственного клиента SQL Server. Также для нее необходим доступ к ключу настройки службы в реестре (для этого данная консоль настройки службы CDC специально настраивает ACL).  
  
## <a name="in-this-section"></a>в этом разделе  
  
-   [Поддержка высокого уровня доступности](high-availability-support.md)  
  
-   [Разрешения, необходимые службе CDC для соединения с SQL Server](sql-server-connection-required-permissions-for-the-cdc-service.md)  
  
-   [Роли пользователя для изменения служб отслеживания данных для Oracle от Attunity.](user-roles.md)  
  
-   [Работа со службой CDC Oracle](the-oracle-cdc-service.md)  
  
## <a name="see-also"></a>См. также:  
 [Как управлять локальной службой CDC](how-to-manage-a-local-cdc-service.md)   
 [Управление службой CDC Oracle](manage-an-oracle-cdc-service.md)  
  
  
