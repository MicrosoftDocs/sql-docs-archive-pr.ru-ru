---
title: Программное построение пакетов | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
ms.assetid: 7474b1f4-7607-4f28-a6fd-67f7db1dd3f8
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 8ef8fd0b6b5bdeead718f204a0933771fe58924a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87658360"
---
# <a name="building-packages-programmatically"></a><span data-ttu-id="e0154-102">Программное построение пакетов</span><span class="sxs-lookup"><span data-stu-id="e0154-102">Building Packages Programmatically</span></span>
  <span data-ttu-id="e0154-103">Если необходимо динамическое создание пакетов или управление и выполнение пакетов служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] вне среды разработки, то можно управлять пакетами программно.</span><span class="sxs-lookup"><span data-stu-id="e0154-103">If you need to create packages dynamically, or to manage and execute [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages outside the development environment, you can manipulate packages programmatically.</span></span> <span data-ttu-id="e0154-104">Этот подход предлагает следующий набор вариантов.</span><span class="sxs-lookup"><span data-stu-id="e0154-104">In this approach, you have a continuous range of options:</span></span>

-   <span data-ttu-id="e0154-105">Загрузка и выполнение существующего пакета без изменения.</span><span class="sxs-lookup"><span data-stu-id="e0154-105">Load and execute an existing package without modification.</span></span>

-   <span data-ttu-id="e0154-106">Загрузка существующего пакета, изменение его конфигурации (например, для другого источника данных) и выполнение пакета.</span><span class="sxs-lookup"><span data-stu-id="e0154-106">Load an existing package, reconfigure it (for example, for a different data source), and execute it.</span></span>

-   <span data-ttu-id="e0154-107">Создание нового пакета, добавление и настройка компонентов поочередно для каждого объекта и для каждого свойства, сохранение пакета и выполнение пакета.</span><span class="sxs-lookup"><span data-stu-id="e0154-107">Create a new package, add and configure components object by object and property by property, save it, and execute it.</span></span>

 <span data-ttu-id="e0154-108">Можно использовать модель объектов служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , чтобы написать код, который создает, настраивает и выполняет пакеты на любом языке программирования управляемого кода.</span><span class="sxs-lookup"><span data-stu-id="e0154-108">You can use the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] object model to write code that creates, configures, and executes packages in any managed programming language.</span></span> <span data-ttu-id="e0154-109">Например, может потребоваться создать управляемые метаданными пакеты, которые настраивают свои соединения или свои источники данных, преобразования и назначения на основании выбранного источника данных и его таблиц и столбцов.</span><span class="sxs-lookup"><span data-stu-id="e0154-109">For example, you may want to create metadata-driven packages that configure their connections or their data sources, transformations, and destinations based on the selected data source and its tables and columns.</span></span>

 <span data-ttu-id="e0154-110">В этом разделе описывается и демонстрируется пошаговое создание и настройка пакета программным способом.</span><span class="sxs-lookup"><span data-stu-id="e0154-110">This section describes and demonstrates how to create and configure a package programmatically line by line.</span></span> <span data-ttu-id="e0154-111">Используя наименее сложный вариант из набора вариантов программирования пакетов, можно просто загрузить и выполнить существующий пакет, не внося в него изменения, как описано в разделе [Выполнение пакетов и управление пакетами программным образом](../run-manage-packages-programmatically/running-and-managing-packages-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="e0154-111">At the less complex end of the range of package programming options, you can simply load and run an existing package without modification as described in [Running and Managing Packages Programmatically](../run-manage-packages-programmatically/running-and-managing-packages-programmatically.md).</span></span>

 <span data-ttu-id="e0154-112">В качестве промежуточного, не описываемого здесь варианта, может быть предложен вариант загрузки существующего пакета в виде шаблона, его перенастройки (например, для другого источника данных) и выполнения.</span><span class="sxs-lookup"><span data-stu-id="e0154-112">An intermediate option not described here is that of loading an existing package as a template, reconfiguring it (for example, for a different data source), and executing it.</span></span> <span data-ttu-id="e0154-113">Сведения данного раздела можно использовать для изменения существующих объектов в пакете.</span><span class="sxs-lookup"><span data-stu-id="e0154-113">You can also use the information in this section to modify the existing objects in a package.</span></span>

> [!NOTE]
>  <span data-ttu-id="e0154-114">При использовании существующего пакета в качестве шаблона и при изменении существующих столбцов в потоке данных, может понадобиться удалить существующие столбцы и вызывать метод <xref:Microsoft.SqlServer.Dts.Pipeline.PipelineComponent.ReinitializeMetaData%2A> затронутых компонентов.</span><span class="sxs-lookup"><span data-stu-id="e0154-114">When you use an existing package as a template and modify existing columns in the data flow, you may have to remove existing columns and call the <xref:Microsoft.SqlServer.Dts.Pipeline.PipelineComponent.ReinitializeMetaData%2A> method of affected components.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="e0154-115">в этом разделе</span><span class="sxs-lookup"><span data-stu-id="e0154-115">In This Section</span></span>
 <span data-ttu-id="e0154-116">[Создание пакета программным способом](../building-packages-programmatically/creating-a-package-programmatically.md) Описывает, как создать пакет программным способом.</span><span class="sxs-lookup"><span data-stu-id="e0154-116">[Creating a Package Programmatically](../building-packages-programmatically/creating-a-package-programmatically.md) Describes how to create a package programmatically.</span></span>

 <span data-ttu-id="e0154-117">[Добавление задач программным способом](../building-packages-programmatically/adding-tasks-programmatically.md) Описывает добавление задач в пакет.</span><span class="sxs-lookup"><span data-stu-id="e0154-117">[Adding Tasks Programmatically](../building-packages-programmatically/adding-tasks-programmatically.md) Describes how to add tasks to the package.</span></span>

 <span data-ttu-id="e0154-118">[Программное подключение задач](../building-packages-programmatically/connecting-tasks-programmatically.md) Описывает, как управлять выполнением контейнеров и задач в пакете в зависимости от результата выполнения предыдущей задачи или контейнера.</span><span class="sxs-lookup"><span data-stu-id="e0154-118">[Connecting Tasks Programmatically](../building-packages-programmatically/connecting-tasks-programmatically.md) Describes how to control execution of the containers and tasks in a package based on the result of the execution of a previous task or container.</span></span>

 <span data-ttu-id="e0154-119">[Добавление соединений программным способом](../building-packages-programmatically/adding-connections-programmatically.md) Описывает добавление диспетчеров соединений в пакет.</span><span class="sxs-lookup"><span data-stu-id="e0154-119">[Adding Connections Programmatically](../building-packages-programmatically/adding-connections-programmatically.md) Describes how to add connection managers to a package.</span></span>

 <span data-ttu-id="e0154-120">[Работа с переменными программным способом](../building-packages-programmatically/working-with-variables-programmatically.md) Описывает, как добавлять и использовать переменные во время выполнения пакета.</span><span class="sxs-lookup"><span data-stu-id="e0154-120">[Working with Variables Programmatically](../building-packages-programmatically/working-with-variables-programmatically.md) Describes how to add and use variables during package execution.</span></span>

 <span data-ttu-id="e0154-121">[Программная обработка событий](../building-packages-programmatically/handling-events-programmatically.md) Описывает обработку событий пакета и задачи.</span><span class="sxs-lookup"><span data-stu-id="e0154-121">[Handling Events Programmatically](../building-packages-programmatically/handling-events-programmatically.md) Describes how to handle package and task events.</span></span>

 <span data-ttu-id="e0154-122">[Включение ведения журнала программным способом](../building-packages-programmatically/enabling-logging-programmatically.md) Описывает включение ведения журнала для пакета или задачи, а также применение настраиваемых фильтров для записи событий в журнал.</span><span class="sxs-lookup"><span data-stu-id="e0154-122">[Enabling Logging Programmatically](../building-packages-programmatically/enabling-logging-programmatically.md) Describes how to enable logging for a package or task, and how to apply custom filters to log events.</span></span>

 <span data-ttu-id="e0154-123">[Добавление задачи потока данных программным способом](../building-packages-programmatically/adding-the-data-flow-task-programmatically.md) Описывает, как добавить и настроить задачу потока данных и ее компоненты.</span><span class="sxs-lookup"><span data-stu-id="e0154-123">[Adding the Data Flow Task Programmatically](../building-packages-programmatically/adding-the-data-flow-task-programmatically.md) Describes how to add and configure the Data Flow task and its components.</span></span>

 <span data-ttu-id="e0154-124">[Программное обнаружение компонентов потока данных](../building-packages-programmatically/discovering-data-flow-components-programmatically.md) Описывает, как определить компоненты, установленные на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="e0154-124">[Discovering Data Flow Components Programmatically](../building-packages-programmatically/discovering-data-flow-components-programmatically.md) Describes how to detect the components that are installed on the local computer.</span></span>

 <span data-ttu-id="e0154-125">[Добавление компонентов потока данных программным способом](../building-packages-programmatically/adding-data-flow-components-programmatically.md) Описывает добавление компонента в задачу потока данных.</span><span class="sxs-lookup"><span data-stu-id="e0154-125">[Adding Data Flow Components Programmatically](../building-packages-programmatically/adding-data-flow-components-programmatically.md) Describes how to add a component to a data flow task.</span></span>

 <span data-ttu-id="e0154-126">[Программное подключение компонентов потока данных](../building-packages-programmatically/connecting-data-flow-components-programmatically.md) Описывает подключение двух компонентов потока данных.</span><span class="sxs-lookup"><span data-stu-id="e0154-126">[Connecting Data Flow Components Programmatically](../building-packages-programmatically/connecting-data-flow-components-programmatically.md) Describes how to connect two data flow components.</span></span>

 <span data-ttu-id="e0154-127">[Выбор входных столбцов программным способом](../building-packages-programmatically/selecting-input-columns-programmatically.md) Описывает, как выбрать входные столбцы из тех, которые предоставляются компоненту посредством восходящего компонента в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="e0154-127">[Selecting Input Columns Programmatically](../building-packages-programmatically/selecting-input-columns-programmatically.md) Describes how to select input columns from those that are provided to a component by upstream components in the data flow.</span></span>

 <span data-ttu-id="e0154-128">[Сохранение пакета программным способом](../building-packages-programmatically/saving-a-package-programmatically.md) Описание способа сохранения пакета программным способом.</span><span class="sxs-lookup"><span data-stu-id="e0154-128">[Saving a Package Programmatically](../building-packages-programmatically/saving-a-package-programmatically.md) Describes how to save a package programmatically.</span></span>

## <a name="reference"></a><span data-ttu-id="e0154-129">Справочные сведения</span><span class="sxs-lookup"><span data-stu-id="e0154-129">Reference</span></span>
 <span data-ttu-id="e0154-130">[Справочник по ошибкам и сообщениям Integration Services](../integration-services-error-and-message-reference.md) Список стандартных [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] кодов ошибок со своими символическими именами и описаниями.</span><span class="sxs-lookup"><span data-stu-id="e0154-130">[Integration Services Error and Message Reference](../integration-services-error-and-message-reference.md) Lists the predefined [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] error codes with their symbolic names and descriptions.</span></span>

## <a name="related-sections"></a><span data-ttu-id="e0154-131">Связанные разделы</span><span class="sxs-lookup"><span data-stu-id="e0154-131">Related Sections</span></span>
 <span data-ttu-id="e0154-132">[Расширение пакетов с помощью сценариев](../extending-packages-scripting/extending-packages-with-scripting.md) Описывает, как расширить поток управления с помощью задачи «Скрипт» и как расширить поток данных с помощью компонента скрипта.</span><span class="sxs-lookup"><span data-stu-id="e0154-132">[Extending Packages with Scripting](../extending-packages-scripting/extending-packages-with-scripting.md) Discusses how to extend the control flow by using the Script task, and how to extend the data flow by using the Script component.</span></span>

 <span data-ttu-id="e0154-133">[Расширение пакетов с помощью пользовательских объектов](../extending-packages-custom-objects/extending-packages-with-custom-objects.md) Описывает создание пользовательских задач, компонентов потока данных и других объектов пакета для использования в нескольких пакетах.</span><span class="sxs-lookup"><span data-stu-id="e0154-133">[Extending Packages with Custom Objects](../extending-packages-custom-objects/extending-packages-with-custom-objects.md) Discusses how to create program custom tasks, data flow components, and other package objects for use in multiple packages.</span></span>

 <span data-ttu-id="e0154-134">[Программное выполнение пакетов и управление ими](../run-manage-packages-programmatically/running-and-managing-packages-programmatically.md) Описывает, как выполнять перечисление, запуск и Управление пакетами и папками, в которых они хранятся.</span><span class="sxs-lookup"><span data-stu-id="e0154-134">[Running and Managing Packages Programmatically](../run-manage-packages-programmatically/running-and-managing-packages-programmatically.md) Discusses how to enumerate, run, and manage packages and the folders in which they are stored.</span></span>

## <a name="external-resources"></a><span data-ttu-id="e0154-135">Внешние ресурсы</span><span class="sxs-lookup"><span data-stu-id="e0154-135">External Resources</span></span>

-   <span data-ttu-id="e0154-136">Образцы CodePlex, [Образцы продуктов служб Integration Services](https://go.microsoft.com/fwlink/?LinkID=131204)на сайте www.codeplex.com/MSFTISProdSamples</span><span class="sxs-lookup"><span data-stu-id="e0154-136">CodePlex samples, [Integration Services Product Samples](https://go.microsoft.com/fwlink/?LinkID=131204), on www.codeplex.com/MSFTISProdSamples</span></span>

-   <span data-ttu-id="e0154-137">Запись в блоге [Профилирование производительности пользовательских расширений](https://go.microsoft.com/fwlink/?LinkId=238831)на сайте blogs.msdn.com.</span><span class="sxs-lookup"><span data-stu-id="e0154-137">Blog entry, [Performance profiling your custom extensions](https://go.microsoft.com/fwlink/?LinkId=238831), on blogs.msdn.com.</span></span>

<span data-ttu-id="e0154-138">![Значок Integration Services (маленький)](../media/dts-16.gif "Значок служб Integration Services (маленький)")  **следит за обновлениями Integration Services**</span><span class="sxs-lookup"><span data-stu-id="e0154-138">![Integration Services icon (small)](../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="e0154-139">Чтобы загрузить новейшую документацию, статьи, образцы и видеоматериалы корпорации Майкрософт, а также лучшие решения участников сообщества, посетите страницу служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] на сайте MSDN:</span><span class="sxs-lookup"><span data-stu-id="e0154-139">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="e0154-140">Посетить страницу «Службы Integration Services» на сайте MSDN</span><span class="sxs-lookup"><span data-stu-id="e0154-140">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="e0154-141">Чтобы получать автоматические уведомления об этих обновлениях, подпишитесь на RSS-каналы, предлагаемые на этой странице.</span><span class="sxs-lookup"><span data-stu-id="e0154-141">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="e0154-142">См. также:</span><span class="sxs-lookup"><span data-stu-id="e0154-142">See Also</span></span>
 [<span data-ttu-id="e0154-143">SQL Server Integration Services</span><span class="sxs-lookup"><span data-stu-id="e0154-143">SQL Server Integration Services</span></span>](../sql-server-integration-services.md)


