---
title: Реализация преобразования «Уточняющий запрос» в режиме полного кэширования с помощью диспетчера соединений OLE DB | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Lookup transformation [Integration Services]
ms.assetid: c4150e1b-bdff-4f7a-af4c-3401c34def83
author: chugugrace
ms.author: chugu
ms.openlocfilehash: f77a753dd71bc487d57492371906fc48bc114357
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667362"
---
# <a name="implement-a-lookup-transformation-in-full-cache-mode-using-the-ole-db-connection-manager"></a>Реализация преобразования «Уточняющий запрос» в режиме полного кэширования с помощью диспетчера соединений OLE DB
  Можно настроить преобразование «Уточняющий запрос», чтобы использовать режим полного кэширования и диспетчер соединений OLE DB. В режиме полного кэширования эталонный набор данных загружается в кэш еще до запуска преобразования «Уточняющий запрос».  
  
 Преобразование «Уточняющий запрос» выполняет уточняющие запросы, соединяя данные из входных столбцов подключенного источника данных и данные из столбцов в эталонном наборе данных. Дополнительные сведения см. в разделе [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).  
  
 При настройке преобразования «Уточняющий запрос» для использования диспетчера соединений OLE DB, нужно выбрать таблицу, представление или SQL-запрос для создания эталонного набора данных.  
  
### <a name="to-implement-a-lookup-transformation-in-full-cache-mode-by-using-ole-db-connection-manager"></a>Реализация преобразования «Уточняющий запрос» с полным кэшированием с помощью диспетчера соединений OLE DB  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте проект [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , содержащий нужный пакет, а затем дважды щелкните этот пакет в обозревателе решений.  
  
2.  Щелкните вкладку **Поток данных** , а затем перетащите преобразование «Уточняющий запрос» из **области элементов**в область конструктора.  
  
3.  Подключите преобразование «Уточняющий запрос» к потоку данных, перетащив соединитель из источника или предыдущего преобразования в преобразование «Уточняющий запрос».  
  
    > [!NOTE]  
    >  Преобразование «Уточняющий запрос» может не пройти проверку, если оно соединено с неструктурированным файлом, в котором содержится пустое поле данных. Успешность проверки преобразования зависит от того, включено ли в диспетчере соединений для неструктурированного файла сохранение значений NULL. Чтобы гарантировать успешность проверки преобразования «Уточняющий запрос», выберите в **редакторе источника «неструктурированный файл»** на странице **Диспетчер соединений**параметр **Оставлять значения NULL из источника в потоке данных** .  
  
4.  Чтобы настроить компонент, дважды щелкните источник или предыдущее преобразование.  
  
5.  Дважды щелкните преобразование "Уточняющий запрос", а затем в окне **Редактор преобразования "Уточняющий запрос"** на странице **Общие** выберите **Полное кэширование**.  
  
6.  В области **Тип соединения** выберите **Диспетчер соединений OLE DB**.  
  
7.  В списке **Укажите метод обработки строк без совпадающих элементов** выберите параметр обработки ошибок для строк без совпадающих элементов.  
  
8.  На странице «Соединение» выберите диспетчер соединений из списка **Диспетчер соединений OLE DB** или нажмите кнопку **Создать** , чтобы создать новый диспетчер соединений. Дополнительные сведения см. в разделе [Диспетчер соединений OLE DB](ole-db-connection-manager.md).  
  
9. Выполните следующие действия.  
  
    -   Выберите параметр **Использовать таблицу или представление**, а затем выберите таблицу или представление; либо нажмите кнопку **Создать** , чтобы создать таблицу или представление.  
  
         -или-  
  
    -   Щелкните мышью **Использовать результаты SQL-запроса**и введите запрос в окне **Команда SQL** или щелкните **Создать запрос** для создания запроса с помощью графических средств, предоставляемых **построителем запросов** .  
  
         -или-  
  
    -   Можно также щелкнуть **Обзор** для импорта инструкции SQL из файла.  
  
     Для проверки SQL-запроса щелкните **Анализ запроса**.  
  
     Чтобы просмотреть образец, нажмите кнопку **Просмотр**.  
  
10. Перейдите на страницу **Столбцы** и перетащите хотя бы один из столбцов в списке **Доступные входные столбцы** в столбец из списка **Доступные уточняющие столбцы** .  
  
    > [!NOTE]  
    >  Преобразование «Уточняющий запрос» автоматически сопоставляет столбцы, которые обладают одинаковыми названиями и типами данных.  
  
    > [!NOTE]  
    >  Типы данных сопоставляемых столбцов должны совпадать. Дополнительные сведения см. в разделе [Integration Services Data Types](../data-flow/integration-services-data-types.md).  
  
11. Включите столбцы подстановки в выходные данные, выполнив следующие действия.  
  
    1.  В списке **Доступные столбцы подстановки** . выберите столбцы.  
  
    2.  Затем в списке **Операция поиска** укажите, будут ли значения из столбцов подстановки заменять значения входных столбцов или они будут записаны в новый столбец.  
  
12. Чтобы настроить вывод ошибок, перейдите на страницу **Вывод ошибок** и задайте параметры обработки ошибок. Дополнительные сведения см. в разделе [Редактор преобразования "Уточняющий запрос" (страница "Вывод ошибок")](../lookup-transformation-editor-error-output-page.md).  
  
13. Нажмите кнопку **ОК** , чтобы сохранить изменения в преобразовании «Уточняющий запрос», а затем запустите пакет.  
  
## <a name="see-also"></a>См. также:  
 [Реализация преобразования "Уточняющий запрос" в режиме полного кэширования с помощью преобразования диспетчера подключений с кэшем](lookup-transformation-full-cache-mode-ole-db-connection-manager.md)   
 [Реализация уточняющего запроса в режиме "Частичное кэширование" или "Без кэширования"](../data-flow/transformations/implement-a-lookup-in-no-cache-or-partial-cache-mode.md)   
 [Преобразования служб Integration Services](../data-flow/transformations/integration-services-transformations.md)  
  
  
