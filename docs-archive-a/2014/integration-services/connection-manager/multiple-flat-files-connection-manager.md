---
title: Диспетчер соединения с несколькими неструктурированными файлами | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Multiple Flat Files connection manager
- connections [Integration Services], flat files
- flat files
- flat file connections [Integration Services]
- connection managers [Integration Services], Multiple Flat Files
- multiple flat file connections
ms.assetid: 31fc3f7a-d323-44f5-a907-1fa3de66631a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a17125fedb495daabc4838161b3260c0d5590319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667351"
---
# <a name="multiple-flat-files-connection-manager"></a><span data-ttu-id="23daf-102">диспетчер соединения с несколькими неструктурированными файлами</span><span class="sxs-lookup"><span data-stu-id="23daf-102">Multiple Flat Files Connection Manager</span></span>
  <span data-ttu-id="23daf-103">Диспетчер соединения с несколькими неструктурированными файлами позволяет пакету получить доступ к данным в нескольких неструктурированных файлах.</span><span class="sxs-lookup"><span data-stu-id="23daf-103">A Multiple Flat Files connection manager enables a package to access data in multiple flat files.</span></span> <span data-ttu-id="23daf-104">Например, источник неструктурированных файлов может использовать диспетчер соединения с несколькими неструктурированными файлами, если задача потока данных находится в контейнере цикла, например в контейнере «цикл по элементам».</span><span class="sxs-lookup"><span data-stu-id="23daf-104">For example, a Flat File source can use a Multiple Flat Files connection manager when the Data Flow task is inside a loop container, such as the For Loop container.</span></span> <span data-ttu-id="23daf-105">В каждом цикле контейнера источник неструктированных файлов загружает данные из следующего имени файла, которое предоставляет диспетчер соединения с несколькими неструктурированными файлами.</span><span class="sxs-lookup"><span data-stu-id="23daf-105">On each loop of the container, the Flat File source loads data from the next file name that the Multiple Flat Files connection manager provides.</span></span>  
  
 <span data-ttu-id="23daf-106">При добавлении к пакету диспетчера соединений с несколькими неструктурированными файлами [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] создает диспетчер соединений, который будет разрешать соединение с несколькими неструктурированными файлами во время выполнения, задает свойства диспетчера соединений с несколькими неструктурированными файлами и добавляет диспетчер соединений с несколькими неструктурированными файлами в `Connections` коллекцию пакета.</span><span class="sxs-lookup"><span data-stu-id="23daf-106">When you add a Multiple Flat Files connection manager to a package, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] creates a connection manager that will resolve to a Multiple Flat Files connection at run time, sets the properties on the Multiple Flat Files connection manager, and adds the Multiple Flat Files connection manager to the `Connections` collection of the package.</span></span>  
  
 <span data-ttu-id="23daf-107">Свойству `ConnectionManagerType` диспетчера соединений присваивается значение `MULTIFLATFILE`.</span><span class="sxs-lookup"><span data-stu-id="23daf-107">The `ConnectionManagerType` property of the connection manager is set to `MULTIFLATFILE`.</span></span>  
  
 <span data-ttu-id="23daf-108">Можно установить конфигурацию диспетчера соединений с несколькими неструктурированными файлами следующими способами.</span><span class="sxs-lookup"><span data-stu-id="23daf-108">You can configure the Multiple Flat Files connection manager in the following ways:</span></span>  
  
-   <span data-ttu-id="23daf-109">Укажите файлы, локаль и кодовую страницу для использования.</span><span class="sxs-lookup"><span data-stu-id="23daf-109">Specify the files, locale, and code page to use.</span></span> <span data-ttu-id="23daf-110">Локаль используется для интерпретации данных, зависящих от локаля, например дат, а кодовая страница используется для конвертации строковых данных в формат Юникод.</span><span class="sxs-lookup"><span data-stu-id="23daf-110">The locale is used to interpret locale-sensitive data such as dates, and the code page is used to convert string data to Unicode.</span></span>  
  
-   <span data-ttu-id="23daf-111">Укажите формат файла.</span><span class="sxs-lookup"><span data-stu-id="23daf-111">Specify the file format.</span></span> <span data-ttu-id="23daf-112">Можно использовать форматы с разделителями, фиксированной шириной или без выравнивания по правому краю.</span><span class="sxs-lookup"><span data-stu-id="23daf-112">You can use a delimited, fixed width, or ragged right format.</span></span>  
  
-   <span data-ttu-id="23daf-113">Укажите строку заголовка, строку данных и разделители столбцов.</span><span class="sxs-lookup"><span data-stu-id="23daf-113">Specify a header row, data row, and column delimiters.</span></span> <span data-ttu-id="23daf-114">Разделители столбцов могут указываться на уровне файла и перезаписываться на уровне столбцов.</span><span class="sxs-lookup"><span data-stu-id="23daf-114">Column delimiters can be set at the file level and overwritten at the column level.</span></span>  
  
-   <span data-ttu-id="23daf-115">Укажите, содержит ли первая строка данных имена столбцов.</span><span class="sxs-lookup"><span data-stu-id="23daf-115">Indicate whether the first row in the files contains column names.</span></span>  
  
-   <span data-ttu-id="23daf-116">Укажите символ ограничителя текста.</span><span class="sxs-lookup"><span data-stu-id="23daf-116">Specify a text qualifier character.</span></span> <span data-ttu-id="23daf-117">Каждый столбец может быть настроен на распознавание текстового ограничителя.</span><span class="sxs-lookup"><span data-stu-id="23daf-117">Each column can be configured to recognize a text qualifier.</span></span>  
  
-   <span data-ttu-id="23daf-118">Установите свойства, например имя, тип данных и максимальную ширину отдельных столбцов.</span><span class="sxs-lookup"><span data-stu-id="23daf-118">Set properties such as the name, data type, and maximum width on individual columns.</span></span>  
  
 <span data-ttu-id="23daf-119">Когда диспетчер соединений нескольких неструктурированных файлов ссылается на несколько файлов, то пути этих файлов разделены символом вертикальной черты (|).</span><span class="sxs-lookup"><span data-stu-id="23daf-119">When the Multiple Flat Files connection manager references multiple files, the paths of the files are separated by the pipe (|) character.</span></span> <span data-ttu-id="23daf-120">Свойство `ConnectionString` диспетчера соединений имеет следующий формат:</span><span class="sxs-lookup"><span data-stu-id="23daf-120">The `ConnectionString` property of the connection manager has the following format:</span></span>  
  
 \<*path*>|\<*path*>  
  
 <span data-ttu-id="23daf-121">Можно также указать несколько файлов, используя символы-шаблоны.</span><span class="sxs-lookup"><span data-stu-id="23daf-121">You can also specify multiple files by using wildcard characters.</span></span> <span data-ttu-id="23daf-122">Например, чтобы сослаться на все текстовые файлы на диске C, `ConnectionString` можно задать для свойства значение C: \\ \*. txt.</span><span class="sxs-lookup"><span data-stu-id="23daf-122">For example, to reference all the text files on the C drive, the value of the `ConnectionString` property can be set to C:\\*.txt.</span></span>  
  
 <span data-ttu-id="23daf-123">Если диспетчер соединений с несколькими неструктурированными файлами ссылается на несколько файлов, то все файлы должны иметь один формат.</span><span class="sxs-lookup"><span data-stu-id="23daf-123">If a Multiple Flat Files connection manager references multiple files, all the files must have the same format.</span></span>  
  
 <span data-ttu-id="23daf-124">По умолчанию диспетчер соединений с несколькими неструктурированными файлами устанавливает длину строковых столбцов в значение 50 символов.</span><span class="sxs-lookup"><span data-stu-id="23daf-124">By default, the Multiple Flat Files connection manager sets the length of string columns to 50 characters.</span></span> <span data-ttu-id="23daf-125">В диалоговом окне **Редактор диспетчера соединений с несколькими неструктурированными файлами** можно оценить образцы данных и автоматически изменить длину этих столбцов, чтобы предотвратить усечение данных или избыточность ширины столбца.</span><span class="sxs-lookup"><span data-stu-id="23daf-125">In the **Multiple Flat Files Connection Manager Editor** dialog box, you can evaluate sample data and automatically resize the length of these columns to prevent truncation of data or excess column width.</span></span> <span data-ttu-id="23daf-126">Если изменение длины столбца происходит не в источнике или преобразовании неструктурированного файла, то длина столбца остается неизменной на всем потоке данных.</span><span class="sxs-lookup"><span data-stu-id="23daf-126">Unless you resize the column length in a Flat File source or a transformation, the column length remains the same throughout the data flow.</span></span> <span data-ttu-id="23daf-127">Если эти столбцы сопоставляются с более узкими целевыми столбцами, то пользователю выдается предупреждение, а во время выполнения могут возникнуть ошибки, связанные с усечением данных.</span><span class="sxs-lookup"><span data-stu-id="23daf-127">If these columns map to destination columns that are narrower, warnings appear in the user interface, and at run time, errors may occur due to data truncation.</span></span> <span data-ttu-id="23daf-128">Можно изменить размер столбцов так, чтобы столбцы соответствовали целевым столбцам в диспетчере соединений с неструктурированными файлами, источнике неструктурированных файлов или преобразовании.</span><span class="sxs-lookup"><span data-stu-id="23daf-128">You can resize the columns to be compatible with the destination columns in the Flat File connection manager, the Flat File source, or a transformation.</span></span> <span data-ttu-id="23daf-129">Чтобы изменить длину выходных столбцов, задайте `Length` свойство выходного столбца на вкладке **свойства входных и выходных данных** в диалоговом окне **Расширенный редактор** .</span><span class="sxs-lookup"><span data-stu-id="23daf-129">To modify the length of output columns, you set the `Length` property of the output column on the **Input and Output Properties** tab in the **Advanced Editor** dialog box.</span></span>  
  
 <span data-ttu-id="23daf-130">Если длина столбцов обновляется в диспетчере соединений с несколькими неструктурированными файлами, после того как был добавлен и настроен источник неструктурированного файла, который использует диспетчер соединений, то нельзя вручную изменять размер выходных столбцов в источнике неструктурированного файла.</span><span class="sxs-lookup"><span data-stu-id="23daf-130">If you update column lengths in the Multiple Flat Files connection manager after you have added and configured the Flat File source that uses the connection manager, you do not have to manually resize the output columns in the Flat File source.</span></span> <span data-ttu-id="23daf-131">При открытии диалогового окна **Источник «Неструктурированный файл»** источник неструктурированного файла предоставляет параметр для синхронизации метаданных столбца.</span><span class="sxs-lookup"><span data-stu-id="23daf-131">When you open the **Flat File Source** dialog box, the Flat File source provides an option to synchronize the column metadata.</span></span>  
  
## <a name="configuration-of-the-multiple-flat-files-connection-manager"></a><span data-ttu-id="23daf-132">Конфигурация диспетчера соединений с несколькими неструктурированными файлами</span><span class="sxs-lookup"><span data-stu-id="23daf-132">Configuration of the Multiple Flat Files Connection Manager</span></span>  
 <span data-ttu-id="23daf-133">Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../../includes/ssis-md.md)] или программными средствами.</span><span class="sxs-lookup"><span data-stu-id="23daf-133">You can set properties through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
 <span data-ttu-id="23daf-134">Дополнительные сведения о свойствах, которые можно задать в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] , см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="23daf-134">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="23daf-135">Редактор диспетчера подключений с несколькими неструктурированными файлами (страница "Общие")</span><span class="sxs-lookup"><span data-stu-id="23daf-135">Multiple Flat Files Connection Manager Editor &#40;General Page&#41;</span></span>](../general-page-of-integration-services-designers-options.md)  
  
-   [<span data-ttu-id="23daf-136">Редактор диспетчера подключений с несколькими неструктурированными файлами (страница "Столбцы")</span><span class="sxs-lookup"><span data-stu-id="23daf-136">Multiple Flat Files Connection Manager Editor &#40;Columns Page&#41;</span></span>](../multiple-flat-files-connection-manager-editor-columns-page.md)  
  
-   [<span data-ttu-id="23daf-137">Редактор диспетчера подключений с несколькими неструктурированными файлами (страница "Дополнительно")</span><span class="sxs-lookup"><span data-stu-id="23daf-137">Multiple Flat Files Connection Manager Editor &#40;Advanced Page&#41;</span></span>](../multiple-flat-files-connection-manager-editor-advanced-page.md)  
  
-   [<span data-ttu-id="23daf-138">Редактор диспетчера подключений с несколькими неструктурированными файлами (страница "Предварительный просмотр")</span><span class="sxs-lookup"><span data-stu-id="23daf-138">Multiple Flat Files Connection Manager Editor &#40;Preview Page&#41;</span></span>](../multiple-flat-files-connection-manager-editor-preview-page.md)  
  
 <span data-ttu-id="23daf-139">Дополнительные сведения о программной настройке диспетчера подключений см. в разделах <xref:Microsoft.SqlServer.Dts.Runtime.ConnectionManager> и [Добавление соединений программным образом](../building-packages-programmatically/adding-connections-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="23daf-139">For information about configuring a connection manager programmatically, see <xref:Microsoft.SqlServer.Dts.Runtime.ConnectionManager> and [Adding Connections Programmatically](../building-packages-programmatically/adding-connections-programmatically.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="23daf-140">См. также:</span><span class="sxs-lookup"><span data-stu-id="23daf-140">See Also</span></span>  
 <span data-ttu-id="23daf-141">[Источник «Неструктурированный файл»](../data-flow/flat-file-source.md) </span><span class="sxs-lookup"><span data-stu-id="23daf-141">[Flat File Source](../data-flow/flat-file-source.md) </span></span>  
 <span data-ttu-id="23daf-142">[Назначение «Неструктурированный файл»](../data-flow/flat-file-destination.md) </span><span class="sxs-lookup"><span data-stu-id="23daf-142">[Flat File Destination](../data-flow/flat-file-destination.md) </span></span>  
 [<span data-ttu-id="23daf-143">Соединения в службах Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="23daf-143">Integration Services &#40;SSIS&#41; Connections</span></span>](integration-services-ssis-connections.md)  
  
  
