---
title: Реализация преобразования «Уточняющий запрос» в режиме полного кэширования с помощью диспетчера соединений с кэшем | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Lookup transformation [Integration Services]
ms.assetid: 58bc7611-5fb5-4113-9742-10959e06b94c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 8b8c77f7ecfbe79db00acce09f706468ec0a0055
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667363"
---
# <a name="implement-a-lookup-transformation-in-full-cache-mode-using-the-cache-connection-manager"></a><span data-ttu-id="580c1-102">Реализация преобразования "Уточняющий запрос" в режиме полного кэширования с помощью преобразования диспетчера соединений с кэшем</span><span class="sxs-lookup"><span data-stu-id="580c1-102">Implement a Lookup Transformation in Full Cache Mode Using the Cache Connection Manager</span></span>
  <span data-ttu-id="580c1-103">Можно настроить преобразование «Уточняющий запрос», чтобы использовать режим полного кэширования и диспетчер соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-103">You can configure the Lookup transformation to use full cache mode and a Cache connection manager.</span></span> <span data-ttu-id="580c1-104">В режиме полного кэширования эталонный набор данных загружается в кэш еще до запуска преобразования «Уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="580c1-104">In full cache mode, the reference dataset is loaded into cache before the Lookup transformation runs.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="580c1-105">Диспетчер соединений с кэшем не поддерживает типы данных больших двоичных объектов: DT_TEXT, DT_NTEXT и DT_IMAGE.</span><span class="sxs-lookup"><span data-stu-id="580c1-105">The Cache connection manager does not support the Binary Large Object (BLOB) data types DT_TEXT, DT_NTEXT, and DT_IMAGE.</span></span> <span data-ttu-id="580c1-106">Если ссылочный набор данных содержит данные типа BLOB, то при попытке выполнения пакета компонент завершится сбоем.</span><span class="sxs-lookup"><span data-stu-id="580c1-106">If the reference dataset contains a BLOB data type, the component will fail when you run the package.</span></span> <span data-ttu-id="580c1-107">**Редактор диспетчера соединений с кэшем** можно использовать для изменения типов данных столбцов.</span><span class="sxs-lookup"><span data-stu-id="580c1-107">You can use the **Cache Connection Manager Editor** to modify column data types.</span></span> <span data-ttu-id="580c1-108">Дополнительные сведения см. в разделе [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-108">For more information, see [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span></span>  
  
 <span data-ttu-id="580c1-109">Преобразование «Уточняющий запрос» выполняет уточняющие запросы, соединяя данные из входных столбцов подключенного источника данных и данные из столбцов в эталонном наборе данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-109">The Lookup transformation performs lookups by joining data in input columns from a connected data source with columns in a reference dataset.</span></span> <span data-ttu-id="580c1-110">Дополнительные сведения см. в разделе [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-110">For more information, see [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).</span></span>  
  
 <span data-ttu-id="580c1-111">Чтобы создать эталонный набор данных, используется один из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="580c1-111">You use one of the following to generate a reference dataset:</span></span>  
  
-   <span data-ttu-id="580c1-112">Файл кэша (CAW)</span><span class="sxs-lookup"><span data-stu-id="580c1-112">Cache file (.caw)</span></span>  
  
     <span data-ttu-id="580c1-113">Диспетчер соединений с кэшем настраивается на считывание данных из существующего файла кэша.</span><span class="sxs-lookup"><span data-stu-id="580c1-113">You configure the Cache connection manager to read data from an existing cache file.</span></span>  
  
-   <span data-ttu-id="580c1-114">Подключенный источник данных в потоке данных</span><span class="sxs-lookup"><span data-stu-id="580c1-114">Connected data source in the data flow</span></span>  
  
     <span data-ttu-id="580c1-115">Используется преобразование «Преобразование кэша» для записи данных из подключенного источника данных в поток данных с помощью диспетчера соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-115">You use a Cache Transform transformation to write data from a connected data source in the data flow to a Cache connection manager.</span></span> <span data-ttu-id="580c1-116">Данные всегда сохраняются в памяти.</span><span class="sxs-lookup"><span data-stu-id="580c1-116">The data is always stored in memory.</span></span>  
  
     <span data-ttu-id="580c1-117">Необходимо добавить преобразование «Уточняющий запрос» к отдельному потоку данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-117">You must add the Lookup transformation to a separate data flow.</span></span> <span data-ttu-id="580c1-118">Это позволяет использовать преобразование «Преобразование кэша» для заполнения данными диспетчера соединений с кэшем перед выполнением преобразования «Уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="580c1-118">This enables the Cache Transform to populate the Cache connection manager before the Lookup transformation is executed.</span></span> <span data-ttu-id="580c1-119">Потоки данных могут находиться в том же пакете или в двух разных пакетах.</span><span class="sxs-lookup"><span data-stu-id="580c1-119">The data flows can be in the same package or in two separate packages.</span></span>  
  
     <span data-ttu-id="580c1-120">Если потоки данных находятся в одном и том же пакете, чтобы подключить потоки данных, используется управление очередностью.</span><span class="sxs-lookup"><span data-stu-id="580c1-120">If the data flows are in the same package, use a precedence constraint to connect the data flows.</span></span> <span data-ttu-id="580c1-121">Это позволяет запустить преобразование «Преобразование кэша» до выполнения преобразования «Уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="580c1-121">This enables the Cache Transform to run before the Lookup transformation runs.</span></span>  
  
     <span data-ttu-id="580c1-122">Если потоки данных находятся в отдельных пакетах, можно использовать задачу «Выполнение пакета», чтобы вызвать дочерний пакет из родительского пакета.</span><span class="sxs-lookup"><span data-stu-id="580c1-122">If the data flows are in separate packages, you can use the Execute Package task to call the child package from the parent package.</span></span> <span data-ttu-id="580c1-123">Можно вызывать несколько дочерних пакетов, добавляя несколько задач «Выполнение пакета» к задаче «Контейнер последовательности» в родительском пакете.</span><span class="sxs-lookup"><span data-stu-id="580c1-123">You can call multiple child packages by adding multiple Execute Package tasks to a Sequence Container task in the parent package.</span></span>  
  
 <span data-ttu-id="580c1-124">Можно обеспечить совместное использование эталонного набора данных, хранимого в кэше, несколькими преобразованиями «Уточняющий запрос» с помощью одного из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="580c1-124">You can share the reference dataset stored in cache, between multiple Lookup transformations by using one of the following methods:</span></span>  
  
-   <span data-ttu-id="580c1-125">Настроить преобразования «Уточняющий запрос» в единственном пакете для использования одного и того же диспетчера соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-125">Configure the Lookup transformations in a single package to use the same Cache connection manager.</span></span>  
  
-   <span data-ttu-id="580c1-126">Настроить диспетчеры соединений с кэшем в разных пакетах, чтобы использовать один и тот же файл кэша.</span><span class="sxs-lookup"><span data-stu-id="580c1-126">Configure the Cache connection managers in different packages to use the same cache file.</span></span>  
  
 <span data-ttu-id="580c1-127">Дополнительные сведения см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="580c1-127">For more information, see the following topics:</span></span>  
  
-   [<span data-ttu-id="580c1-128">Преобразование кэша</span><span class="sxs-lookup"><span data-stu-id="580c1-128">Cache Transform</span></span>](../data-flow/transformations/cache-transform.md)  
  
-   [<span data-ttu-id="580c1-129">Диспетчер соединений с кэшем</span><span class="sxs-lookup"><span data-stu-id="580c1-129">Cache Connection Manager</span></span>](cache-connection-manager.md)  
  
-   [<span data-ttu-id="580c1-130">Управление очередностью</span><span class="sxs-lookup"><span data-stu-id="580c1-130">Precedence Constraints</span></span>](../control-flow/precedence-constraints.md)  
  
-   [<span data-ttu-id="580c1-131">Задача «Выполнение пакета»</span><span class="sxs-lookup"><span data-stu-id="580c1-131">Execute Package Task</span></span>](../control-flow/execute-package-task.md)  
  
-   [<span data-ttu-id="580c1-132">Контейнер последовательности</span><span class="sxs-lookup"><span data-stu-id="580c1-132">Sequence Container</span></span>](../control-flow/sequence-container.md)  
  
 <span data-ttu-id="580c1-133">Видеоматериал, в котором показано, как реализовать преобразование "Уточняющий запрос" в режиме полного кэширования с помощью диспетчера подключений с кэшем, см. в статье [Как реализовать преобразование "Уточняющий запрос" в режиме полного кэширования (видеоматериал по SQL Server)](https://go.microsoft.com/fwlink/?LinkId=131031).</span><span class="sxs-lookup"><span data-stu-id="580c1-133">For a video that demonstrates how to implement a Lookup transformation in Full Cache mode using the Cache connection manager, see [How to: Implement a Lookup Transformation in Full Cache Mode (SQL Server Video)](https://go.microsoft.com/fwlink/?LinkId=131031).</span></span>  
  
### <a name="to-implement-a-lookup-transformation-in-full-cache-mode-in-one-package-by-using-cache-connection-manager-and-a-data-source-in-the-data-flow"></a><span data-ttu-id="580c1-134">Реализация преобразования «Уточняющий запрос» в режиме полного кэширования в одном пакете с использованием диспетчера соединений с кэшем и источника данных в потоке данных</span><span class="sxs-lookup"><span data-stu-id="580c1-134">To implement a Lookup transformation in full cache mode in one package by using Cache connection manager and a data source in the data flow</span></span>  
  
1.  <span data-ttu-id="580c1-135">В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте проект служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , а затем откройте пакет.</span><span class="sxs-lookup"><span data-stu-id="580c1-135">In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], open a [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] project, and then open a package.</span></span>  
  
2.  <span data-ttu-id="580c1-136">На вкладке **Поток управления** добавьте две задачи потока данных, а затем соедините эти задачи с помощью зеленого соединителя.</span><span class="sxs-lookup"><span data-stu-id="580c1-136">On the **Control Flow** tab, add two Data Flow tasks, and then connect the tasks by using a green connector:</span></span>  
  
3.  <span data-ttu-id="580c1-137">В первом потоке данных добавьте преобразование «Преобразование кэша», а затем подключите это преобразование к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-137">In the first data flow, add a Cache Transform transformation, and then connect the transformation to a data source.</span></span>  
  
     <span data-ttu-id="580c1-138">При необходимости настройте источник данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-138">Configure the data source as needed.</span></span>  
  
4.  <span data-ttu-id="580c1-139">Дважды щелкните "Преобразование кэша", а затем в окне **Редактор преобразований кэша**на странице **Диспетчер соединений** щелкните **Создать** , чтобы создать новый диспетчер соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-139">Double-click the Cache Transform, and then in the **Cache Transformation Editor**, on the **Connection Manager** page, click **New** to create a new Cache connection manager.</span></span>  
  
5.  <span data-ttu-id="580c1-140">Перейдите на вкладку **Столбцы** диалогового окна **Редактор диспетчера соединений с кэшем** и с помощью параметра **Значение индекса** укажите, какие столбцы являются индексными столбцами.</span><span class="sxs-lookup"><span data-stu-id="580c1-140">Click the **Columns** tab of the **Cache Connection Manager Editor** dialog box, and then specify which columns are the index columns by using the **Index Position** option.</span></span>  
  
     <span data-ttu-id="580c1-141">Для неиндексированных столбцов позиция индекса равна 0.</span><span class="sxs-lookup"><span data-stu-id="580c1-141">For non-index columns, the index position is 0.</span></span> <span data-ttu-id="580c1-142">Для индексированных столбцов позиция индекса является положительным порядковым номером.</span><span class="sxs-lookup"><span data-stu-id="580c1-142">For index columns, the index position is a sequential, positive number.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="580c1-143">Если преобразование «Уточняющий запрос» настроено для использования диспетчера соединений с кэшем, то только индексированные столбцы в ссылочном наборе данных могут быть сопоставлены с входными столбцами.</span><span class="sxs-lookup"><span data-stu-id="580c1-143">When the Lookup transformation is configured to use a Cache connection manager, only index columns in the reference dataset can be mapped to input columns.</span></span> <span data-ttu-id="580c1-144">Кроме того, все столбцы индекса должны быть сопоставлены.</span><span class="sxs-lookup"><span data-stu-id="580c1-144">Also, all index columns must be mapped.</span></span> <span data-ttu-id="580c1-145">Дополнительные сведения см. в разделе [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-145">For more information, see [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span></span>  
  
6.  <span data-ttu-id="580c1-146">Чтобы сохранить содержимое кэша в файле, настройте диспетчер соединений с кэшем в окне **Редактор диспетчера соединений с кэшем**на вкладке **Общие** . Для этого задайте следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="580c1-146">To save the cache to a file, in the **Cache Connection Manager Editor**, on the **General** tab, configure the Cache connection manager by setting the following options:</span></span>  
  
    -   <span data-ttu-id="580c1-147">Выберите **Использовать кэш файлов**.</span><span class="sxs-lookup"><span data-stu-id="580c1-147">Select **Use file cache**.</span></span>  
  
    -   <span data-ttu-id="580c1-148">В поле **Имя файла**введите имя файла или нажмите кнопку **Обзор** и выберите файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-148">For **File name**, either type the file path or click **Browse** to select the file.</span></span>  
  
         <span data-ttu-id="580c1-149">Если ввести путь к несуществующему файлу, то система создаст файл только при выполнении пакета.</span><span class="sxs-lookup"><span data-stu-id="580c1-149">If you type a path for a file that does not exist, the system creates the file when you run the package.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="580c1-150">Уровень защиты пакета не применяется к кэшируемому файлу.</span><span class="sxs-lookup"><span data-stu-id="580c1-150">The protection level of the package does not apply to the cache file.</span></span> <span data-ttu-id="580c1-151">Если кэшируемый файл содержит важные данные, используйте список управления доступом (ACL), чтобы запретить доступ к расположению или папке, в которой хранится файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-151">If the cache file contains sensitive information, use an access control list (ACL) to restrict access to the location or folder in which you store the file.</span></span> <span data-ttu-id="580c1-152">Доступ следует разрешать только определенным учетным записям.</span><span class="sxs-lookup"><span data-stu-id="580c1-152">You should enable access only to certain accounts.</span></span> <span data-ttu-id="580c1-153">Дополнительные сведения см. в разделе [Доступ к файлам, используемым пакетами](../access-to-files-used-by-packages.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-153">For more information, see [Access to Files Used by Packages](../access-to-files-used-by-packages.md).</span></span>  
  
7.  <span data-ttu-id="580c1-154">При необходимости настройте преобразование кэша.</span><span class="sxs-lookup"><span data-stu-id="580c1-154">Configure the Cache Transform as needed.</span></span> <span data-ttu-id="580c1-155">Дополнительные сведения см. в разделах [Редактор преобразования "Кэш" (страница "Диспетчер соединений")](../cache-transformation-editor-connection-manager-page.md) и [Редактор преобразования "Кэш" (страница "Сопоставления")](../cache-transformation-editor-mappings-page.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-155">For more information, see [Cache Transformation Editor &#40;Connection Manager Page&#41;](../cache-transformation-editor-connection-manager-page.md) and [Cache Transformation Editor &#40;Mappings Page&#41;](../cache-transformation-editor-mappings-page.md).</span></span>  
  
8.  <span data-ttu-id="580c1-156">Во втором потоке данных добавьте преобразование «Уточняющий запрос», а затем настройте преобразование, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="580c1-156">In the second data flow, add a Lookup transformation, and then configure the transformation by doing the following tasks:</span></span>  
  
    1.  <span data-ttu-id="580c1-157">Подключите преобразование «Уточняющий запрос» к потоку данных, перетащив соединитель из источника или предыдущего преобразования в преобразование «Уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="580c1-157">Connect the Lookup transformation to the data flow by dragging a connector from a source or a previous transformation to the Lookup transformation.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-158">Преобразование «Уточняющий запрос» может не пройти проверку, если оно соединено с неструктурированным файлом, в котором содержится пустое поле данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-158">A Lookup transformation might not validate if that transformation connects to a flat file that contains an empty date field.</span></span> <span data-ttu-id="580c1-159">Успешность проверки преобразования зависит от того, включено ли в диспетчере соединений для неструктурированного файла сохранение значений NULL.</span><span class="sxs-lookup"><span data-stu-id="580c1-159">Whether the transformation validates depends on whether the connection manager for the flat file has been configured to retain null values.</span></span> <span data-ttu-id="580c1-160">Чтобы гарантировать успешность проверки преобразования «Уточняющий запрос», выберите в **редакторе источника «неструктурированный файл»** на странице **Диспетчер соединений**параметр **Оставлять значения NULL из источника в потоке данных** .</span><span class="sxs-lookup"><span data-stu-id="580c1-160">To ensure that the Lookup transformation validates, in the **Flat File Source Editor**, on the **Connection Manager Page**, select the **Retain null values from the source as null values in the data flow** option.</span></span>  
  
    2.  <span data-ttu-id="580c1-161">Чтобы настроить компонент, дважды щелкните источник или предыдущее преобразование.</span><span class="sxs-lookup"><span data-stu-id="580c1-161">Double-click the source or previous transformation to configure the component.</span></span>  
  
    3.  <span data-ttu-id="580c1-162">Дважды щелкните преобразование "Уточняющий запрос", а затем в окне **Редактор преобразования "Уточняющий запрос"** на странице **Общие** выберите **Полное кэширование**.</span><span class="sxs-lookup"><span data-stu-id="580c1-162">Double-click the Lookup transformation, and then in the **Lookup Transformation Editor**, on the **General** page, select **Full cache**.</span></span>  
  
    4.  <span data-ttu-id="580c1-163">В области **Тип соединения** выберите **Диспетчер соединений с кэшем**.</span><span class="sxs-lookup"><span data-stu-id="580c1-163">In the **Connection type** area, select **Cache connection manager**.</span></span>  
  
    5.  <span data-ttu-id="580c1-164">В списке **Укажите метод обработки строк без совпадающих элементов** выберите параметр обработки ошибок.</span><span class="sxs-lookup"><span data-stu-id="580c1-164">From the **Specify how to handle rows with no matching entries** list, select an error handling option.</span></span>  
  
    6.  <span data-ttu-id="580c1-165">На странице **Соединение** выберите диспетчер соединений с кэшем в списке **Диспетчер соединений с кэшем** .</span><span class="sxs-lookup"><span data-stu-id="580c1-165">On the **Connection** page, from the **Cache connection manager** list, select a Cache connection manager.</span></span>  
  
    7.  <span data-ttu-id="580c1-166">Перейдите на страницу **Столбцы** и перетащите хотя бы один из столбцов в списке **Доступные входные столбцы** в столбец из списка **Доступные столбцы подстановки** .</span><span class="sxs-lookup"><span data-stu-id="580c1-166">Click the **Columns** page, and then drag at least one column from the **Available Input Columns** list to a column in the **Available Lookup Column** list.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-167">Преобразование «Уточняющий запрос» автоматически сопоставляет столбцы, которые обладают одинаковыми названиями и типами данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-167">The Lookup transformation automatically maps columns that have the same name and the same data type.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-168">Типы данных сопоставляемых столбцов должны совпадать.</span><span class="sxs-lookup"><span data-stu-id="580c1-168">Columns must have matching data types to be mapped.</span></span> <span data-ttu-id="580c1-169">Дополнительные сведения см. в разделе [Integration Services Data Types](../data-flow/integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-169">For more information, see [Integration Services Data Types](../data-flow/integration-services-data-types.md).</span></span>  
  
    8.  <span data-ttu-id="580c1-170">В списке **Доступные столбцы подстановки** выберите столбцы.</span><span class="sxs-lookup"><span data-stu-id="580c1-170">In the **Available Lookup Columns** list, select columns.</span></span> <span data-ttu-id="580c1-171">Затем в списке **Операция поиска** задайте, будут ли значения из столбцов подстановки замещать значения из входных столбцов или же они будут перезаписаны в новый столбец.</span><span class="sxs-lookup"><span data-stu-id="580c1-171">Then in the **Lookup Operation** list, specify whether the values from the lookup columns replace values in the input column or are written to a new column.</span></span>  
  
    9. <span data-ttu-id="580c1-172">Чтобы настроить вывод ошибок, перейдите на страницу **Вывод ошибок** и задайте параметры обработки ошибок.</span><span class="sxs-lookup"><span data-stu-id="580c1-172">To configure the error output, click the **Error Output** page and set the error handling options.</span></span> <span data-ttu-id="580c1-173">Дополнительные сведения см. в разделе [Редактор преобразования "Уточняющий запрос" (страница "Вывод ошибок")](../lookup-transformation-editor-error-output-page.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-173">For more information, see [Lookup Transformation Editor &#40;Error Output Page&#41;](../lookup-transformation-editor-error-output-page.md).</span></span>  
  
    10. <span data-ttu-id="580c1-174">Чтобы сохранить изменения в преобразовании «Уточняющий запрос», нажмите кнопку **ОК** .</span><span class="sxs-lookup"><span data-stu-id="580c1-174">Click **OK** to save your changes to the Lookup transformation.</span></span>  
  
9. <span data-ttu-id="580c1-175">Запустите пакет.</span><span class="sxs-lookup"><span data-stu-id="580c1-175">Run the package.</span></span>  
  
### <a name="to-implement-a-lookup-transformation-in-full-cache-mode-in-two-packages-by-using-cache-connection-manager-and-a-data-source-in-the-data-flow"></a><span data-ttu-id="580c1-176">Реализация преобразования «Уточняющий запрос» в режиме полного кэширования в двух пакетах с использованием диспетчера соединений с кэшем и источника данных в потоке данных</span><span class="sxs-lookup"><span data-stu-id="580c1-176">To implement a Lookup transformation in full cache mode in two packages by using Cache connection manager and a data source in the data flow</span></span>  
  
1.  <span data-ttu-id="580c1-177">В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте проект служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , а затем откройте два пакета.</span><span class="sxs-lookup"><span data-stu-id="580c1-177">In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], open a [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] project, and then open two packages.</span></span>  
  
2.  <span data-ttu-id="580c1-178">На вкладке «Поток управления» в каждом пакете добавьте задачу потока данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-178">On the Control Flow tab in each package, add a Data Flow task.</span></span>  
  
3.  <span data-ttu-id="580c1-179">В родительском пакете добавьте к потоку данных преобразование «Преобразование кэша», а затем подключите преобразование к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-179">In the parent package, add a Cache Transform transformation to the data flow, and then connect the transformation to a data source.</span></span>  
  
     <span data-ttu-id="580c1-180">При необходимости настройте источник данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-180">Configure the data source as needed.</span></span>  
  
4.  <span data-ttu-id="580c1-181">Дважды щелкните "Преобразование кэша", а затем в окне **Редактор преобразований кэша**на странице **Диспетчер соединений** щелкните **Создать** , чтобы создать новый диспетчер соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-181">Double-click the Cache Transform, and then in the **Cache Transformation Editor**, on the **Connection Manager** page, click **New** to create a new Cache connection manager.</span></span>  
  
5.  <span data-ttu-id="580c1-182">В окне **Редактор диспетчера соединений с кэшем**на вкладке **Общие** настройте диспетчер соединений с кэшем. Для этого задайте следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="580c1-182">In the **Cache Connection Manager Editor**, on the **General** tab, configure the Cache connection manager by setting the following options:</span></span>  
  
    -   <span data-ttu-id="580c1-183">Выберите **Использовать кэш файлов**.</span><span class="sxs-lookup"><span data-stu-id="580c1-183">Select **Use file cache**.</span></span>  
  
    -   <span data-ttu-id="580c1-184">В поле **Имя файла**введите имя файла или нажмите кнопку **Обзор** и выберите файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-184">For **File name**, either type the file path or click **Browse** to select the file.</span></span>  
  
         <span data-ttu-id="580c1-185">Если ввести путь к несуществующему файлу, то система создаст файл только при выполнении пакета.</span><span class="sxs-lookup"><span data-stu-id="580c1-185">If you type a path for a file that does not exist, the system creates the file when you run the package.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="580c1-186">Уровень защиты пакета не применяется к кэшируемому файлу.</span><span class="sxs-lookup"><span data-stu-id="580c1-186">The protection level of the package does not apply to the cache file.</span></span> <span data-ttu-id="580c1-187">Если кэшируемый файл содержит важные данные, используйте список управления доступом (ACL), чтобы запретить доступ к расположению или папке, в которой хранится файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-187">If the cache file contains sensitive information, use an access control list (ACL) to restrict access to the location or folder in which you store the file.</span></span> <span data-ttu-id="580c1-188">Доступ следует разрешать только определенным учетным записям.</span><span class="sxs-lookup"><span data-stu-id="580c1-188">You should enable access only to certain accounts.</span></span> <span data-ttu-id="580c1-189">Дополнительные сведения см. в разделе [Доступ к файлам, используемым пакетами](../access-to-files-used-by-packages.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-189">For more information, see [Access to Files Used by Packages](../access-to-files-used-by-packages.md).</span></span>  
  
6.  <span data-ttu-id="580c1-190">Перейдите на вкладку **Столбцы** , а затем задайте, какие столбцы будут столбцами индекса, с помощью параметра **Позиция индекса** .</span><span class="sxs-lookup"><span data-stu-id="580c1-190">Click the **Columns** tab, and then specify which columns are the index columns by using the **Index Position** option.</span></span>  
  
     <span data-ttu-id="580c1-191">Для неиндексированных столбцов позиция индекса равна 0.</span><span class="sxs-lookup"><span data-stu-id="580c1-191">For non-index columns, the index position is 0.</span></span> <span data-ttu-id="580c1-192">Для индексированных столбцов позиция индекса является положительным порядковым номером.</span><span class="sxs-lookup"><span data-stu-id="580c1-192">For index columns, the index position is a sequential, positive number.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="580c1-193">Если преобразование «Уточняющий запрос» настроено для использования диспетчера соединений с кэшем, то только индексированные столбцы в ссылочном наборе данных могут быть сопоставлены с входными столбцами.</span><span class="sxs-lookup"><span data-stu-id="580c1-193">When the Lookup transformation is configured to use a Cache connection manager, only index columns in the reference dataset can be mapped to input columns.</span></span> <span data-ttu-id="580c1-194">Кроме того, все столбцы индекса должны быть сопоставлены.</span><span class="sxs-lookup"><span data-stu-id="580c1-194">Also, all index columns must be mapped.</span></span> <span data-ttu-id="580c1-195">Дополнительные сведения см. в разделе [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-195">For more information, see [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span></span>  
  
7.  <span data-ttu-id="580c1-196">При необходимости настройте преобразование кэша.</span><span class="sxs-lookup"><span data-stu-id="580c1-196">Configure the Cache Transform as needed.</span></span> <span data-ttu-id="580c1-197">Дополнительные сведения см. в разделах [Редактор преобразования "Кэш" (страница "Диспетчер соединений")](../cache-transformation-editor-connection-manager-page.md) и [Редактор преобразования "Кэш" (страница "Сопоставления")](../cache-transformation-editor-mappings-page.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-197">For more information, see [Cache Transformation Editor &#40;Connection Manager Page&#41;](../cache-transformation-editor-connection-manager-page.md) and [Cache Transformation Editor &#40;Mappings Page&#41;](../cache-transformation-editor-mappings-page.md).</span></span>  
  
8.  <span data-ttu-id="580c1-198">Выполните одно из следующих действий, чтобы заполнить данными диспетчер соединений с кэшем, который используется во втором пакете.</span><span class="sxs-lookup"><span data-stu-id="580c1-198">Do one of the following to populate the Cache connection manager that is used in the second package:</span></span>  
  
    -   <span data-ttu-id="580c1-199">Запустите родительский пакет.</span><span class="sxs-lookup"><span data-stu-id="580c1-199">Run the parent package.</span></span>  
  
    -   <span data-ttu-id="580c1-200">Дважды щелкните диспетчер соединений с кэшем, созданный в шаге 4, нажмите кнопку **Столбцы**, выделите строки, а затем нажмите клавиши CTRL + C, чтобы скопировать метаданные столбца.</span><span class="sxs-lookup"><span data-stu-id="580c1-200">Double-click the Cache connection manager you created in step 4, click **Columns**, select the rows, and then press CTRL+C to copy the column metadata.</span></span>  
  
9. <span data-ttu-id="580c1-201">В дочернем пакете создайте диспетчер соединений с кэшем. Для этого щелкните правой кнопкой мыши в области **Диспетчеры соединений** , нажмите кнопку **Создать соединение**, выберите значение **CACHE** в диалоговом окне **Добавление диспетчера соединений служб SSIS** , а затем нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="580c1-201">In the child package, create a Cache connection manager by right-clicking in the **Connection Managers** area, clicking **New Connection**, selecting **CACHE** in the **Add SSIS Connection Manager** dialog box, and then clicking **Add**.</span></span>  
  
     <span data-ttu-id="580c1-202">Область **Диспетчеры соединений** появится над следующими вкладками конструктора **:** Поток управления **,** Поток данных **и** Обработчики событий [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="580c1-202">The **Connection Managers** area appears on the bottom of the **Control Flow**, **Data Flow**, and **Event Handlers** tabs of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] Designer.</span></span>  
  
10. <span data-ttu-id="580c1-203">В окне **Редактор диспетчера соединений с кэшем**на вкладке **Общие** настройте диспетчер соединений с кэшем на считывание данных из выбранного файла кэша. Для этого задайте следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="580c1-203">In the **Cache Connection Manager Editor**, on the **General** tab, configure the Cache connection manager to read the data from the cache file that you selected by setting the following options:</span></span>  
  
    -   <span data-ttu-id="580c1-204">Выберите **Использовать кэш файлов**.</span><span class="sxs-lookup"><span data-stu-id="580c1-204">Select **Use file cache**.</span></span>  
  
    -   <span data-ttu-id="580c1-205">В поле **Имя файла**введите имя файла или нажмите кнопку **Обзор** и выберите файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-205">For **File name**, either type the file path or click **Browse** to select the file.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="580c1-206">Уровень защиты пакета не применяется к кэшируемому файлу.</span><span class="sxs-lookup"><span data-stu-id="580c1-206">The protection level of the package does not apply to the cache file.</span></span> <span data-ttu-id="580c1-207">Если кэшируемый файл содержит важные данные, используйте список управления доступом (ACL), чтобы запретить доступ к расположению или папке, в которой хранится файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-207">If the cache file contains sensitive information, use an access control list (ACL) to restrict access to the location or folder in which you store the file.</span></span> <span data-ttu-id="580c1-208">Доступ следует разрешать только определенным учетным записям.</span><span class="sxs-lookup"><span data-stu-id="580c1-208">You should enable access only to certain accounts.</span></span> <span data-ttu-id="580c1-209">Дополнительные сведения см. в разделе [Доступ к файлам, используемым пакетами](../access-to-files-used-by-packages.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-209">For more information, see [Access to Files Used by Packages](../access-to-files-used-by-packages.md).</span></span>  
  
11. <span data-ttu-id="580c1-210">Если в шаге 8 были скопированы метаданные столбца, нажмите кнопку **Столбцы**, выберите пустую строку, а затем нажмите клавиши CTRL + V, чтобы вставить метаданные столбца.</span><span class="sxs-lookup"><span data-stu-id="580c1-210">If you copied the column metadata in step 8, click **Columns**, select the empty row, and then press CTRL+V to paste the column metadata.</span></span>  
  
12. <span data-ttu-id="580c1-211">Добавьте преобразование «Уточняющий запрос» и настройте преобразование, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="580c1-211">Add a Lookup transformation, and then configure the transformation by doing the following:</span></span>  
  
    1.  <span data-ttu-id="580c1-212">Подключите преобразование «Уточняющий запрос» к потоку данных, перетащив соединитель из источника или предыдущего преобразования в преобразование «Уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="580c1-212">Connect the Lookup transformation to the data flow by dragging a connector from a source or a previous transformation to the Lookup transformation.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-213">Преобразование «Уточняющий запрос» может не пройти проверку, если оно соединено с неструктурированным файлом, в котором содержится пустое поле данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-213">A Lookup transformation might not validate if that transformation connects to a flat file that contains an empty date field.</span></span> <span data-ttu-id="580c1-214">Успешность проверки преобразования зависит от того, включено ли в диспетчере соединений для неструктурированного файла сохранение значений NULL.</span><span class="sxs-lookup"><span data-stu-id="580c1-214">Whether the transformation validates depends on whether the connection manager for the flat file has been configured to retain null values.</span></span> <span data-ttu-id="580c1-215">Чтобы гарантировать успешность проверки преобразования «Уточняющий запрос», выберите в **редакторе источника «неструктурированный файл»** на странице **Диспетчер соединений**параметр **Оставлять значения NULL из источника в потоке данных** .</span><span class="sxs-lookup"><span data-stu-id="580c1-215">To ensure that the Lookup transformation validates, in the **Flat File Source Editor**, on the **Connection Manager Page**, select the **Retain null values from the source as null values in the data flow** option.</span></span>  
  
    2.  <span data-ttu-id="580c1-216">Чтобы настроить компонент, дважды щелкните источник или предыдущее преобразование.</span><span class="sxs-lookup"><span data-stu-id="580c1-216">Double-click the source or previous transformation to configure the component.</span></span>  
  
    3.  <span data-ttu-id="580c1-217">Дважды щелкните преобразование "Уточняющий запрос", а затем выберите **Полное кэширование** на странице **Общее** окна **Редактор преобразования "Уточняющий запрос"** .</span><span class="sxs-lookup"><span data-stu-id="580c1-217">Double-click the Lookup transformation, and then select **Full cache** on the **General** page of the **Lookup Transformation Editor**.</span></span>  
  
    4.  <span data-ttu-id="580c1-218">Выберите **Диспетчер соединений с кэшем** в области **Тип соединения** .</span><span class="sxs-lookup"><span data-stu-id="580c1-218">Select **Cache connection manager** in the **Connection type** area.</span></span>  
  
    5.  <span data-ttu-id="580c1-219">Выберите параметр обработки ошибок для строк без совпадающих записей из списка **Укажите метод обработки строк без совпадающих элементов** .</span><span class="sxs-lookup"><span data-stu-id="580c1-219">Select an error handling option for rows without matching entries from the **Specify how to handle rows with no matching entries** list.</span></span>  
  
    6.  <span data-ttu-id="580c1-220">На странице **Соединение** выберите из списка **Диспетчер соединений с кэшем** добавленный диспетчер соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-220">On the **Connection** page, from the **Cache connection manager** list, select the Cache connection manager that you added.</span></span>  
  
    7.  <span data-ttu-id="580c1-221">Перейдите на страницу **Столбцы** и перетащите хотя бы один из столбцов в списке **Доступные входные столбцы** в столбец из списка **Доступные столбцы подстановки** .</span><span class="sxs-lookup"><span data-stu-id="580c1-221">Click the **Columns** page, and then drag at least one column from the **Available Input Columns** list to a column in the **Available Lookup Column** list.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-222">Преобразование «Уточняющий запрос» автоматически сопоставляет столбцы, которые обладают одинаковыми названиями и типами данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-222">The Lookup transformation automatically maps columns that have the same name and the same data type.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-223">Типы данных сопоставляемых столбцов должны совпадать.</span><span class="sxs-lookup"><span data-stu-id="580c1-223">Columns must have matching data types to be mapped.</span></span> <span data-ttu-id="580c1-224">Дополнительные сведения см. в разделе [Integration Services Data Types](../data-flow/integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-224">For more information, see [Integration Services Data Types](../data-flow/integration-services-data-types.md).</span></span>  
  
    8.  <span data-ttu-id="580c1-225">В списке **Доступные столбцы подстановки** выберите столбцы.</span><span class="sxs-lookup"><span data-stu-id="580c1-225">In the **Available Lookup Columns** list, select columns.</span></span> <span data-ttu-id="580c1-226">Затем в списке **Операция поиска** задайте, будут ли значения из столбцов подстановки замещать значения из входных столбцов или же они будут перезаписаны в новый столбец.</span><span class="sxs-lookup"><span data-stu-id="580c1-226">Then in the **Lookup Operation** list, specify whether the values from the lookup columns replace values in the input column or are written to a new column.</span></span>  
  
    9. <span data-ttu-id="580c1-227">Чтобы настроить вывод ошибок, перейдите на страницу **Вывод ошибок** и задайте параметры обработки ошибок.</span><span class="sxs-lookup"><span data-stu-id="580c1-227">To configure the error output, click the **Error Output** page and set the error handling options.</span></span> <span data-ttu-id="580c1-228">Дополнительные сведения см. в разделе [Редактор преобразования "Уточняющий запрос" (страница "Вывод ошибок")](../lookup-transformation-editor-error-output-page.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-228">For more information, see [Lookup Transformation Editor &#40;Error Output Page&#41;](../lookup-transformation-editor-error-output-page.md).</span></span>  
  
    10. <span data-ttu-id="580c1-229">Чтобы сохранить изменения в преобразовании «Уточняющий запрос», нажмите кнопку **ОК** .</span><span class="sxs-lookup"><span data-stu-id="580c1-229">Click **OK** to save your changes to the Lookup transformation.</span></span>  
  
13. <span data-ttu-id="580c1-230">Откройте родительский пакет, добавьте задачу «Выполнение пакета» к потоку управления, а затем настройте задачу для вызова дочернего пакета.</span><span class="sxs-lookup"><span data-stu-id="580c1-230">Open the parent package, add an Execute Package task to the control flow, and then configure the task to call the child package.</span></span> <span data-ttu-id="580c1-231">Дополнительные сведения см. в статье [Execute Package Task](../control-flow/execute-package-task.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-231">For more information, see [Execute Package Task](../control-flow/execute-package-task.md).</span></span>  
  
14. <span data-ttu-id="580c1-232">Запустите пакеты.</span><span class="sxs-lookup"><span data-stu-id="580c1-232">Run the packages.</span></span>  
  
### <a name="to-implement-a-lookup-transformation-in-full-cache-mode-by-using-cache-connection-manager-and-an-existing-cache-file"></a><span data-ttu-id="580c1-233">Реализация преобразования «Уточняющий запрос» в режиме полного кэширования с использованием диспетчера соединений с кэшем и существующего файла кэша</span><span class="sxs-lookup"><span data-stu-id="580c1-233">To implement a Lookup transformation in full cache mode by using Cache connection manager and an existing cache file</span></span>  
  
1.  <span data-ttu-id="580c1-234">В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте проект служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , а затем откройте пакет.</span><span class="sxs-lookup"><span data-stu-id="580c1-234">In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], open a [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] project, and then open a package.</span></span>  
  
2.  <span data-ttu-id="580c1-235">Щелкните правой кнопкой в области **Диспетчеры соединений** и выберите команду **Создать соединение**.</span><span class="sxs-lookup"><span data-stu-id="580c1-235">Right-click in the **Connection Managers** area, and then click **New Connection**.</span></span>  
  
     <span data-ttu-id="580c1-236">Область **Диспетчеры соединений** появится над следующими вкладками конструктора **:** Поток управления **,** Поток данных **и** Обработчики событий [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="580c1-236">The **Connection Managers** area appears on the bottom of the **Control Flow**, **Data Flow**, and **Event Handlers** tabs of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] Designer.</span></span>  
  
3.  <span data-ttu-id="580c1-237">В диалоговом окне **Добавление диспетчера соединений со службами SSIS** выберите значение **CACHE**и нажмите кнопку **Добавить** , чтобы добавить диспетчер соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-237">In the **Add SSIS Connection Manager** dialog box, select **CACHE**, and then click **Add** to add a Cache connection manager.</span></span>  
  
4.  <span data-ttu-id="580c1-238">Дважды щелкните диспетчер соединений с кэшем, чтобы открыть окно **Редактор диспетчера соединений с кэшем**.</span><span class="sxs-lookup"><span data-stu-id="580c1-238">Double-click the Cache connection manager to open the **Cache Connection Manager Editor**.</span></span>  
  
5.  <span data-ttu-id="580c1-239">В окне **Редактор диспетчера соединений с кэшем**на вкладке **Общие** настройте диспетчер соединений с кэшем. Для этого задайте следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="580c1-239">In the **Cache Connection Manager Editor**, on the **General** tab, configure the Cache connection manager by setting the following options:</span></span>  
  
    -   <span data-ttu-id="580c1-240">Выберите **Использовать кэш файлов**.</span><span class="sxs-lookup"><span data-stu-id="580c1-240">Select **Use file cache**.</span></span>  
  
    -   <span data-ttu-id="580c1-241">В поле **Имя файла**введите имя файла или нажмите кнопку **Обзор** и выберите файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-241">For **File name**, either type the file path or click **Browse** to select the file.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="580c1-242">Уровень защиты пакета не применяется к кэшируемому файлу.</span><span class="sxs-lookup"><span data-stu-id="580c1-242">The protection level of the package does not apply to the cache file.</span></span> <span data-ttu-id="580c1-243">Если кэшируемый файл содержит важные данные, используйте список управления доступом (ACL), чтобы запретить доступ к расположению или папке, в которой хранится файл.</span><span class="sxs-lookup"><span data-stu-id="580c1-243">If the cache file contains sensitive information, use an access control list (ACL) to restrict access to the location or folder in which you store the file.</span></span> <span data-ttu-id="580c1-244">Доступ следует разрешать только определенным учетным записям.</span><span class="sxs-lookup"><span data-stu-id="580c1-244">You should enable access only to certain accounts.</span></span> <span data-ttu-id="580c1-245">Дополнительные сведения см. в разделе [Доступ к файлам, используемым пакетами](../access-to-files-used-by-packages.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-245">For more information, see [Access to Files Used by Packages](../access-to-files-used-by-packages.md).</span></span>  
  
6.  <span data-ttu-id="580c1-246">Перейдите на вкладку **Столбцы** , а затем задайте, какие столбцы будут столбцами индекса, с помощью параметра **Позиция индекса** .</span><span class="sxs-lookup"><span data-stu-id="580c1-246">Click the **Columns** tab, and then specify which columns are the index columns by using the **Index Position** option.</span></span>  
  
     <span data-ttu-id="580c1-247">Для неиндексированных столбцов позиция индекса равна 0.</span><span class="sxs-lookup"><span data-stu-id="580c1-247">For non-index columns, the index position is 0.</span></span> <span data-ttu-id="580c1-248">Для индексированных столбцов позиция индекса является положительным порядковым номером.</span><span class="sxs-lookup"><span data-stu-id="580c1-248">For index columns, the index position is a sequential, positive number.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="580c1-249">Если преобразование «Уточняющий запрос» настроено для использования диспетчера соединений с кэшем, то только индексированные столбцы в ссылочном наборе данных могут быть сопоставлены с входными столбцами.</span><span class="sxs-lookup"><span data-stu-id="580c1-249">When the Lookup transformation is configured to use a Cache connection manager, only index columns in the reference dataset can be mapped to input columns.</span></span> <span data-ttu-id="580c1-250">Кроме того, все столбцы индекса должны быть сопоставлены.</span><span class="sxs-lookup"><span data-stu-id="580c1-250">Also, all index columns must be mapped.</span></span> <span data-ttu-id="580c1-251">Дополнительные сведения см. в разделе [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-251">For more information, see [Cache Connection Manager Editor](../cache-connection-manager-editor.md).</span></span>  
  
7.  <span data-ttu-id="580c1-252">На вкладке **Поток управления** добавьте задачу потока данных к пакету, а затем добавьте преобразование «Уточняющий запрос» к потоку данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-252">On the **Control Flow** tab, add a Data Flow task to the package, and then add a Lookup transformation to the data flow.</span></span>  
  
8.  <span data-ttu-id="580c1-253">Настройте преобразование «Уточняющий запрос», выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="580c1-253">Configure the Lookup transformation by doing the following:</span></span>  
  
    1.  <span data-ttu-id="580c1-254">Подключите преобразование «Уточняющий запрос» к потоку данных, перетащив соединитель из источника или предыдущего преобразования в преобразование «Уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="580c1-254">Connect the Lookup transformation to the data flow by dragging a connector from a source or a previous transformation to the Lookup transformation.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-255">Преобразование «Уточняющий запрос» может не пройти проверку, если оно соединено с неструктурированным файлом, в котором содержится пустое поле данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-255">A Lookup transformation might not validate if that transformation connects to a flat file that contains an empty date field.</span></span> <span data-ttu-id="580c1-256">Успешность проверки преобразования зависит от того, включено ли в диспетчере соединений для неструктурированного файла сохранение значений NULL.</span><span class="sxs-lookup"><span data-stu-id="580c1-256">Whether the transformation validates depends on whether the connection manager for the flat file has been configured to retain null values.</span></span> <span data-ttu-id="580c1-257">Чтобы гарантировать успешность проверки преобразования «Уточняющий запрос», выберите в **редакторе источника «неструктурированный файл»** на странице **Диспетчер соединений**параметр **Оставлять значения NULL из источника в потоке данных** .</span><span class="sxs-lookup"><span data-stu-id="580c1-257">To ensure that the Lookup transformation validates, in the **Flat File Source Editor**, on the **Connection Manager Page**, select the **Retain null values from the source as null values in the data flow** option.</span></span>  
  
    2.  <span data-ttu-id="580c1-258">Чтобы настроить компонент, дважды щелкните источник или предыдущее преобразование.</span><span class="sxs-lookup"><span data-stu-id="580c1-258">Double-click the source or previous transformation to configure the component.</span></span>  
  
    3.  <span data-ttu-id="580c1-259">Дважды щелкните преобразование "Уточняющий запрос", а затем в окне **Редактор преобразования "Уточняющий запрос"** на странице **Общие** выберите **Полное кэширование**.</span><span class="sxs-lookup"><span data-stu-id="580c1-259">Double-click the Lookup transformation, and then in the **Lookup Transformation Editor**, on the **General** page, select **Full cache**.</span></span>  
  
    4.  <span data-ttu-id="580c1-260">Выберите **Диспетчер соединений с кэшем** в области **Тип соединения** .</span><span class="sxs-lookup"><span data-stu-id="580c1-260">Select **Cache connection manager** in the **Connection type** area.</span></span>  
  
    5.  <span data-ttu-id="580c1-261">Выберите параметр обработки ошибок для строк без совпадающих записей из списка **Укажите метод обработки строк без совпадающих элементов** .</span><span class="sxs-lookup"><span data-stu-id="580c1-261">Select an error handling option for rows without matching entries from the **Specify how to handle rows with no matching entries** list.</span></span>  
  
    6.  <span data-ttu-id="580c1-262">На странице **Соединение** выберите из списка **Диспетчер соединений с кэшем** добавленный диспетчер соединений с кэшем.</span><span class="sxs-lookup"><span data-stu-id="580c1-262">On the **Connection** page, from the **Cache connection manager** list, select the Cache connection manager that you added.</span></span>  
  
    7.  <span data-ttu-id="580c1-263">Перейдите на страницу **Столбцы** и перетащите хотя бы один из столбцов в списке **Доступные входные столбцы** в столбец из списка **Доступные столбцы подстановки** .</span><span class="sxs-lookup"><span data-stu-id="580c1-263">Click the **Columns** page, and then drag at least one column from the **Available Input Columns** list to a column in the **Available Lookup Column** list.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-264">Преобразование «Уточняющий запрос» автоматически сопоставляет столбцы, которые обладают одинаковыми названиями и типами данных.</span><span class="sxs-lookup"><span data-stu-id="580c1-264">The Lookup transformation automatically maps columns that have the same name and the same data type.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="580c1-265">Типы данных сопоставляемых столбцов должны совпадать.</span><span class="sxs-lookup"><span data-stu-id="580c1-265">Columns must have matching data types to be mapped.</span></span> <span data-ttu-id="580c1-266">Дополнительные сведения см. в разделе [Integration Services Data Types](../data-flow/integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-266">For more information, see [Integration Services Data Types](../data-flow/integration-services-data-types.md).</span></span>  
  
    8.  <span data-ttu-id="580c1-267">В списке **Доступные столбцы подстановки** выберите столбцы.</span><span class="sxs-lookup"><span data-stu-id="580c1-267">In the **Available Lookup Columns** list, select columns.</span></span> <span data-ttu-id="580c1-268">Затем в списке **Операция поиска** задайте, будут ли значения из столбцов подстановки замещать значения из входных столбцов или же они будут перезаписаны в новый столбец.</span><span class="sxs-lookup"><span data-stu-id="580c1-268">Then in the **Lookup Operation** list, specify whether the values from the lookup columns replace values in the input column or are written to a new column.</span></span>  
  
    9. <span data-ttu-id="580c1-269">Чтобы настроить вывод ошибок, перейдите на страницу **Вывод ошибок** и задайте параметры обработки ошибок.</span><span class="sxs-lookup"><span data-stu-id="580c1-269">To configure the error output, click the **Error Output** page and set the error handling options.</span></span> <span data-ttu-id="580c1-270">Дополнительные сведения см. в разделе [Редактор преобразования "Уточняющий запрос" (страница "Вывод ошибок")](../lookup-transformation-editor-error-output-page.md).</span><span class="sxs-lookup"><span data-stu-id="580c1-270">For more information, see [Lookup Transformation Editor &#40;Error Output Page&#41;](../lookup-transformation-editor-error-output-page.md).</span></span>  
  
    10. <span data-ttu-id="580c1-271">Чтобы сохранить изменения в преобразовании «Уточняющий запрос», нажмите кнопку **ОК** .</span><span class="sxs-lookup"><span data-stu-id="580c1-271">Click **OK** to save your changes to the Lookup transformation.</span></span>  
  
9. <span data-ttu-id="580c1-272">Запустите пакет.</span><span class="sxs-lookup"><span data-stu-id="580c1-272">Run the package.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="580c1-273">См. также:</span><span class="sxs-lookup"><span data-stu-id="580c1-273">See Also</span></span>  
 <span data-ttu-id="580c1-274">[Реализация преобразования "Уточняющий запрос" в режиме полного кэширования с помощью диспетчера подключений OLE DB](lookup-transformation-full-cache-mode-ole-db-connection-manager.md) </span><span class="sxs-lookup"><span data-stu-id="580c1-274">[Implement a Lookup Transformation in Full Cache Mode Using the OLE DB Connection Manager](lookup-transformation-full-cache-mode-ole-db-connection-manager.md) </span></span>  
 <span data-ttu-id="580c1-275">[Реализация уточняющего запроса в режиме "Частичное кэширование" или "Без кэширования"](../data-flow/transformations/implement-a-lookup-in-no-cache-or-partial-cache-mode.md) </span><span class="sxs-lookup"><span data-stu-id="580c1-275">[Implement a Lookup in No Cache or Partial Cache Mode](../data-flow/transformations/implement-a-lookup-in-no-cache-or-partial-cache-mode.md) </span></span>  
 [<span data-ttu-id="580c1-276">Преобразования служб Integration Services</span><span class="sxs-lookup"><span data-stu-id="580c1-276">Integration Services Transformations</span></span>](../data-flow/transformations/integration-services-transformations.md)  
  
  
