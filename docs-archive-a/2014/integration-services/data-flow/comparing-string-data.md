---
title: Сравнение строковых данных | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- comparing string data
- comparison options [Integration Services]
- locales [Integration Services]
- converting string data
- string comparisons
ms.assetid: 93aeb5bd-e208-46b7-8979-dea2dcd37d4c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5670f434470d8fad0a8b593ccde0c01ae307e417
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667833"
---
# <a name="comparing-string-data"></a><span data-ttu-id="56be3-102">сравнение строковых данных</span><span class="sxs-lookup"><span data-stu-id="56be3-102">Comparing String Data</span></span>
  <span data-ttu-id="56be3-103">Сравнения строк — важная составляющая любого преобразования, которое выполняется с помощью служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]. Кроме того, они применяются для вычисления выражений в переменных и выражениях свойств.</span><span class="sxs-lookup"><span data-stu-id="56be3-103">String comparisons are an important part of many of the transformations performed by [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], and string comparisons are also used in the evaluation of expressions in variables and property expressions.</span></span> <span data-ttu-id="56be3-104">Например, при преобразовании «Сортировка» сравниваются значения в наборе данных для сортировки данных по возрастанию или по убыванию.</span><span class="sxs-lookup"><span data-stu-id="56be3-104">For example, the Sort transformation compares values in a dataset to sort data in ascending or descending order.</span></span>  
  
## <a name="configuring-transformations-for-string-comparisons"></a><span data-ttu-id="56be3-105">Настройка преобразований для сравнений строк</span><span class="sxs-lookup"><span data-stu-id="56be3-105">Configuring Transformations for String Comparisons</span></span>  
 <span data-ttu-id="56be3-106">Для таких преобразований, как «Сортировка», «Выполнение статистического вычисления», «Нечеткое группирование» и «Нечеткий уточняющий запрос», можно настраивать различные способы сравнения строк на уровне столбца.</span><span class="sxs-lookup"><span data-stu-id="56be3-106">The Sort, Aggregate, Fuzzy Grouping, and Fuzzy Lookup transformations can be customized to change the way strings are compared at the column level.</span></span> <span data-ttu-id="56be3-107">Например, можно указать, что сравнение нечувствительно к регистру. Это означает, что символы в верхнем и нижнем регистре будут считаться одинаковыми.</span><span class="sxs-lookup"><span data-stu-id="56be3-107">For example, you can specify that a comparison ignores case, which means that uppercase and lowercase characters are treated as the same character.</span></span>  
  
 <span data-ttu-id="56be3-108">Приведенные ниже преобразования используют выражения, в которых могут быть строковые сравнения.</span><span class="sxs-lookup"><span data-stu-id="56be3-108">The following transformations use expressions that can include string comparisons.</span></span>  
  
-   <span data-ttu-id="56be3-109">Преобразование «Условное разбиение» с помощью сравнений строк в выражениях может определять, в какой выход следует отправлять строки данных.</span><span class="sxs-lookup"><span data-stu-id="56be3-109">The Conditional Split transformation can use string comparisons in expressions to determine which output to send the data row to.</span></span> <span data-ttu-id="56be3-110">Дополнительные сведения см. в статье [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="56be3-110">For more information, see [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span></span>  
  
-   <span data-ttu-id="56be3-111">Преобразование «Производный столбец» с помощью строковых сравнений в выражениях может формировать новые значения столбцов.</span><span class="sxs-lookup"><span data-stu-id="56be3-111">The Derived Column transformation can use string comparisons in expressions to generate new column values.</span></span> <span data-ttu-id="56be3-112">Дополнительные сведения см. в разделе [Derived Column Transformation](transformations/derived-column-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="56be3-112">For more information, see [Derived Column Transformation](transformations/derived-column-transformation.md).</span></span>  
  
 <span data-ttu-id="56be3-113">Кроме того, выражения со строковыми сравнениями можно применять в переменных, сопоставлении переменных, а также в элементах управления очередностью.</span><span class="sxs-lookup"><span data-stu-id="56be3-113">Variables, variable mappings, and precedence constraints also use expressions, which can include string comparisons.</span></span> <span data-ttu-id="56be3-114">Дополнительные сведения о выражениях см. в разделе [Выражения служб Integration Services (SSIS)](../expressions/integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="56be3-114">For more information about expressions, see [Integration Services &#40;SSIS&#41; Expressions](../expressions/integration-services-ssis-expressions.md).</span></span>  
  
## <a name="processing-during-string-comparison"></a><span data-ttu-id="56be3-115">Обработка в ходе сравнения строк</span><span class="sxs-lookup"><span data-stu-id="56be3-115">Processing during String Comparison</span></span>  
 <span data-ttu-id="56be3-116">В зависимости от характера данных и конфигурации преобразования при сравнении строковых данных может происходить следующая обработка:</span><span class="sxs-lookup"><span data-stu-id="56be3-116">Depending on the data and the configuration of the transformation, the following processing may occur during the comparison of string data:</span></span>  
  
-   <span data-ttu-id="56be3-117">Преобразование данных в Юникод.</span><span class="sxs-lookup"><span data-stu-id="56be3-117">Converting data to Unicode.</span></span> <span data-ttu-id="56be3-118">Если в источнике данных не использована кодировка Юникод, то данные автоматически преобразуются в Юникод до начала сравнения.</span><span class="sxs-lookup"><span data-stu-id="56be3-118">If the source data is not already Unicode, the data is automatically converted to Unicode before the comparison occurs.</span></span>  
  
-   <span data-ttu-id="56be3-119">Использование локаля для применения правил конкретных локалей при интерпретации даты, времени, десятичных данных и порядка сортировки.</span><span class="sxs-lookup"><span data-stu-id="56be3-119">Using locale to apply locale-specific rules for interpreting date, time, decimal data, and sort order.</span></span>  
  
-   <span data-ttu-id="56be3-120">Применение параметров сравнения на уровне столбца для изменения чувствительности сравнений.</span><span class="sxs-lookup"><span data-stu-id="56be3-120">Applying comparison options at the column level to change the sensitivity of comparisons.</span></span>  
  
## <a name="converting-string-data-to-unicode"></a><span data-ttu-id="56be3-121">Преобразование строковых данных в Юникод</span><span class="sxs-lookup"><span data-stu-id="56be3-121">Converting String Data to Unicode</span></span>  
 <span data-ttu-id="56be3-122">В зависимости от операций, которые выполняет преобразование, и конфигурации преобразования строковые данные могут преобразовываться в тип данных DT_WSTR, посредством которого строковые символы представляются в формате Юникод.</span><span class="sxs-lookup"><span data-stu-id="56be3-122">Depending on the operations that the transformation performs and the configuration of the transformation, string data may be converted to the DT_WSTR data type, which is a Unicode representation of string characters.</span></span>  
  
 <span data-ttu-id="56be3-123">Строковые данные, имеющие тип данных DT_STR, преобразуются в Юникод с использованием кодовой страницы столбца.</span><span class="sxs-lookup"><span data-stu-id="56be3-123">String data that has the DT_STR data type is converted to Unicode using the code page of the column.</span></span> [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="56be3-124">поддерживают кодовые страницы на уровне столбцов; каждый столбец может быть преобразован с использованием отдельной кодовой страницы.</span><span class="sxs-lookup"><span data-stu-id="56be3-124">supports code pages at the column level, and each column can be converted by using a different code page.</span></span>  
  
 <span data-ttu-id="56be3-125">Обычно службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] могут самостоятельно определить правильную кодовую страницу по источнику данных.</span><span class="sxs-lookup"><span data-stu-id="56be3-125">In most cases, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] can identify the correct code page from the data source.</span></span> <span data-ttu-id="56be3-126">Например, в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] можно настроить параметры сортировки для уровня базы данных и уровня столбца.</span><span class="sxs-lookup"><span data-stu-id="56be3-126">For example, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can set a collation at the database and column levels.</span></span> <span data-ttu-id="56be3-127">Кодовая страница является производной от параметров сортировки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которые могут быть либо параметрами сортировки Windows, либо параметрами сортировки SQL.</span><span class="sxs-lookup"><span data-stu-id="56be3-127">The code page is derived from a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collation, which can be either a Windows or an SQL collation.</span></span>  
  
 <span data-ttu-id="56be3-128">Если службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] выдают непредвиденную кодовую таблицу или если пакет подключается к источнику данных с помощью поставщика, который не предоставил данных для определения правильной кодовой страницы, то можно указать кодовую страницу по умолчанию в источнике и назначении OLE DB.</span><span class="sxs-lookup"><span data-stu-id="56be3-128">If [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides an unexpected code page, or if the package accesses a data source by using a provider that does not supply sufficient information to determine the correct code page, you can specify a default code page in the OLE DB source and the OLE DB destination.</span></span> <span data-ttu-id="56be3-129">Кодовая страница по умолчанию используется вместо кодовых страниц, указанных в службах [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="56be3-129">The default code pages are used instead of the code pages that [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span>  
  
 <span data-ttu-id="56be3-130">У файлов нет кодовых страниц.</span><span class="sxs-lookup"><span data-stu-id="56be3-130">Files do not have code pages.</span></span> <span data-ttu-id="56be3-131">Вместо этого в диспетчере соединений одного или нескольких неструктурированных файлов, с помощью которого пакет подключается к данным в файле, предусмотрено свойство, указывающее кодовую страницу для файла.</span><span class="sxs-lookup"><span data-stu-id="56be3-131">Instead, the Flat File and the Multiple Flat Files connection managers that a package uses to connect to file data include a property for specifying the code page of the file.</span></span> <span data-ttu-id="56be3-132">Кодовую страницу можно задавать только на уровне файла, но не на уровне столбца.</span><span class="sxs-lookup"><span data-stu-id="56be3-132">The code page can be set at the file level only, not at the column level.</span></span>  
  
## <a name="setting-locale"></a><span data-ttu-id="56be3-133">Настройка локалей</span><span class="sxs-lookup"><span data-stu-id="56be3-133">Setting Locale</span></span>  
 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="56be3-134">не применяют кодовые страницы при определении правил, зависящих от языкового стандарта, для сортировки данных или интерпретации даты, времени и десятичных данных.</span><span class="sxs-lookup"><span data-stu-id="56be3-134">does not use the code page to infer locale-specific rules for sorting data or interpreting date, time, and decimal data.</span></span> <span data-ttu-id="56be3-135">Вместо этого преобразование считывает языковой стандарт, заданный в свойстве LocaleId компонента потока данных, задачи потока данных, контейнера или пакета.</span><span class="sxs-lookup"><span data-stu-id="56be3-135">Instead, the transformation reads the locale that is set by the LocaleId property on the data flow component, Data Flow task, container, or package.</span></span> <span data-ttu-id="56be3-136">По умолчанию локаль преобразования наследуется от задачи потока данных, которая в свою очередь наследует его от пакета.</span><span class="sxs-lookup"><span data-stu-id="56be3-136">By default, the locale of a transformation is inherited from its Data Flow task, which in turn inherits from the package.</span></span> <span data-ttu-id="56be3-137">Если задача потока данных находится в контейнере, например в контейнере «цикл по элементам», то она наследует локаль от контейнера.</span><span class="sxs-lookup"><span data-stu-id="56be3-137">If the Data Flow task is in a container such as the For Loop container, it inherits its locale from the container.</span></span>  
  
 <span data-ttu-id="56be3-138">Кроме того, можно указывать локаль для диспетчеров соединений с одним или несколькими неструктурированными файлами.</span><span class="sxs-lookup"><span data-stu-id="56be3-138">You can also specify a locale for a Flat File connection manager and a Multiple Flat Files connection manager.</span></span>  
  
## <a name="setting-comparison-options"></a><span data-ttu-id="56be3-139">Настройка параметров сравнения</span><span class="sxs-lookup"><span data-stu-id="56be3-139">Setting Comparison Options</span></span>  
 <span data-ttu-id="56be3-140">Локаль содержит основные правила сравнения строковых данных.</span><span class="sxs-lookup"><span data-stu-id="56be3-140">The locale provides the basic rules for comparing string data.</span></span> <span data-ttu-id="56be3-141">Например, локаль определяет положение сортировки каждой буквы в алфавите.</span><span class="sxs-lookup"><span data-stu-id="56be3-141">For example, the locale specifies the sort position of each letter in the alphabet.</span></span> <span data-ttu-id="56be3-142">Тем не менее этих правил может быть недостаточно для сравнений, выполняемых некоторыми преобразованиями, и службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] поддерживают набор расширенных параметров сравнения, которых нет среди основных правил локали.</span><span class="sxs-lookup"><span data-stu-id="56be3-142">However, these rules may not be sufficient for the comparisons that some transformations perform, and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] supports a set of advanced comparison options that go beyond the comparison rules of a locale.</span></span> <span data-ttu-id="56be3-143">Эти параметры сравнения задаются на уровне столбца.</span><span class="sxs-lookup"><span data-stu-id="56be3-143">These comparison options are set at the column level.</span></span> <span data-ttu-id="56be3-144">Например, один из параметров сравнения позволяет игнорировать непробельные символы.</span><span class="sxs-lookup"><span data-stu-id="56be3-144">For example, one of the comparison options lets you ignore nonspacing characters.</span></span> <span data-ttu-id="56be3-145">В результате этого параметра игнорируются диакритические знаки, такие как диакритические знаки, что делает "a" и "a" идентичными для сравнения.</span><span class="sxs-lookup"><span data-stu-id="56be3-145">The effect of this option is to ignore diacritics such as the accent, which makes "a" and "å" identical for comparison purposes.</span></span>  
  
 <span data-ttu-id="56be3-146">В приведенной ниже таблице описаны параметры сравнения и стиль сортировки.</span><span class="sxs-lookup"><span data-stu-id="56be3-146">The following table describes the comparison options and a sort style.</span></span>  
  
|<span data-ttu-id="56be3-147">Параметр сравнения</span><span class="sxs-lookup"><span data-stu-id="56be3-147">Comparison option</span></span>|<span data-ttu-id="56be3-148">Description</span><span class="sxs-lookup"><span data-stu-id="56be3-148">Description</span></span>|  
|-----------------------|-----------------|  
|<span data-ttu-id="56be3-149">Игнорировать регистр</span><span class="sxs-lookup"><span data-stu-id="56be3-149">Ignore case</span></span>|<span data-ttu-id="56be3-150">Указывает, следует ли при сравнении различать символы в верхнем и нижнем регистре.</span><span class="sxs-lookup"><span data-stu-id="56be3-150">Specifies whether the comparison distinguishes between uppercase and lowercase letters.</span></span> <span data-ttu-id="56be3-151">Если параметр задан, то строковое сравнение игнорирует регистр.</span><span class="sxs-lookup"><span data-stu-id="56be3-151">If this option is set, the string comparison ignores case.</span></span> <span data-ttu-id="56be3-152">Например, «ABC» при сравнении не отличается от «abc».</span><span class="sxs-lookup"><span data-stu-id="56be3-152">For example, "ABC" becomes the same as "abc".</span></span>|  
|<span data-ttu-id="56be3-153">Игнорируется тип японской азбуки</span><span class="sxs-lookup"><span data-stu-id="56be3-153">Ignore kana type</span></span>|<span data-ttu-id="56be3-154">Указывает, следует ли различать при сравнении два типа символов японской азбуки: хирагана и катакана.</span><span class="sxs-lookup"><span data-stu-id="56be3-154">Specifies whether the comparison distinguishes between the two types of Japanese kana characters: hiragana and katakana.</span></span> <span data-ttu-id="56be3-155">Если параметр задан, то строковое сравнение игнорирует тип японской азбуки.</span><span class="sxs-lookup"><span data-stu-id="56be3-155">If this option is set, the string comparison ignores kana type.</span></span>|  
|<span data-ttu-id="56be3-156">Игнорировать ширину символа</span><span class="sxs-lookup"><span data-stu-id="56be3-156">Ignore character width</span></span>|<span data-ttu-id="56be3-157">Указывает, следует ли при сравнении различать однобайтовые символы или аналогичные двухбайтовые символы.</span><span class="sxs-lookup"><span data-stu-id="56be3-157">Specifies whether the comparison distinguishes between a single-byte character and the same character when it is represented as a double-byte character.</span></span> <span data-ttu-id="56be3-158">Если параметр задан, то строковое сравнение рассматривает однобайтовое и двухбайтовое представления символа как один и тот же символ.</span><span class="sxs-lookup"><span data-stu-id="56be3-158">If this option is set, the string comparison treats single-byte and double-byte representations of the same character as identical.</span></span>|  
|<span data-ttu-id="56be3-159">Игнорировать непробельные символы</span><span class="sxs-lookup"><span data-stu-id="56be3-159">Ignore nonspacing characters</span></span>|<span data-ttu-id="56be3-160">Указывает, следует ли при сравнении различать обычные символы и символы с диакритическими знаками.</span><span class="sxs-lookup"><span data-stu-id="56be3-160">Specifies whether the comparison distinguishes between spacing characters and diacritics.</span></span> <span data-ttu-id="56be3-161">Если параметр задан, то строковое сравнение не учитывает диакритические знаки.</span><span class="sxs-lookup"><span data-stu-id="56be3-161">If this option is set, the comparison ignores diacritics.</span></span> <span data-ttu-id="56be3-162">Например, буква «a» с любыми диакритическими знаками будет считаться обычной буквой «a».</span><span class="sxs-lookup"><span data-stu-id="56be3-162">For example, "å" is equal to "a".</span></span>|  
|<span data-ttu-id="56be3-163">Не учитывать символы</span><span class="sxs-lookup"><span data-stu-id="56be3-163">Ignore symbols</span></span>|<span data-ttu-id="56be3-164">Указывает, следует ли различать буквенные символы и такие символы, как пробелы, знаки пунктуации, знаки валют, а также математические символы.</span><span class="sxs-lookup"><span data-stu-id="56be3-164">Specifies whether the comparison distinguishes between letter characters and symbols such as white-space characters, punctuation, currency symbols, and mathematical symbols.</span></span> <span data-ttu-id="56be3-165">Если параметр задан, то строковое сравнение игнорирует символы.</span><span class="sxs-lookup"><span data-stu-id="56be3-165">If this option is set, the string comparison ignores symbols.</span></span> <span data-ttu-id="56be3-166">Например, « Москва» не отличается от «Москва», а «\*ABC» не отличается от «ABC'».</span><span class="sxs-lookup"><span data-stu-id="56be3-166">For example, " New York" becomes the same as "New York" and "\*ABC" is the same as "ABC"'.</span></span>|  
|<span data-ttu-id="56be3-167">Сортировать знаки пунктуации как символы</span><span class="sxs-lookup"><span data-stu-id="56be3-167">Sort punctuation as symbols</span></span>|<span data-ttu-id="56be3-168">Указывает, следует ли располагать все знаки пунктуации, кроме дефиса и апострофа, перед буквенно-цифровыми символами.</span><span class="sxs-lookup"><span data-stu-id="56be3-168">Specifies whether the comparison sorts all punctuation symbols, except the hyphen and apostrophe, before the alphanumeric characters.</span></span> <span data-ttu-id="56be3-169">Например, если параметр задан, то «.ABC» оказывается перед «ABC».</span><span class="sxs-lookup"><span data-stu-id="56be3-169">For example, if this option is set, ".ABC" sorts before "ABC".</span></span>|  
  
 <span data-ttu-id="56be3-170">Для сравнения данных эти параметры используют преобразования «Сортировка», «Выполнение статистического вычисления», «Нечеткое группирование» и «Нечеткий уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="56be3-170">The Sort, Aggregate, Fuzzy Grouping and Fuzzy Lookup transformations include these options for comparing data.</span></span>  
  
 <span data-ttu-id="56be3-171">Флаг сравнения **FullySensitive** отображается в диалоговом окне **Расширенный редактор** для преобразований «Нечеткое группирование» и «Нечеткий уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="56be3-171">The **FullySensitive** comparison flag displays in the **Advanced Editor** dialog box for the Fuzzy Grouping and Fuzzy Lookup transformations.</span></span> <span data-ttu-id="56be3-172">Если установлен флаг сравнения **FullySensitive** , то применяются все параметры сравнения.</span><span class="sxs-lookup"><span data-stu-id="56be3-172">Selecting the **FullySensitive** comparison flag means that all the comparison options apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="56be3-173">См. также:</span><span class="sxs-lookup"><span data-stu-id="56be3-173">See Also</span></span>  
 <span data-ttu-id="56be3-174">[Типы данных служб Integration Services](integration-services-data-types.md) </span><span class="sxs-lookup"><span data-stu-id="56be3-174">[Integration Services Data Types](integration-services-data-types.md) </span></span>  
 <span data-ttu-id="56be3-175">[Быстрый синтаксический анализ](../fast-parse.md) </span><span class="sxs-lookup"><span data-stu-id="56be3-175">[Fast Parse](../fast-parse.md) </span></span>  
 [<span data-ttu-id="56be3-176">Стандартный синтаксический анализ</span><span class="sxs-lookup"><span data-stu-id="56be3-176">Standard Parse</span></span>](../standard-parse.md)  
  
  
