---
title: Источник OLE DB | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbsource.f1
helpviewer_keywords:
- sources [Integration Services], OLE DB
- OLE DB source [Integration Services]
ms.assetid: f87cc5f6-b078-40f3-9d87-7a65e13e4c86
author: chugugrace
ms.author: chugu
ms.openlocfilehash: ce0d2a95639dc31ee8cf4dd9cdaca6844ad4a1d9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87657192"
---
# <a name="ole-db-source"></a>Источник OLE DB
  Источник OLE DB извлекает сведения из множества поддерживающих технологию OLE DB реляционных баз данных с помощью таблицы базы данных, представления или команды SQL. Например, источник OLE DB может извлекать данные из таблиц [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office Access или [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
 Источник OLE DB предоставляет четыре различных режима доступа к данным, используемые при извлечении данных:  
  
-   Таблица или представление.  
  
-   Таблица или представление, указанные в переменной.  
  
-   Результат выполнения инструкции SQL. Может использоваться параметризированный запрос.  
  
-   Результат выполнения инструкции SQL хранится в переменной.  
  
> [!NOTE]  
>  Когда инструкция SQL используется для вызова хранимой процедуры, возвращающей результаты из временной таблицы, используйте параметр WITH RESULT SETS для определения метаданных набора результатов.  
  
 При использовании параметризированного запроса можно сопоставить переменные с параметрами, чтобы задать значения для отдельных параметров в инструкциях SQL.  
  
 Данный источник для подключения к источнику данных использует диспетчер соединений OLE DB, в котором задается используемый поставщик OLE DB. Дополнительные сведения см. в разделе [Диспетчер соединений OLE DB](../connection-manager/ole-db-connection-manager.md).  
  
 Проект служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] также предоставляет объект источника данных, из которого можно создать диспетчер соединений OLE DB, делая источники данных и представления источников данных доступными для источника OLE DB.  
  
 Некоторые поставщики OLE DB накладывают определенные ограничения на источник OLE DB.  
  
-   Поставщик [!INCLUDE[msCoName](../../includes/msconame-md.md)] OLE DB для Oracle не поддерживает типы данных Oracle BLOB, CLOB, NCLOB, BFILE или UROWID, так что источник OLE DB не может извлекать данные из таблиц, содержащих столбцы с этими типами данных.  
  
-   Поставщики IBM OLE DB DB2 и [!INCLUDE[msCoName](../../includes/msconame-md.md)] OLE DB DB2 не поддерживают команду SQL, вызывающую хранимую процедуру. Если такая команда использована, источник OLE DB не может создать метаданные столбца. В результате этого отсутствуют доступные столбцы данных для компонентов потоков данных, которые располагаются следом за источником OLE DB в потоке данных, что приводит к сбою потокового выполнения.  
  
 Источник OLE DB имеет один обычный выход и один выход ошибок.  
  
## <a name="using-parameterized-sql-statements"></a>Использование параметризованных инструкций SQL  
 Источник OLE DB может использовать инструкцию SQL для извлечения данных. Это может быть инструкция SELECT или EXEC.  
  
 Источник OLE DB использует диспетчер соединений OLE DB для соединения с источником данных, из которого происходит извлечение данных. В зависимости от поставщика, используемого диспетчером соединений OLE DB, и СУРБД, с которой он соединяется, имена и списки параметров подчиняются разным правилам. Если имена параметров возвращаются из СУРБД, их можно использовать для сопоставления параметров из списка с параметрами из инструкции SQL, в противном случае параметры сопоставляются с параметрами в инструкции SQL в соответствии с их порядковым положением в списке параметров. Типы поддерживаемых имен параметров зависят от поставщика. Например, одни поставщики требуют, чтобы использовались имена переменных или столбцов, а другие требуют, чтобы использовались символьные имена, например, 0 или Param0. Правила именования параметров в инструкциях SQL см. в документации к поставщику.  
  
 Если используется диспетчер соединений OLE DB, нельзя использовать параметризованные вложенные запросы, поскольку источник OLE DB не сможет получить сведения о параметрах через поставщик OLE DB. Однако можно использовать выражение, чтобы объединить значения параметров в строку запроса и задать свойство SqlCommand источника. В конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] можно настроить источник OLE DB с помощью диалогового окна **Редактор источника "OLE DB"** , а также сопоставить переменные с параметрами в диалоговом окне **Установка параметров запроса** .  
  
### <a name="specifying-parameters-by-using-ordinal-positions"></a>Задание параметров с помощью порядкового положения  
 Если имена параметров не возвращаются, то, с какими создателями параметров они сопоставляются во время выполнения, определяет порядок следования параметров в списке **Параметры** в диалоговом окне **Установка параметров запроса** . Первый параметр в списке сопоставляется с первым символом «?» в инструкции SQL, второй параметр сопоставляется со вторым символом «?», и т. д.  
  
 Следующая инструкция SQL выбирает строки из таблицы **Product** в базе данных [!INCLUDE[ssSampleDBUserInputNonLocal](../../includes/sssampledbuserinputnonlocal-md.md)] . Первый параметр в списке **Сопоставления** сопоставляется с первым параметром, со столбцом **Color** , второй параметр сопоставляется со столбцом **Size** .  
  
 `SELECT * FROM Production.Product WHERE Color = ? AND Size = ?`  
  
 Имена параметров значения не имеют. Например, если у параметра такое же имя, как и у столбца, с которым он сопоставляется, но он не стоит в правильном положении по порядку в списке **Параметры** , то сопоставление параметра во время выполнения будет основано на порядковом положении параметра, а не на его имени.  
  
 В команде EXEC обычно требуется, чтобы в качестве имен параметров использовались имена переменных, предоставляющие значения параметров в процедуре.  
  
### <a name="specifying-parameters-by-using-names"></a>Задание параметров с помощью имен  
 Если из СУРБД возвращаются действительные имена параметров RDBMS, то параметры, используемые в инструкциях SELECT и EXEC, сопоставляются по имени. Имена параметров должны совпадать с именами, ожидаемыми хранимой процедурой, которая запускается инструкцией SELECT или EXEC.  
  
 Следующая инструкция SQL запускает хранимую процедуру **uspGetWhereUsedProductID** , доступную в базе данных [!INCLUDE[ssSampleDBUserInputNonLocal](../../includes/sssampledbuserinputnonlocal-md.md)] .  
  
 `EXEC uspGetWhereUsedProductID ?, ?`  
  
 Хранимая процедура ожидает, что в переменных `@StartProductID` и `@CheckDate`будут содержаться значения параметров. Порядок следования параметров в списке **Сопоставления** неважен. Единственное требование состоит в том, что имена параметров должны совпадать с именами переменных в хранимой процедуре вплоть до символа \@.  
  
### <a name="mapping-parameters-to-variables"></a>Сопоставление параметров и переменных  
 Параметры сопоставляются с переменными, которые во время выполнения предоставляют значения параметров. Переменные обычно являются определяемыми пользователем переменными, хотя также можно использовать системные переменные, предоставляемые службами [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] . При использовании определяемых пользователем переменных убедитесь, что тип их данных совместим с типом данных столбца, на который ссылается сопоставляемый параметр. Дополнительные сведения см. в разделе [Переменные служб Integration Services (SSIS)](../integration-services-ssis-variables.md).  
  
## <a name="troubleshooting-the-ole-db-source"></a>Устранение неполадок, связанных с источником OLE DB  
 Можно вести журнал вызовов, сделанных источником OLE DB к внешним источникам данных. Эта возможность ведения журнала может быть использована для устранения неполадок загрузки данных из внешнего источника данных, выполняемой источником OLE DB. Чтобы вести журнал вызовов, которые источник OLE DB совершает к внешним поставщикам данных, необходимо включить ведение журнала пакета и выбрать событие **Диагностика** на уровне пакета. Дополнительные сведения см. в разделе [Инструменты устранения неполадок при выполнении пакетов](../troubleshooting/troubleshooting-tools-for-package-execution.md).  
  
## <a name="configuring-the-ole-db-source"></a>Настройка источника OLE DB  
 Свойства задаются программно или через конструктор служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] .  
  
 Дополнительные сведения о свойствах, которые можно задавать в диалоговом окне **Редактор источника OLE DB** , см. в следующих разделах:  
  
-   [Редактор источника OLE DB (страница "Диспетчер соединений")](../ole-db-source-editor-connection-manager-page.md)  
  
-   [Редактор источника OLE DB (страница "Столбцы")](../ole-db-source-editor-columns-page.md)  
  
-   [Редактор источника OLE DB (страница "Вывод ошибок")](../ole-db-source-editor-error-output-page.md)  
  
 Диалоговое окно **Расширенный редактор** содержит свойства, которые можно установить с помощью программных средств. Дополнительные сведения о свойствах, которые вы можете задать в диалоговом окне **Расширенный редактор** или программными средствами, см. в следующих разделах.  
  
-   [Общие свойства](../common-properties.md)  
  
-   [Пользовательские свойства OLE DB](ole-db-custom-properties.md)  
  
## <a name="related-tasks"></a>Связанные задачи  
  
-   [Извлечение данных с помощью источника «OLE DB»](ole-db-source.md)  
  
-   [Сопоставления параметров запросов с переменными в компонентах потока данных](map-query-parameters-to-variables-in-a-data-flow-component.md)  
  
-   [Установление свойств компонента потока данных](set-the-properties-of-a-data-flow-component.md)  
  
-   [Сортировка данных для преобразований "Слияние" и "Соединение слиянием"](transformations/sort-data-for-the-merge-and-merge-join-transformations.md)  
  
## <a name="related-content"></a>См. также  
 Статья Wiki [Соединители служб SSIS с Oracle](https://go.microsoft.com/fwlink/?LinkId=220670)на сайте social.technet.microsoft.com.  
  
## <a name="see-also"></a>См. также:  
 [Назначение OLE DB](ole-db-destination.md)   
 [Переменные в службах Integration Services (SSIS)](../integration-services-ssis-variables.md)   
 [Поток данных](data-flow.md)  
  
  
