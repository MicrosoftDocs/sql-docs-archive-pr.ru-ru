---
title: Преобразование "Команда OLE DB" | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbcommandtrans.f1
helpviewer_keywords:
- statements [Integration Services]
- OLE DB Command transformation
ms.assetid: baa6735c-5acf-4759-b077-1216aca16c6c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a6b0498d0ae5fa61a00cc7f6fc89e4dc506cd25a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87752327"
---
# <a name="ole-db-command-transformation"></a><span data-ttu-id="501e6-102">преобразование «Команда OLE DB»</span><span class="sxs-lookup"><span data-stu-id="501e6-102">OLE DB Command Transformation</span></span>
  <span data-ttu-id="501e6-103">Преобразование «Команда OLE DB» выполняет инструкцию SQL для каждой строки потока данных.</span><span class="sxs-lookup"><span data-stu-id="501e6-103">The OLE DB Command transformation runs an SQL statement for each row in a data flow.</span></span> <span data-ttu-id="501e6-104">Например, можно выполнить инструкцию SQL, с помощью которой создаются, обновляются или удаляются строки в таблице базы данных.</span><span class="sxs-lookup"><span data-stu-id="501e6-104">For example, you can run an SQL statement that inserts, updates, or deletes rows in a database table.</span></span>  
  
 <span data-ttu-id="501e6-105">Преобразование «Команда OLE DB» можно настроить следующими способами.</span><span class="sxs-lookup"><span data-stu-id="501e6-105">You can configure the OLE DB Command Transformation in the following ways:</span></span>  
  
-   <span data-ttu-id="501e6-106">Указать инструкцию SQL, которую преобразование выполняет для каждой строки.</span><span class="sxs-lookup"><span data-stu-id="501e6-106">Provide the SQL statement that the transformation runs for each row.</span></span>  
  
-   <span data-ttu-id="501e6-107">Задать время ожидания инструкции SQL в секундах.</span><span class="sxs-lookup"><span data-stu-id="501e6-107">Specify the number of seconds before the SQL statement times out.</span></span>  
  
-   <span data-ttu-id="501e6-108">Указать кодовую страницу по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="501e6-108">Specify the default code page.</span></span>  
  
 <span data-ttu-id="501e6-109">Обычно инструкция SQL содержит параметры.</span><span class="sxs-lookup"><span data-stu-id="501e6-109">Typically, the SQL statement includes parameters.</span></span> <span data-ttu-id="501e6-110">Значения параметров хранятся во внешних столбцах на входе преобразования, и сопоставление входного столбца с внешним столбцом означает сопоставление входного столбца с параметром.</span><span class="sxs-lookup"><span data-stu-id="501e6-110">The parameter values are stored in external columns in the transformation input, and mapping an input column to an external column maps an input column to a parameter.</span></span> <span data-ttu-id="501e6-111">Например, для размещения строк в таблице **DimProduct** в соответствии со значениями в столбце **ProductKey** и для их последующего удаления можно сопоставить внешний столбец **Param_0** с входным столбцом **ProductKey** и выполнить инструкцию SQL `DELETE FROM DimProduct WHERE ProductKey = ?`.</span><span class="sxs-lookup"><span data-stu-id="501e6-111">For example, to locate rows in the **DimProduct** table by the value in their **ProductKey** column and then delete them, you can map the external column named **Param_0** to the input column named **ProductKey,** and then run the SQL statement `DELETE FROM DimProduct WHERE ProductKey = ?`..</span></span> <span data-ttu-id="501e6-112">Преобразование «Команда OLE DB» определяет имена параметров, которые нельзя изменить.</span><span class="sxs-lookup"><span data-stu-id="501e6-112">The OLE DB Command transformation provides the parameter names and you cannot modify them.</span></span> <span data-ttu-id="501e6-113">Имена параметров представляют собой **Param_0**, **Param_1**и т. д.</span><span class="sxs-lookup"><span data-stu-id="501e6-113">The parameter names are **Param_0**, **Param_1**, and so on.</span></span>  
  
 <span data-ttu-id="501e6-114">Если преобразование «Команда OLE DB» настраивается в диалоговом окне **Расширенный редактор** , с помощью кнопки **Обновить** можно автоматически сопоставить параметры инструкции SQL с внешними столбцами входа преобразования, а также определить характеристики каждого параметра.</span><span class="sxs-lookup"><span data-stu-id="501e6-114">If you configure the OLE DB Command transformation by using the **Advanced Editor** dialog box, the parameters in the SQL statement may be mapped automatically to external columns in the transformation input, and the characteristics of each parameter defined, by clicking the **Refresh** button.</span></span> <span data-ttu-id="501e6-115">Тем не менее, если поставщик OLE DB, используемый преобразованием «Команда OLE DB», не поддерживает извлечение сведений о параметрах из самих параметров, то внешние столбцы должны настраиваться вручную.</span><span class="sxs-lookup"><span data-stu-id="501e6-115">However, if the OLE DB provider that the OLE DB Command transformation uses does not support deriving parameter information from the parameter, you must configure the external columns manually.</span></span> <span data-ttu-id="501e6-116">В этом случае для каждого параметра необходимо добавить столбец к внешнему входу преобразования, присвоить столбцам имена типа **Param_0**, указать значение свойства DBParamInfoFlags и сопоставить входные столбцы, в которых содержатся значения параметров, с внешними столбцами.</span><span class="sxs-lookup"><span data-stu-id="501e6-116">This means that you must add a column for each parameter to the external input to the transformation, update the column names to use names like **Param_0**, specify the value of the DBParamInfoFlags property, and map the input columns that contain parameter values to the external columns.</span></span>  
  
 <span data-ttu-id="501e6-117">Значение свойства DBParamInfoFlags представляет собой характеристики параметра.</span><span class="sxs-lookup"><span data-stu-id="501e6-117">The value of DBParamInfoFlags represents the characteristics of the parameter.</span></span> <span data-ttu-id="501e6-118">Например, значение **1** показывает, что параметр является входным, а значение **65** показывает, что параметр является входным и может принимать значение NULL.</span><span class="sxs-lookup"><span data-stu-id="501e6-118">For example, the value **1** specifies that the parameter is an input parameter, and the value **65** specifies that the parameter is an input parameter and may contain a null value.</span></span> <span data-ttu-id="501e6-119">Значения должны соответствовать значениям из перечисления OLE DB DBPARAMFLAGSENUM.</span><span class="sxs-lookup"><span data-stu-id="501e6-119">The values must match the values in the OLE DB DBPARAMFLAGSENUM enumeration.</span></span> <span data-ttu-id="501e6-120">Дополнительные сведения см. в справочной документации по OLE DB.</span><span class="sxs-lookup"><span data-stu-id="501e6-120">For more information, see the OLE DB reference documentation.</span></span>  
  
 <span data-ttu-id="501e6-121">Преобразование OLE DB Command включает в себя пользовательское свойство `SQLCommand`.</span><span class="sxs-lookup"><span data-stu-id="501e6-121">The OLE DB Command transformation includes the `SQLCommand` custom property.</span></span> <span data-ttu-id="501e6-122">Это свойство может быть обновлено выражением свойства при загрузке пакета.</span><span class="sxs-lookup"><span data-stu-id="501e6-122">This property can be updated by a property expression when the package is loaded.</span></span> <span data-ttu-id="501e6-123">Дополнительные сведения см. в разделах [Выражения служб Integration Services (SSIS)](../../expressions/integration-services-ssis-expressions.md), [Использование выражений свойств в пакетах](../../expressions/use-property-expressions-in-packages.md) и [Пользовательские свойства преобразований](transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="501e6-123">For more information, see [Integration Services &#40;SSIS&#41; Expressions](../../expressions/integration-services-ssis-expressions.md), [Use Property Expressions in Packages](../../expressions/use-property-expressions-in-packages.md), and [Transformation Custom Properties](transformation-custom-properties.md).</span></span>  
  
 <span data-ttu-id="501e6-124">Это преобразование содержит один вход, один обычный вывод и один вывод ошибок.</span><span class="sxs-lookup"><span data-stu-id="501e6-124">This transformation has one input, one regular output, and one error output.</span></span>  
  
## <a name="logging"></a><span data-ttu-id="501e6-125">Logging</span><span class="sxs-lookup"><span data-stu-id="501e6-125">Logging</span></span>  
 <span data-ttu-id="501e6-126">В журнал можно записывать вызовы, сделанные преобразованием «Команда OLE DB» к внешним источникам данных.</span><span class="sxs-lookup"><span data-stu-id="501e6-126">You can log the calls that the OLE DB Command transformation makes to external data providers.</span></span> <span data-ttu-id="501e6-127">Эта возможность протоколирования может быть использована для устранения неполадок соединений и выполнения команд для внешних источников данных, которые выполняются преобразованием «Команда OLE DB».</span><span class="sxs-lookup"><span data-stu-id="501e6-127">You can use this logging capability to troubleshoot the connections and commands to external data sources that the OLE DB Command transformation performs.</span></span> <span data-ttu-id="501e6-128">Для протоколирования вызовов, которые преобразование «Команда OLE DB» совершает к внешним поставщикам данных, необходимо разрешить ведение журнала пакета и выбрать событие **Диагностика** на уровне пакета.</span><span class="sxs-lookup"><span data-stu-id="501e6-128">To log the calls that the OLE DB Command transformation makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="501e6-129">Дополнительные сведения см. в разделе [Инструменты устранения неполадок при выполнении пакетов](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="501e6-129">For more information, see [Troubleshooting Tools for Package Execution](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="501e6-130">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="501e6-130">Related Tasks</span></span>  
 <span data-ttu-id="501e6-131">Преобразование можно настроить с помощью конструктора служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] или объектной модели.</span><span class="sxs-lookup"><span data-stu-id="501e6-131">You can configure the transformation by either using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or the object model.</span></span> <span data-ttu-id="501e6-132">Сведения о настройке преобразования с помощью конструктора [!INCLUDE[ssIS](../../../includes/ssis-md.md)] см. в разделе  [Настройка преобразования "Команда OLE DB"](../../configure-the-ole-db-command-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="501e6-132">For details about configuring the transformation using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] designer, see  [Configure the OLE DB Command Transformation](../../configure-the-ole-db-command-transformation.md).</span></span> <span data-ttu-id="501e6-133">Сведения о настройке этого преобразования программными средствами см. в руководстве разработчика.</span><span class="sxs-lookup"><span data-stu-id="501e6-133">See the Developer Guide for details about programmatically configuring this transformation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="501e6-134">См. также:</span><span class="sxs-lookup"><span data-stu-id="501e6-134">See Also</span></span>  
 <span data-ttu-id="501e6-135">[Поток данных](../data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="501e6-135">[Data Flow](../data-flow.md) </span></span>  
 [<span data-ttu-id="501e6-136">Преобразования служб Integration Services</span><span class="sxs-lookup"><span data-stu-id="501e6-136">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
