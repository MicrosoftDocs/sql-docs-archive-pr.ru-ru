---
title: Преобразование "Команда OLE DB" | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbcommandtrans.f1
helpviewer_keywords:
- statements [Integration Services]
- OLE DB Command transformation
ms.assetid: baa6735c-5acf-4759-b077-1216aca16c6c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a6b0498d0ae5fa61a00cc7f6fc89e4dc506cd25a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87752327"
---
# <a name="ole-db-command-transformation"></a>преобразование «Команда OLE DB»
  Преобразование «Команда OLE DB» выполняет инструкцию SQL для каждой строки потока данных. Например, можно выполнить инструкцию SQL, с помощью которой создаются, обновляются или удаляются строки в таблице базы данных.  
  
 Преобразование «Команда OLE DB» можно настроить следующими способами.  
  
-   Указать инструкцию SQL, которую преобразование выполняет для каждой строки.  
  
-   Задать время ожидания инструкции SQL в секундах.  
  
-   Указать кодовую страницу по умолчанию.  
  
 Обычно инструкция SQL содержит параметры. Значения параметров хранятся во внешних столбцах на входе преобразования, и сопоставление входного столбца с внешним столбцом означает сопоставление входного столбца с параметром. Например, для размещения строк в таблице **DimProduct** в соответствии со значениями в столбце **ProductKey** и для их последующего удаления можно сопоставить внешний столбец **Param_0** с входным столбцом **ProductKey** и выполнить инструкцию SQL `DELETE FROM DimProduct WHERE ProductKey = ?`. Преобразование «Команда OLE DB» определяет имена параметров, которые нельзя изменить. Имена параметров представляют собой **Param_0**, **Param_1**и т. д.  
  
 Если преобразование «Команда OLE DB» настраивается в диалоговом окне **Расширенный редактор** , с помощью кнопки **Обновить** можно автоматически сопоставить параметры инструкции SQL с внешними столбцами входа преобразования, а также определить характеристики каждого параметра. Тем не менее, если поставщик OLE DB, используемый преобразованием «Команда OLE DB», не поддерживает извлечение сведений о параметрах из самих параметров, то внешние столбцы должны настраиваться вручную. В этом случае для каждого параметра необходимо добавить столбец к внешнему входу преобразования, присвоить столбцам имена типа **Param_0**, указать значение свойства DBParamInfoFlags и сопоставить входные столбцы, в которых содержатся значения параметров, с внешними столбцами.  
  
 Значение свойства DBParamInfoFlags представляет собой характеристики параметра. Например, значение **1** показывает, что параметр является входным, а значение **65** показывает, что параметр является входным и может принимать значение NULL. Значения должны соответствовать значениям из перечисления OLE DB DBPARAMFLAGSENUM. Дополнительные сведения см. в справочной документации по OLE DB.  
  
 Преобразование OLE DB Command включает в себя пользовательское свойство `SQLCommand`. Это свойство может быть обновлено выражением свойства при загрузке пакета. Дополнительные сведения см. в разделах [Выражения служб Integration Services (SSIS)](../../expressions/integration-services-ssis-expressions.md), [Использование выражений свойств в пакетах](../../expressions/use-property-expressions-in-packages.md) и [Пользовательские свойства преобразований](transformation-custom-properties.md).  
  
 Это преобразование содержит один вход, один обычный вывод и один вывод ошибок.  
  
## <a name="logging"></a>Logging  
 В журнал можно записывать вызовы, сделанные преобразованием «Команда OLE DB» к внешним источникам данных. Эта возможность протоколирования может быть использована для устранения неполадок соединений и выполнения команд для внешних источников данных, которые выполняются преобразованием «Команда OLE DB». Для протоколирования вызовов, которые преобразование «Команда OLE DB» совершает к внешним поставщикам данных, необходимо разрешить ведение журнала пакета и выбрать событие **Диагностика** на уровне пакета. Дополнительные сведения см. в разделе [Инструменты устранения неполадок при выполнении пакетов](../../troubleshooting/troubleshooting-tools-for-package-execution.md).  
  
## <a name="related-tasks"></a>Связанные задачи  
 Преобразование можно настроить с помощью конструктора служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] или объектной модели. Сведения о настройке преобразования с помощью конструктора [!INCLUDE[ssIS](../../../includes/ssis-md.md)] см. в разделе  [Настройка преобразования "Команда OLE DB"](../../configure-the-ole-db-command-transformation.md). Сведения о настройке этого преобразования программными средствами см. в руководстве разработчика.  
  
## <a name="see-also"></a>См. также:  
 [Поток данных](../data-flow.md)   
 [Преобразования служб Integration Services](integration-services-transformations.md)  
  
  
