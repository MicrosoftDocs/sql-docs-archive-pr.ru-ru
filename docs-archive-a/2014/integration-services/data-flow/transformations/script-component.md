---
title: Компонент скрипта | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scriptcomponentdetails.f1
helpviewer_keywords:
- Script transformation
- scripts [Integration Services], transformations
- Script component [Integration Services], about Script component
- Script component [Integration Services]
ms.assetid: 131c2d0c-2e33-4785-94af-ada5c049821e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: af8e500e399b0f69a7e34c9e2e01c74d83256107
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87752312"
---
# <a name="script-component"></a><span data-ttu-id="18adc-102">Компонент скрипта</span><span class="sxs-lookup"><span data-stu-id="18adc-102">Script Component</span></span>
  <span data-ttu-id="18adc-103">Компонент скрипта размещает скрипт и позволяет пакету включать и выполнять пользовательский код скрипта.</span><span class="sxs-lookup"><span data-stu-id="18adc-103">The Script component hosts script and enables a package to include and run custom script code.</span></span> <span data-ttu-id="18adc-104">Можно использовать компонент скрипта в пакетах для следующих целей.</span><span class="sxs-lookup"><span data-stu-id="18adc-104">You can use the Script component in packages for the following purposes:</span></span>  
  
-   <span data-ttu-id="18adc-105">Применить множественные преобразования к данным, вместо того, чтобы использовать множественные преобразования в потоке данных.</span><span class="sxs-lookup"><span data-stu-id="18adc-105">Apply multiple transformations to data instead of using multiple transformations in the data flow.</span></span> <span data-ttu-id="18adc-106">Например, скрипт может добавить значения в два столбца и затем вычислить среднее значение суммы.</span><span class="sxs-lookup"><span data-stu-id="18adc-106">For example, a script can add the values in two columns and then calculate the average of the sum.</span></span>  
  
-   <span data-ttu-id="18adc-107">Получить доступ к бизнес-правилам в существующей сборке .NET.</span><span class="sxs-lookup"><span data-stu-id="18adc-107">Access business rules in an existing .NET assembly.</span></span> <span data-ttu-id="18adc-108">Например, скрипт может применить бизнес-правило, определяющее диапазон правильных значений в столбце `Income`.</span><span class="sxs-lookup"><span data-stu-id="18adc-108">For example, a script can apply a business rule that specifies the range of values that are valid in an `Income` column.</span></span>  
  
-   <span data-ttu-id="18adc-109">Использовать пользовательские формулы и функции в дополнение к функциям и операторам, которые предоставляет грамматика выражений служб [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="18adc-109">Use custom formulas and functions in addition to the functions and operators that the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression grammar provides.</span></span> <span data-ttu-id="18adc-110">Например, можно проверить номера кредитных карт, используя формулу LUHN.</span><span class="sxs-lookup"><span data-stu-id="18adc-110">For example, validate credit card numbers that use the LUHN formula.</span></span>  
  
-   <span data-ttu-id="18adc-111">Проверить данные столбца на правильность и не учитывать записи, содержащие недопустимые данные.</span><span class="sxs-lookup"><span data-stu-id="18adc-111">Validate column data and skip records that contain invalid data.</span></span> <span data-ttu-id="18adc-112">Например, скрипт может определять адекватность почтовых расходов и пропускать записи с очень большими или очень маленькими суммами.</span><span class="sxs-lookup"><span data-stu-id="18adc-112">For example, a script can assess the reasonableness of a postage amount and skip records with extremely high or low amounts.</span></span>  
  
 <span data-ttu-id="18adc-113">Компонент скрипта обеспечивает простой и быстрый путь включения пользовательских функций в поток данных.</span><span class="sxs-lookup"><span data-stu-id="18adc-113">The Script component provides an easy and quick way to include custom functions in a data flow.</span></span> <span data-ttu-id="18adc-114">Однако, если планируется многократное использование кода скрипта во множестве пакетов, необходимо рассмотреть программирование пользовательского компонента вместо использования компонента скрипта.</span><span class="sxs-lookup"><span data-stu-id="18adc-114">However, if you plan to reuse the script code in multiple packages, you should consider programming a custom component instead of using the Script component.</span></span> <span data-ttu-id="18adc-115">Дополнительные сведения см. в разделе [Разработка пользовательского компонента потока данных](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span><span class="sxs-lookup"><span data-stu-id="18adc-115">For more information, see [Developing a Custom Data Flow Component](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="18adc-116">Если компонент скрипта содержит скрипт, пытающийся прочесть значение столбца, равное NULL, то при запуске пакета компонент скрипта завершится с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="18adc-116">If the Script component contains a script that tries to read the value of a column that is NULL, the Script component fails when you run the package.</span></span> <span data-ttu-id="18adc-117">Рекомендуется, чтобы скрипт использовал метод <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> для определения того, является ли столбец значением NULL, перед попыткой чтения значения столбца.</span><span class="sxs-lookup"><span data-stu-id="18adc-117">We recommend that your script use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> method to determine whether the column is NULL before trying to read the column value.</span></span>  
  
 <span data-ttu-id="18adc-118">Компонент скрипта может быть использован как источник, преобразование или назначение.</span><span class="sxs-lookup"><span data-stu-id="18adc-118">The Script component can be used as a source, a transformation, or a destination.</span></span> <span data-ttu-id="18adc-119">Компонент поддерживает один вход и множество выходов.</span><span class="sxs-lookup"><span data-stu-id="18adc-119">This component supports one input and multiple outputs.</span></span> <span data-ttu-id="18adc-120">В зависимости от того, как компонент используется, он поддерживает либо вход, либо выход, либо и вход и выход одновременно.</span><span class="sxs-lookup"><span data-stu-id="18adc-120">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="18adc-121">Скрипт вызывается каждой строкой на входе или выходе.</span><span class="sxs-lookup"><span data-stu-id="18adc-121">The script is invoked by every row in the input or output.</span></span>  
  
-   <span data-ttu-id="18adc-122">Если используется как источник, компонент скрипта поддерживает множество выходов.</span><span class="sxs-lookup"><span data-stu-id="18adc-122">If used as a source, the Script component supports multiple outputs.</span></span>  
  
-   <span data-ttu-id="18adc-123">Если используется как преобразование, компонент скрипта поддерживает один вход и множество выходов.</span><span class="sxs-lookup"><span data-stu-id="18adc-123">If used as a transformation, the Script component supports one input and multiple outputs.</span></span>  
  
-   <span data-ttu-id="18adc-124">Если используется как назначение, компонент скрипта поддерживает один вход.</span><span class="sxs-lookup"><span data-stu-id="18adc-124">If used as a destination, the Script component supports one input.</span></span>  
  
 <span data-ttu-id="18adc-125">Компонент скрипта не поддерживает выход ошибок.</span><span class="sxs-lookup"><span data-stu-id="18adc-125">The Script component does not support error outputs.</span></span>  
  
 <span data-ttu-id="18adc-126">После того как выбран подходящий компонент скрипта для пакета, нужно настроить входы и выходы, разработать скрипт, используемый компонентом, и настроить сам компонент.</span><span class="sxs-lookup"><span data-stu-id="18adc-126">After you decide that the Script component is the appropriate choice for your package, you have to configure the inputs and outputs, develop the script that the component uses, and configure the component itself.</span></span>  
  
## <a name="understanding-the-script-component-modes"></a><span data-ttu-id="18adc-127">Основные сведения о режимах компонента скрипта</span><span class="sxs-lookup"><span data-stu-id="18adc-127">Understanding the Script Component Modes</span></span>  
 <span data-ttu-id="18adc-128">В конструкторе [!INCLUDE[ssIS](../../../includes/ssis-md.md)] у компонента скрипта есть два режима: режим конструирования метаданных и режим конструирования кода.</span><span class="sxs-lookup"><span data-stu-id="18adc-128">In the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata-design mode and code-design mode.</span></span> <span data-ttu-id="18adc-129">В режиме редактирования метаданных можно добавлять и изменять входы и выходы компонента скрипта, но нельзя писать код.</span><span class="sxs-lookup"><span data-stu-id="18adc-129">In metadata-design mode, you can add and modify the Script component inputs and outputs, but you cannot write code.</span></span> <span data-ttu-id="18adc-130">После того как все входы и выходы настроены, переключаетесь в режим редактирования кода, чтобы написать скрипт.</span><span class="sxs-lookup"><span data-stu-id="18adc-130">After all the inputs and outputs are configured, you switch to code-design mode to write the script.</span></span> <span data-ttu-id="18adc-131">Компонент скрипта автоматически создает базовый код из метаданных входов и выходов.</span><span class="sxs-lookup"><span data-stu-id="18adc-131">The Script component automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="18adc-132">Если пользователь изменил метаданные после того, как компонент скрипта создал базовый код, то пользовательский код больше не может быть откомпилированным, потому что измененный базовый код может быть несовместим с пользовательским кодом.</span><span class="sxs-lookup"><span data-stu-id="18adc-132">If you change the metadata after the Script component generates the base code, your code may no longer compile because the updated base code may be incompatible with your code.</span></span>  
  
## <a name="writing-the-script-that-the-component-uses"></a><span data-ttu-id="18adc-133">Разработка скрипта, используемого компонентом</span><span class="sxs-lookup"><span data-stu-id="18adc-133">Writing the Script that the Component Uses</span></span>  
 <span data-ttu-id="18adc-134">Компонент скрипта использует для создания скриптов среду [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA).</span><span class="sxs-lookup"><span data-stu-id="18adc-134">The Script component uses [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts.</span></span> <span data-ttu-id="18adc-135">Доступ к VSTA осуществляется из **Редактора преобразования «Скрипт»** .</span><span class="sxs-lookup"><span data-stu-id="18adc-135">You access VSTA from the **Script Transformation Editor**.</span></span> <span data-ttu-id="18adc-136">Дополнительные сведения см. в разделе [Редактор преобразования "Скрипт" (страница "Скрипт")](../../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="18adc-136">For more information, see [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="18adc-137">Компонент скрипта содержит проект VSTA, который включает автоматически создающийся класс, называемый ScriptMain, представляющий метаданные компонента.</span><span class="sxs-lookup"><span data-stu-id="18adc-137">The Script component provides a VSTA project that includes an auto-generated class, named ScriptMain, that represents the component metadata.</span></span> <span data-ttu-id="18adc-138">Например, если компонент скрипта используется как преобразование, имеющее три выхода, ScriptMain содержит метод для каждого выхода.</span><span class="sxs-lookup"><span data-stu-id="18adc-138">For example, if the Script component is used as a transformation that has three outputs, ScriptMain includes a method for each output.</span></span> <span data-ttu-id="18adc-139">ScriptMain — это точка входа в скрипт.</span><span class="sxs-lookup"><span data-stu-id="18adc-139">ScriptMain is the entry point to the script.</span></span>  
  
 <span data-ttu-id="18adc-140">Среда VSTA располагает всеми стандартными возможностями среды [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] , в том числе редактором [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] с цветовым выделением, технологией IntelliSense и браузером объектов.</span><span class="sxs-lookup"><span data-stu-id="18adc-140">VSTA includes all the standard features of the [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] editor, IntelliSense, and Object Browser.</span></span> <span data-ttu-id="18adc-141">Скрипт, используемый компонентом скрипта, сохранен в определении пакета.</span><span class="sxs-lookup"><span data-stu-id="18adc-141">The script that the Script component uses is stored in the package definition.</span></span> <span data-ttu-id="18adc-142">При конструировании пакета код скрипта временно записывается в файл проекта.</span><span class="sxs-lookup"><span data-stu-id="18adc-142">When you are designing the package, the script code is temporarily written to a project file.</span></span>  
  
 <span data-ttu-id="18adc-143">Среда VSTA поддерживает языки программирования [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# и [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="18adc-143">VSTA supports the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic programming languages.</span></span>  
  
 <span data-ttu-id="18adc-144">Сведения по программированию компонента скрипта см. в разделе [Расширение потока данных с помощью компонента скрипта](script-component.md).</span><span class="sxs-lookup"><span data-stu-id="18adc-144">For information about how to program the Script component, see [Extending the Data Flow with the Script Component](script-component.md).</span></span> <span data-ttu-id="18adc-145">Дополнительные сведения о способах настройки компонента скрипта как источника, преобразования или назначения см. в разделе [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="18adc-145">For more specific information about how to configure the Script component as a source, transformation, or destination, see [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span> <span data-ttu-id="18adc-146">Дополнительные примеры, например назначение «ODBC», в которых показано использование компонента скрипта, см. в разделе [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span><span class="sxs-lookup"><span data-stu-id="18adc-146">For additional examples such as an ODBC destination that demonstrate the use of the Script component, see [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="18adc-147">В отличие от предыдущих версий, где можно было указать, являются ли скрипты предварительно скомпилированными, в версии [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] и более поздних версиях все скрипты компилируются заранее.</span><span class="sxs-lookup"><span data-stu-id="18adc-147">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="18adc-148">Если скрипт компилируется заранее, то во время выполнения не загружается языковая подсистема и пакет выполняется быстрее.</span><span class="sxs-lookup"><span data-stu-id="18adc-148">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="18adc-149">Однако заранее скомпилированные двоичные файлы занимают значительное место на диске.</span><span class="sxs-lookup"><span data-stu-id="18adc-149">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-component"></a><span data-ttu-id="18adc-150">Настройка компонента скрипта</span><span class="sxs-lookup"><span data-stu-id="18adc-150">Configuring the Script Component</span></span>  
 <span data-ttu-id="18adc-151">Можно настроить компонент скрипта следующими способами.</span><span class="sxs-lookup"><span data-stu-id="18adc-151">You can configure the Script component in the following ways:</span></span>  
  
-   <span data-ttu-id="18adc-152">Выберите входные столбцы, на которые необходимо ссылаться.</span><span class="sxs-lookup"><span data-stu-id="18adc-152">Select the input columns to reference.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="18adc-153">При использовании конструктора служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] можно настроить только один вход.</span><span class="sxs-lookup"><span data-stu-id="18adc-153">You can configure only one input when you use the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer.</span></span>  
  
-   <span data-ttu-id="18adc-154">Предоставьте скрипт, выполняемый компонентом.</span><span class="sxs-lookup"><span data-stu-id="18adc-154">Provide the script that the component runs.</span></span>  
  
-   <span data-ttu-id="18adc-155">Укажите язык скрипта.</span><span class="sxs-lookup"><span data-stu-id="18adc-155">Specify the script language.</span></span>  
  
-   <span data-ttu-id="18adc-156">Предоставьте разделенные запятыми списки переменных с разрешениями «только чтение» и «чтение и запись».</span><span class="sxs-lookup"><span data-stu-id="18adc-156">Provide comma-separated lists of read-only and read/write variables.</span></span>  
  
-   <span data-ttu-id="18adc-157">Добавьте больше выходов, а также выходные столбцы, которым скрипт присваивает значения.</span><span class="sxs-lookup"><span data-stu-id="18adc-157">Add more outputs, and add output columns to which the script assigns.</span></span>  
  
 <span data-ttu-id="18adc-158">Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../../../includes/ssis-md.md)] или программными средствами.</span><span class="sxs-lookup"><span data-stu-id="18adc-158">You can set properties through [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-component-in-the-designer"></a><span data-ttu-id="18adc-159">Настройка компонента скрипта в конструкторе</span><span class="sxs-lookup"><span data-stu-id="18adc-159">Configuring the Script Component in the Designer</span></span>  
 <span data-ttu-id="18adc-160">Дополнительные сведения о свойствах, которые можно установить в диалоговом окне **Редактор преобразования «Скрипт»** , см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="18adc-160">For more information about the properties that you can set in the **Script Transformation Editor** dialog box, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="18adc-161">Редактор преобразования "Скрипт" (страница "Входные столбцы")</span><span class="sxs-lookup"><span data-stu-id="18adc-161">Script Transformation Editor &#40;Input Columns Page&#41;</span></span>](../../script-transformation-editor-input-columns-page.md)  
  
-   [<span data-ttu-id="18adc-162">Редактор преобразования "Скрипт" (страница "Входы и выходы")</span><span class="sxs-lookup"><span data-stu-id="18adc-162">Script Transformation Editor &#40;Inputs and Outputs Page&#41;</span></span>](../../script-transformation-editor-inputs-and-outputs-page.md)  
  
-   [<span data-ttu-id="18adc-163">Редактор преобразования "Скрипт" (страница "Скрипт")</span><span class="sxs-lookup"><span data-stu-id="18adc-163">Script Transformation Editor &#40;Script Page&#41;</span></span>](../../script-transformation-editor-script-page.md)  
  
-   [<span data-ttu-id="18adc-164">Редактор преобразования "Скрипт" (страница "Диспетчеры соединений")</span><span class="sxs-lookup"><span data-stu-id="18adc-164">Script Transformation Editor &#40;Connection Managers Page&#41;</span></span>](../../script-transformation-editor-connection-managers-page.md)  
  
 <span data-ttu-id="18adc-165">Дополнительные сведения об установке этих свойств в конструкторе служб [!INCLUDE[ssIS](../../../includes/ssis-md.md)] см. в следующем разделе:</span><span class="sxs-lookup"><span data-stu-id="18adc-165">For more information about how to set these properties in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="18adc-166">Установление свойств компонента потока данных</span><span class="sxs-lookup"><span data-stu-id="18adc-166">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
### <a name="configuring-the-script-component-programmatically"></a><span data-ttu-id="18adc-167">Программная настройка компонента скрипта</span><span class="sxs-lookup"><span data-stu-id="18adc-167">Configuring the Script Component Programmatically</span></span>  
 <span data-ttu-id="18adc-168">Дополнительные сведения о свойствах, которые можно установить в окне **Свойства** или программно, см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="18adc-168">For more information about the properties that you can set in the **Properties** window or programmatically, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="18adc-169">Общие свойства</span><span class="sxs-lookup"><span data-stu-id="18adc-169">Common Properties</span></span>](../../common-properties.md)  
  
-   [<span data-ttu-id="18adc-170">Пользовательские свойства преобразований</span><span class="sxs-lookup"><span data-stu-id="18adc-170">Transformation Custom Properties</span></span>](transformation-custom-properties.md)  
  
 <span data-ttu-id="18adc-171">Дополнительные сведения о настройке свойств см. в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="18adc-171">For more information about how to set properties, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="18adc-172">Установление свойств компонента потока данных</span><span class="sxs-lookup"><span data-stu-id="18adc-172">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="18adc-173">См. также</span><span class="sxs-lookup"><span data-stu-id="18adc-173">Related Content</span></span>  
 [<span data-ttu-id="18adc-174">Преобразования служб Integration Services</span><span class="sxs-lookup"><span data-stu-id="18adc-174">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
 [<span data-ttu-id="18adc-175">Расширение потока данных с помощью компонента скрипта</span><span class="sxs-lookup"><span data-stu-id="18adc-175">Extending the Data Flow with the Script Component</span></span>](script-component.md)  
  
  
