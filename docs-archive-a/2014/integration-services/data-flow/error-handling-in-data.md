---
title: Обработка ошибок в данных | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- truncating data
- data conversion errors [Integration Services]
- errors [Integration Services], data flow components
- lookups [Integration Services]
- errors [Integration Services]
- errors [Integration Services], data flow outputs
- error outputs [Integration Services]
- data flow [Integration Services], errors
- expressions [Integration Services], errors
ms.assetid: c61667b4-25cb-4d45-a52f-a733e32863f4
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 442ecc68fc352d50955af9302fbcedf77ba36338
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87751355"
---
# <a name="error-handling-in-data"></a><span data-ttu-id="cfd59-102">Обработка ошибок в данных</span><span class="sxs-lookup"><span data-stu-id="cfd59-102">Error Handling in Data</span></span>
  <span data-ttu-id="cfd59-103">Если компонент потока данных применяет преобразование к данным столбца, выделяет данные из источников или загружает данные в назначения, то может возникнуть ошибка.</span><span class="sxs-lookup"><span data-stu-id="cfd59-103">When a data flow component applies a transformation to column data, extracts data from sources, or loads data into destinations, errors can occur.</span></span> <span data-ttu-id="cfd59-104">Ошибки часто возникают из-за непредвиденных значений данных.</span><span class="sxs-lookup"><span data-stu-id="cfd59-104">Errors frequently occur because of unexpected data values.</span></span> <span data-ttu-id="cfd59-105">Например, преобразование данных не выполняется, так как столбец вместо числа содержит строку; вставка в столбец базы данных не выполняется, потому что данные имеют тип даты, а столбец содержит числовые данные; наконец, результат выражения не может быть определен, так как значение столбца равно нулю, поэтому математическая операция недопустима.</span><span class="sxs-lookup"><span data-stu-id="cfd59-105">For example, a data conversion fails because a column contains a string instead of a number, an insertion into a database column fails because the data is a date and the column has a numeric data type, or an expression fails to evaluate because a column value is zero, resulting in a mathematical operation that is not valid.</span></span>  
  
 <span data-ttu-id="cfd59-106">Обычно происходят ошибки следующих категорий.</span><span class="sxs-lookup"><span data-stu-id="cfd59-106">Errors typically fall into one the following categories:</span></span>  
  
-   <span data-ttu-id="cfd59-107">Ошибки преобразования данных, возникающие, если преобразование приводит к потере значащих разрядов, потере незначащих разрядов или к усечению строк.</span><span class="sxs-lookup"><span data-stu-id="cfd59-107">Data conversion errors, which occur if a conversion results in loss of significant digits, the loss of insignificant digits, and the truncation of strings.</span></span> <span data-ttu-id="cfd59-108">Ошибки преобразования данных также возникают, если запрашиваемое преобразование не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="cfd59-108">Data conversion errors also occur if the requested conversion is not supported.</span></span>  
  
-   <span data-ttu-id="cfd59-109">Ошибки оценки выражений, возникающие, если выражения, оцениваемые во время исполнения, выполняют недействительные операции или становятся синтаксически неправильными из-за потери данных или их неверных значений данных.</span><span class="sxs-lookup"><span data-stu-id="cfd59-109">Expression evaluation errors, which occur if expressions that are evaluated at run time perform invalid operations or become syntactically incorrect because of missing or incorrect data values.</span></span>  
  
-   <span data-ttu-id="cfd59-110">Ошибки поиска, возникающие, если операция поиска не может обнаружить соответствия в таблице уточняющих запросов.</span><span class="sxs-lookup"><span data-stu-id="cfd59-110">Lookup errors, which occur if a lookup operation fails to locate a match in the lookup table.</span></span>  
  
 <span data-ttu-id="cfd59-111">Многие компоненты потока данных поддерживают выходы ошибок, которые позволяют пользователю контролировать обработку ошибок компонентом на уровне строки как во входных, так и в выходных данных.</span><span class="sxs-lookup"><span data-stu-id="cfd59-111">Many data flow components support error outputs, which let you control how the component handles row-level errors in both incoming and outgoing data.</span></span> <span data-ttu-id="cfd59-112">Заданием параметров на отдельных столбцах на входе или выходе определяется, какие действия выполняет компонент при возникновении усечения или ошибки.</span><span class="sxs-lookup"><span data-stu-id="cfd59-112">You specify how the component behaves when truncation or an error occurs by setting options on individual columns in the input or output.</span></span> <span data-ttu-id="cfd59-113">Например, можно указать, что компонент завершается ошибкой, если имя клиента усечено, но пропускает ошибки в другом столбце, содержащем менее важные данные.</span><span class="sxs-lookup"><span data-stu-id="cfd59-113">For example, you can specify that the component should fail if customer name data is truncated, but ignore errors on another column that contains less important data.</span></span>  
  
 <span data-ttu-id="cfd59-114">Вывод ошибок может быть связан с входными данными другого преобразования или загружен в назначение, отличное от назначения выхода без ошибок.</span><span class="sxs-lookup"><span data-stu-id="cfd59-114">The error output can be connected to the input of another transformation or loaded into a different destination than the non-error output.</span></span> <span data-ttu-id="cfd59-115">Например, выход ошибки может быть привязан к преобразованию «Производный столбец», которое формирует строку для пустого столбца.</span><span class="sxs-lookup"><span data-stu-id="cfd59-115">For example, the error output can be a connected to a Derived Column transformation that provides a string for a column that is blank.</span></span>  
  
 <span data-ttu-id="cfd59-116">На следующей диаграмме показан простой поток данных, содержащий выход ошибок.</span><span class="sxs-lookup"><span data-stu-id="cfd59-116">The following diagram shows a simple data flow including an error output.</span></span>  
  
 <span data-ttu-id="cfd59-117">![Поток данных с выводом ошибок](../media/mw-dts-11.gif "Поток данных с выводом ошибок")</span><span class="sxs-lookup"><span data-stu-id="cfd59-117">![Data flow with error output](../media/mw-dts-11.gif "Data flow with error output")</span></span>  
  
 <span data-ttu-id="cfd59-118">В дополнение к столбцам данных выход ошибок включает в себя столбцы **ErrorCode** и **ErrorColumn** .</span><span class="sxs-lookup"><span data-stu-id="cfd59-118">In addition to the data columns, the error output includes the **ErrorCode** and **ErrorColumn** columns.</span></span> <span data-ttu-id="cfd59-119">Столбец **ErrorCode** идентифицирует ошибку, а столбец **ErrorColumn** содержит идентификатор журнала обращений и преобразований столбца с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="cfd59-119">The **ErrorCode** column identifies the error and the **ErrorColumn** contains the lineage identifier of the error column.</span></span> <span data-ttu-id="cfd59-120">Чтобы просмотреть метаданные этих столбцов, щелкните путь, соединяющий выход ошибок со следующим компонентом потока данных.</span><span class="sxs-lookup"><span data-stu-id="cfd59-120">To view the metadata of these columns, click the path that connects the error output to the next component in the data flow.</span></span> <span data-ttu-id="cfd59-121">В некоторых случаях значение столбца **ErrorColumn** устанавливается в ноль.</span><span class="sxs-lookup"><span data-stu-id="cfd59-121">Under some circumstances, the value of the **ErrorColumn** column is set to zero.</span></span> <span data-ttu-id="cfd59-122">Это происходит, если условие ошибки влияет на целую строку, а не один столбец.</span><span class="sxs-lookup"><span data-stu-id="cfd59-122">This occurs when the error condition affects the entire row instead of a single column.</span></span> <span data-ttu-id="cfd59-123">Например, если преобразование «Уточняющий запрос» завершилось неудачно.</span><span class="sxs-lookup"><span data-stu-id="cfd59-123">An example is when a lookup fails in the Lookup transformation.</span></span>  
  
 <span data-ttu-id="cfd59-124">Дополнительные сведения см. в статьях [Поток данных](data-flow.md) и [Пути служб Integration Services](integration-services-paths.md).</span><span class="sxs-lookup"><span data-stu-id="cfd59-124">For more information, see [Data Flow](data-flow.md) and [Integration Services Paths](integration-services-paths.md).</span></span>  
  
 <span data-ttu-id="cfd59-125">Список ошибок, предупреждений и других сообщений служб Integration Services см. в разделе [Integration Services Error and Message Reference](../integration-services-error-and-message-reference.md).</span><span class="sxs-lookup"><span data-stu-id="cfd59-125">For a list of Integration Services errors, warnings, and other messages, see [Integration Services Error and Message Reference](../integration-services-error-and-message-reference.md).</span></span>  
  
## <a name="error-and-truncation-options"></a><span data-ttu-id="cfd59-126">Параметры ошибок и усечения</span><span class="sxs-lookup"><span data-stu-id="cfd59-126">Error and Truncation Options</span></span>  
 <span data-ttu-id="cfd59-127">Ошибки разделяются на две категории: ошибки и усечения.</span><span class="sxs-lookup"><span data-stu-id="cfd59-127">Errors fall into one of two categories: errors or truncations.</span></span> <span data-ttu-id="cfd59-128">Ошибка указывает на определенную неполадку и формирует результат NULL.</span><span class="sxs-lookup"><span data-stu-id="cfd59-128">An error indicates an unequivocal failure, and generates a NULL result.</span></span> <span data-ttu-id="cfd59-129">Такие ошибки могут включать в себя ошибки преобразования данных или ошибки оценки выражений.</span><span class="sxs-lookup"><span data-stu-id="cfd59-129">Such errors can include data conversion errors or expression evaluation errors.</span></span> <span data-ttu-id="cfd59-130">Например, попытка преобразовать в число строку, содержащую буквенные символы, вызывает ошибку.</span><span class="sxs-lookup"><span data-stu-id="cfd59-130">For example, an attempt to convert a string that contains alphabetical characters to a number causes an error.</span></span> <span data-ttu-id="cfd59-131">Преобразования данных, вычисления выражений и назначения результатов выражений переменным, свойствам и столбцам данных могут завершиться неудачей вследствие неверного приведения типа или несовместимости типов данных.</span><span class="sxs-lookup"><span data-stu-id="cfd59-131">Data conversions, expression evaluations, and assignments of expression results to variables, properties, and data columns may fail because of illegal casts and incompatible data types.</span></span> <span data-ttu-id="cfd59-132">Дополнительные сведения см. в разделах [Приведение (выражение служб SSIS)](../expressions/cast-ssis-expression.md), [Типы данных в выражениях служб Integration Services](../expressions/integration-services-data-types-in-expressions.md) и [Типы данных служб Integration Services](integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="cfd59-132">For more information see, [Cast &#40;SSIS Expression&#41;](../expressions/cast-ssis-expression.md), [Integration Services Data Types in Expressions](../expressions/integration-services-data-types-in-expressions.md), and [Integration Services Data Types](integration-services-data-types.md).</span></span>  
  
 <span data-ttu-id="cfd59-133">Усечение менее серьезно, чем ошибка.</span><span class="sxs-lookup"><span data-stu-id="cfd59-133">A truncation is less serious than an error.</span></span> <span data-ttu-id="cfd59-134">Усечение формирует результаты, которые могут использоваться или даже быть желательными.</span><span class="sxs-lookup"><span data-stu-id="cfd59-134">A truncation generates results that might be usable or even desirable.</span></span> <span data-ttu-id="cfd59-135">Можно выбрать, интерпретировать усечения как ошибки или как приемлемые состояния.</span><span class="sxs-lookup"><span data-stu-id="cfd59-135">You can elect to treat truncations as errors or as acceptable conditions.</span></span> <span data-ttu-id="cfd59-136">Например, при вставке 15-символьной строки в столбец шириной всего в один символ можно выбрать усечение строки.</span><span class="sxs-lookup"><span data-stu-id="cfd59-136">For example, if you are inserting a 15-character string into a column that is only one character wide, you can elect to truncate the string.</span></span>  
  
 <span data-ttu-id="cfd59-137">Можно установить, как источники, преобразования и назначения обрабатывают ошибки и усечения.</span><span class="sxs-lookup"><span data-stu-id="cfd59-137">You can configure how sources, transformations, and destinations handle errors and truncations.</span></span> <span data-ttu-id="cfd59-138">В следующей таблице приводятся описания дополнительных параметров.</span><span class="sxs-lookup"><span data-stu-id="cfd59-138">The following table describes the options.</span></span>  
  
|<span data-ttu-id="cfd59-139">Параметр</span><span class="sxs-lookup"><span data-stu-id="cfd59-139">Option</span></span>|<span data-ttu-id="cfd59-140">Описание</span><span class="sxs-lookup"><span data-stu-id="cfd59-140">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="cfd59-141">Компонент, завершившийся сбоем</span><span class="sxs-lookup"><span data-stu-id="cfd59-141">Fail Component</span></span>|<span data-ttu-id="cfd59-142">Задача потока данных заканчивается сбоем, если возникли ошибка или усечение.</span><span class="sxs-lookup"><span data-stu-id="cfd59-142">The Data Flow task fails when an error or a truncation occurs.</span></span> <span data-ttu-id="cfd59-143">Неудача является параметром по умолчанию для ошибки и усечения.</span><span class="sxs-lookup"><span data-stu-id="cfd59-143">Failure is the default option for an error and a truncation.</span></span>|  
|<span data-ttu-id="cfd59-144">Пропуск неудачи</span><span class="sxs-lookup"><span data-stu-id="cfd59-144">Ignore Failure</span></span>|<span data-ttu-id="cfd59-145">Ошибка или усечение пропускаются, и строка данных направляется на выход преобразования или источника.</span><span class="sxs-lookup"><span data-stu-id="cfd59-145">The error or the truncation is ignored and the data row is directed to the output of the transformation or source.</span></span>|  
|<span data-ttu-id="cfd59-146">Перенаправление строки</span><span class="sxs-lookup"><span data-stu-id="cfd59-146">Redirect Row</span></span>|<span data-ttu-id="cfd59-147">Ошибка или строка данных усечения направляется на выход ошибок источника, преобразования или назначения.</span><span class="sxs-lookup"><span data-stu-id="cfd59-147">The error or the truncation data row is directed to the error output of the source, transformation, or destination.</span></span>|  
  
## <a name="adding-the-error-description"></a><span data-ttu-id="cfd59-148">Добавление описания ошибки</span><span class="sxs-lookup"><span data-stu-id="cfd59-148">Adding the Error Description</span></span>  
 <span data-ttu-id="cfd59-149">По умолчанию выходные данные по ошибкам предоставляют числовой код ошибки и, как правило, содержат идентификатор столбца, в котором эта ошибка возникла.</span><span class="sxs-lookup"><span data-stu-id="cfd59-149">By default an error output provides the numeric error code and usually contains the identifier of the column in which the error occurred.</span></span> <span data-ttu-id="cfd59-150">Можно использовать компонент скрипта для включения описания ошибки в дополнительный столбец, используя одну строку скрипта для вызова метода <xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100.GetErrorDescription%2A> интерфейса <xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100>.</span><span class="sxs-lookup"><span data-stu-id="cfd59-150">You can use the Script component to include the error description in an additional column by using a single line of script to call the <xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100.GetErrorDescription%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100> interface.</span></span>  
  
 <span data-ttu-id="cfd59-151">Компонент скрипта может быть добавлен в сегмент ошибки потока данных в любом месте выхода данных из компонента потока данных, чьи ошибки нужно перехватить, но обычно размещается непосредственно перед строками ошибок, которые пишутся в целевой объект.</span><span class="sxs-lookup"><span data-stu-id="cfd59-151">The Script component can be added to the error segment of the data flow anywhere downstream from the data flow components whose errors that you want to capture, but is typically placed immediately before the error rows are written to a destination.</span></span> <span data-ttu-id="cfd59-152">В этом случае скрипт просматривает только описание строк записанных ошибок.</span><span class="sxs-lookup"><span data-stu-id="cfd59-152">This way, the script looks up only descriptions for error rows that are written.</span></span> <span data-ttu-id="cfd59-153">Например, сегмент ошибки потока данных может исправить некоторые ошибки и не писать эти строки в целевой объект ошибок.</span><span class="sxs-lookup"><span data-stu-id="cfd59-153">For example, the error segment of the data flow may correct some errors and not write those rows to an error destination.</span></span> <span data-ttu-id="cfd59-154">Дополнительные сведения см. [в разделе Улучшение вывода ошибок с помощью компонента скрипта](../extending-packages-scripting-data-flow-script-component-examples/enhancing-an-error-output-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="cfd59-154">For more information, see [Enhancing an Error Output with the Script Component](../extending-packages-scripting-data-flow-script-component-examples/enhancing-an-error-output-with-the-script-component.md).</span></span>  
  
### <a name="to-configure-an-error-output"></a><span data-ttu-id="cfd59-155">Настройка выхода ошибок</span><span class="sxs-lookup"><span data-stu-id="cfd59-155">To configure an error output</span></span>  
  
-   [<span data-ttu-id="cfd59-156">Настройка вывода ошибок в компоненте потока данных</span><span class="sxs-lookup"><span data-stu-id="cfd59-156">Configure an Error Output in a Data Flow Component</span></span>](../configure-an-error-output-in-a-data-flow-component.md)  
  
## <a name="see-also"></a><span data-ttu-id="cfd59-157">См. также:</span><span class="sxs-lookup"><span data-stu-id="cfd59-157">See Also</span></span>  
 <span data-ttu-id="cfd59-158">[Поток данных](data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="cfd59-158">[Data Flow](data-flow.md) </span></span>  
 <span data-ttu-id="cfd59-159">[Преобразование данных с помощью преобразований](transformations/transform-data-with-transformations.md) </span><span class="sxs-lookup"><span data-stu-id="cfd59-159">[Transform Data with Transformations](transformations/transform-data-with-transformations.md) </span></span>  
 <span data-ttu-id="cfd59-160">[Соединение компонентов с путями](../connect-components-with-paths.md) </span><span class="sxs-lookup"><span data-stu-id="cfd59-160">[Connect Components with Paths](../connect-components-with-paths.md) </span></span>  
 <span data-ttu-id="cfd59-161">[Задача потока данных](../control-flow/data-flow-task.md) </span><span class="sxs-lookup"><span data-stu-id="cfd59-161">[Data Flow Task](../control-flow/data-flow-task.md) </span></span>  
 [<span data-ttu-id="cfd59-162">Поток данных</span><span class="sxs-lookup"><span data-stu-id="cfd59-162">Data Flow</span></span>](data-flow.md)  
  
  
