---
title: Использование переменных в пакетах | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- user-defined variables [Integration Services]
- variables [Integration Services], use scenarios
- system variables [Integration Services]
ms.assetid: 7742e92d-46c5-4cc4-b9a3-45b688ddb787
author: chugugrace
ms.author: chugu
ms.openlocfilehash: acfb6813406bd3a143712e40ec510a4658d4e5da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656452"
---
# <a name="use-variables-in-packages"></a><span data-ttu-id="31773-102">Использование переменных в пакетах</span><span class="sxs-lookup"><span data-stu-id="31773-102">Use Variables in Packages</span></span>
  <span data-ttu-id="31773-103">Переменные — полезное и гибкое дополнение к пакетам служб [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] ; переменные могут обеспечивать взаимодействие между объектами в пакете и между родительскими и дочерними пакетами.</span><span class="sxs-lookup"><span data-stu-id="31773-103">Variables are a useful and flexible addition to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages; they can provide communication among objects in the package, and between parent and child packages.</span></span> <span data-ttu-id="31773-104">Переменные также можно использовать в выражениях и скриптах.</span><span class="sxs-lookup"><span data-stu-id="31773-104">Variables can also be used in expressions and scripts.</span></span>  
  
## <a name="user-defined-variables-and-system-variables"></a><span data-ttu-id="31773-105">Пользовательские и системные переменные</span><span class="sxs-lookup"><span data-stu-id="31773-105">User-Defined Variables and System Variables</span></span>  
 <span data-ttu-id="31773-106">Службы [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] предоставляют системные переменные и поддерживают работу с пользовательскими.</span><span class="sxs-lookup"><span data-stu-id="31773-106">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] provides system variables and supports user-defined variables.</span></span> <span data-ttu-id="31773-107">При создании нового пакета, добавлении в него контейнера или задачи или создании обработчика событий служб [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] включает в контейнер набор системных переменных.</span><span class="sxs-lookup"><span data-stu-id="31773-107">When you create a new package, add a container or a task to a package, or create an event handler, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] includes a set of system variables for the container.</span></span> <span data-ttu-id="31773-108">Системные переменные хранят полезную информацию о пакете, контейнере, задаче или обработчике событий.</span><span class="sxs-lookup"><span data-stu-id="31773-108">System variables contain useful information about a package, container, task, or event handler.</span></span> <span data-ttu-id="31773-109">Например, во время выполнения системная переменная **MachineName** хранит имя компьютера, на котором запущен пакет, а переменная **StartTime** — время начала выполнения пакета.</span><span class="sxs-lookup"><span data-stu-id="31773-109">For example, at run time the **MachineName** system variable contains the name of the computer on which the package is running and **StartTime** the time the package started to run.</span></span> <span data-ttu-id="31773-110">Системные переменные доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="31773-110">System variables are read-only.</span></span> <span data-ttu-id="31773-111">Дополнительные сведения см. в статье [System Variables](system-variables.md).</span><span class="sxs-lookup"><span data-stu-id="31773-111">For more information, see [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="31773-112">Можно создавать пользовательские переменные и задействовать их в пакетах.</span><span class="sxs-lookup"><span data-stu-id="31773-112">You can create user-defined variables and then use them in packages.</span></span> <span data-ttu-id="31773-113">Пользовательские переменные могут использоваться в службах [!INCLUDE[ssIS](../includes/ssis-md.md)]различными способами: в скриптах, в выражениях, использующих элементы управления очередностью, в контейнере "цикл по элементам", в преобразованиях "Производный столбец" и "Условное разбиение" и в выражениях, обновляющих значения свойств.</span><span class="sxs-lookup"><span data-stu-id="31773-113">User-defined variables can be used in many ways in [!INCLUDE[ssIS](../includes/ssis-md.md)]: in scripts; in the expressions used by precedence constraints, the For Loop container, the Derived Column transformation, and the Conditional Split transformation; and in the property expressions that update property values.</span></span>  
  
 <span data-ttu-id="31773-114">Например, пользовательскую переменную можно задействовать в вычислении условия для контейнера «цикл по элементам».</span><span class="sxs-lookup"><span data-stu-id="31773-114">For example, you can use a user-defined variable in the evaluation condition for the For Loop container.</span></span> <span data-ttu-id="31773-115">Можно также сопоставить значение перечислителя коллекции в контейнере «цикл по каждому элементу» с переменной, а если задача «Выполнение SQL» содержит параметризованную инструкцию, то можно сопоставить параметры инструкции с переменными.</span><span class="sxs-lookup"><span data-stu-id="31773-115">You can also map the enumerator collection value in a Foreach Loop container to a variable, and if an Execute SQL task uses a parameterized SQL statement, you can map the parameters for the statement to variables.</span></span> <span data-ttu-id="31773-116">Дополнительные сведения см. в разделе [Переменные служб Integration Services (SSIS)](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="31773-116">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>  
  
## <a name="variables-usage-scenarios"></a><span data-ttu-id="31773-117">Сценарии использования переменных</span><span class="sxs-lookup"><span data-stu-id="31773-117">Variables Usage Scenarios</span></span>  
 <span data-ttu-id="31773-118">Переменные в пакетах [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] используются различными способами.</span><span class="sxs-lookup"><span data-stu-id="31773-118">Variables are used in many different ways in [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages.</span></span> <span data-ttu-id="31773-119">Возможно, что разработка пакетов будет затруднительна без добавления в пакет пользовательских переменных для реализации гибкости и управляемости решений.</span><span class="sxs-lookup"><span data-stu-id="31773-119">You will probably find that package development does not progress far before you have to add a user-defined variable to your package to implement the flexibility and manageability your solution requires.</span></span> <span data-ttu-id="31773-120">В зависимости от сценария также используются системные переменные.</span><span class="sxs-lookup"><span data-stu-id="31773-120">Depending on the scenario, system variables are also commonly used.</span></span>  
  
 <span data-ttu-id="31773-121">**Выражение свойств.** Используйте переменные для предоставления значений в выражениях свойств, устанавливающих свойства пакетов и объектов пакетов.</span><span class="sxs-lookup"><span data-stu-id="31773-121">**Property Expressions** Use variables to provide values in the property expressions that set the properties of packages and package objects.</span></span> <span data-ttu-id="31773-122">Например, выражение `SELECT * FROM @varTableName` включает переменную `varTableName` , которая обновляет инструкцию SQL, выполняемую задачей «Выполнение SQL».</span><span class="sxs-lookup"><span data-stu-id="31773-122">For example, the expression, `SELECT * FROM @varTableName` includes the variable `varTableName` that updates the SQL statement that an Execute SQL task runs.</span></span> <span data-ttu-id="31773-123">Выражение `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`обновляет пакет, выполняемый задачей «Выполнение пакета», запуская пакет, указанный в переменной `varPackageFirst` , в первый день месяца и пакет, указанный в переменной `varPackageOther` , в остальные дни.</span><span class="sxs-lookup"><span data-stu-id="31773-123">The expression, `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`", updates the package that the Execute Package task runs, by running the package specified in the `varPackageFirst` variable on the first day of the month and running the package specified in the `varPackageOther` variable on other days.</span></span> <span data-ttu-id="31773-124">Дополнительные сведения см. в разделе [Использование выражений свойств в пакетах](expressions/use-property-expressions-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="31773-124">For more information, see [Use Property Expressions in Packages](expressions/use-property-expressions-in-packages.md).</span></span>  
  
 <span data-ttu-id="31773-125">**Выражения потоков данных.** Используйте переменные для предоставления значений выражениям, используемым преобразованиями «Производный столбец» и «Условное разбиение» для заполнения столбцов или направления строк на различные выходы преобразования.</span><span class="sxs-lookup"><span data-stu-id="31773-125">**Data Flow Expressions** Use variables to provide values in the expressions that the Derived Column and Conditional Split transformations use to populate columns, or to direct data rows to different transformation outputs.</span></span> <span data-ttu-id="31773-126">Например, выражение `@varSalutation + LastName`объединяет значение переменной `VarSalutation` и столбец `LastName` .</span><span class="sxs-lookup"><span data-stu-id="31773-126">For example, the expression, `@varSalutation + LastName`, concatenates the value in the `VarSalutation` variable and the `LastName` column.</span></span> <span data-ttu-id="31773-127">Выражение `Income < @HighIncome`направляет на выход строки данных, в которых значение столбца `Income` меньше значения переменной `HighIncome` .</span><span class="sxs-lookup"><span data-stu-id="31773-127">The expression, `Income < @HighIncome`, directs data rows in which the value of the `Income` column is less than the value in the `HighIncome` variable to an output.</span></span> <span data-ttu-id="31773-128">Дополнительные сведения см. в разделах [Преобразование "Производный столбец"](data-flow/transformations/derived-column-transformation.md), [Преобразование "Условное разбиение"](data-flow/transformations/conditional-split-transformation.md) и [Выражения служб Integration Services (SSIS)](expressions/integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="31773-128">For more information, see [Derived Column Transformation](data-flow/transformations/derived-column-transformation.md), [Conditional Split Transformation](data-flow/transformations/conditional-split-transformation.md), and [Integration Services &#40;SSIS&#41; Expressions](expressions/integration-services-ssis-expressions.md).</span></span>  
  
 <span data-ttu-id="31773-129">**Выражения управления очередностью.** Предоставляют значения для использования в управлении очередностью для определения запуска исполняемого объекта с таким управлением.</span><span class="sxs-lookup"><span data-stu-id="31773-129">**Precedence Constraint Expressions** Provide values to use in precedence constraints to determine whether a constrained executable runs.</span></span> <span data-ttu-id="31773-130">Эти выражения могут использоваться вместе с результатом выполнения (успех, ошибка, завершение) либо вместо результата выполнения.</span><span class="sxs-lookup"><span data-stu-id="31773-130">The expressions can be used either together with an execution outcome (success, failure, completion), or instead of an execution outcome.</span></span> <span data-ttu-id="31773-131">Например, если выражение `@varMax > @varMin` получает значение `true`, исполняемый объект запускается.</span><span class="sxs-lookup"><span data-stu-id="31773-131">For example, if the expression, `@varMax > @varMin`, evaluates to `true`, the executable runs.</span></span> <span data-ttu-id="31773-132">Дополнительные сведения см. в статье [Добавление выражений к элементам управления очередностью](control-flow/precedence-constraints.md).</span><span class="sxs-lookup"><span data-stu-id="31773-132">For more information, see [Add Expressions to Precedence Constraints](control-flow/precedence-constraints.md).</span></span>  
  
 <span data-ttu-id="31773-133">**Параметры и коды возврата.** Предоставляют значения для ввода параметров или сохраняют значения выходных параметров и кодов возврата.</span><span class="sxs-lookup"><span data-stu-id="31773-133">**Parameters and Return Codes** Provide values to input parameters, or store the values of output parameters and return codes.</span></span> <span data-ttu-id="31773-134">Это можно сделать с помощью сопоставления переменных с параметрами и возвращаемыми значениями.</span><span class="sxs-lookup"><span data-stu-id="31773-134">You do this by mapping the variables to parameters and return values.</span></span> <span data-ttu-id="31773-135">Например, если переменная `varProductId` имеет значение 23 при выполнении инструкции SQL `SELECT * from Production.Product WHERE ProductID = ?`, запрос получит продукты с идентификатором `ProductID` , равным 23.</span><span class="sxs-lookup"><span data-stu-id="31773-135">For example, if you set the variable `varProductId` to 23 and run the SQL statement, `SELECT * from Production.Product WHERE ProductID = ?`, the query retrieves the product with a `ProductID` of 23.</span></span> <span data-ttu-id="31773-136">Дополнительные сведения см. в разделах [Задача "Выполнение SQL"](control-flow/execute-sql-task.md) и [Параметры и коды возврата в задаче "Выполнение SQL"](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="31773-136">For more information, see [Execute SQL Task](control-flow/execute-sql-task.md) and [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="31773-137">**Выражения контейнера «цикл по элементам».** Предоставляют значения для использования выражений инициализации, оценки и присваивания в контейнере «цикл по элементам».</span><span class="sxs-lookup"><span data-stu-id="31773-137">**For Loop Expressions** Provide values to use in the initialization, evaluation, and assignment expressions of the For Loop.</span></span> <span data-ttu-id="31773-138">Например, если переменная `varCount` имеет значение 2, а `varMaxCount` — 10, выражением инициализации является `@varCount`, выражением оценки —  `@varCount < @varMaxCount`, а выражением присваивания — `@varCount =@varCount +1`, цикл повторится 8 раз.</span><span class="sxs-lookup"><span data-stu-id="31773-138">For example, if the variable `varCount` is 2 and `varMaxCount` is 10, the initialization expression is `@varCount`, the evaluation expression is  `@varCount < @varMaxCount`, and the assignment expression is `@varCount =@varCount +1`, then the loop repeats 8 times.</span></span> <span data-ttu-id="31773-139">Дополнительные сведения см. в статье [For Loop Container](control-flow/for-loop-container.md).</span><span class="sxs-lookup"><span data-stu-id="31773-139">For more information, see [For Loop Container](control-flow/for-loop-container.md).</span></span>  
  
 <span data-ttu-id="31773-140">**Конфигурации переменной родительского пакета.** Передает значения из родительского пакета в дочерний.</span><span class="sxs-lookup"><span data-stu-id="31773-140">**Parent Package Variable Configurations** Pass values from parent packages to child packages.</span></span> <span data-ttu-id="31773-141">Дочерние пакеты могут получить доступ к переменным родительского пакета путем использования конфигураций переменных пакета.</span><span class="sxs-lookup"><span data-stu-id="31773-141">Child packages can access variables in the parent package by using parent package variable configurations.</span></span> <span data-ttu-id="31773-142">Например, если дочерний пакет должен использовать ту же дату, что и родительский пакет, он может определить конфигурацию переменной родительского пакета, которая определяет значение переменной, установленное с помощью функции GETDATE.</span><span class="sxs-lookup"><span data-stu-id="31773-142">For example, if the child package must use the same date as the parent package, the child package can define a parent package variable configuration that specifies a variable set by the GETDATE function in the parent package.</span></span> <span data-ttu-id="31773-143">Дополнительные сведения см. в разделах [Execute Package Task](control-flow/execute-package-task.md) и [Package Configurations](../../2014/integration-services/package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="31773-143">For more information, see [Execute Package Task](control-flow/execute-package-task.md) and [Package Configurations](../../2014/integration-services/package-configurations.md).</span></span>  
  
 <span data-ttu-id="31773-144">**Задача скрипта и компонент скрипта** . Предоставляет список переменных только для чтения и чтения/записи для задач "Скрипт" и компонента скрипта, обновляет переменные для чтения/записи с помощью скрипта и использует обновленные значения в скрипте или вне его.</span><span class="sxs-lookup"><span data-stu-id="31773-144">**Script Task and Script Component** Provide a list of read-only and read/write variable to the Script task or Script component, update the read/write variables within the script, and then use the updated values in or outside the script.</span></span> <span data-ttu-id="31773-145">Например, в коде `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`переменная скрипта `numberOfCars` обновлена значением переменной `NumberOfCars`.</span><span class="sxs-lookup"><span data-stu-id="31773-145">For example, in the code, `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, the script variable `numberOfCars` is updated by the value in the variable, `NumberOfCars`.</span></span> <span data-ttu-id="31773-146">Дополнительные сведения см. в статье [Using Variables in the Script Task](control-flow/script-task.md).</span><span class="sxs-lookup"><span data-stu-id="31773-146">For more information, see [Using Variables in the Script Task](control-flow/script-task.md).</span></span>  
  
## <a name="configurations-and-variables"></a><span data-ttu-id="31773-147">Конфигурации и переменные</span><span class="sxs-lookup"><span data-stu-id="31773-147">Configurations and Variables</span></span>  
 <span data-ttu-id="31773-148">Чтобы динамически обновлять переменные, можно создавать конфигурации для переменных, развертывать их вместе с пакетами и обновлять значения переменных в файле конфигурации при развертывании пакета.</span><span class="sxs-lookup"><span data-stu-id="31773-148">To dynamically update variables, you can create configurations for the variables, deploy the configurations with the package, and then update the variable values in the configuration file when you deploy the packages.</span></span> <span data-ttu-id="31773-149">Во время выполнения пакет будет использовать обновленные значения переменных.</span><span class="sxs-lookup"><span data-stu-id="31773-149">At run time, the package uses the updated variable values.</span></span> <span data-ttu-id="31773-150">Дополнительные сведения см. в разделе [Создание конфигурации пакетов](../../2014/integration-services/create-package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="31773-150">For more information, see [Create Package Configurations](../../2014/integration-services/create-package-configurations.md).</span></span>  
  
### <a name="to-add-modify-and-delete-user-defined-variables"></a><span data-ttu-id="31773-151">Добавление, изменение или удаление пользовательских переменных</span><span class="sxs-lookup"><span data-stu-id="31773-151">To add, modify, and delete user-defined variables</span></span>  
  
-   [<span data-ttu-id="31773-152">Добавление, удаление и изменение области определяемой пользователем переменной в пакете</span><span class="sxs-lookup"><span data-stu-id="31773-152">Add, Delete, Change Scope of User-Defined Variable in a Package</span></span>](../../2014/integration-services/add-delete-change-scope-of-user-defined-variable-in-a-package.md)  
  
-   [<span data-ttu-id="31773-153">Установка свойств определяемой пользователем переменной</span><span class="sxs-lookup"><span data-stu-id="31773-153">Set the Properties of a User-Defined Variable</span></span>](../../2014/integration-services/set-the-properties-of-a-user-defined-variable.md)  
  
  
