---
title: конструктор запросов | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder dialog box
ms.assetid: 780752c9-6e3c-4f44-aaff-4f4d5e5a45c5
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 81be066d92ef1e19a141414dad4359b60efca2f9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729602"
---
# <a name="query-builder"></a><span data-ttu-id="b8d8c-102">Построитель запросов</span><span class="sxs-lookup"><span data-stu-id="b8d8c-102">Query Builder</span></span>
  <span data-ttu-id="b8d8c-103">Используйте диалоговое окно **Построитель запросов** , чтобы создать запрос для использования в задаче «Выполнение SQL», в источнике и цели OLE DB, а также в преобразовании «Уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="b8d8c-103">Use the **Query Builder** dialog box to create a query for use in the Execute SQL task, the OLE DB source and the OLE DB destination, and the Lookup transformation.</span></span>  
  
 <span data-ttu-id="b8d8c-104">Построитель запросов можно использовать для выполнения следующих задач.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-104">You can use Query Builder to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="b8d8c-105">**Работа с графическим представлением запроса или с командами SQL** Построитель запросов располагает панелью, которая отображает запрос в графическом виде, и панелью, которая содержит текст SQL-запроса.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-105">**Working with a graphical representation of a query or with SQL commands** Query Builder includes a pane that displays your query graphically and a pane that displays the SQL text of your query.</span></span> <span data-ttu-id="b8d8c-106">Можно работать либо в графической, либо в текстовой панели.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-106">You can work in either the graphical pane or the text pane.</span></span> <span data-ttu-id="b8d8c-107">Построитель запросов синхронизирует представления, так что они всегда отражают текущее состояние.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-107">Query Builder synchronizes the views so that they are always current.</span></span>  
  
-   <span data-ttu-id="b8d8c-108">**Соединение связанных таблиц** Если к запросу добавляется более одной таблицы, построитель запросов автоматически определяет взаимосвязь таблиц и создает подходящую команду соединения.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-108">**Joining related tables** If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="b8d8c-109">**Выполнение запроса и обновление баз данных** Построитель запросов можно использовать для возврата данных с помощью инструкции SELECT языка Transact-SQL, а также для создания запросов, которые обновляют, добавляют или удаляют записи в базе данных.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-109">**Querying or updating databases** You can use Query Builder to return data by using Transact-SQL SELECT statements and to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="b8d8c-110">**Просмотр и немедленное редактирование результатов** Можно запустить запрос и работать с набором записей в сетке, позволяющей просматривать и редактировать записи в базе данных.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-110">**Viewing and editing results immediately** You can run your query and work with a recordset in a grid that allows you to scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="b8d8c-111">Графические средства в диалоговом окне **Построитель запросов** позволяют создавать запросы с помощью операций перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-111">The graphical tools in the **Query Builder** dialog box let you construct queries using drag-and-drop operations.</span></span> <span data-ttu-id="b8d8c-112">По умолчанию в диалоговом окне построителя запросов строятся запросы SELECT, также можно строить запросы INSERT, UPDATE или DELETE.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-112">By default, the Query Builder dialog box constructs SELECT queries, but you can also build INSERT, UPDATE, or DELETE queries.</span></span> <span data-ttu-id="b8d8c-113">Все типы инструкций SQL также могут быть проанализированы и выполнены в диалоговом окне **Построитель запросов** .</span><span class="sxs-lookup"><span data-stu-id="b8d8c-113">All types of SQL statements can be parsed and run in the **Query Builder** dialog box.</span></span> <span data-ttu-id="b8d8c-114">Дополнительные сведения об инструкциях SQL в пакетах см. в разделе [Запросы в службах Integration Services (SSIS)](integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="b8d8c-114">For more information about SQL statements in packages, see [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="b8d8c-115">Для более подробного знакомства с языком Transact-SQL и его синтаксисом см. раздел [Справочник по Transact-SQL (компонент Database Engine)](/sql/t-sql/language-reference).</span><span class="sxs-lookup"><span data-stu-id="b8d8c-115">To learn more about the Transact-SQL language and its syntax, see [Transact-SQL Reference &#40;Database Engine&#41;](/sql/t-sql/language-reference).</span></span>  
  
 <span data-ttu-id="b8d8c-116">Кроме того, в запросе можно использовать переменные для предоставления значений входному параметру, для сбора значений выходных параметров и хранения кодов возврата.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-116">You can also use variables in a query to provide values to an input parameter, to capture values of output parameters, and to store return codes.</span></span> <span data-ttu-id="b8d8c-117">Дополнительные сведения об использовании переменных в запросах пакетов см. в разделах [Задача "Выполнение SQL"](control-flow/execute-sql-task.md), [Источник OLE DB](data-flow/ole-db-source.md)и [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="b8d8c-117">To learn more about using variables in the queries that packages use, see [Execute SQL Task](control-flow/execute-sql-task.md), [OLE DB Source](data-flow/ole-db-source.md), and [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span> <span data-ttu-id="b8d8c-118">Дополнительные сведения об использовании переменных в задаче "Выполнение SQL" см. в разделах [Параметры и коды возврата в задаче "Выполнение SQL"](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) и [Результирующие наборы в задаче "Выполнение SQL"](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="b8d8c-118">To learn more about using variables in the Execute SQL Task, see [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) and [Result Sets in the Execute SQL Task](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="b8d8c-119">Переменные с параметрами и кодами возврата используются в преобразованиях «Уточняющий запрос» и «Нечеткий уточняющий запрос».</span><span class="sxs-lookup"><span data-stu-id="b8d8c-119">The Lookup and Fuzzy lookup transformations can also use variables with parameters and return codes.</span></span> <span data-ttu-id="b8d8c-120">Сведения об источнике OLE DB применимы к этим двум преобразованиям.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-120">The information about the OLE DB source applies to these two transformations also.</span></span>  
  
## <a name="options"></a><span data-ttu-id="b8d8c-121">Варианты</span><span class="sxs-lookup"><span data-stu-id="b8d8c-121">Options</span></span>  
 <span data-ttu-id="b8d8c-122">**Панель инструментов**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-122">**Toolbar**</span></span>  
 <span data-ttu-id="b8d8c-123">Используйте панель инструментов для управления наборами данных, для выбора отображаемых областей, а также для управления функциями запросов.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-123">Use the toolbar to manage datasets, select panes to display, and control query functions.</span></span>  
  
|<span data-ttu-id="b8d8c-124">Значение</span><span class="sxs-lookup"><span data-stu-id="b8d8c-124">Value</span></span>|<span data-ttu-id="b8d8c-125">Описание</span><span class="sxs-lookup"><span data-stu-id="b8d8c-125">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="b8d8c-126">**Показать/скрыть панель диаграмм**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-126">**Show/Hide Diagram Pane**</span></span>|<span data-ttu-id="b8d8c-127">Показывает или скрывает панель **диаграмм** .</span><span class="sxs-lookup"><span data-stu-id="b8d8c-127">Shows or hides the **Diagram** pane.</span></span>|  
|<span data-ttu-id="b8d8c-128">**Показать/скрыть панель сетки**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-128">**Show/Hide Grid Pane**</span></span>|<span data-ttu-id="b8d8c-129">Показывает или скрывает панель **сетки** .</span><span class="sxs-lookup"><span data-stu-id="b8d8c-129">Shows or hides the **Grid** pane.</span></span>|  
|<span data-ttu-id="b8d8c-130">**Показать/скрыть панель SQL**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-130">**Show/Hide SQL Pane**</span></span>|<span data-ttu-id="b8d8c-131">Показывает или скрывает панель **SQL** .</span><span class="sxs-lookup"><span data-stu-id="b8d8c-131">Shows or hides the **SQL** pane.</span></span>|  
|<span data-ttu-id="b8d8c-132">**Показать/скрыть панель результатов**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-132">**Show/Hide Results Pane**</span></span>|<span data-ttu-id="b8d8c-133">Показывает или скрывает панель **Результаты** .</span><span class="sxs-lookup"><span data-stu-id="b8d8c-133">Shows or hides the **Results** pane.</span></span>|  
|<span data-ttu-id="b8d8c-134">**Выполнить**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-134">**Run**</span></span>|<span data-ttu-id="b8d8c-135">Выполняет запрос.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-135">Runs the query.</span></span> <span data-ttu-id="b8d8c-136">Результаты отображаются на панели результатов.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-136">Results are displayed in the result pane.</span></span>|  
|<span data-ttu-id="b8d8c-137">**Проверить SQL**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-137">**Verify SQL**</span></span>|<span data-ttu-id="b8d8c-138">Осуществляет проверку допустимости инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-138">Verifies that the SQL statement is valid.</span></span>|  
|<span data-ttu-id="b8d8c-139">**Сортировка по возрастанию**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-139">**Sort Ascending**</span></span>|<span data-ttu-id="b8d8c-140">Сортирует по возрастанию выходные строки в выбранном столбце на панели сетки.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-140">Sorts output rows on the selected column in the grid pane, in ascending order.</span></span>|  
|<span data-ttu-id="b8d8c-141">**Сортировка по убыванию**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-141">**Sort Descending**</span></span>|<span data-ttu-id="b8d8c-142">Сортирует по убыванию выходные строки в выбранном столбце на панели сетки.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-142">Sorts output rows on the selected column in the grid pane, in descending order.</span></span>|  
|<span data-ttu-id="b8d8c-143">**Удалить фильтр**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-143">**Remove Filter**</span></span>|<span data-ttu-id="b8d8c-144">Выберите имя столбца на панели сетки, а затем нажмите кнопку **Удалить фильтр** , чтобы удалить критерии сортировки для столбца.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-144">Select a column name in the grid pane, and then click **Remove Filter** to remove sort criteria for the column.</span></span>|  
|<span data-ttu-id="b8d8c-145">**Использовать Group By**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-145">**Use Group By**</span></span>|<span data-ttu-id="b8d8c-146">Добавляет к запросу функцию GROUP BY.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-146">Adds GROUP BY functionality to the query.</span></span>|  
|<span data-ttu-id="b8d8c-147">**Добавить таблицу**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-147">**Add Table**</span></span>|<span data-ttu-id="b8d8c-148">Добавляет новую таблицу в запрос.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-148">Adds a new table to the query.</span></span>|  
  
 <span data-ttu-id="b8d8c-149">**Определение запроса**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-149">**Query Definition**</span></span>  
 <span data-ttu-id="b8d8c-150">Определение запроса предлагает панель инструментов и набор других областей, при помощи которых можно определить и проверить запрос.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-150">The query definition provides a toolbar and panes in which to define and test the query.</span></span>  
  
|<span data-ttu-id="b8d8c-151">Панель</span><span class="sxs-lookup"><span data-stu-id="b8d8c-151">Pane</span></span>|<span data-ttu-id="b8d8c-152">Описание</span><span class="sxs-lookup"><span data-stu-id="b8d8c-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="b8d8c-153">Панель **диаграммы**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-153">**Diagram** pane</span></span>|<span data-ttu-id="b8d8c-154">Отображает запрос в виде диаграммы.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-154">Displays the query in a diagram.</span></span> <span data-ttu-id="b8d8c-155">Диаграмма показывает включенные в запрос таблицы, а также способы их соединения.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-155">The diagram shows the tables included in the query, and how they are joined.</span></span> <span data-ttu-id="b8d8c-156">Установите или снимите флажок рядом со столбцом в таблице, чтобы добавить или исключить его из результатов запроса.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-156">Select or clear the check box next to a column in a table to add or remove it from the query output.</span></span><br /><br /> <span data-ttu-id="b8d8c-157">При добавлении таблиц в запрос построитель запросов создает соединения между таблицами на основе ключей в таблице.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-157">When you add tables to the query, Query Builder creates joins between tables based on tables, depending on the keys in the table.</span></span> <span data-ttu-id="b8d8c-158">Чтобы добавить соединение, перетащите поле одной таблицы на поле другой таблицы.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-158">To add a join, drag a field from one table onto a field in another table.</span></span> <span data-ttu-id="b8d8c-159">Для управления соединением щелкните его правой кнопкой мыши, а затем выберите пункт в меню.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-159">To manage a join, right-click the join, and then select a menu option.</span></span><br /><br /> <span data-ttu-id="b8d8c-160">Щелкните правой кнопкой мыши панель **Диаграмма** , чтобы добавить или удалить таблицы, выбрать все таблицы, а также показать или скрыть панели.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-160">Right-click the **Diagram** pane to add or remove tables, select all the tables, and show or hide panes.</span></span>|  
|<span data-ttu-id="b8d8c-161">Панель **сетки**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-161">**Grid** pane</span></span>|<span data-ttu-id="b8d8c-162">Отображает запрос в виде сетки.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-162">Displays the query in a grid.</span></span> <span data-ttu-id="b8d8c-163">Можно использовать эту панель, чтобы добавить или удалить столбцы из запроса и изменить настройки для каждого столбца.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-163">You can use this pane to add to and remove columns from the query and change the settings for each column.</span></span>|  
|<span data-ttu-id="b8d8c-164">Панель **SQL**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-164">**SQL** pane</span></span>|<span data-ttu-id="b8d8c-165">Отображает запрос в виде текста SQL.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-165">Displays the query as SQL text.</span></span> <span data-ttu-id="b8d8c-166">Изменения, совершенные на панели **Диаграмма** и на панели **Сетка** отобразятся здесь, а изменения, совершенные здесь, будут отображены на панели **Диаграмма** и на панели **Сетка** .</span><span class="sxs-lookup"><span data-stu-id="b8d8c-166">Changes made in the **Diagram** pane and the **Grid** pane will appear here, and changes made here will appear in the **Diagram** pane and the **Grid** pane.</span></span>|  
|<span data-ttu-id="b8d8c-167">Панель**результатов**</span><span class="sxs-lookup"><span data-stu-id="b8d8c-167">**Results** pane</span></span>|<span data-ttu-id="b8d8c-168">Отображает результаты запроса после нажатия кнопки **Выполнить** на панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="b8d8c-168">Displays the results of the query when you click **Run** on the toolbar.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b8d8c-169">См. также:</span><span class="sxs-lookup"><span data-stu-id="b8d8c-169">See Also</span></span>  
 <span data-ttu-id="b8d8c-170">[Задача «Выполнение SQL»](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="b8d8c-170">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 <span data-ttu-id="b8d8c-171">[Источник OLE DB](data-flow/ole-db-source.md) </span><span class="sxs-lookup"><span data-stu-id="b8d8c-171">[OLE DB Source](data-flow/ole-db-source.md) </span></span>  
 <span data-ttu-id="b8d8c-172">[Назначение OLE DB](data-flow/ole-db-destination.md) </span><span class="sxs-lookup"><span data-stu-id="b8d8c-172">[OLE DB Destination](data-flow/ole-db-destination.md) </span></span>  
 <span data-ttu-id="b8d8c-173">[Преобразование «Уточняющий запрос»](data-flow/transformations/lookup-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="b8d8c-173">[Lookup Transformation](data-flow/transformations/lookup-transformation.md) </span></span>  
 <span data-ttu-id="b8d8c-174">[Запросы&#41; Integration Services &#40;SSIS](integration-services-ssis-queries.md) </span><span class="sxs-lookup"><span data-stu-id="b8d8c-174">[Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md) </span></span>  
 [<span data-ttu-id="b8d8c-175">Предложение MERGE в пакетах служб Integration Services</span><span class="sxs-lookup"><span data-stu-id="b8d8c-175">MERGE in Integration Services Packages</span></span>](control-flow/merge-in-integration-services-packages.md)  
  
  
