---
title: Установка Поставщик Analysis Services OLE DB на серверах SharePoint | Документация Майкрософт
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: 2c62daf9-1f2d-4508-a497-af62360ee859
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 371d344a451e7702a525e0cb6afa3421b6598cac
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666382"
---
# <a name="install-the-analysis-services-ole-db-provider-on-sharepoint-servers"></a><span data-ttu-id="d05f5-102">Установка поставщика OLE DB служб Analysis Services на серверах SharePoint</span><span class="sxs-lookup"><span data-stu-id="d05f5-102">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>
  <span data-ttu-id="d05f5-103">Поставщик Microsoft OLE DB для служб Analysis Services (MSOLAP) представляет собой интерфейс, используемый клиентскими приложениями для взаимодействия с данными служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-103">The Microsoft OLE DB Provider for Analysis Services (MSOLAP) is an interface that client applications use to interact with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="d05f5-104">В среде SharePoint, где установлен [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], поставщик обрабатывает запросы на подключение к данным [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-104">In a SharePoint environment that includes [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], the provider handles connection requests for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data.</span></span>  
  
 <span data-ttu-id="d05f5-105">Поставщик данных включен в пакет установки [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] (spPowerPivot.msi), но, возможно, потребуется и ручная установка.</span><span class="sxs-lookup"><span data-stu-id="d05f5-105">The data provider is included in the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi), but might require manual installation.</span></span> <span data-ttu-id="d05f5-106">Существует две причины, по которым может потребоваться установить клиентские библиотеки или поставщики данных вручную на сервер SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d05f5-106">There are two reasons why you might need to manually install a client library or data provider on a SharePoint server.</span></span>  
  
-   <span data-ttu-id="d05f5-107">**Включить обратную совместимость**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-107">**Enable backwards compatibility**.</span></span> <span data-ttu-id="d05f5-108">Книги [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] указывают версию [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] поставщика OLE DB служб Analysis Services в своей строке подключения.</span><span class="sxs-lookup"><span data-stu-id="d05f5-108">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] workbooks specify the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the Analysis Services OLE DB provider in their connection string.</span></span> <span data-ttu-id="d05f5-109">В связи с этим для успешного выполнения запроса на компьютере должна присутствовать эта версия поставщика.</span><span class="sxs-lookup"><span data-stu-id="d05f5-109">As such, this provider version must be present on the computer in order for the request to succeed.</span></span>  
  
-   <span data-ttu-id="d05f5-110">**Разрешение доступа к данным на выделенном экземпляре служб Excel**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-110">**Enable data access on a dedicated Excel Services instance**.</span></span> <span data-ttu-id="d05f5-111">Если в ферме SharePoint есть службы Excel Services на сервере, на котором нет [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], необходимо установить версию [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] поставщика и другие компоненты для обеспечения связи с клиентами с помощью пакета установки [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-111">If your SharePoint farm includes Excel Services on a server that does not also have [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] version of the provider and other client connectivity components by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="d05f5-112">Эти ситуации не являются взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="d05f5-112">These scenarios are not mutually exclusive.</span></span> <span data-ttu-id="d05f5-113">Для размещения книг нескольких версий в ферме, в которой есть серверы приложений, использующие службы Excel Services без экземпляра [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], потребуется установить и старые и новые версии поставщика данных на каждый компьютер со службами Excel Services.</span><span class="sxs-lookup"><span data-stu-id="d05f5-113">Hosting multiple workbook versions on a farm that includes application servers running Excel Services without a [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instance will require that you install both older and newer versions of the data provider on each Excel Services computer.</span></span>  
  
  
##  <a name="versions-of-the-ole-db-provider-supporting-powerpivot-data-access"></a><a name="bkmk_vers"></a><span data-ttu-id="d05f5-114">Версии поставщика OLE DB, поддерживающего доступ к данным PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d05f5-114">Versions of the OLE DB Provider Supporting PowerPivot Data Access</span></span>  
 <span data-ttu-id="d05f5-115">Ферма SharePoint может включать несколько версий поставщика OLE DB служб Analysis Services, включая предыдущие версии, которые не поддерживают доступ к данным PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d05f5-115">A SharePoint farm might include multiple versions of the Analysis Services OLE DB provider, including older versions that do not support PowerPivot data access.</span></span>  
  
 <span data-ttu-id="d05f5-116">По умолчанию вместе с SharePoint 2010 устанавливается версия [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] поставщика.</span><span class="sxs-lookup"><span data-stu-id="d05f5-116">By default, SharePoint 2010 installs the [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the provider.</span></span> <span data-ttu-id="d05f5-117">Хотя он определяется как MSOLAP.4 (та же версия, которая используется для [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), данная версия не работает для доступа к данным PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d05f5-117">Although it is identified as MSOLAP.4 (the same version number used for [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), this version does not work for PowerPivot data access.</span></span> <span data-ttu-id="d05f5-118">Чтобы успешно установить соединение, необходима версия [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] или [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] поставщика.</span><span class="sxs-lookup"><span data-stu-id="d05f5-118">In order for connections to succeed, you must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of the provider.</span></span>  
  
 <span data-ttu-id="d05f5-119">Следующая за [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] версия поставщика OLE DB включает новые средства поддержки транспорта и соединений для структур данных служб [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-119">A post [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the OLE DB provider includes transports and connection support for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data structures.</span></span> <span data-ttu-id="d05f5-120">В книгах [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] используются новые версии поставщика для передачи запросов на обработку серверам [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] в ферме.</span><span class="sxs-lookup"><span data-stu-id="d05f5-120">[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks use newer versions of this provider to request query processing from [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] servers in the farm.</span></span> <span data-ttu-id="d05f5-121">Чтобы получить обновленную версию, можно загрузить ее и установить с помощью страницы «Пакет дополнительных компонентов SQL Server».</span><span class="sxs-lookup"><span data-stu-id="d05f5-121">To get an updated version, you can download and install it through a SQL Server Feature Pack page.</span></span>  
  
 <span data-ttu-id="d05f5-122">В следующей таблице описаны допустимые значения.</span><span class="sxs-lookup"><span data-stu-id="d05f5-122">The following table describes the valid versions:</span></span>  
  
|<span data-ttu-id="d05f5-123">Версия продукта</span><span class="sxs-lookup"><span data-stu-id="d05f5-123">Product version</span></span>|<span data-ttu-id="d05f5-124">Версия файла</span><span class="sxs-lookup"><span data-stu-id="d05f5-124">File version</span></span>|<span data-ttu-id="d05f5-125">Действует для:</span><span class="sxs-lookup"><span data-stu-id="d05f5-125">Valid for:</span></span>|  
|---------------------|------------------|----------------|  
|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]|<span data-ttu-id="d05f5-126">MSOLAP100.dll в файловой системе</span><span class="sxs-lookup"><span data-stu-id="d05f5-126">MSOLAP100.dll in the file system</span></span><br /><br /> <span data-ttu-id="d05f5-127">MSOLAP.4 в строке подключения Excel</span><span class="sxs-lookup"><span data-stu-id="d05f5-127">MSOLAP.4 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="d05f5-128">10.50.1600 или выше в подробных сведениях о версии файла</span><span class="sxs-lookup"><span data-stu-id="d05f5-128">10.50.1600 or later in file version details</span></span>|<span data-ttu-id="d05f5-129">Используется для моделей данных, созданных с помощью надстройки PowerPivot для Excel версии [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-129">Use for data models created using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel.</span></span>|  
|[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]|<span data-ttu-id="d05f5-130">MSOLAP110.dll в файловой системе</span><span class="sxs-lookup"><span data-stu-id="d05f5-130">MSOLAP110.dll in the file system</span></span><br /><br /> <span data-ttu-id="d05f5-131">MSOLAP.5 в строке подключения Excel</span><span class="sxs-lookup"><span data-stu-id="d05f5-131">MSOLAP.5 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="d05f5-132">11.0.0000 или выше в подробных сведениях о версии файла</span><span class="sxs-lookup"><span data-stu-id="d05f5-132">11.0.0000 or later in file version details</span></span>|<span data-ttu-id="d05f5-133">Используется для моделей данных, созданных с помощью [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] для Excel версии [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] или [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-133">Use for data models created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span>|  
|[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]|<span data-ttu-id="d05f5-134">MSOLAP120.dll в файловой системе</span><span class="sxs-lookup"><span data-stu-id="d05f5-134">MSOLAP120.dll in the file system</span></span><br /><br /> <span data-ttu-id="d05f5-135">12.0.20000 или выше в подробных сведениях о версии файла</span><span class="sxs-lookup"><span data-stu-id="d05f5-135">12.0.20000 or later in file version details</span></span>|<span data-ttu-id="d05f5-136">Используется для моделей данных, отличных от моделей [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-136">Use for data models other than [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] models.</span></span>|  
  
  
##  <a name="why-you-need-to-install-the-ole-db-provider"></a><a name="bkmk_why"></a><span data-ttu-id="d05f5-137">Зачем нужно устанавливать поставщик OLE DB</span><span class="sxs-lookup"><span data-stu-id="d05f5-137">Why you need to install the OLE DB Provider</span></span>  
 <span data-ttu-id="d05f5-138">Встречаются две ситуации, которые могут вызвать необходимость установки поставщика OLE DB на серверах фермы вручную.</span><span class="sxs-lookup"><span data-stu-id="d05f5-138">There are two scenarios that call for manually installing the OLE DB provider on servers in the farm.</span></span>  
  
 <span data-ttu-id="d05f5-139">**Наиболее распространенный сценарий** — при наличии более старых и более новых версий [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] книг, сохраненных в библиотеках документов в ферме.</span><span class="sxs-lookup"><span data-stu-id="d05f5-139">**The most common scenario** is when you have older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks that are saved in document libraries in the farm.</span></span> <span data-ttu-id="d05f5-140">Если аналитики организации пользуются надстройкой [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] версии [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для Excel и сохраняют такие книги в установке [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], то старые книги работать не будут.</span><span class="sxs-lookup"><span data-stu-id="d05f5-140">If analysts in your organization are using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel, and they save those workbooks to a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, the older workbook will not work.</span></span> <span data-ttu-id="d05f5-141">Строка подключения будет ссылаться на старую версию поставщика, которая не будет находиться на сервере, если она не установлена.</span><span class="sxs-lookup"><span data-stu-id="d05f5-141">Its connection string will reference an older version of the provider, which won't be on the server unless you install it.</span></span> <span data-ttu-id="d05f5-142">Установка обеих версий поможет обеспечить доступ к данным в книгах PowerPivot, созданных и в старых и в новых версиях надстройки [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для Excel.</span><span class="sxs-lookup"><span data-stu-id="d05f5-142">Installing both versions will enable data access for PowerPivot workbooks created in older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span> <span data-ttu-id="d05f5-143">Программа установки [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] не устанавливает версию [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] поставщика, поэтому его необходимо установить вручную, чтобы обеспечить доступ к книгам из предыдущей версии.</span><span class="sxs-lookup"><span data-stu-id="d05f5-143">[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Setup does not install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider, so you must install it manually if you are using workbooks from a previous version.</span></span>  
  
 <span data-ttu-id="d05f5-144">**Второй сценарий** заключается в том, что в ферме SharePoint, где запущены службы Excel, есть сервер [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d05f5-144">**The second scenario** is when you have a server in a SharePoint farm that runs Excel Services, but not [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="d05f5-145">В этом случае сервер приложений, на котором запускаются службы Excel, должен быть обновлен вручную для использования новой версии поставщика.</span><span class="sxs-lookup"><span data-stu-id="d05f5-145">In this case, the application server that runs Excel Services must be manually updated to use a newer version of the provider.</span></span> <span data-ttu-id="d05f5-146">Это необходимо для соединения с экземпляром PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d05f5-146">This is necessary for connecting to a PowerPivot for SharePoint instance.</span></span> <span data-ttu-id="d05f5-147">Если службы Excel Services используют старую версия поставщика, запрос на соединение выполнить не удастся.</span><span class="sxs-lookup"><span data-stu-id="d05f5-147">If Excel Services is using an older version of the provider, the connection request will fail.</span></span> <span data-ttu-id="d05f5-148">Обратите внимание, что поставщик должен быть установлен с помощью мастера установки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или пакета установки [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] (spPowerPivot.msi), чтобы были установлены поддерживающие элементы для всех компонентов [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-148">Note that the provider must be installed by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup or the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi) in order to ensure that all components required support [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] are installed.</span></span>  
  
  
##  <a name="install-the-sql-server-2012-ole-db-provider-on-an-excel-services-server-by-using-sql-server-setup"></a><a name="bkmk_sql11"></a><span data-ttu-id="d05f5-149">Установка поставщика SQL Server 2012 OLE DB на сервере служб Excel с помощью программы установки SQL Server</span><span class="sxs-lookup"><span data-stu-id="d05f5-149">Install the SQL Server 2012 OLE DB Provider on an Excel Services server by using SQL Server Setup</span></span>  
 <span data-ttu-id="d05f5-150">Следующие инструкции помогут установить поставщик OLE DB и другие компоненты для обеспечения связи с клиентами на серверах SharePoint, где он еще не установлен, например на серверах приложений, где службы Excel Services работают без надстройки PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d05f5-150">Use the following instructions to add the OLE DB provider and other client connectivity components to SharePoint servers that do not already have them installed, such as application servers that run Excel Services without PowerPivot for SharePoint on the same hardware.</span></span>  
  
 <span data-ttu-id="d05f5-151">Используйте эти инструкции, чтобы установить текущий поставщик Analysis Services OLE DB и добавить **Microsoft.AnalysisServices.Xmla.dll** в глобальную сборку.</span><span class="sxs-lookup"><span data-stu-id="d05f5-151">Use these instructions to install the current Analysis Services OLE DB provider and to add the **Microsoft.AnalysisServices.Xmla.dll** to the global assembly.</span></span>  
  
#### <a name="run-sql-server-setup-and-install-the-client-connectivity-tools"></a><span data-ttu-id="d05f5-152">Запуск программы установки SQL Server и установка клиентских средств подключения</span><span class="sxs-lookup"><span data-stu-id="d05f5-152">Run SQL Server Setup and Install the Client Connectivity Tools</span></span>  
  
1.  <span data-ttu-id="d05f5-153">На сервере приложений, где размещены службы Excel Services, запустите программу установки SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d05f5-153">On the application server that hosts Excel Services, run SQL Server Setup.</span></span>  
  
2.  <span data-ttu-id="d05f5-154">На странице Установка выберите пункт **создать SQL Server изолированную установку или добавить компоненты к существующей установке**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-154">On the Installation page, choose **New SQL Server stand-alone installation or add features to an existing installation**.</span></span>  
  
3.  <span data-ttu-id="d05f5-155">На странице Тип установки выберите **выполнить новую установку SQL Server 2012**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-155">On the Installation Type page, choose **Perform a new installation of SQL Server 2012**.</span></span>  
  
4.  <span data-ttu-id="d05f5-156">На странице Роль установки выберите **SQL Server Установка компонентов**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-156">On the Setup Role page, choose **SQL Server Feature Installation**.</span></span>  
  
5.  <span data-ttu-id="d05f5-157">На странице **Выбор компонентов** щелкните элемент **клиентские средства подключение**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-157">On the **Feature Selection** page, click **Client Tools Connectivity**.</span></span> <span data-ttu-id="d05f5-158">Этот параметр устанавливает **Microsoft.AnalysisServices.Xmla.dll**</span><span class="sxs-lookup"><span data-stu-id="d05f5-158">This option installs **Microsoft.AnalysisServices.Xmla.dll**</span></span>  
  
     <span data-ttu-id="d05f5-159">Не выбирайте другие функции.</span><span class="sxs-lookup"><span data-stu-id="d05f5-159">Do not select any other features.</span></span>  
  
6.  <span data-ttu-id="d05f5-160">Нажмите кнопку **Далее** , чтобы завершить работу мастера, а затем нажмите кнопку **установить** , чтобы запустить программу установки.</span><span class="sxs-lookup"><span data-stu-id="d05f5-160">Click **Next** to finish the wizard, and then click **Install** to run Setup.</span></span>  
  
7.  <span data-ttu-id="d05f5-161">При наличии других серверов со службами Excel Services, на которых не установлена надстройка PowerPivot для SharePoint, повторите описанные выше шаги.</span><span class="sxs-lookup"><span data-stu-id="d05f5-161">Repeat the previous steps if you have other servers running Excel Services, without a PowerPivot for SharePoint installation on the same server.</span></span>  
  
#### <a name="verify-msolap5-is-a-trusted-provider"></a><span data-ttu-id="d05f5-162">Убедитесь в том, что MSOLAP.5 является надежным поставщиком</span><span class="sxs-lookup"><span data-stu-id="d05f5-162">Verify MSOLAP.5 is a trusted provider</span></span>  
  
1.  <span data-ttu-id="d05f5-163">В центре администрирования выберите **Управление приложениями служб**и щелкните приложение служб Excel Services.</span><span class="sxs-lookup"><span data-stu-id="d05f5-163">In Central Administration, click **Manage service applications**, and then click the Excel Services service application.</span></span>  
  
2.  <span data-ttu-id="d05f5-164">Щелкните **Надежные поставщики данных**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-164">Click **Trusted Data Providers**.</span></span>  
  
3.  <span data-ttu-id="d05f5-165">Убедитесь, что в списке отображается MSOLAP.5.</span><span class="sxs-lookup"><span data-stu-id="d05f5-165">Verify that MSOLAP.5 appears in the list.</span></span> <span data-ttu-id="d05f5-166">MSOLAP.5 уже может быть надежным поставщиком, в зависимости от настройки PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d05f5-166">Depending on how you configured PowerPivot for SharePoint, MSOLAP.5 might already be trusted.</span></span> <span data-ttu-id="d05f5-167">Если вы использовали средство конфигурации PowerPivot, а затем выполнили это действие из списка задач, поставщик MSOLAP.5 не будет надежным для служб Excel Services. В этом случае его необходимо будет добавить вручную.</span><span class="sxs-lookup"><span data-stu-id="d05f5-167">If you used the PowerPivot Configuration tool, but then excluded this action from the task list, MSOLAP.5 will not be trusted by Excel Services and now needs to be added manually.</span></span>  
  
4.  <span data-ttu-id="d05f5-168">Если MSOLAP нет в списке, щелкните **Добавить доверенный поставщик данных**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-168">If MSOLAP is not listed, click **Add Trusted Data Provider**.</span></span>  
  
5.  <span data-ttu-id="d05f5-169">В качестве идентификатора поставщика введите `MSOLAP.5`.</span><span class="sxs-lookup"><span data-stu-id="d05f5-169">In Provider ID, type `MSOLAP.5`.</span></span>  
  
6.  <span data-ttu-id="d05f5-170">В качестве типа поставщика необходимо указать OLE DB.</span><span class="sxs-lookup"><span data-stu-id="d05f5-170">For Provider Type, ensure that OLE DB is selected.</span></span>  
  
7.  <span data-ttu-id="d05f5-171">В поле "Описание поставщика" введите **Поставщик Microsoft OLE DB для OLAP Services 11.0**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-171">In Provider Description, type **Microsoft OLE DB Provider for OLAP Services 11.0**.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="d05f5-172">Проверка установки</span><span class="sxs-lookup"><span data-stu-id="d05f5-172">Verify installation</span></span>  
  
1.  <span data-ttu-id="d05f5-173">Перейдите в каталог «Program Files\Microsoft Analysis Services\AS OLEDB\110».</span><span class="sxs-lookup"><span data-stu-id="d05f5-173">Go to Program files\Microsoft Analysis Services\AS OLEDB\110.</span></span>  
  
2.  <span data-ttu-id="d05f5-174">Щелкните правой кнопкой мыши файл msolap110.dll и выберите пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-174">Right-click msolap110.dll and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="d05f5-175">Щелкните **Сведения**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-175">Click **Details**.</span></span>  
  
4.  <span data-ttu-id="d05f5-176">Просмотрите информацию о версии файла.</span><span class="sxs-lookup"><span data-stu-id="d05f5-176">View the file version information.</span></span> <span data-ttu-id="d05f5-177">Версия должна включать 11,00. \<buildnumber> .</span><span class="sxs-lookup"><span data-stu-id="d05f5-177">The version should include 11.00.\<buildnumber>.</span></span>  
  
5.  <span data-ttu-id="d05f5-178">Удостоверьтесь, что в папке «Windows\assembly» присутствует файл Microsoft.AnalysisServices.Xmla.dll версии 11.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="d05f5-178">In the Windows\assembly folder, verify that Microsoft.AnalysisServices.Xmla.dll, version 11.0.0.0, is listed.</span></span>  
  
  
##  <a name="use-the-powerpivot-for-sharepoint-installation-package-sppowerpivotmsi-to-install-the-sql-server-2012-ole-db-provider"></a><a name="bkmk_install2012_from_sppowerpivot_msi"></a><span data-ttu-id="d05f5-179">Используйте пакет установки PowerPivot для SharePoint (spPowerPivot.msi) для установки поставщика OLE DB SQL Server 2012</span><span class="sxs-lookup"><span data-stu-id="d05f5-179">Use the PowerPivot for SharePoint Installation package (spPowerPivot.msi) to install the SQL Server 2012 OLE DB Provider</span></span>  
 <span data-ttu-id="d05f5-180">Установите [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] поставщик OLE DB на сервере служб Excel и с помощью [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] пакета установки **(spPowerPivot.msi)**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-180">Install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] OLE DB Provider on and Excel Services Server by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package **(spPowerPivot.msi)**.</span></span>  
  
#### <a name="download-the-msolap5-provider-from-the-sssql11sp1-feature-pack"></a><span data-ttu-id="d05f5-181">Загрузите поставщик MSOLAP.5 из пакета дополнительных компонентов [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d05f5-181">Download the MSOLAP.5 provider from the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] Feature Pack.</span></span>  
  
1.  <span data-ttu-id="d05f5-182">Перейдите в [пакет дополнительных компонентов Microsoft® SQL Server® 2012 с пакетом обновления 1 (SP1)](https://www.microsoft.com/download/details.aspx?id=35580)</span><span class="sxs-lookup"><span data-stu-id="d05f5-182">Browse to [Microsoft® SQL Server® 2012 SP1 Feature Pack](https://www.microsoft.com/download/details.aspx?id=35580)</span></span>  
  
2.  <span data-ttu-id="d05f5-183">Нажмите кнопку **установить инструкции**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-183">Click **Install Instructions**.</span></span>  
  
3.  <span data-ttu-id="d05f5-184">См. раздел «Поставщик Microsoft Analysis Services OLE DB для Microsoft SQL Server 2012 с пакетом обновления 1 (SP1)».</span><span class="sxs-lookup"><span data-stu-id="d05f5-184">See the section "Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1".</span></span> <span data-ttu-id="d05f5-185">Загрузите файл и начните установку.</span><span class="sxs-lookup"><span data-stu-id="d05f5-185">Download the file and start the installation.</span></span>  
  
4.  <span data-ttu-id="d05f5-186">На странице **Выбор компонентов** выберите **поставщик Analysis Services OLE DB для SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-186">On the **Feature Selection** page, select **Analysis Services OLE DB Provider for SQL Server**.</span></span> <span data-ttu-id="d05f5-187">Снимите флажки с других компонентов и завершите установку.</span><span class="sxs-lookup"><span data-stu-id="d05f5-187">Unselect the other components and complete the installation.</span></span> <span data-ttu-id="d05f5-188">Дополнительные сведения о spPowerPivot.msi см. в [статье Установка и удаление надстройки PowerPivot для SharePoint &#40;&#41;SharePoint 2013 ](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span><span class="sxs-lookup"><span data-stu-id="d05f5-188">For more information on spPowerPivot.msi, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
5.  <span data-ttu-id="d05f5-189">Зарегистрируйте MSOLAP.5 в качестве надежного поставщика в службах Excel SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d05f5-189">Register MSOLAP.5 as a trusted provider with SharePoint Excel Services.</span></span> <span data-ttu-id="d05f5-190">Дополнительные сведения см. в разделе [Добавление MSOLAP.5 в качестве надежного поставщика данных в службах Excel Services](https://technet.microsoft.com/library/hh758436.aspx).</span><span class="sxs-lookup"><span data-stu-id="d05f5-190">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://technet.microsoft.com/library/hh758436.aspx).</span></span>  
  
  
##  <a name="install-the-sql-server-2008-r2-ole-db-provider-to-host-earlier-version-workbooks"></a><a name="bkmk_kj"></a><span data-ttu-id="d05f5-191">Установка поставщика SQL Server 2008 R2 OLE DB для размещения книг более ранних версий</span><span class="sxs-lookup"><span data-stu-id="d05f5-191">Install the SQL Server 2008 R2 OLE DB Provider to host earlier version workbooks</span></span>  
 <span data-ttu-id="d05f5-192">Используйте следующие инструкции, чтобы установить версию [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] поставщика MSOLAP.4 и зарегистрировать файл Microsoft.AnalysisServices.ChannelTransport.dll.</span><span class="sxs-lookup"><span data-stu-id="d05f5-192">Use the following instructions to install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the MSOLAP.4 provider, and register the Microsoft.AnalysisServices.ChannelTransport.dll file.</span></span> <span data-ttu-id="d05f5-193">ChannelTransport является дочерним компонентом поставщика OLE DB служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="d05f5-193">The ChannelTransport is a subcomponent of the Analysis Services OLE DB provider.</span></span> <span data-ttu-id="d05f5-194">Версия [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] поставщика читает реестр с помощью метода ChannelTransport для установления подключения.</span><span class="sxs-lookup"><span data-stu-id="d05f5-194">The [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider reads the registry when using ChannelTransport to make a connection.</span></span> <span data-ttu-id="d05f5-195">Регистрация этого файла после выполнения установки требуется только для тех соединений, которые обрабатываются поставщиком [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] на сервере [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-195">Registering this file is a post-installation step required only for connections handled by the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] provider on a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] server.</span></span>  
  
#### <a name="step-1-download-and-install-the-client-library"></a><span data-ttu-id="d05f5-196">Шаг 1. скачивание и установка клиентской библиотеки</span><span class="sxs-lookup"><span data-stu-id="d05f5-196">Step 1: Download and install the client library</span></span>  
  
1.  <span data-ttu-id="d05f5-197">На [странице пакет дополнительных компонентов SQL Server 2008 R2](https://www.microsoft.com/download/details.aspx?id=44272)найдите поставщик Microsoft Analysis Services OLE DB для Microsoft SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="d05f5-197">On the [SQL Server 2008 R2 Feature Pack page](https://www.microsoft.com/download/details.aspx?id=44272), find Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 R2.</span></span>  
  
2.  <span data-ttu-id="d05f5-198">Загрузите пакет x64 программы установки `SQLServer2008_ASOLEDB10.msi`.</span><span class="sxs-lookup"><span data-stu-id="d05f5-198">Download the x64 Package of the `SQLServer2008_ASOLEDB10.msi` installation program.</span></span> <span data-ttu-id="d05f5-199">Несмотря на то что в имени содержится SQLServer2008, это правильный файл для поставщика версии SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="d05f5-199">Although the file name contains SQLServer2008, it is the correct file for the SQL Server 2008 R2 version of the provider.</span></span>  
  
3.  <span data-ttu-id="d05f5-200">На компьютере, где имеется установка [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], запустите файл MSI, чтобы установить библиотеку.</span><span class="sxs-lookup"><span data-stu-id="d05f5-200">On the computer that has an installation of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], run the .msi to install the library.</span></span>  
  
4.  <span data-ttu-id="d05f5-201">Если в ферме есть другие серверы, которые используют только службы Excel Services, без [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] на том же компьютере, повторите предыдущие шаги, чтобы установить версию 2008 R2 поставщика на компьютер со службами Excel Services.</span><span class="sxs-lookup"><span data-stu-id="d05f5-201">If you have other servers in the farm that run just Excel Services, without [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] on the same server, repeat the previous steps to install the 2008 R2 version of the provider on the Excel Services computer.</span></span>  
  
#### <a name="step-2-register-the-microsoftanalysisserviceschanneltransportdll-file"></a><span data-ttu-id="d05f5-202">Шаг 2. Регистрация файла Microsoft.AnalysisServices.ChannelTransport.dll</span><span class="sxs-lookup"><span data-stu-id="d05f5-202">Step 2: Register the Microsoft.AnalysisServices.ChannelTransport.dll file</span></span>  
  
1.  <span data-ttu-id="d05f5-203">Используйте программу regasm.exe для регистрации файла.</span><span class="sxs-lookup"><span data-stu-id="d05f5-203">Use the regasm.exe utility to register the file.</span></span> <span data-ttu-id="d05f5-204">Если вы не выполняли regasm.exe до, добавьте ее родительскую папку C:\Windows\Microsoft.NET\Framework64\v4.0.30319 \\ в переменную системного пути.</span><span class="sxs-lookup"><span data-stu-id="d05f5-204">If you have not run regasm.exe before, add its parent folder, C:\Windows\Microsoft.NET\Framework64\v4.0.30319\\, to the system path variable.</span></span>  
  
2.  <span data-ttu-id="d05f5-205">Откройте командную строку с разрешениями администратора.</span><span class="sxs-lookup"><span data-stu-id="d05f5-205">Open a command prompt with administrator permissions.</span></span>  
  
3.  <span data-ttu-id="d05f5-206">Перейдите в папку «С:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91»</span><span class="sxs-lookup"><span data-stu-id="d05f5-206">Go to this folder C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span></span>  
  
4.  <span data-ttu-id="d05f5-207">Введите следующую команду: `regasm microsoft.analysisservices.channeltransport.dll`</span><span class="sxs-lookup"><span data-stu-id="d05f5-207">Enter the following command: `regasm microsoft.analysisservices.channeltransport.dll`</span></span>  
  
5.  <span data-ttu-id="d05f5-208">Повторите предыдущие шаги для любого компьютера, на который вручную установили версию 2008 R2 поставщика.</span><span class="sxs-lookup"><span data-stu-id="d05f5-208">Repeat the previous steps for any computer on which you manually installed the 2008 R2 version of the provider.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="d05f5-209">Проверка установки</span><span class="sxs-lookup"><span data-stu-id="d05f5-209">Verify installation</span></span>  
  
1.  <span data-ttu-id="d05f5-210">Теперь можно делать срезы или фильтровать книги [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d05f5-210">You should now be able to slice or filter [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] workbooks.</span></span> <span data-ttu-id="d05f5-211">Если возникает какая-либо ошибка, убедитесь, что для регистрации файла вы использовали 64-разрядную версию программы regasm.exe.</span><span class="sxs-lookup"><span data-stu-id="d05f5-211">If an error occurs, verify that you used the 64-bit version of regasm.exe to register the file.</span></span>  
  
2.  <span data-ttu-id="d05f5-212">Кроме того, вы можете проверить версию файла.</span><span class="sxs-lookup"><span data-stu-id="d05f5-212">Additionally, you can check the file version.</span></span>  
  
     <span data-ttu-id="d05f5-213">Перейдите по адресу `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`.</span><span class="sxs-lookup"><span data-stu-id="d05f5-213">Go to `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`.</span></span> <span data-ttu-id="d05f5-214">Щелкните правой кнопкой мыши **msolap100.dll** и выберите пункт **свойства**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-214">Right-click **msolap100.dll** and select **Properties**.</span></span> <span data-ttu-id="d05f5-215">Щелкните **Сведения**.</span><span class="sxs-lookup"><span data-stu-id="d05f5-215">Click **Details**.</span></span>  
  
     <span data-ttu-id="d05f5-216">Просмотрите информацию о версии файла.</span><span class="sxs-lookup"><span data-stu-id="d05f5-216">View the file version information.</span></span> <span data-ttu-id="d05f5-217">Версия должна включать 10,50. \<buildnumber> .</span><span class="sxs-lookup"><span data-stu-id="d05f5-217">The version should include 10.50.\<buildnumber>.</span></span>  
  
  
## <a name="see-also"></a><span data-ttu-id="d05f5-218">См. также:</span><span class="sxs-lookup"><span data-stu-id="d05f5-218">See Also</span></span>  
 [<span data-ttu-id="d05f5-219">Установка PowerPivot для SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="d05f5-219">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
  
  
