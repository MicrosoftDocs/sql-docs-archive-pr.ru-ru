---
title: Настройка брандмауэра Windows для разрешения доступа к SQL Server | Документация Майкрософт
ms.custom: ''
ms.date: 06/22/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- Windows Firewall ports
- WMI firewall ports
- Windows Firewall [Database Engine]
- firewall systems, configuring
- advfirewall
- firewall systems
- rules firewall
- firewall systems, overview and port list
- 1433 TCP port
- portopening using netsh
- ports [SQL Server], TCP
- netsh to open firewall ports
ms.assetid: f55c6a0e-b6bd-4803-b51a-f3a419803024
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: d1a0bc32040fc90e5f73faa708f314722bc8f3b5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87657499"
---
# <a name="configure-the-windows-firewall-to-allow-sql-server-access"></a><span data-ttu-id="6a6b1-102">Configure the Windows Firewall to Allow SQL Server Access</span><span class="sxs-lookup"><span data-stu-id="6a6b1-102">Configure the Windows Firewall to Allow SQL Server Access</span></span>
  <span data-ttu-id="6a6b1-103">Системы брандмауэров предотвращают несанкционированный доступ к ресурсам компьютера.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-103">Firewall systems help prevent unauthorized access to computer resources.</span></span> <span data-ttu-id="6a6b1-104">Если брандмауэр включен, но настроен неправильно, попытка соединения с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может оказаться заблокированной.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-104">If a firewall is turned on but not correctly configured, attempts to connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might be blocked.</span></span>  
  
 <span data-ttu-id="6a6b1-105">Чтобы разрешить доступ к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] через брандмауэр, его необходимо настроить на компьютере, на котором работает [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-105">To access an instance of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] through a firewall, you must configure the firewall on the computer that is running [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to allow access.</span></span> <span data-ttu-id="6a6b1-106">Брандмауэр является компонентом [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-106">The firewall is a component of [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span></span> <span data-ttu-id="6a6b1-107">Вместо него можно установить брандмауэр другой компании.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-107">You can also install a firewall from another company.</span></span> <span data-ttu-id="6a6b1-108">В данном разделе обсуждается настройка брандмауэра Windows, однако общие принципы применимы к любым другим брандмауэрам.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-108">This topic discusses how to configure the Windows firewall, but the basic principles apply to other firewall programs.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6a6b1-109">В разделе содержатся общие сведения о настройке брандмауэра и сводные сведения, представляющие интерес для администратора [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-109">This topic provides an overview of firewall configuration and summarizes information of interest to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] administrator.</span></span> <span data-ttu-id="6a6b1-110">Дополнительные сведения и официальные данные о брандмауэрах см. в документации по брандмауэру, например в разделе [Брандмауэр Windows в режиме повышенной безопасности и IPsec](https://go.microsoft.com/fwlink/?LinkID=116904).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-110">For more information about the firewall and for authoritative firewall information, see the firewall documentation, such as [Windows Firewall with Advanced Security and IPsec](https://go.microsoft.com/fwlink/?LinkID=116904).</span></span>  
  
 <span data-ttu-id="6a6b1-111">Пользователи, хорошо знакомые с элементом **Брандмауэр Windows** на панели управления и оснасткой "Брандмауэр Windows в режиме повышенной безопасности" консоли управления (MMC) и умеющие настраивать параметры брандмауэра, могут перейти непосредственно к разделам, приведенным в списке ниже.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-111">Users familiar with the **Windows Firewall** item in Control Panel and with the Windows Firewall with Advanced Security Microsoft Management Console (MMC) snap-in and who know which firewall settings they want to configure can move directly to the topics in the following list:</span></span>  
  
-   [<span data-ttu-id="6a6b1-112">Настройка брандмауэра Windows для доступа к компоненту Database Engine</span><span class="sxs-lookup"><span data-stu-id="6a6b1-112">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
-   [<span data-ttu-id="6a6b1-113">Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6a6b1-113">Configure the Windows Firewall to Allow Analysis Services Access</span></span>](../../../2014/analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access.md)  
  
-   [<span data-ttu-id="6a6b1-114">настроить брандмауэр для доступа к серверу отчетов</span><span class="sxs-lookup"><span data-stu-id="6a6b1-114">Configure a Firewall for Report Server Access</span></span>](../../reporting-services/report-server/configure-a-firewall-for-report-server-access.md)  
  

  
##  <a name="basic-firewall-information"></a><a name="BKMK_basic"></a> <span data-ttu-id="6a6b1-115">Основные сведения о брандмауэрах</span><span class="sxs-lookup"><span data-stu-id="6a6b1-115">Basic Firewall Information</span></span>  
 <span data-ttu-id="6a6b1-116">Брандмауэр проверяет входящие пакеты на соответствие набору правил.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-116">Firewalls work by inspecting incoming packets, and comparing them against a set of rules.</span></span> <span data-ttu-id="6a6b1-117">Если правила разрешают передачу пакета, то брандмауэр передает его протоколу TCP/IP для дальнейшей обработки.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-117">If the rules allow the packet, the firewall passes the packet to the TCP/IP protocol for additional processing.</span></span> <span data-ttu-id="6a6b1-118">Если передача пакета правилами не разрешена, то брандмауэр отвергает его и, если включено ведение журнала, создает в файле журнала соответствующую запись.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-118">If the rules do not allow the packet, the firewall discards the packet and, if logging is enabled, creates an entry in the firewall logging file.</span></span>  
  
 <span data-ttu-id="6a6b1-119">Список разрешенного трафика заполняется одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-119">The list of allowed traffic is populated in one of the following ways:</span></span>  
  
-   <span data-ttu-id="6a6b1-120">Когда защищенный брандмауэром компьютер открывает соединение, брандмауэр добавляет в список элемент, разрешающий ответ по этому соединению.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-120">When the computer that has the firewall enabled initiates communication, the firewall creates an entry in the list so that the response is allowed.</span></span> <span data-ttu-id="6a6b1-121">Полученный ответ рассматривается как ожидаемый и не требует настройки.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-121">The incoming response is considered solicited traffic and you do not have to configure this.</span></span>  
  
-   <span data-ttu-id="6a6b1-122">Работа администратора заключается в настройке исключений в работе брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-122">An administrator configures exceptions to the firewall.</span></span> <span data-ttu-id="6a6b1-123">Это дает возможность разрешать доступ определенным программам, запущенным на компьютере, либо доступ к определенным портам.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-123">This allows either access to specified programs running on your computer, or access to specified connection ports on your computer.</span></span> <span data-ttu-id="6a6b1-124">В этом случае компьютер принимает весь входящий трафик, выполняя роль сервера, прослушивателя или однорангового узла.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-124">In this case, the computer accepts unsolicited incoming traffic when acting as a server, a listener, or a peer.</span></span> <span data-ttu-id="6a6b1-125">Для соединения с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]должна быть выполнена именно такая настройка.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-125">This is the type of configuration that must be completed to connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="6a6b1-126">Выбор стратегии брандмауэра является более сложной задачей и не сводится лишь к открытию или закрытию портов.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-126">Choosing a firewall strategy is more complex than just deciding if a given port should be open or closed.</span></span> <span data-ttu-id="6a6b1-127">При выборе стратегии брандмауэра для предприятия необходимо обязательно рассмотреть все доступные правила и параметры конфигурации.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-127">When designing a firewall strategy for your enterprise, make sure that you consider all the rules and configuration options available to you.</span></span> <span data-ttu-id="6a6b1-128">В этом разделе все возможные параметры брандмауэра не рассматриваются.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-128">This topic does not review all the possible firewall options.</span></span> <span data-ttu-id="6a6b1-129">Рекомендуется ознакомиться со следующими документами.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-129">We recommend that you review the following documents:</span></span>  
  
 [<span data-ttu-id="6a6b1-130">Руководство по началу работы с брандмауэром Windows в режиме повышенной безопасности</span><span class="sxs-lookup"><span data-stu-id="6a6b1-130">Windows Firewall with Advanced Security Getting Started Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=116080)  
  
 [<span data-ttu-id="6a6b1-131">Руководство разработчика по брандмауэру Windows в режиме повышенной безопасности</span><span class="sxs-lookup"><span data-stu-id="6a6b1-131">Windows Firewall with Advanced Security Design Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=116904)  
  
 [<span data-ttu-id="6a6b1-132">Основные сведения об изоляции серверов и доменов</span><span class="sxs-lookup"><span data-stu-id="6a6b1-132">Introduction to Server and Domain Isolation</span></span>](https://go.microsoft.com/fwlink/?LinkId=116081)  
  
##  <a name="default-firewall-settings"></a><a name="BKMK_default"></a> <span data-ttu-id="6a6b1-133">Параметры брандмауэра по умолчанию</span><span class="sxs-lookup"><span data-stu-id="6a6b1-133">Default Firewall Settings</span></span>  
 <span data-ttu-id="6a6b1-134">Первым шагом при планировании конфигурации брандмауэра является определение его текущего состояния в операционной системе.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-134">The first step in planning your firewall configuration is to determine the current status of the firewall for your operating system.</span></span> <span data-ttu-id="6a6b1-135">Если операционная система была обновлена с предыдущей версии, в ней могли сохраниться старые настройки брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-135">If the operating system was upgraded from a previous version, the earlier firewall settings may have been preserved.</span></span> <span data-ttu-id="6a6b1-136">Кроме того, параметры брандмауэра могли быть изменены другим администратором или групповой политикой домена.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-136">Also, the firewall settings could have been changed by another administrator or by a Group Policy in your domain.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6a6b1-137">Включение брандмауэра может повлиять на общий доступ к файлам и принтерам, подключения к удаленному рабочему столу и работу других программ, которым необходим доступ к компьютеру.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-137">Turning on the firewall will affect other programs that access this computer, such as file and print sharing, and remote desktop connections.</span></span> <span data-ttu-id="6a6b1-138">Администратор должен просмотреть все приложения, которые работают на компьютере, прежде чем приступать к настройке параметров брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-138">Administrators should consider all applications that are running on the computer before adjusting the firewall settings.</span></span>  
  
##  <a name="programs-to-configure-the-firewall"></a><a name="BKMK_programs"></a> <span data-ttu-id="6a6b1-139">Программы для настройки брандмауэра</span><span class="sxs-lookup"><span data-stu-id="6a6b1-139">Programs to Configure the Firewall</span></span>  
 <span data-ttu-id="6a6b1-140">Существует три способа настройки параметров брандмауэра Windows.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-140">There are three ways to configure the Windows Firewall settings.</span></span>  
  
-   <span data-ttu-id="6a6b1-141">**Элемент «Брандмауэр Windows» на панели управления**</span><span class="sxs-lookup"><span data-stu-id="6a6b1-141">**Windows Firewall item in Control Panel**</span></span>  
  
     <span data-ttu-id="6a6b1-142">Элемент **Брандмауэр Windows** можно открыть с панели управления.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-142">The **Windows Firewall** item can be opened from Control Panel.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6a6b1-143">Изменения, произведенные в элементе **Брандмауэр Windows** на панели управления, применяются только к текущему профилю.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-143">Changes made in the **Windows Firewall** item in Control Panel only affect the current profile.</span></span> <span data-ttu-id="6a6b1-144">На переносных компьютерах и других мобильных устройствах пользоваться элементом **Брандмауэр Windows** на панели управления нельзя, так как профиль может измениться при установлении соединения в другой конфигурации,</span><span class="sxs-lookup"><span data-stu-id="6a6b1-144">Mobile devices, for example a laptop, should not use the **Windows Firewall** item in Control Panel as the profile might change when it is connected in a different configuration.</span></span> <span data-ttu-id="6a6b1-145">в результате чего ранее настроенный профиль станет недоступен.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-145">Then the previously-configured profile will not be in effect.</span></span> <span data-ttu-id="6a6b1-146">Дополнительные сведения о профилях см. в разделе [Руководство по началу работы с брандмауэром Windows в режиме повышенной безопасности](https://go.microsoft.com/fwlink/?LinkId=116080).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-146">For more information about profiles, see [Windows Firewall with Advanced Security Getting Started Guide](https://go.microsoft.com/fwlink/?LinkId=116080).</span></span>  
  
     <span data-ttu-id="6a6b1-147">Элемент **Брандмауэр Windows** на панели управления позволяет настроить</span><span class="sxs-lookup"><span data-stu-id="6a6b1-147">The **Windows Firewall** item in Control Panel allows you to configure basic options.</span></span> <span data-ttu-id="6a6b1-148">следующие основные параметры.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-148">These include the following:</span></span>  
  
    -   <span data-ttu-id="6a6b1-149">Включение и отключение элемента **Брандмауэр Windows** на панели управления.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-149">Turning the **Windows Firewall** item in Control Panel on or off</span></span>  
  
    -   <span data-ttu-id="6a6b1-150">Включение и отключение правил.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-150">Enabling and disabling rules</span></span>  
  
    -   <span data-ttu-id="6a6b1-151">Предоставление исключений для портов и программ.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-151">Granting exceptions for ports and programs</span></span>  
  
    -   <span data-ttu-id="6a6b1-152">Задание некоторых ограничений области действия.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-152">Setting some scope restrictions</span></span>  
  
     <span data-ttu-id="6a6b1-153">Элемент **Брандмауэр Windows** на панели управления лучше всего подходит пользователям, которые не имеют опыта в настройке конфигурации брандмауэра, если необходимо настроить основные параметры брандмауэра для стационарного компьютера.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-153">The **Windows Firewall** item in Control Panel is most appropriate for users who are not experienced in firewall configuration, and who are configuring basic firewall options for computers that are not mobile.</span></span> <span data-ttu-id="6a6b1-154">Также можно открыть элемент **Брандмауэр Windows** на панели управления из `run` команды с помощью следующей процедуры:</span><span class="sxs-lookup"><span data-stu-id="6a6b1-154">You can also open the **Windows Firewall** item in Control Panel from the `run` command by using the following procedure:</span></span>  
  
    #### <a name="to-open-the-windows-firewall-item"></a><span data-ttu-id="6a6b1-155">Открытие элемента «Брандмауэр Windows»</span><span class="sxs-lookup"><span data-stu-id="6a6b1-155">To open the Windows Firewall item</span></span>  
  
    1.  <span data-ttu-id="6a6b1-156">В меню **Пуск** выберите команду **Выполнить**и введите команду `firewall.cpl`.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-156">On the **Start** menu, click **Run**, and then enter `firewall.cpl`.</span></span>  
  
    2.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
-   <span data-ttu-id="6a6b1-157">**Консоль управления (MMC)**</span><span class="sxs-lookup"><span data-stu-id="6a6b1-157">**Microsoft Management Console (MMC)**</span></span>  
  
     <span data-ttu-id="6a6b1-158">Оснастка «Брандмауэр Windows в режиме повышенной безопасности» позволяет настраивать дополнительные параметры брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-158">The Windows Firewall with Advanced Security MMC snap-in lets you configure more advanced firewall settings.</span></span> <span data-ttu-id="6a6b1-159">Эта оснастка представляет большинство параметров брандмауэра и в удобной форме, а также все профили брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-159">This snap-in presents most of the firewall options in an easy-to-use manner, and presents all firewall profiles.</span></span> <span data-ttu-id="6a6b1-160">Дополнительные сведения см. в подразделе [Использование оснастки "Брандмауэр Windows в режиме повышенной безопасности"](#BKMK_WF_msc) далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-160">For more information, see [Using the Windows Firewall with Advanced Security Snap-in](#BKMK_WF_msc) later in this topic.</span></span>  
  
-   <span data-ttu-id="6a6b1-161">**netsh**</span><span class="sxs-lookup"><span data-stu-id="6a6b1-161">**netsh**</span></span>  
  
     <span data-ttu-id="6a6b1-162">Средство **netsh.exe** позволяет администратору настраивать компьютеры с ОС Windows и наблюдать за ними из командной строки или с помощью пакетного файла **.**</span><span class="sxs-lookup"><span data-stu-id="6a6b1-162">The **netsh.exe** tool can be used by an administrator to configure and monitor Windows-based computers at a command prompt or using a batch file **.**</span></span> <span data-ttu-id="6a6b1-163">При использовании средства **netsh** вводимые команды направляются соответствующим помощникам, которые выполняют их.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-163">By using the **netsh** tool, you can direct the context commands you enter to the appropriate helper, and the helper then performs the command.</span></span> <span data-ttu-id="6a6b1-164">Помощник представляет собой файл библиотеки DLL, которая расширяет функциональность средства **netsh** , предоставляя возможности настройки, мониторинга и поддержки других служб, служебных программ или протоколов.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-164">A helper is a Dynamic Link Library (.dll) file that extends the functionality of the **netsh** tool by providing configuration, monitoring, and support for one or more services, utilities, or protocols.</span></span> <span data-ttu-id="6a6b1-165">Все операционные системы, поддерживающие [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , имеют модуль поддержки брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-165">All operating systems that support [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] have a firewall helper.</span></span> [!INCLUDE[firstref_longhorn](../../includes/firstref-longhorn-md.md)] <span data-ttu-id="6a6b1-166">также содержит расширенный помощник брандмауэра **advfirewall**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-166">also has an advanced firewall helper called **advfirewall**.</span></span> <span data-ttu-id="6a6b1-167">В этом разделе не приведены сведения об использовании **netsh** .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-167">The details of using **netsh** are not discussed in this topic.</span></span> <span data-ttu-id="6a6b1-168">Однако многие из описанных параметров конфигурации можно настроить с помощью средства **netsh**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-168">However, many of the configuration options described can be configured by using **netsh**.</span></span> <span data-ttu-id="6a6b1-169">Например, выполните в командной строке следующий скрипт, чтобы открыть TCP-порт 1433:</span><span class="sxs-lookup"><span data-stu-id="6a6b1-169">For example, run the following script at a command prompt to open TCP port 1433:</span></span>  
  
    ```  
    netsh firewall set portopening protocol = TCP port = 1433 name = SQLPort mode = ENABLE scope = SUBNET profile = CURRENT  
    ```  
  
     <span data-ttu-id="6a6b1-170">Аналогичный пример, использующий брандмауэр Windows для модуля поддержки повышенной безопасности:</span><span class="sxs-lookup"><span data-stu-id="6a6b1-170">A similar example using the Windows Firewall for Advanced Security helper:</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name = SQLPort dir = in protocol = tcp action = allow localport = 1433 remoteip = localsubnet profile = DOMAIN  
    ```  
  
     <span data-ttu-id="6a6b1-171">Дополнительные сведения о средстве **netsh**см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="6a6b1-171">For more information about **netsh**, see the following links:</span></span>  
  
    -   [<span data-ttu-id="6a6b1-172">Использование средства Netsh.exe и параметров командной строки</span><span class="sxs-lookup"><span data-stu-id="6a6b1-172">How to Use the Netsh.exe Tool and Command-Line Switches</span></span>](https://support.microsoft.com/kb/242468)  
  
    -   [<span data-ttu-id="6a6b1-173">Использование контекста netsh advfirewall firewall вместо контекста netsh firewall для управления работой брандмауэра Windows в операционной системе Windows Server 2008 или Windows Vista</span><span class="sxs-lookup"><span data-stu-id="6a6b1-173">How to use the "netsh advfirewall firewall" context instead of the "netsh firewall" context to control Windows Firewall behavior in Windows Server 2008 and in Windows Vista</span></span>](https://support.microsoft.com/kb/947709)  
  
    -   [<span data-ttu-id="6a6b1-174">Команда «netsh firewall» с параметром «profile=all» не настраивает открытый профиль на компьютере под управлением Windows Vista</span><span class="sxs-lookup"><span data-stu-id="6a6b1-174">The "netsh firewall" command together with the "profile=all" parameter does not configure the public profile on a Windows Vista-based computer</span></span>](https://support.microsoft.com/kb/947213)  
  
## <a name="ports-used-by-ssnoversion"></a><span data-ttu-id="6a6b1-175">Порты, используемые [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="6a6b1-175">Ports Used By [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>  
 <span data-ttu-id="6a6b1-176">Следующие таблицы помогут выяснить, какие порты использует [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a6b1-176">The following tables can help you identify the ports being used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
###  <a name="ports-used-by-the-database-engine"></a><a name="BKMK_ssde"></a> <span data-ttu-id="6a6b1-177">Ports Used By the Database Engine</span><span class="sxs-lookup"><span data-stu-id="6a6b1-177">Ports Used By the Database Engine</span></span>  
 <span data-ttu-id="6a6b1-178">В следующей таблице перечислены порты, обычно используемые компонентом [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a6b1-178">The following table lists the ports that are frequently used by the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span>  
  
|<span data-ttu-id="6a6b1-179">Сценарий</span><span class="sxs-lookup"><span data-stu-id="6a6b1-179">Scenario</span></span>|<span data-ttu-id="6a6b1-180">Порт</span><span class="sxs-lookup"><span data-stu-id="6a6b1-180">Port</span></span>|<span data-ttu-id="6a6b1-181">Комментарии</span><span class="sxs-lookup"><span data-stu-id="6a6b1-181">Comments</span></span>|  
|--------------|----------|--------------|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-182">по умолчанию, работающий по протоколу TCP</span><span class="sxs-lookup"><span data-stu-id="6a6b1-182">default instance running over TCP</span></span>|<span data-ttu-id="6a6b1-183">TCP-порт 1433</span><span class="sxs-lookup"><span data-stu-id="6a6b1-183">TCP port 1433</span></span>|<span data-ttu-id="6a6b1-184">Этот порт открывают в брандмауэре чаще всего.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-184">This is the most common port allowed through the firewall.</span></span> <span data-ttu-id="6a6b1-185">Он применяется для программных соединений с экземпляром компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)]по умолчанию или именованным экземпляром, который является единственным на данном компьютере</span><span class="sxs-lookup"><span data-stu-id="6a6b1-185">It applies to routine connections to the default installation of the [!INCLUDE[ssDE](../../includes/ssde-md.md)], or a named instance that is the only instance running on the computer.</span></span> <span data-ttu-id="6a6b1-186">(для именованных экземпляров следует учитывать ряд особых требований,</span><span class="sxs-lookup"><span data-stu-id="6a6b1-186">(Named instances have special considerations.</span></span> <span data-ttu-id="6a6b1-187">См. раздел [динамические порты](#BKMK_dynamic_ports) далее в этом разделе.)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-187">See [Dynamic Ports](#BKMK_dynamic_ports) later in this topic.)</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-188">в конфигурации по умолчанию</span><span class="sxs-lookup"><span data-stu-id="6a6b1-188">named instances in the default configuration</span></span>|<span data-ttu-id="6a6b1-189">TCP-порт выделяется динамически в момент запуска компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-189">The TCP port is a dynamic port determined at the time the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts.</span></span>|<span data-ttu-id="6a6b1-190">См. подраздел [Динамические порты](#BKMK_dynamic_ports)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-190">See the discussion below in the section [Dynamic Ports](#BKMK_dynamic_ports).</span></span> <span data-ttu-id="6a6b1-191">При использовании именованных экземпляров службе браузера [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может потребоваться UDP-порт 1434.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-191">UDP port 1434 might be required for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser Service when you are using named instances.</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-192">, если они настроены для использования фиксированного порта</span><span class="sxs-lookup"><span data-stu-id="6a6b1-192">named instances when they are configured to use a fixed port</span></span>|<span data-ttu-id="6a6b1-193">Номер порта настраивается администратором.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-193">The port number configured by the administrator.</span></span>|<span data-ttu-id="6a6b1-194">См. подраздел [Динамические порты](#BKMK_dynamic_ports)далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-194">See the discussion below in the section [Dynamic Ports](#BKMK_dynamic_ports).</span></span>|  
|<span data-ttu-id="6a6b1-195">Выделенное административное соединение</span><span class="sxs-lookup"><span data-stu-id="6a6b1-195">Dedicated Admin Connection</span></span>|<span data-ttu-id="6a6b1-196">TCP-порт 1434 предназначен для экземпляра по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-196">TCP port 1434 for the default instance.</span></span> <span data-ttu-id="6a6b1-197">Другие порты используются для именованных экземпляров.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-197">Other ports are used for named instances.</span></span> <span data-ttu-id="6a6b1-198">Номер порта проверьте по журналу ошибок.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-198">Check the error log for the port number.</span></span>|<span data-ttu-id="6a6b1-199">По умолчанию удаленные соединения по выделенному административному соединению (DAC) запрещены.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-199">By default, remote connections to the Dedicated Administrator Connection (DAC) are not enabled.</span></span> <span data-ttu-id="6a6b1-200">Разрешить удаленное выделенное административное соединение можно при помощи средства настройки контактной зоны.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-200">To enable remote DAC, use the Surface Area Configuration facet.</span></span> <span data-ttu-id="6a6b1-201">Дополнительные сведения см. в разделе [Surface Area Configuration](../../relational-databases/security/surface-area-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-201">For more information, see [Surface Area Configuration](../../relational-databases/security/surface-area-configuration.md).</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-202">Служба браузера</span><span class="sxs-lookup"><span data-stu-id="6a6b1-202">Browser service</span></span>|<span data-ttu-id="6a6b1-203">UDP-порт 1434</span><span class="sxs-lookup"><span data-stu-id="6a6b1-203">UDP port 1434</span></span>|<span data-ttu-id="6a6b1-204">Служба « [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , браузер» прослушивает входящие соединения к именованному экземпляру и возвращает клиенту номер TCP-порта, соответствующего именованному экземпляру.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-204">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service listens for incoming connections to a named instance and provides the client the TCP port number that corresponds to that named instance.</span></span> <span data-ttu-id="6a6b1-205">Обычно служба « [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , браузер» запускается при использовании именованного экземпляра компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-205">Normally the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service is started whenever named instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] are used.</span></span> <span data-ttu-id="6a6b1-206">Если клиент настроен для соединения с именованным экземпляром по заданному порту, то службу « [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , браузер» запускать не обязательно.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-206">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service does not have to be started if the client is configured to connect to the specific port of the named instance.</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-207">, работающий через конечную точку HTTP</span><span class="sxs-lookup"><span data-stu-id="6a6b1-207">instance running over an HTTP endpoint.</span></span>|<span data-ttu-id="6a6b1-208">Может указываться во время создания конечной точки HTTP.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-208">Can be specified when an HTTP endpoint is created.</span></span> <span data-ttu-id="6a6b1-209">По умолчанию используется TCP-порт 80 для данных CLEAR_PORT и порт 443 для данных SSL_PORT.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-209">The default is TCP port 80 for CLEAR_PORT traffic and 443 for SSL_PORT traffic.</span></span>|<span data-ttu-id="6a6b1-210">Используется для HTTP-соединения по URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-210">Used for an HTTP connection through a URL.</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-211">по умолчанию, работающий через конечную точку HTTPS</span><span class="sxs-lookup"><span data-stu-id="6a6b1-211">default instance running over an HTTPS endpoint.</span></span>|<span data-ttu-id="6a6b1-212">TCP-порт 443</span><span class="sxs-lookup"><span data-stu-id="6a6b1-212">TCP port 443</span></span>|<span data-ttu-id="6a6b1-213">Используется для HTTPS-соединения по URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-213">Used for an HTTPS connection through a URL.</span></span> <span data-ttu-id="6a6b1-214">HTTPS представляет собой HTTP-соединение, защищенное по протоколу SSL.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-214">HTTPS is an HTTP connection that uses secure sockets layer (SSL).</span></span>|  
|[!INCLUDE[ssSB](../../includes/sssb-md.md)]|<span data-ttu-id="6a6b1-215">TCP-порт 4022.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-215">TCP port 4022.</span></span> <span data-ttu-id="6a6b1-216">Чтобы проверить используемый порт, выполните следующий запрос:</span><span class="sxs-lookup"><span data-stu-id="6a6b1-216">To verify the port used, execute the following query:</span></span><br /><br /> `SELECT name, protocol_desc, port, state_desc`<br /><br /> `FROM sys.tcp_endpoints`<br /><br /> `WHERE type_desc = 'SERVICE_BROKER'`|<span data-ttu-id="6a6b1-217">Для компонента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssSB](../../includes/sssb-md.md)]нет порта по умолчанию, но эта конфигурация принята в электронной документации для использования в примерах.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-217">There is no default port for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssSB](../../includes/sssb-md.md)], but this is the conventional configuration used in Books Online examples.</span></span>|  
|<span data-ttu-id="6a6b1-218">Зеркальное отображение базы данных</span><span class="sxs-lookup"><span data-stu-id="6a6b1-218">Database Mirroring</span></span>|<span data-ttu-id="6a6b1-219">Порт, выбранный администратором.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-219">Administrator chosen port.</span></span> <span data-ttu-id="6a6b1-220">Чтобы определить порт, выполните следующий запрос.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-220">To determine the port, execute the following query:</span></span><br /><br /> `SELECT name, protocol_desc, port, state_desc FROM sys.tcp_endpoints`<br /><br /> `WHERE type_desc = 'DATABASE_MIRRORING'`|<span data-ttu-id="6a6b1-221">Для зеркального отображения базы данных нет порта по умолчанию, однако в примерах электронной документации используется TCP-порт 7022.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-221">There is no default port for database mirroring however Books Online examples use TCP port 7022.</span></span> <span data-ttu-id="6a6b1-222">Очень важно избегать прерывания используемой конечной точки зеркального отображения, особенно в режиме высокой безопасности с автоматической отработкой отказа.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-222">It is very important to avoid interrupting an in-use mirroring endpoint, especially in high-safety mode with automatic failover.</span></span> <span data-ttu-id="6a6b1-223">Конфигурация брандмауэра должна избегать прерывания кворума.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-223">Your firewall configuration must avoid breaking quorum.</span></span> <span data-ttu-id="6a6b1-224">Дополнительные сведения см. в разделе [Указание сетевого адреса сервера (зеркальное отображение базы данных)](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-224">For more information, see [Specify a Server Network Address &#40;Database Mirroring&#41;](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md).</span></span>|  
|<span data-ttu-id="6a6b1-225">Репликация</span><span class="sxs-lookup"><span data-stu-id="6a6b1-225">Replication</span></span>|<span data-ttu-id="6a6b1-226">Соединения с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для репликации используют порты, которые обычно использует компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] (TCP-порт 1433 для экземпляра по умолчанию и т. д.)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-226">Replication connections to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] use the typical regular [!INCLUDE[ssDE](../../includes/ssde-md.md)] ports (TCP port 1433 for the default instance, etc.)</span></span><br /><br /> <span data-ttu-id="6a6b1-227">Веб-синхронизация и доступ через FTP/UNC к моментальному снимку репликации потребуют открытия в брандмауэре других портов.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-227">Web synchronization and FTP/UNC access for replication snapshot require additional ports to be opened on the firewall.</span></span> <span data-ttu-id="6a6b1-228">Передачу начальных данных и схемы из одного места в другое репликация осуществляет по протоколу FTP (TCP-порт 21) либо с помощью синхронизации через HTTP (TCP-порт 80) или общего доступа к файлам.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-228">To transfer initial data and schema from one location to another, replication can use FTP (TCP port 21), or sync over HTTP (TCP port 80) or File Sharing.</span></span> <span data-ttu-id="6a6b1-229">Для общего доступа к файлам используются UDP-порты 137 и 138 и TCP-порт 139 (если используется NetBIOS).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-229">File sharing uses UDP port 137 and 138, and TCP port 139 if it using NetBIOS.</span></span> <span data-ttu-id="6a6b1-230">Совместное использование файлов использует TCP-порт 445.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-230">File Sharing uses TCP port 445.</span></span>|<span data-ttu-id="6a6b1-231">Для синхронизации по протоколу HTTP в репликации используется конечная точка IIS (порты которой являются настраиваемыми, но порт 80 применяется по умолчанию), однако процесс IIS подключается к серверу базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] через стандартные порты (1433 для экземпляра по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-231">For sync over HTTP, replication uses the IIS endpoint (ports for which are configurable but is port 80 by default), but the IIS process connects to the backend [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] through the standard ports (1433 for the default instance.</span></span><br /><br /> <span data-ttu-id="6a6b1-232">При веб-синхронизации через FTP-порт передача данных выполняется между службами IIS и издателем [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , а не между подписчиком и службами IIS.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-232">During Web synchronization using FTP, the FTP transfer is between IIS and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] publisher, not between subscriber and IIS.</span></span>|  
|[!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="6a6b1-233">отладчик</span><span class="sxs-lookup"><span data-stu-id="6a6b1-233">debugger</span></span>|<span data-ttu-id="6a6b1-234">TCP-порт 135</span><span class="sxs-lookup"><span data-stu-id="6a6b1-234">TCP port 135</span></span><br /><br /> <span data-ttu-id="6a6b1-235">См. раздел [Особые замечания относительно порта 135](#BKMK_port_135)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-235">See [Special Considerations for Port 135](#BKMK_port_135)</span></span><br /><br /> <span data-ttu-id="6a6b1-236">Также может потребоваться исключение [IPsec](#BKMK_additional_ports) .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-236">The [IPsec](#BKMK_additional_ports) exception might also be required.</span></span>|<span data-ttu-id="6a6b1-237">При использовании среды [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]на [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] главном компьютере в список исключений необходимо также добавить программу **Devenv.exe** и открыть TCP-порт 135.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-237">If using [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], on the [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] host computer, you must also add **Devenv.exe** to the Exceptions list and open TCP port 135.</span></span><br /><br /> <span data-ttu-id="6a6b1-238">При использовании среды [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]на [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] главном компьютере необходимо также добавить в список исключений программу **ssms.exe** и открыть TCP-порт 135.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-238">If using [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], on the [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] host computer, you must also add **ssms.exe** to the Exceptions list and open TCP port 135.</span></span> <span data-ttu-id="6a6b1-239">Дополнительные сведения см. [в разделе Настройка отладчика Transact-SQL](../../relational-databases/scripting/configure-firewall-rules-before-running-the-tsql-debugger.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-239">For more information, see [Configure the Transact-SQL Debugger](../../relational-databases/scripting/configure-firewall-rules-before-running-the-tsql-debugger.md).</span></span>|  
  
 <span data-ttu-id="6a6b1-240">Пошаговые инструкции по настройке брандмауэра Windows для компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)]см. в разделе [Настройка брандмауэра Windows для доступа к компоненту Database Engine](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-240">For step by step instructions to configure the Windows Firewall for the [!INCLUDE[ssDE](../../includes/ssde-md.md)], see [Configure a Windows Firewall for Database Engine Access](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md).</span></span>  
  
####  <a name="dynamic-ports"></a><a name="BKMK_dynamic_ports"></a> <span data-ttu-id="6a6b1-241">Динамические порты</span><span class="sxs-lookup"><span data-stu-id="6a6b1-241">Dynamic Ports</span></span>  
 <span data-ttu-id="6a6b1-242">По умолчанию именованные экземпляры (включая [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)]) используют динамические порты.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-242">By default, named instances (including [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)]) use dynamic ports.</span></span> <span data-ttu-id="6a6b1-243">Это означает, что при каждом запуске компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] находит доступный порт и занимает его.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-243">That means that every time that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts, it identifies an available port and uses that port number.</span></span> <span data-ttu-id="6a6b1-244">Если именованный экземпляр является единственным установленным экземпляром компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] , то, скорее всего, он будет использовать TCP-порт 1433.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-244">If the named instance is the only instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] installed, it will probably use TCP port 1433.</span></span> <span data-ttu-id="6a6b1-245">При установке других экземпляров компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] они будут использовать другие TCP-порты.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-245">If other instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] are installed, it will probably use a different TCP port.</span></span> <span data-ttu-id="6a6b1-246">Поскольку выбираемый порт может меняться при каждом запуске компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] , настроить брандмауэр для разрешения доступа к нужному порту сложно.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-246">Because the port selected might change every time that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is started, it is difficult to configure the firewall to enable access to the correct port number.</span></span> <span data-ttu-id="6a6b1-247">Поэтому, если используется брандмауэр, рекомендуется настроить компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] на постоянное использование одного и того же порта.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-247">Therefore, if a firewall is used, we recommend reconfiguring the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to use the same port number every time.</span></span> <span data-ttu-id="6a6b1-248">Такой порт называется фиксированным или статическим.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-248">This is called a fixed port or a static port.</span></span> <span data-ttu-id="6a6b1-249">Дополнительные сведения см. в разделе [Настройка сервера для прослушивания указанного TCP-порта (диспетчер конфигурации SQL Server)](../../database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-249">For more information, see [Configure a Server to Listen on a Specific TCP Port &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port.md).</span></span>  
  
 <span data-ttu-id="6a6b1-250">В качестве альтернативы настройке именованного экземпляра для прослушивания фиксированного порта можно создать в брандмауэре исключение для программы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], например **sqlservr.exe** (для компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-250">An alternative to configuring a named instance to listen on a fixed port is to create an exception in the firewall for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] program such as **sqlservr.exe** (for the [!INCLUDE[ssDE](../../includes/ssde-md.md)]).</span></span> <span data-ttu-id="6a6b1-251">Это хороший выход из положения, однако номер порта не будет отображаться в столбце **Локальный порт** на странице **Правила для входящих подключений** оснастки "Брандмауэр Windows в режиме повышенной безопасности".</span><span class="sxs-lookup"><span data-stu-id="6a6b1-251">This can be convenient, but the port number will not appear in the **Local Port** column of the **Inbound Rules** page when you are using the Windows Firewall with Advanced Security MMC snap-in.</span></span> <span data-ttu-id="6a6b1-252">В результате аудит открытых портов станет сложнее.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-252">This can make it more difficult to audit which ports are open.</span></span> <span data-ttu-id="6a6b1-253">Еще один нюанс заключается в том, что при применении совокупного обновления или пакета обновления может измениться путь к исполняемому файлу [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , что сделает правило брандмауэра недействительным.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-253">Another consideration is that a service pack or cumulative update can change the path to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] executable which will invalidate the firewall rule.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6a6b1-254">Следующая процедура выполняется с помощью элемента **Брандмауэр Windows** на панели управления.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-254">The following procedure uses the **Windows Firewall** item in Control Panel.</span></span> <span data-ttu-id="6a6b1-255">В оснастке MMC «Брандмауэр Windows в режиме повышенной безопасности» поддерживается настройка дополнительных параметров брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-255">The Windows Firewall with Advanced Security MMC snap-in can configure a more complex rule.</span></span> <span data-ttu-id="6a6b1-256">В их число входит настройка исключение службы, которая может оказаться полезной при обеспечении углубленной защиты.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-256">This includes configuring a service exception which can be useful for providing defense in depth.</span></span> <span data-ttu-id="6a6b1-257">См. подраздел [Использование оснастки "Брандмауэр Windows в режиме повышенной безопасности"](#BKMK_WF_msc) ниже.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-257">See [Using the Windows Firewall with Advanced Security Snap-in](#BKMK_WF_msc) below.</span></span>  
  
###### <a name="to-add-a-program-exception-to-the-firewall-using-the-windows-firewall-item-in-control-panel"></a><span data-ttu-id="6a6b1-258">Добавление в брандмауэр исключения для программы при помощи элемента «Брандмауэр Windows» на панели управления</span><span class="sxs-lookup"><span data-stu-id="6a6b1-258">To add a program exception to the firewall using the Windows Firewall item in Control Panel.</span></span>  
  
1.  <span data-ttu-id="6a6b1-259">На вкладке **Исключения** элемента **Брандмауэр Windows** на панели управления нажмите кнопку **Добавить программу**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-259">On the **Exceptions** tab of the **Windows Firewall** item in Control Panel, click **Add a program**.</span></span>  
  
2.  <span data-ttu-id="6a6b1-260">Перейдите в расположение экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , который вы хотите разрешить через брандмауэр, например **C:\PROGRAM Files\Microsoft SQL Server\MSSQL12. <instance_name> \MSSQL\Binn**, выберите **sqlservr.exe**и нажмите кнопку **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-260">Browse to the location of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that you want to allow through the firewall, for example **C:\Program Files\Microsoft SQL Server\MSSQL12.<instance_name>\MSSQL\Binn**, select **sqlservr.exe**, and then click **Open**.</span></span>  
  
3.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
 <span data-ttu-id="6a6b1-261">Дополнительные сведения о конечных точках см. в разделах [Настройка ядра СУБД на прослушивание нескольких портов TCP](../../database-engine/configure-windows/configure-the-database-engine-to-listen-on-multiple-tcp-ports.md) и [Представления каталога конечных точек (Transact-SQL)](/sql/relational-databases/system-catalog-views/endpoints-catalog-views-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-261">For more information about endpoints, see [Configure the Database Engine to Listen on Multiple TCP Ports](../../database-engine/configure-windows/configure-the-database-engine-to-listen-on-multiple-tcp-ports.md) and [Endpoints Catalog Views &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/endpoints-catalog-views-transact-sql).</span></span>  
  
###  <a name="ports-used-by-analysis-services"></a><a name="BKMK_ssas"></a> <span data-ttu-id="6a6b1-262">Порты, используемые службами Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6a6b1-262">Ports Used By Analysis Services</span></span>  
 <span data-ttu-id="6a6b1-263">В следующей таблице перечислены порты, обычно используемые службами [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a6b1-263">The following table lists the ports that are frequently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
|<span data-ttu-id="6a6b1-264">Компонент</span><span class="sxs-lookup"><span data-stu-id="6a6b1-264">Feature</span></span>|<span data-ttu-id="6a6b1-265">Порт</span><span class="sxs-lookup"><span data-stu-id="6a6b1-265">Port</span></span>|<span data-ttu-id="6a6b1-266">Комментарии</span><span class="sxs-lookup"><span data-stu-id="6a6b1-266">Comments</span></span>|  
|-------------|----------|--------------|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]|<span data-ttu-id="6a6b1-267">TCP-порт 2383 для экземпляра по умолчанию</span><span class="sxs-lookup"><span data-stu-id="6a6b1-267">TCP port 2383 for the default instance</span></span>|<span data-ttu-id="6a6b1-268">Стандартный порт для экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-268">The standard port for the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-269">Служба браузера</span><span class="sxs-lookup"><span data-stu-id="6a6b1-269">Browser service</span></span>|<span data-ttu-id="6a6b1-270">Для именованного экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] необходим только TCP-порт 2382</span><span class="sxs-lookup"><span data-stu-id="6a6b1-270">TCP port 2382 only needed for an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instance</span></span>|<span data-ttu-id="6a6b1-271">Запросы клиентского соединения к именованному экземпляру служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , в которых не указан номер порта, направляются на порт 2382, который прослушивает служба « [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , браузер».</span><span class="sxs-lookup"><span data-stu-id="6a6b1-271">Client connection requests for a named instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] that do not specify a port number are directed to port 2382, the port on which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser listens.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-272">затем перенаправляет запрос на порт, используемый запрошенным именованным экземпляром.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-272">Browser then redirects the request to the port that the named instance uses.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="6a6b1-273">настроены для работы через протокол IIS/HTTP</span><span class="sxs-lookup"><span data-stu-id="6a6b1-273">configured for use through IIS/HTTP</span></span><br /><br /> <span data-ttu-id="6a6b1-274">(Сводная таблица??</span><span class="sxs-lookup"><span data-stu-id="6a6b1-274">(The PivotTable??</span></span> <span data-ttu-id="6a6b1-275">Служба использует HTTP или HTTPS)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-275">Service uses HTTP or HTTPS)</span></span>|<span data-ttu-id="6a6b1-276">TCP-порт 80</span><span class="sxs-lookup"><span data-stu-id="6a6b1-276">TCP port 80</span></span>|<span data-ttu-id="6a6b1-277">Используется для HTTP-соединения по URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-277">Used for an HTTP connection through a URL.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="6a6b1-278">настроены для работы через протокол IIS/HTTPS</span><span class="sxs-lookup"><span data-stu-id="6a6b1-278">configured for use through IIS/HTTPS</span></span><br /><br /> <span data-ttu-id="6a6b1-279">(Сводная таблица??</span><span class="sxs-lookup"><span data-stu-id="6a6b1-279">(The PivotTable??</span></span> <span data-ttu-id="6a6b1-280">Служба использует HTTP или HTTPS)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-280">Service uses HTTP or HTTPS)</span></span>|<span data-ttu-id="6a6b1-281">TCP-порт 443</span><span class="sxs-lookup"><span data-stu-id="6a6b1-281">TCP port 443</span></span>|<span data-ttu-id="6a6b1-282">Используется для HTTPS-соединения по URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-282">Used for an HTTPS connection through a URL.</span></span> <span data-ttu-id="6a6b1-283">HTTPS представляет собой HTTP-соединение, защищенное по протоколу SSL.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-283">HTTPS is an HTTP connection that uses secure sockets layer (SSL).</span></span>|  
  
 <span data-ttu-id="6a6b1-284">Если пользователи производят доступ к службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] через Интернет и службы IIS, необходимо открыть порт, который прослушивают службы IIS, и указать этот порт в строке соединения клиента.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-284">If users access [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] through IIS and the Internet, you must open the port on which IIS is listening and specify that port in the client connection string.</span></span> <span data-ttu-id="6a6b1-285">В этом случае необязательно иметь открытые порты для прямого доступа к службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a6b1-285">In this case, no ports have to be open for direct access to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="6a6b1-286">Необходимо ограничить доступ к порту по умолчанию 2389, порту 2382 и другим портам, которые не нужны для осуществления доступа.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-286">The default port 2389, and port 2382, should be restricted together with all other ports that are not required.</span></span>  
  
 <span data-ttu-id="6a6b1-287">Пошаговые инструкции по настройке брандмауэра Windows для компонента [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]см. в разделе [Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services](../../../2014/analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-287">For step by step instructions to configure the Windows Firewall for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [Configure the Windows Firewall to Allow Analysis Services Access](../../../2014/analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
###  <a name="ports-used-by-reporting-services"></a><a name="BKMK_ssrs"></a> <span data-ttu-id="6a6b1-288">Порты, используемые службами Reporting Services</span><span class="sxs-lookup"><span data-stu-id="6a6b1-288">Ports Used By Reporting Services</span></span>  
 <span data-ttu-id="6a6b1-289">В следующей таблице перечислены порты, обычно используемые службами [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6a6b1-289">The following table lists the ports that are frequently used by [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span>  
  
|<span data-ttu-id="6a6b1-290">Компонент</span><span class="sxs-lookup"><span data-stu-id="6a6b1-290">Feature</span></span>|<span data-ttu-id="6a6b1-291">Порт</span><span class="sxs-lookup"><span data-stu-id="6a6b1-291">Port</span></span>|<span data-ttu-id="6a6b1-292">Комментарии</span><span class="sxs-lookup"><span data-stu-id="6a6b1-292">Comments</span></span>|  
|-------------|----------|--------------|  
|[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="6a6b1-293">Веб-службы</span><span class="sxs-lookup"><span data-stu-id="6a6b1-293">Web Services</span></span>|<span data-ttu-id="6a6b1-294">TCP-порт 80</span><span class="sxs-lookup"><span data-stu-id="6a6b1-294">TCP port 80</span></span>|<span data-ttu-id="6a6b1-295">Используется для HTTP-соединения со службами [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] по URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-295">Used for an HTTP connection to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] through a URL.</span></span> <span data-ttu-id="6a6b1-296">Не рекомендуется использовать стандартное правило **Службы Интернета (HTTP)** .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-296">We recommend that you do not use the preconfigured rule **World Wide Web Services (HTTP)**.</span></span> <span data-ttu-id="6a6b1-297">Дополнительные сведения см. в разделе [Взаимодействие с другими правилами брандмауэра](#BKMK_other_rules) ниже.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-297">For more information, see the [Interaction with Other Firewall Rules](#BKMK_other_rules) section below.</span></span>|  
|[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="6a6b1-298">настроены для работы через протокол HTTPS</span><span class="sxs-lookup"><span data-stu-id="6a6b1-298">configured for use through HTTPS</span></span>|<span data-ttu-id="6a6b1-299">TCP-порт 443</span><span class="sxs-lookup"><span data-stu-id="6a6b1-299">TCP port 443</span></span>|<span data-ttu-id="6a6b1-300">Используется для HTTPS-соединения по URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-300">Used for an HTTPS connection through a URL.</span></span> <span data-ttu-id="6a6b1-301">HTTPS представляет собой HTTP-соединение, защищенное по протоколу SSL.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-301">HTTPS is an HTTP connection that uses secure sockets layer (SSL).</span></span> <span data-ttu-id="6a6b1-302">Не рекомендуется использовать стандартное правило **Защищенные службы Интернета (HTTPS)** .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-302">We recommend that you do not use the preconfigured rule **Secure World Wide Web Services (HTTPS)**.</span></span> <span data-ttu-id="6a6b1-303">Дополнительные сведения см. в разделе [Взаимодействие с другими правилами брандмауэра](#BKMK_other_rules) ниже.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-303">For more information, see the [Interaction with Other Firewall Rules](#BKMK_other_rules) section below.</span></span>|  
  
 <span data-ttu-id="6a6b1-304">Для соединения служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] с экземпляром компонента [!INCLUDE[ssDE](../../includes/ssde-md.md)] или служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]необходимо также открыть соответствующие порты для этих служб.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-304">When [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] connects to an instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] or [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], you must also open the appropriate ports for those services.</span></span> <span data-ttu-id="6a6b1-305">Пошаговые инструкции по настройке брандмауэра Windows для компонента [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]см. в разделе [Настройка брандмауэра для доступа к серверу отчетов](../../reporting-services/report-server/configure-a-firewall-for-report-server-access.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-305">For step-by-step instructions to configure the Windows Firewall for [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], [Configure a Firewall for Report Server Access](../../reporting-services/report-server/configure-a-firewall-for-report-server-access.md).</span></span>  
  
###  <a name="ports-used-by-integration-services"></a><a name="BKMK_ssis"></a> <span data-ttu-id="6a6b1-306">Порты, используемые службами Integration Services</span><span class="sxs-lookup"><span data-stu-id="6a6b1-306">Ports Used By Integration Services</span></span>  
 <span data-ttu-id="6a6b1-307">В следующей таблице перечислены порты, используемые службой [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-307">The following table lists the ports that are used by the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service.</span></span>  
  
|<span data-ttu-id="6a6b1-308">Компонент</span><span class="sxs-lookup"><span data-stu-id="6a6b1-308">Feature</span></span>|<span data-ttu-id="6a6b1-309">Порт</span><span class="sxs-lookup"><span data-stu-id="6a6b1-309">Port</span></span>|<span data-ttu-id="6a6b1-310">Комментарии</span><span class="sxs-lookup"><span data-stu-id="6a6b1-310">Comments</span></span>|  
|-------------|----------|--------------|  
|[!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="6a6b1-311">удаленные вызовы процедур (MS RPC)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-311">remote procedure calls (MS RPC)</span></span><br /><br /> <span data-ttu-id="6a6b1-312">Используется средой выполнения служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-312">Used by the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] runtime.</span></span>|<span data-ttu-id="6a6b1-313">TCP-порт 135</span><span class="sxs-lookup"><span data-stu-id="6a6b1-313">TCP port 135</span></span><br /><br /> <span data-ttu-id="6a6b1-314">См. раздел [Особые замечания относительно порта 135](#BKMK_port_135)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-314">See [Special Considerations for Port 135](#BKMK_port_135)</span></span>|<span data-ttu-id="6a6b1-315">Служба [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] обращается к DCOM по порту 135.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-315">The [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service uses DCOM on port 135.</span></span> <span data-ttu-id="6a6b1-316">Диспетчер управления службами использует порт 135 для запуска и остановки службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , передачи управляющих запросов запущенной службе и выполнения других задач.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-316">The Service Control Manager uses port 135 to perform tasks such as starting and stopping the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service and transmitting control requests to the running service.</span></span> <span data-ttu-id="6a6b1-317">Номер порта не может быть изменен.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-317">The port number cannot be changed.</span></span><br /><br /> <span data-ttu-id="6a6b1-318">Это единственный порт, который должен быть открыт при соединении с удаленным экземпляром службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] из среды [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] или прикладной программы.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-318">This port is only required to be open if you are connecting to a remote instance of the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service from [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] or a custom application.</span></span>|  
  
 <span data-ttu-id="6a6b1-319">Пошаговые инструкции по настройке брандмауэра Windows для компонента [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]см. в разделе [Настройка параметров брандмауэра Windows для доступа к службам SSIS](../../../2014/integration-services/configure-a-windows-firewall-for-access-to-the-ssis-service.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-319">For step-by-step instructions to configure the Windows Firewall for [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], see [Configure a Windows Firewall for Access to the SSIS Service](../../../2014/integration-services/configure-a-windows-firewall-for-access-to-the-ssis-service.md).</span></span>  
  
###  <a name="additional-ports-and-services"></a><a name="BKMK_additional_ports"></a> <span data-ttu-id="6a6b1-320">Другие порты и службы</span><span class="sxs-lookup"><span data-stu-id="6a6b1-320">Additional Ports and Services</span></span>  
 <span data-ttu-id="6a6b1-321">В следующей таблице перечислены порты и службы, от которых может зависеть [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-321">The following table lists ports and services that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might depend on.</span></span>  
  
|<span data-ttu-id="6a6b1-322">Сценарий</span><span class="sxs-lookup"><span data-stu-id="6a6b1-322">Scenario</span></span>|<span data-ttu-id="6a6b1-323">Порт</span><span class="sxs-lookup"><span data-stu-id="6a6b1-323">Port</span></span>|<span data-ttu-id="6a6b1-324">Комментарии</span><span class="sxs-lookup"><span data-stu-id="6a6b1-324">Comments</span></span>|  
|--------------|----------|--------------|  
|<span data-ttu-id="6a6b1-325">Инструментарий управления Windows (WMI)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-325">Windows Management Instrumentation</span></span><br /><br /> <span data-ttu-id="6a6b1-326">Дополнительные сведения о WMI см. в разделе [WMI Provider for Configuration Management Concepts](../../relational-databases/wmi-provider-configuration/wmi-provider-for-configuration-management.md)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-326">For more information about WMI, see [WMI Provider for Configuration Management Concepts](../../relational-databases/wmi-provider-configuration/wmi-provider-for-configuration-management.md)</span></span>|<span data-ttu-id="6a6b1-327">Инструментарий WMI запускается в составе общего узла службы с назначением портов через DCOM.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-327">WMI runs as part of a shared service host with ports assigned through DCOM.</span></span> <span data-ttu-id="6a6b1-328">Инструментарий WMI может пользовать TCP-порт 135.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-328">WMI might be using TCP port 135.</span></span><br /><br /> <span data-ttu-id="6a6b1-329">См. раздел [Особые замечания относительно порта 135](#BKMK_port_135)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-329">See [Special Considerations for Port 135](#BKMK_port_135)</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-330">использует инструментарий WMI для просмотра и управления службами.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-330">Configuration Manager uses WMI to list and manage services.</span></span> <span data-ttu-id="6a6b1-331">Рекомендуется использовать стандартную группу правил **Инструментарий управления Windows (WMI)** .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-331">We recommend that you use the preconfigured rule group **Windows Management Instrumentation (WMI)**.</span></span> <span data-ttu-id="6a6b1-332">Дополнительные сведения см. в разделе [Взаимодействие с другими правилами брандмауэра](#BKMK_other_rules) ниже.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-332">For more information, see the [Interaction with Other Firewall Rules](#BKMK_other_rules) section below.</span></span>|  
|[!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="6a6b1-333">Координатор распределенных транзакций (Майкрософт) (MS DTC)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-333">Distributed Transaction Coordinator (MS DTC)</span></span>|<span data-ttu-id="6a6b1-334">TCP-порт 135</span><span class="sxs-lookup"><span data-stu-id="6a6b1-334">TCP port 135</span></span><br /><br /> <span data-ttu-id="6a6b1-335">См. раздел [Особые замечания относительно порта 135](#BKMK_port_135)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-335">See [Special Considerations for Port 135](#BKMK_port_135)</span></span>|<span data-ttu-id="6a6b1-336">Если приложение использует распределенные транзакции, то может потребоваться настройка брандмауэра таким образом, чтобы разрешить передачу данных координатора распределенных транзакций ([!INCLUDE[msCoName](../../includes/msconame-md.md)]) (MS DTC) между отдельными экземплярами MS DTC и между MS DTC и диспетчерами ресурсов (например, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-336">If your application uses distributed transactions, you might have to configure the firewall to allow [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator (MS DTC) traffic to flow between separate MS DTC instances, and between the MS DTC and resource managers such as [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6a6b1-337">Рекомендуется использовать стандартную группу правил **Координатор распределенных транзакций** .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-337">We recommend that you use the preconfigured **Distributed Transaction Coordinator** rule group.</span></span><br /><br /> <span data-ttu-id="6a6b1-338">Если для всего кластера настроен единственный общий координатор MS DTC в отдельной группе ресурсов, следует добавить программу sqlservr.exe в список исключений брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-338">When a single shared MS DTC is configured for the entire cluster in a separate resource group you should add sqlservr.exe as an exception to the firewall.</span></span>|  
|<span data-ttu-id="6a6b1-339">Кнопка обзора в среде [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] соединяется со службой [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], браузер по протоколу UDP.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-339">The browse button in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] uses UDP to connect to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser Service.</span></span> <span data-ttu-id="6a6b1-340">Дополнительные сведения см. в разделе [Служба обозревателя SQL Server (ядро СУБД и SSAS)](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-340">For more information, see [SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md).</span></span>|<span data-ttu-id="6a6b1-341">UDP-порт 1434</span><span class="sxs-lookup"><span data-stu-id="6a6b1-341">UDP port 1434</span></span>|<span data-ttu-id="6a6b1-342">Протокол UDP не сохраняет соединения.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-342">UDP is a connectionless protocol.</span></span><br /><br /> <span data-ttu-id="6a6b1-343">Свойство [UnicastResponsesToMulticastBroadcastDisabled интерфейса INetFwProfile](https://go.microsoft.com/fwlink/?LinkId=118371) управляет работой брандмауэра по отношению к одноадресным ответам на широковещательные (или многоадресные) UDP-запросы.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-343">The firewall has a setting, which is named [UnicastResponsesToMulticastBroadcastDisabled Property of the INetFwProfile Interface](https://go.microsoft.com/fwlink/?LinkId=118371) which controls the behavior of the firewall with respect to unicast responses to a broadcast (or multicast) UDP request.</span></span>  <span data-ttu-id="6a6b1-344">Возможны два варианта.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-344">It has two behaviors:</span></span><br /><br /> <span data-ttu-id="6a6b1-345">Если этот параметр имеет значение TRUE, то одноадресные ответы на широковещательные запросы запрещены.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-345">If the setting is TRUE, no unicast responses to a broadcast are permitted at all.</span></span> <span data-ttu-id="6a6b1-346">Перечисление служб завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-346">Enumerating services will fail.</span></span><br /><br /> <span data-ttu-id="6a6b1-347">Если этот параметр имеет значение FALSE (по умолчанию), то одноадресные ответы разрешены в течение 3 секунд.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-347">If the setting is FALSE (default), unicast responses are permitted for 3 seconds.</span></span> <span data-ttu-id="6a6b1-348">Время ожидания не настраивается.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-348">The length of time is not configurable.</span></span> <span data-ttu-id="6a6b1-349">Если сеть переполнена, каналы имеют задержки или сервер работает в режиме высокой нагрузки, то при построении списка экземпляров [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] список может быть возвращен лишь частично и ввести пользователя в заблуждение.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-349">in a congested or high-latency network, or for heavily loaded servers, tries to enumerate instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might return a partial list, which might mislead users.</span></span>|  
|<span data-ttu-id="6a6b1-350">Трафик по протоколу IPsec</span><span class="sxs-lookup"><span data-stu-id="6a6b1-350">IPsec traffic</span></span>|<span data-ttu-id="6a6b1-351">UDP-порты 500 и 4500</span><span class="sxs-lookup"><span data-stu-id="6a6b1-351">UDP port 500 and UDP port 4500</span></span>|<span data-ttu-id="6a6b1-352">Если политика домена требует выполнения сетевых соединения через протокол IPsec, необходимо добавить в список исключений UDP-порты 4500 и 500.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-352">If the domain policy requires network communications to be done through IPsec, you must also add UDP port 4500 and UDP port 500 to the exception list.</span></span> <span data-ttu-id="6a6b1-353">Протокол IPsec можно включить с помощью **мастера создания правила для входящего подключения** в оснастке "Брандмауэр Windows".</span><span class="sxs-lookup"><span data-stu-id="6a6b1-353">IPsec is an option using the **New Inbound Rule Wizard** in the Windows Firewall snap-in.</span></span> <span data-ttu-id="6a6b1-354">Дополнительные сведения см. в разделе [Использование оснастки "Брандмауэр Windows в режиме повышенной безопасности"](#BKMK_WF_msc) ниже.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-354">For more information, see [Using the Windows Firewall with Advanced Security Snap-in](#BKMK_WF_msc) below.</span></span>|  
|<span data-ttu-id="6a6b1-355">Использование проверки подлинности Windows в надежных доменах</span><span class="sxs-lookup"><span data-stu-id="6a6b1-355">Using Windows Authentication with Trusted Domains</span></span>|<span data-ttu-id="6a6b1-356">Брандмауэр можно настроить для разрешения запросов проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-356">Firewalls must be configured to allow authentication requests.</span></span>|<span data-ttu-id="6a6b1-357">Дополнительные сведения см. в разделе [Настройка брандмауэра для работы с доменами и отношениями доверия](https://support.microsoft.com/kb/179442/).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-357">For more information, see [How to configure a firewall for domains and trusts](https://support.microsoft.com/kb/179442/).</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="6a6b1-358">и кластеризация Windows</span><span class="sxs-lookup"><span data-stu-id="6a6b1-358">and Windows Clustering</span></span>|<span data-ttu-id="6a6b1-359">Кластеризация требует открытия дополнительных портов, не связанных с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]напрямую.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-359">Clustering requires additional ports that are not directly related to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|<span data-ttu-id="6a6b1-360">Дополнительные сведения см. в разделе [Подготовка сети для работы кластера](https://go.microsoft.com/fwlink/?LinkId=118372).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-360">For more information, see [Enable a network for cluster use](https://go.microsoft.com/fwlink/?LinkId=118372).</span></span>|  
|<span data-ttu-id="6a6b1-361">Пространства имен URL-адресов, зарезервированные в компоненте HTTP.SYS</span><span class="sxs-lookup"><span data-stu-id="6a6b1-361">URL namespaces reserved in the HTTP Server API (HTTP.SYS)</span></span>|<span data-ttu-id="6a6b1-362">Обычно TCP-порт 80, однако можно настроить для использования любого другого порта.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-362">Probably TCP port 80, but can be configured to other ports.</span></span> <span data-ttu-id="6a6b1-363">Общие сведения см. в разделе [Настройка протоколов HTTP и HTTPS](https://go.microsoft.com/fwlink/?LinkId=118373).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-363">For general information, see [Configuring HTTP and HTTPS](https://go.microsoft.com/fwlink/?LinkId=118373).</span></span>|<span data-ttu-id="6a6b1-364">Сведения о резервировании конечной точки компонента HTTP.SYS с помощью программы HttpCfg.exe, относящиеся к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], см. в разделе [Сведения о резервировании и регистрации URL-адресов (диспетчер конфигурации служб SSRS)](../../reporting-services/install-windows/about-url-reservations-and-registration-ssrs-configuration-manager.md).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-364">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specific information about reserving an HTTP.SYS endpoint using HttpCfg.exe, see [About URL Reservations and Registration  &#40;SSRS Configuration Manager&#41;](../../reporting-services/install-windows/about-url-reservations-and-registration-ssrs-configuration-manager.md).</span></span>|  
  
##  <a name="special-considerations-for-port-135"></a><a name="BKMK_port_135"></a> <span data-ttu-id="6a6b1-365">Особые замечания относительно порта 135</span><span class="sxs-lookup"><span data-stu-id="6a6b1-365">Special Considerations for Port 135</span></span>  
 <span data-ttu-id="6a6b1-366">При использовании в качестве транспортного протокола RPC через TCP/IP или UDP/IP входящие порты для системных служб часто выделяются динамически с номерами выше 1024.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-366">When you use RPC with TCP/IP or with UDP/IP as the transport, inbound ports are frequently dynamically assigned to system services as required; TCP/IP and UDP/IP ports that are larger than port 1024 are used.</span></span> <span data-ttu-id="6a6b1-367">Иногда их называют «случайными RPC-портами».</span><span class="sxs-lookup"><span data-stu-id="6a6b1-367">These are frequently informally referred to as "random RPC ports."</span></span> <span data-ttu-id="6a6b1-368">В этом случае RPC-клиент определяет порт, назначенный серверу, через модуль конечной точки RPC.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-368">In these cases, RPC clients rely on the RPC endpoint mapper to tell them which dynamic ports were assigned to the server.</span></span> <span data-ttu-id="6a6b1-369">Для некоторых служб, работающих через протокол RPC, можно настроить использование определенного фиксированного порта.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-369">For some RPC-based services, you can configure a specific port instead of letting RPC assign one dynamically.</span></span> <span data-ttu-id="6a6b1-370">Можно также ограничить диапазон портов, которые могут быть динамически назначены службой RPC независимо от службы.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-370">You can also restrict the range of ports that RPC dynamically assigns to a small range, regardless of the service.</span></span> <span data-ttu-id="6a6b1-371">Поскольку порт 135 используется для многих служб, он часто подвергается атакам злоумышленников.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-371">Because port 135 is used for many services it is frequently attacked by malicious users.</span></span> <span data-ttu-id="6a6b1-372">В случае открытия порта 135 рекомендуется ограничить область действия правила брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-372">When opening port 135, consider restricting the scope of the firewall rule.</span></span>  
  
 <span data-ttu-id="6a6b1-373">Дополнительные сведения о порте 135 см. в следующих ресурсах.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-373">For more information about port 135, see the following references:</span></span>  
  
-   [<span data-ttu-id="6a6b1-374">Общие сведения о службе и требования к сетевым портам в системе Windows Server</span><span class="sxs-lookup"><span data-stu-id="6a6b1-374">Service overview and network port requirements for the Windows Server system</span></span>](https://support.microsoft.com/kb/832017)  
  
-   [<span data-ttu-id="6a6b1-375">Устранение неполадок модуля сопоставления конечной точки RPC при помощи средств поддержки, устанавливаемых с компакт-диска Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="6a6b1-375">Troubleshooting RPC Endpoint Mapper errors using the Windows Server 2003 Support Tools from the product CD</span></span>](https://support.microsoft.com/kb/839880)  
  
-   [<span data-ttu-id="6a6b1-376">Удаленный вызов процедур (RPC)</span><span class="sxs-lookup"><span data-stu-id="6a6b1-376">Remote procedure call (RPC)</span></span>](https://go.microsoft.com/fwlink/?LinkId=118375)  
  
-   [<span data-ttu-id="6a6b1-377">Настройка динамического выделения портов RPC для работы с брандмауэром</span><span class="sxs-lookup"><span data-stu-id="6a6b1-377">How to configure RPC dynamic port allocation to work with firewalls</span></span>](https://support.microsoft.com/kb/154596/)  
  
##  <a name="interaction-with-other-firewall-rules"></a><a name="BKMK_other_rules"></a> <span data-ttu-id="6a6b1-378">Взаимодействие с другими правилами брандмауэра</span><span class="sxs-lookup"><span data-stu-id="6a6b1-378">Interaction with Other Firewall Rules</span></span>  
 <span data-ttu-id="6a6b1-379">Настройка брандмауэра Windows производится на основе правил и групп правил.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-379">The Windows Firewall uses rules and rule groups to establish its configuration.</span></span> <span data-ttu-id="6a6b1-380">Каждое правило или группа правил обычно связаны с определенной программой или службой, которая может изменить или удалить это правило без участия пользователя.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-380">Each rule or rule group is generally associated with a particular program or service, and that program or service might modify or delete that rule without your knowledge.</span></span> <span data-ttu-id="6a6b1-381">Например, группы правил **Службы Интернета (HTTP)** и **Защищенные службы Интернета (HTTPS)** связаны со службами IIS.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-381">For example, the rule groups **World Wide Web Services (HTTP)** and **World Wide Web Services (HTTPS)** are associated with IIS.</span></span> <span data-ttu-id="6a6b1-382">При включении этих правил будут открыты порты 80 и 443 и разрешены функции [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , зависящие от этих портов.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-382">Enabling those rules will open ports 80 and 443, and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that depend on ports 80 and 443 will function if those rules are enabled.</span></span> <span data-ttu-id="6a6b1-383">Однако администратор в процессе настройки служб IIS может изменить или отключить эти правила.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-383">However, administrators configuring IIS might modify or disable those rules.</span></span> <span data-ttu-id="6a6b1-384">Поэтому, если [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]использует порт 80 или 443, необходимо создать собственное правило или группу правил для поддержки необходимой конфигурации портов, не зависящей от служб IIS.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-384">Therefore, if you are using port 80 or port 443 for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you should create your own rule or rule group that maintains your desired port configuration independently of the other IIS rules.</span></span>  
  
 <span data-ttu-id="6a6b1-385">Оснастка «Брандмауэр Windows в режиме повышенной безопасности» пропускает весь трафик, соответствующий применимым разрешающим правилам.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-385">The Windows Firewall with Advanced Security MMC snap-in allows any traffic that matches any applicable allow rule.</span></span> <span data-ttu-id="6a6b1-386">Если существует два правила для порта 80 (но с разными параметрами), будет разрешен любой трафик, соответствующий хотя бы одному из этих правил.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-386">So if there are two rules that both apply to port 80 (with different parameters), traffic that matches either rule will be permitted.</span></span> <span data-ttu-id="6a6b1-387">Таким образом, если одно правило разрешает трафик по порту 80 из локальной подсети, а второе разрешает трафик с любого адреса, то будет разрешен любой трафик по порту 80, независимо от его источника.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-387">So if one rule allows traffic over port 80 from local subnet and one rule allows traffic from any address, the net effect is that all traffic to port 80 is permitted regardless of the source.</span></span> <span data-ttu-id="6a6b1-388">Чтобы обеспечить эффективное управление доступом к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], администратор должен периодически проверять все правила брандмауэра, разрешенные на сервере.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-388">To effectively manage access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], administrators should periodically review all firewall rules enabled on the server.</span></span>  
  
##  <a name="overview-of-firewall-profiles"></a><a name="BKMK_profiles"></a> <span data-ttu-id="6a6b1-389">Общие сведения о профилях брандмауэра</span><span class="sxs-lookup"><span data-stu-id="6a6b1-389">Overview of Firewall Profiles</span></span>  
 <span data-ttu-id="6a6b1-390">Профили брандмауэра рассматриваются в разделе [Руководство по началу работы с брандмауэром Windows в режиме повышенной безопасности](https://go.microsoft.com/fwlink/?LinkId=116080) в подразделе **Брандмауэр узла, привязанный к местонахождению в сети**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-390">Firewall profiles are discussed in [Windows Firewall with Advanced Security Getting Started Guide](https://go.microsoft.com/fwlink/?LinkId=116080) in the section **Network location-aware host firewall**.</span></span> <span data-ttu-id="6a6b1-391">Подводя итоги, операционная система определяет и запоминает каждую из сетей, к которым осуществлялось подключение, по обмену данными, соединениям и категории.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-391">To summarize, the operating systems identify and remember each of the networks to which they connect with regard to connectivity, connections, and category.</span></span>  
  
 <span data-ttu-id="6a6b1-392">Брандмауэр Windows в режиме повышенной безопасности делит сети на три типа.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-392">There are three network location types in Windows Firewall with Advanced Security:</span></span>  
  
-   <span data-ttu-id="6a6b1-393">Домен.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-393">Domain.</span></span> <span data-ttu-id="6a6b1-394">Windows может выполнить проверку подлинности доступа к контроллеру домена, в который включен компьютер.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-394">Windows can authenticate access to the domain controller for the domain to which the computer is joined.</span></span>  
  
-   <span data-ttu-id="6a6b1-395">Общедоступный.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-395">Public.</span></span> <span data-ttu-id="6a6b1-396">В эту категорию первоначально попадают все сети, не входящие в домены.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-396">Other than domain networks, all networks are initially categorized as public.</span></span> <span data-ttu-id="6a6b1-397">Сети, которые представляют прямые соединения с Интернетом, являются открытыми (аэропорты, кафе и другие места открытого доступа).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-397">Networks that represent direct connections to the Internet or are in public locations, such as airports and coffee shops should be left public.</span></span>  
  
-   <span data-ttu-id="6a6b1-398">Закрытый.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-398">Private.</span></span> <span data-ttu-id="6a6b1-399">Сеть, определенная пользователем или приложением как личная.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-399">A network identified by a user or application as private.</span></span> <span data-ttu-id="6a6b1-400">Только доверенные сети могут быть определены как частные.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-400">Only trusted networks should be identified as private networks.</span></span> <span data-ttu-id="6a6b1-401">Обычно в качестве частной сети определяется сеть малого предприятия, домашняя сеть и т. п.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-401">Users will likely want to identify home or small business networks as private.</span></span>  
  
 <span data-ttu-id="6a6b1-402">Администратор может создать профиль для каждого типа сети и задать для этих профилей разные политики брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-402">The administrator can create a profile for each network location type, with each profile containing different firewall policies.</span></span> <span data-ttu-id="6a6b1-403">Одномоментно применим только один профиль.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-403">Only one profile is applied at any time.</span></span> <span data-ttu-id="6a6b1-404">Профили применяются в следующем порядке.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-404">Profile order is applied as follows:</span></span>  
  
1.  <span data-ttu-id="6a6b1-405">Если все интерфейсы прошли проверку подлинности к контроллеру домена, членом которого является компьютер, то применяется профиль домена.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-405">If all interfaces are authenticated to the domain controller for the domain of which the computer is a member, the domain profile is applied.</span></span>  
  
2.  <span data-ttu-id="6a6b1-406">Если все интерфейсы либо прошли проверку подлинности к контроллеру домена, либо соединены с сетями, которые определены как частные, применяется частный профиль.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-406">If all interfaces are either authenticated to the domain controller or are connected to networks that are classified as private network locations, the private profile is applied.</span></span>  
  
3.  <span data-ttu-id="6a6b1-407">В противном случае применяется открытый профиль.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-407">Otherwise, the public profile is applied.</span></span>  
  
 <span data-ttu-id="6a6b1-408">Просмотреть и настроить профили брандмауэра можно с помощью оснастки «Брандмауэр Windows в режиме повышенной безопасности».</span><span class="sxs-lookup"><span data-stu-id="6a6b1-408">Use the Windows Firewall with Advanced Security MMC snap-in to view and configure all firewall profiles.</span></span> <span data-ttu-id="6a6b1-409">Элемент **Брандмауэр Windows** на панели управления позволяет настраивать только текущий профиль.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-409">The **Windows Firewall** item in Control Panel only configures the current profile.</span></span>  
  
##  <a name="additional-firewall-settings-using-the-windows-firewall-item-in-control-panel"></a><a name="BKMK_additional_settings"></a> <span data-ttu-id="6a6b1-410">Дополнительные параметры брандмауэра в элементе «Брандмауэр Windows» на панели управления</span><span class="sxs-lookup"><span data-stu-id="6a6b1-410">Additional Firewall Settings Using the Windows Firewall Item in Control Panel</span></span>  
 <span data-ttu-id="6a6b1-411">Исключения, добавляемые в брандмауэр, могут ограничить открытие портов для входящих соединений с определенных компьютеров или из локальной подсети.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-411">Exceptions that you add to the firewall can restrict the opening of the port to incoming connections from specific computers or the local subnet.</span></span> <span data-ttu-id="6a6b1-412">Метод ограничения области действия открытия портов способен сократить зону уязвимости компьютера, и поэтому рекомендуется к применению.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-412">This restriction of the scope of the port opening can reduce how much your computer is exposed to malicious users, and is recommended.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6a6b1-413">Элемент **Брандмауэр Windows** на панели управления позволяет настроить только текущий профиль.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-413">Using the **Windows Firewall** item in Control Panel only configures the current firewall profile.</span></span>  
  
#### <a name="to-change-the-scope-of-a-firewall-exception-using-the-windows-firewall-item-in-control-panel"></a><span data-ttu-id="6a6b1-414">Изменение области действия исключения брандмауэра с помощью «Брандмауэра Windows» на панели управления</span><span class="sxs-lookup"><span data-stu-id="6a6b1-414">To change the scope of a firewall exception using the Windows Firewall item in Control Panel</span></span>  
  
1.  <span data-ttu-id="6a6b1-415">В элементе **Брандмауэр Windows** на панели управления выберите программу или порт на вкладке **Исключения** и нажмите кнопку **Свойства** или **Изменить**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-415">In the **Windows Firewall** item in Control Panel, select a program or port on the **Exceptions** tab, and then click **Properties** or **Edit**.</span></span>  
  
2.  <span data-ttu-id="6a6b1-416">В диалоговом окне **Изменение программы** или **Изменение порта** нажмите кнопку **Изменить область**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-416">In the **Edit a Program** or **Edit a Port** dialog box, click **Change Scope**.</span></span>  
  
3.  <span data-ttu-id="6a6b1-417">Выберите один из следующих параметров.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-417">Choose one of the following options:</span></span>  
  
    -   <span data-ttu-id="6a6b1-418">**Любой компьютер (включая Интернет)**</span><span class="sxs-lookup"><span data-stu-id="6a6b1-418">**Any computer (including those on the Internet)**</span></span>  
  
         <span data-ttu-id="6a6b1-419">Не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-419">Not recommended.</span></span> <span data-ttu-id="6a6b1-420">В этом режиме любой компьютер, который имеет доступ к данному узлу, сможет подключиться к программе или порту.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-420">This will allow any computer that can address your computer to connect to the specified program or port.</span></span> <span data-ttu-id="6a6b1-421">Этот параметр может пригодиться для передачи данных анонимным пользователям Интернета, однако он повышает уязвимость компьютера.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-421">This setting might be necessary to allow information to be presented to anonymous users on the internet, but increases your exposure to malicious users.</span></span> <span data-ttu-id="6a6b1-422">Уязвимость еще более повысится, если одновременно с этим параметром разрешить просмотр трансляции сетевых адресов (например при помощи параметра «Разрешить просмотр узлов»).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-422">Your exposure can be further increased if you enable this setting and also allow Network Address Translation (NAT) traversal, such as the Allow edge traversal option.</span></span>  
  
    -   <span data-ttu-id="6a6b1-423">**Только моя сеть (подсеть)**</span><span class="sxs-lookup"><span data-stu-id="6a6b1-423">**My network (subnet) only**</span></span>  
  
         <span data-ttu-id="6a6b1-424">Это более безопасный режим, чем **Любой компьютер**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-424">This is a more secure setting than **Any computer**.</span></span> <span data-ttu-id="6a6b1-425">Только компьютеры локальной подсети могут производить соединение с программой или портом.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-425">Only computers on the local subnet of your network can connect to the program or port.</span></span>  
  
    -   <span data-ttu-id="6a6b1-426">**Особый список.**</span><span class="sxs-lookup"><span data-stu-id="6a6b1-426">**Custom list:**</span></span>  
  
     <span data-ttu-id="6a6b1-427">Соединение разрешено только компьютерам, имеющим перечисленные IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-427">Only computers that have the IP addresses you list can connect.</span></span> <span data-ttu-id="6a6b1-428">Это еще более безопасный режим, чем **Только локальная сеть (подсеть)** , хотя у клиентского компьютера, использующего DHCP, может измениться IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-428">This can be a more secure setting than **My network (subnet) only**, however, client computers using DHCP can occasionally change their IP address.</span></span> <span data-ttu-id="6a6b1-429">После этого он уже не сможет установить соединение.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-429">Then the intended computer will not be able to connect.</span></span> <span data-ttu-id="6a6b1-430">Другой компьютер, которому доступ не предоставлялся, может получить перечисленный в списке IP-адрес, что позволит ему установить соединение.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-430">Another computer, which you had not intended to authorize, might accept the listed IP address and then be able to connect.</span></span> <span data-ttu-id="6a6b1-431">Параметр **Особый список** может пригодиться для хранения списка серверов, настроенных для использования фиксированного IP-адреса, однако эти адреса могут быть перехвачены злоумышленником.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-431">The **Custom list** option might be appropriate for listing other servers which are configured to use a fixed IP address; however, IP addresses might be spoofed by an intruder.</span></span> <span data-ttu-id="6a6b1-432">Эффект ограничения правил брандмауэра напрямую зависит от уровня защиты сетевой инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-432">Restricting firewall rules are only as strong as your network infrastructure.</span></span>  
  
##  <a name="using-the-windows-firewall-with-advanced-security-snap-in"></a><a name="BKMK_WF_msc"></a> <span data-ttu-id="6a6b1-433">Использование оснастки «Брандмауэр Windows в режиме повышенной безопасности»</span><span class="sxs-lookup"><span data-stu-id="6a6b1-433">Using the Windows Firewall with Advanced Security Snap-in</span></span>  
 <span data-ttu-id="6a6b1-434">Дополнительные параметры брандмауэра можно настроить при помощи оснастки «Брандмауэр Windows в режиме повышенной безопасности».</span><span class="sxs-lookup"><span data-stu-id="6a6b1-434">Additional advanced firewall settings can be configured by using the Windows Firewall with Advanced Security MMC snap-in.</span></span> <span data-ttu-id="6a6b1-435">Эта оснастка включает в себя мастер правил и дает доступ к дополнительным параметрам, которые недоступны через элемент **Брандмауэр Windows** на панели управления.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-435">The snap-in includes a rule wizard and exposes additional settings that are not available in the **Windows Firewall** item in Control Panel.</span></span> <span data-ttu-id="6a6b1-436">В их число входят следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-436">These settings include the following:</span></span>  
  
-   <span data-ttu-id="6a6b1-437">Параметры шифрования.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-437">Encryption settings</span></span>  
  
-   <span data-ttu-id="6a6b1-438">Ограничения служб.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-438">Services restrictions</span></span>  
  
-   <span data-ttu-id="6a6b1-439">Ограничение соединений для компьютеров по именам.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-439">Restricting connections for computers by name</span></span>  
  
-   <span data-ttu-id="6a6b1-440">Ограничение соединений для определенных пользователей или профилей.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-440">Restricting connections to specific users or profiles</span></span>  
  
-   <span data-ttu-id="6a6b1-441">Разрешение просмотра узлов для исключения маршрутизаторов NAT.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-441">Edge traversal allowing traffic to bypass Network Address Translation (NAT) routers</span></span>  
  
-   <span data-ttu-id="6a6b1-442">Настройка правил исходящих соединений.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-442">Configuring outbound rules</span></span>  
  
-   <span data-ttu-id="6a6b1-443">Настройка правил безопасности.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-443">Configuring security rules</span></span>  
  
-   <span data-ttu-id="6a6b1-444">Требование протокола IPsec для входящих соединений.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-444">Requiring IPsec for incoming connections</span></span>  
  
#### <a name="to-create-a-new-firewall-rule-using-the-new-rule-wizard"></a><span data-ttu-id="6a6b1-445">Создание правила брандмауэра при помощи мастера создания правил</span><span class="sxs-lookup"><span data-stu-id="6a6b1-445">To create a new firewall rule using the New Rule wizard</span></span>  
  
1.  <span data-ttu-id="6a6b1-446">В меню Пуск выберите команду **Выполнить**, введите **WF.msc**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-446">On the Start menu, click **Run**, type **WF.msc**, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="6a6b1-447">В левой части панели **Брандмауэр Windows в режиме повышенной безопасности**щелкните правой кнопкой мыши элемент **Правила для входящих подключений**и выберите пункт **Создать правило**.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-447">In the **Windows Firewall with Advanced Security**, in the left pane, right-click **Inbound Rules**, and then click **New Rule**.</span></span>  
  
3.  <span data-ttu-id="6a6b1-448">Завершите **мастер создания правила для нового входящего подключения** , задав все необходимые параметры.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-448">Complete the **New Inbound Rule Wizard** using the settings that you want.</span></span>  
  
##  <a name="troubleshooting-firewall-settings"></a><a name="BKMK_troubleshooting"></a> <span data-ttu-id="6a6b1-449">Устранение неполадок настройки брандмауэра</span><span class="sxs-lookup"><span data-stu-id="6a6b1-449">Troubleshooting Firewall Settings</span></span>  
 <span data-ttu-id="6a6b1-450">Следующие средства и методы могут оказаться полезными при устранении неполадок брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-450">The following tools and techniques can be useful in troubleshooting firewall issues:</span></span>  
  
-   <span data-ttu-id="6a6b1-451">Действующее состояние порта является объединением всех правил, связанных с этим портом.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-451">The effective port status is the union of all rules related to the port.</span></span> <span data-ttu-id="6a6b1-452">Чтобы заблокировать доступ к порту, бывает полезно просмотреть все правила, в которых он упоминается.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-452">When trying to block access through a port, it can be helpful to review all the rules which cite the port number.</span></span> <span data-ttu-id="6a6b1-453">Чтобы сделать это, откройте оснастку «Брандмауэр Windows в режиме повышенной безопасности» и отсортируйте правила по номеру порта.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-453">To do this, use the Windows Firewall with Advanced Security MMC snap-in and sort the inbound and outbound rules by port number.</span></span>  
  
-   <span data-ttu-id="6a6b1-454">Просмотрите порты, которые активны на компьютере, где запущен [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-454">Review the ports that are active on the computer on which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running.</span></span> <span data-ttu-id="6a6b1-455">В процессе анализа необходимо проверить, на каких TCP/IP-портах осуществляется прослушивание, а также проверить состояние этих портов.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-455">This review process includes verifying which TCP/IP ports are listening and also verifying the status of the ports.</span></span>  
  
     <span data-ttu-id="6a6b1-456">Чтобы проверить, на каких портах осуществляется прослушивание, используйте служебную программу командной строки **netstat** .</span><span class="sxs-lookup"><span data-stu-id="6a6b1-456">To verify which ports are listening, use the **netstat** command-line utility.</span></span> <span data-ttu-id="6a6b1-457">Помимо активных TCP-подключений, служебная программа **netstat** также отображает различную статистику и другие сведения о протоколе IP.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-457">In addition to displaying active TCP connections, the **netstat** utility also displays a variety of IP statistics and information.</span></span>  
  
    #### <a name="to-list-which-tcpip-ports-are-listening"></a><span data-ttu-id="6a6b1-458">Получение списка прослушиваемых TCP/IP-портов</span><span class="sxs-lookup"><span data-stu-id="6a6b1-458">To list which TCP/IP ports are listening</span></span>  
  
    1.  <span data-ttu-id="6a6b1-459">Откройте окно командной строки.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-459">Open the Command Prompt window.</span></span>  
  
    2.  <span data-ttu-id="6a6b1-460">В командной строке введите `netstat -n -a`.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-460">At the command prompt, type `netstat -n -a`.</span></span>  
  
         <span data-ttu-id="6a6b1-461">При наличии параметра **-n** служебная программа **netstat** выводит адреса и номера портов активных подключений TCP в числовом виде.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-461">The **-n** switch instructs **netstat** to numerically display the address and port number of active TCP connections.</span></span> <span data-ttu-id="6a6b1-462">При наличии параметра **-a** служебная программа **netstat** выводит порты TCP и UDP, которые прослушиваются компьютером.</span><span class="sxs-lookup"><span data-stu-id="6a6b1-462">The **-a** switch instructs **netstat** to display the TCP and UDP ports on which the computer is listening.</span></span>  
  
-   <span data-ttu-id="6a6b1-463">Служебную программу **PortQry** можно использовать для вывода состояния портов TCP/IP (прослушивается, не прослушивается, фильтруется).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-463">The **PortQry** utility can be used to report the status of TCP/IP ports as listening, not listening, or filtered.</span></span> <span data-ttu-id="6a6b1-464">В состоянии фильтрации порт может либо прослушиваться, либо не прослушиваться. Это состояние указывает, что программа не получила ответа от порта. Служебную программу **PortQry** можно скачать из [Центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=17148).</span><span class="sxs-lookup"><span data-stu-id="6a6b1-464">(With a filtered status, the port might or might not be listening; this status indicates that the utility did not receive a response from the port.) The **PortQry** utility is available for download from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=17148).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6a6b1-465">См. также:</span><span class="sxs-lookup"><span data-stu-id="6a6b1-465">See Also</span></span>  
 [<span data-ttu-id="6a6b1-466">Обзор служб и требования к сетевым портам в Windows</span><span class="sxs-lookup"><span data-stu-id="6a6b1-466">Service overview and network port requirements for the Windows Server system</span></span>](https://support.microsoft.com/kb/832017)  
