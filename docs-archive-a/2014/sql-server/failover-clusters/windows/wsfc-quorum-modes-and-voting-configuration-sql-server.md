---
title: Режимы кворума WSFC и участвующая в голосовании конфигурация (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], WSFC clusters
- quorum [SQL Server], AlwaysOn and WSFC quorum
- failover clustering [SQL Server], AlwaysOn Availability Groups
ms.assetid: ca0d59ef-25f0-4047-9130-e2282d058283
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 6b1d5ad992c59f252f485f2d65451a72f150bef8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87659264"
---
# <a name="wsfc-quorum-modes-and-voting-configuration-sql-server"></a><span data-ttu-id="9ada1-102">Режимы кворума WSFC и участвующая в голосовании конфигурация (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="9ada1-102">WSFC Quorum Modes and Voting Configuration (SQL Server)</span></span>
  <span data-ttu-id="9ada1-103">И [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)][!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], и экземпляры отказоустойчивого кластера (FCI) в режиме AlwaysOn используют платформу отказоустойчивых кластеров Windows Server (WSFC).</span><span class="sxs-lookup"><span data-stu-id="9ada1-103">Both [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)][!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] and AlwaysOn Failover Cluster Instances (FCI) take advantage of Windows Server Failover Clustering (WSFC) as a platform technology.</span></span>  <span data-ttu-id="9ada1-104">В WSFC для мониторинга общей исправности кластера и обеспечения максимальной отказоустойчивости на уровне узлов используется подход, основанный на кворуме.</span><span class="sxs-lookup"><span data-stu-id="9ada1-104">WSFC uses a quorum-based approach to monitoring overall cluster health and maximize node-level fault tolerance.</span></span> <span data-ttu-id="9ada1-105">Для проектирования, эксплуатации и устранения неполадок решений высокого уровня доступности режима AlwaysOn и решений аварийного восстановления требуется отличное знание режимов кворума WSFC и конфигурации голосования узлов.</span><span class="sxs-lookup"><span data-stu-id="9ada1-105">A fundamental understanding of WSFC quorum modes and node voting configuration is very important to designing, operating, and troubleshooting your AlwaysOn high availability and disaster recovery solution.</span></span>  
  
 <span data-ttu-id="9ada1-106">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="9ada1-106">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="9ada1-107">Определение работоспособности кластера по кворуму</span><span class="sxs-lookup"><span data-stu-id="9ada1-107">Cluster Health Detection by Quorum</span></span>](#ClusterHealthDetectionbyQuorum)  
  
-   [<span data-ttu-id="9ada1-108">Режимы кворума</span><span class="sxs-lookup"><span data-stu-id="9ada1-108">Quorum Modes</span></span>](#QuorumModes)  
  
-   [<span data-ttu-id="9ada1-109">Узлы голосования и не голосования</span><span class="sxs-lookup"><span data-stu-id="9ada1-109">Voting and Non-Voting Nodes</span></span>](#VotingandNonVotingNodes)  
  
-   [<span data-ttu-id="9ada1-110">Рекомендуемые настройки для голосования в отношении кворума</span><span class="sxs-lookup"><span data-stu-id="9ada1-110">Recommended Adjustments to Quorum Voting</span></span>](#RecommendedAdjustmentstoQuorumVoting)  
  
-   [<span data-ttu-id="9ada1-111">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="9ada1-111">Related Tasks</span></span>](#RelatedTasks)  
  
-   [<span data-ttu-id="9ada1-112">См. также</span><span class="sxs-lookup"><span data-stu-id="9ada1-112">Related Content</span></span>](#RelatedContent)  
  
##  <a name="cluster-health-detection-by-quorum"></a><a name="ClusterHealthDetectionbyQuorum"></a> <span data-ttu-id="9ada1-113">Определение исправности кластера по кворуму</span><span class="sxs-lookup"><span data-stu-id="9ada1-113">Cluster Health Detection by Quorum</span></span>  
 <span data-ttu-id="9ada1-114">Все узлы в кластере WSFC участвуют в периодической передаче тактового импульса, сообщающего состояние исправности узла другим узлам.</span><span class="sxs-lookup"><span data-stu-id="9ada1-114">Each node in a WSFC cluster participates in periodic heartbeat communication to share the node's health status with the other nodes.</span></span> <span data-ttu-id="9ada1-115">Неотвечающие узлы считаются неисправными.</span><span class="sxs-lookup"><span data-stu-id="9ada1-115">Unresponsive nodes are considered to be in a failed state.</span></span>  
  
 <span data-ttu-id="9ada1-116">Набор узлов *кворума* — это большинство узлов с правом голоса и следящих объектов в кластере WSFC.</span><span class="sxs-lookup"><span data-stu-id="9ada1-116">A *quorum* node set is a majority of the voting nodes and witnesses in the WSFC cluster.</span></span> <span data-ttu-id="9ada1-117">Общая исправность и состояние кластера WSFC определяется периодическим *голосованием с кворумом*.</span><span class="sxs-lookup"><span data-stu-id="9ada1-117">The overall health and status of a WSFC cluster is determined by a periodic *quorum vote*.</span></span>  <span data-ttu-id="9ada1-118">Наличие кворума означает, что кластер работоспособен и может обеспечивать отказоустойчивость на уровне узла.</span><span class="sxs-lookup"><span data-stu-id="9ada1-118">The presence of a quorum means that the cluster is healthy and able to provide node-level fault tolerance.</span></span>  
  
 <span data-ttu-id="9ada1-119">Отсутствие кворума указывает, что кластер неработоспособен.</span><span class="sxs-lookup"><span data-stu-id="9ada1-119">The absence of a quorum indicates that the cluster is not healthy.</span></span>  <span data-ttu-id="9ada1-120">Необходимо поддерживать общую исправность кластера WSFC, чтобы обеспечить доступность и работоспособность вторичных узлов, на которые смогут переключаться первичные узлы в случае сбоя.</span><span class="sxs-lookup"><span data-stu-id="9ada1-120">Overall WSFC cluster health must be maintained in order to ensure that healthy secondary nodes are available for primary nodes to fail over to.</span></span>  <span data-ttu-id="9ada1-121">Если голосование с кворумом завершается неудачей, кластер WSFC переводится в режим «вне сети» в качестве меры предосторожности.</span><span class="sxs-lookup"><span data-stu-id="9ada1-121">If the quorum vote fails, the WSFC cluster will be set offline as a precautionary measure.</span></span>  <span data-ttu-id="9ada1-122">При этом также останавливаются все экземпляры [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , зарегистрированные в кластере.</span><span class="sxs-lookup"><span data-stu-id="9ada1-122">This will also cause all [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances registered with the cluster to be stopped.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9ada1-123">Если кластер WSFC переводится в режим «вне сети» из-за отсутствия кворума, перевести его обратно в оперативный режим потребуется вручную.</span><span class="sxs-lookup"><span data-stu-id="9ada1-123">If a WSFC cluster is set offline because of quorum failure, manual intervention is required to bring it back online.</span></span>  
>   
>  <span data-ttu-id="9ada1-124">Дополнительные сведения см. в статье [Аварийное восстановление WSFC с помощью принудительного кворума &#40;SQL Server&#41;](wsfc-disaster-recovery-through-forced-quorum-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="9ada1-124">For more information, see: [WSFC Disaster Recovery through Forced Quorum &#40;SQL Server&#41;](wsfc-disaster-recovery-through-forced-quorum-sql-server.md).</span></span>  
  
##  <a name="quorum-modes"></a><a name="QuorumModes"></a><span data-ttu-id="9ada1-125">Режимы кворума</span><span class="sxs-lookup"><span data-stu-id="9ada1-125">Quorum Modes</span></span>  
 <span data-ttu-id="9ada1-126">*Режим кворума* настраивается на уровне кластера WSFC, который определяет метод проведения голосования с кворумом.</span><span class="sxs-lookup"><span data-stu-id="9ada1-126">A *quorum mode* is configured at the WSFC cluster level that dictates the methodology used for quorum voting.</span></span>  <span data-ttu-id="9ada1-127">Диспетчер отказоустойчивого кластера рекомендует режим кворума на основании количества узлов в кластере.</span><span class="sxs-lookup"><span data-stu-id="9ada1-127">The Failover Cluster Manager utility will recommend a quorum mode based on the number of nodes in the cluster.</span></span>  
  
 <span data-ttu-id="9ada1-128">Для определения кворума голосов можно использовать следующие режимы кворума:</span><span class="sxs-lookup"><span data-stu-id="9ada1-128">The following quorum modes can be used to determine what constitutes a quorum of votes:</span></span>  
  
-   <span data-ttu-id="9ada1-129">**Большинство узлов.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-129">**Node Majority.**</span></span> <span data-ttu-id="9ada1-130">Кластер признается работоспособным, если больше половины узлов подтверждают работоспособность кластера.</span><span class="sxs-lookup"><span data-stu-id="9ada1-130">More than one-half of the voting nodes in the cluster must vote affirmatively for the cluster to be healthy.</span></span>  
  
-   <span data-ttu-id="9ada1-131">**Большинство узлов и общих файловых ресурсов.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-131">**Node and File Share Majority.**</span></span> <span data-ttu-id="9ada1-132">Аналогичен режиму кворума большинства узлов, за исключением того, что удаленная общая папка также настраивается в качестве следящей папки с правом голоса, и подключения от любого узла к этой папке также считаются голосами, подтверждающими работоспособность.</span><span class="sxs-lookup"><span data-stu-id="9ada1-132">Similar to Node Majority quorum mode, except that a remote file share is also configured as a voting witness, and connectivity from any node to that share is also counted as an affirmative vote.</span></span>  <span data-ttu-id="9ada1-133">Кластер признается работоспособным, если больше половины возможных голосов подтверждают работоспособность кластера.</span><span class="sxs-lookup"><span data-stu-id="9ada1-133">More than one-half of the possible votes must be affirmative for the cluster to be healthy.</span></span>  
  
     <span data-ttu-id="9ada1-134">Рекомендуется, чтобы следящая общая папка не размещалась ни на одном узле в кластере и была видима для всех узлов в кластере.</span><span class="sxs-lookup"><span data-stu-id="9ada1-134">As a best practice, the witness file share should not reside on any node in the cluster, and it should be visible to all nodes in the cluster.</span></span>  
  
-   <span data-ttu-id="9ada1-135">**Большинство узлов и дисков.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-135">**Node and Disk Majority.**</span></span> <span data-ttu-id="9ada1-136">Аналогичен режиму кворума большинства узлов, за исключением того, что общий дисковый кластерный ресурс также признается следящим объектом с правом голоса, а все подключения от любого узла к этому общему диску считаются голосами, подтверждающими работоспособность.</span><span class="sxs-lookup"><span data-stu-id="9ada1-136">Similar to Node Majority quorum mode, except that a shared disk cluster resource is also designated as a voting witness, and connectivity from any node to that shared disk is also counted as an affirmative vote.</span></span>  <span data-ttu-id="9ada1-137">Кластер признается работоспособным, если больше половины возможных голосов подтверждают работоспособность кластера.</span><span class="sxs-lookup"><span data-stu-id="9ada1-137">More than one-half of the possible votes must be affirmative for the cluster to be healthy.</span></span>  
  
-   <span data-ttu-id="9ada1-138">**только диск.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-138">**Disk Only.**</span></span> <span data-ttu-id="9ada1-139">Общий дисковый кластерный ресурс признается следящим, а подключение от любого узла к этому общему диску считается голосом, подтверждающим работоспособность.</span><span class="sxs-lookup"><span data-stu-id="9ada1-139">A shared disk cluster resource is designated as a witness, and connectivity by any node to that shared disk is counted as an affirmative vote.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="9ada1-140">При использовании асимметричной системы хранения для [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]в общем случае следует использовать режим кворума «Большинство узлов» при нечетном числе узлов с правом голоса и режим кворума «Большинство узлов и общих папок» при четном числе узлов с правом голоса.</span><span class="sxs-lookup"><span data-stu-id="9ada1-140">When using an asymmetric storage configuration for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], you should generally use the Node Majority quorum mode when you have an odd number of voting nodes, or the Node and File Share Majority quorum mode when you have an even number of voting nodes.</span></span>  
  
##  <a name="voting-and-non-voting-nodes"></a><a name="VotingandNonVotingNodes"></a> <span data-ttu-id="9ada1-141">Узлы с правом и без права голоса</span><span class="sxs-lookup"><span data-stu-id="9ada1-141">Voting and Non-Voting Nodes</span></span>  
 <span data-ttu-id="9ada1-142">По умолчанию каждый узел в кластере WSFC включается в качестве члена кворума кластера. Каждый узел имеет один голос, который учитывается при определении общей исправности кластера, и каждый узел постоянно пытается образовать кворум.</span><span class="sxs-lookup"><span data-stu-id="9ada1-142">By default, each node in the WSFC cluster is included as a member of the cluster quorum; each node has a single vote in determining the overall cluster health, and each node will continuously attempt to establish a quorum.</span></span>  <span data-ttu-id="9ada1-143">На данный момент были четко определены узлы кластера WSFC, принимающие участие в голосовании по исправности кластера, которые называются *узлами с правом голоса*.</span><span class="sxs-lookup"><span data-stu-id="9ada1-143">The quorum discussion to this point has carefully qualified the set of WSFC cluster nodes that vote on cluster health as *voting nodes*.</span></span>  
  
 <span data-ttu-id="9ada1-144">Ни один отдельный узел в кластере WSFC не может окончательно определить, является ли кластер в целом работоспособным.</span><span class="sxs-lookup"><span data-stu-id="9ada1-144">No individual node in a WSFC cluster can definitively determine that the cluster as a whole is healthy or unhealthy.</span></span>  <span data-ttu-id="9ada1-145">В любой момент времени с точки зрения любого узла может казаться, что некоторые другие узлы не работают, находятся в процессе отработки отказа или не отвечают из-за сбоя сетевого подключения.</span><span class="sxs-lookup"><span data-stu-id="9ada1-145">At any given moment, from the perspective of each node, some of the other nodes may appear to be offline, or appear to be in the process of failover, or appear unresponsive due to a network communication failure.</span></span>  <span data-ttu-id="9ada1-146">Главная задача голосования с кворумом — определить, является ли видимое состояние каждого узла в кластере WSFC фактическим состоянием этих узлов.</span><span class="sxs-lookup"><span data-stu-id="9ada1-146">A key function of the quorum vote is to determine whether the apparent state of each of node in the WSFC cluster is indeed that actual state of those nodes.</span></span>  
  
 <span data-ttu-id="9ada1-147">Для всех режимов кворума, кроме "только диски", эффективность голосования кворума зависит от надежности соединений между всеми узлами с правом голоса в кластере.</span><span class="sxs-lookup"><span data-stu-id="9ada1-147">For all of the quorum models except 'Disk Only', the effectiveness of a quorum vote depends on reliable communications between all of the voting nodes in the cluster.</span></span> <span data-ttu-id="9ada1-148">Сетевые соединения между узлами в одной физической подсети следует считать надежными, и голосование кворума следует считать надежным.</span><span class="sxs-lookup"><span data-stu-id="9ada1-148">Network communications between nodes on the same physical subnet should be considered reliable; the quorum vote should be trusted.</span></span>  
  
 <span data-ttu-id="9ada1-149">Однако если в голосовании кворума кажется, что узел или другая подсеть не отвечают, но на самом деле они находятся в рабочем состоянии, то, скорее всего, это происходит из-за сбоя соединения между подсетями.</span><span class="sxs-lookup"><span data-stu-id="9ada1-149">However, if a node on another subnet is seen as non-responsive in a quorum vote, but it is actually online and otherwise healthy, that is most likely due to a network communications failure between subnets.</span></span>  <span data-ttu-id="9ada1-150">В зависимости от топологии кластера, режима кворума и конфигурации политики отработки отказа, сбой сетевого соединения может приводить к созданию более одного набора узлов с правом голоса.</span><span class="sxs-lookup"><span data-stu-id="9ada1-150">Depending upon the cluster topology, quorum mode, and failover policy configuration, that network communications failure may effectively create more than one set (or subset) of voting nodes.</span></span>  
  
 <span data-ttu-id="9ada1-151">Если свой собственный кворум могут организовать несколько наборов узлов с правом голоса, это называется *сценарием с дроблением*.</span><span class="sxs-lookup"><span data-stu-id="9ada1-151">When more than one subset of voting nodes is able to establish a quorum on its own, that is known as a *split-brain scenario*.</span></span>  <span data-ttu-id="9ada1-152">В этом случае узлы в отдельных кворумах могут вести себя по-разному и находиться в конфликте друг с другом.</span><span class="sxs-lookup"><span data-stu-id="9ada1-152">In such a scenario, the nodes in the separate quorums may behave differently, and in conflict with one another.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9ada1-153">Сценарий с дроблением возможен только в случаях, когда системный администратор вручную организует принудительную работу кворума или в очень редких случаях принудительной отработки отказа при явном разделении набора узлов кворума.</span><span class="sxs-lookup"><span data-stu-id="9ada1-153">The split-brain scenario is only possible when a system administrator manually performs a forced quorum operation, or in very rare circumstances, a forced failover; explicitly subdividing the quorum node set.</span></span>  
  
 <span data-ttu-id="9ada1-154">Чтобы упростить настройку кворума и увеличить время, может потребоваться изменить параметр *NodeWeight* каждого узла таким образом, чтобы голосование узла не учитывал кворум.</span><span class="sxs-lookup"><span data-stu-id="9ada1-154">In order to simplify your quorum configuration and increase up-time, you may want to adjust each node's *NodeWeight* setting so that the node's vote is not counted towards the quorum.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9ada1-155">Для использования параметров NodeWeight необходимо применить следующее исправление ко всем серверам в кластере WSFC:</span><span class="sxs-lookup"><span data-stu-id="9ada1-155">In order to use NodeWeight settings, the following hotfix must be applied to all servers in the WSFC cluster:</span></span>  
>   
>  <span data-ttu-id="9ada1-156">[KB2494036](https://support.microsoft.com/kb/2494036). доступно исправление, позволяющее настроить узел кластера, не имеющий голоса кворума в [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] и в[!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)]</span><span class="sxs-lookup"><span data-stu-id="9ada1-156">[KB2494036](https://support.microsoft.com/kb/2494036): A hotfix is available to let you configure a cluster node that does not have quorum votes in [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] and in [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)]</span></span>  
  
##  <a name="recommended-adjustments-to-quorum-voting"></a><a name="RecommendedAdjustmentstoQuorumVoting"></a> <span data-ttu-id="9ada1-157">Рекомендуемые настройки для голосования с кворумом</span><span class="sxs-lookup"><span data-stu-id="9ada1-157">Recommended Adjustments to Quorum Voting</span></span>  
 <span data-ttu-id="9ada1-158">При включении или отключении голоса конкретного узла WSFC соблюдайте следующие правила.</span><span class="sxs-lookup"><span data-stu-id="9ada1-158">When enabling or disabling a given WSFC node's vote, follow these guidelines:</span></span>  
  
-   <span data-ttu-id="9ada1-159">**Отсутствие голосования по умолчанию.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-159">**No vote by default.**</span></span> <span data-ttu-id="9ada1-160">Предполагается, что каждый узел не должен голосовать без явного выравнивания.</span><span class="sxs-lookup"><span data-stu-id="9ada1-160">Assume that each node should not vote without explicit justification.</span></span>  
  
-   <span data-ttu-id="9ada1-161">**Охватите все основные реплики.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-161">**Include all primary replicas.**</span></span> <span data-ttu-id="9ada1-162">Каждый узел WSFC, на котором размещена первичная реплика группы доступности или предпочитаемый владелец FCI, должен иметь голос.</span><span class="sxs-lookup"><span data-stu-id="9ada1-162">Each WSFC node that hosts an availability group primary replica or is the preferred owner of an FCI should have a vote.</span></span>  
  
-   <span data-ttu-id="9ada1-163">**Включайте возможных владельцев автоматического перехода на другой ресурс.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-163">**Include possible automatic failover owners.**</span></span> <span data-ttu-id="9ada1-164">Каждый узел, на котором в результате автоматического перехода группы доступности или экземпляра отказоустойчивого кластера на другой ресурс может размещаться первичная реплика доступности, должен иметь голос.</span><span class="sxs-lookup"><span data-stu-id="9ada1-164">Each node that could host a primary replica, as the result of an automatic availability group failover or FCI failover, should have a vote.</span></span> <span data-ttu-id="9ada1-165">Если имеется только одна группа доступности в кластере WSFC, а реплики доступности размещаются только на автономных экземплярах, то это правило охватывает только вторичную реплику, которая является целью автоматического перехода на другой ресурс.</span><span class="sxs-lookup"><span data-stu-id="9ada1-165">If there is only one availability group in the WSFC cluster and availability replicas are hosted only by standalone instances, this rule includes only the secondary replica that is the automatic failover target.</span></span>  
  
-   <span data-ttu-id="9ada1-166">**Исключайте узлы вторичного сайта.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-166">**Exclude secondary site nodes.**</span></span> <span data-ttu-id="9ada1-167">В общем случае не давайте голоса узлам WSFC, которые находятся на вторичном сайте аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="9ada1-167">In general, do not give votes to WSFC nodes that reside at a secondary disaster recovery site.</span></span>  <span data-ttu-id="9ada1-168">Не следует, чтобы узлы на вторичном сайте могли принимать участие в решение о переводе кластера в режим «вне сети», когда на первичном сайте нет никаких проблем.</span><span class="sxs-lookup"><span data-stu-id="9ada1-168">You do not want nodes in the secondary site to contribute to a decision to take the cluster offline when there is nothing wrong with the primary site.</span></span>  
  
-   <span data-ttu-id="9ada1-169">**Нечетное число голосов.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-169">**Odd number of votes.**</span></span> <span data-ttu-id="9ada1-170">Если необходимо, добавьте в кластер следящую общую папку, следящий узел или следящий диск и измените режим кворума, чтобы избежать возможного разделения голосов пополам при голосовании с кворумом.</span><span class="sxs-lookup"><span data-stu-id="9ada1-170">If necessary, add a witness file share, a witness node, or a witness disk to the cluster and adjust the quorum mode to prevent possible ties in the quorum vote.</span></span>  
  
-   <span data-ttu-id="9ada1-171">**Перераспределяйте назначение голосов после отработки отказа.**</span><span class="sxs-lookup"><span data-stu-id="9ada1-171">**Re-assess vote assignments post-failover.**</span></span> <span data-ttu-id="9ada1-172">Не следует допускать отработку отказа с переходом на конфигурацию кластера, которая не поддерживает работоспособность кворума.</span><span class="sxs-lookup"><span data-stu-id="9ada1-172">You do not want to fail over into a cluster configuration that does not support a healthy quorum.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9ada1-173">При проверке конфигурации кворума голосования WSFC мастер создания групп доступности в режиме AlwaysOn отображает предупреждение, если выполняется любое из следующих условий.</span><span class="sxs-lookup"><span data-stu-id="9ada1-173">When validating WSFC quorum vote configuration, the AlwaysOn Availability Group Wizard shows a warning if any of the following conditions are true:</span></span>  
> 
>  -   <span data-ttu-id="9ada1-174">Узел кластера, на котором размещена первичная реплика, не имеет голоса.</span><span class="sxs-lookup"><span data-stu-id="9ada1-174">The cluster node that hosts the primary replica does not have a vote</span></span>  
> -   <span data-ttu-id="9ada1-175">Вторичная реплика настроена для автоматического перехода на другой ресурс, а ее узел кластера не имеет голоса.</span><span class="sxs-lookup"><span data-stu-id="9ada1-175">A secondary replica is configured for automatic failover and its cluster node does not have a vote.</span></span>  
> -   <span data-ttu-id="9ada1-176">[KB2494036](https://support.microsoft.com/kb/2494036) не установлено на всех узлах кластера, на которых размещены реплики доступности.</span><span class="sxs-lookup"><span data-stu-id="9ada1-176">[KB2494036](https://support.microsoft.com/kb/2494036) is not installed on all cluster nodes that host availability replicas.</span></span> <span data-ttu-id="9ada1-177">Это обновление необходимо для добавления или удаления голосов для узлов кластера в многосайтовых развертываниях.</span><span class="sxs-lookup"><span data-stu-id="9ada1-177">This patch is required to add or remove votes for cluster nodes in multi-site deployments.</span></span> <span data-ttu-id="9ada1-178">Однако в односайтовых развертываниях это обычно не требуется, поэтому можно безопасно пропустить предупреждение.</span><span class="sxs-lookup"><span data-stu-id="9ada1-178">However, in single-site deployments, it is usually not required and you may safely ignore the warning.</span></span>  
> 
> [!TIP]
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="9ada1-179">предлагает несколько системных динамических административных представлений, которые могут помочь в управлении параметрами конфигурации кластера WSFC и голосовании с кворумом узлов.</span><span class="sxs-lookup"><span data-stu-id="9ada1-179">exposes several system dynamic management views (DMVs) that can help you manage settings related WSFC cluster configuration and node quorum voting.</span></span>  
> 
>  <span data-ttu-id="9ada1-180">Дополнительные сведения можно найти в разделах:  [sys.dm_hadr_cluster](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-cluster-transact-sql), [sys.dm_hadr_cluster_members](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-cluster-members-transact-sql), [sys.dm_os_cluster_nodes](/sql/relational-databases/system-dynamic-management-views/sys-dm-os-nodes-transact-sql), [sys.dm_hadr_cluster_networks](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-cluster-networks-transact-sql)</span><span class="sxs-lookup"><span data-stu-id="9ada1-180">For more information, see:  [sys.dm_hadr_cluster](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-cluster-transact-sql), [sys.dm_hadr_cluster_members](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-cluster-members-transact-sql), [sys.dm_os_cluster_nodes](/sql/relational-databases/system-dynamic-management-views/sys-dm-os-nodes-transact-sql), [sys.dm_hadr_cluster_networks](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-cluster-networks-transact-sql)</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="9ada1-181">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="9ada1-181">Related Tasks</span></span>  
  
-   [<span data-ttu-id="9ada1-182">Просмотр параметров NodeWeight кворума кластера</span><span class="sxs-lookup"><span data-stu-id="9ada1-182">View Cluster Quorum NodeWeight Settings</span></span>](view-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="9ada1-183">Настройка параметров NodeWeight для кворума кластера</span><span class="sxs-lookup"><span data-stu-id="9ada1-183">Configure Cluster Quorum NodeWeight Settings</span></span>](configure-cluster-quorum-nodeweight-settings.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="9ada1-184">См. также</span><span class="sxs-lookup"><span data-stu-id="9ada1-184">Related Content</span></span>  
  
-   [<span data-ttu-id="9ada1-185">Руководство по решениям режима AlwaysOn в Microsoft SQL Server для обеспечения высокой доступности и аварийного восстановления</span><span class="sxs-lookup"><span data-stu-id="9ada1-185">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="9ada1-186">Проверка конфигурации голосов кворума в мастерах групп доступности AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="9ada1-186">Quorum vote configuration check in AlwaysOn Availability Group Wizards</span></span>](https://blogs.msdn.com/b/sqlalwayson/archive/2012/03/13/quorum-vote-configuration-check-in-alwayson-availability-group-wizards-andy-jing.aspx)  
  
-   <span data-ttu-id="9ada1-187">[Технологии Windows Server: отказоустойчивые кластеры](https://technet.microsoft.com/library/cc732488\(v=WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="9ada1-187">[Windows Server Technologies:  Failover Clusters](https://technet.microsoft.com/library/cc732488\(v=WS.10\).aspx)</span></span>  
  
-   <span data-ttu-id="9ada1-188">[Пошаговое руководство по отказоустойчивым кластерам: настройка кворума в отказоустойчивом кластере](https://technet.microsoft.com/library/cc770620\(WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="9ada1-188">[Failover Cluster Step-by-Step Guide: Configuring the Quorum in a Failover Cluster](https://technet.microsoft.com/library/cc770620\(WS.10\).aspx)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9ada1-189">См. также:</span><span class="sxs-lookup"><span data-stu-id="9ada1-189">See Also</span></span>  
 <span data-ttu-id="9ada1-190">[Аварийное восстановление WSFC с помощью принудительного &#40;кворума SQL Server&#41;](wsfc-disaster-recovery-through-forced-quorum-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="9ada1-190">[WSFC Disaster Recovery through Forced Quorum &#40;SQL Server&#41;](wsfc-disaster-recovery-through-forced-quorum-sql-server.md) </span></span>  
 [<span data-ttu-id="9ada1-191">Отказоустойчивая кластеризация Windows Server (WSFC) с SQL Server</span><span class="sxs-lookup"><span data-stu-id="9ada1-191">Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server</span></span>](windows-server-failover-clustering-wsfc-with-sql-server.md)  
  
  
