---
title: Переименование экземпляра отказоустойчивого кластера SQL Server | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- clusters [SQL Server], virtual servers
- renaming virtual servers
- virtual servers [SQL Server], failover clustering
- failover clustering [SQL Server], virtual servers
ms.assetid: 2a49d417-25fb-4760-8ae5-5871bfb1e6f3
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 397e36931e446861db0fcb899cad30e8c7b1ffc2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87659303"
---
# <a name="rename-a-sql-server-failover-cluster-instance"></a><span data-ttu-id="f2158-102">переименовать экземпляр отказоустойчивого кластера SQL Server</span><span class="sxs-lookup"><span data-stu-id="f2158-102">Rename a SQL Server Failover Cluster Instance</span></span>
  <span data-ttu-id="f2158-103">Если экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] является частью отказоустойчивого кластера, процесс переименования виртуального сервера отличается от процесса переименования изолированного экземпляра.</span><span class="sxs-lookup"><span data-stu-id="f2158-103">When a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance is part of a failover cluster, the process of renaming the virtual server differs from that of renaming a stand-alone instance.</span></span> <span data-ttu-id="f2158-104">Дополнительные сведения см. в статье [Переименование компьютера, на который установлен изолированный экземпляр SQL Server](../../../database-engine/install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f2158-104">For more information, see [Rename a Computer that Hosts a Stand-Alone Instance of SQL Server](../../../database-engine/install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md).</span></span>  
  
 <span data-ttu-id="f2158-105">Имя виртуального сервера всегда совпадает с сетевым именем SQL-сервера (сетевое имя виртуального SQL-сервера).</span><span class="sxs-lookup"><span data-stu-id="f2158-105">The name of the virtual server is always the same as the name of the SQL Network Name (the SQL Virtual Server Network Name).</span></span> <span data-ttu-id="f2158-106">Несмотря на то, что имя виртуального сервера можно изменить, изменить имя экземпляра нельзя.</span><span class="sxs-lookup"><span data-stu-id="f2158-106">Although you can change the name of the virtual server, you cannot change the instance name.</span></span> <span data-ttu-id="f2158-107">Например, можно изменить имя виртуального сервера «VS1\экземпляр1» на другое имя, например «SQL35\экземпляр1», но часть имени, содержащая имя экземпляра (т. е. экземпляр1) останется неизменной.</span><span class="sxs-lookup"><span data-stu-id="f2158-107">For example, you can change a virtual server named VS1\instance1 to some other name, such as SQL35\instance1, but the instance portion of the name, instance1, will remain unchanged.</span></span>  
  
 <span data-ttu-id="f2158-108">Прежде чем приступить к процессу переименования, обратите внимание на следующие пункты.</span><span class="sxs-lookup"><span data-stu-id="f2158-108">Before you begin the renaming process, review the items below.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="f2158-109">не поддерживает переименование серверов, участвующих в репликации, за исключением случаев использования доставки журналов с репликацией.</span><span class="sxs-lookup"><span data-stu-id="f2158-109">does not support renaming servers involved in replication, except in the case of using log shipping with replication.</span></span> <span data-ttu-id="f2158-110">Сервер-получатель в доставке журналов может быть переименован, если сервер-источник окончательно потерян.</span><span class="sxs-lookup"><span data-stu-id="f2158-110">The secondary server in log shipping can be renamed if the primary server is permanently lost.</span></span> <span data-ttu-id="f2158-111">Дополнительные сведения см. в статье [Репликация и доставка журналов (SQL Server)](../../../database-engine/log-shipping/log-shipping-and-replication-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="f2158-111">For more information, see [Log Shipping and Replication &#40;SQL Server&#41;](../../../database-engine/log-shipping/log-shipping-and-replication-sql-server.md).</span></span>  
  
-   <span data-ttu-id="f2158-112">При переименовании виртуального сервера, настроенного для использования зеркального отображения базы данных, прежде чем приступить к переименованию, необходимо отключить зеркальное отображение базы данных, а затем заново установить зеркальное отображение базы данных с новым именем виртуального сервера.</span><span class="sxs-lookup"><span data-stu-id="f2158-112">When renaming a virtual server that is configured to use database mirroring, you must turn off database mirroring before the renaming operation, and then re-establish database mirroring with the new virtual server name.</span></span> <span data-ttu-id="f2158-113">Метаданные для зеркального отображения базы данных не будут обновлены автоматически для отражения нового имени виртуального сервера.</span><span class="sxs-lookup"><span data-stu-id="f2158-113">Metadata for database mirroring will not be updated automatically to reflect the new virtual server name.</span></span>  
  
### <a name="to-rename-a-virtual-server"></a><span data-ttu-id="f2158-114">Переименование виртуального сервера</span><span class="sxs-lookup"><span data-stu-id="f2158-114">To rename a virtual server</span></span>  
  
1.  <span data-ttu-id="f2158-115">С помощью программы «Администратор кластера» измените сетевое имя SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f2158-115">Using Cluster Administrator, change the SQL Network Name to the new name.</span></span>  
  
2.  <span data-ttu-id="f2158-116">Переведите ресурс с этим сетевым именем в режим «вне сети».</span><span class="sxs-lookup"><span data-stu-id="f2158-116">Take the network name resource offline.</span></span> <span data-ttu-id="f2158-117">При этом ресурсы [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и другие зависимые ресурсы переводятся в режим «вне сети».</span><span class="sxs-lookup"><span data-stu-id="f2158-117">This takes the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource and other dependent resources offline as well.</span></span>  
  
3.  <span data-ttu-id="f2158-118">Переведите ресурсы [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] обратно в режим «в сети».</span><span class="sxs-lookup"><span data-stu-id="f2158-118">Bring the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource back online.</span></span>  
  
## <a name="verify-the-renaming-operation"></a><span data-ttu-id="f2158-119">Проверка операции переименования</span><span class="sxs-lookup"><span data-stu-id="f2158-119">Verify the Renaming Operation</span></span>  
 <span data-ttu-id="f2158-120">После того как виртуальный сервер переименован, любые соединения, использовавшие старое имя, должны осуществляться с использованием нового имени.</span><span class="sxs-lookup"><span data-stu-id="f2158-120">After a virtual server has been renamed, any connections that used the old name must now connect using the new name.</span></span>  
  
 <span data-ttu-id="f2158-121">Чтобы убедиться в том, что операция переименования завершена, выберите необходимые данные из `@@servername` или `sys.servers`.</span><span class="sxs-lookup"><span data-stu-id="f2158-121">To verify that the renaming operation has completed, select information from either `@@servername` or `sys.servers`.</span></span> <span data-ttu-id="f2158-122">Функция `@@servername` возвращает новое имя виртуального сервера, а в таблице `sys.servers` отображается новое имя виртуального сервера.</span><span class="sxs-lookup"><span data-stu-id="f2158-122">The `@@servername` function will return the new virtual server name, and the `sys.servers` table will show the new virtual server name.</span></span> <span data-ttu-id="f2158-123">Чтобы проверить правильность отработки отказа с новым именем, попытайтесь создать сбойную ситуацию на ресурсе [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] через другие узлы.</span><span class="sxs-lookup"><span data-stu-id="f2158-123">To verify that the failover process is working correctly with the new name, the user should also try to fail the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource over to the other nodes.</span></span>  
  
 <span data-ttu-id="f2158-124">Для установления соединения с любого узла, расположенного в том же кластере, новое имя можно использовать немедленно.</span><span class="sxs-lookup"><span data-stu-id="f2158-124">For connections from any node in the cluster, the new name can be used almost immediately.</span></span> <span data-ttu-id="f2158-125">Однако для соединений с другого компьютера, использующих новое имя, новое имя не может быть использовано для подключения к серверу до тех пор, пока оно не будет видимо с этого клиентского компьютера.</span><span class="sxs-lookup"><span data-stu-id="f2158-125">However, for connections using the new name from a client computer, the new name cannot be used to connect to the server until the new name is visible to that client computer.</span></span> <span data-ttu-id="f2158-126">До того момента, как новое имя будет распространено по всей сети, может пройти от нескольких секунд до 3-5 минут (в зависимости от конфигурации сети). Кроме того, может потребоваться дополнительное время на то, чтобы старое имя виртуального сервера перестало быть видимо в сети.</span><span class="sxs-lookup"><span data-stu-id="f2158-126">The length of time required for the new name to be propagated across a network can be a few seconds, or as long as 3 to 5 minutes, depending on the network configuration; additional time may be required before the old virtual server name is no longer visible on the network.</span></span>  
  
 <span data-ttu-id="f2158-127">Чтобы уменьшить задержки сетевого распространения операции переименования виртуального сервера, выполните следующие шаги.</span><span class="sxs-lookup"><span data-stu-id="f2158-127">To minimize network propagation delay of a virtual server renaming operation, use the following steps:</span></span>  
  
#### <a name="to-minimize-network-propagation-delay"></a><span data-ttu-id="f2158-128">Минимизация задержки сетевого распространения</span><span class="sxs-lookup"><span data-stu-id="f2158-128">To minimize network propagation delay</span></span>  
  
1.  <span data-ttu-id="f2158-129">Выполните следующие команды в командной строке на узле сервера:</span><span class="sxs-lookup"><span data-stu-id="f2158-129">Issue the following commands from a command prompt on the server node:</span></span>  
  
    ```  
    ipconfig /flushdns  
    ipconfig /registerdns  
    nbtstat -RR  
    ```  
  
## <a name="additional-considerations-after-the-renaming-operation"></a><span data-ttu-id="f2158-130">Дополнительные меры после операции переименования</span><span class="sxs-lookup"><span data-stu-id="f2158-130">Additional considerations after the Renaming Operation</span></span>  
 <span data-ttu-id="f2158-131">После изменения сетевого имени кластера отработки отказа необходимо выполнить проверку и следующие инструкции для включения всех сценариев в агенте [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и службах [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f2158-131">After we rename the network name of failover cluster we need to verify and perform the following instructions to enable all scenarios in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent and [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="f2158-132">\*\* [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] .\*\* После изменения сетевого имени [!INCLUDE[ssASCurrent](../../../includes/ssascurrent-md.md)] экземпляра отказоустойчивого кластера с помощью средства "Администратор кластера Windows" в будущем может произойти сбой.</span><span class="sxs-lookup"><span data-stu-id="f2158-132">**[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]:** After you change the network name of a [!INCLUDE[ssASCurrent](../../../includes/ssascurrent-md.md)] failover cluster instance using Windows Cluster Administrator tool, the future upgrade or uninstall operation might fail.</span></span> <span data-ttu-id="f2158-133">Чтобы устранить эту проблему, обновите запись реестра **имя_кластера** , следуя инструкциям в разделе "решение" [этой](https://go.microsoft.com/fwlink/?LinkId=244002) статьи ( https://go.microsoft.com/fwlink/?LinkId=244002) .</span><span class="sxs-lookup"><span data-stu-id="f2158-133">To resolve this issue update the **ClusterName** registry entry following the instructions in the resolution section of [this](https://go.microsoft.com/fwlink/?LinkId=244002) (https://go.microsoft.com/fwlink/?LinkId=244002).</span></span>  
  
 <span data-ttu-id="f2158-134">\*\* [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Служба агента:\*\* проверьте и выполните следующие дополнительные действия для [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Служба агента:</span><span class="sxs-lookup"><span data-stu-id="f2158-134">**[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent Service:** Verify and perform the below additional actions for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent Service:</span></span>  
  
-   <span data-ttu-id="f2158-135">Исправьте параметры в реестре, если агент SQL Server настроен на пересылку событий.</span><span class="sxs-lookup"><span data-stu-id="f2158-135">Fix the registry settings if SQL Agent is configured for event forwarding.</span></span> <span data-ttu-id="f2158-136">Дополнительные сведения см. в статье [Назначение сервера пересылки событий (среда SQL Server Management Studio)](../../../ssms/agent/designate-an-events-forwarding-server-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="f2158-136">For more information, see [Designate an Events Forwarding Server &#40;SQL Server Management Studio&#41;](../../../ssms/agent/designate-an-events-forwarding-server-sql-server-management-studio.md).</span></span>  
  
-   <span data-ttu-id="f2158-137">Исправьте имена экземпляра главного сервера (MSX) и целевых серверов (TSX), если сетевое имя компьютеров / кластера было изменено.</span><span class="sxs-lookup"><span data-stu-id="f2158-137">Fix the master server (MSX) and target servers (TSX) instance names when machines / cluster network name is renamed.</span></span> <span data-ttu-id="f2158-138">Дополнительные сведения см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="f2158-138">For more information, see the following topics:</span></span>  
  
    -   [<span data-ttu-id="f2158-139">Отключение нескольких целевых серверов от главного</span><span class="sxs-lookup"><span data-stu-id="f2158-139">Defect Multiple Target Servers from a Master Server</span></span>](../../../ssms/agent/defect-multiple-target-servers-from-a-master-server.md)  
  
    -   [<span data-ttu-id="f2158-140">Создание многосерверной среды</span><span class="sxs-lookup"><span data-stu-id="f2158-140">Create a Multiserver Environment</span></span>](../../../ssms/agent/create-a-multiserver-environment.md)  
  
-   <span data-ttu-id="f2158-141">Измените конфигурацию доставки журналов, чтобы для резервного копирования и восстановления журналов использовалось обновленное имя сервера.</span><span class="sxs-lookup"><span data-stu-id="f2158-141">Reconfigure the Log Shipping so that updated server name is used to backup and restore logs.</span></span> <span data-ttu-id="f2158-142">Дополнительные сведения см. в следующих разделах:</span><span class="sxs-lookup"><span data-stu-id="f2158-142">For more information, see the following topics:</span></span>  
  
    -   [<span data-ttu-id="f2158-143">Настройка доставки журналов (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="f2158-143">Configure Log Shipping &#40;SQL Server&#41;</span></span>](../../../database-engine/log-shipping/configure-log-shipping-sql-server.md)  
  
    -   [<span data-ttu-id="f2158-144">Удаление доставки журналов (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="f2158-144">Remove Log Shipping &#40;SQL Server&#41;</span></span>](../../../database-engine/log-shipping/remove-log-shipping-sql-server.md)  
  
-   <span data-ttu-id="f2158-145">Обновите шаги заданий, зависящие от имени сервера.</span><span class="sxs-lookup"><span data-stu-id="f2158-145">Update the Jobsteps that depend on server name.</span></span> <span data-ttu-id="f2158-146">Дополнительные сведения см. в статье [Manage Job Steps](../../../ssms/agent/manage-job-steps.md).</span><span class="sxs-lookup"><span data-stu-id="f2158-146">For more information, see [Manage Job Steps](../../../ssms/agent/manage-job-steps.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f2158-147">См. также:</span><span class="sxs-lookup"><span data-stu-id="f2158-147">See Also</span></span>  
 [<span data-ttu-id="f2158-148">Переименование компьютера, на который установлен изолированный экземпляр SQL Server</span><span class="sxs-lookup"><span data-stu-id="f2158-148">Rename a Computer that Hosts a Stand-Alone Instance of SQL Server</span></span>](../../../database-engine/install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md)  
  
  
