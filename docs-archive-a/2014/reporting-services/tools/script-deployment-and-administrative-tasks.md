---
title: Написание скриптов для задач развертывания и администрирования | Документы Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- scripts [Reporting Services]
- moving reports
- report servers [Reporting Services], duplicating settings
- deploying [Reporting Services], scripts
- copying report server settings
- administrative tasks [Reporting Services]
- duplicating report server environment
- migrating reports [Reporting Services]
- scripts [Reporting Services], deployments
- transferrng reports
- reports [Reporting Services], migrating
ms.assetid: d0416c9e-e3f9-456d-9870-2cfd2c49039b
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 7562bec3211824d5e84441434b4696a44d51fa9b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87665243"
---
# <a name="script-deployment-and-administrative-tasks"></a><span data-ttu-id="8ae2c-102">Написание скриптов для задач развертывания и администрирования</span><span class="sxs-lookup"><span data-stu-id="8ae2c-102">Script Deployment and Administrative Tasks</span></span>
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="8ae2c-103">поддерживают использование сценариев для автоматизации стандартных задач по установке, развертыванию и администрированию.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-103">supports the use of scripts to automate routine installation, deployment, and administrative tasks.</span></span> <span data-ttu-id="8ae2c-104">Развертывание сервера отчетов является многошаговым процессом.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-104">Deploying a report server is a multi-step process.</span></span> <span data-ttu-id="8ae2c-105">Чтобы настроить развертывание, необходимо использовать несколько средств и процессов. Для автоматизации всех задач не существует единой программы или единого подхода.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-105">You must use several tools and processes to configure a deployment; there is no single program or approach that can be used to automate all the tasks.</span></span>  
  
 <span data-ttu-id="8ae2c-106">Не все шаги следует автоматизировать.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-106">Not every step should be automated.</span></span> <span data-ttu-id="8ae2c-107">В некоторых случаях выполнение шага вручную или с помощью графического средства является самым простым и эффективным подходом.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-107">In some cases, performing a step manually or through a graphical tool is the simplest and most effective approach.</span></span> <span data-ttu-id="8ae2c-108">Например, если требуется развернуть большое количество отчетов и моделей, проще скопировать базу данных сервера отчетов, чем писать программный код, который воссоздаст среду сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-108">For example, if you want to deploy a large number of reports and models, it is better to copy the report server databases rather than write code that recreates report server environment.</span></span>  
  
 <span data-ttu-id="8ae2c-109">Некоторые шаги требуют специального программного кода.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-109">Some steps require custom code.</span></span> <span data-ttu-id="8ae2c-110">Например, автоматизировать настройку URL-адресов для веб-службы и диспетчера отчетов можно только путем написания специального кода, который обращается к Инструментарию управления Windows (WMI) сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-110">For example, configuring the URLs for the Web service and Report Manager can be automated, but only if you write custom code that makes calls into the Report Server Windows Management Instrumentation (WMI) provider.</span></span> <span data-ttu-id="8ae2c-111">Избежать написания программного кода на этом шаге можно. Для этого примените средство настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="8ae2c-111">If you do not want to write code, you must use the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool to perform the step.</span></span>  
  
 <span data-ttu-id="8ae2c-112">Чтобы выполнить скрипт, настраивающий сервер отчетов, необходимо иметь права локального администратора на настраиваемом компьютере.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-112">To run script that configures a report server, you must be a local administrator on the computer that you are configuring.</span></span> <span data-ttu-id="8ae2c-113">Дополнительные сведения о подготовке сервера отчетов для удаленного администрирования см. в разделе [Настройка сервера отчетов для удаленного администрирования](../report-server/configure-a-report-server-for-remote-administration.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-113">For more information, see [Configure a Report Server for Remote Administration](../report-server/configure-a-report-server-for-remote-administration.md).</span></span>  
  
 <span data-ttu-id="8ae2c-114">Этот раздел описывает рекомендуемые подходы для автоматизации определенных шагов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-114">This topic describes recommended approaches for automating specific steps.</span></span> <span data-ttu-id="8ae2c-115">Упомянуты несколько программ и программных интерфейсов; описания каждого предоставлены далее в разделе.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-115">Several programs and programmatic interfaces are mentioned; descriptions of each one are provided later in this topic.</span></span>  
  
## <a name="deployment-tasks-and-how-to-automate-them"></a><span data-ttu-id="8ae2c-116">Задачи развертывания и способы их автоматизации</span><span class="sxs-lookup"><span data-stu-id="8ae2c-116">Deployment Tasks and How to Automate Them</span></span>  
 <span data-ttu-id="8ae2c-117">В следующей таблице обобщены задачи по установке и настройке сервера отчетов, необходимые для его развертывания.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-117">The following table summarizes the installation and configuration tasks that are necessary for deploying a report server.</span></span> <span data-ttu-id="8ae2c-118">Эту таблицу можно использовать для сверки конкретной задачи с подходом, позволяющим ее автоматизировать или выполнить полностью автоматически.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-118">You can use the table to match a specific task to an approach that allows you to automate or perform the task unattended.</span></span>  
  
|<span data-ttu-id="8ae2c-119">Задача</span><span class="sxs-lookup"><span data-stu-id="8ae2c-119">Task</span></span>|<span data-ttu-id="8ae2c-120">Подход</span><span class="sxs-lookup"><span data-stu-id="8ae2c-120">Approach</span></span>|  
|----------|--------------|  
|<span data-ttu-id="8ae2c-121">Установить службы [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8ae2c-121">Install [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span>|<span data-ttu-id="8ae2c-122">Для выполнения автоматической установки программу установки можно запустить из командной строки.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-122">You can run setup from the command line to perform an unattended installation.</span></span><br /><br /> <span data-ttu-id="8ae2c-123">Программу установки можно использовать как для установки, так и для настройки сервера отчетов, но только в случае, если указаны параметры конфигурации по умолчанию и система соответствует всем требованиям для этого типа установки.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-123">You can use Setup to both install and configure a report server, but only if you specify the default configuration option and your system meets all the requirements for this installation type.</span></span> <span data-ttu-id="8ae2c-124">Если установка конфигурации по умолчанию невозможна, необходимо установить только файлы.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-124">If you cannot install the default configuration, you must perform a files-only installation.</span></span>|  
|<span data-ttu-id="8ae2c-125">Настройте учетную запись службы.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-125">Configure the service account.</span></span>|<span data-ttu-id="8ae2c-126">Начальная конфигурация этой учетной записи службы выполняется программой установки.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-126">The service account is initially configured through Setup.</span></span> <span data-ttu-id="8ae2c-127">Чтобы автоматизировать сделанные в учетной записи службы изменения как задачу, которая будет выполнена после установки, необходимо записать пользовательский код, выполняющий вызовы к поставщику WMI сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-127">To automate changes to the service account as a post-Setup task, you must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="8ae2c-128">Для программной настройки учетной записи службы не существует специальных программ командной строки или шаблонов скриптов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-128">There are no command-prompt utilities or script templates for configuring the service account programmatically.</span></span><br /><br /> <span data-ttu-id="8ae2c-129">Если автоматизировать этот шаг путем создания программного кода невозможно, то учетную запись можно настроить вручную при помощи средства настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="8ae2c-129">If coding requirements prevent you from automating this step, you can easily configure the account manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="8ae2c-130">Дополнительные сведения см. в разделе [Настройка учетной записи службы (диспетчер конфигураций служб SSRS)](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-130">For more information, see [Configure a Service Account &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="8ae2c-131">Настройте URL-адреса веб-службы сервера отчетов и диспетчера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-131">Configure the Report Server Web service and Report Manager URLs.</span></span>|<span data-ttu-id="8ae2c-132">Необходимо записать специальный программный код, обращающийся к поставщику WMI сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-132">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="8ae2c-133">Для настройки URL-адресов не существует специальных программ командной строки или шаблонов скриптов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-133">There are no command line utilities or script templates for configuring the URLs.</span></span><br /><br /> <span data-ttu-id="8ae2c-134">Если вы хотите избежать написания кода, то URL-адреса можно настроить вручную при помощи средства настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="8ae2c-134">If you want to avoid writing code, you can configure the URLs manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="8ae2c-135">Дополнительные сведения см. в статье [Настройка URL-адреса (диспетчер конфигурации служб SSRS)](../install-windows/configure-a-url-ssrs-configuration-manager.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-135">For more information, see [Configure a URL  &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="8ae2c-136">Создание базы данных сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-136">Create the report server database.</span></span>|<span data-ttu-id="8ae2c-137">Необходимо записать специальный программный код, обращающийся к поставщику WMI сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-137">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="8ae2c-138">Для создания баз данных сервера отчетов и роли RSExecRole не существует специальных программ командной строки или шаблонов скриптов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-138">There are no command-prompt utilities or script templates for creating the report server databases and RSExecRole.</span></span><br /><br /> <span data-ttu-id="8ae2c-139">Если вы хотите избежать написания кода, то базу данных можно создать вручную при помощи средства настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="8ae2c-139">If you want to avoid writing code, you can create the database manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="8ae2c-140">Дополнительные сведения см. в разделе [Создание базы данных сервера отчетов, работающего в собственном режиме (диспетчер конфигураций служб SSRS)](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-140">For more information, see [Create a Native Mode Report Server Database  &#40;SSRS Configuration Manager&#41;](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md).</span></span>|  
|<span data-ttu-id="8ae2c-141">Настройка подключения к базе данных сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-141">Configure the report server database connection.</span></span>|<span data-ttu-id="8ae2c-142">При изменении строки подключения, учетной записи, пароля или типа проверки подлинности следует запустить программу **rsconfig** для настройки соединения.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-142">If you are changing the connection string, account or password, or the authentication type, run the **rsconfig** utility to configure the connection.</span></span> <span data-ttu-id="8ae2c-143">Дополнительные сведения см. в разделах [Настройка подключения к базе данных сервера отчетов (диспетчер конфигураций служб Reporting Services)](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md) и [Программа rsconfig (SSRS)](rsconfig-utility-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-143">For more information, see [Configure a Report Server Database Connection  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md) and [rsconfig Utility &#40;SSRS&#41;](rsconfig-utility-ssrs.md).</span></span><br /><br /> <span data-ttu-id="8ae2c-144">Программу rsconfig.exe нельзя использовать для создания или обновления базы данных.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-144">You cannot use rsconfig.exe to create or upgrade the database.</span></span> <span data-ttu-id="8ae2c-145">База данных и роль RSExecRole должны быть созданы ранее.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-145">The database and RSExecRole must already exist.</span></span>|  
|<span data-ttu-id="8ae2c-146">Настройка масштабного развертывания.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-146">Configure a scale-out deployment.</span></span>|<span data-ttu-id="8ae2c-147">Для настройки масштабного развертывания выберите один из следующих подходов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-147">Choose from the following approaches to automate scale-out deployment:</span></span><br /><br /> <span data-ttu-id="8ae2c-148">Для соединения экземпляров сервера отчетов с существующим экземпляром запустите программу rskeymgmt.exe.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-148">Run the rskeymgmt.exe utility to join report server instances to an existing installation.</span></span> <span data-ttu-id="8ae2c-149">Дополнительные сведения см. в разделе [Добавление и удаление ключей шифрования для масштабного развертывания (диспетчер конфигураций служб SSRS)](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-149">For more information, see [Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md).</span></span><br /><br /> <span data-ttu-id="8ae2c-150">Напишите специальный программный код, обращающийся к поставщику WMI сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-150">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="8ae2c-151">Резервное копирование ключей шифрования.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-151">Backup encryption keys.</span></span>|<span data-ttu-id="8ae2c-152">Для автоматизации резервного копирования ключей шифрования выберите один из следующих подходов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-152">Choose from the following approaches to automate encryption key backup:</span></span><br /><br /> <span data-ttu-id="8ae2c-153">Для создания резервной копии ключей шифрования запустите программу rskeymgmt.exe.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-153">Run the rskeymgmt.exe utility to back up the keys.</span></span> <span data-ttu-id="8ae2c-154">Дополнительные сведения см. в разделе [Резервное копирование и восстановление ключей шифрования служб Reporting Services](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-154">For more information, see [Back Up and Restore Reporting Services Encryption Keys](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md).</span></span><br /><br /> <span data-ttu-id="8ae2c-155">Напишите специальный программный код, обращающийся к поставщику WMI сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-155">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="8ae2c-156">Настройка электронной почты сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-156">Configure Report Server E-mail.</span></span>|<span data-ttu-id="8ae2c-157">Напишите пользовательский программный код, обращающийся к поставщику WMI служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="8ae2c-157">Write custom code that runs against the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider.</span></span> <span data-ttu-id="8ae2c-158">Поставщик поддерживает подмножество установок конфигурации электронной почты.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-158">The provider supports a subset of the e-mail configuration settings.</span></span><br /><br /> <span data-ttu-id="8ae2c-159">Хотя файл RSReportServer.config содержит все установки, не используйте этот файл автоматически.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-159">Although the RSReportServer.config file includes all the settings, do not use the file in an automated manner.</span></span> <span data-ttu-id="8ae2c-160">В особенности не используйте пакетный файл для копирования файла на другой сервер отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-160">Specifically, do not use a batch file to copy the file to another report server.</span></span> <span data-ttu-id="8ae2c-161">Каждый файл конфигурации содержит значения, определенные для текущего экземпляра.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-161">Each configuration file includes values that are specific to the current instance.</span></span> <span data-ttu-id="8ae2c-162">Эти значения не будут допустимыми на других экземплярах сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-162">Those values will not be valid on other report server instances.</span></span><br /><br /> <span data-ttu-id="8ae2c-163">Дополнительные сведения о параметрах см. в разделе [Настройка сервера отчетов для доставки электронной почты &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-163">For more information about the settings, see [Configure a Report Server for E-Mail Delivery &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="8ae2c-164">Настройка учетной записи автоматического выполнения.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-164">Configure the unattended execution account.</span></span>|<span data-ttu-id="8ae2c-165">Для автоматизации настройки учетной записи автоматического выполнения выберите один из следующих подходов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-165">Choose from the following approaches to automate unattended processing account configuration:</span></span><br /><br /> <span data-ttu-id="8ae2c-166">Запустите программу rsconfig.exe для настройки учетной записи.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-166">Run the rsconfig.exe utility to configure the account.</span></span> <span data-ttu-id="8ae2c-167">Дополнительные сведения см. в разделе [Настройка учетной записи автоматического выполнения &#40;диспетчер конфигурации служб SSRS&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-167">For more information, see [Configure the Unattended Execution Account &#40;SSRS Configuration Manager&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span></span><br /><br /> <span data-ttu-id="8ae2c-168">Напишите специальный программный код, обращающийся к поставщику WMI сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-168">Write custom code that makes calls into the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="8ae2c-169">Развертывание существующего содержимого на другом сервере отчетов, включая иерархию папок, назначение ролей, отчеты, подписки, расписания, источники данных и ресурсы.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-169">Deploy existing content on another report server, including the folder hierarchy, role assignments, reports, subscriptions, schedules, data sources, and resources.</span></span>|<span data-ttu-id="8ae2c-170">Лучший способ повторно создать существующую среду сервера отчетов — скопировать базу данных сервера отчетов в новый экземпляр сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-170">The best way to re-create an existing report server environment is to copy the report server database to a new report server instance.</span></span><br /><br /> <span data-ttu-id="8ae2c-171">Альтернативный подход заключается в написании специального кода, который программным путем заново создает существующее содержимое сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-171">An alternative approach is to write custom code that recreates existing report server content programmatically.</span></span> <span data-ttu-id="8ae2c-172">Однако учтите, что подписки, моментальные снимки отчетов и журнал отчетов невозможно создать повторно программным способом.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-172">However, be aware that subscriptions, report snapshots, and report history cannot be recreated programmatically.</span></span><br /><br /> <span data-ttu-id="8ae2c-173">В некоторых случаях развертывание может выиграть от применения обоих методов (то есть можно восстановить базу данных сервера отчетов, а затем записать программный код, изменяющий ее для конкретного экземпляра).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-173">Some deployments can benefit from using both techniques together (that is, restore a report server database, and then run custom code that modifies the report server database for a specific installation).</span></span><br /><br /> <span data-ttu-id="8ae2c-174"> Подробный пример см. в разделе [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-174">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span><br /><br /> <span data-ttu-id="8ae2c-175">Дополнительные сведения о перемещении базы данных сервера отчетов см. в разделе [Перемещение баз данных сервера отчетов на другой компьютер (собственный режим служб SSRS)](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-175">For more information about relocating a report server database, see [Moving the Report Server Databases to Another Computer &#40;SSRS Native Mode&#41;](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md).</span></span> <span data-ttu-id="8ae2c-176">Дополнительные сведения о создании среды сервера отчетов программным способом см. в подразделе «Миграция содержимого и папок сервера отчетов с помощью скрипта» этого раздела.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-176">For more information about creating report serer environment programmatically, see the section "Using Script to Migrate Report Server Content and Folders" in this topic.</span></span>|  
  
## <a name="tools-and-technologies-for-automating-server-deployment"></a><span data-ttu-id="8ae2c-177">Инструменты и технологии для автоматизации развертывания сервера</span><span class="sxs-lookup"><span data-stu-id="8ae2c-177">Tools and Technologies for Automating Server deployment</span></span>  
 <span data-ttu-id="8ae2c-178">В следующем списке обобщаются программы и интерфейсы, которые могут использоваться для автоматизации задач развертывания и обслуживания.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-178">The following list summarizes the programs and interfaces that can be used to automate deployment and maintenance tasks:</span></span>  
  
-   <span data-ttu-id="8ae2c-179">Программа установки может запускаться в автоматическом режиме для установки и (в некоторых случаях) настройки компонентов сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-179">The Setup program can be run in unattended mode to install and sometimes configure report server components.</span></span> <span data-ttu-id="8ae2c-180">Чтобы программа установки настроила экземпляр сервера отчетов, следует использовать параметр установки «Только файлы».</span><span class="sxs-lookup"><span data-stu-id="8ae2c-180">You must use the Files-Only installation option to have Setup configure a report server instance.</span></span>  
  
-   <span data-ttu-id="8ae2c-181">Поставщик WMI служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и программы командной строки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] можно использовать для локальной и удаленной настройки сервера.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-181">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider and [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] command line utilities can be used for local and remote server configuration.</span></span>  
  
     <span data-ttu-id="8ae2c-182">Поставщик WMI служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] предоставляет классы, свойства и методы, реализующие управление всеми аспектами установки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] , — задание учетной записи службы, настройка URL-адресов, создание и настройка базы данных сервера отчетов или настройка сервера отчетов для доставки отчетов по электронной почте.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-182">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider exposes classes, properties, and methods that allow you to configure all aspects of a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation including specifying the service account, configuring URLs, creating and configuring the report server database, or configuring a report server for e-mail delivery.</span></span> <span data-ttu-id="8ae2c-183">Для использования поставщика WMI необходимо записать специальный программный код или скрипт.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-183">You must write custom code or script to use the WMI provider.</span></span> <span data-ttu-id="8ae2c-184">Дополнительные сведения см. в разделе [Доступ к поставщику WMI для служб Reporting Services](access-the-reporting-services-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-184">For more information, see [Access the Reporting Services WMI Provider](access-the-reporting-services-wmi-provider.md).</span></span>  
  
     <span data-ttu-id="8ae2c-185">Альтернативой написанию программного кода является использование программ командной строки (rsconfig.exe и rskeymgmt.exe).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-185">An alternative to writing code is to use the command line utilities (rsconfig.exe and rskeymgmt.exe).</span></span> <span data-ttu-id="8ae2c-186">Можно записать пакетный файл, запускающий эти программы.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-186">You can write batch files that run the utilities.</span></span> <span data-ttu-id="8ae2c-187">Программы могут использоваться для автоматизации не всех задач настройки.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-187">You can use the utilities to automate some but not all configuration tasks.</span></span>  
  
-   <span data-ttu-id="8ae2c-188">Средство обработки скриптов сервера отчетов (rs.exe) может выполнять пользовательский код [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] для повторного создания или перемещения существующего содержимого с одного сервера отчетов на другой.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-188">The report server script host tool (rs.exe) can run custom [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] code that you might write to re-create or move existing content from one report server to another.</span></span> <span data-ttu-id="8ae2c-189">При этом подходе скрипт записывается на языке [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], сохраняется в виде RSS-файла и с помощью программы rs.exe запускается на сервере отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-189">With this approach, you write script in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], save it as an .rss file, and use rs.exe to run the script on the target report server.</span></span> <span data-ttu-id="8ae2c-190">Написанный скрипт может обращаться к веб-службе сервера отчетов по протоколу SOAP.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-190">The script you write can call the SOAP interface to the Report Server Web service.</span></span> <span data-ttu-id="8ae2c-191">При создании скриптов развертывания данный подход позволяет повторно создавать пространство имен и содержимое папок сервера отчетов, а также политики безопасности на основе ролей.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-191">Deployment scripts are written using this approach because it allows you to re-create a report server folder namespace and content, and re-create role-based security.</span></span>  
  
-   <span data-ttu-id="8ae2c-192">В выпуске [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] появились командлеты PowerShell для режима интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-192">The [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] release introduced PowerShell cmdlets for SharePoint integrated mode.</span></span> <span data-ttu-id="8ae2c-193">PowerShell можно использовать для настройки и администрирования интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-193">You can use PowerShell to configure and administer the SharePoint integration.</span></span>  <span data-ttu-id="8ae2c-194">Дополнительные сведения см. в разделе [Командлеты PowerShell для служб Reporting Services в режиме интеграции с SharePoint](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-194">For more information, see [PowerShell cmdlets for Reporting Services SharePoint Mode](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md).</span></span>  
  
## <a name="use-scripts-to-migrate-report-server-content-and-folders"></a><span data-ttu-id="8ae2c-195">Миграция содержимого и папок сервера отчетов с помощью скриптов</span><span class="sxs-lookup"><span data-stu-id="8ae2c-195">Use Scripts to Migrate Report Server Content and Folders</span></span>  
 <span data-ttu-id="8ae2c-196">Можно записать скрипт, дублирующие среду сервера отчетов на другом экземпляре сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-196">You can write scripts that duplicate a report server environment on another report server instance.</span></span> <span data-ttu-id="8ae2c-197">Скрипты развертывания, как правило, пишутся на языке [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] , а затем выполняются с помощью сервера скриптов сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-197">Deployment scripts are generally written in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and then processed using the report server script host utility.</span></span>  
  
 <span data-ttu-id="8ae2c-198"> Подробный пример см. в разделе [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-198">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
 <span data-ttu-id="8ae2c-199">Скрипты позволяют копировать с одного сервера на другой папки, общие источники данных, ресурсы, отчеты, назначение ролей и настройки.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-199">Use scripts to copy folders, shared data sources, resources, reports, role assignments, and settings from one server to another.</span></span> <span data-ttu-id="8ae2c-200">Если есть необходимость воссоздания пространства имен сервера отчетов, они пишутся для одного экземпляра сервера отчетов, а затем выполняются на другом.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-200">You write a script for one report server instance, and then run it on another server to re-create the report server namespace.</span></span> <span data-ttu-id="8ae2c-201">Если развертывание служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] выполняется на нескольких серверах отчетов, то для одинаковой их настройки один и тот же скрипт выполняется на каждом из серверов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-201">If you have multiple report servers in your [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] deployment, you can run the script on each server individually to configure all servers in the same way.</span></span>  
  
 <span data-ttu-id="8ae2c-202">Следующий перечень описывает шаги, необходимые для перемещения отчетов с одного сервера на другой.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-202">The following list describes the steps for migrating reports from one server to another.</span></span>  
  
1.  <span data-ttu-id="8ae2c-203">Присвойте переменной скрипта URL-адрес исходного сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-203">Set your script variable to the URL of the source report server.</span></span>  
  
2.  <span data-ttu-id="8ae2c-204">Воспользуйтесь методами <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> и <xref:ReportService2010.ReportingService2010.GetProperties%2A> для получения определения и свойств отчета.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-204">Use the <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> and <xref:ReportService2010.ReportingService2010.GetProperties%2A> methods to retrieve the report definition and the properties of the report.</span></span>  
  
3.  <span data-ttu-id="8ae2c-205">Присвойте URL-адресу значение, указывающее на целевой сервер.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-205">Set the URL to point to the destination server.</span></span>  
  
4.  <span data-ttu-id="8ae2c-206">Воспользуйтесь методом <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> , передав ему свойства, возвращенные методом <xref:ReportService2010.ReportingService2010.GetProperties%2A> , и определение отчета, возвращенное методом <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-206">Use <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> method, passing the properties returned from <xref:ReportService2010.ReportingService2010.GetProperties%2A> and the report definition returned by <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>.</span></span>  
  
 <span data-ttu-id="8ae2c-207">Пользуясь методами get и create, можно выполнить аналогичные шаги для переноса настроек, папок, общих источников данных и ресурсов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-207">By using a combination of get and create methods, you can perform similar steps to migrate settings, folders, shared data sources, and resources.</span></span> <span data-ttu-id="8ae2c-208">Дополнительные сведения о доступных методах см. в разделе [Технический справочник (службы SSAS)](../technical-reference-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-208">For more information about the methods available to you, see [Technical Reference &#40;SSRS&#41;](../technical-reference-ssrs.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8ae2c-209">Если учетные данные не указаны явным образом, то скрипты выполняются от имени пользователя [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows, запустившего скрипт.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-209">Scripts run under the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials of the user running the script unless credentials are explicitly set.</span></span>  
  
 <span data-ttu-id="8ae2c-210">Дополнительные сведения о форматировании и выполнении файлов скриптов см. в разделе [Создание скриптов с помощью программы rs.exe и веб-службы](script-with-the-rs-exe-utility-and-the-web-service.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-210">For more information about how to format and run a script file, see [Script with the rs.exe Utility and the Web Service](script-with-the-rs-exe-utility-and-the-web-service.md).</span></span>  
  
## <a name="using-scripts-to-set-server-properties"></a><span data-ttu-id="8ae2c-211">Настройка свойств сервера с помощью сценариев</span><span class="sxs-lookup"><span data-stu-id="8ae2c-211">Using Scripts to Set Server Properties</span></span>  
 <span data-ttu-id="8ae2c-212">Можно записать сценарии, которые зададут системные свойства на сервере отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-212">You can write scripts that set system properties on the report server.</span></span> <span data-ttu-id="8ae2c-213">Следующий скрипт [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET иллюстрирует один из способов установки свойств.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-213">The following [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET script shows one way to set properties.</span></span> <span data-ttu-id="8ae2c-214">Этот сценарий отключает элемент управления RSClientPrint ActiveX, но можно заменить значения `EnableClientPrinting` и `False` любым допустимым именем свойства и значением.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-214">This example disables the RSClientPrint ActiveX control, but you can replace `EnableClientPrinting` and `False` with any valid property name and value.</span></span> <span data-ttu-id="8ae2c-215">Полный список свойств сервера см. в разделе [Report Server System Properties](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-215">To view a complete list of server properties, see [Report Server System Properties](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md).</span></span>  
  
 <span data-ttu-id="8ae2c-216">Чтобы использовать скрипт, сохраните его в файл с расширением RSS, а затем воспользуйтесь программой командной строки rs.exe для запуска файла на сервере отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-216">To use the script, save it to a file that has an .rss extension, and then use the rs.exe command prompt utility to run the file on the report server.</span></span> <span data-ttu-id="8ae2c-217">Скрипт не компилируется, поэтому необязательно иметь установку [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8ae2c-217">The script is not compiled, so it is not necessary to have an installation of [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="8ae2c-218">В этом примере предполагается, что пользователь имеет необходимые разрешения на локальном компьютере, на котором находится сервер отчетов.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-218">This example assumes that you have permissions on the local computer that hosts the report server.</span></span> <span data-ttu-id="8ae2c-219">Если пользователь не вошел в систему под учетной записью, имеющей необходимые разрешения, необходимо указать сведения об учетной записи с помощью дополнительных аргументов командной строки.</span><span class="sxs-lookup"><span data-stu-id="8ae2c-219">If you are not logged on under an account that has permissions, you must specify account information through additional command line arguments.</span></span> <span data-ttu-id="8ae2c-220">Дополнительные сведения см. в разделе [Программа RS.exe (SSRS)](rs-exe-utility-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-220">For more information, see [RS.exe Utility &#40;SSRS&#41;](rs-exe-utility-ssrs.md).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="8ae2c-221"> Подробный пример см. в разделе [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span><span class="sxs-lookup"><span data-stu-id="8ae2c-221">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
```vb
Public Sub Main()  
        Dim props(0) As [Property]  
        Dim setProp As New [Property]  
        setProp.Name = "EnableClientPrinting"  
        setProp.Value = "False"   
        props(0) = setProp  
        Try  
            rs.SetSystemProperties(props)  
        Catch ex As System.Web.Services.Protocols.SoapException  
            Console.Write(ex.Detail.InnerXml)  
        Catch e as Exception  
            Console.Write(e.Message)  
        End Try  
End Sub  
```  
  
## <a name="see-also"></a><span data-ttu-id="8ae2c-222">См. также:</span><span class="sxs-lookup"><span data-stu-id="8ae2c-222">See Also</span></span>  
 <span data-ttu-id="8ae2c-223">[Метод GenerateDatabaseCreationScript (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-223">[GenerateDatabaseCreationScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span></span>  
 <span data-ttu-id="8ae2c-224">[Метод GenerateDatabaseRightsScript (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-224">[GenerateDatabaseRightsScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span></span>  
 <span data-ttu-id="8ae2c-225">[Метод GenerateDatabaseUpgradeScript (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-225">[GenerateDatabaseUpgradeScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span></span>  
 <span data-ttu-id="8ae2c-226">[Установка SQL Server 2014 из командной строки](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-226">[Install SQL Server 2014 from the Command Prompt](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span></span>  
 <span data-ttu-id="8ae2c-227">[Установка сервера отчетов служб Reporting Services в собственном режиме](../install-windows/install-reporting-services-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-227">[Install Reporting Services Native Mode Report Server](../install-windows/install-reporting-services-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="8ae2c-228">[Сервер отчетов служб Reporting Services (основной режим)](../report-server/reporting-services-report-server-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-228">[Reporting Services Report Server &#40;Native Mode&#41;](../report-server/reporting-services-report-server-native-mode.md) </span></span>  
 <span data-ttu-id="8ae2c-229">[Программы командной строки сервера отчетов (службы SSRS)](report-server-command-prompt-utilities-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-229">[Report Server Command Prompt Utilities &#40;SSRS&#41;](report-server-command-prompt-utilities-ssrs.md) </span></span>  
 <span data-ttu-id="8ae2c-230">[Планирование поддержки Reporting Services и Power View в браузере &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span><span class="sxs-lookup"><span data-stu-id="8ae2c-230">[Planning for Reporting Services and Power View Browser Support &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span></span>  
 [<span data-ttu-id="8ae2c-231">Инструментальные средства служб Reporting Services</span><span class="sxs-lookup"><span data-stu-id="8ae2c-231">Reporting Services Tools</span></span>](reporting-services-tools.md)  
