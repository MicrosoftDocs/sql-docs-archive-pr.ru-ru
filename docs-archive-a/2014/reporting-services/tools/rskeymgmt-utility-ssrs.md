---
title: Программа rskeymgmt (SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- report servers [Reporting Services], encryption
- joining report server instances [SQL Server]
- report server scale-out deployments [Reporting Services]
- cryptography [Reporting Services]
- multiple report server instances
- command prompt utilities [Reporting Services]
- report servers [Reporting Services], scale-out deployments
- encryption [Reporting Services]
- rskeymgmt utility
- scale-out deployments [Reporting Services]
ms.assetid: 53f1318d-bd2d-4c08-b19f-c8b698b5b3d3
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: ae4bdd6656cf5b29f8fd40fcf730f49a6de8f32e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87735989"
---
# <a name="rskeymgmt-utility-ssrs"></a>Программа rskeymgmt (SSRS)
  Извлекает, восстанавливает, создает и удаляет симметричный ключ, используемый для защиты важных данных сервера отчетов от несанкционированного доступа. Эта программа также используется для соединения экземпляров сервера отчетов в конфигурацию с масштабным развертыванием. *Конфигурация сервера отчетов с масштабным развертыванием* означает множество экземпляров сервера отчетов, которые совместно используют одну базу данных сервера отчетов.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
      rskeymgmt {-?}  
{-eextract}  
{-aapply}  
{-ddeleteall}  
{-srecreatekey}  
{-rremoveinstancekey}  
{-jjoinfarm}  
{-iinstance}  
{-ffile}  
{-pencryptionpassword}  
{-mremotecomputer}  
{-ninstancenameofremotecomputer}  
{-uadministratoruseraccount}  
{-vadministratorpassword}  
{-ttrace}  
```  
  
## <a name="arguments"></a>Аргументы  
 **-?**  
 Показывает синтаксис аргументов **rskeymgmt** .  
  
 **-e**  
 Извлекает симметричный ключ, используемый для шифрования и расшифровки данных для экземпляра сервера отчетов, чтобы его можно было скопировать в файл.  
  
 Этот аргумент не принимает значения. Однако, чтобы закончить извлечение, в командную строку необходимо включить дополнительные аргументы. Это аргументы `-f` и `-p`.  
  
 **-a**  
 Заменяет существующий симметричный ключ копией, содержащейся в файле резервной копии, защищенном паролем. Обновляются все экземпляры симметричного ключа.  
  
 Этот аргумент не принимает значения. Однако, чтобы выбрать файл, содержащий ключ, который будет применен, в командную строку необходимо включить дополнительные аргументы. Аргументы, которые можно указать, включают `-f` и `-p`.  
  
 **-d**  
 Удаляет все экземпляры симметричного ключа и все зашифрованные данные в базе данных сервера отчетов. Этот аргумент не принимает значения.  
  
 `-s`  
 Формирует новый симметричный ключ и повторно шифрует все зашифрованное содержимое с его помощью. Повторно создаются все экземпляры симметричного ключа.  
  
 `-j`  
 Настраивает удаленный экземпляр сервера отчетов для совместного использования базы данных сервера отчетов, которая используется локальным экземпляром сервера отчетов.  
  
 **-r**  *installationID*  
 Удаляет сведения о симметричном ключе для указанного экземпляра сервера отчетов, удаляя таким образом сервер отчетов из конфигурации с масштабным развертыванием. Идентификатор *installationID* — это значение идентификатора GUID, которое находится в файле RSReportserver.config.  
  
 `-f`  *file*  
 Указывает полный путь к файлу, в котором хранится резервная копия симметричных ключей.  
  
 Для **rskeymgmt -e**в указанный файл записывается симметричный ключ.  
  
 Для **rskeymgmt -a**значение симметричного ключа, которое хранится в файле, применяется к экземпляру сервера отчетов.  
  
 `-p`  *пароль*  
 (Необходим для `-f`.) Определяет пароль, используемый для создания резервной копии или применения симметричного ключа. Это значение не может быть пустым.  
  
 `-i`  
 Определяет локальный экземпляр сервера отчетов. Этот аргумент необязателен, если сервер отчетов установлен на экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] по умолчанию (значение по умолчанию для аргумента `-i` — MSSQLSERVER). Если сервер отчетов установлен как именованный экземпляр, аргумент `-i` является обязательным.  
  
 `-m`  
 Указывает имя удаленного компьютера, на котором размещается экземпляр сервера отчетов, присоединяемый к конфигурации сервера отчетов с масштабным развертыванием. Используйте имя компьютера, которое идентифицирует его в сети.  
  
 `-n`  
 Указывает имя экземпляра сервера отчетов на удаленном компьютере. Этот аргумент необязателен, если сервер отчетов установлен на экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] по умолчанию (значение по умолчанию для аргумента `-n` — MSSQLSERVER). Если сервер отчетов установлен как именованный экземпляр, аргумент `-n` является обязательным.  
  
 `-u`  *UserAccount*  
 Указывает учетную запись администратора на удаленном компьютере, который присоединяется к масштабному развертыванию. Если учетная запись не указана, используются учетные данные текущего пользователя.  
  
 `-v`  *пароль*  
 (Необходим для `-u`.) Указывает пароль учетной записи администратора на удаленном компьютере, который присоединяется к конфигурации с масштабным развертыванием.  
  
 **-t**  *Трассировка*  
 Выводит сообщения об ошибках в журнал трассировки. Этот аргумент не принимает значения. Дополнительные сведения см. в статье [Report Server Service Trace Log](../report-server/report-server-service-trace-log.md).  
  
## <a name="permissions"></a>Разрешения  
 Для запуска этого средства необходимо быть локальным администратором. Запускать его необходимо локально на компьютере, где размещается сервер отчетов. Программа rskeymgmt работает с локальным экземпляром сервера отчетов Windows (программа не может подключиться к удаленным экземплярам службы сервера отчетов Windows, и поэтому она не может использоваться для управления ключами шифрования удаленного экземпляра сервера отчетов).  
  
> [!NOTE]  
>  При использовании аргументов `-u` и `-v` убедитесь, что указана учетная запись, которая имеет разрешения администратора на удаленном компьютере.  
  
## <a name="examples"></a>Примеры  
 В следующих примерах показаны способы использования **rskeymgmt**. Также показано, как извлечь, восстановить и удалить ключи шифрования и как настроить конфигурацию сервера отчетов с масштабным развертыванием.  
  
#### <a name="extracting-encryption-keys"></a>Извлечение ключей шифрования  
 В этом примере показано, как создать резервную копию ключа шифрования и сохранить ее в защищенном паролем файле на гибком диске. Если сервер отчетов установлен на именованный экземпляр, добавьте аргумент `-i`.  
  
```  
rskeymgmt -e -f a:\backupkey\keys -p <password>  
```  
  
#### <a name="restoring-encryption-keys"></a>Восстановление ключей шифрования из копии  
 В этом примере показано, как заменить ключ шифрования. Необходимо указать местоположение резервной копии ключа и пароль, который разблокирует файл.  
  
```  
rskeymgmt -a -f a:\backupkey\keys -p <password>  
```  
  
#### <a name="deleting-encryption-keys-and-encrypted-content"></a>Удаление ключей шифрования и зашифрованного содержимого  
 В этом примере показано, как удалить все ключи шифрования, сохраненные на сервере отчетов. Если сервер отчетов установлен в конфигурации с масштабным развертыванием, то будут удалены ключи шифрования для всех экземпляров сервера отчетов, включенных в конфигурацию. При удалении ключа шифрования удаляются также все зашифрованные значения, существующие в базе данных сервера отчетов. Дополнительные сведения о зашифрованном содержимом см. в разделе [Хранение зашифрованных данных сервера отчетов (диспетчер конфигурации служб SSRS)](../install-windows/ssrs-encryption-keys-store-encrypted-report-server-data.md).  
  
```  
rskeymgmt -d  
```  
  
#### <a name="joining-a-remote-report-server-named-instance-to-a-scale-out-deployment"></a>Присоединение удаленного именованного экземпляра сервера отчетов к конфигурации с масштабным развертыванием  
 В этом примере показано, как добавить экземпляр сервера отчетов, установленный на удаленном компьютере, к конфигурации сервера отчетов с масштабным развертыванием. Эту команду необходимо запустить на одном из компьютеров, который уже настроен на использование общей базы данных. Аргументы команды указывают удаленный экземпляр сервера отчетов, который нужно присоединить к конфигурации с масштабным развертыванием.  
  
```  
rskeymgmt -j -m <remotecomputer> -n <namedreportserverinstance> -u <administratoraccount> -v <administratorpassword>  
```  
  
> [!NOTE]  
>  Конфигурация сервера отчетов с масштабным развертыванием означает модель развертывания, где несколько экземпляров сервера отчетов совместно используют одну базу данных сервера отчетов. База данных сервера отчетов может использоваться любым экземпляром сервера отчетов, который хранит в ней свои симметричные ключи. Например, если база данных сервера отчетов содержит сведения о ключах для трех экземпляров сервера отчетов, все три экземпляра считаются элементами одной конфигурации с масштабным развертыванием.  
  
#### <a name="joining-report-server-instances-on-the-same-computer"></a>Объединение экземпляров сервера отчетов на одном компьютере  
 Можно создать конфигурацию с масштабным развертыванием из нескольких экземпляров сервера отчетов, установленных на одном компьютере. При объединении экземпляров сервера отчетов, установленных локально, нельзя использовать аргументы `-u` и `-v`. Аргументы `-u` и `-v` используются только при подсоединении экземпляра с удаленного компьютера. Если задать аргументы, появится такая ошибка: "Учетные данные пользователя не могут использоваться для локальных подключений".  
  
 Следующий пример показывает синтаксис для создания масштабного развертывания из нескольких локальных экземпляров. В этом примере <`initializedinstance`> — имя экземпляра, который уже инициализирован для использования базы данных сервера отчетов, а <`newinstance`> — имя экземпляра, который необходимо добавить в развертывание:  
  
```  
rskeymgmt -j -i <initializedinstance> -m <computer name> -n <newinstance>  
```  
  
#### <a name="removing-encryption-keys-for-a-single-report-server-in-a-scale-out-deployment"></a>Удаление ключей шифрования отдельного сервера отчетов в конфигурации с масштабным развертыванием  
 В этом примере показано, как удалить ключи шифрования отдельного сервера отчетов в конфигурации с масштабным развертыванием. Ключи удаляются из базы данных сервера отчетов. Как только ключи этого экземпляра сервера отчетов будут удалены, он больше не сможет обращаться к зашифрованным данным в базе данных и будет фактически удален из конфигурации с масштабным развертыванием.  
  
 Чтобы удалить экземпляр сервера отчетов из масштабного развертывания, требуется указать идентификатор установки. Идентификатор установки — это идентификатор GUID, сохраненный в файле RSReportserver.config экземпляра сервера отчетов, для которого планируется удалить ключи шифрования. На компьютере, который планируется удалить из конфигурации с масштабным развертыванием, необходимо выполнить следующую команду. Если сервер отчетов установлен на именованный экземпляр, используйте аргумент `-i`, чтобы указать экземпляр. Дополнительные сведения см. в статье [RSReportServer Configuration File](../report-server/rsreportserver-config-configuration-file.md).  
  
```  
rskeymgmt -r <installationID>  
```  
  
## <a name="file-location"></a>Расположение файла  
 Rskeymgmt.exe находится в папке ** \<*drive*> : \PROGRAM Files\Microsoft SQL Server\110\Tools\Binn** или в ** \<*drive*> папке: \Program Files (x86) \Microsoft SQL Server\110\Tools\Binn**. Программу можно запустить из любой папки файловой системы.  
  
## <a name="remarks"></a>Remarks  
 Сервер отчетов шифрует сохраненные учетные данные и сведения о соединении. Для шифрования данных используются открытый ключ и симметричный ключ. Для запуска сервера отчетов в базе данных сервера отчетов должен находиться набор допустимых ключей. Программу **rskeymgmt** можно использовать для создания резервных копий, удаления или восстановления ключей. Если ключи не могут быть восстановлены, это средство предоставляет возможность удаления зашифрованного содержимого, которое больше не может использоваться.  
  
 Программа **rskeymgmt** используется для управления набором ключей, указанным во время установки или при инициализации. Она подключается к локальной службе Windows сервера отчетов через конечную точку удаленного вызова процедур (RPC). Чтобы эта программа могла работать, должна быть запущена служба Windows сервера отчетов.  
  
 Дополнительные сведения о ключах шифрования см. в разделах [Настройка ключей шифрования и управление ими (диспетчер конфигурации служб SSRS)](../install-windows/ssrs-encryption-keys-manage-encryption-keys.md) и [Инициализация сервера отчетов (диспетчер конфигурации служб SSRS)](../install-windows/ssrs-encryption-keys-initialize-a-report-server.md).  
  
## <a name="see-also"></a>См. также:  
 [Настройка масштабного развертывания сервера отчетов в собственном режиме &#40;службы SSRS Configuration Manager&#41;](../install-windows/configure-a-native-mode-report-server-scale-out-deployment.md)   
 [Сервер отчетов служб Reporting Services (основной режим)](../report-server/reporting-services-report-server-native-mode.md)   
 [Программы командной строки сервера отчетов &#40;службы SSRS&#41;](report-server-command-prompt-utilities-ssrs.md)   
 [Настройка ключей шифрования и управление ими (диспетчер конфигурации служб SSRS)](../install-windows/ssrs-encryption-keys-manage-encryption-keys.md)  
  
  
