---
title: Экспорт в Microsoft Word (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 0cd8ae26-4682-4473-8f15-af084951defd
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 2c4e498ee6fb1952326f508d853d31dff218473c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739458"
---
# <a name="exporting-to-microsoft-word-report-builder-and-ssrs"></a>Экспорт в Microsoft Word (построитель отчетов и службы SSRS)
  Модуль подготовки отчетов Word подготавливает отчеты в собственном формате [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2007–2010. Используется формат Office Open XML.  
  
 Модуль подготовки отчетов Word является совместимым с [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2007–2010, а также с [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2003 с установленным пакетом совместимости [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office для Word, Excel и PowerPoint. 
  
 Содержимое файлов, создаваемых этим модулем подготовки, имеет тип **application/vnd.openxmlformats-officedocument.wordprocessingml.document** , а имена файлов имеют расширение DOCX.  
  
 Предыдущая версия модуля подготовки отчетов Word, совместимая с [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2003, переименована в Word 2003. По умолчанию доступен только модуль подготовки отчетов Word. Чтобы получить доступ к модулю подготовки отчетов Word 2003, необходимо обновить файлы конфигурации служб Reporting Services. Модуль подготовки Word 2003 создает содержимое файлов типа **application/vnd.ms-word** , имена файлов имеют расширение DOC.  
  
> [!IMPORTANT]  
>  Модуль подготовки отчетов [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2003 устарел. Дополнительные сведения см. [в разделе Нерекомендуемые функции в SQL Server Reporting Services в SQL Server 2014](../deprecated-features-in-sql-server-reporting-services-ssrs.md).  
  
 После экспорта отчета в документ Word можно изменить содержимое отчета и спроектировать отчеты в стиле документа, такие как наклейки для почтовой рассылки, заказы на покупку или стандартные письма.  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="report-items-in-word"></a><a name="ReportItemsWord"></a> Элементы отчета в формате Word  
 Отчеты, экспортированные в формат Word, имеют вид вложенной таблицы, представляющей текст отчета. Область данных табликса подготавливается к просмотру в виде вложенной таблицы, в которой отображается структура области данных отчета. Текстовые поля и прямоугольники выводятся как отдельные ячейки таблицы. Значение текстового поля отображается внутри ячейки.  
  
 Изображения, диаграммы, гистограммы, sparkline-графики, карты, индикаторы и датчики выводятся как статические изображения, каждое в своей ячейке таблицы. Гиперссылки и ссылки детализации, содержащиеся в этих элементах отчета, также экспортируются. Карты и области диаграммы, с которыми можно работать щелчком мыши, не поддерживаются.  
  
 Многостолбцовые отчеты в стиле газетной верстки не подготавливаются к просмотру в формате Word. Фоновые изображения и цвета текста отчета и страницы не подготавливаются к просмотру.  
  
##  <a name="pagination"></a><a name="Pagination"></a>Разбивк  
 Когда отчет открывается в текстовом редакторе Word, он повторно разбивает отчет на страницы на основании размера страницы. Повторное разбиение на страницы может привести к появлению разрывов страниц в непредвиденных местах. В некоторых случаях может оказаться, что экспортированный отчет содержит два разрыва страницы подряд или пустые страницы. Можно попытаться изменить разбиение на страницы в Word, настраивая размеры полей страницы.  
  
 Этот модуль подготовки отчетов поддерживает только логические разрывы страниц.  
  
### <a name="page-sizing"></a>Изменение размера страницы  
 В подготовленном для просмотра отчете высота и ширина страницы в текстовом редакторе Word определяются следующими свойствами RDL: высота и ширина листа бумаги, ширина левого, правого, верхнего и нижнего полей страницы.  
  
### <a name="page-width"></a>Ширина страницы  
 В формате Word поддерживаются страницы шириной до 55,87 см. Если ширина отчета превышает 55,87 см, отчет все равно будет подготовлен к просмотру; однако в текстовом редакторе Word его содержимое не будет выведено ни в режиме разметки страницы, ни в режиме чтения. Чтобы просмотреть данные, необходимо переключиться в обычный режим разметки или в режим веб-документа. В этих режимах текстовый редактор Word сокращает количество пробельных символов, поэтому отображается большая часть содержимого отчета.  
  
 При подготовке к просмотру отчет будет сделан настолько широким, насколько это потребуется, чтобы вывести его содержимое, но не более 55,87 см шириной. Минимальная ширина отчета основана на свойстве языка определения отчетов Width на панели свойств.  
  
##  <a name="document-properties"></a><a name="DocumentProperties"></a>Свойства документа  
 Модуль подготовки отчетов в формате Word записывает следующие метаданные в DOCX-файл.  
  
|Свойства элемента отчета|Описание|  
|-------------------------------|-----------------|  
|Report Title (заголовок отчета)|Title|  
|Report.Author|Автор|  
|Report.Description|Комментарии|  
  
##  <a name="page-headers-and-footers"></a><a name="ReportHeadersFooters"></a>Верхние и нижние колонтитулы страницы  
 Верхние и нижние колонтитулы страницы отображаются как области верхнего и нижнего колонтитула в Word. Если в верхнем или нижнем колонтитуле страницы расположен номер страницы отчета или выражение для указания общего количества страниц отчета, они преобразуются в поле документа Word, так что в подготовленном к просмотру отчете номер страницы будет выведен правильно. Текстовый редактор Word не поддерживает настройки высоты верхнего или нижнего колонтитула, заданные в отчете. Свойство PrintOnFirstPage в зависимости от условий может указывать, выводится ли на печать текст из верхнего и нижнего колонтитулов страницы на первой странице отчета. Если в готовом для просмотра отчете содержится несколько страниц и каждая страница состоит только из одного раздела, то можно присвоить свойству PrintOnFirstPage значение False, и текст на первой странице будет подавляться. В противном случае текст выводится на печать независимо от значения свойства PrintOnFirstPage.  
  
 Модуль подготовки отчетов Word пытается выполнить синтаксический анализ всех выражений в верхних и нижних колонтитулах страницы при экспорте отчетов в Word. Множество форм выражений успешно проходят синтаксический анализ, и ожидаемые значения появляются в верхних и нижних колонтитулах страницы на всех страницах отчета.  
  
 Но если нижний или верхний колонтитул страницы содержит сложное выражение, результатом которого являются различные значения на разных страницах отчета, то на всех страницах отчета может отображаться одно и то же значение. В следующих двух выражениях номера страниц не наращиваются в экспортированном отчете. Номер страницы преобразуется в одно и то же значение на всех страницах отчета.  
  
-   `="Page: " + Globals!PageNumber.ToString + " of " + Globals!TotalPages.ToString`  
  
-   `=Avg(Fields!YTDPurchase.Value, "Sales") & " Page Number " & Globals!PageNumber`  
  
 Это происходит потому, что модуль подготовки отчетов Word анализирует отчет для определения наличия таких полей, относящихся к разбиению на страницы, как **PageNumber** и **TotalPages** , и обрабатывает только простые ссылки, а не вызовы функций. В данном случае в выражении вызывается функция **ToString** . Следующие два выражения являются эквивалентными, и оба обеспечивают правильную подготовку к просмотру при предварительном просмотре отчета в построителе отчетов или конструкторе отчетов либо при подготовке к просмотру опубликованного отчета в диспетчере отчетов или библиотеке SharePoint. Но модуль подготовки отчетов Word успешно выполняет синтаксический анализ только второго выражения и правильно подготавливает к просмотру номера страниц.  
  
-   **Сложное выражение:**  Выражение имеет`="Average Sales " & Avg(Fields!YTDPurchase.Value, "Sales") & " Page Number " & Globals!PageNumber`  
  
-   **Выражение с текстом выполняется:** Текст, **средний объем продаж**, выражение, `=Avg(Fields!YTDPurchase.Value, "Sales)` текст, **номер страницы**и выражение`=Globals!PageNumber`  
  
 Чтобы избежать этой проблемы, при включении выражений в колонтитулы используйте несколько отрезков текста вместо одного сложного выражения. Следующие два выражения эквивалентны. Первое выражение является сложным, а второй использует отрезки текста. Модуль подготовки отчетов Word успешно выполняет синтаксический анализ только второго выражения.  
  
##  <a name="interactivity"></a><a name="Interactivity"></a>Интерактивности  
 В формате Word поддерживается ряд интерактивных элементов. Ниже приведено описание особенностей поведения.  
  
### <a name="show-and-hide"></a>Показать и скрыть  
 Модуль подготовки отчетов к просмотру в формате Word отображает элементы отчета с учетом их состояния в момент подготовки к просмотру. Если элемент отчета скрыт, он не будет отображен в документе Word. Если элемент отчета отображается, он будет отображен в документе Word. Переключение видимости в формате Word не поддерживается.  
  
### <a name="document-map"></a>Схема документа  
 Если в отчете существуют метки схемы документа, они будут отображены как метки оглавления Word на соответствующих элементах и группах отчета. Метка схемы документа будет использована как текст метки оглавления. Целевая ссылка будет расположена возле элемента, на котором установлена метка. Оглавление в документе формата Word не создается, но пользователь может построить собственное оглавление, используя подготовленные в отчете метки схемы документа.  
  
### <a name="hyperlink-and-drillthrough-links"></a>Гиперссылки и ссылки детализации  
 Гиперссылки и ссылки детализации в текстовых полях и изображениях отчета отображаются в документе формата Word как гиперссылки. При щелчке гиперссылки открывается установленный в системе по умолчанию веб-браузер и открывает данный URL-адрес. При щелчке гиперссылки детализации выполняется доступ к исходному серверу отчетов.  
  
### <a name="interactive-sorting"></a>Интерактивная сортировка  
 Содержимое отчета выводится на основе текущей сортировки области данных отчета. Формат Word не поддерживает интерактивную сортировку. После подготовки отчета можно использовать функции табличной сортировки текстового редактора Word.  
  
### <a name="bookmarks"></a>Закладки  
 Содержащиеся в отчете закладки отображаются как закладки Word. Ссылки закладок подготавливаются к просмотру как гиперссылки, ведущие на метки закладок в документе. Длина меток закладок не должна превышать 40 символов. Единственный специальный символ, который можно использовать в метке закладки — символ подчеркивания (_). Неподдерживаемые специальные символы удаляются из имени метки закладки. Если имя длиннее 40 символов, оно усекается. Если имена нескольких закладок в отчете повторяются, эти закладки не будут отображены в документе Word.  
  
##  <a name="word-style-rendering"></a><a name="WordStyleRendering"></a> Подготовка к просмотру стилей при подготовке отчета в формате Word  
 Далее следует краткое описание отображения стилей при подготовке отчета в формате Word.  
  
### <a name="color-palette"></a>Цветовая палитра  
 Содержащиеся в отчете цвета отображаются в документе Word.  
  
### <a name="border"></a>Рамка  
 Границы элементов отчета, отличные от границ страницы, отображаются в формате Word как границы ячеек таблицы Word.  
  
##  <a name="squiggly-lines-in-exported-reports"></a><a name="SquigglyLines"></a> Волнистые линии в экспортированных отчетах  
 При экспорте и просмотре отчетов в Word данные отчета или константы могут оказаться подчеркнутыми красной или зеленой волнистой линией. Красная волнистая линия указывает на орфографическую ошибку. Зеленая волнистая линия указывает на грамматическую ошибку. Это происходит в тех случаях, когда отчет содержит слова, не соответствующие правилам языка (орфографии и грамматики), выбранного в Word. Например, заголовки столбцов в отчете на английском языке, скорее всего, будут подчеркнуты красной волнистой линией, если отчет готовится к просмотру на версии Word для испанского языка. Орфографические ошибки характернее для отчетов, чем грамматические, поскольку обычно отчеты содержат короткие фрагменты текста, а не полные предложения и абзацы.  
  
 Наличие волнистых линий в отчете заставляет предположить, что в нем содержатся ошибки, хотя на самом деле их может и не быть. Волнистые линии можно убрать, изменив язык проверки для отчета. Чтобы изменить язык проверки, выделите все содержимое отчета и задайте для него нужный язык. Можно выделить как весь отчет, так и его часть. В Word 2010 параметр язык, **установленный** **в поле язык** , находится на вкладке **Проверка** . После обновления содержимого необходимо снова сохранить документ.  
  
 От языка используемой программы Office зависит язык средств проверки (например, словарь), включенный в программу или языковой пакет [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office.  
  
 В следующих разделах приведена дополнительная информация о настройке параметров Office и Word.  
  
-   Изменить язык редактирования можно в **Языковых параметрах Microsoft Office 2010** или в диалоговом окне **Параметры Word** в Word. Дополнительные сведения см. в разделе [Включение использования других языков в программах Office](https://office.microsoft.com/word-help/enable-the-use-of-other-languages-in-your-office-programs-HA010354783.aspx?CTT=1).  
  
-   Установка языкового пакета Office и изменение языка редактирования. Дополнительные сведения см. в разделах [Включение использования других языков в программах Office](https://office.microsoft.com/word-help/enable-the-use-of-other-languages-in-your-office-programs-HA010354783.aspx?CTT=1) и [Параметры языка Office 2010](https://office.microsoft.com/language/).  
  
> [!NOTE]  
>  Смена языка редактирования в **Языковых параметрах Microsoft Office 2010** или в диалоговом окне **Параметры Word** в Word отразится на всех программах Office.  
  
##  <a name="word-limitations"></a><a name="WordLimitations"></a> Ограничения формата Word  
 Формат [!INCLUDE[ofprword](../../includes/ofprword-md.md)]накладывает следующие ограничения.  
  
-   Таблицы формата Word поддерживают не более 63 столбцов. Если в отчете содержится больше 63 столбцов, при попытке его подготовки в формате Word таблица будет разбита на несколько. Дополнительные столбцы помещаются рядом с 63 столбцами, отображаемыми в тексте отчета. Поэтому расположение столбцов отчета может не совпадать с ожидаемым.  
  
-   В формате Word поддерживаются страницы шириной и высотой не более 55,87 см. Если содержимое отчета по ширине превышает 55,87 см, в режиме разметки страницы часть данных может не отображаться.  
  
-   В формате Word не учитываются настройки высоты верхнего и нижнего колонтитула.  
  
-   После экспорта отчета Word повторно разбивает его на страницы. Это может привести к появлению в отчете, готовом для просмотра, дополнительных разрывов страниц.  
  
-   Word не повторяет строки заголовка на странице 2 и выше, хотя свойство RepeatOnNewPage строки статического заголовка в табликса (таблица, матрица или список) устанавливается в значение `True` . Чтобы настроить отображение строк заголовков на новых страницах, можно в отчете определить явные разрывы страниц. Однако поскольку к отчету, подготовленному к просмотру и экспортированному в приложение Word, применяется собственный алгоритм разбиения на страницы, то полученные результаты могут различаться и повторение строки верхнего колонтитула не гарантируется. Статическая строка заголовка представляет собой строку, содержащую заголовки столбцов.  
  
-   Текстовые поля, содержащие неразрывные пробелы, увеличиваются в размерах.  
  
-   При экспорте текста в Word применение текста с художественным оформлением шрифта может для некоторых шрифтов привести к выпадению или образованию непредвиденных глифов в подготовленном для просмотра отчете.  
  
##  <a name="benefits-of-using-the-word-renderer"></a><a name="WordBenefits"></a> Преимущества использования модуля подготовки Word  
 В дополнение к тому, что для экспортированных отчетов стали доступными новые средства [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2007–2010, файлы экспортированных отчетов с расширением DOCX, как правило, имеют меньший размер. Отчеты, экспортированные с использованием модуля подготовки отчетов Word, обычно намного меньше, чем такие же отчеты, экспортированные с использованием модуля подготовки отчетов Word 2003.  
  
## <a name="backward-compatibility-of-exported-reports"></a>Обратная совместимость экспортированных отчетов.  
 Предусмотрена возможность выбирать режим совместимости Word и задавать параметры совместимости. Модуль подготовки отчетов Word создает документы с включенным режимом совместимости. Повторное сохранение документов с выключенным режимом совместимости может привести к нарушению макета документа.  
  
 После отключения режима совместимости и повторного сохранения отчета в макете отчета могут произойти непредвиденные изменения.  
  
##  <a name="availability-of-the-word-2003-renderer"></a><a name="AvailabilityWord"></a>Доступность модуля подготовки отчетов Word 2003  
 В [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] стандартный модуль подготовки отчетов Word имеет версию, которая создает собственный формат [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2007–2010. Это параметр **Word** , содержащийся в меню **Экспорт** диспетчера отчетов и в списке SharePoint. Более ранняя версия, совместимая только с [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2003, теперь называется Word 2003 и содержится в меню под этим именем. Пункт меню **Word 2003** не отображается по умолчанию, но администратор может сделать его видимым, обновив файл конфигурации RSReportServer. Для экспорта отчетов из среды [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] с помощью модуля подготовки отчетов Word 2003 необходимо обновить файл конфигурации RSReportDesigner. Однако настройка видимости модуля подготовки отчетов Word 2003 не обеспечивает его доступность во всех сценариях. Поскольку файл конфигурации RSReportServer хранится на сервере отчетов, для обеспечения возможности чтения файла конфигурации средства и продукты, хранящиеся в целевом местоположении экспорта отчетов, должны быть подключены к серверу отчетов. При использовании средств или продуктов в отключенном или локальном режиме модуль подготовки отчетов Word 2003 недоступен. Пункт меню **Word 2003** по-прежнему будет недоступен. Если сделать модуль подготовки отчетов Word 2003 видимым, изменив файл конфигурации RSReportDesigner, пункт меню **Word 2003** будет всегда доступен в режиме предварительного просмотра отчета в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] .  
  
 Пункт меню **Word 2003** не отображается в следующих случаях.  
  
-   Построитель отчетов работает в отключенном режиме и используется для предварительного просмотра отчетов. Это относится как к версии [!INCLUDE[ndptecclick](../../includes/ndptecclick-md.md)] , так и к изолированной версии построителя отчетов.  
  
-   Веб-часть средства просмотра отчетов работает в локальном режиме, а ферма SharePoint не интегрирована с сервером отчетов служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Дополнительные сведения см [. в разделе Отчеты о локальном и подключенном режимах в средстве просмотра отчетов &#40;Reporting Services в режиме интеграции с SharePoint&#41;](../local-vs-connected-mode-report-viewer-reporting-services-sharepoint-mode.md)  
  
 Если пункт меню модуля подготовки отчетов **Word 2003** видим, то в следующих сценариях будут доступны параметры **Word** и **Word 2003** :  
  
-   Диспетчер отчетов, если службы Reporting Services установлены в собственном режим.  
  
-   Сайт SharePoint, если службы Reporting Services установлены в режиме интеграции с SharePoint.  
  
-   [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] и вы просматриваете отчеты.  
  
-   Построитель отчетов подключен к серверу отчетов. Это может быть версия [!INCLUDE[ndptecclick](../../includes/ndptecclick-md.md)] или изолированная версия построителя отчетов.  
  
-   Веб-часть средства просмотра отчетов в удаленном режиме.  
  
 Элементы для двух модулей подготовки отчетов Word в файлах конфигурации RSReportServer и RSReportDesigner показаны в следующем коде XML:  
  
 `<Extension Name="WORDOPENXML" Type="Microsoft.ReportingServices.Rendering.WordRenderer.WordOpenXmlRenderer.WordOpenXmlDocumentRenderer,Microsoft.ReportingServices.WordRendering"/>`  
  
 `<Extension Name="WORD" Type="Microsoft.ReportingServices.Rendering.WordRenderer.WordDocumentRenderer,Microsoft.ReportingServices.WordRendering" Visible="false"/>`  
  
 Расширение WORDOPENXML определяет модуль подготовки отчетов Word для [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2007–2010. Расширение WORD определяет версию [!INCLUDE[ofprword](../../includes/ofprword-md.md)] 2003. `Visible = "false"` указывает, что модуль подготовки отчетов Word 2003 скрыт. Дополнительные сведения см. в разделах [RSReportServer Configuration File](../report-server/rsreportserver-config-configuration-file.md) и [RSReportDesigner Configuration File](../report-server/rsreportdesigner-configuration-file.md).  
  
##  <a name="differences-between-the-word-and-word-2003-renderers"></a><a name="Differences"></a>Различия между модулями подготовки отчетов Word и Word 2003  
 Отчеты, подготовленные к просмотру с использованием модулей подготовки Word или Word 2003, как правило, визуально неразличимы. Но можно заметить небольшие различия между двумя форматами Word или Word 2003.  
  
##  <a name="device-information-settings"></a><a name="DeviceInfo"></a>Настройки сведений об устройстве  
 Некоторые настройки по умолчанию для этого модуля подготовки отчетов можно изменить. Изменив настройки сведений об устройстве можно, например, пропустить все гиперссылки и ссылки детализации, или развернуть все элементы, которые могут быть развернуты, независимо от их состояния на момент подготовки отчета. Это делается с помощью настроек сведений об устройстве. Дополнительные сведения см. в статье [Word Device Information Settings](../word-device-information-settings.md).  
  
## <a name="see-also"></a>См. также:  
 [Разбиение на страницы в Reporting Services &#40;построитель отчетов и SSRS&#41;](../report-design/pagination-in-reporting-services-report-builder-and-ssrs.md)   
 [Поведения подготовки к просмотру &#40;построитель отчетов и SSRS&#41;](../report-design/rendering-behaviors-report-builder-and-ssrs.md)   
 [Интерактивные функции для различных модулей подготовки отчетов к просмотру &#40;построитель отчетов и SSRS&#41;](interactive-functionality-different-report-rendering-extensions.md)   
 [Подготовка элементов отчета к просмотру &#40;построитель отчетов и SSRS&#41;](../report-design/rendering-report-items-report-builder-and-ssrs.md)   
 [Таблицы, матрицы и списки (построитель отчетов и службы SSRS)](../report-design/create-invoices-and-forms-with-lists-report-builder-and-ssrs.md)  
  
