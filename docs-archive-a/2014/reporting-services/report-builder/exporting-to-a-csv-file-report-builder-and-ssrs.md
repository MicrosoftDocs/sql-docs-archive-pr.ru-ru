---
title: Экспорт в CSV-файл (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 68ec746e-8c82-47f5-8c3d-dbe403a441e5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 635d5904acf6e616378f5423bfbaf4cf5390fa9e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87654875"
---
# <a name="exporting-to-a-csv-file-report-builder-and-ssrs"></a>Экспорт в CSV-файл (построитель отчетов и службы SSRS)
  Модуль подготовки отчетов в формате с разделителями-запятыми (CSV) готовит отчеты для просмотра в виде плоских представлений данных стандартизованного текстового вида. Этот формат легко читается и может использоваться для обмена со многими приложениями.  
  
 Модуль подготовки отчетов в формате CSV использует строковый символ-разделитель для отделения полей и строк. Строковый разделитель можно настроить, чтобы использовать символ, отличный от запятой. Полученный файл может быть открыт в электронных таблицах (например в [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] ) или импортирован в другие программы. Отчет экспортируется в CSV-файл и возвращает тип MIME `text/csv`.  
  
 Если необходимо работать с данными, связанными с диаграммами, гистограммами, инфокривыми, датчиками и индикаторами в [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)], экспортируйте отчет в файл в формате CSV и откройте файл в [!INCLUDE[msCoName](../../includes/msconame-md.md)] Excel.  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="csv-rendering"></a><a name="CSVRendering"></a> Подготовка CSV-отчетов  
 Если для отображения используются параметры по умолчанию, отчет в формате CSV имеет следующие характеристики:  
  
-   По умолчанию строка разделителя полей — запятая (,).  
  
    > [!NOTE]  
    >  В качестве разделителя полей можно задать любой символ, в том числе символ табуляции. Для этого нужно изменить настройки сведений об устройстве. Дополнительные сведения см. в разделе [CSV Device Information Settings](../csv-device-information-settings.md).  
  
-   Строка разделителя записей — это возврат каретки и перевод строки ( \<cr> \<lf> ).  
  
-   Ограничитель текста — кавычка (").  
  
     Модуль подготовки отчетов в формате CSV не заключает все текстовые строки в квалификаторы. Ограничители текста добавляются только в случаях, когда строка содержит символ разделителя или символ конца строки.  
  
-   Если текст содержит внедренную строку разделителя или строку ограничителя текста, вокруг текста помещается ограничитель текста, а внедренные ограничители удваиваются.  
  
-   Форматирование и макет игнорируются.  
  
 При обработке не учитываются следующие элементы.  
  
-   Верхний колонтитул страницы  
  
-   Нижний колонтитул страницы  
  
-   Пользовательские элементы отчета  
  
-   Строка  
  
-   Образ —  
  
-   Прямоугольник  
  
-   Автоматические подытоги  
  
 Остальные элементы отчета сортируются сверху вниз, затем слева направо. Каждый элемент присваивается столбцу. Если отчет имеет вложенные элементы данных, такие как списки или таблицы, родительские элементы повторяются в каждой записи.  
  
 В следующей таблице описывается, как выглядят подготовленные к просмотру элементы отчета.  
  
|Элемент|Поведение при подготовке к просмотру|  
|----------|------------------------|  
|Текстовое поле|Подготовка содержимого текстового поля. По умолчанию элементы форматируются на основе их форматирующих свойств. В режиме совместимости форматирование можно изменить, изменив настройки сведений об устройстве. Дополнительные сведения о режимах подготовки отчетов в формате CSV см. ниже.|  
|Таблица|Подготовка путем разворачивания таблицы и создания строки и столбца для каждой строки и столбца на самом низком уровне детализации. Строки и столбцы подытогов не имеют заголовков строки или столбца. Детализированные отчеты не поддерживаются.|  
|Матрица|Подготовка с развертыванием таблицы и созданием строки и столбца для каждой строки и столбца на самом низком уровне детализации. Строки и столбцы подытогов не имеют заголовков строки или столбца.|  
|Список|Подготовка записи для каждой отдельной строки или экземпляра в списке.|  
|Подотчет|Родительский элемент повторяется для каждого экземпляра содержимого.|  
|Диаграмма|Выполняется подготовка к просмотру путем создания строк для всех значений диаграммы и меток элементов. Метки для рядов и категорий в иерархиях приводятся к плоскому формату и включаются в строку для значения диаграммы.|  
|Гистограмма|Отображается как диаграмма. Как правило, гистограмма не содержит иерархии или метки.|  
|Спарклайн|Отображается как диаграмма. Как правило, спарклайн не содержит иерархий или меток.|  
|Индикаторная диаграмма|Подготавливает единственную запись с минимальным и максимальным значениями линейной шкалы, начальным и конечным значениями диапазона и значением указателя.|  
|Индикатор|Отображается как единственная запись с названием активного состояния, состояний доступности и значений данных.|  
|Схема|Подготовка строки с метками и значениями каждого элемента слоя карты.<br /><br /> Если карта содержит несколько слоев, значения в строках могут различаться в зависимости от того, используются ли в слоях карты идентичные или различные области данных карты. Если одна область карты используется несколькими слоями карты, то строки содержат данные всех слоев.|  
  
### <a name="hierarchical-and-grouped-data"></a>Иерархические и группированные данные  
 Иерархические и группированные данные должны быть переведены в плоский формат, чтобы их можно было представить в формате CSV.  
  
 Модуль подготовки отчетов делает отчет плоским, преобразуя его в древовидную структуру, отображающую вложенные группы области данных. Формирование плоского отчета происходит следующим образом.  
  
-   Сначала делается плоской иерархия строк, затем — иерархия столбцов.  
  
-   Столбцы упорядочены следующим образом: текстовые поля в тексте отчета — слева направо, сверху вниз, а затем области данных — слева направо, сверху вниз.  
  
-   В пределах области данных столбцы упорядочены следующим образом: элементы углов, элементы иерархии строк, элементы иерархии столбцов, а затем ячейки.  
  
-   Одноранговые области данных — это области данных или динамические группы, относящиеся к одной и той же области данных или имеющие одного динамического предка. Одноранговые данные можно определить по разветвлениям уплощенного дерева.  
  
 Дополнительные сведения см. в разделе [Таблицы, матрицы и списки (построитель отчетов и службы SSRS)](../report-design/create-invoices-and-forms-with-lists-report-builder-and-ssrs.md).  
  
 
  
##  <a name="renderer-modes"></a><a name="RenderingModes"></a> Режимы модуля подготовки отчетов  
 Модуль подготовки отчетов в формате CSV может работать в двух режимах: один оптимизирован для Excel, второй — для приложений сторонних разработчиков, требующих строгого соответствия спецификации CSV в стандарте RFC 4180. В зависимости от режима одноранговые области данных обрабатываются по-разному.  
  
### <a name="default-mode"></a>Режим по умолчанию  
 Режим по умолчанию оптимизирован для использования отчетов в электронных таблицах Excel. Отчет, подготовленный в режиме по умолчанию, имеет формат CSV-файла с несколькими разделами данных в формате CSV. Каждая одноранговая область данных отделена пустой строкой. Одноранговые области данных в тексте отчета выводятся как отдельные массивы данных внутри файла CSV. Результатом является CSV-файл, в котором:  
  
-   индивидуальные текстовые поля в тексте отчета выводятся один раз как первый блок данных в CSV-файле;  
  
-   каждая одноранговая область данных верхнего уровня в тексте отчета выводится в своем собственном блоке данных;  
  
-   вложенные области данных выводятся диагонально в одном и том же блоке данных.  
  
#### <a name="formatting"></a>Форматирование  
 Числовые значения выводятся в форматированном виде. Программа работы с электронными таблицами Excel распознает форматированные численные значения — денежные суммы, проценты, даты — и форматирует ячейки соответствующим образом при импорте CSV-файла.  
  
### <a name="compliant-mode"></a>Режим совместимости  
 Совместимый формат оптимизирован для приложений сторонних разработчиков.  
  
#### <a name="data-regions"></a>Области данных  
 Заголовки столбцов содержатся только в первой строке файла, и каждая строка содержит одинаковое количество столбцов.  
  
#### <a name="formatting"></a>Форматирование  
 Значения не форматируются.  
  
##  <a name="interactivity"></a><a name="Interactivity"></a>Интерактивности  
 Ни один формат CSV данного модуля подготовки отчетов не поддерживает интерактивности. Не обрабатываются следующие интерактивные элементы.  
  
-   Гиперссылки  
  
-   Показать или скрыть  
  
-   Схема документа  
  
-   Ссылки с детализацией или дополнительной информацией  
  
-   Сортировка конечным пользователем  
  
-   Фиксированные заголовки  
  
-   Закладки  
  

  
##  <a name="device-information-settings"></a><a name="DeviceInfo"></a>Настройки сведений об устройстве  
 Некоторые настройки по умолчанию для этого модуля подготовки отчетов можно изменить с помощью изменения настроек сведений об устройстве. Можно, например, указать, в каком режиме готовить отчет, какие символы использовать в качестве разделителей, а какие — в качестве ограничителей текста. Дополнительные сведения см. в разделе [CSV Device Information Settings](../csv-device-information-settings.md).  
  
  
  
## <a name="see-also"></a>См. также:  
 [Разбиение на страницы в Reporting Services &#40;построитель отчетов и SSRS&#41;](../report-design/pagination-in-reporting-services-report-builder-and-ssrs.md)   
 [Поведения подготовки к просмотру &#40;построитель отчетов и SSRS&#41;](../report-design/rendering-behaviors-report-builder-and-ssrs.md)   
 [Интерактивные функции для различных модулей подготовки отчетов к просмотру &#40;построитель отчетов и SSRS&#41;](interactive-functionality-different-report-rendering-extensions.md)   
 [Подготовка элементов отчета к просмотру &#40;построитель отчетов и SSRS&#41;](../report-design/rendering-report-items-report-builder-and-ssrs.md)   
 [Таблицы, матрицы и списки (построитель отчетов и службы SSRS)](../report-design/create-invoices-and-forms-with-lists-report-builder-and-ssrs.md)  
  
  
