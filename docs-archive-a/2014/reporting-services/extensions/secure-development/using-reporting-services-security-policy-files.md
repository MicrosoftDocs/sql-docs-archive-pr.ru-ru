---
title: Использование файлов политики безопасности служб Reporting Services | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- code groups [Reporting Services]
- CodeGroup elements
- configuration files [Reporting Services]
- code access security [Reporting Services], security policies
- security policies [Reporting Services]
- security configuration files [Reporting Services]
- named permission sets [Reporting Services]
ms.assetid: 2280fff6-3de7-44b1-87da-5db0ec975928
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 15c5422741137505bc29a2de861fca1420e455d8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668655"
---
# <a name="using-reporting-services-security-policy-files"></a><span data-ttu-id="eebbf-102">Использование файлов политики безопасности служб Reporting Services</span><span class="sxs-lookup"><span data-stu-id="eebbf-102">Using Reporting Services Security Policy Files</span></span>
  <span data-ttu-id="eebbf-103">Службы [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] хранят сведения о политике безопасности компонентов в реестре и файлах конфигурации, которые копируются в файловую систему при установке.</span><span class="sxs-lookup"><span data-stu-id="eebbf-103">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] stores component security policy information in three configuration files that are copied to the file system during setup.</span></span> <span data-ttu-id="eebbf-104">В этих файлах конфигурации хранится сочетание внутренней и пользовательской политики безопасности для сборок программного кода в службах [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eebbf-104">These configuration files can contain a combination of internal-use and user-defined security policies for code assemblies in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="eebbf-105">Три файла конфигурации соответствуют трем защищаемым компонентам служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]: сервер отчетов и служба Windows, веб-приложение диспетчер отчетов и окно предварительного просмотра конструктора отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-105">The three configuration files correspond to three securable components in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]: The report server and Windows service, the Report Manager Web application, and the Report Designer preview window.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eebbf-106">Для конструктора отчетов предусмотрено два режима предварительного просмотра: вкладка предварительного просмотра и всплывающее окно предварительного просмотра, которое вызывается при запуске проекта отчета в режиме **DebugLocal**.</span><span class="sxs-lookup"><span data-stu-id="eebbf-106">There are two preview modes for Report Designer: the preview tab and the pop-up preview window that is launched when your Report Project is started in **DebugLocal** mode.</span></span> <span data-ttu-id="eebbf-107">Вкладка **Просмотр** не является защищаемым компонентом, к ней не применяются параметры политики безопасности.</span><span class="sxs-lookup"><span data-stu-id="eebbf-107">The **Preview** tab is not a securable component and does not apply security policy settings.</span></span> <span data-ttu-id="eebbf-108">Окно предварительного просмотра предназначено для имитации функциональной возможности сервера отчетов и поэтому имеет файл конфигурации политики безопасности, который необходимо изменить, если используются пользовательские сборки или пользовательские модули в конструкторе отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-108">The preview window is meant to simulate the report server functionality and therefore has a policy configuration file that you or an administrator must modify to use custom assemblies and custom extensions in Report Designer.</span></span>  
  
 <span data-ttu-id="eebbf-109">Файлы конфигурации политики безопасности содержат сведения класса безопасности, некоторые именованные наборы разрешений по умолчанию и группы программного кода для сборки в службах [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eebbf-109">The security policy configuration files contain security class information, some default named permission sets, and the code groups for assemblies in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="eebbf-110">Файлы конфигурации политики безопасности служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] напоминают файл Security.config, который определяет иерархию группы кода и наборы разрешений, связанные с политиками на уровне компьютера и предприятия в [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eebbf-110">The policy configuration files of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] are similar to the Security.config file that determines the code group hierarchy and permission sets associated with machine and enterprise level policies in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="eebbf-111">Этот файл находится в C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\CONFIG\security.config.</span><span class="sxs-lookup"><span data-stu-id="eebbf-111">The location of this file is C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\CONFIG\security.config.</span></span>  
  
## <a name="policy-files-in-reporting-services"></a><span data-ttu-id="eebbf-112">Файлы политик в службах Reporting Services</span><span class="sxs-lookup"><span data-stu-id="eebbf-112">Policy Files in Reporting Services</span></span>  
 <span data-ttu-id="eebbf-113">В следующей таблице приводится список файлов конфигурации в службах [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)], их расположение (предполагается установка по умолчанию) и соответствующие функции.</span><span class="sxs-lookup"><span data-stu-id="eebbf-113">The following table lists the policy configuration files in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)], their locations (assuming a default installation), and their respective functions.</span></span>  
  
|<span data-ttu-id="eebbf-114">Имя файла</span><span class="sxs-lookup"><span data-stu-id="eebbf-114">File name</span></span>|<span data-ttu-id="eebbf-115">Расположение (установка по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="eebbf-115">Location (default installation)</span></span>|<span data-ttu-id="eebbf-116">Description</span><span class="sxs-lookup"><span data-stu-id="eebbf-116">Description</span></span>|  
|---------------|---------------------------------------|-----------------|  
|<span data-ttu-id="eebbf-117">rssrvpolicy.config</span><span class="sxs-lookup"><span data-stu-id="eebbf-117">rssrvpolicy.config</span></span>|<span data-ttu-id="eebbf-118">C:\Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportServer</span><span class="sxs-lookup"><span data-stu-id="eebbf-118">C:\Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportServer</span></span>|<span data-ttu-id="eebbf-119">Файл конфигурации политики безопасности сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-119">The report server policy configuration file.</span></span> <span data-ttu-id="eebbf-120">Эти политики безопасности в первую очередь касаются выражений отчетов и пользовательских сборок после развертывания отчета на сервере отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-120">These security policies primarily affect report expressions and custom assemblies once a report is deployed to a report server.</span></span> <span data-ttu-id="eebbf-121">Этот файл также влияет на пользовательские данные, доставку, модули подготовки отчета и безопасности, развернутые на сервере отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-121">This policy file also affects custom data, delivery, rendering and security extensions deployed to the report server.</span></span>|  
|<span data-ttu-id="eebbf-122">rsmgrpolicy.config</span><span class="sxs-lookup"><span data-stu-id="eebbf-122">rsmgrpolicy.config</span></span>|<span data-ttu-id="eebbf-123">C:\Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportManager</span><span class="sxs-lookup"><span data-stu-id="eebbf-123">C:\Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportManager</span></span>|<span data-ttu-id="eebbf-124">Файл конфигурации политики диспетчера отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-124">Report Manager policy configuration file.</span></span> <span data-ttu-id="eebbf-125">Эти политики безопасности касаются всех сборок, расширяющих функции диспетчера отчетов, например расширения подписки для пользовательских модулей доставки.</span><span class="sxs-lookup"><span data-stu-id="eebbf-125">These security policies affect all assemblies that extend Report Manager; for example, subscription user interface extensions for custom delivery.</span></span>|  
|<span data-ttu-id="eebbf-126">rspreviewpolicy.config</span><span class="sxs-lookup"><span data-stu-id="eebbf-126">rspreviewpolicy.config</span></span>|<span data-ttu-id="eebbf-127">C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies</span><span class="sxs-lookup"><span data-stu-id="eebbf-127">C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies</span></span>|<span data-ttu-id="eebbf-128">Файл конфигурации политики изолированного предварительного просмотра для конструктора отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-128">The Report Designer stand-alone preview policy configuration file.</span></span> <span data-ttu-id="eebbf-129">Эти политики безопасности касаются пользовательских сборок и выражений отчета, которые используются в отчете во время предварительного просмотра и разработки.</span><span class="sxs-lookup"><span data-stu-id="eebbf-129">These security policies affect custom assemblies and report expressions that are used in reports during preview and development.</span></span> <span data-ttu-id="eebbf-130">Они влияют также на пользовательские модули, например модули обработки данных, развернутые в конструкторе отчетов.</span><span class="sxs-lookup"><span data-stu-id="eebbf-130">These policies also affect custom extensions, such as data processing extensions, that are deployed to Report Designer.</span></span>|  
  
## <a name="modifying-configuration-files"></a><span data-ttu-id="eebbf-131">Изменение файлов конфигурации</span><span class="sxs-lookup"><span data-stu-id="eebbf-131">Modifying Configuration Files</span></span>  
 <span data-ttu-id="eebbf-132">Параметры конфигурации задаются либо как элементы XML, либо как атрибуты.</span><span class="sxs-lookup"><span data-stu-id="eebbf-132">Configuration settings are specified as either XML elements or attributes.</span></span> <span data-ttu-id="eebbf-133">Если вы знакомы с XML и файлами конфигурации, то можете использовать редактор текста или кода для настройки пользовательских параметров.</span><span class="sxs-lookup"><span data-stu-id="eebbf-133">If you understand XML and configuration files, you can use a text or code editor to modify user-definable settings.</span></span> <span data-ttu-id="eebbf-134">Файлы конфигурации политики безопасности содержат сведения о иерархии группы программных кодов и набора разрешений, связанных с уровнем политики в службах [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eebbf-134">Security configuration files contain information about the code group hierarchy and permission sets associated with a policy level in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="eebbf-135">Для изменения политики безопасности в файле Security.config рекомендуется использовать вначале программу настройки .NET Framework (Mscorcfg.msc) или программу политики управления доступом для кода (Caspol.exe), чтобы изменения политики соответствовали допустимым XML-элементам конфигурации для файлов политик.</span><span class="sxs-lookup"><span data-stu-id="eebbf-135">It is recommended that you use the .NET Framework Configuration Utility (Mscorcfg.msc) or Code Access Security Policy Utility (Caspol.exe) to modify security policies in the Security.config file first, so that policy changes correspond to valid XML configuration elements for policy files.</span></span> <span data-ttu-id="eebbf-136">Сразу после этого можно вырезать и вставлять в файл политики новые группы кодов и наборы разрешений из файла Security.config для компонентов, к которым добавляются разрешения на программный код.</span><span class="sxs-lookup"><span data-stu-id="eebbf-136">Once you have done that, you can cut and paste the new code groups and permission sets from Security.config to the policy file for the component to which you are adding code permissions.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="eebbf-137">До внесения изменений необходимо создать резервные копии файлов конфигурации политик.</span><span class="sxs-lookup"><span data-stu-id="eebbf-137">You should backup your policy configuration files prior to making any changes.</span></span>  
  
 <span data-ttu-id="eebbf-138">При таком подходе достигается следующее.</span><span class="sxs-lookup"><span data-stu-id="eebbf-138">Using this approach accomplishes two things.</span></span> <span data-ttu-id="eebbf-139">Во-первых, это дает возможность использовать визуальные средства при создании групп кодов и наборов разрешений для служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eebbf-139">First, it enables you to use a visual tool to build your code groups and permission sets for [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="eebbf-140">Это гораздо легче, чем писать XML-элементы конфигурации с самого начала.</span><span class="sxs-lookup"><span data-stu-id="eebbf-140">This is much easier than writing XML configuration elements from scratch.</span></span> <span data-ttu-id="eebbf-141">Во-вторых, обеспечивает сохранность файлов конфигурации политики безопасности при неправильных XML-элементах и атрибутах.</span><span class="sxs-lookup"><span data-stu-id="eebbf-141">Secondly, it ensures that you do not corrupt the security policy configuration files with malformed XML elements and attributes.</span></span> <span data-ttu-id="eebbf-142">Дополнительные сведения о программе политики управления доступом для кода см. в MSDN, раздел «Использование файлов политики безопасности служб Reporting Services».</span><span class="sxs-lookup"><span data-stu-id="eebbf-142">For more information about the Code Access Security Policy Utility, see Using Reporting Services Security Policy Files on MSDN.</span></span>  
  
 <span data-ttu-id="eebbf-143">Перед изменением файлов конфигурации политик следует прочитать все сведения, изложенные в этом разделе, а также относящиеся к нему темы.</span><span class="sxs-lookup"><span data-stu-id="eebbf-143">Before modifying policy configuration files, you should read all the information available in this section and related topics.</span></span> <span data-ttu-id="eebbf-144">Изменение конфигураций политик служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] может в значительной степени повлиять на безопасность выполнения компонентами служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] внешних программных модулей.</span><span class="sxs-lookup"><span data-stu-id="eebbf-144">Modifying the policy configuration of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] can have a significant security impact on how [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] components execute external code modules.</span></span>  
  
## <a name="placement-of-codegroup-elements-for-extensions"></a><span data-ttu-id="eebbf-145">Размещение элементов CodeGroup для модулей</span><span class="sxs-lookup"><span data-stu-id="eebbf-145">Placement of CodeGroup Elements for Extensions</span></span>  
 <span data-ttu-id="eebbf-146">Размещение элементов CodeGroup в файле политики безопасности имеет большое значение.</span><span class="sxs-lookup"><span data-stu-id="eebbf-146">The placement of CodeGroup elements in a security policy file is important.</span></span> <span data-ttu-id="eebbf-147">Для модулей и разработанных пользовательских сборок рекомендуется размещать группы программного кода непосредственно под элементом URL-членства «$CodeGen$/\*», как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="eebbf-147">For extensions and custom assemblies that you develop, it is recommended that you place your custom code groups directly below the existing entry for the URL membership "$CodeGen$/\*", as indicated by the following:</span></span>  
  
```  
<CodeGroup  
    class="UnionCodeGroup"  
    version="1"  
    PermissionSetName="FullTrust">  
    <IMembershipCondition   
        class="UrlMembershipCondition"  
        version="1"  
        Url="$CodeGen$/*"  
    />  
</CodeGroup>  
<CodeGroup   
    class="UnionCodeGroup"  
    version="1"  
    PermissionSetName="FullTrust"  
    Name="MyCustomCodeGroup"  
    Description="Code group for my custom extension">  
        <IMembershipCondition class="UrlMembershipCondition"  
        version="1"  
        Url="C:\Program Files\Microsoft SQL Server\MSSQL\Reporting Services\ReportServer\bin\MyAssembly.dll"  
        />  
</CodeGroup>  
```  
  
 <span data-ttu-id="eebbf-148">Дополнительные группы программных кодов можно размещать одну за другой.</span><span class="sxs-lookup"><span data-stu-id="eebbf-148">Additional code groups can be added one after another.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="eebbf-149">См. также:</span><span class="sxs-lookup"><span data-stu-id="eebbf-149">See Also</span></span>  
 [<span data-ttu-id="eebbf-150">Основные сведения о политиках безопасности</span><span class="sxs-lookup"><span data-stu-id="eebbf-150">Understanding Security Policies</span></span>](understanding-security-policies.md)  
  
  
