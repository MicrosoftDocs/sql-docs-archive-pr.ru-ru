---
title: Подготовка к реализации модуля обработки данных | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- interfaces [Reporting Services]
- data processing extensions [Reporting Services], implementing
ms.assetid: 698817e4-33da-4eb5-9407-4103e1c35247
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: a3588aea825233631cb4ad7752919ad88bb4dbf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750480"
---
# <a name="preparing-to-implement-a-data-processing-extension"></a><span data-ttu-id="1e510-102">Подготовка к реализации модуля обработки данных</span><span class="sxs-lookup"><span data-stu-id="1e510-102">Preparing to Implement a Data Processing Extension</span></span>
  <span data-ttu-id="1e510-103">Перед реализацией собственного модуля обработки данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] вам следует определить реализуемые интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="1e510-103">Before you implement your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension, you should define the interfaces to implement.</span></span> <span data-ttu-id="1e510-104">Вы можете создать зависящие от модулей реализации всего набора интерфейсов либо реализовать только ограниченное его подмножество, например интерфейсы <xref:Microsoft.ReportingServices.DataProcessing.IDataReader> и <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand>. Используя эти интерфейсы, клиенты в основном взаимодействовали бы с результирующим набором в виде объекта **DataReader**, а модуль обработки данных служб [!INCLUDE[ssRS](../../../includes/ssrs.md)] использовался бы как посредник между результирующим набором и источником данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-104">You may want to provide extension-specific implementations of the entire set of interfaces, or you may simply want to focus your implementation on a subset, such as the <xref:Microsoft.ReportingServices.DataProcessing.IDataReader> and <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand> interfaces in which clients would interact primarily with a result set as a **DataReader** object and would use your [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extension as a bridge between the result set and your data source.</span></span>  
  
 <span data-ttu-id="1e510-105">Модули обработки данных можно реализовать двумя путями:</span><span class="sxs-lookup"><span data-stu-id="1e510-105">You can implement data processing extensions in one of two ways:</span></span>  
  
-   <span data-ttu-id="1e510-106">Классы модуля обработки данных могут реализовывать интерфейсы поставщика данных [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] и при необходимости расширенные интерфейсы модуля обработки данных, предоставляемые службами [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1e510-106">Your data processing extension classes can implement the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] data provider interfaces and optionally the extended data processing extension interfaces provided by [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="1e510-107">Классы модуля обработки данных могут реализовать интерфейсы модуля обработки данных, предоставляемые службами [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)], и, при необходимости, расширенные интерфейсы модуля обработки данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-107">Your data processing extension classes can implement the data processing extension interfaces provided by [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] and optionally the extended data processing extension interfaces.</span></span>  
  
 <span data-ttu-id="1e510-108">Если модуль обработки данных служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] не поддерживает определенное свойство или метод, то его следует реализовать, как операцию, не выполняющую никакого действия.</span><span class="sxs-lookup"><span data-stu-id="1e510-108">If your [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension will not support a particular property or method, implement the property or method as no-operation.</span></span> <span data-ttu-id="1e510-109">Если клиент ожидает определенное поведение, то следует создать исключение **NotSupportedException**.</span><span class="sxs-lookup"><span data-stu-id="1e510-109">If a client expects a particular behavior, throw a **NotSupportedException** exception.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1e510-110">Реализация в виде пустой команды свойства или метода применяется только к свойствам и методам интерфейсов, которые пользователь решил реализовать.</span><span class="sxs-lookup"><span data-stu-id="1e510-110">A no-operation implementation of a property or method only applies to the properties and methods of those interfaces that you choose to implement.</span></span> <span data-ttu-id="1e510-111">Необязательные интерфейсы, которые пользователь решил не реализовывать, следует исключить из сборки модуля обработки данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-111">Optional interfaces that you choose not to implement should be left out of your data processing extension assembly.</span></span> <span data-ttu-id="1e510-112">Дополнительные сведения о том, какие из интерфейсов являются необходимыми, а какие нет, смотрите далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="1e510-112">For more information about whether an interface is required or optional, see the table later in this section.</span></span>  
  
## <a name="required-extension-functionality"></a><span data-ttu-id="1e510-113">Необходимые функциональные возможности модуля</span><span class="sxs-lookup"><span data-stu-id="1e510-113">Required Extension Functionality</span></span>  
 <span data-ttu-id="1e510-114">Каждый модуль обработки данных служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] должен обеспечивать следующие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="1e510-114">Each [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension must provide the following functionality:</span></span>  
  
-   <span data-ttu-id="1e510-115">Открывают соединение с источником данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-115">Open a connection to a data source.</span></span>  
  
-   <span data-ttu-id="1e510-116">Возможность анализа запроса и возвращения списка имен полей для результирующего набора.</span><span class="sxs-lookup"><span data-stu-id="1e510-116">Analyze a query and return a list of field names for the result set.</span></span>  
  
-   <span data-ttu-id="1e510-117">Возможность выполнения запроса к источнику данных и возвращения набора строк.</span><span class="sxs-lookup"><span data-stu-id="1e510-117">Execute a query against the data source and return a row set.</span></span>  
  
-   <span data-ttu-id="1e510-118">Возможность передачи запросу параметров с одним значением.</span><span class="sxs-lookup"><span data-stu-id="1e510-118">Pass single-valued parameters to the query.</span></span>  
  
-   <span data-ttu-id="1e510-119">Возможность просмотра строк в наборе строк и получения данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-119">Iterate through rows in the row set and retrieve data.</span></span>  
  
 <span data-ttu-id="1e510-120">Каждый модуль обработки данных может быть расширен с добавлением следующих функциональных возможностей.</span><span class="sxs-lookup"><span data-stu-id="1e510-120">Each data processing extension can be extended to include the following functionality:</span></span>  
  
-   <span data-ttu-id="1e510-121">Анализируют запрос и возвращают список имен параметров, используемых в запросе.</span><span class="sxs-lookup"><span data-stu-id="1e510-121">Analyze a query and return a list of parameter names used in the query.</span></span>  
  
-   <span data-ttu-id="1e510-122">Возможность анализа запроса и возвращения списка полей, по которым сгруппирован запрос.</span><span class="sxs-lookup"><span data-stu-id="1e510-122">Analyze a query and return the list of fields by which the query is grouped.</span></span>  
  
-   <span data-ttu-id="1e510-123">Возможность анализа запроса и возвращения списка полей, по которым отсортирован запрос.</span><span class="sxs-lookup"><span data-stu-id="1e510-123">Analyze a query and return the list of fields by which the query is sorted.</span></span>  
  
-   <span data-ttu-id="1e510-124">Возможность предоставления имени пользователя и пароля для соединения с источником данных, не зависящим от строки соединения.</span><span class="sxs-lookup"><span data-stu-id="1e510-124">Provide a user name and password to connect to the data source that is independent of the connection string.</span></span>  
  
-   <span data-ttu-id="1e510-125">Возможность просмотра строк в наборе строк и возвращения вспомогательных метаданных о значениях данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-125">Iterate through rows in the row set and retrieve auxiliary metadata about the data values.</span></span>  
  
-   <span data-ttu-id="1e510-126">Возможность статистической обработки данных на сервере.</span><span class="sxs-lookup"><span data-stu-id="1e510-126">Aggregate data at the server.</span></span>  
  
## <a name="available-extension-interfaces"></a><span data-ttu-id="1e510-127">Доступные интерфейсы модулей</span><span class="sxs-lookup"><span data-stu-id="1e510-127">Available Extension Interfaces</span></span>  
 <span data-ttu-id="1e510-128">В следующей таблице описываются доступные интерфейсы, и поясняется, являются ли они необходимыми или нет.</span><span class="sxs-lookup"><span data-stu-id="1e510-128">The following table describes the available interfaces and whether implementation is required or optional.</span></span>  
  
|<span data-ttu-id="1e510-129">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="1e510-129">Interface</span></span>|<span data-ttu-id="1e510-130">Description</span><span class="sxs-lookup"><span data-stu-id="1e510-130">Description</span></span>|<span data-ttu-id="1e510-131">Реализация</span><span class="sxs-lookup"><span data-stu-id="1e510-131">Implementation</span></span>|  
|---------------|-----------------|--------------------|  
|<span data-ttu-id="1e510-132">IDbConnection</span><span class="sxs-lookup"><span data-stu-id="1e510-132">IDbConnection</span></span>|<span data-ttu-id="1e510-133">Представляет уникальный сеанс с источником данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-133">Represents a unique session with a data source.</span></span> <span data-ttu-id="1e510-134">Если используется система базы данных клиент/сервер, то сеанс может быть эквивалентом сетевого соединения с сервером.</span><span class="sxs-lookup"><span data-stu-id="1e510-134">In the case of a client/server database system, the session may be equivalent to a network connection to the server.</span></span>|<span data-ttu-id="1e510-135">Обязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-135">Required</span></span>|  
|<span data-ttu-id="1e510-136">IDbConnectionExtension</span><span class="sxs-lookup"><span data-stu-id="1e510-136">IDbConnectionExtension</span></span>|<span data-ttu-id="1e510-137">Представляет дополнительные свойства соединения, которые могут быть реализованы модулем обработки данных служб [!INCLUDE[ssRS](../../../includes/ssrs.md)], затрагивающие вопросы безопасности и проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="1e510-137">Represents additional connection properties that can be implemented by [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions regarding security and authentication.</span></span>|<span data-ttu-id="1e510-138">Необязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-138">Optional</span></span>|  
|<span data-ttu-id="1e510-139">IDbTransaction</span><span class="sxs-lookup"><span data-stu-id="1e510-139">IDbTransaction</span></span>|<span data-ttu-id="1e510-140">Представляет локальную транзакцию.</span><span class="sxs-lookup"><span data-stu-id="1e510-140">Represents a local transaction.</span></span>|<span data-ttu-id="1e510-141">Обязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-141">Required</span></span>|  
|<span data-ttu-id="1e510-142">IDbTransactionExtension</span><span class="sxs-lookup"><span data-stu-id="1e510-142">IDbTransactionExtension</span></span>|<span data-ttu-id="1e510-143">Представляет дополнительные свойства транзакций, которые могут быть реализованы модулями обработки данных служб [!INCLUDE[ssRS](../../../includes/ssrs.md)].</span><span class="sxs-lookup"><span data-stu-id="1e510-143">Represents additional transaction properties that can be implemented by [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions.</span></span>|<span data-ttu-id="1e510-144">Необязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-144">Optional</span></span>|  
|<span data-ttu-id="1e510-145">IDbCommand</span><span class="sxs-lookup"><span data-stu-id="1e510-145">IDbCommand</span></span>|<span data-ttu-id="1e510-146">Представляет запрос или команду, используемую при наличии соединения с источником данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-146">Represents a query or command that is used when connected to a data source.</span></span>|<span data-ttu-id="1e510-147">Обязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-147">Required</span></span>|  
|<span data-ttu-id="1e510-148">IDbCommandAnalysis</span><span class="sxs-lookup"><span data-stu-id="1e510-148">IDbCommandAnalysis</span></span>|<span data-ttu-id="1e510-149">Предоставляет дополнительные сведения о командах для анализа запроса и возвращения списка имен параметров, используемых в запросе.</span><span class="sxs-lookup"><span data-stu-id="1e510-149">Represents additional command information for analyzing a query and returning a list of parameter names used in the query.</span></span>|<span data-ttu-id="1e510-150">Необязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-150">Optional</span></span>|  
|<span data-ttu-id="1e510-151">IDataParameter</span><span class="sxs-lookup"><span data-stu-id="1e510-151">IDataParameter</span></span>|<span data-ttu-id="1e510-152">Представляет параметр или пару имя/значение, передаваемую команде или запросу.</span><span class="sxs-lookup"><span data-stu-id="1e510-152">Represents a parameter or name/value pair that is passed to a command or query.</span></span>|<span data-ttu-id="1e510-153">Обязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-153">Required</span></span>|  
|<span data-ttu-id="1e510-154">IDataParameterCollection</span><span class="sxs-lookup"><span data-stu-id="1e510-154">IDataParameterCollection</span></span>|<span data-ttu-id="1e510-155">Представляет коллекцию всех параметров, имеющих отношение к команде или запросу.</span><span class="sxs-lookup"><span data-stu-id="1e510-155">Represents a collection of all parameters relevant to a command or query.</span></span>|<span data-ttu-id="1e510-156">Обязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-156">Required</span></span>|  
|<span data-ttu-id="1e510-157">IDataReader</span><span class="sxs-lookup"><span data-stu-id="1e510-157">IDataReader</span></span>|<span data-ttu-id="1e510-158">Указывает метод считывания потока данных из источника данных, доступного только для чтения, с возможностью перемещения только вперед.</span><span class="sxs-lookup"><span data-stu-id="1e510-158">Provides a method of reading a forward-only, read-only stream of data from your data source.</span></span>|<span data-ttu-id="1e510-159">Обязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-159">Required</span></span>|  
|<span data-ttu-id="1e510-160">IDataReaderExtension</span><span class="sxs-lookup"><span data-stu-id="1e510-160">IDataReaderExtension</span></span>|<span data-ttu-id="1e510-161">Предоставляет метод считывания одного или нескольких потоков результирующих наборов с возможностью перемещения только вперед, полученных путем выполнения команды на источнике данных.</span><span class="sxs-lookup"><span data-stu-id="1e510-161">Provides a method of reading one or more forward-only streams of result sets, obtained by executing a command at a data source.</span></span> <span data-ttu-id="1e510-162">Данный интерфейс обеспечивает дополнительную поддержку статистических полей.</span><span class="sxs-lookup"><span data-stu-id="1e510-162">This interface provides additional support for field aggregates.</span></span>|<span data-ttu-id="1e510-163">Необязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-163">Optional</span></span>|  
|<span data-ttu-id="1e510-164">IExtension</span><span class="sxs-lookup"><span data-stu-id="1e510-164">IExtension</span></span>|<span data-ttu-id="1e510-165">Предоставляет базовый класс для модуля обработки данных служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1e510-165">Provides the base class for a [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension.</span></span> <span data-ttu-id="1e510-166">Также позволяет реализующему лицу включить локализованное имя для модуля и передать настройки конфигурации из файла конфигурации в модуль.</span><span class="sxs-lookup"><span data-stu-id="1e510-166">Also enables an implementer to include a localized name for the extension and to pass configuration settings from the configuration file to the extension.</span></span>|<span data-ttu-id="1e510-167">Обязательно</span><span class="sxs-lookup"><span data-stu-id="1e510-167">Required</span></span>|  
  
 <span data-ttu-id="1e510-168">Интерфейсы модуля обработки данных по возможности идентичны подмножеству интерфейсов, методов и свойств поставщика данных [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1e510-168">The data processing extension interfaces are identical to a subset of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] data provider interfaces, methods, and properties whenever possible.</span></span> <span data-ttu-id="1e510-169">Дополнительные сведения о реализации полного поставщика данных платформы [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] см. в разделе «Реализация поставщика данных платформы .NET Framework» в документации по пакету средств разработки программного обеспечения (пакетом SDK) [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1e510-169">For more information about implementing a full [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] data provider, see "Implementing a .NET Framework Data Provider" in your [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Software Development Kit (SDK) documentation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1e510-170">См. также:</span><span class="sxs-lookup"><span data-stu-id="1e510-170">See Also</span></span>  
 <span data-ttu-id="1e510-171">[Модули служб Reporting Services](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="1e510-171">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="1e510-172">[Реализация модуля обработки данных](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="1e510-172">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="1e510-173">Библиотека модулей Reporting Services</span><span class="sxs-lookup"><span data-stu-id="1e510-173">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  
