---
title: Ссылки на коллекцию полей набора данных (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 006c6bd3-d776-4c20-9092-32e40688ac49
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 9e4140c35f8035e3ac8fae37aefb9d7f2afcaecc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667597"
---
# <a name="dataset-fields-collection-references-report-builder-and-ssrs"></a>Ссылки на коллекцию полей набора данных (построитель отчетов и службы SSRS)
  В каждом наборе данных отчета содержится одна коллекция Fields. Коллекция Fields представляет собой набор полей, заданных запросом набора данных, и все созданные дополнительные вычисляемые поля. После создания набора данных коллекция полей появляется в области **Данные отчета** .  
  
 Простая ссылка на поле в выражении отображается в области конструктора в виде простого выражения. Например, если перетащить поле `Sales` из области данных отчета в ячейку таблицы в области конструктора, отображается `[Sales]` . Оно представляет базовое выражение `=Fields!Sales.Value` , установленное для свойства текстового поля "Значение". При запуске отчета обработчик отчетов вычисляет это выражение и отображает фактические данные из источника данных в текстовом поле ячейки таблицы. Дополнительные сведения см. в разделе [Выражения (построитель отчетов и службы SSRS)](expressions-report-builder-and-ssrs.md) и [Коллекция полей набора данных (построитель отчетов и службы SSRS)](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="displaying-the-field-collection-for-a-dataset"></a>Отображение коллекции полей для набора данных  
 Чтобы отобразить отдельные значения коллекции полей, перетащите каждое поле в строку детализации таблицы и запустите отчет. Ссылки в строке детализации области данных таблицы или списка отображают значение для каждой строки набора данных.  
  
 Чтобы отобразить сводные значения поля, перетащите каждое числовое поле в область данных матрицы. Агрегатной функцией по умолчанию для совокупности строк является Sum, например, `=Sum(Fields!Sales.Value)`. Функцию по умолчанию можно изменить, чтобы вычислять разные сводки. Дополнительные сведения см. в разделах [Справочник по агрегатным функциям (построитель отчетов и службы SSRS)](report-builder-functions-aggregate-functions-reference.md).  
  
 Чтобы отобразить сводные значения для коллекции полей в текстовом поле непосредственно в области конструктора (а не в области данных), необходимо указать имя набора данных в качестве области действия агрегатной функции. Например, для набора данных с именем `SalesData`следующее выражение задает сумму всех значений в поле `Sales`: `=Sum(Fields!Sales,"SalesData")`.  
  
 Если диалоговое окно **Выражение** используется для определения простой ссылки на поле, можно выбрать коллекцию Fields в панели категорий и увидеть список доступных полей в панели **Поле** . Каждое поле имеет несколько свойств, в том числе Value и IsMissing. Остальные свойства представляют собой стандартные расширенные свойства поля, которые могут быть доступны для набора данных в зависимости от типа источника данных.  
  
### <a name="detecting-nulls-for-a-dataset-field"></a>Обнаружение значений NULL в поле набора данных  
 Чтобы обнаружить значение NULL поля (`Nothing` в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), используется функция `IsNothing`. При помещении в текстовое поле сведений о таблице следующее выражение проверяет поле `MiddleName` и заменяет значение NULL текстом «No Middle Name», либо возвращает значение поля, если оно отлично от значения NULL:  
  
 `=IIF(IsNothing(Fields!MiddleName.Value),"No Middle Name",Fields!MiddleName.Value)`  
  
### <a name="detecting-missing-fields-for-dynamic-queries-at-run-time"></a>Обнаружение отсутствующих полей для динамических запросов во время выполнения  
 По умолчанию элементы в коллекции Fields имеют два свойства: Value и IsMissing. Свойство IsMissing указывает, содержится ли поле, определенное во время разработки, в полях, полученных во время выполнения. Например, запрос может вызывать хранимую процедуру, в которой результирующий набор различается с входным параметром, или же запрос может указывать `SELECT * FROM` *\<table>* место изменения определения таблицы.  
  
> [!NOTE]  
>  Свойство IsMissing обнаруживает изменения в схеме набора данных, произошедшие между временем разработки и временем выполнения, для всех типов источников данных. Параметр IsMissing не может использоваться для обнаружения пустых элементов в многомерном кубе и не связан с понятиями языка запросов многомерных выражений `EMPTY` и `NON EMPTY` .  
  
 Свойство IsMissing можно проверить в пользовательском коде, чтобы определить, присутствует ли поле в результирующем наборе. Его нельзя проверить в выражении, вызывающем функцию [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], например, `IIF` или `SWITCH`, поскольку [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] вычисляет все параметры при вызове функции, что приводит к ошибке, если вычисляется ссылка на отсутствующее поле.  
  
#### <a name="example-for-controlling-the-visibility-of-a-dynamic-column-for-a-missing-field"></a>Пример управления видимостью динамического столбца для отсутствующего поля  
 Чтобы определить выражение, управляющее видимостью столбца, в котором отображается поле набора данных, необходимо вначале создать функцию пользовательского кода, возвращающую логическое значение, которое указывает на наличие или отсутствие этого поля. Например, следующая функция пользовательского кода возвращает значение true, если поле отсутствует, и значение false при его наличии.  
  
```  
Public Function IsFieldMissing(field as Field) as Boolean  
 If (field.IsMissing) Then  
 Return True  
  Else   
  Return False  
 End If  
End Function  
```  
  
 Чтобы использовать эту функцию для управления видимостью столбца, присвойте свойству Hidden столбца следующее выражение:  
  
 `=Code.IsFieldMissing(Fields!FieldName)`  
  
 Столбец будет скрыт, если поле не существует.  
  
#### <a name="example-for-controlling-the-text-box-value-for-a-missing-field"></a>Пример управления значением текстового поля для отсутствующего поля  
 Чтобы заменить значение отсутствующего поля собственным текстом, необходимо написать пользовательский код, который возвращает текст, используемый вместо значения поля, если оно отсутствует. Например, следующая функция пользовательского кода возвращает значение поля, если оно существует, и сообщение, которое указывается в качестве второго параметра функции, если поле отсутствует:  
  
```  
Public Function IsFieldMissingThenString(field as Field, strMessage as String) as String  
 If (field.IsMissing) Then  
  Return strMessage  
 Else   
  Return field.Value  
  End If  
End Function  
```  
  
 Чтобы использовать эту функцию в текстовом поле, добавьте следующее выражение к свойству Value:  
  
 `=Code.IsFieldMissingThenString(Fields!FieldName,"Missing")`  
  
 Текстовое поле отображает значение поля или указанный текст.  
  
### <a name="using-extended-field-properties"></a>Использование расширенных свойств поля  
 Расширенные свойства поля представляют собой дополнительные свойства, которые определяются в поле модулем обработки данных, зависящим от типа источника данных для набора данных. Расширенные свойства поля могут быть стандартными или зависящими от конкретного источника данных. Дополнительные сведения см. в разделе [Расширенные свойства поля для базы данных служб Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).  
  
 Если указывается свойство, неподдерживаемое для этого поля, выражение принимает значение `null` (`Nothing` в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]). Если расширенные свойства поля не поддерживаются поставщиком данных или поле не найдено при выполнении запроса, значением свойства будет `null` (`Nothing` в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) для свойств с типами `String` и `Object`, а свойствам типа `Integer` присваивается значение 0. Модуль обработки данных может использовать преимущества стандартных свойств, оптимизируя запросы, включающие следующий синтаксис.  
  
## <a name="see-also"></a>См. также:  
 [Примеры выражений (построитель отчетов и службы SSRS)](expression-examples-report-builder-and-ssrs.md)   
 [Добавление данных в построитель отчетов &#40;отчетов и SSRS&#41;](../report-data/report-datasets-ssrs.md)  
  
  
