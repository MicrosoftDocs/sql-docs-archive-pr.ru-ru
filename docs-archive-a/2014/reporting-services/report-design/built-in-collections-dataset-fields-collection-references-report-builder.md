---
title: Ссылки на коллекцию полей набора данных (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 006c6bd3-d776-4c20-9092-32e40688ac49
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 9e4140c35f8035e3ac8fae37aefb9d7f2afcaecc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667597"
---
# <a name="dataset-fields-collection-references-report-builder-and-ssrs"></a><span data-ttu-id="a634b-102">Ссылки на коллекцию полей набора данных (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="a634b-102">Dataset Fields Collection References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="a634b-103">В каждом наборе данных отчета содержится одна коллекция Fields.</span><span class="sxs-lookup"><span data-stu-id="a634b-103">Each dataset in a report contains one Fields collection.</span></span> <span data-ttu-id="a634b-104">Коллекция Fields представляет собой набор полей, заданных запросом набора данных, и все созданные дополнительные вычисляемые поля.</span><span class="sxs-lookup"><span data-stu-id="a634b-104">The Fields collection is the set of fields specified by the dataset query plus any additional calculated fields that you create.</span></span> <span data-ttu-id="a634b-105">После создания набора данных коллекция полей появляется в области **Данные отчета** .</span><span class="sxs-lookup"><span data-stu-id="a634b-105">After you create a dataset, the field collection appears in the **Report Data** pane.</span></span>  
  
 <span data-ttu-id="a634b-106">Простая ссылка на поле в выражении отображается в области конструктора в виде простого выражения.</span><span class="sxs-lookup"><span data-stu-id="a634b-106">A simple field reference in an expression displays on the design surface as a simple expression.</span></span> <span data-ttu-id="a634b-107">Например, если перетащить поле `Sales` из области данных отчета в ячейку таблицы в области конструктора, отображается `[Sales]` .</span><span class="sxs-lookup"><span data-stu-id="a634b-107">For example, when you drag the field `Sales` from the Report Data pane to a table cell on the design surface, `[Sales]` is displayed.</span></span> <span data-ttu-id="a634b-108">Оно представляет базовое выражение `=Fields!Sales.Value` , установленное для свойства текстового поля "Значение".</span><span class="sxs-lookup"><span data-stu-id="a634b-108">This represents the underlying expression `=Fields!Sales.Value` that is set on the text box Value property.</span></span> <span data-ttu-id="a634b-109">При запуске отчета обработчик отчетов вычисляет это выражение и отображает фактические данные из источника данных в текстовом поле ячейки таблицы.</span><span class="sxs-lookup"><span data-stu-id="a634b-109">When the report runs, the report processor evaluates this expression and displays the actual data from the data source in the text box in the table cell.</span></span> <span data-ttu-id="a634b-110">Дополнительные сведения см. в разделе [Выражения (построитель отчетов и службы SSRS)](expressions-report-builder-and-ssrs.md) и [Коллекция полей набора данных (построитель отчетов и службы SSRS)](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="a634b-110">For more, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) and [Dataset Fields Collection &#40;Report Builder and SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="displaying-the-field-collection-for-a-dataset"></a><span data-ttu-id="a634b-111">Отображение коллекции полей для набора данных</span><span class="sxs-lookup"><span data-stu-id="a634b-111">Displaying the Field Collection for a Dataset</span></span>  
 <span data-ttu-id="a634b-112">Чтобы отобразить отдельные значения коллекции полей, перетащите каждое поле в строку детализации таблицы и запустите отчет.</span><span class="sxs-lookup"><span data-stu-id="a634b-112">To display the individual values for a field collection, drag each field to a table detail row and run the report.</span></span> <span data-ttu-id="a634b-113">Ссылки в строке детализации области данных таблицы или списка отображают значение для каждой строки набора данных.</span><span class="sxs-lookup"><span data-stu-id="a634b-113">References from the detail row of a table or list data region display a value for each row in the dataset.</span></span>  
  
 <span data-ttu-id="a634b-114">Чтобы отобразить сводные значения поля, перетащите каждое числовое поле в область данных матрицы.</span><span class="sxs-lookup"><span data-stu-id="a634b-114">To display summarized values for a field, drag each numeric field to the data area of a matrix.</span></span> <span data-ttu-id="a634b-115">Агрегатной функцией по умолчанию для совокупности строк является Sum, например, `=Sum(Fields!Sales.Value)`.</span><span class="sxs-lookup"><span data-stu-id="a634b-115">The default aggregate function for the total row is Sum, for example, `=Sum(Fields!Sales.Value)`.</span></span> <span data-ttu-id="a634b-116">Функцию по умолчанию можно изменить, чтобы вычислять разные сводки.</span><span class="sxs-lookup"><span data-stu-id="a634b-116">You can change the default function in order to calculate different totals.</span></span> <span data-ttu-id="a634b-117">Дополнительные сведения см. в разделах [Справочник по агрегатным функциям (построитель отчетов и службы SSRS)](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="a634b-117">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
 <span data-ttu-id="a634b-118">Чтобы отобразить сводные значения для коллекции полей в текстовом поле непосредственно в области конструктора (а не в области данных), необходимо указать имя набора данных в качестве области действия агрегатной функции.</span><span class="sxs-lookup"><span data-stu-id="a634b-118">To display summarized values for a field collection in a text box directly on the design surface (not part of a data region), you must specify the dataset name as a scope for the aggregate function.</span></span> <span data-ttu-id="a634b-119">Например, для набора данных с именем `SalesData`следующее выражение задает сумму всех значений в поле `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span><span class="sxs-lookup"><span data-stu-id="a634b-119">For example, for a dataset named `SalesData`, the following expression specifies the total of all values for the field `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span></span>  
  
 <span data-ttu-id="a634b-120">Если диалоговое окно **Выражение** используется для определения простой ссылки на поле, можно выбрать коллекцию Fields в панели категорий и увидеть список доступных полей в панели **Поле** .</span><span class="sxs-lookup"><span data-stu-id="a634b-120">When you use the **Expression** dialog box to define a simple field reference, you can select the Fields collection in the Category pane and see the list of available fields in the **Field** pane.</span></span> <span data-ttu-id="a634b-121">Каждое поле имеет несколько свойств, в том числе Value и IsMissing.</span><span class="sxs-lookup"><span data-stu-id="a634b-121">Each field has several properties, including Value and IsMissing.</span></span> <span data-ttu-id="a634b-122">Остальные свойства представляют собой стандартные расширенные свойства поля, которые могут быть доступны для набора данных в зависимости от типа источника данных.</span><span class="sxs-lookup"><span data-stu-id="a634b-122">The remaining properties are predefined extended field properties that may be available to the dataset depending on the data source type.</span></span>  
  
### <a name="detecting-nulls-for-a-dataset-field"></a><span data-ttu-id="a634b-123">Обнаружение значений NULL в поле набора данных</span><span class="sxs-lookup"><span data-stu-id="a634b-123">Detecting Nulls for a Dataset Field</span></span>  
 <span data-ttu-id="a634b-124">Чтобы обнаружить значение NULL поля (`Nothing` в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), используется функция `IsNothing`.</span><span class="sxs-lookup"><span data-stu-id="a634b-124">To detect a field value that is null (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), you can use the function `IsNothing`.</span></span> <span data-ttu-id="a634b-125">При помещении в текстовое поле сведений о таблице следующее выражение проверяет поле `MiddleName` и заменяет значение NULL текстом «No Middle Name», либо возвращает значение поля, если оно отлично от значения NULL:</span><span class="sxs-lookup"><span data-stu-id="a634b-125">When placed in a text box in a table details row, the following expression tests the field `MiddleName` and substitutes the text "No Middle Name" when the value is null, and the field value itself when the value is not null:</span></span>  
  
 `=IIF(IsNothing(Fields!MiddleName.Value),"No Middle Name",Fields!MiddleName.Value)`  
  
### <a name="detecting-missing-fields-for-dynamic-queries-at-run-time"></a><span data-ttu-id="a634b-126">Обнаружение отсутствующих полей для динамических запросов во время выполнения</span><span class="sxs-lookup"><span data-stu-id="a634b-126">Detecting Missing Fields for Dynamic Queries at Run Time</span></span>  
 <span data-ttu-id="a634b-127">По умолчанию элементы в коллекции Fields имеют два свойства: Value и IsMissing.</span><span class="sxs-lookup"><span data-stu-id="a634b-127">By default, items in the Fields collection have two properties: Value and IsMissing.</span></span> <span data-ttu-id="a634b-128">Свойство IsMissing указывает, содержится ли поле, определенное во время разработки, в полях, полученных во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="a634b-128">The IsMissing property indicates whether a field that is defined for a dataset at design time is contained in the fields retrieved at run time.</span></span> <span data-ttu-id="a634b-129">Например, запрос может вызывать хранимую процедуру, в которой результирующий набор различается с входным параметром, или же запрос может указывать `SELECT * FROM` *\<table>* место изменения определения таблицы.</span><span class="sxs-lookup"><span data-stu-id="a634b-129">For example, your query might call a stored procedure in which the result set varies with an input parameter, or your query might be `SELECT * FROM` *\<table>* where the table definition changed.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a634b-130">Свойство IsMissing обнаруживает изменения в схеме набора данных, произошедшие между временем разработки и временем выполнения, для всех типов источников данных.</span><span class="sxs-lookup"><span data-stu-id="a634b-130">IsMissing detects changes in the dataset schema between design time and run time for any type of data source.</span></span> <span data-ttu-id="a634b-131">Параметр IsMissing не может использоваться для обнаружения пустых элементов в многомерном кубе и не связан с понятиями языка запросов многомерных выражений `EMPTY` и `NON EMPTY` .</span><span class="sxs-lookup"><span data-stu-id="a634b-131">IsMissing cannot be used to detect empty members in a multidimensional cube and is not related to the MDX query language concepts of `EMPTY` and `NON EMPTY`.</span></span>  
  
 <span data-ttu-id="a634b-132">Свойство IsMissing можно проверить в пользовательском коде, чтобы определить, присутствует ли поле в результирующем наборе.</span><span class="sxs-lookup"><span data-stu-id="a634b-132">You can test the IsMissing property in custom code to determine if a field is present in the result set.</span></span> <span data-ttu-id="a634b-133">Его нельзя проверить в выражении, вызывающем функцию [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], например, `IIF` или `SWITCH`, поскольку [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] вычисляет все параметры при вызове функции, что приводит к ошибке, если вычисляется ссылка на отсутствующее поле.</span><span class="sxs-lookup"><span data-stu-id="a634b-133">You cannot test for its presence using an expression with a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] function call such as `IIF` or `SWITCH`, because [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] evaluates all parameters in the call to the function, which results in an error when the reference to the missing is evaluated.</span></span>  
  
#### <a name="example-for-controlling-the-visibility-of-a-dynamic-column-for-a-missing-field"></a><span data-ttu-id="a634b-134">Пример управления видимостью динамического столбца для отсутствующего поля</span><span class="sxs-lookup"><span data-stu-id="a634b-134">Example for Controlling the Visibility of a Dynamic Column for a Missing Field</span></span>  
 <span data-ttu-id="a634b-135">Чтобы определить выражение, управляющее видимостью столбца, в котором отображается поле набора данных, необходимо вначале создать функцию пользовательского кода, возвращающую логическое значение, которое указывает на наличие или отсутствие этого поля.</span><span class="sxs-lookup"><span data-stu-id="a634b-135">To set an expression that controls the visibility of a column that displays a field in a dataset, you must first define a custom code function that returns a Boolean value based on whether the field is missing.</span></span> <span data-ttu-id="a634b-136">Например, следующая функция пользовательского кода возвращает значение true, если поле отсутствует, и значение false при его наличии.</span><span class="sxs-lookup"><span data-stu-id="a634b-136">For example, the following custom code function returns true if the field is missing and false if the field exists.</span></span>  
  
```  
Public Function IsFieldMissing(field as Field) as Boolean  
 If (field.IsMissing) Then  
 Return True  
  Else   
  Return False  
 End If  
End Function  
```  
  
 <span data-ttu-id="a634b-137">Чтобы использовать эту функцию для управления видимостью столбца, присвойте свойству Hidden столбца следующее выражение:</span><span class="sxs-lookup"><span data-stu-id="a634b-137">To use this function to control visibility of a column, set the Hidden property of the column to the following expression:</span></span>  
  
 `=Code.IsFieldMissing(Fields!FieldName)`  
  
 <span data-ttu-id="a634b-138">Столбец будет скрыт, если поле не существует.</span><span class="sxs-lookup"><span data-stu-id="a634b-138">The column is hidden when the field does not exist.</span></span>  
  
#### <a name="example-for-controlling-the-text-box-value-for-a-missing-field"></a><span data-ttu-id="a634b-139">Пример управления значением текстового поля для отсутствующего поля</span><span class="sxs-lookup"><span data-stu-id="a634b-139">Example for Controlling the Text Box Value for a Missing Field</span></span>  
 <span data-ttu-id="a634b-140">Чтобы заменить значение отсутствующего поля собственным текстом, необходимо написать пользовательский код, который возвращает текст, используемый вместо значения поля, если оно отсутствует.</span><span class="sxs-lookup"><span data-stu-id="a634b-140">To substitute text that you write in place of the value of a missing field, you must write custom code that returns text you can use in place of a field value when the field is missing.</span></span> <span data-ttu-id="a634b-141">Например, следующая функция пользовательского кода возвращает значение поля, если оно существует, и сообщение, которое указывается в качестве второго параметра функции, если поле отсутствует:</span><span class="sxs-lookup"><span data-stu-id="a634b-141">For example, the following custom code function returns the value of the field if the field exists, and the message that you specify as the second parameter if the field does not exist:</span></span>  
  
```  
Public Function IsFieldMissingThenString(field as Field, strMessage as String) as String  
 If (field.IsMissing) Then  
  Return strMessage  
 Else   
  Return field.Value  
  End If  
End Function  
```  
  
 <span data-ttu-id="a634b-142">Чтобы использовать эту функцию в текстовом поле, добавьте следующее выражение к свойству Value:</span><span class="sxs-lookup"><span data-stu-id="a634b-142">To use this function in a text box, add the following expression to the Value property:</span></span>  
  
 `=Code.IsFieldMissingThenString(Fields!FieldName,"Missing")`  
  
 <span data-ttu-id="a634b-143">Текстовое поле отображает значение поля или указанный текст.</span><span class="sxs-lookup"><span data-stu-id="a634b-143">The text box displays either the field value or the text that you specified.</span></span>  
  
### <a name="using-extended-field-properties"></a><span data-ttu-id="a634b-144">Использование расширенных свойств поля</span><span class="sxs-lookup"><span data-stu-id="a634b-144">Using Extended Field Properties</span></span>  
 <span data-ttu-id="a634b-145">Расширенные свойства поля представляют собой дополнительные свойства, которые определяются в поле модулем обработки данных, зависящим от типа источника данных для набора данных.</span><span class="sxs-lookup"><span data-stu-id="a634b-145">Extended field properties are additional properties defined on a field by the data processing extension, which is determined by the data source type for the dataset.</span></span> <span data-ttu-id="a634b-146">Расширенные свойства поля могут быть стандартными или зависящими от конкретного источника данных.</span><span class="sxs-lookup"><span data-stu-id="a634b-146">Extended field properties are predefined or specific to a data source type.</span></span> <span data-ttu-id="a634b-147">Дополнительные сведения см. в разделе [Расширенные свойства поля для базы данных служб Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="a634b-147">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
 <span data-ttu-id="a634b-148">Если указывается свойство, неподдерживаемое для этого поля, выражение принимает значение `null` (`Nothing` в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="a634b-148">If you specify a property that is not supported for that field, the expression evaluates to `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="a634b-149">Если расширенные свойства поля не поддерживаются поставщиком данных или поле не найдено при выполнении запроса, значением свойства будет `null` (`Nothing` в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) для свойств с типами `String` и `Object`, а свойствам типа `Integer` присваивается значение 0.</span><span class="sxs-lookup"><span data-stu-id="a634b-149">If a data provider does not support extended field properties, or if the field is not found when the query is executed, the value for the property is `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) for properties of type `String` and `Object`, and zero (0) for properties of type `Integer`.</span></span> <span data-ttu-id="a634b-150">Модуль обработки данных может использовать преимущества стандартных свойств, оптимизируя запросы, включающие следующий синтаксис.</span><span class="sxs-lookup"><span data-stu-id="a634b-150">A data processing extension may take advantage of predefined properties by optimizing queries that include this syntax.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a634b-151">См. также:</span><span class="sxs-lookup"><span data-stu-id="a634b-151">See Also</span></span>  
 <span data-ttu-id="a634b-152">[Примеры выражений (построитель отчетов и службы SSRS)](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="a634b-152">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="a634b-153">Добавление данных в построитель отчетов &#40;отчетов и SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="a634b-153">Add Data to a Report &#40;Report Builder and SSRS&#41;</span></span>](../report-data/report-datasets-ssrs.md)  
  
  
