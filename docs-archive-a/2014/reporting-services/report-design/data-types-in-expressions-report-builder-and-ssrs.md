---
title: Типы данных в выражениях (построитель отчетов и службы SSRS) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736101"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="c5f87-102">Типы данных в выражениях (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="c5f87-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="c5f87-103">Типы данных представляют разные виды данных, чтобы их можно было эффективно хранить и обрабатывать.</span><span class="sxs-lookup"><span data-stu-id="c5f87-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="c5f87-104">Стандартные типы данных включают текст (строки), числа с десятичными разрядами или без них, даты и время, а также изображения.</span><span class="sxs-lookup"><span data-stu-id="c5f87-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="c5f87-105">Значения в отчете должны быть представлены с помощью типов данных языка определения отчетов.</span><span class="sxs-lookup"><span data-stu-id="c5f87-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="c5f87-106">При отображении значения в отчете его можно отформатировать в соответствии с конкретными предпочтениями.</span><span class="sxs-lookup"><span data-stu-id="c5f87-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="c5f87-107">Например, поле, представляющее валюту, может храниться в определении отчета как число с плавающей запятой, но отображаться в различных форматах в зависимости от выбранного свойства формата.</span><span class="sxs-lookup"><span data-stu-id="c5f87-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="c5f87-108">Дополнительные сведения о форматах отображения см. в разделе [Форматирование элементов отчета (построитель отчетов и службы SSRS)](formatting-report-items-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="c5f87-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="c5f87-109">Типы данных языка определения отчетов и типы данных среды CLR</span><span class="sxs-lookup"><span data-stu-id="c5f87-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="c5f87-110">Значения, заданные в RDL-файле, должны иметь один из типов данных языка определения отчетов.</span><span class="sxs-lookup"><span data-stu-id="c5f87-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="c5f87-111">При компиляции и обработке отчета типы данных языка определения отчетов преобразуются в типы данных среды CLR.</span><span class="sxs-lookup"><span data-stu-id="c5f87-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="c5f87-112">В следующей таблице показаны применяемые преобразования, которые обозначены «По умолчанию».</span><span class="sxs-lookup"><span data-stu-id="c5f87-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="c5f87-113">Тип RDL</span><span class="sxs-lookup"><span data-stu-id="c5f87-113">RDL Type</span></span>|<span data-ttu-id="c5f87-114">Типы CLR</span><span class="sxs-lookup"><span data-stu-id="c5f87-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="c5f87-115">String</span><span class="sxs-lookup"><span data-stu-id="c5f87-115">String</span></span>|<span data-ttu-id="c5f87-116">По умолчанию: String</span><span class="sxs-lookup"><span data-stu-id="c5f87-116">Default: String</span></span><br /><br /> <span data-ttu-id="c5f87-117">Chart, GUID, Timespan</span><span class="sxs-lookup"><span data-stu-id="c5f87-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="c5f87-118">Логическое</span><span class="sxs-lookup"><span data-stu-id="c5f87-118">Boolean</span></span>|<span data-ttu-id="c5f87-119">По умолчанию: Boolean</span><span class="sxs-lookup"><span data-stu-id="c5f87-119">Default: Boolean</span></span>|  
|<span data-ttu-id="c5f87-120">Целое число</span><span class="sxs-lookup"><span data-stu-id="c5f87-120">Integer</span></span>|<span data-ttu-id="c5f87-121">По умолчанию: Int64</span><span class="sxs-lookup"><span data-stu-id="c5f87-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="c5f87-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span><span class="sxs-lookup"><span data-stu-id="c5f87-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="c5f87-123">Дата и время</span><span class="sxs-lookup"><span data-stu-id="c5f87-123">DateTime</span></span>|<span data-ttu-id="c5f87-124">По умолчанию: DateTime</span><span class="sxs-lookup"><span data-stu-id="c5f87-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="c5f87-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c5f87-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="c5f87-126">Float</span><span class="sxs-lookup"><span data-stu-id="c5f87-126">Float</span></span>|<span data-ttu-id="c5f87-127">По умолчанию: Double</span><span class="sxs-lookup"><span data-stu-id="c5f87-127">Default: Double</span></span><br /><br /> <span data-ttu-id="c5f87-128">Single, Decimal</span><span class="sxs-lookup"><span data-stu-id="c5f87-128">Single, Decimal</span></span>|  
|<span data-ttu-id="c5f87-129">Двоичные данные</span><span class="sxs-lookup"><span data-stu-id="c5f87-129">Binary</span></span>|<span data-ttu-id="c5f87-130">По умолчанию: Byte[]</span><span class="sxs-lookup"><span data-stu-id="c5f87-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="c5f87-131">Variant</span><span class="sxs-lookup"><span data-stu-id="c5f87-131">Variant</span></span>|<span data-ttu-id="c5f87-132">Любое из вышеприведенного, кроме Byte[]</span><span class="sxs-lookup"><span data-stu-id="c5f87-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="c5f87-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="c5f87-133">VariantArray</span></span>|<span data-ttu-id="c5f87-134">Массив данных типа Variant</span><span class="sxs-lookup"><span data-stu-id="c5f87-134">Array of Variant</span></span>|  
|<span data-ttu-id="c5f87-135">Упорядочиваемый уровень изоляции</span><span class="sxs-lookup"><span data-stu-id="c5f87-135">Serializable</span></span>|<span data-ttu-id="c5f87-136">Значение типа Variant или типов, отмеченных свойством Serializable или реализующих интерфейс ISerializable.</span><span class="sxs-lookup"><span data-stu-id="c5f87-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="c5f87-137">Общие сведения о типах данных и о записи выражений</span><span class="sxs-lookup"><span data-stu-id="c5f87-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="c5f87-138">Важно понимать типы данных при написании выражений, в которых сравниваются или сочетаются значения, например, при определении выражений группы или критериев фильтра либо при вычислении статистических значений.</span><span class="sxs-lookup"><span data-stu-id="c5f87-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="c5f87-139">Сравнения и вычисления допускаются только с элементами одного типа данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="c5f87-140">Если типы данных не совпадают, можно явно преобразовать тип данных в элементе отчета с помощью выражения.</span><span class="sxs-lookup"><span data-stu-id="c5f87-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="c5f87-141">Ниже описаны случаи, когда необходимо преобразовать один тип данных в другой.</span><span class="sxs-lookup"><span data-stu-id="c5f87-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="c5f87-142">Сравнение значения параметра отчета одного типа данных с полем набора данных другого типа.</span><span class="sxs-lookup"><span data-stu-id="c5f87-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="c5f87-143">Написание критерия фильтра, в котором сравниваются значения разных типов данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="c5f87-144">Написание выражения сортировки, в котором сочетаются поля, имеющие разный тип данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="c5f87-145">Написание выражений группы, в котором сочетаются поля, имеющие разный тип данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="c5f87-146">Преобразование значения, полученного из источника данных одного типа данных, в другой тип данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="c5f87-147">Определение типа данных в отчете</span><span class="sxs-lookup"><span data-stu-id="c5f87-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="c5f87-148">Чтобы определить тип данных элемента отчета, можно написать выражение, возвращающее тип данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="c5f87-149">Например, чтобы показать тип данных для поля `MyField`, добавьте к ячейке таблицы следующее выражение: `=Fields!MyField.Value.GetType().ToString()`.</span><span class="sxs-lookup"><span data-stu-id="c5f87-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="c5f87-150">Результат отображает тип данных CLR, используемый для представления поля `MyField`, например `System.String` или `System.DateTime`.</span><span class="sxs-lookup"><span data-stu-id="c5f87-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="c5f87-151">Преобразование полей набора данных в другой тип данных</span><span class="sxs-lookup"><span data-stu-id="c5f87-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="c5f87-152">Можно также преобразовать поля набора данных, прежде чем они будут использоваться в отчете.</span><span class="sxs-lookup"><span data-stu-id="c5f87-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="c5f87-153">В следующем списке описаны способы преобразования существующего поля набора данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="c5f87-154">Изменение запроса набора данных, чтобы добавить новое поле запроса с преобразованными данными.</span><span class="sxs-lookup"><span data-stu-id="c5f87-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="c5f87-155">В реляционных и многомерных источниках данных при этом способе в операции преобразования используются ресурсы источника данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="c5f87-156">Создание вычисляемого поля на основе существующего поля набора данных отчета с помощью выражения, преобразующего все данные одного столбца результирующего набора в данные нового столбца с другим типом данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="c5f87-157">Например, следующее выражение преобразует поле Year из целочисленного значения в строковое: `=CStr(Fields!Year.Value)`.</span><span class="sxs-lookup"><span data-stu-id="c5f87-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="c5f87-158">Дополнительные сведения см. в разделе [Добавление, изменение и обновление полей в области данных отчета (построитель отчетов и службы SSRS)](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="c5f87-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="c5f87-159">Проверка наличия метаданных в используемом модуле обработки данных с целью получения предварительно отформатированных данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="c5f87-160">Например, запрос многомерных выражений служб [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] включает расширенное свойство FORMATTED_VALUE для значений куба, отформатированных при обработке куба.</span><span class="sxs-lookup"><span data-stu-id="c5f87-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="c5f87-161">Дополнительные сведения см. в разделе [Расширенные свойства поля для базы данных служб Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="c5f87-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="c5f87-162">Основные сведения о типах данных параметров</span><span class="sxs-lookup"><span data-stu-id="c5f87-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="c5f87-163">Параметры отчета должны иметь один из пяти типов данных: Boolean, DateTime, Integer, Float или Text (также известный как String).</span><span class="sxs-lookup"><span data-stu-id="c5f87-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="c5f87-164">Если запрос набора данных включает параметры запроса, автоматически создаются параметры отчета, которые связываются с параметрами запроса.</span><span class="sxs-lookup"><span data-stu-id="c5f87-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="c5f87-165">Типом данных по умолчанию для параметра отчета является String.</span><span class="sxs-lookup"><span data-stu-id="c5f87-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="c5f87-166">Чтобы изменить тип данных по умолчанию параметра отчета, выберите нужное значение в раскрывающемся списке **Тип данных** на странице **Общие** в диалоговом окне **Свойства параметров отчета** .</span><span class="sxs-lookup"><span data-stu-id="c5f87-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c5f87-167">Параметры отчета с типами данных DateTime не поддерживают миллисекунды.</span><span class="sxs-lookup"><span data-stu-id="c5f87-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="c5f87-168">После создания параметра на основе значений, содержащих миллисекунды, нельзя выбрать значение из раскрывающегося списка доступных значений Date или Time, включающих миллисекунды.</span><span class="sxs-lookup"><span data-stu-id="c5f87-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="c5f87-169">Написание выражений, преобразующих типы данных или получающих части данных</span><span class="sxs-lookup"><span data-stu-id="c5f87-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="c5f87-170">При объединении текста и полей набора данных с помощью оператора объединения (&) среда CLR обычно предоставляет форматы по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c5f87-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="c5f87-171">Если нужно явно преобразовать поле набора данных или параметр в конкретный тип данных, для преобразования данных необходимо использовать метод CLR или функцию библиотеки времени выполнения Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="c5f87-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="c5f87-172">В следующей таблице приводятся примеры преобразования типов данных.</span><span class="sxs-lookup"><span data-stu-id="c5f87-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="c5f87-173">Тип преобразования</span><span class="sxs-lookup"><span data-stu-id="c5f87-173">Type of conversion</span></span>|<span data-ttu-id="c5f87-174">Пример</span><span class="sxs-lookup"><span data-stu-id="c5f87-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="c5f87-175">DateTime в String</span><span class="sxs-lookup"><span data-stu-id="c5f87-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="c5f87-176">String в DateTime</span><span class="sxs-lookup"><span data-stu-id="c5f87-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="c5f87-177">String в DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c5f87-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="c5f87-178">Получение года</span><span class="sxs-lookup"><span data-stu-id="c5f87-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="c5f87-179">Boolean в Integer</span><span class="sxs-lookup"><span data-stu-id="c5f87-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="c5f87-180">-1 соответствует значению True, а 0 — значению False.</span><span class="sxs-lookup"><span data-stu-id="c5f87-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="c5f87-181">Boolean в Integer</span><span class="sxs-lookup"><span data-stu-id="c5f87-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="c5f87-182">1 соответствует значению True, а 0 соответствует значению False.</span><span class="sxs-lookup"><span data-stu-id="c5f87-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="c5f87-183">Только часть DateTime значения DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c5f87-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="c5f87-184">Только часть Offset значения DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c5f87-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="c5f87-185">Для управления отображаемым форматом значений можно также использовать функцию Format.</span><span class="sxs-lookup"><span data-stu-id="c5f87-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="c5f87-186">Дополнительные сведения см. в разделе [Функции (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span><span class="sxs-lookup"><span data-stu-id="c5f87-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="c5f87-187">Дополнительные примеры</span><span class="sxs-lookup"><span data-stu-id="c5f87-187">Advanced Examples</span></span>  
 <span data-ttu-id="c5f87-188">При соединении с источником данных поставщика данных, не поддерживающим преобразование всех типов данных, типом данных по умолчанию для неподдерживаемых типов является String.</span><span class="sxs-lookup"><span data-stu-id="c5f87-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="c5f87-189">В следующих примерах приводятся решения для конкретных типов данных, которые возвращаются как String.</span><span class="sxs-lookup"><span data-stu-id="c5f87-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="c5f87-190">Объединение типов данных String и DateTimeOffset среды CLR</span><span class="sxs-lookup"><span data-stu-id="c5f87-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="c5f87-191">Для большинства типов данных среда CLR обеспечивает преобразования по умолчанию для объединения значений, имеющих разный тип данных, в одну строку с помощью оператора &.</span><span class="sxs-lookup"><span data-stu-id="c5f87-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="c5f87-192">Например, следующее выражение объединяет текст "The date and time are: " с полем набора данных StartDate, которое является значением <xref:System.DateTime> : `="The date and time are: " & Fields!StartDate.Value`.</span><span class="sxs-lookup"><span data-stu-id="c5f87-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="c5f87-193">Для некоторых типов данных может понадобиться включение функции ToString.</span><span class="sxs-lookup"><span data-stu-id="c5f87-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="c5f87-194">Например, в следующем выражении показан тот же пример с использованием типа данных CLR <xref:System.DateTimeOffset>, который включает дату, время и смещение часового пояса относительно часового пояса времени в формате UTC: `="The time is: " & Fields!StartDate.Value.ToString()`.</span><span class="sxs-lookup"><span data-stu-id="c5f87-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="c5f87-195">Преобразование строкового типа данных в тип данных DateTime среды CLR</span><span class="sxs-lookup"><span data-stu-id="c5f87-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="c5f87-196">Если модуль обработки данных не поддерживает все определенные в источнике данных типы данных, данные могут быть получены в виде текста.</span><span class="sxs-lookup"><span data-stu-id="c5f87-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="c5f87-197">Например, значение с типом данных `datetimeoffset(7)` можно получить как значение String.</span><span class="sxs-lookup"><span data-stu-id="c5f87-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="c5f87-198">В Перте, Австралия, строковое значение для 1 июля 2008 6:05:07.9999999 утра</span><span class="sxs-lookup"><span data-stu-id="c5f87-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="c5f87-199">будет напоминать следующий текст:</span><span class="sxs-lookup"><span data-stu-id="c5f87-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="c5f87-200">В этом примере показана дата (1 июля 2008), за которой следует время с 7-значной точностью (6:05:07.9999999 утра) и смещение часового пояса времени в формате UTC в часах и минутах (+ 8 часов 0 минут).</span><span class="sxs-lookup"><span data-stu-id="c5f87-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="c5f87-201">В следующих примерах это значение помещается в поле с типом данных `String` с именем `MyDateTime.Value`.</span><span class="sxs-lookup"><span data-stu-id="c5f87-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="c5f87-202">Для преобразования этой даты в одно или несколько значений CLR можно воспользоваться одним из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="c5f87-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="c5f87-203">В текстовом поле получите часть строки с помощью выражения.</span><span class="sxs-lookup"><span data-stu-id="c5f87-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="c5f87-204">Пример:</span><span class="sxs-lookup"><span data-stu-id="c5f87-204">For example:</span></span>  
  
    -   <span data-ttu-id="c5f87-205">Следующее выражение возвращает часть строки, относящуюся к часу смещения часового пояса времени в формате UTC, и преобразует ее в минуты: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="c5f87-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="c5f87-206">Результат `480`.</span><span class="sxs-lookup"><span data-stu-id="c5f87-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="c5f87-207">Следующее выражение преобразует строку в значение даты и времени: `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="c5f87-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="c5f87-208">Если строка `MyDateTime.Value` содержит значение смещения времени в формате UTC, то функция `DateTime.Parse` сначала изменит смещение времени в формате UTC (7:00 утра</span><span class="sxs-lookup"><span data-stu-id="c5f87-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="c5f87-209">- [`+08:00`] относительно времени в формате UTC 23:00</span><span class="sxs-lookup"><span data-stu-id="c5f87-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="c5f87-210">предыдущего вечера).</span><span class="sxs-lookup"><span data-stu-id="c5f87-210">the night before).</span></span> <span data-ttu-id="c5f87-211">Затем функция `DateTime.Parse` применяет локальное смещение времени в формате UTC сервера отчетов и при необходимости настраивает переход на летнее время.</span><span class="sxs-lookup"><span data-stu-id="c5f87-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="c5f87-212">Например, в Ричмонде, штат Вашингтон, смещение локального времени с переходом на летнее время составляет `[-07:00]`, или на 7 часов раньше 23:00.</span><span class="sxs-lookup"><span data-stu-id="c5f87-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="c5f87-213">Результатом является следующее значение типа `DateTime`: `2007-07-06 04:07:07 PM` (6 июля 2007 г., 16:07).</span><span class="sxs-lookup"><span data-stu-id="c5f87-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="c5f87-214">Дополнительные сведения о преобразовании строк в `DateTime` типы данных см. в статьях [Анализ строк даты и времени](https://go.microsoft.com/fwlink/?LinkId=89703), [Форматирование даты и времени для определенной культуры](https://go.microsoft.com/fwlink/?LinkId=89704)и [Выбор между DateTime, DateTimeOffset и TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="c5f87-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="c5f87-215">Добавление нового вычисляемого поля к набору данных отчета, который использует выражение для получения части строки.</span><span class="sxs-lookup"><span data-stu-id="c5f87-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="c5f87-216">Дополнительные сведения см. в разделе [Добавление, изменение и обновление полей в области данных отчета (построитель отчетов и службы SSRS)](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="c5f87-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="c5f87-217">Изменение запроса набора данных отчета, чтобы использовать функции [!INCLUDE[tsql](../../includes/tsql-md.md)] для независимого получения значений даты и времени и создания отдельных столбцов.</span><span class="sxs-lookup"><span data-stu-id="c5f87-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="c5f87-218">В следующем примере показано использование функции `DatePart` для добавления столбца к году и столбца к смещению часового пояса времени в формате UTC, преобразованного в минуты:</span><span class="sxs-lookup"><span data-stu-id="c5f87-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="c5f87-219">Результирующий набор содержит три столбца.</span><span class="sxs-lookup"><span data-stu-id="c5f87-219">The result set has three columns.</span></span> <span data-ttu-id="c5f87-220">Первый столбец представляет дату и время, второй — год, а третий содержит значение смещения времени в формате UTC в минутах.</span><span class="sxs-lookup"><span data-stu-id="c5f87-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="c5f87-221">В следующей строке показаны данные примера:</span><span class="sxs-lookup"><span data-stu-id="c5f87-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="c5f87-222">Дополнительные сведения о типах данных баз данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] см. в разделах [Типы данных &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) и [Типы данных и функции даты и времени &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql)[электронной документации по SQL Server](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="c5f87-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="c5f87-223">Дополнительные сведения о типах данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] см. в разделе [Типы данных в службах Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services)[SQL Server Books Onle](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="c5f87-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5f87-224">См. также:</span><span class="sxs-lookup"><span data-stu-id="c5f87-224">See Also</span></span>  
 [<span data-ttu-id="c5f87-225">Форматирование элементов отчета (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="c5f87-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  
