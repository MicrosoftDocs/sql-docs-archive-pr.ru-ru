---
title: Ссылки на коллекцию ReportItems (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: edc0c75f-0530-4e6d-85aa-3385301bfd00
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 61c89002adafb030288535debfe72de061945640
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87728049"
---
# <a name="reportitems-collection-references-report-builder-and-ssrs"></a><span data-ttu-id="c933f-102">Ссылки на коллекцию ReportItems (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="c933f-102">ReportItems Collection References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="c933f-103">Встроенная коллекция `ReportItems` является набором текстовых полей из элементов отчета, например строк области данных или текстовых полей в области конструктора отчетов.</span><span class="sxs-lookup"><span data-stu-id="c933f-103">The `ReportItems` built-in collection is the set of text boxes from report items such as rows of a data region or text boxes on the report design surface.</span></span> <span data-ttu-id="c933f-104">Коллекция `ReportItems` включает текстовые поля, находящиеся в текущей области верхнего колонтитула, нижнего колонтитула или текста отчета.</span><span class="sxs-lookup"><span data-stu-id="c933f-104">The `ReportItems` collection includes text boxes that are in the current scope of a page header, page footer, or report body.</span></span> <span data-ttu-id="c933f-105">Эта коллекция определяется во время выполнения обработчика отчетов и модуля подготовки отчетов.</span><span class="sxs-lookup"><span data-stu-id="c933f-105">This collection is determined at run time by the report processor and the report renderer.</span></span> <span data-ttu-id="c933f-106">Текущая область изменяется после успешного объединения обработчиком отчетов данных отчета и элементов макета элементов отчета, когда пользователь просматривает страницы отчета.</span><span class="sxs-lookup"><span data-stu-id="c933f-106">The current scope changes as the report processor successively combines report data and the report item layout elements as the user views pages of a report.</span></span> <span data-ttu-id="c933f-107">Встроенная коллекция `ReportItems` может использоваться для формирования колонтитулов страницы в стиле словаря, в котором на каждой странице указываются первый и последний элемент.</span><span class="sxs-lookup"><span data-stu-id="c933f-107">You can use the `ReportItems` built-in collection to produce dictionary-style page headers that show the first and last items on each page.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="using-the-reportitems-value-property"></a><span data-ttu-id="c933f-108">Использования свойства значения ReportItems</span><span class="sxs-lookup"><span data-stu-id="c933f-108">Using the ReportItems Value Property</span></span>  
 <span data-ttu-id="c933f-109">Элементы коллекции `ReportItems` имеют только одно свойство: Value.</span><span class="sxs-lookup"><span data-stu-id="c933f-109">Items within the `ReportItems` collection have only one property: Value.</span></span> <span data-ttu-id="c933f-110">Значение элемента `ReportItems` может использоваться для отображения или вычисления данных из другого поля отчета.</span><span class="sxs-lookup"><span data-stu-id="c933f-110">The value for a `ReportItems` item can be used to display or calculate data from another field in the report.</span></span> <span data-ttu-id="c933f-111">Чтобы получить доступ к значению текущего текстового поля, можно использовать встроенное в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] глобальное выражение Me.Value или просто Value.</span><span class="sxs-lookup"><span data-stu-id="c933f-111">To access the value of the current text box, you can use the [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] built-in global Me.Value or simply Value.</span></span> <span data-ttu-id="c933f-112">Однако в функциях отчета, таких как First и агрегатных функциях, необходимо использовать полный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="c933f-112">In report functions such as First and aggregate functions, use the fully qualified syntax.</span></span>  
  
 <span data-ttu-id="c933f-113">Пример:</span><span class="sxs-lookup"><span data-stu-id="c933f-113">For example:</span></span>  
  
-   <span data-ttu-id="c933f-114">Это выражение, помещенное в текстовое поле, отображает значение текстового поля `ReportItem` с именем `Textbox1`:</span><span class="sxs-lookup"><span data-stu-id="c933f-114">This expression, placed in a text box, displays the value of a `ReportItem` text box named `Textbox1`:</span></span>  
  
     `=ReportItems!Textbox1.Value`  
  
-   <span data-ttu-id="c933f-115">Это выражение, помещенное в `ReportItem` свойство цвета текстового поля, отображает текст в черном виде, если значение равно > 0; в противном случае значение отображается красным цветом:</span><span class="sxs-lookup"><span data-stu-id="c933f-115">This expression, placed in a `ReportItem` text box Color property, displays the text in black when the value is > 0; otherwise, the value is displayed in red:</span></span>  
  
     `=IIF(Me.Value > 0,"Black","Red")`  
  
-   <span data-ttu-id="c933f-116">Это выражение, помещенное в текстовое поле верхнего или нижнего колонтитула, отображает на каждой странице отчета, готового для просмотра, первое значение текстового поля `LastName`:</span><span class="sxs-lookup"><span data-stu-id="c933f-116">This expression, placed in a text box in the page header or page footer, displays the first value per page of the rendered report, for a text box named `LastName`:</span></span>  
  
     `=First(ReportItems("LastName").Value)`  
  
## <a name="dictionary-style-page-header-expressions"></a><span data-ttu-id="c933f-117">Выражения колонтитулов в стиле словаря</span><span class="sxs-lookup"><span data-stu-id="c933f-117">Dictionary-Style Page Header Expressions</span></span>  
 <span data-ttu-id="c933f-118">Можно создать верхний колонтитул, который будет отображать на странице первого и последнего клиентов.</span><span class="sxs-lookup"><span data-stu-id="c933f-118">You can create a page header to display the first customer on the page and the last customer on the page.</span></span> <span data-ttu-id="c933f-119">Так как текстовое поле в верхнем колонтитуле может ссылаться на встроенную коллекцию `ReportItems` только один раз в выражении, необходимо добавить в верхний колонтитул два текстовых поля: одно для имени первого клиента (`=First(ReportItems!textboxLastName.Value`), второе для имени последнего клиента (`=Last(ReportItems!textboxLastName.Value`).</span><span class="sxs-lookup"><span data-stu-id="c933f-119">Because a text box in the page header can only refer to the `ReportItems` built-in collection once in an expression, you need to add two text boxes to the page header: one for the first customer name (`=First(ReportItems!textboxLastName.Value`) and one for the last customer name (`=Last(ReportItems!textboxLastName.Value`).</span></span>  
  
 <span data-ttu-id="c933f-120">В разделе верхнего или нижнего колонтитула только текстовые поля текущей страницы доступны как члены коллекции `ReportItems`.</span><span class="sxs-lookup"><span data-stu-id="c933f-120">In a page header or page footer section, only text boxes on the current page are available as a member of the `ReportItems` collection.</span></span> <span data-ttu-id="c933f-121">Например, если выражение `ReportItems!textboxLastName.Value` ссылается на текстовое поле, которое появляется только на первой странице многостраничной области данных, значение видно для первой страницы, но на всех других страницах отображается **#Ошибка** , показывая, что выражение не может быть оценено в том виде, в каком оно записано.</span><span class="sxs-lookup"><span data-stu-id="c933f-121">For example, if `ReportItems!textboxLastName.Value` refers to a text box that only appears on the first page for a multipage data region, you see a value for the first page, but all other pages display **#Error** to show the expression could not be evaluated as written.</span></span>  
  
## <a name="scope-for-the-reportitems-collection"></a><span data-ttu-id="c933f-122">Область коллекции ReportItems</span><span class="sxs-lookup"><span data-stu-id="c933f-122">Scope for the ReportItems Collection</span></span>  
 <span data-ttu-id="c933f-123">При выполнении отчета каждое текстовое поле в теле отчета или в области данных оценивается в контексте его набора данных, области данных и взаимосвязей групп.</span><span class="sxs-lookup"><span data-stu-id="c933f-123">As the report is processed, each text box in the report body or in a data region is evaluated in the context of its dataset, data region, and group associations.</span></span> <span data-ttu-id="c933f-124">Областью для ссылки на коллекцию `ReportItems` является текущая область или любая точка, находящаяся выше текущей области.</span><span class="sxs-lookup"><span data-stu-id="c933f-124">The scope for a reference to the `ReportItems` collection is the current scope or any point higher than the current scope.</span></span>  
  
 <span data-ttu-id="c933f-125">Например, текстовое поле в строке, находящейся в родительской группе, не должно содержать выражение, ссылающееся на имя текстового поля в строке дочерней группы.</span><span class="sxs-lookup"><span data-stu-id="c933f-125">For example, a text box in a row that is in a parent group must not contain an expression that refers to the name of a text box in a child group row.</span></span> <span data-ttu-id="c933f-126">Результат вычисления такого выражения отличается от значения в отчете, т. к. текстовое поле дочерней строки расположено вне этой области.</span><span class="sxs-lookup"><span data-stu-id="c933f-126">Such an expression does not resolve to a value in the report because the child row text box is out of scope.</span></span> <span data-ttu-id="c933f-127">Дополнительные сведения см. в разделах [Справочник по агрегатным функциям (построитель отчетов и службы SSRS)](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="c933f-127">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c933f-128">См. также:</span><span class="sxs-lookup"><span data-stu-id="c933f-128">See Also</span></span>  
 <span data-ttu-id="c933f-129">[Встроенные коллекции в выражениях (построитель отчетов и службы SSRS)](built-in-collections-in-expressions-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="c933f-129">[Built-in Collections in Expressions &#40;Report Builder and SSRS&#41;](built-in-collections-in-expressions-report-builder.md) </span></span>  
 <span data-ttu-id="c933f-130">[Примеры выражений (построитель отчетов и службы SSRS)](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="c933f-130">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="c933f-131">[Разбиение на страницы в службах Reporting Services (построитель отчетов и службы SSRS)](pagination-in-reporting-services-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="c933f-131">[Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="c933f-132">Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="c933f-132">Filter, Group, and Sort Data &#40;Report Builder and SSRS&#41;</span></span>](filter-group-and-sort-data-report-builder-and-ssrs.md)  
  
  
