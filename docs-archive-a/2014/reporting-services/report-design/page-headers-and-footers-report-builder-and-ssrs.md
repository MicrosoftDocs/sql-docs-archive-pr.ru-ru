---
title: Верхние и нижние колонтитулы страницы (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- sql12.rtp.rptdesigner.pagefooter.fill.f1
- "10125"
- "10121"
- "10120"
- "10122"
- "10123"
- sql12.rtp.rptdesigner.pageheader.border.f1
- sql12.rtp.rptdesigner.pageheader.general.f1
- sql12.rtp.rptdesigner.pagefooter.border.f1
- sql12.rtp.rptdesigner.pageheader.fill.f1
- sql12.rtp.rptdesigner.pagefooter.general.f1
- "10124"
ms.assetid: 4fb9faac-511e-404a-b8d7-1f2e3cb47b11
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: d534833a6820c9924e69ae0575341d578b746732
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87659443"
---
# <a name="page-headers-and-footers-report-builder-and-ssrs"></a><span data-ttu-id="6b841-102">Верхние и нижние колонтитулы страницы (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="6b841-102">Page Headers and Footers (Report Builder and SSRS)</span></span>
  <span data-ttu-id="6b841-103">Отчет может содержать верхний и нижний колонтитулы, которые располагаются в верхней и нижней части каждой страницы соответственно.</span><span class="sxs-lookup"><span data-stu-id="6b841-103">A report can contain a header and footer that run along the top and bottom of each page, respectively.</span></span> <span data-ttu-id="6b841-104">Верхние и нижние колонтитулы могут содержать статический текст, изображения, линии, прямоугольники, границы, цвет фона, фоновые изображения и выражения.</span><span class="sxs-lookup"><span data-stu-id="6b841-104">Headers and footers can contain static text, images, lines, rectangles, borders, background color, background images, and expressions.</span></span> <span data-ttu-id="6b841-105">Выражения включают ссылки на поля набора данных для отчетов, имеющих один и только один набор данных, а также вызовы агрегатных функций, которые включают набор данных в качестве области.</span><span class="sxs-lookup"><span data-stu-id="6b841-105">Expressions include dataset field references for reports with exactly one dataset and aggregate function calls that include the dataset as a scope.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6b841-106">Каждый модуль подготовки отчетов обрабатывает страницы по-разному.</span><span class="sxs-lookup"><span data-stu-id="6b841-106">Each rendering extension processes pages differently.</span></span> <span data-ttu-id="6b841-107">Дополнительные сведения о разбиении отчета на страницы и модулях подготовки отчетов см. в разделе [Разбиение на страницы в службах Reporting Services (построитель отчетов и службы SSRS)](pagination-in-reporting-services-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-107">For more information about report pagination and rendering extensions, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="6b841-108">По умолчанию, отчеты содержат нижние колонтитулы, но не содержат верхние.</span><span class="sxs-lookup"><span data-stu-id="6b841-108">By default, reports have page footers, but not page headers.</span></span> <span data-ttu-id="6b841-109">Дополнительные сведения о том, как добавлять или удалять их, см. в разделе [Добавление или удаление верхнего или нижнего колонтитула страницы (построитель отчетов и службы SSRS)](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-109">For more information about how to add or remove them, see [Add or Remove a Page Header or Footer &#40;Report Builder and SSRS&#41;](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="6b841-110">Верхние и нижние колонтитулы обычно содержат номера страниц, заголовки отчетов и другие свойства отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-110">Headers and footers commonly contain page numbers, report titles, and other report properties.</span></span> <span data-ttu-id="6b841-111">Дополнительные сведения о том, как добавить эти элементы в верхний или нижний колонтитул страницы отчета, см. в разделе [Отображение номеров страниц или других свойств отчета (построитель отчетов и службы SSRS)](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-111">For more information about how to add these items to your report header or footer, see [Display Page Numbers or Other Report Properties &#40;Report Builder and SSRS&#41;](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="6b841-112">После создания верхнего или нижнего колонтитула страницы он отображается на каждой странице отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-112">After you create a page header or footer, it is displayed on each report page.</span></span> <span data-ttu-id="6b841-113">Дополнительные сведения о том, как скрыть верхние и нижние колонтитулы на первой и последней страницах, см. в разделе [Скрытие верхнего или нижнего колонтитула первой или последней страницы (построитель отчетов и службы SSRS)](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-113">For more information about how to suppress page headers and footers on the first and last pages, see [Hide a Page Header or Footer on the First or Last Page &#40;Report Builder and SSRS&#41;](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-headers-and-footers"></a><span data-ttu-id="6b841-114">Верхние и нижние колонтитулы отчета</span><span class="sxs-lookup"><span data-stu-id="6b841-114">Report Headers and Footers</span></span>  
 <span data-ttu-id="6b841-115">Верхние и нижние колонтитулы страницы не следует путать с верхними и нижними колонтитулами отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-115">Page headers and footers are not the same as report headers and footers.</span></span> <span data-ttu-id="6b841-116">В отчетах не предусмотрены специальные области верхнего или нижнего колонтитула отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-116">Reports do not have a special report header or report footer area.</span></span> <span data-ttu-id="6b841-117">Верхний колонтитул отчета состоит из элементов отчета, которые помещены в верхней части текста отчета в области конструктора отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-117">A report header consists of the report items that are placed at the top of the report body on the report design surface.</span></span> <span data-ttu-id="6b841-118">Эти элементы появляются только один раз в качестве первого содержимого в отчете.</span><span class="sxs-lookup"><span data-stu-id="6b841-118">They appear only once as the first content in the report.</span></span> <span data-ttu-id="6b841-119">Нижний колонтитул отчета состоит из элементов отчета, которые помещены в нижней части текста отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-119">A report footer consists of report items that are placed at the bottom of the report body.</span></span> <span data-ttu-id="6b841-120">Эти элементы появляются только один раз в качестве последнего содержимого в отчете.</span><span class="sxs-lookup"><span data-stu-id="6b841-120">They appear only once as the last content in the report.</span></span>  
  
## <a name="displaying-variable-data-in-a-page-header-or-footer"></a><span data-ttu-id="6b841-121">Отображение изменяющихся данных в верхнем или нижнем колонтитуле страницы</span><span class="sxs-lookup"><span data-stu-id="6b841-121">Displaying Variable Data in a Page Header or Footer</span></span>  
 <span data-ttu-id="6b841-122">Верхние и нижние колонтитулы страниц могут включать статическое содержимое, но в основном используются для отображения изменяющегося содержимого, такого как номер страницы или сведения о содержимом страницы.</span><span class="sxs-lookup"><span data-stu-id="6b841-122">Page headers and footers can contain static content, but they are more commonly used to display varying content like page numbers or information about the contents of a page.</span></span> <span data-ttu-id="6b841-123">Чтобы отобразить изменяющиеся данных, разные для каждой страницы, необходимо использовать выражение.</span><span class="sxs-lookup"><span data-stu-id="6b841-123">To display variable data that is different on each page, you must use an expression.</span></span>  
  
 <span data-ttu-id="6b841-124">Если в отчете определен только один набор данных, то в верхний или нижний колонтитул страницы можно добавить простые выражения, такие как `[FieldName]` .</span><span class="sxs-lookup"><span data-stu-id="6b841-124">If there is only one dataset defined in the report, you can add simple expressions such as `[FieldName]` to a page header or footer.</span></span> <span data-ttu-id="6b841-125">Перетащите поле из набора данных области данных отчета или коллекции «Встроенные поля» в верхний или нижний колонтитул страницы.</span><span class="sxs-lookup"><span data-stu-id="6b841-125">Drag the field from the Report Data pane dataset field collection or the Built-in Fields collection to the page header or page footer.</span></span> <span data-ttu-id="6b841-126">От имени пользователя будет автоматически добавлено текстовое поле с подходящим выражением.</span><span class="sxs-lookup"><span data-stu-id="6b841-126">A text box with the appropriate expression is automatically added for you.</span></span>  
  
 <span data-ttu-id="6b841-127">Чтобы можно было вычислять суммы или другие статистические данные, относящиеся к значениям на странице, можно использовать статистические выражения, в которых заданы значения ReportItems или имя набора данных.</span><span class="sxs-lookup"><span data-stu-id="6b841-127">To calculate sums or other aggregates for values on the page, you can use aggregate expressions that specify ReportItems or the name of a dataset.</span></span> <span data-ttu-id="6b841-128">Коллекция ReportItems представляет собой коллекцию текстовых полей на каждой странице, созданную после подготовки отчета к отображению.</span><span class="sxs-lookup"><span data-stu-id="6b841-128">The ReportItems collection is the collection of text boxes on each page after report rendering occurs.</span></span> <span data-ttu-id="6b841-129">Имя набора данных должно существовать в определении отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-129">The dataset name must exist in the report definition.</span></span> <span data-ttu-id="6b841-130">В следующей таблице показано, какие элементы поддерживаются в статистическом выражении каждого типа:</span><span class="sxs-lookup"><span data-stu-id="6b841-130">The following table displays which items are supported in each type of aggregate expression:</span></span>  
  
|<span data-ttu-id="6b841-131">Поддерживается в выражении</span><span class="sxs-lookup"><span data-stu-id="6b841-131">Supported in expression</span></span>|<span data-ttu-id="6b841-132">Статистические выражения ReportItems</span><span class="sxs-lookup"><span data-stu-id="6b841-132">ReportItems aggregates</span></span>|<span data-ttu-id="6b841-133">Статистические выражения набора данных (в качестве области должно быть указано имя набора данных)</span><span class="sxs-lookup"><span data-stu-id="6b841-133">Dataset aggregates (scope must be name of dataset)</span></span>|  
|-----------------------------|----------------------------|----------------------------------------------------------|  
|<span data-ttu-id="6b841-134">Текстовые поля в тексте отчета</span><span class="sxs-lookup"><span data-stu-id="6b841-134">Text boxes in body of report</span></span>|<span data-ttu-id="6b841-135">Да</span><span class="sxs-lookup"><span data-stu-id="6b841-135">Yes</span></span>|<span data-ttu-id="6b841-136">нет</span><span class="sxs-lookup"><span data-stu-id="6b841-136">No</span></span>|  
|<span data-ttu-id="6b841-137">&PageNumber</span><span class="sxs-lookup"><span data-stu-id="6b841-137">&PageNumber</span></span>|<span data-ttu-id="6b841-138">Да</span><span class="sxs-lookup"><span data-stu-id="6b841-138">Yes</span></span>|<span data-ttu-id="6b841-139">нет</span><span class="sxs-lookup"><span data-stu-id="6b841-139">No</span></span>|  
|<span data-ttu-id="6b841-140">&TotalPages</span><span class="sxs-lookup"><span data-stu-id="6b841-140">&TotalPages</span></span>|<span data-ttu-id="6b841-141">Да</span><span class="sxs-lookup"><span data-stu-id="6b841-141">Yes</span></span>|<span data-ttu-id="6b841-142">нет</span><span class="sxs-lookup"><span data-stu-id="6b841-142">No</span></span>|  
|<span data-ttu-id="6b841-143">Агрегатная функция</span><span class="sxs-lookup"><span data-stu-id="6b841-143">Aggregate function</span></span>|<span data-ttu-id="6b841-144">Да.</span><span class="sxs-lookup"><span data-stu-id="6b841-144">Yes.</span></span> <span data-ttu-id="6b841-145">Например,</span><span class="sxs-lookup"><span data-stu-id="6b841-145">For example,</span></span><br /><br /> `=First(ReportItems!TXT_LastName.Value)`|<span data-ttu-id="6b841-146">Да.</span><span class="sxs-lookup"><span data-stu-id="6b841-146">Yes.</span></span> <span data-ttu-id="6b841-147">Например,</span><span class="sxs-lookup"><span data-stu-id="6b841-147">For example,</span></span><br /><br /> `=Max(Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="6b841-148">Коллекция полей для элементов на странице</span><span class="sxs-lookup"><span data-stu-id="6b841-148">Fields collection for items on the page</span></span>|<span data-ttu-id="6b841-149">Косвенно.</span><span class="sxs-lookup"><span data-stu-id="6b841-149">Indirectly.</span></span> <span data-ttu-id="6b841-150">Например,</span><span class="sxs-lookup"><span data-stu-id="6b841-150">For example,</span></span><br /><br /> `=Sum(ReportItems!Textbox1.Value)`|<span data-ttu-id="6b841-151">Да.</span><span class="sxs-lookup"><span data-stu-id="6b841-151">Yes.</span></span> <span data-ttu-id="6b841-152">Например,</span><span class="sxs-lookup"><span data-stu-id="6b841-152">For example,</span></span><br /><br /> `=Sum(Fields!Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="6b841-153">Изображение, привязанное к данным</span><span class="sxs-lookup"><span data-stu-id="6b841-153">Data-bound image</span></span>|<span data-ttu-id="6b841-154">Косвенно.</span><span class="sxs-lookup"><span data-stu-id="6b841-154">Indirectly.</span></span> <span data-ttu-id="6b841-155">Например `=ReportItems!TXT_Photo.Value`.</span><span class="sxs-lookup"><span data-stu-id="6b841-155">For example, `=ReportItems!TXT_Photo.Value`</span></span>|<span data-ttu-id="6b841-156">Да.</span><span class="sxs-lookup"><span data-stu-id="6b841-156">Yes.</span></span> <span data-ttu-id="6b841-157">Например,</span><span class="sxs-lookup"><span data-stu-id="6b841-157">For example,</span></span><br /><br /> `=First(Fields!Photo.Value,"DataSet1")`|  
  
 <span data-ttu-id="6b841-158">Следующие подразделы этого раздела содержат готовые к использованию выражения, получающие переменные данные, обычно используемые в колонтитулах.</span><span class="sxs-lookup"><span data-stu-id="6b841-158">The following sections in this topic show ready-to-use expressions that get variable data commonly used in headers and footers.</span></span> <span data-ttu-id="6b841-159">Этот раздел также содержит сведения о том, как модуль подготовки отчетов в формате Excel обрабатывает верхние и нижние колонтитулы.</span><span class="sxs-lookup"><span data-stu-id="6b841-159">There is also a section on how the Excel rendering extension processes headers and footers.</span></span> <span data-ttu-id="6b841-160">Дополнительные сведения о выражениях см. в разделе [Выражения (построитель отчетов и службы SSRS)](expressions-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-160">For more information about expressions, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md).</span></span>  
  
### <a name="adding-calculated-page-totals-to-a-header-or-footer"></a><span data-ttu-id="6b841-161">Добавление вычисляемых суммарных показателей страниц в колонтитул</span><span class="sxs-lookup"><span data-stu-id="6b841-161">Adding Calculated Page Totals to a Header or Footer</span></span>  
 <span data-ttu-id="6b841-162">Применительно к некоторым отчетам бывает удобно включить в верхний или нижний колонтитул каждого отчета вычисляемое значение (например, общую сумму по странице, если страница содержит числовые значения).</span><span class="sxs-lookup"><span data-stu-id="6b841-162">For some reports, it is useful to include a calculated value in the header or footer of each report; for example, a per-page sum total if the page includes numeric values.</span></span> <span data-ttu-id="6b841-163">Но на поля нельзя ссылаться непосредственно, поэтому в верхний или нижний колонтитул необходимо поместить ссылку на имя элемента отчета (например, на текстовое поле), а не на поле данных.</span><span class="sxs-lookup"><span data-stu-id="6b841-163">Because you cannot reference the fields directly, the expression that you put in the header or footer must reference the name of the report item (for example, a text box) rather than the data field:</span></span>  
  
 `=Sum(ReportItems!Textbox1.Value)`  
  
 <span data-ttu-id="6b841-164">Если текстовое поле находится в таблице или списке, содержащих повторяющиеся строки данных, то значение, выводимое во время выполнения в верхнем или нижнем колонтитуле, будет суммой всех значений экземпляра данных `TextBox1` в таблице или в списке для текущей страницы.</span><span class="sxs-lookup"><span data-stu-id="6b841-164">If the text box is in a table or list that contains repeated rows of data, the value that appears in the header or footer at run time is a sum of all values of all `TextBox1` instance data in the table or list for the current page.</span></span>  
  
 <span data-ttu-id="6b841-165">При вычислении суммарных показателей страниц при использовании различных модулей подготовки отчета можно ожидать, что будут выводиться различные цифры.</span><span class="sxs-lookup"><span data-stu-id="6b841-165">When calculating page totals, you can expect to see differences in the totals when you use different rendering extensions to view the report.</span></span> <span data-ttu-id="6b841-166">Зависящие от страниц данные будут рассчитываться по-разному для каждого из модулей подготовки отчетов.</span><span class="sxs-lookup"><span data-stu-id="6b841-166">Paginated output is calculated differently for each rendering extension.</span></span> <span data-ttu-id="6b841-167">Одна и та же страница может содержать различные итоговые значения при просмотре в формате HTML и в формате PDF, если на одну страницу в PDF приходится разное количество данных.</span><span class="sxs-lookup"><span data-stu-id="6b841-167">The same page that you view in HTML might show different totals when viewed in PDF if the amount of data on the PDF page is different.</span></span> <span data-ttu-id="6b841-168">Дополнительные сведения см. в разделе [Поведение при подготовке к просмотру (построитель отчетов и службы SSRS)](rendering-behaviors-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-168">For more information, see [Rendering Behaviors &#40;Report Builder  and SSRS&#41;](rendering-behaviors-report-builder-and-ssrs.md).</span></span>  
  
### <a name="for-reports-with-multiple-datasets"></a><span data-ttu-id="6b841-169">Отчеты с несколькими наборами данных</span><span class="sxs-lookup"><span data-stu-id="6b841-169">For Reports with Multiple Datasets</span></span>  
 <span data-ttu-id="6b841-170">Применительно к отчетам с несколькими наборами данных не допускается добавление полей или привязанных к данных изображений непосредственно в верхний или нижний колонтитул.</span><span class="sxs-lookup"><span data-stu-id="6b841-170">For reports with more than one dataset, you cannot add fields or data-bound images directly to a header or footer.</span></span> <span data-ttu-id="6b841-171">Однако можно создать выражение, косвенно ссылающееся на поле или привязанное к данным изображение, которое необходимо использовать в верхнем или нижнем колонтитуле.</span><span class="sxs-lookup"><span data-stu-id="6b841-171">However, you can write an expression that indirectly references a field or data-bound image that you want to use in a header or footer.</span></span>  
  
 <span data-ttu-id="6b841-172">Чтобы поместить переменные данные в верхний или нижний колонтитул:</span><span class="sxs-lookup"><span data-stu-id="6b841-172">To put variable data in a header or footer:</span></span>  
  
-   <span data-ttu-id="6b841-173">Добавьте текстовое поле в верхний или нижний колонтитул.</span><span class="sxs-lookup"><span data-stu-id="6b841-173">Add a text box to the header or footer.</span></span>  
  
-   <span data-ttu-id="6b841-174">В текстовом поле введите выражение, создающее изменяющиеся данные, которые необходимо вывести.</span><span class="sxs-lookup"><span data-stu-id="6b841-174">In the text box, write an expression that produces the variable data that you want to appear.</span></span>  
  
-   <span data-ttu-id="6b841-175">Включите в выражение ссылки на элементы отчета на странице (например, можно сослаться на текстовое поле, содержащее данные из определенного поля).</span><span class="sxs-lookup"><span data-stu-id="6b841-175">In the expression, include references to report items on the page; for example, you can reference a text box that contains data from a particular field.</span></span> <span data-ttu-id="6b841-176">Не включайте прямую ссылку на поля из набора данных.</span><span class="sxs-lookup"><span data-stu-id="6b841-176">Do not include a direct reference to fields in a dataset.</span></span> <span data-ttu-id="6b841-177">Например, нельзя использовать выражение `[LastName]`.</span><span class="sxs-lookup"><span data-stu-id="6b841-177">For example, you cannot use the expression `[LastName]`.</span></span> <span data-ttu-id="6b841-178">Можно использовать следующее выражение для отображения содержимого первого экземпляра текстового поля с именем `TXT_LastName`:</span><span class="sxs-lookup"><span data-stu-id="6b841-178">You can use the following expression to display the contents of the first instance of a text box named `TXT_LastName`:</span></span>  
  
     `=First(ReportItems!TXT_LastName.Value)`  
  
 <span data-ttu-id="6b841-179">В верхнем или нижнем колонтитуле страницы нельзя применять агрегатные функции к полям.</span><span class="sxs-lookup"><span data-stu-id="6b841-179">You cannot use aggregate functions on fields in the page header or footer.</span></span> <span data-ttu-id="6b841-180">Можно использовать только агрегатную функцию по отношению к элементам отчета в тексте отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-180">You can only use an aggregate function on report items in the report body.</span></span> <span data-ttu-id="6b841-181">Примеры выражений в верхних и нижних колонтитулах страницы см. в разделе [Примеры выражений (построитель отчетов и службы SSRS)](expression-examples-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-181">For common expressions in page headers and footers, see [Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md).</span></span>  
  
#### <a name="adding-a-data-bound-image-to-a-header-or-footer"></a><span data-ttu-id="6b841-182">Добавление привязанного к данным изображения в верхний или нижний колонтитул</span><span class="sxs-lookup"><span data-stu-id="6b841-182">Adding a Data-Bound Image to a Header or Footer</span></span>  
 <span data-ttu-id="6b841-183">В верхнем или нижнем колонтитуле можно использовать изображение, хранящееся в базе данных.</span><span class="sxs-lookup"><span data-stu-id="6b841-183">You can use image data stored in a database in a header or footer.</span></span> <span data-ttu-id="6b841-184">Однако из элемента отчета Image нельзя ссылаться на поля базы данных напрямую.</span><span class="sxs-lookup"><span data-stu-id="6b841-184">However, you cannot reference database fields from the Image report item directly.</span></span> <span data-ttu-id="6b841-185">Вместо этого необходимо добавить текстовое поле в тело отчета, а затем связать текстовое поле с полем данных, которое содержит изображение (учтите, что это значение должно быть сохранено в формате base64).</span><span class="sxs-lookup"><span data-stu-id="6b841-185">Instead, you must add a text box in the body of the report and then set the text box to the data field that contains the image (note that the value must be base64 encoded).</span></span> <span data-ttu-id="6b841-186">Можно скрыть текстовое поле в тексте отчета, чтобы не происходил вывод изображения в кодировке base64.</span><span class="sxs-lookup"><span data-stu-id="6b841-186">You can hide the text box in the body of the report to avoid showing the base64-encoded image.</span></span> <span data-ttu-id="6b841-187">Затем можно сослаться на значение скрытого текстового поля из элемента отчета Image в верхнем или нижнем колонтитуле страницы.</span><span class="sxs-lookup"><span data-stu-id="6b841-187">Then, you can reference the value of the hidden text box from the Image report item in the page header or footer.</span></span>  
  
 <span data-ttu-id="6b841-188">Предположим, например, что существует отчет, состоящий из страниц с информацией о продукте.</span><span class="sxs-lookup"><span data-stu-id="6b841-188">For example, suppose you have a report that consists of product information pages.</span></span> <span data-ttu-id="6b841-189">В верхнем колонтитуле каждой страницы необходимо отобразить фотографию продукта.</span><span class="sxs-lookup"><span data-stu-id="6b841-189">In the header of each page, you want to display a photograph of the product.</span></span> <span data-ttu-id="6b841-190">Чтобы напечатать изображение, хранимое в верхнем колонтитуле страницы, определите скрытое текстовое поле `TXT_Photo` в теле отчета, которое будет получать изображение из базы данных, и задайте ему значение с помощью выражения:</span><span class="sxs-lookup"><span data-stu-id="6b841-190">To print a stored image in the report header, define a hidden text box named `TXT_Photo` in the body of the report that retrieves the image from the database and use an expression to give it a value:</span></span>  
  
 `=Convert.ToBase64String(Fields!Photo.Value)`  
  
 <span data-ttu-id="6b841-191">В верхнем колонтитуле добавьте элемент отчета Image, использующий текстовое поле `TXT_Photo` , который будет декодироваться для показа изображения:</span><span class="sxs-lookup"><span data-stu-id="6b841-191">In the header, add an Image report item which uses the `TXT_Photo` text box, decoded to show the image:</span></span>  
  
 `=Convert.FromBase64String(ReportItems!TXT_Photo.Value)`  
  
## <a name="using-headers-and-footers-to-position-text"></a><span data-ttu-id="6b841-192">Использование верхних и нижних колонтитулов для позиционирования текста</span><span class="sxs-lookup"><span data-stu-id="6b841-192">Using Headers and Footers to Position Text</span></span>  
 <span data-ttu-id="6b841-193">Можно использовать верхние и нижние колонтитулы для позиционирования текста на странице.</span><span class="sxs-lookup"><span data-stu-id="6b841-193">You can use headers and footers to position text on a page.</span></span> <span data-ttu-id="6b841-194">Предположим, например, что требуется создать отчет, который необходимо отправить по почте заказчикам.</span><span class="sxs-lookup"><span data-stu-id="6b841-194">For example, suppose you are creating a report that you want to mail out to customers.</span></span> <span data-ttu-id="6b841-195">Можно использовать верхний или нижний колонтитул для размещения адреса заказчика таким образом, чтобы он был виден в окне конверта даже в свернутом состоянии.</span><span class="sxs-lookup"><span data-stu-id="6b841-195">You can use a header or footer to position the customer address so that it appears in an envelope window when folded.</span></span>  
  
 <span data-ttu-id="6b841-196">Если текстовое поле используется только для заполнения верхнего или нижнего колонтитула, то можно скрыть поле в теле отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-196">If you are only using the text box to populate a header or footer, you can hide the text box in the report body.</span></span> <span data-ttu-id="6b841-197">Расположение текстового поля в теле отчета может оказывать влияние на то, появится ли значение на верхнем или нижнем колонтитуле первой или последней страницы отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-197">Placement of the text box in the report body can have an effect on whether the value appears on the header or footer of the first or last page of a report.</span></span> <span data-ttu-id="6b841-198">Например, если таблицы, матрицы или списки располагаются в отчете на нескольких страницах, то скрытое текстовое поле окажется на последней странице.</span><span class="sxs-lookup"><span data-stu-id="6b841-198">For example, if you have tables, matrices, or lists that cause the report to span multiple pages, the hidden text box value appears on the last page.</span></span> <span data-ttu-id="6b841-199">Если данные нужно отобразить на первой странице, поместите скрытое текстовое поле в верхней части текста отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-199">If you want it to appear on the first page, place the hidden text box at the top of the report body.</span></span>  
  
## <a name="designing-reports-with-page-headers-and-footers-for-specific-renderers"></a><span data-ttu-id="6b841-200">Проектирование отчетов с верхними и нижними колонтитулами страниц для конкретных модулей подготовки отчетов</span><span class="sxs-lookup"><span data-stu-id="6b841-200">Designing Reports with Page Headers and Footers for Specific Renderers</span></span>  
 <span data-ttu-id="6b841-201">При обработке отчета сведения о данных и макете объединяются.</span><span class="sxs-lookup"><span data-stu-id="6b841-201">When a report is processed, data and layout information are combined.</span></span> <span data-ttu-id="6b841-202">При просмотре отчета эти объединенные сведения передаются в модуль подготовки отчетов, который определяет, какое количество данных отчета может поместиться на каждой странице отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-202">When you view a report, the combined information is passed to a renderer that determines how much report data fits on each report page.</span></span>  
  
 <span data-ttu-id="6b841-203">Если просмотр отчета на сервере отчетов осуществляется с использованием браузера, то для управления содержимым просматриваемых страниц отчета используется модуль подготовки отчетов HTML.</span><span class="sxs-lookup"><span data-stu-id="6b841-203">If you view a report on the report server using a browser, the HTML renderer controls the content on the report pages that you see.</span></span> <span data-ttu-id="6b841-204">Если намечено доставка отчетов в формате, отличным от того, который используется для просмотра, или решено напечатать отчеты в каком-то конкретном формате, то может потребоваться оптимизировать макет отчета для того модуля подготовки отчетов, который планируется использовать при получении конечного формата отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-204">If you plan to deliver reports in a different format than you use for viewing, or if you plan to print reports in a specific format, you may want to optimize the report layout for the renderer you plan to use for the final report format.</span></span> <span data-ttu-id="6b841-205">Дополнительные сведения о разбиении отчета на страницы см. в разделе [Разбиение на страницы в службах Reporting Services (построитель отчетов и службы SSRS)](pagination-in-reporting-services-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-205">For more information about report pagination, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
### <a name="working-with-page-headers-and-footers-in-excel"></a><span data-ttu-id="6b841-206">Работа с верхними и нижними колонтитулами страниц в Excel</span><span class="sxs-lookup"><span data-stu-id="6b841-206">Working with Page Headers and Footers in Excel</span></span>  
 <span data-ttu-id="6b841-207">При определении верхнего и нижнего колонтитулов страницы для отчетов, предназначенных для модуля подготовки отчетов в формате Excel, придерживайтесь следующих правил для получения оптимальных результатов:</span><span class="sxs-lookup"><span data-stu-id="6b841-207">When defining page headers and footers for reports that target the Excel rendering extension, follow these guidelines to achieve best results:</span></span>  
  
-   <span data-ttu-id="6b841-208">Используйте нижние колонтитулы для отображения номеров страниц.</span><span class="sxs-lookup"><span data-stu-id="6b841-208">Use page footers to display page numbers.</span></span>  
  
-   <span data-ttu-id="6b841-209">Используйте верхние колонтитулы для представления изображений, заголовков или другого текста.</span><span class="sxs-lookup"><span data-stu-id="6b841-209">Use page headers to display images, titles, or other text.</span></span> <span data-ttu-id="6b841-210">Не выводите номера страниц в верхнем колонтитуле.</span><span class="sxs-lookup"><span data-stu-id="6b841-210">Do not put page numbers in the header.</span></span>  
  
 <span data-ttu-id="6b841-211">Возможности Excel по работе с нижними колонтитулами ограничены.</span><span class="sxs-lookup"><span data-stu-id="6b841-211">In Excel, page footers have a limited layout.</span></span> <span data-ttu-id="6b841-212">При определении отчета, содержащего сложные элементы отчета в нижнем колонтитуле, колонтитул не будет обрабатываться должным образом при просмотре отчета в Excel.</span><span class="sxs-lookup"><span data-stu-id="6b841-212">If you define a report that includes complex report items in the page footer, the page footer won't process as you expect when the report is viewed in Excel.</span></span>  
  
 <span data-ttu-id="6b841-213">Модуль подготовки отчетов в формате Excel помещает изображения и допускает абсолютное позиционирование простых или сложных элементов отчета в верхнем колонтитуле страницы.</span><span class="sxs-lookup"><span data-stu-id="6b841-213">The Excel rendering extension can accommodate images and absolute positioning of simple or complex report items in the page header.</span></span> <span data-ttu-id="6b841-214">Побочным эффектом поддержки более разнообразных макетов верхнего колонтитула является сниженная поддержка расчета номера страницы в верхнем колонтитуле.</span><span class="sxs-lookup"><span data-stu-id="6b841-214">A side effect of supporting a richer page header layout is reduced support for calculating page numbers in the header.</span></span> <span data-ttu-id="6b841-215">В модуле подготовки отчетов в формате Excel параметры по умолчанию предусматривают вычисление номеров страниц на основе числа рабочих листов.</span><span class="sxs-lookup"><span data-stu-id="6b841-215">In the Excel rendering extension, default settings cause page numbers to be calculated based on the number of worksheets.</span></span> <span data-ttu-id="6b841-216">В зависимости от способа определения отчета, это может привести к формированию неверных номеров страниц.</span><span class="sxs-lookup"><span data-stu-id="6b841-216">Depending on how you define the report, this might produce erroneous page numbers.</span></span> <span data-ttu-id="6b841-217">Предположим, например, что имеется отчет, отображаемый как один большой рабочий лист, который выводится на печать на четырех страницах.</span><span class="sxs-lookup"><span data-stu-id="6b841-217">For example, suppose you have a report that renders as a single large worksheet that prints on four pages.</span></span> <span data-ttu-id="6b841-218">Если в верхнем колонтитуле включены сведения о номере страницы, то на каждой отпечатанной странице в верхнем колонтитуле отобразится «Страница 1 из 1».</span><span class="sxs-lookup"><span data-stu-id="6b841-218">If you include page number information in the header, each printed page will show "Page 1 of 1" in the header.</span></span>  
  
 <span data-ttu-id="6b841-219">Более точный подсчет страниц основан на логических страницах, соответствующих размерам печатаемых листов.</span><span class="sxs-lookup"><span data-stu-id="6b841-219">A more accurate page count is based on logical pages that correlate to the dimensions of a printed page.</span></span> <span data-ttu-id="6b841-220">В Excel в нижнем колонтитуле страницы автоматически используются логические номера страниц.</span><span class="sxs-lookup"><span data-stu-id="6b841-220">In Excel, the page footer uses logical page numbers automatically.</span></span> <span data-ttu-id="6b841-221">Чтобы вывести номер логической страницы в верхнем колонтитуле страницы, необходимо настроить сведения об устройстве в целях применения простых верхних колонтитулов.</span><span class="sxs-lookup"><span data-stu-id="6b841-221">To put the logical page count in the page header, you must configure the device information settings to use simple headers.</span></span> <span data-ttu-id="6b841-222">Но следует знать, что при использовании простых верхних колонтитулов отключается возможность использования в области верхнего колонтитула сложных макетов отчета.</span><span class="sxs-lookup"><span data-stu-id="6b841-222">Be aware that when you use simple headers, you remove the capability of handling complex report layout in the header region.</span></span>  
  
 <span data-ttu-id="6b841-223">Дополнительные сведения см. в разделе [Экспорт в Microsoft Excel (построитель отчетов и службы SSRS)](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="6b841-223">For more information, see [Exporting to Microsoft Excel &#40;Report Builder and SSRS&#41;](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6b841-224">См. также:</span><span class="sxs-lookup"><span data-stu-id="6b841-224">See Also</span></span>  
 <span data-ttu-id="6b841-225">[Внедрение изображения в отчет (построитель отчетов и службы SSRS)](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="6b841-225">[Embed an Image in a Report &#40;Report Builder and SSRS&#41;](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="6b841-226">Прямоугольники и линии (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="6b841-226">Rectangles and Lines &#40;Report Builder and SSRS&#41;</span></span>](rectangles-and-lines-report-builder-and-ssrs.md)  
  
  
