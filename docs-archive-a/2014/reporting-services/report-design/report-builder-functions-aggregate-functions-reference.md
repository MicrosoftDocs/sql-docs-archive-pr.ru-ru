---
title: Справочник по агрегатным функциям (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: db6542ee-02d0-4073-90e6-cba8f9510fbb
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: b7c88935b303d36e73741bee17e966ec6616a030
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736061"
---
# <a name="aggregate-functions-reference-report-builder-and-ssrs"></a><span data-ttu-id="c5cbc-102">Справочник по агрегатным функциям (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="c5cbc-102">Aggregate Functions Reference (Report Builder and SSRS)</span></span>
  <span data-ttu-id="c5cbc-103">Чтобы включить в отчет статистические значения, в выражениях можно использовать агрегатные функции.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-103">To include aggregated values in your report, you can use built-in aggregate functions in expressions.</span></span> <span data-ttu-id="c5cbc-104">Агрегатная функция по умолчанию для числовых полей — функция SUM.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-104">The default aggregate function for numeric fields is SUM.</span></span> <span data-ttu-id="c5cbc-105">Можно изменить выражение и использовать другую встроенную агрегатную функцию или указать другую область.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-105">You can edit the expression and use a different built-in aggregate function or specify a different scope.</span></span> <span data-ttu-id="c5cbc-106">Область определяет набор данных, используемый при вычислениях.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-106">Scope identifies which set of data to use for the calculation.</span></span>  
  
 <span data-ttu-id="c5cbc-107">Поскольку в обработчике отчетов объединены данные и макет отчета, то выражения для всех элементов отчета вычисляются.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-107">As the report processor combines report data and the report layout, the expressions for each report item are evaluated.</span></span> <span data-ttu-id="c5cbc-108">При просмотре всех страниц отчета в элементах отчета, подготовленных к просмотру, отображаются результаты для всех выражений.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-108">As you view each page of the report, you see the results for each expression in the rendered report items.</span></span>  
  
 <span data-ttu-id="c5cbc-109">В следующей таблице перечислены категории встроенных функций, которые можно включать в выражение.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-109">The following table lists categories of built-in functions that you can include in an expression:</span></span>  
  
-   [<span data-ttu-id="c5cbc-110">Встроенные агрегатные функции</span><span class="sxs-lookup"><span data-stu-id="c5cbc-110">Built-in Aggregate Functions</span></span>](#CalculatingAggregates)  
  
-   [<span data-ttu-id="c5cbc-111">Ограничения встроенных полей, коллекций и агрегатных функций</span><span class="sxs-lookup"><span data-stu-id="c5cbc-111">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>](#Restrictions)  
  
-   [<span data-ttu-id="c5cbc-112">Ограничения вложенных агрегатов</span><span class="sxs-lookup"><span data-stu-id="c5cbc-112">Restrictions on Nested Aggregates</span></span>](#NestedRestrictions)  
  
-   [<span data-ttu-id="c5cbc-113">Вычисление текущих значений</span><span class="sxs-lookup"><span data-stu-id="c5cbc-113">Calculating Running Values</span></span>](#CalculatingRunningValues)  
  
-   [<span data-ttu-id="c5cbc-114">Получение числа строк</span><span class="sxs-lookup"><span data-stu-id="c5cbc-114">Retrieving Row Counts</span></span>](#RetrievingRowCounts)  
  
-   [<span data-ttu-id="c5cbc-115">Уточняющий запрос значений из другого набора данных</span><span class="sxs-lookup"><span data-stu-id="c5cbc-115">Looking Up Values from Another Dataset</span></span>](#LookupFunctions)  
  
-   [<span data-ttu-id="c5cbc-116">Получение основанных на сортировке значений</span><span class="sxs-lookup"><span data-stu-id="c5cbc-116">Retrieving Sort-Dependent Values</span></span>](#RetrievingPostsortValues)  
  
-   [<span data-ttu-id="c5cbc-117">Получение серверных агрегатов</span><span class="sxs-lookup"><span data-stu-id="c5cbc-117">Retrieving Server Aggregates</span></span>](#RetrievingServerAggregates)  
  
-   [<span data-ttu-id="c5cbc-118">Получение уровня рекурсии</span><span class="sxs-lookup"><span data-stu-id="c5cbc-118">Retrieving Recursive Level</span></span>](#RetrievingRecursiveLevel)  
  
-   [<span data-ttu-id="c5cbc-119">Тестирование области</span><span class="sxs-lookup"><span data-stu-id="c5cbc-119">Testing for Scope</span></span>](#TestingforScope)  
  
 <span data-ttu-id="c5cbc-120">Чтобы определить допустимые области для функции, см. раздел справки по конкретной функции.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-120">To determine the valid scopes for a function, see the individual function reference topic.</span></span> <span data-ttu-id="c5cbc-121">Дополнительные сведения и примеры см. в разделе [Область выражения для суммирования, агрегатных функций и встроенных коллекций (построитель отчетов и службы SSRS)](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span><span class="sxs-lookup"><span data-stu-id="c5cbc-121">For more information and for examples, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="built-in-aggregate-functions"></a><a name="CalculatingAggregates"></a> <span data-ttu-id="c5cbc-122">Встроенные агрегатные функции</span><span class="sxs-lookup"><span data-stu-id="c5cbc-122">Built-in Aggregate Functions</span></span>  
 <span data-ttu-id="c5cbc-123">Для вычисления сводных значений для набора ненулевых числовых данных в области по умолчанию или именованной области используются следующие встроенные функции.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-123">The following built-in functions calculate summary values for a set of non-null numeric data in the default scope or the named scope.</span></span>  
  
|<span data-ttu-id="c5cbc-124">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-124">**Function**</span></span>|<span data-ttu-id="c5cbc-125">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-125">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="c5cbc-126">Avg</span><span class="sxs-lookup"><span data-stu-id="c5cbc-126">Avg</span></span>](report-builder-functions-avg-function.md)|<span data-ttu-id="c5cbc-127">Возвращает среднее значение всех числовых значений, отличных от NULL, заданных выражением, вычисляемым для данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-127">Returns the average of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-128">Count</span><span class="sxs-lookup"><span data-stu-id="c5cbc-128">Count</span></span>](report-builder-functions-count-function.md)|<span data-ttu-id="c5cbc-129">Возвращает количество значений, отличных от NULL, определяемое выражением, вычисляемым в контексте данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-129">Returns a count of non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-130">CountDistinct</span><span class="sxs-lookup"><span data-stu-id="c5cbc-130">CountDistinct</span></span>](report-builder-functions-countdistinct-function.md)|<span data-ttu-id="c5cbc-131">Возвращает количество уникальных значений, отличных от NULL, определяемое выражением, вычисляемым в контексте данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-131">Returns a count of all distinct non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-132">Max</span><span class="sxs-lookup"><span data-stu-id="c5cbc-132">Max</span></span>](report-builder-functions-max-function.md)|<span data-ttu-id="c5cbc-133">Возвращает максимальное значение всех числовых значений, отличных от NULL, заданных выражением, вычисляемым в контексте данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-133">Returns the maximum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="c5cbc-134">Можно использовать для задания максимального значения оси диаграммы при управлении масштабом.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-134">You can use this for specifying a chart axis maximum value to control the scale.</span></span>|  
|[<span data-ttu-id="c5cbc-135">Min</span><span class="sxs-lookup"><span data-stu-id="c5cbc-135">Min</span></span>](report-builder-functions-min-function.md)|<span data-ttu-id="c5cbc-136">Возвращает минимальное значение всех числовых значений, отличных от NULL, заданных выражением, вычисляемым в контексте данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-136">Returns the minimum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="c5cbc-137">Можно использовать для задания минимального значения оси диаграммы при управлении масштабом.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-137">You can use this for specifying a chart axis minimum value to control the scale.</span></span>|  
|[<span data-ttu-id="c5cbc-138">StDev</span><span class="sxs-lookup"><span data-stu-id="c5cbc-138">StDev</span></span>](report-builder-functions-stdev-function.md)|<span data-ttu-id="c5cbc-139">Возвращает стандартное отклонение всех числовых значений, отличных от NULL, заданных выражением, вычисляемым для данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-139">Returns the standard deviation of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-140">StDevP</span><span class="sxs-lookup"><span data-stu-id="c5cbc-140">StDevP</span></span>](report-builder-functions-stdevp-function.md)|<span data-ttu-id="c5cbc-141">Возвращает стандартное отклонение совокупности всех числовых значений, отличных от NULL, заданных выражением, вычисляемым в контексте данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-141">Returns the population standard deviation of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-142">Sum</span><span class="sxs-lookup"><span data-stu-id="c5cbc-142">Sum</span></span>](report-builder-functions-sum-function.md)|<span data-ttu-id="c5cbc-143">Возвращает сумму всех числовых значений, отличных от NULL, заданных выражением, вычисляемым для данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-143">Returns the sum of all the non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-144">Union</span><span class="sxs-lookup"><span data-stu-id="c5cbc-144">Union</span></span>](report-builder-functions-union-function.md)|<span data-ttu-id="c5cbc-145">Возвращает объединение всех значений пространственных данных типа `SqlGeometry` или `SqlGeography`, не равных NULL и указанных с помощью выражения, которое вычисляется в заданной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-145">Returns the union of all the non-null spatial data values of type `SqlGeometry` or `SqlGeography` that are specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-146">Var</span><span class="sxs-lookup"><span data-stu-id="c5cbc-146">Var</span></span>](report-builder-functions-var-function.md)|<span data-ttu-id="c5cbc-147">Возвращает дисперсию всех числовых значений, отличных от NULL, заданных выражением, вычисляемым для данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-147">Returns the variance of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="c5cbc-148">VarP</span><span class="sxs-lookup"><span data-stu-id="c5cbc-148">VarP</span></span>](report-builder-functions-varp-function.md)|<span data-ttu-id="c5cbc-149">Возвращает дисперсию совокупности всех числовых значений, отличных от NULL, заданных выражением, вычисляемым в контексте данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-149">Returns the population variance of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
  
##  <a name="restrictions-on-built-in-fields-collections-and-aggregate-functions"></a><a name="Restrictions"></a><span data-ttu-id="c5cbc-150">Ограничения встроенных полей, коллекций и агрегатных функций</span><span class="sxs-lookup"><span data-stu-id="c5cbc-150">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>  
 <span data-ttu-id="c5cbc-151">В следующей таблице описываются ограничения местоположений отчетов, в которых можно добавлять выражения, содержащие ссылки на глобальные встроенные коллекции.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-151">The following table summarizes restrictions in report locations on where you can add expressions that contain references to global built-in collections.</span></span>  
  
|<span data-ttu-id="c5cbc-152">Местоположение в отчете</span><span class="sxs-lookup"><span data-stu-id="c5cbc-152">Location in Report</span></span>|<span data-ttu-id="c5cbc-153">Поля</span><span class="sxs-lookup"><span data-stu-id="c5cbc-153">Fields</span></span>|<span data-ttu-id="c5cbc-154">Параметры</span><span class="sxs-lookup"><span data-stu-id="c5cbc-154">Parameters</span></span>|<span data-ttu-id="c5cbc-155">ReportItems</span><span class="sxs-lookup"><span data-stu-id="c5cbc-155">ReportItems</span></span>|<span data-ttu-id="c5cbc-156">PageNumber</span><span class="sxs-lookup"><span data-stu-id="c5cbc-156">PageNumber</span></span><br /><br /> <span data-ttu-id="c5cbc-157">TotalPages</span><span class="sxs-lookup"><span data-stu-id="c5cbc-157">TotalPages</span></span>|<span data-ttu-id="c5cbc-158">DataSource</span><span class="sxs-lookup"><span data-stu-id="c5cbc-158">DataSource</span></span><br /><br /> <span data-ttu-id="c5cbc-159">DataSet</span><span class="sxs-lookup"><span data-stu-id="c5cbc-159">DataSet</span></span>|<span data-ttu-id="c5cbc-160">Переменные</span><span class="sxs-lookup"><span data-stu-id="c5cbc-160">Variables</span></span>|<span data-ttu-id="c5cbc-161">RenderFormat</span><span class="sxs-lookup"><span data-stu-id="c5cbc-161">RenderFormat</span></span>|  
|------------------------|------------|----------------|-----------------|-------------------------------|----------------------------|---------------|------------------|  
|<span data-ttu-id="c5cbc-162">Заголовок страницы</span><span class="sxs-lookup"><span data-stu-id="c5cbc-162">Page Header</span></span><br /><br /> <span data-ttu-id="c5cbc-163">Нижний колонтитул страницы</span><span class="sxs-lookup"><span data-stu-id="c5cbc-163">Page Footer</span></span>|<span data-ttu-id="c5cbc-164">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-164">Yes</span></span>|<span data-ttu-id="c5cbc-165">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-165">Yes</span></span>|<span data-ttu-id="c5cbc-166">Максимум одно</span><span class="sxs-lookup"><span data-stu-id="c5cbc-166">At most one</span></span><br /><br /> <span data-ttu-id="c5cbc-167">Примечание 1</span><span class="sxs-lookup"><span data-stu-id="c5cbc-167">Note 1</span></span>|<span data-ttu-id="c5cbc-168">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-168">Yes</span></span>|<span data-ttu-id="c5cbc-169">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-169">Yes</span></span>|<span data-ttu-id="c5cbc-170">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-170">Yes</span></span>|<span data-ttu-id="c5cbc-171">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-171">Yes</span></span>|  
|<span data-ttu-id="c5cbc-172">Текст</span><span class="sxs-lookup"><span data-stu-id="c5cbc-172">Body</span></span>|<span data-ttu-id="c5cbc-173">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-173">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-174">Примечание 2</span><span class="sxs-lookup"><span data-stu-id="c5cbc-174">Note 2</span></span>|<span data-ttu-id="c5cbc-175">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-175">Yes</span></span>|<span data-ttu-id="c5cbc-176">Только элементы в текущей или включающей области</span><span class="sxs-lookup"><span data-stu-id="c5cbc-176">Only items in the currnet scope or a containing scope</span></span><br /><br /> <span data-ttu-id="c5cbc-177">Примечание 3</span><span class="sxs-lookup"><span data-stu-id="c5cbc-177">Note 3</span></span>|<span data-ttu-id="c5cbc-178">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-178">No</span></span>|<span data-ttu-id="c5cbc-179">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-179">Yes</span></span>|<span data-ttu-id="c5cbc-180">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-180">Yes</span></span>|<span data-ttu-id="c5cbc-181">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-181">Yes</span></span>|  
|<span data-ttu-id="c5cbc-182">Параметр отчета</span><span class="sxs-lookup"><span data-stu-id="c5cbc-182">Report Parameter</span></span>|<span data-ttu-id="c5cbc-183">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-183">No</span></span>|<span data-ttu-id="c5cbc-184">Только ранее упомянутые в списке параметры</span><span class="sxs-lookup"><span data-stu-id="c5cbc-184">Only parameters earlier in the list</span></span><br /><br /> <span data-ttu-id="c5cbc-185">Примечание 4</span><span class="sxs-lookup"><span data-stu-id="c5cbc-185">Note 4</span></span>|<span data-ttu-id="c5cbc-186">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-186">No</span></span>|<span data-ttu-id="c5cbc-187">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-187">No</span></span>|<span data-ttu-id="c5cbc-188">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-188">No</span></span>|<span data-ttu-id="c5cbc-189">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-189">No</span></span>|<span data-ttu-id="c5cbc-190">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-190">No</span></span>|  
|<span data-ttu-id="c5cbc-191">Поле</span><span class="sxs-lookup"><span data-stu-id="c5cbc-191">Field</span></span>|<span data-ttu-id="c5cbc-192">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-192">Yes</span></span>|<span data-ttu-id="c5cbc-193">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-193">Yes</span></span>|<span data-ttu-id="c5cbc-194">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-194">No</span></span>|<span data-ttu-id="c5cbc-195">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-195">No</span></span>|<span data-ttu-id="c5cbc-196">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-196">No</span></span>|<span data-ttu-id="c5cbc-197">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-197">No</span></span>|<span data-ttu-id="c5cbc-198">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-198">No</span></span>|  
|<span data-ttu-id="c5cbc-199">Параметр запроса</span><span class="sxs-lookup"><span data-stu-id="c5cbc-199">Query Parameter</span></span>|<span data-ttu-id="c5cbc-200">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-200">No</span></span>|<span data-ttu-id="c5cbc-201">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-201">Yes</span></span>|<span data-ttu-id="c5cbc-202">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-202">No</span></span>|<span data-ttu-id="c5cbc-203">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-203">No</span></span>|<span data-ttu-id="c5cbc-204">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-204">No</span></span>|<span data-ttu-id="c5cbc-205">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-205">No</span></span>|<span data-ttu-id="c5cbc-206">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-206">No</span></span>|  
|<span data-ttu-id="c5cbc-207">Выражение группы</span><span class="sxs-lookup"><span data-stu-id="c5cbc-207">Group Expression</span></span>|<span data-ttu-id="c5cbc-208">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-208">Yes</span></span>|<span data-ttu-id="c5cbc-209">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-209">Yes</span></span>|<span data-ttu-id="c5cbc-210">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-210">No</span></span>|<span data-ttu-id="c5cbc-211">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-211">No</span></span>|<span data-ttu-id="c5cbc-212">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-212">Yes</span></span>|<span data-ttu-id="c5cbc-213">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-213">No</span></span>|<span data-ttu-id="c5cbc-214">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-214">No</span></span>|  
|<span data-ttu-id="c5cbc-215">Выражение сортировки</span><span class="sxs-lookup"><span data-stu-id="c5cbc-215">Sort Expression</span></span>|<span data-ttu-id="c5cbc-216">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-216">Yes</span></span>|<span data-ttu-id="c5cbc-217">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-217">Yes</span></span>|<span data-ttu-id="c5cbc-218">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-218">No</span></span>|<span data-ttu-id="c5cbc-219">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-219">No</span></span>|<span data-ttu-id="c5cbc-220">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-220">Yes</span></span>|<span data-ttu-id="c5cbc-221">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-221">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-222">Примечание 5</span><span class="sxs-lookup"><span data-stu-id="c5cbc-222">Note 5</span></span>|<span data-ttu-id="c5cbc-223">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-223">No</span></span>|  
|<span data-ttu-id="c5cbc-224">Критерий фильтра</span><span class="sxs-lookup"><span data-stu-id="c5cbc-224">Filter Expression</span></span>|<span data-ttu-id="c5cbc-225">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-225">Yes</span></span>|<span data-ttu-id="c5cbc-226">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-226">Yes</span></span>|<span data-ttu-id="c5cbc-227">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-227">No</span></span>|<span data-ttu-id="c5cbc-228">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-228">No</span></span>|<span data-ttu-id="c5cbc-229">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-229">Yes</span></span>|<span data-ttu-id="c5cbc-230">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-230">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-231">Примечание 6</span><span class="sxs-lookup"><span data-stu-id="c5cbc-231">Note 6</span></span>|<span data-ttu-id="c5cbc-232">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-232">No</span></span>|  
|<span data-ttu-id="c5cbc-233">Код</span><span class="sxs-lookup"><span data-stu-id="c5cbc-233">Code</span></span>|<span data-ttu-id="c5cbc-234">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-234">No</span></span>|<span data-ttu-id="c5cbc-235">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-235">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-236">Примечание 7</span><span class="sxs-lookup"><span data-stu-id="c5cbc-236">Note 7</span></span>|<span data-ttu-id="c5cbc-237">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-237">No</span></span>|<span data-ttu-id="c5cbc-238">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-238">No</span></span>|<span data-ttu-id="c5cbc-239">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-239">No</span></span>|<span data-ttu-id="c5cbc-240">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-240">No</span></span>|<span data-ttu-id="c5cbc-241">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-241">No</span></span>|  
|<span data-ttu-id="c5cbc-242">Report.Language</span><span class="sxs-lookup"><span data-stu-id="c5cbc-242">Report.Language</span></span>|<span data-ttu-id="c5cbc-243">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-243">No</span></span>|<span data-ttu-id="c5cbc-244">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-244">Yes</span></span>|<span data-ttu-id="c5cbc-245">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-245">No</span></span>|<span data-ttu-id="c5cbc-246">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-246">No</span></span>|<span data-ttu-id="c5cbc-247">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-247">No</span></span>|<span data-ttu-id="c5cbc-248">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-248">No</span></span>|<span data-ttu-id="c5cbc-249">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-249">No</span></span>|  
|<span data-ttu-id="c5cbc-250">Переменные</span><span class="sxs-lookup"><span data-stu-id="c5cbc-250">Variables</span></span>|<span data-ttu-id="c5cbc-251">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-251">Yes</span></span>|<span data-ttu-id="c5cbc-252">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-252">Yes</span></span>|<span data-ttu-id="c5cbc-253">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-253">No</span></span>|<span data-ttu-id="c5cbc-254">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-254">No</span></span>|<span data-ttu-id="c5cbc-255">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-255">Yes</span></span>|<span data-ttu-id="c5cbc-256">Текущая или включающая область</span><span class="sxs-lookup"><span data-stu-id="c5cbc-256">Current or containing scope</span></span>|<span data-ttu-id="c5cbc-257">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-257">No</span></span>|  
|<span data-ttu-id="c5cbc-258">Статистические выражения</span><span class="sxs-lookup"><span data-stu-id="c5cbc-258">Aggregates</span></span>|<span data-ttu-id="c5cbc-259">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-259">Yes</span></span>|<span data-ttu-id="c5cbc-260">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-260">Yes</span></span>|<span data-ttu-id="c5cbc-261">Только в верхнем или нижнем колонтитуле страницы</span><span class="sxs-lookup"><span data-stu-id="c5cbc-261">Only in page header/page footer</span></span>|<span data-ttu-id="c5cbc-262">Только в агрегатных функциях элементов отчета</span><span class="sxs-lookup"><span data-stu-id="c5cbc-262">Only in report item aggregates</span></span>|<span data-ttu-id="c5cbc-263">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-263">Yes</span></span>|<span data-ttu-id="c5cbc-264">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-264">No</span></span>|<span data-ttu-id="c5cbc-265">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-265">No</span></span>|  
|<span data-ttu-id="c5cbc-266">Функции поиска</span><span class="sxs-lookup"><span data-stu-id="c5cbc-266">Lookup functions</span></span>|<span data-ttu-id="c5cbc-267">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-267">Yes</span></span>|<span data-ttu-id="c5cbc-268">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-268">Yes</span></span>|<span data-ttu-id="c5cbc-269">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-269">Yes</span></span>|<span data-ttu-id="c5cbc-270">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-270">No</span></span>|<span data-ttu-id="c5cbc-271">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-271">Yes</span></span>|<span data-ttu-id="c5cbc-272">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-272">No</span></span>|<span data-ttu-id="c5cbc-273">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-273">No</span></span>|  
  
-   <span data-ttu-id="c5cbc-274">**Примечание 1.**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-274">**Note 1.**</span></span> <span data-ttu-id="c5cbc-275">Элемент ReportItems должен существовать на странице отчета, подготовленной к просмотру, или их значение равно NULL.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-275">ReportItems must exist in the rendered report page, or their value is Null.</span></span> <span data-ttu-id="c5cbc-276">Если видимость элемента отчета зависит от выражения, принимающего значение False, то этот элемент отчета не существует на странице.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-276">If the visibility of a report item depends on an expression that evaluates to False, the report item does not exist on the page.</span></span>  
  
-   <span data-ttu-id="c5cbc-277">**Примечание 2.**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-277">**Note 2.**</span></span> <span data-ttu-id="c5cbc-278">. Если ссылка на поле используется в области группы и ссылка на поле не включена в выражение группы, то значение для поля считается неопределенным, за исключением случаев, когда в области имеется только одно значение.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-278">If a field reference is used in a group scope, and the field reference is not included in the group expression, then the value for the field is undefined, unless there is only one value in the scope.</span></span> <span data-ttu-id="c5cbc-279">Чтобы указать значение используйте методы First и Last и область группы.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-279">To specify a value, use First or Last and the group scope.</span></span>  
  
-   <span data-ttu-id="c5cbc-280">**Примечание 3.**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-280">**Note 3.**</span></span> <span data-ttu-id="c5cbc-281">. Выражения, включающие ссылку на элемент ReportItems, могут использоваться для указания значений для других элементов ReportItems в той же или включающей области группы.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-281">Expressions that include a reference to ReportItems can specify values for other ReportItems in the same group scope or in a containing group scope.</span></span>  
  
-   <span data-ttu-id="c5cbc-282">**Примечание 4**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-282">**Note 4.**</span></span> <span data-ttu-id="c5cbc-283">. Значения свойств для предыдущих параметров могут быть равны NULL.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-283">Property values for earlier parameters might be null.</span></span>  
  
-   <span data-ttu-id="c5cbc-284">**Примечание 5.**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-284">**Note 5.**</span></span> <span data-ttu-id="c5cbc-285">. Только при сортировке элементов.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-285">In Member sorts only.</span></span> <span data-ttu-id="c5cbc-286">Нельзя использовать в выражениях сортировки области данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-286">Cannot use in data region sort expressions.</span></span>  
  
-   <span data-ttu-id="c5cbc-287">**Примечание 6**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-287">**Note 6.**</span></span> <span data-ttu-id="c5cbc-288">. Только для фильтров элементов.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-288">In Member filters only.</span></span> <span data-ttu-id="c5cbc-289">Нельзя использовать в выражениях сортировки области данных или критериев фильтра наборов данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-289">Cannot use in data region or dataset filter expressions.</span></span>  
  
-   <span data-ttu-id="c5cbc-290">**Примечание 7.**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-290">**Note 7.**</span></span> <span data-ttu-id="c5cbc-291">Коллекция параметров не инициализируется до обработки блока кода, поэтому методы не могут быть использованы для управления параметрами при инициализации.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-291">The Parameters collection is not initialized until after the Code block is processed, so methods cannot be used to control parameters on initialization.</span></span>  
  
-   <span data-ttu-id="c5cbc-292">**Примечание 8.**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-292">**Note 8.**</span></span> <span data-ttu-id="c5cbc-293">Все агрегатные функции, за исключением Count и CountDistinct, должны иметь один тип данных, или все значения должны быть равны NULL.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-293">Data type for all aggregates except Count and CountDistinct must be the same data type, or null, for all values.</span></span>  
  
##  <a name="restrictions-on-nested-aggregates"></a><a name="NestedRestrictions"></a><span data-ttu-id="c5cbc-294">Ограничения вложенных статистических выражений</span><span class="sxs-lookup"><span data-stu-id="c5cbc-294">Restrictions on Nested Aggregates</span></span>  
 <span data-ttu-id="c5cbc-295">В следующей таблице описываются ограничения, которые используются агрегатными функциями для указания других агрегатных функций как вложенных агрегатов.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-295">The following table summarizes restrictions on which aggregates functions can specify other aggregate functions as nested aggregates.</span></span>  
  
|<span data-ttu-id="c5cbc-296">Контекст</span><span class="sxs-lookup"><span data-stu-id="c5cbc-296">Context</span></span>|<span data-ttu-id="c5cbc-297">RunningValue</span><span class="sxs-lookup"><span data-stu-id="c5cbc-297">RunningValue</span></span>|<span data-ttu-id="c5cbc-298">RowNumber</span><span class="sxs-lookup"><span data-stu-id="c5cbc-298">RowNumber</span></span>|<span data-ttu-id="c5cbc-299">First</span><span class="sxs-lookup"><span data-stu-id="c5cbc-299">First</span></span><br /><br /> <span data-ttu-id="c5cbc-300">Последняя</span><span class="sxs-lookup"><span data-stu-id="c5cbc-300">Last</span></span>|<span data-ttu-id="c5cbc-301">Назад</span><span class="sxs-lookup"><span data-stu-id="c5cbc-301">Previous</span></span>|<span data-ttu-id="c5cbc-302">Sum и другие функции предварительной сортировки</span><span class="sxs-lookup"><span data-stu-id="c5cbc-302">Sum and Other Presort functions</span></span>|<span data-ttu-id="c5cbc-303">Агрегаты ReportItem</span><span class="sxs-lookup"><span data-stu-id="c5cbc-303">ReportItem aggregates</span></span>|<span data-ttu-id="c5cbc-304">Функции поиска</span><span class="sxs-lookup"><span data-stu-id="c5cbc-304">Lookup functions</span></span>|<span data-ttu-id="c5cbc-305">Агрегатная функция</span><span class="sxs-lookup"><span data-stu-id="c5cbc-305">Aggregate Function</span></span>|  
|-------------|------------------|---------------|--------------------|--------------|-------------------------------------|---------------------------|----------------------|------------------------|  
|<span data-ttu-id="c5cbc-306">Текущее значение</span><span class="sxs-lookup"><span data-stu-id="c5cbc-306">Running Value</span></span>|<span data-ttu-id="c5cbc-307">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-307">No</span></span>|<span data-ttu-id="c5cbc-308">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-308">No</span></span>|<span data-ttu-id="c5cbc-309">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-309">No</span></span>|<span data-ttu-id="c5cbc-310">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-310">No</span></span>|<span data-ttu-id="c5cbc-311">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-311">Yes</span></span>|<span data-ttu-id="c5cbc-312">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-312">No</span></span>|<span data-ttu-id="c5cbc-313">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-313">Yes</span></span>|<span data-ttu-id="c5cbc-314">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-314">No</span></span>|  
|<span data-ttu-id="c5cbc-315">First</span><span class="sxs-lookup"><span data-stu-id="c5cbc-315">First</span></span><br /><br /> <span data-ttu-id="c5cbc-316">Последняя</span><span class="sxs-lookup"><span data-stu-id="c5cbc-316">Last</span></span>|<span data-ttu-id="c5cbc-317">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-317">No</span></span>|<span data-ttu-id="c5cbc-318">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-318">No</span></span>|<span data-ttu-id="c5cbc-319">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-319">No</span></span>|<span data-ttu-id="c5cbc-320">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-320">No</span></span>|<span data-ttu-id="c5cbc-321">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-321">Yes</span></span>|<span data-ttu-id="c5cbc-322">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-322">No</span></span>|<span data-ttu-id="c5cbc-323">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-323">No</span></span>|<span data-ttu-id="c5cbc-324">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-324">No</span></span>|  
|<span data-ttu-id="c5cbc-325">Назад</span><span class="sxs-lookup"><span data-stu-id="c5cbc-325">Previous</span></span>|<span data-ttu-id="c5cbc-326">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-326">Yes</span></span>|<span data-ttu-id="c5cbc-327">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-327">Yes</span></span>|<span data-ttu-id="c5cbc-328">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-328">Yes</span></span>|<span data-ttu-id="c5cbc-329">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-329">No</span></span>|<span data-ttu-id="c5cbc-330">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-330">Yes</span></span>|<span data-ttu-id="c5cbc-331">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-331">No</span></span>|<span data-ttu-id="c5cbc-332">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-332">Yes</span></span>|<span data-ttu-id="c5cbc-333">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-333">No</span></span>|  
|<span data-ttu-id="c5cbc-334">Sum и другие функции предварительной сортировки</span><span class="sxs-lookup"><span data-stu-id="c5cbc-334">Sum and other Presort functions</span></span>|<span data-ttu-id="c5cbc-335">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-335">No</span></span>|<span data-ttu-id="c5cbc-336">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-336">No</span></span>|<span data-ttu-id="c5cbc-337">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-337">No</span></span>|<span data-ttu-id="c5cbc-338">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-338">No</span></span>|<span data-ttu-id="c5cbc-339">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-339">Yes</span></span>|<span data-ttu-id="c5cbc-340">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-340">No</span></span>|<span data-ttu-id="c5cbc-341">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-341">Yes</span></span>|<span data-ttu-id="c5cbc-342">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-342">No</span></span>|  
|<span data-ttu-id="c5cbc-343">Агрегаты ReportItem</span><span class="sxs-lookup"><span data-stu-id="c5cbc-343">ReportItem aggregates</span></span>|<span data-ttu-id="c5cbc-344">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-344">No</span></span>|<span data-ttu-id="c5cbc-345">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-345">No</span></span>|<span data-ttu-id="c5cbc-346">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-346">No</span></span>|<span data-ttu-id="c5cbc-347">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-347">No</span></span>|<span data-ttu-id="c5cbc-348">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-348">No</span></span>|<span data-ttu-id="c5cbc-349">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-349">No</span></span>|<span data-ttu-id="c5cbc-350">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-350">No</span></span>|<span data-ttu-id="c5cbc-351">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-351">No</span></span>|  
|<span data-ttu-id="c5cbc-352">Функции поиска</span><span class="sxs-lookup"><span data-stu-id="c5cbc-352">Lookup functions</span></span>|<span data-ttu-id="c5cbc-353">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-353">Yes</span></span>|<span data-ttu-id="c5cbc-354">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-354">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-355">Примечание 1</span><span class="sxs-lookup"><span data-stu-id="c5cbc-355">Note 1</span></span>|<span data-ttu-id="c5cbc-356">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-356">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-357">Примечание 1</span><span class="sxs-lookup"><span data-stu-id="c5cbc-357">Note 1</span></span>|<span data-ttu-id="c5cbc-358">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-358">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-359">Примечание 1</span><span class="sxs-lookup"><span data-stu-id="c5cbc-359">Note 1</span></span>|<span data-ttu-id="c5cbc-360">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-360">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-361">Примечание 1</span><span class="sxs-lookup"><span data-stu-id="c5cbc-361">Note 1</span></span>|<span data-ttu-id="c5cbc-362">Да</span><span class="sxs-lookup"><span data-stu-id="c5cbc-362">Yes</span></span><br /><br /> <span data-ttu-id="c5cbc-363">Примечание 1</span><span class="sxs-lookup"><span data-stu-id="c5cbc-363">Note 1</span></span>|<span data-ttu-id="c5cbc-364">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-364">No</span></span>|<span data-ttu-id="c5cbc-365">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-365">No</span></span>|  
|<span data-ttu-id="c5cbc-366">Агрегатная функция</span><span class="sxs-lookup"><span data-stu-id="c5cbc-366">Aggregate Function</span></span>|<span data-ttu-id="c5cbc-367">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-367">No</span></span>|<span data-ttu-id="c5cbc-368">Нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-368">No</span></span>|<span data-ttu-id="c5cbc-369">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-369">No</span></span>|<span data-ttu-id="c5cbc-370">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-370">No</span></span>|<span data-ttu-id="c5cbc-371">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-371">No</span></span>|<span data-ttu-id="c5cbc-372">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-372">No</span></span>|<span data-ttu-id="c5cbc-373">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-373">No</span></span>|<span data-ttu-id="c5cbc-374">нет</span><span class="sxs-lookup"><span data-stu-id="c5cbc-374">No</span></span>|  
  
-   <span data-ttu-id="c5cbc-375">**Примечание 1.**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-375">**Note 1.**</span></span> <span data-ttu-id="c5cbc-376">Использование агрегатных функций разрешено только внутри выражения *Source* функции Lookup, если функция Lookup не содержится в агрегате.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-376">Aggregate functions are only allowed inside the *Source* expression of a Lookup function if the Lookup function is not contained in an aggregate.</span></span> <span data-ttu-id="c5cbc-377">Использование агрегатных функций не разрешено внутри выражений *Destination* или *Result* функции поиска.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-377">Aggregate functions are not allowed inside the *Destination* or *Result* expressions of a Lookup function.</span></span>  
  
##  <a name="calculating-running-values"></a><a name="CalculatingRunningValues"></a><span data-ttu-id="c5cbc-378">Вычисление текущих значений</span><span class="sxs-lookup"><span data-stu-id="c5cbc-378">Calculating Running Values</span></span>  
 <span data-ttu-id="c5cbc-379">Следующие встроенные функции вычисляют текущие значения для набора данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-379">The following built-in functions calculate running values for a set of data.</span></span> <span data-ttu-id="c5cbc-380">Функция `RowNumber` подобна функции `RunningValue` тем, что возвращает текущее значение счетчика, которое увеличивается для каждой строки внутри содержащей области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-380">`RowNumber` is like `RunningValue` in that it returns the running value of a count that increments for each row within the containing scope.</span></span> <span data-ttu-id="c5cbc-381">В этих функциях параметр области должен задавать вмещающую область, которая управляет обнулением счетчика.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-381">The scope parameter for these functions must specify a containing scope, which controls when the count restarts.</span></span>  
  
|<span data-ttu-id="c5cbc-382">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-382">**Function**</span></span>|<span data-ttu-id="c5cbc-383">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-383">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="c5cbc-384">RowNumber</span><span class="sxs-lookup"><span data-stu-id="c5cbc-384">RowNumber</span></span>](report-builder-functions-rownumber-function.md)|<span data-ttu-id="c5cbc-385">Возвращает текущее количество строк в указанной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-385">Returns a running count of the number of rows for the specified scope.</span></span> <span data-ttu-id="c5cbc-386">Функция `RowNumber` начинает счет с 1, а не с 0.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-386">The `RowNumber` function restarts counting at 1, not 0.</span></span>|  
|[<span data-ttu-id="c5cbc-387">RunningValue</span><span class="sxs-lookup"><span data-stu-id="c5cbc-387">RunningValue</span></span>](report-builder-functions-runningvalue-function.md)|<span data-ttu-id="c5cbc-388">Возвращает текущий агрегат всех числовых значений, отличных от NULL, заданных выражением, вычисляемым для данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-388">Returns a running aggregate of all non-null numeric values specified by the expression, evaluated for the given scope.</span></span>|  
  
##  <a name="retrieving-row-counts"></a><a name="RetrievingRowCounts"></a><span data-ttu-id="c5cbc-389">Получение количества строк</span><span class="sxs-lookup"><span data-stu-id="c5cbc-389">Retrieving Row Counts</span></span>  
 <span data-ttu-id="c5cbc-390">Следующая встроенная функция вычисляет количество строк в данной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-390">The following built-in function calculates the number of rows in the given scope.</span></span> <span data-ttu-id="c5cbc-391">Используйте эту функцию для подсчета всех строк, включая строки, содержащие значение NULL.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-391">Use this function to count all rows, including rows with null values.</span></span>  
  
|<span data-ttu-id="c5cbc-392">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-392">**Function**</span></span>|<span data-ttu-id="c5cbc-393">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-393">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="c5cbc-394">CountRows</span><span class="sxs-lookup"><span data-stu-id="c5cbc-394">CountRows</span></span>](report-builder-functions-countrows-function.md)|<span data-ttu-id="c5cbc-395">Возвращает число строк в указанной области, включая строки со значениями NULL.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-395">Returns the number of rows in the specified scope, including rows with null values.</span></span>|  
  
##  <a name="looking-up-values-from-another-dataset"></a><a name="LookupFunctions"></a><span data-ttu-id="c5cbc-396">Поиск значений из другого набора данных</span><span class="sxs-lookup"><span data-stu-id="c5cbc-396">Looking Up Values from Another Dataset</span></span>  
 <span data-ttu-id="c5cbc-397">Следующие функции поиска извлекают значения из указанного набора данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-397">The following lookup functions retrieve values from a specified dataset.</span></span>  
  
|<span data-ttu-id="c5cbc-398">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-398">**Function**</span></span>|<span data-ttu-id="c5cbc-399">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-399">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="c5cbc-400">Функция Lookup</span><span class="sxs-lookup"><span data-stu-id="c5cbc-400">Lookup Function</span></span>](report-builder-functions-lookup-function.md)|<span data-ttu-id="c5cbc-401">Возвращает значение определенного выражения из набора данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-401">Returns a value from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="c5cbc-402">Функция LookupSet</span><span class="sxs-lookup"><span data-stu-id="c5cbc-402">LookupSet Function</span></span>](report-builder-functions-lookupset-function.md)|<span data-ttu-id="c5cbc-403">Возвращает набор значений указанного выражения из набора данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-403">Returns a set of values from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="c5cbc-404">Функция Multilookup</span><span class="sxs-lookup"><span data-stu-id="c5cbc-404">Multilookup Function</span></span>](report-builder-functions-multilookup-function.md)|<span data-ttu-id="c5cbc-405">Возвращает первые подходящие значения для набора имен из набора данных, содержащего пары «имя-значение».</span><span class="sxs-lookup"><span data-stu-id="c5cbc-405">Returns the set of first-match values for a set of names from a dataset that contains name/value pairs.</span></span>|  
  
##  <a name="retrieving-sort-dependent-values"></a><a name="RetrievingPostsortValues"></a><span data-ttu-id="c5cbc-406">Получение значений, зависящих от сортировки</span><span class="sxs-lookup"><span data-stu-id="c5cbc-406">Retrieving Sort-Dependent Values</span></span>  
 <span data-ttu-id="c5cbc-407">Следующие встроенные функции возвращают первое, последнее или предыдущее значения внутри заданной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-407">The following built-in functions return the first, last, or previous value within a given scope.</span></span> <span data-ttu-id="c5cbc-408">Эти функции зависят от порядка сортировки значений данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-408">These functions depend on the sort order of the data values.</span></span> <span data-ttu-id="c5cbc-409">С помощью этих функций можно, например, найти последнее и первое значения на странице, чтобы создать заголовок в стиле словаря.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-409">Use these functions, for example, to find the first and last values on a page to create a dictionary-style page header.</span></span> <span data-ttu-id="c5cbc-410">Используйте функцию `Previous`, чтобы сравнить значение в одной строке со значением в предыдущей строке конкретной области, например чтобы найти значение годового процента в таблице.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-410">Use `Previous` to compare a value in one row to the previous row's value within a specific scope, for example, to find percentage year over year values in a table.</span></span>  
  
|<span data-ttu-id="c5cbc-411">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-411">**Function**</span></span>|<span data-ttu-id="c5cbc-412">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-412">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="c5cbc-413">First</span><span class="sxs-lookup"><span data-stu-id="c5cbc-413">First</span></span>](report-builder-functions-first-function.md)|<span data-ttu-id="c5cbc-414">Возвращает первое значение указанного выражения для заданной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-414">Returns the first value in the given scope of the specified expression.</span></span>|  
|[<span data-ttu-id="c5cbc-415">Последняя</span><span class="sxs-lookup"><span data-stu-id="c5cbc-415">Last</span></span>](report-builder-functions-last-function.md)|<span data-ttu-id="c5cbc-416">Возвращает последнее значение указанного выражения для заданной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-416">Returns the last value in the given scope of the specified expression.</span></span>|  
|[<span data-ttu-id="c5cbc-417">Назад</span><span class="sxs-lookup"><span data-stu-id="c5cbc-417">Previous</span></span>](report-builder-functions-previous-function.md)|<span data-ttu-id="c5cbc-418">Возвращает значение или значение статистического выражения для предыдущего экземпляра элемента внутри заданной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-418">Returns the value or the specified aggregate value for the previous instance of an item within the specified scope.</span></span>|  
  
##  <a name="retrieving-server-aggregates"></a><a name="RetrievingServerAggregates"></a><span data-ttu-id="c5cbc-419">Получение серверных статистических выражений</span><span class="sxs-lookup"><span data-stu-id="c5cbc-419">Retrieving Server Aggregates</span></span>  
 <span data-ttu-id="c5cbc-420">Следующая встроенная функция получает пользовательские агрегаты из поставщика данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-420">The following built-in function retrieves custom aggregates from the data provider.</span></span> <span data-ttu-id="c5cbc-421">Например, при использовании источника данных типа служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] можно получить агрегаты, вычисляемые на сервере источника данных и используемые в заголовке группы.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-421">For example, using an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data source type, you can retrieve aggregates calculated on the data source server for use in a group header.</span></span>  
  
|<span data-ttu-id="c5cbc-422">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-422">**Function**</span></span>|<span data-ttu-id="c5cbc-423">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c5cbc-423">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="c5cbc-424">Aggregate</span><span class="sxs-lookup"><span data-stu-id="c5cbc-424">Aggregate</span></span>](report-builder-functions-aggregate-function.md)|<span data-ttu-id="c5cbc-425">Возвращает пользовательские статистические данные заданного выражения в соответствии с определением поставщика данных.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-425">Returns a custom aggregate of the specified expression, as defined by the data provider.</span></span>|  
  
##  <a name="testing-for-scope"></a><a name="TestingforScope"></a><span data-ttu-id="c5cbc-426">Тестирование области</span><span class="sxs-lookup"><span data-stu-id="c5cbc-426">Testing for Scope</span></span>  
 <span data-ttu-id="c5cbc-427">Следующая встроенная функция тестирует текущий контекст элемента отчета, чтобы увидеть, является ли он элементом определенной области.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-427">The following built-in function tests the current context of a report item to see if it is a member of a specific scope.</span></span>  
  
|<span data-ttu-id="c5cbc-428">Функция</span><span class="sxs-lookup"><span data-stu-id="c5cbc-428">Function</span></span>|<span data-ttu-id="c5cbc-429">Описание</span><span class="sxs-lookup"><span data-stu-id="c5cbc-429">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="c5cbc-430">InScope</span><span class="sxs-lookup"><span data-stu-id="c5cbc-430">InScope</span></span>](report-builder-functions-inscope-function.md)|<span data-ttu-id="c5cbc-431">Указывает, входит ли текущий экземпляр элемента в пределы указанной области действия.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-431">Indicates whether the current instance of an item is within the specified scope.</span></span>|  
  
##  <a name="retrieving-recursive-level"></a><a name="RetrievingRecursiveLevel"></a><span data-ttu-id="c5cbc-432">Получение уровня рекурсии</span><span class="sxs-lookup"><span data-stu-id="c5cbc-432">Retrieving Recursive Level</span></span>  
 <span data-ttu-id="c5cbc-433">Следующая встроенная функция получает текущий уровень при обработке рекурсивной иерархии.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-433">The following built-in function retrieves the current level when a recursive hierarchy is processed.</span></span> <span data-ttu-id="c5cbc-434">Чтобы управлять уровнем отступа визуальной иерархии для рекурсивной группы, используйте результат этой функции вместе со свойством `Padding` в текстовом поле.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-434">Use the result of this function with the `Padding` property in a text box to control the indent level of a visual hierarchy for a recursive group.</span></span> <span data-ttu-id="c5cbc-435">Дополнительные сведения см. в разделе [Создание групп рекурсивной иерархии (построитель отчетов и службы SSRS)](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="c5cbc-435">For more information, see [Creating Recursive Hierarchy Groups &#40;Report Builder and SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span></span>  
  
|<span data-ttu-id="c5cbc-436">Компонент</span><span class="sxs-lookup"><span data-stu-id="c5cbc-436">Function</span></span>|<span data-ttu-id="c5cbc-437">Description</span><span class="sxs-lookup"><span data-stu-id="c5cbc-437">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="c5cbc-438">Level</span><span class="sxs-lookup"><span data-stu-id="c5cbc-438">Level</span></span>](report-builder-functions-level-function.md)|<span data-ttu-id="c5cbc-439">Возвращает текущий уровень глубины в рекурсивной иерархии.</span><span class="sxs-lookup"><span data-stu-id="c5cbc-439">Returns the current level of depth in a recursive hierarchy.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c5cbc-440">См. также:</span><span class="sxs-lookup"><span data-stu-id="c5cbc-440">See Also</span></span>  
 <span data-ttu-id="c5cbc-441">[Использование выражений в отчетах &#40;построитель отчетов и SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="c5cbc-441">[Expression Uses in Reports &#40;Report Builder and SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="c5cbc-442">[Примеры выражений (построитель отчетов и службы SSRS)](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="c5cbc-442">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="c5cbc-443">Область выражения для суммирования, агрегатных функций и встроенных коллекций (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="c5cbc-443">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  
  
  
