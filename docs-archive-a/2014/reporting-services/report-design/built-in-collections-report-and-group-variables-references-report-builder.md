---
title: Ссылки на коллекции переменных отчета и группы (построитель отчетов и службы SSRS) | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10404"
- sql12.rtp.rptdesigner.categorygroupproperties.variables.f1
- "10083"
- sql12.rtp.rptdesigner.seriesgroupproperties.variables.f1
- sql12.rtp.rptdesigner.reportproperties.variables.f1
- sql12.rtp.rptdesigner.groupproperties.variables.f1
- "10292"
- "10412"
ms.assetid: 4be5b463-3ce2-483d-a3c6-dae752cb543e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 41dd652bf39721b13801131a5ec268495edf9d29
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87728050"
---
# <a name="report-and-group-variables-collections-references-report-builder-and-ssrs"></a><span data-ttu-id="a7255-102">Ссылки на коллекции переменных отчета и группы (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="a7255-102">Report and Group Variables Collections References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="a7255-103">При сложном вычислении, которое используется несколько раз в выражениях отчета, может потребоваться создание переменной.</span><span class="sxs-lookup"><span data-stu-id="a7255-103">When you have a complex calculation that is used more than once in expressions in a report, you might want to create a variable.</span></span> <span data-ttu-id="a7255-104">Можно создать переменную отчета или переменную группы.</span><span class="sxs-lookup"><span data-stu-id="a7255-104">You can create a report variable or a group variable.</span></span> <span data-ttu-id="a7255-105">В отчете имена переменных должны быть уникальными.</span><span class="sxs-lookup"><span data-stu-id="a7255-105">Variable names must be unique in a report.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-variables"></a><span data-ttu-id="a7255-106">Переменные отчета</span><span class="sxs-lookup"><span data-stu-id="a7255-106">Report Variables</span></span>  
 <span data-ttu-id="a7255-107">Переменная отчета используется для хранения значения зависимых от времени вычислений, например курсов валют или отметок времени, либо для сложного вычисления, на которое указывает несколько ссылок.</span><span class="sxs-lookup"><span data-stu-id="a7255-107">Use a report variable to hold a value for time-dependent calculations, such as currency rates or time stamps, or for a complex calculation that is referenced multiple times.</span></span> <span data-ttu-id="a7255-108">По умолчанию переменная отчета вычисляется один раз и может использоваться во всех выражениях отчета.</span><span class="sxs-lookup"><span data-stu-id="a7255-108">By default, a report variable is calculated once and can be used in expressions throughout a report.</span></span> <span data-ttu-id="a7255-109">Переменные отчета по умолчанию доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="a7255-109">Report variables are read-only by default.</span></span> <span data-ttu-id="a7255-110">Можно изменить эту настройку по умолчанию путем включения переменной отчета как допускающей чтение и запись.</span><span class="sxs-lookup"><span data-stu-id="a7255-110">You can change the default to enable a report variable as read-write.</span></span> <span data-ttu-id="a7255-111">Значение переменной отчета сохраняется в течение всего сеанса, до повторной обработки отчета.</span><span class="sxs-lookup"><span data-stu-id="a7255-111">The value in a report variable is preserved throughout a session, until the report is processed again.</span></span>  
  
 <span data-ttu-id="a7255-112">Чтобы добавить переменную отчета, откройте диалоговое окно **Свойства отчета** , выберите пункт **Переменные**и введите имя и значение.</span><span class="sxs-lookup"><span data-stu-id="a7255-112">To add a report variable, open the **ReportProperties** dialog box, click **Variables**, and provide a name and a value.</span></span> <span data-ttu-id="a7255-113">Имена — это строки с учетом регистра, которые начинаются с буквы и не содержат пробелов.</span><span class="sxs-lookup"><span data-stu-id="a7255-113">Names are case-sensitive strings that begin with a letter and have no spaces.</span></span> <span data-ttu-id="a7255-114">Имя может содержать буквы, цифры и символы подчеркивания (_).</span><span class="sxs-lookup"><span data-stu-id="a7255-114">A name can include letters, numbers, or underscores (_).</span></span>  
  
 <span data-ttu-id="a7255-115">Для ссылки на переменную в выражении используется синтаксис глобальной коллекции, например `=Variables!CustomTimeStamp.Value`.</span><span class="sxs-lookup"><span data-stu-id="a7255-115">To refer to the variable in an expression, use the global collection syntax, for example, `=Variables!CustomTimeStamp.Value`.</span></span> <span data-ttu-id="a7255-116">В области конструктора значение появляется в текстовом поле в виде `<<Expr>>`.</span><span class="sxs-lookup"><span data-stu-id="a7255-116">On the design surface, the value appears in a text box as `<<Expr>>`.</span></span>  
  
 <span data-ttu-id="a7255-117">Параметры отчета можно использовать следующими способами.</span><span class="sxs-lookup"><span data-stu-id="a7255-117">You can use report variables in the following ways:</span></span>  
  
-   <span data-ttu-id="a7255-118">**Использование только для чтения** . Задайте значение один раз, чтобы создать константу для сеанса работы с отчетом, например, для создания метки времени.</span><span class="sxs-lookup"><span data-stu-id="a7255-118">**Read-only use** Set a value once to create a constant for the report session, for example, to create a time stamp.</span></span>  
  
     <span data-ttu-id="a7255-119">Выражения в текстовых полях вычисляются по требованию при просмотре отчета пользователем, поэтому динамические значения (например, выражение, включающее функцию `Now()` , возвращающую время суток) могут возвращать различные значения после просмотра следующей страницы и возврата к предыдущей странице с помощью кнопки **Назад** .</span><span class="sxs-lookup"><span data-stu-id="a7255-119">Because expressions in text boxes are evaluated on-demand as a user pages through a report, dynamic values (for example, an expression that includes the `Now()` function, which returns the time of day) can return different values if you page forward and backward by using the **Back** button.</span></span> <span data-ttu-id="a7255-120">Путем задания значения переменной отчета для выражения `=Now()`и добавления переменной в выражение гарантируется использование одного и того же значения при обработке отчета.</span><span class="sxs-lookup"><span data-stu-id="a7255-120">By setting a the value of a report variable to the expression `=Now()`, and then adding the variable to your expression, you ensure the same value is used throughout report processing.</span></span>  
  
-   <span data-ttu-id="a7255-121">**Использование для чтения и записи** . Задайте значение единожды и сериализуйте его в ходе сеанса работы с отчетом.</span><span class="sxs-lookup"><span data-stu-id="a7255-121">**Read-write use** Set a value once and serialize the value within a report session.</span></span> <span data-ttu-id="a7255-122">Вариант с чтением и записью для переменных представляет собой лучшую альтернативу по сравнению с использованием статической переменной в блоке «Код» определения отчета.</span><span class="sxs-lookup"><span data-stu-id="a7255-122">The read-write option for variables provides a better alternative than using a static variable in the Code block in the report definition.</span></span>  
  
     <span data-ttu-id="a7255-123">При снятии параметра **только для чтения** для переменной свойство для записи переменной устанавливается в значение `true` .</span><span class="sxs-lookup"><span data-stu-id="a7255-123">When you clear the **Read-Only** option for a variable, the Writable property for the variable is set to `true`.</span></span> <span data-ttu-id="a7255-124">Чтобы обновить значение этой переменной с помощью выражения, используйте метод SetValue, например `=Variables!MyVariable.SetValue("123")`.</span><span class="sxs-lookup"><span data-stu-id="a7255-124">To update the value from an expression, use the SetValue method, for example, `=Variables!MyVariable.SetValue("123")`.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="a7255-125">Нельзя управлять инициализацией переменной или вычислением выражения, которое обновляет значение переменной, в обработчике отчетов.</span><span class="sxs-lookup"><span data-stu-id="a7255-125">You cannot control when the report processor initializes a variable or evaluates an expression that updates a variable.</span></span> <span data-ttu-id="a7255-126">Порядок выполнения при инициализации переменной не определен.</span><span class="sxs-lookup"><span data-stu-id="a7255-126">The order of execution for variable initialization is undefined.</span></span>  
  
 <span data-ttu-id="a7255-127">Дополнительные сведения о сеансах см. в разделе [Previewing Reports in Report Builder](../report-builder/previewing-reports-in-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="a7255-127">For more information about sessions, see [Previewing Reports in Report Builder](../report-builder/previewing-reports-in-report-builder.md).</span></span>  
  
## <a name="group-variables"></a><span data-ttu-id="a7255-128">Групповые переменные</span><span class="sxs-lookup"><span data-stu-id="a7255-128">Group Variables</span></span>  
 <span data-ttu-id="a7255-129">Групповые переменные используются для однократного вычисления сложного выражения в области группы.</span><span class="sxs-lookup"><span data-stu-id="a7255-129">Use a group variable to calculate a complex expression once in the scope of a group.</span></span> <span data-ttu-id="a7255-130">Групповая переменная действительна только в области группы и ее дочерних групп.</span><span class="sxs-lookup"><span data-stu-id="a7255-130">A group variable is valid only in the scope of the group and its child groups.</span></span>  
  
 <span data-ttu-id="a7255-131">Например, предположим, что область данных отображает складские запасы элементов, находящихся в различных налоговых категориях, и требуется установить налоговые ставки для каждой категории.</span><span class="sxs-lookup"><span data-stu-id="a7255-131">For example, suppose a data region displays inventory data for items that are in different tax categories and you want to apply different tax rates for each category.</span></span> <span data-ttu-id="a7255-132">Затем следует сгруппировать данные в категории и определить переменную *Tax* в родительской группе.</span><span class="sxs-lookup"><span data-stu-id="a7255-132">You would group the data on Category and define a *Tax* variable on the parent group.</span></span> <span data-ttu-id="a7255-133">Потом необходимо определить групповую переменную для параметра *ItemTax* для каждой налоговой категории и назначить для каждой из отдельных подгрупп категории требуемую групповую переменную.</span><span class="sxs-lookup"><span data-stu-id="a7255-133">Then you would define a group variable for *ItemTax* for each tax category and assign each of the different Category subgroups to the correct group variable.</span></span> <span data-ttu-id="a7255-134">Пример:</span><span class="sxs-lookup"><span data-stu-id="a7255-134">For example:</span></span>  
  
-   <span data-ttu-id="a7255-135">Для родительской группы, основанной на `[Category]`, следует определить переменную *Tax* со значением `[Tax]`.</span><span class="sxs-lookup"><span data-stu-id="a7255-135">For the parent group based on `[Category]`, define the variable *Tax* with a value `[Tax]`.</span></span> <span data-ttu-id="a7255-136">Предположим, что значениями категории являются пищевые продукты и одежда.</span><span class="sxs-lookup"><span data-stu-id="a7255-136">Assume the category values are Food and Clothing.</span></span>  
  
-   <span data-ttu-id="a7255-137">Для дочерней группы, основанной на `[Subcategory]`, следует определить переменную *ItemsTax* как `=Variables!Tax.Value * Sum(Fields!Price.Value)`.</span><span class="sxs-lookup"><span data-stu-id="a7255-137">For the child group based on `[Subcategory]`, define the variable *ItemsTax* as `=Variables!Tax.Value * Sum(Fields!Price.Value)`.</span></span> <span data-ttu-id="a7255-138">Предположим, что значениями подкатегории для категории «Пищевые продукты» являются напитки и хлеб.</span><span class="sxs-lookup"><span data-stu-id="a7255-138">Assume the subcategory values for the category Food are Beverages and Bread.</span></span> <span data-ttu-id="a7255-139">Предположим, что значениями подкатегории «Одежда» являются рубашки и шляпы.</span><span class="sxs-lookup"><span data-stu-id="a7255-139">Assume the subcategory values for Clothing are Shirts and Hats.</span></span>  
  
-   <span data-ttu-id="a7255-140">В текстовом поле в строке дочерней группы следует добавить выражение `=Variables!ItemsTax.Value`.</span><span class="sxs-lookup"><span data-stu-id="a7255-140">For a text box in a row in the child group, add the expression `=Variables!ItemsTax.Value`.</span></span>  
  
     <span data-ttu-id="a7255-141">В текстовом поле отображается полная сумма налога для напитков и хлеба при помощи налога «Пищевые продукты» и для рубашек и шляп — при помощи налога «Одежда».</span><span class="sxs-lookup"><span data-stu-id="a7255-141">The text box displays the total tax for Beverages and Bread using the Food tax and for Shirts and Hats using the Clothing tax.</span></span>  
  
 <span data-ttu-id="a7255-142">Чтобы добавить групповую переменную, следует открыть диалоговое окно **Свойства группы табликса** , выбрать пункт **Переменные**и ввести имя и значение.</span><span class="sxs-lookup"><span data-stu-id="a7255-142">To add a group variable, open the **Tablix Group Properties** dialog box, click **Variables**, and provide a name and a value.</span></span> <span data-ttu-id="a7255-143">Групповая переменная вычисляется один раз для уникального значения группы.</span><span class="sxs-lookup"><span data-stu-id="a7255-143">The group variable is calculated once per unique group value.</span></span>  
  
 <span data-ttu-id="a7255-144">Для ссылки на переменную в выражении используется синтаксис глобальной коллекции, например `=Variables!GroupDescription.Value`.</span><span class="sxs-lookup"><span data-stu-id="a7255-144">To refer to the variable in an expression, use the global collection syntax, for example, `=Variables!GroupDescription.Value`.</span></span> <span data-ttu-id="a7255-145">В области конструктора значение появляется в текстовом поле в виде `<<Expr>>`.</span><span class="sxs-lookup"><span data-stu-id="a7255-145">On the design surface, the value appears in a text box as `<<Expr>>`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a7255-146">См. также:</span><span class="sxs-lookup"><span data-stu-id="a7255-146">See Also</span></span>  
 <span data-ttu-id="a7255-147">[Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](filter-group-and-sort-data-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="a7255-147">[Filter, Group, and Sort Data &#40;Report Builder and SSRS&#41;](filter-group-and-sort-data-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="a7255-148">[Встроенные коллекции в выражениях (построитель отчетов и службы SSRS)](built-in-collections-in-expressions-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="a7255-148">[Built-in Collections in Expressions &#40;Report Builder and SSRS&#41;](built-in-collections-in-expressions-report-builder.md) </span></span>  
 [<span data-ttu-id="a7255-149">Примеры выражений (построитель отчетов и службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="a7255-149">Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](expression-examples-report-builder-and-ssrs.md)  
  
  
