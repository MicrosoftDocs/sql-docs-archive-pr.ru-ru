---
title: Обновление базы данных сервера отчетов | Документы Майкрософт
ms.custom: ''
ms.date: 08/10/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- upgrading databases
- report server database
- upgrading Reporting Services
ms.assetid: 4091cf87-9d97-4048-a393-67f1f9207401
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 28e382de505781f4155204fcc652d1308dacce76
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668653"
---
# <a name="upgrade-a-report-server-database"></a><span data-ttu-id="dbe57-102">Обновление базы данных сервера отчетов</span><span class="sxs-lookup"><span data-stu-id="dbe57-102">Upgrade a Report Server Database</span></span>
  <span data-ttu-id="dbe57-103">База данных сервера отчетов обеспечивает хранение одного или нескольких экземпляров сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-103">The report server database provides storage for one or more report server instances.</span></span> <span data-ttu-id="dbe57-104">Схема базы данных сервера отчетов с каждым новым выпуском служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]может меняться, поэтому версия базы данных должна совпадать с версией используемого экземпляра сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-104">Because the report server database schema can change with each new release of [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], it is required that the database version match the version of the report server instance you are using.</span></span> <span data-ttu-id="dbe57-105">В большинстве случаев обновление базы данных сервера отчетов может быть выполнено автоматически, без необходимости выполнения каких-либо действий со стороны пользователя.</span><span class="sxs-lookup"><span data-stu-id="dbe57-105">In most cases, a report server database can be upgraded automatically with no specific action on your part.</span></span>  
  
 <span data-ttu-id="dbe57-106">**Основной режим:** В [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] собственном режиме база данных сервера отчетов на самом деле состоит из двух баз данных с именами по умолчанию ReportServer и reportservertempdb.</span><span class="sxs-lookup"><span data-stu-id="dbe57-106">**Native Mode:** In [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Native mode, the report server database is actually comprised of two database that have default names of "ReportServer and ReportServerTempDB".</span></span>  
  
 <span data-ttu-id="dbe57-107">**Режим интеграции с SharePoint:** В [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] режиме интеграции с SharePoint база данных сервера отчетов фактически является коллекцией баз данных, создаваемых для каждого экземпляра [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] приложения службы.</span><span class="sxs-lookup"><span data-stu-id="dbe57-107">**SharePoint mode:** In [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] SharePoint mode the report server database is actually a collection of databases that is created for each instance of the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] service application.</span></span>  
  
## <a name="ways-to-upgrade-a-native-mode-report-server-database"></a><span data-ttu-id="dbe57-108">Способы обновления базы данных сервера отчетов в собственном режиме</span><span class="sxs-lookup"><span data-stu-id="dbe57-108">Ways to Upgrade a Native Mode Report Server Database</span></span>  
 <span data-ttu-id="dbe57-109">В следующем списке приведены условия, при соблюдении которых происходит обновление базы данных сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-109">The following list identifies the conditions under which a report server database is upgraded:</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="dbe57-110">Программа установки обновит одиночный экземпляр сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-110">Setup upgrades a single instance of a report server.</span></span> <span data-ttu-id="dbe57-111">Схема базы данных сервера отчетов будет автоматически обновлена, после того как служба запустится и сервер отчетов определит, что версия схемы базы данных не совпадает с версией сервера.</span><span class="sxs-lookup"><span data-stu-id="dbe57-111">The report server database schema is automatically upgraded after service startup and the report server determines that the database schema version does not match the server version.</span></span>  
  
     <span data-ttu-id="dbe57-112">При запуске службы сервер отчетов проверяет версию схемы базы данных, чтобы определить, соответствует ли она версии сервера.</span><span class="sxs-lookup"><span data-stu-id="dbe57-112">At service startup, the report server checks the database schema version to verify that it matches the server version.</span></span> <span data-ttu-id="dbe57-113">Если у схемы базы данных более старая версия, то она будет автоматически обновлена до версии, необходимой серверу отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-113">If the database schema version is an older version, it is automatically upgraded to the schema version that is required by the report server.</span></span> <span data-ttu-id="dbe57-114">Функция автоматического обновления особенно полезна при восстановлении из резервной копии или подключении старой базы данных сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-114">Automatic upgrade is especially useful if you restored or attached an older report server database.</span></span> <span data-ttu-id="dbe57-115">В файл журнала трассировки сервера отчетов выводится сообщение об обновлении версии схемы базы данных.</span><span class="sxs-lookup"><span data-stu-id="dbe57-115">A message is entered in the report server trace log file indicating that the database schema version was upgraded.</span></span>  
  
-   <span data-ttu-id="dbe57-116">Диспетчер конфигурации служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] обновляет локальную или удаленную базу данных сервера отчетов, если для использования с более новым экземпляром сервера отчетов выбрана предыдущая версия.</span><span class="sxs-lookup"><span data-stu-id="dbe57-116">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager upgrades a local or remote report server database when you select an older version to use with a newer report server instance.</span></span> <span data-ttu-id="dbe57-117">В этом случае необходимо подтвердить выполнение обновления, прежде чем оно будет осуществлено.</span><span class="sxs-lookup"><span data-stu-id="dbe57-117">In this case, you must confirm the upgrade action before it happens.</span></span>  
  
     <span data-ttu-id="dbe57-118">В диспетчере конфигурации служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] больше нет отдельной кнопки «Обновить» и скрипта обновления.</span><span class="sxs-lookup"><span data-stu-id="dbe57-118">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager no longer provides a separate Upgrade button or upgrade script.</span></span> <span data-ttu-id="dbe57-119">Эти средства устарели, начиная с [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] , в связи с появлением в службе сервера отчетов функции автоматического обновления.</span><span class="sxs-lookup"><span data-stu-id="dbe57-119">Those features are obsolete starting with [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] due to the automatic upgrade feature of the Report Server service.</span></span>  
  
 <span data-ttu-id="dbe57-120">После обновления схемы откат до предыдущей версии становится невозможным.</span><span class="sxs-lookup"><span data-stu-id="dbe57-120">After the schema is updated, you cannot rollback the upgrade to an earlier version.</span></span> <span data-ttu-id="dbe57-121">Чтобы иметь возможность повторно создать предыдущую установку, всегда создавайте резервную копию базы данных сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-121">Always backup the report server database in case you need to recreate a previous installation.</span></span>  
  
## <a name="how-the-schema-metadata-and-report-server-content-is-updated"></a><span data-ttu-id="dbe57-122">Обновление схемы, метаданных и содержимого сервера отчетов</span><span class="sxs-lookup"><span data-stu-id="dbe57-122">How the Schema, Metadata, and Report Server Content is Updated</span></span>  
 <span data-ttu-id="dbe57-123">База данных сервера отчетов обновляется в три этапа.</span><span class="sxs-lookup"><span data-stu-id="dbe57-123">The report server database is upgraded in three stages:</span></span>  
  
1.  <span data-ttu-id="dbe57-124">Схема обновляется автоматически после установки и запуска службы или же после выбора базы данных сервера отчетов [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в собственном режиме в диспетчере конфигурации [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] , который имеет более старую версию.</span><span class="sxs-lookup"><span data-stu-id="dbe57-124">The schema is upgraded automatically after setup and service startup, or when you select a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native mode report server database in the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager that is an older version.</span></span> <span data-ttu-id="dbe57-125">Кроме этого, служба сервера отчетов осуществляет проверку версии базы данных во время запуска.</span><span class="sxs-lookup"><span data-stu-id="dbe57-125">In addition, the Report Server service checks the database version at startup.</span></span> <span data-ttu-id="dbe57-126">Если сервер отчетов соединяется с базой данных предыдущей версии, то он обновляет ее во время своего запуска.</span><span class="sxs-lookup"><span data-stu-id="dbe57-126">If the report server is connected to a database that is an earlier version, the report server will update the database during startup.</span></span>  
  
2.  <span data-ttu-id="dbe57-127">Дескрипторы безопасности обновляются при первом использовании базы данных сервера отчетов после обновления схемы.</span><span class="sxs-lookup"><span data-stu-id="dbe57-127">Security descriptors are upgraded on first use of the report server database after the schema is updated.</span></span>  
  
3.  <span data-ttu-id="dbe57-128">Опубликованные отчеты и скомпилированные моментальные снимки отчетов обновляются при первом использовании.</span><span class="sxs-lookup"><span data-stu-id="dbe57-128">Published reports and compiled report snapshots are updated on first use.</span></span> <span data-ttu-id="dbe57-129">Дополнительные сведения см. в разделе [Upgrade Reports](upgrade-reports.md).</span><span class="sxs-lookup"><span data-stu-id="dbe57-129">For more information, see [Upgrade Reports](upgrade-reports.md).</span></span>  
  
 <span data-ttu-id="dbe57-130">Кроме базы данных сервера отчетов при работе сервера отчетов используется временная база данных.</span><span class="sxs-lookup"><span data-stu-id="dbe57-130">In addition to the report server database, a report server also uses a temporary database.</span></span> <span data-ttu-id="dbe57-131">Она обновляется автоматически при обновлении базы данных сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-131">The temporary database is upgraded automatically when you upgrade the report server database.</span></span>  
  
## <a name="permissions-required-to-upgrade-a-report-server-database"></a><span data-ttu-id="dbe57-132">Разрешения, необходимые для обновления базы данных сервера отчетов</span><span class="sxs-lookup"><span data-stu-id="dbe57-132">Permissions required to upgrade a Report Server Database</span></span>  
 <span data-ttu-id="dbe57-133">При обновлении установки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] , включающем базу данных сервера отчетов, может появиться сообщение об ошибке, если обновление базы данных выполняется с недостаточными разрешениями.</span><span class="sxs-lookup"><span data-stu-id="dbe57-133">If you are upgrading a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation that includes a report server database, you may see an error message if the database upgrade is performed with insufficient permissions.</span></span> <span data-ttu-id="dbe57-134">По умолчанию программа установки для соединения с удаленным экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и обновления схемы пользуется токеном безопасности пользователя, запустившего программу установки.</span><span class="sxs-lookup"><span data-stu-id="dbe57-134">By default, Setup uses the security token of the user who is running the Setup program to connect to the remote [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance and update the schema.</span></span> <span data-ttu-id="dbe57-135">База данных будет успешно обновлена, если у пользователя есть разрешения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **sysadmin** на доступ к серверу базы данных с расположенными базами данных сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="dbe57-135">If you have [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **sysadmin** permissions on the database server that hosts the report server databases, the database upgrade will succeed.</span></span> <span data-ttu-id="dbe57-136">Аналогичным образом при запуске программы установки из командной строки с указанием аргументов RSUPGRADEDATABASEACCOUNT и RSUPGRADEPASSWORD с учетными данными, обладающими разрешением **sysadmin** на изменение схемы на удаленном компьютере, обновление данных также произойдет успешно.</span><span class="sxs-lookup"><span data-stu-id="dbe57-136">Similarly, if you run Setup from the command prompt and specify the RSUPGRADEDATABASEACCOUNT and RSUPGRADEPASSWORD arguments for an account that has **sysadmin** permission to modify the schema on the remote computer, the database upgrade will succeed.</span></span>  
  
 <span data-ttu-id="dbe57-137">Однако, если разрешение **sysadmin** на изменение схемы на удаленном компьютере отсутствуют, в соединении будет отказано со следующей ошибкой.</span><span class="sxs-lookup"><span data-stu-id="dbe57-137">However, if you do not have **sysadmin** permission to the database on the remote computer, the connection will be refused with the following error:</span></span>  
  
 `"Setup was not able to upgrade the report server database schema. You must update the database schema manually after setup is finished. To update the schema, run the Reporting Services Configuration Manager, open the Database Setup page, re-select the database, and click Apply. The database will be upgraded automatically."`  
  
 <span data-ttu-id="dbe57-138">В этот момент произойдет обновление программных файлов сервера отчетов, однако версия формата базы данных сервера отчетов останется прежней.</span><span class="sxs-lookup"><span data-stu-id="dbe57-138">At this point, the report server program files will be upgraded, but the report server database will be in the format of the previous version.</span></span> <span data-ttu-id="dbe57-139">Сервер отчетов будет недоступен до тех пор, пока процесс обновления не будет завершен (для этого базу данных необходимо обновить вручную).</span><span class="sxs-lookup"><span data-stu-id="dbe57-139">The report server will be unavailable until you finish the upgrade process by upgrading the database manually.</span></span>  
  
#### <a name="to-upgrade-a-native-mode-database-with-scripts"></a><span data-ttu-id="dbe57-140">Обновление базы данных в собственном режиме с помощью скриптов</span><span class="sxs-lookup"><span data-stu-id="dbe57-140">To upgrade a Native Mode database With Scripts</span></span>  
 <span data-ttu-id="dbe57-141">Для обновления базы данных сервера отчетов можно использовать скрипты WMI.</span><span class="sxs-lookup"><span data-stu-id="dbe57-141">You can use WMI scripts to upgrade a report server database.</span></span> <span data-ttu-id="dbe57-142">Дополнительные сведения см. в статье [Метод GenerateDatabaseUpgradeScript (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md).</span><span class="sxs-lookup"><span data-stu-id="dbe57-142">For more information, see [GenerateDatabaseUpgradeScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dbe57-143">См. также:</span><span class="sxs-lookup"><span data-stu-id="dbe57-143">See Also</span></span>  
 <span data-ttu-id="dbe57-144">[Использование диспетчера конфигурации служб Reporting Services (собственный режим)](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="dbe57-144">[Reporting Services Configuration Manager &#40;Native Mode&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span></span>  
 <span data-ttu-id="dbe57-145">[Создание базы данных сервера отчетов &#40;службы SSRS Configuration Manager&#41;](../../sql-server/install/create-a-report-server-database-ssrs-configuration-manager.md) </span><span class="sxs-lookup"><span data-stu-id="dbe57-145">[Create a Report Server Database  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/create-a-report-server-database-ssrs-configuration-manager.md) </span></span>  
 <span data-ttu-id="dbe57-146">[Мастер изменения базы данных &#40;&#41;служб SSRS в собственном режиме](../../sql-server/install/change-database-wizard-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="dbe57-146">[Change Database Wizard &#40;SSRS Native Mode&#41;](../../sql-server/install/change-database-wizard-ssrs-native-mode.md) </span></span>  
 <span data-ttu-id="dbe57-147">[Обновление и перенос служб Reporting Services](upgrade-and-migrate-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="dbe57-147">[Upgrade and Migrate Reporting Services](upgrade-and-migrate-reporting-services.md) </span></span>  
 [<span data-ttu-id="dbe57-148">Перенос установки служб Reporting Services (собственный режим)</span><span class="sxs-lookup"><span data-stu-id="dbe57-148">Migrate a Reporting Services Installation &#40;Native Mode&#41;</span></span>](migrate-a-reporting-services-installation-native-mode.md)  
  
  
