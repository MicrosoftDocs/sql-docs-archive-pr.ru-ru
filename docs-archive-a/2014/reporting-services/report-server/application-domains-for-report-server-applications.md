---
title: Домены приложений для приложений сервера отчетов | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- application domains [Reporting Services]
- recycling application domains
ms.assetid: a455e2e6-8764-493d-a1bc-abe80829f543
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 5f52ee48c5a5f9113b277271320b649ed8e7dd79
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87665841"
---
# <a name="application-domains-for-report-server-applications"></a>Домены приложений для приложений сервера отчетов
  В службах [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]сервер отчетов реализован как единственная служба, включающая веб-службу сервера отчетов, диспетчер отчетов и приложение фоновой обработки. Каждое приложение эксплуатируется в собственном домене приложения, в составе общего процесса сервера отчетов. Создание, настройка и управление доменами приложений обычно осуществляются внутри процесса. Однако знание того, как происходят операции очистки для доменов приложений сервера отчетов, может быть полезным при исследовании проблем производительности или использования памяти и при устранении неполадок в работе службы.  
  
> [!NOTE]  
>  При настройке доступа к построителю отчетов на сервере отчетов, который использует обычную проверку подлинности, построитель отчетов выполняется в своем собственном домене приложений. Это домен приложений, отличный от других доменов приложений, которые запускаются в процессе сервера. Он управляется контроллером служб и не зависит от функций управления памятью, которые перераспределяют память в процессе ее активного использования на сервере отчетов.  
  
 В следующем списке описаны события, которые становятся причиной выполнения операций очистки домена приложений служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .  
  
-   Плановые операции очистки, выполняемые через стандартные интервалы времени.  
  
-   Изменения конфигурации на сервере отчетов.  
  
-   [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] .  
  
-   Сбой выделения памяти.  
  
 В следующей таблице приведены итоговые сведения о том, как происходит очистка домена приложений в ответ на эти события.  
  
|Событие|Описание события|Применяется к|Настраивается|Описание операции очистки|  
|-----------|-----------------------|----------------|------------------|-----------------------------------|  
|Плановые операции очистки, выполняемые через стандартные интервалы времени|По умолчанию, домены приложений очищаются через каждые 12 часов.<br /><br /> Плановые операции очистки чаще всего выполняются применительно к приложениям [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] , обеспечивающих общую исправность процесса.|Веб-служба сервера отчетов<br /><br /> Диспетчер отчетов<br /><br /> Приложение фоновой обработки|Да. Значение параметра конфигурации `RecycleTime` в файле RSReportServer.config определяет интервал очистки.<br /><br /> Параметр `MaxAppDomainUnloadTime` задает время ожидания, в течение которого допускается завершение фоновой обработки.|[!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] управляет операцией очистки для веб-службы и диспетчера отчетов.<br /><br /> Для приложения фоновой обработки сервер отчетов создает новый домен приложения для новых заданий, инициированных по расписанию. Завершение уже выполняемых заданий в текущем домене приложения допускается до истечения времени ожидания.|  
|Изменения конфигурации на сервере отчетов|[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] очищают домены приложений в ответ на изменения в файле RSReportServer.config.|Веб-служба сервера отчетов<br /><br /> Диспетчер отчетов<br /><br /> Приложение фоновой обработки|Нет.|Остановить операции очистки невозможно. Тем не менее, операции очистки, выполняемые в ответ на изменения конфигурации, осуществляются таким же образом, как и плановые операции очистки. Для новых запросов создаются новые домены приложений, в то время как текущие запросы и задания завершаются в текущем домене приложения.|  
|[!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] изменения конфигурации|[!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] осуществляет очистку доменов приложений, если происходят изменения в отслеживаемых им файлах (например, в файлах machine.config и Web.config, а также в программных файлах [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] ).|Веб-служба сервера отчетов<br /><br /> Диспетчер отчетов|Нет.|[!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] управляет работой.<br /><br /> Операции очистки, инициированные [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] , не затрагивают домен приложения фоновой обработки.|  
|Нехватка памяти и ошибки при выделении памяти|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] немедленно происходит очистка доменов приложений в случае ошибки при выделении памяти или в условиях значительной нехватки памяти на сервере.|Веб-служба сервера отчетов<br /><br /> Диспетчер отчетов<br /><br /> Приложение фоновой обработки|Нет.|При значительной нехватке памяти сервер отчетов не принимает новые запросы в текущем домене приложения. Пока сервер отклоняет новые запросы, происходят ошибки HTTP 503. Новые домены приложений не создаются до тех пор, пока не произойдет выгрузка старого домена приложения. Это означает, что в случае внесения изменений в файл конфигурации в условиях значительной нехватки памяти на сервере, выполняемые запросы и задания могут не запускаться или не завершаться.<br /><br /> В случае ошибки при выполнении операции выделения памяти происходит немедленный перезапуск всех доменов приложений. Выполняемые задания и запросы уничтожаются. Необходимо перезапустить эти задания и запросы вручную.|  
  
## <a name="planned-and-unplanned-recycle-operations"></a>Запланированные и незапланированные операции очистки  
 Операции очистки могут быть либо запланированными, либо незапланированными, в зависимости от условий, которые приводят к выполнению операции.  
  
-   Запланированные операции очистки происходят через постоянные интервалы, которые определены в файле RSReportServer.config. По умолчанию— через каждые 12 часов. Это характерно для приложений [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] , обеспечивающих общую исправность процесса. Для запланированных операций очистки сервер отчетов создает дополнительные домены приложений для новых запросов. Завершение уже выполняемых запросов в текущем домене приложения допускается до истечения времени ожидания. Значения параметров конфигурации, которые управляют запланированными операциями очистки, задаются для всего сервера в целом. Возможность настроить отдельное расписание очистки или пороговое значение памяти для каждого приложения отсутствует.  
  
-   Незапланированные операции очистки происходят в произвольные моменты времени в ответ на изменения конфигурации, нехватку памяти и ошибки при выполнении операций выделения памяти.  
  
    -   При изменениях конфигурации сервер отчетов предпринимает попытку использовать мягкую очистку, при которой выполняется перенаправление новых запросов на новый экземпляр домена приложения. Если мягкая очистка оканчивается неудачей, сервер инициирует жесткую очистку домена приложения, которая предусматривает отмену всех выполняемых запросов, останов текущих доменов приложений и перезапуск доменов приложений.  
  
    -   Возникновение ошибок при осуществлении операций выделения памяти указывает на то, что системные ресурсы являются недостаточными для объема обработки отчетов, выполняемого сервером. Операция жесткой очистки для всех доменов приложений происходит в ответ на ошибку операции выделения памяти. Все очереди запросов очищаются. Отмененные запросы не перезапускаются. Пользователи, которые просматривали отчет в оперативном режиме, должны обновить или повторно открыть отчет. Плановая обработка произойдет в следующий запланированный момент времени. Если связанная с этим задержка недопустима, то можно обновить моментальный снимок отчета вручную, либо изменить расписание подписки или расписание моментальных снимков отчетов, чтобы требуемая обработка была выполнена немедленно.  
  
 Очистка доменов приложений для веб-службы сервера отчетов, диспетчера отчетов и приложения фоновой обработки может осуществляться вместе или отдельно, в зависимости от обстоятельств, которые приводят к выполнению очистки.  
  
-   Операции очистки, инициированные [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)], затрагивают только приложения [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)]: Веб-служба сервера отчетов и диспетчер отчетов. [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] очистка доменов приложений зависит от того, имеются ли изменения в отслеживаемых файлах. Операции очистки, которые инициированы [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] , как правило, являются независимыми от операций очистки, относящихся к приложениям фоновой обработки.  
  
-   Операции очистки, инициированные сервером отчетов, обычно затрагивают веб-службу сервера отчетов, диспетчер отчетов и приложение фоновой обработки. Операции очистки происходят в ответ на изменения значений параметров конфигурации и перезапуска службы.  
  
## <a name="rsreportserver-configuration-settings-for-application-domains"></a>Значения параметров конфигурации RSReportServer для доменов приложений  
 Параметры конфигурации задаются в файле [RSReportServer.config](rsreportserver-config-configuration-file.md). В следующем примере показаны параметры конфигурации по умолчанию, относящиеся к запланированному выполнению очистки домена приложения.  
  
 `<RecycleTime>720</RecycleTime>`  
  
 `<MaxAppDomainUnloadTime>30</MaxAppDomainUnloadTime>`  
  
 Эти элементы описываются в следующей таблице.  
  
|Элемент|Применяется к|Определение|  
|-------------|----------------|----------------|  
|`RecycleTime`|Все три домена приложений служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]|Указывает, как часто происходит очистка доменов приложений. По умолчанию расписание очистки соответствует 12-часовой схеме, обычно применяемой для очистки домена приложения [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] . С указанного в расписании времени все новые запросы перенаправляются новому экземпляру домена приложений. Запросы, которые в данный момент выполняются на исходном экземпляре, отрабатывают до завершения. После завершения всех процессов исходный экземпляр удаляется, а новый экземпляр становится единственным активным экземпляром домена приложений.<br /><br /> Значение по умолчанию составляет 720 минут.|  
|`MaxAppDomainUnloadTime`|Только домен приложения фоновой обработки|По умолчанию сервер отчетов предоставляет 30 минут для завершения работы домена приложения во время операции очистки. Если выполняемые задания не могут быть завершены в течение предоставленного времени (или если задание занимает больше времени, чем позволяет период ожидания), экземпляр домена приложения немедленно перезапускается. Все незавершенные задания прерываются.<br /><br /> Дополнительные сведения о просмотре состояния или отмене заданий, выполняемых на сервере отчетов, см. в разделе [Отмена заданий сервера отчетов (среда Management Studio)](../tools/cancel-report-server-jobs-management-studio.md).|  
  
> [!NOTE]  
>  Хотя веб-служба сервера отчетов и диспетчер отчетов являются приложениями [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] , они не реагируют на плановую очистку домена приложений, которая может быть указана в файле machine.config для приложений [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] , развернутых на сервере служб IIS.  
  
## <a name="see-also"></a>См. также:  
 [Файл конфигурации RSReportServer](rsreportserver-config-configuration-file.md)   
 [Изменение файла конфигурации служб Reporting Services (RSreportserver.config)](modify-a-reporting-services-configuration-file-rsreportserver-config.md)   
 [Настройка доступной памяти для приложений сервера отчетов](../report-server/configure-available-memory-for-report-server-applications.md)  
  
  
