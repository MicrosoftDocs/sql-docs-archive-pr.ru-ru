---
title: Конструктор запросов к спискам SharePoint (построитель отчетов) | Документы Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10016"
ms.assetid: b8a3122c-8008-4950-b515-937636d7967f
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: a35efb926b8f729874cff42afc53fb5820c920f0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87751756"
---
# <a name="sharepoint-list-query-designer-report-builder"></a><span data-ttu-id="a0816-102">Конструктор запросов к спискам SharePoint (построитель отчетов)</span><span class="sxs-lookup"><span data-stu-id="a0816-102">SharePoint List Query Designer (Report Builder)</span></span>
  <span data-ttu-id="a0816-103">Построитель отчетов предоставляет графический и текстовый конструкторы запросов, с помощью которых можно создавать запросы, определяющие данные, получаемые с сайта SharePoint для набора данных отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-103">Report Builder provides both a graphical query designer and a text-based query designer to help you create a query that specifies the data to retrieve from a SharePoint site for a report dataset.</span></span> <span data-ttu-id="a0816-104">Графический конструктор запросов используется для просмотра метаданных списка SharePoint, интерактивного создания запроса, а также для просмотра его результатов.</span><span class="sxs-lookup"><span data-stu-id="a0816-104">Use the graphical query designer to explore the SharePoint list metadata, interactively build a query, and view the results of your query.</span></span> <span data-ttu-id="a0816-105">Текстовый конструктор запросов используется для просмотра запроса, созданного графическим конструктором запросов, для его изменения или ввода команд запроса.</span><span class="sxs-lookup"><span data-stu-id="a0816-105">Use the text-based query designer to view the query that was built by the graphical query designer, modify a query, or type the query commands.</span></span> <span data-ttu-id="a0816-106">Также можно импортировать существующий запрос из файла или отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-106">You can also import an existing query from a file or report.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="a0816-107">При создании и выполнении запросов пользователи получают доступ к источникам данных.</span><span class="sxs-lookup"><span data-stu-id="a0816-107">Users access data sources when they create and run queries.</span></span> <span data-ttu-id="a0816-108">Следует предоставить минимальные разрешения на источники данных, например разрешение только на чтение.</span><span class="sxs-lookup"><span data-stu-id="a0816-108">You should grant minimal permissions on the data sources, such as read-only permissions.</span></span>  
  
## <a name="graphical-query-designer"></a><span data-ttu-id="a0816-109">Графический конструктор запросов</span><span class="sxs-lookup"><span data-stu-id="a0816-109">Graphical Query Designer</span></span>  
 <span data-ttu-id="a0816-110">Графический конструктор запросов позволяет просматривать сайт SharePoint, в интерактивном режиме формировать команду, получающую данные списка SharePoint для набора данных.</span><span class="sxs-lookup"><span data-stu-id="a0816-110">In the graphical query designer you can explorer the SharePoint site, interactively build the command that retrieve SharePoint list data for a dataset.</span></span> <span data-ttu-id="a0816-111">Следует выбрать поля, включаемые в набор данных, и при необходимости указать фильтры, ограничивающие данные в наборе данных.</span><span class="sxs-lookup"><span data-stu-id="a0816-111">You choose the fields to include in the dataset and optionally, specify filters that limit the data in the dataset.</span></span> <span data-ttu-id="a0816-112">Можно указать, что фильтры используются в качестве параметров, и указывать значение фильтра во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="a0816-112">You can specify that filters are used as parameters and provide the value of the filter at run-time.</span></span>  
  
 <span data-ttu-id="a0816-113">Списки SharePoint содержат большое количество специальных полей SharePoint, которые совершенно не нужно включать в отчеты.</span><span class="sxs-lookup"><span data-stu-id="a0816-113">SharePoint lists include a large number of SharePoint specific fields that might not be useful to include in reports.</span></span> <span data-ttu-id="a0816-114">В конструкторе запросов предусмотрен параметр для скрытия этих полей, что позволяет находить нужные поля гораздо проще и быстрее.</span><span class="sxs-lookup"><span data-stu-id="a0816-114">The query designer provides an option to hide these fields to make it easier and quicker to determine the fields to use.</span></span>  
  
 <span data-ttu-id="a0816-115">Графический конструктор запросов состоит из трех областей</span><span class="sxs-lookup"><span data-stu-id="a0816-115">The graphical query designer is divided into three areas</span></span>  
  
-   <span data-ttu-id="a0816-116">Просмотрите панель, на которой выбираются элементы списка и их поля для использования.</span><span class="sxs-lookup"><span data-stu-id="a0816-116">Explore pane in which you select the list items and their fields to use.</span></span>  
  
-   <span data-ttu-id="a0816-117">Область конструирования, в которой создается запрос.</span><span class="sxs-lookup"><span data-stu-id="a0816-117">Design area in which you build the query.</span></span>  
  
-   <span data-ttu-id="a0816-118">Панель результатов, на которой просматриваются результаты запроса.</span><span class="sxs-lookup"><span data-stu-id="a0816-118">Results pane in which you view the query results.</span></span>  
  
 <span data-ttu-id="a0816-119">На следующем рисунке показан графический конструктор запросов при использовании списков SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a0816-119">The following figure shows the graphical query designer when it is used with SharePoint lists.</span></span>  
  
 <span data-ttu-id="a0816-120">![rsQD_Relational_Graphical_SharePoint](../media/rsqd-relational-graphical-sharepoint.gif "rsQD_Relational_Graphical_SharePoint")</span><span class="sxs-lookup"><span data-stu-id="a0816-120">![rsQD_Relational_Graphical_SharePoint](../media/rsqd-relational-graphical-sharepoint.gif "rsQD_Relational_Graphical_SharePoint")</span></span>  
  
 <span data-ttu-id="a0816-121">В следующей таблице описываются функции каждой панели.</span><span class="sxs-lookup"><span data-stu-id="a0816-121">The following table describes the function of each pane.</span></span>  
  
 [<span data-ttu-id="a0816-122">Списки SharePoint</span><span class="sxs-lookup"><span data-stu-id="a0816-122">SharePoint Lists</span></span>](#DatabaseView)  
 <span data-ttu-id="a0816-123">Отображает списки SharePoint и поля внутри каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="a0816-123">Displays SharePoint lists and the fields within each item in the list.</span></span>  
  
 [<span data-ttu-id="a0816-124">Выбранные поля</span><span class="sxs-lookup"><span data-stu-id="a0816-124">Selected fields</span></span>](#SelectedFields)  
 <span data-ttu-id="a0816-125">Отображается список имен полей списка SharePoint из выбранных элементов на панели «Списки SharePoint».</span><span class="sxs-lookup"><span data-stu-id="a0816-125">Displays the list of SharePoint list field names from the selected items in the SharePoint Lists pane.</span></span> <span data-ttu-id="a0816-126">Эти поля становятся коллекцией полей для набора данных отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-126">These fields become the field collection for the report dataset.</span></span>  
  
 [<span data-ttu-id="a0816-127">Примененные фильтры</span><span class="sxs-lookup"><span data-stu-id="a0816-127">Applied filters</span></span>](#AppliedFilters)  
 <span data-ttu-id="a0816-128">Отображается список полей и условия фильтра для таблиц или представлений в области представления базы данных.</span><span class="sxs-lookup"><span data-stu-id="a0816-128">Displays a list of fields and filter criteria for tables or views in the Database view.</span></span>  
  
 [<span data-ttu-id="a0816-129">Результаты запроса</span><span class="sxs-lookup"><span data-stu-id="a0816-129">Query results</span></span>](#QueryResults)  
 <span data-ttu-id="a0816-130">Отображает образец данных для результирующего набора автоматически созданного запроса.</span><span class="sxs-lookup"><span data-stu-id="a0816-130">Displays sample data for the result set for the automatically generated query.</span></span>  
  
###  <a name="sharepoint-lists-pane"></a><a name="DatabaseView"></a> <span data-ttu-id="a0816-131">Панель «Списки SharePoint»</span><span class="sxs-lookup"><span data-stu-id="a0816-131">SharePoint Lists Pane</span></span>  
 <span data-ttu-id="a0816-132">На панели «Списки SharePoint» отображаются метаданные объектов базы данных, для просмотра которых у пользователя есть разрешения, определяемые соединением с источником данных и учетными данными.</span><span class="sxs-lookup"><span data-stu-id="a0816-132">The SharePoint Lists pane displays the metadata for database objects that you have the permissions to view, which is determined by the data source connection and credentials.</span></span> <span data-ttu-id="a0816-133">В иерархическом представлении отображаются объекты базы данных, организованные схемой базы данных.</span><span class="sxs-lookup"><span data-stu-id="a0816-133">The hierarchical view displays database objects organized by database schema.</span></span> <span data-ttu-id="a0816-134">Можно развернуть узлы для каждой схемы, чтобы просмотреть таблицы, представления, хранимые процедуры и возвращающие табличное значение функции.</span><span class="sxs-lookup"><span data-stu-id="a0816-134">Expand the node for each schema to view tables, views, stored procedures, and table-valued functions.</span></span> <span data-ttu-id="a0816-135">Разверните таблицу или представление, чтобы отобразить столбцы.</span><span class="sxs-lookup"><span data-stu-id="a0816-135">Expand a table or view to display the columns.</span></span>  
  
###  <a name="selected-fields-pane"></a><a name="SelectedFields"></a> <span data-ttu-id="a0816-136">Панель «Выбранные поля»</span><span class="sxs-lookup"><span data-stu-id="a0816-136">Selected Fields Pane</span></span>  
 <span data-ttu-id="a0816-137">На панели «Выбранные поля» отображаются поля элементов списка, выбранных в качестве элементов списка SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a0816-137">The Selected Fields pane displays the list item fields that you select for SharePoint list items.</span></span> <span data-ttu-id="a0816-138">Поля, отображаемые в этой панели, становятся коллекцией полей для набора данных отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-138">The fields that are displayed in this pane become the field collection for the report dataset.</span></span> <span data-ttu-id="a0816-139">После создания набора данных и запроса область данных отчета можно использовать для просмотра коллекции полей для набора данных отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-139">After you create a dataset and a query, use the Report Data pane to view the field collection for a report dataset.</span></span> <span data-ttu-id="a0816-140">Эти поля представляют данные, которые могут быть отображены в таблицах, представлениях, диаграммах и других элементах отчета при его просмотре.</span><span class="sxs-lookup"><span data-stu-id="a0816-140">These fields represent the data you can display in tables, charts, and other report items when you view a report.</span></span>  
  
 <span data-ttu-id="a0816-141">Чтобы добавить или удалить поля с этой панели, следует установить или снять флажки на панели «Списки SharePoint», соответствующие полям таблицы или представления.</span><span class="sxs-lookup"><span data-stu-id="a0816-141">To add or remove fields to this pane, select or clear check boxes for the table or view fields in the SharePoint Lists pane.</span></span>  
  
###  <a name="applied-filters-pane"></a><a name="AppliedFilters"></a> <span data-ttu-id="a0816-142">Панель «Примененные фильтры»</span><span class="sxs-lookup"><span data-stu-id="a0816-142">Applied Filters Pane</span></span>  
 <span data-ttu-id="a0816-143">На панели «Примененные фильтры» отображаются условия, используемые для ограничения числа строк данных, возвращаемых во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="a0816-143">The Applied Filters pane displays the criteria that are used to limit the number of rows of data that are retrieved at run-time.</span></span> <span data-ttu-id="a0816-144">Условия, указанные в этой панели, используются для создания предложения [!INCLUDE[tsql](../../includes/tsql-md.md)] WHERE.</span><span class="sxs-lookup"><span data-stu-id="a0816-144">Criteria specified in this pane are used to generate a [!INCLUDE[tsql](../../includes/tsql-md.md)] WHERE clause.</span></span> <span data-ttu-id="a0816-145">При выборе режима параметров происходит автоматическое создание параметра отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-145">When you select the parameter option, a report parameter is automatically created.</span></span> <span data-ttu-id="a0816-146">Параметры отчета, основанные на параметрах запроса, позволяют пользователю указывать для запроса значения, управляющие данными в отчете.</span><span class="sxs-lookup"><span data-stu-id="a0816-146">Report parameters that are based on query parameters enable a user to specify values for the query to control the data in the report.</span></span>  
  
 <span data-ttu-id="a0816-147">Отображаются следующие столбцы.</span><span class="sxs-lookup"><span data-stu-id="a0816-147">The following columns are displayed:</span></span>  
  
-   <span data-ttu-id="a0816-148">**Имя поля.** Отображается имя поля, к которому будет применено условие.</span><span class="sxs-lookup"><span data-stu-id="a0816-148">**Field Name** Displays the name of the field to apply the criteria to.</span></span>  
  
-   <span data-ttu-id="a0816-149">**Оператор.** Отображается операция, которая будет использована в критерии фильтра.</span><span class="sxs-lookup"><span data-stu-id="a0816-149">**Operator** Displays the operation to use in the filter expression.</span></span>  
  
-   <span data-ttu-id="a0816-150">**Значение.** Отображается значение, которое будет использовано в критерии фильтра.</span><span class="sxs-lookup"><span data-stu-id="a0816-150">**Value** Displays the value to use in the filter expression.</span></span>  
  
-   <span data-ttu-id="a0816-151">**Параметр** Отображается параметр для добавления параметра к запросу.</span><span class="sxs-lookup"><span data-stu-id="a0816-151">**Parameter** Displays the option to add a query parameter to the query.</span></span> <span data-ttu-id="a0816-152">С помощью диалогового окна «Свойства набора данных» можно просмотреть связи между параметрами запроса и параметрами отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-152">Use the Dataset properties to view the relationship between query parameter and report parameter.</span></span>  
  
###  <a name="query-results-pane"></a><a name="QueryResults"></a> <span data-ttu-id="a0816-153">Область результатов запроса</span><span class="sxs-lookup"><span data-stu-id="a0816-153">Query Results Pane</span></span>  
 <span data-ttu-id="a0816-154">На панели результатов запроса отображаются результаты автоматически созданного запроса, заданного выбором в других областях.</span><span class="sxs-lookup"><span data-stu-id="a0816-154">The Query results pane displays the results for the automatically generated query that is specified by selections in the other panes.</span></span> <span data-ttu-id="a0816-155">Столбцы результирующего набора — это поля, указанные на панели «Выбранные поля». Данные строк ограничиваются фильтрами, указанными на панели «Примененные фильтры».</span><span class="sxs-lookup"><span data-stu-id="a0816-155">The columns in the result set are the fields that you specify in the Selected Fields pane and the row data is limited by the filters that you specify in the Applied Filters pane.</span></span>  
  
 <span data-ttu-id="a0816-156">Эти данные представляют значения из источника данных на время выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="a0816-156">This data represents values from the data source at the time that you run the query.</span></span> <span data-ttu-id="a0816-157">Данные не сохраняются в определении отчета. При обработке в отчет возвращаются реальные данные.</span><span class="sxs-lookup"><span data-stu-id="a0816-157">The data is not saved in the report definition .The actual data in the report is retrieved when the report is processed.</span></span>  
  
 <span data-ttu-id="a0816-158">Порядок сортировки в результирующем наборе определяется порядком получения данных из источника данных.</span><span class="sxs-lookup"><span data-stu-id="a0816-158">Sort order in the result set is determined by the order the data is retrieved from the data source.</span></span> <span data-ttu-id="a0816-159">Порядок сортировки может быть изменен путем изменения запроса или после получения данных для отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-159">Sort order can be changed by modifying the query or after the data is retrieved for the report.</span></span>  
  
### <a name="graphical-query-designer-toolbar"></a><span data-ttu-id="a0816-160">Панель инструментов графического конструктора запросов</span><span class="sxs-lookup"><span data-stu-id="a0816-160">Graphical Query Designer Toolbar</span></span>  
 <span data-ttu-id="a0816-161">На панели инструментов конструктора реляционных запросов расположены следующие кнопки, помогающие указать или просмотреть результаты запроса.</span><span class="sxs-lookup"><span data-stu-id="a0816-161">The relational query designer toolbar provides the following buttons to help you specify or view the results of a query.</span></span>  
  
|<span data-ttu-id="a0816-162">Кнопка</span><span class="sxs-lookup"><span data-stu-id="a0816-162">Button</span></span>|<span data-ttu-id="a0816-163">Description</span><span class="sxs-lookup"><span data-stu-id="a0816-163">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="a0816-164">**Редактировать как текст**</span><span class="sxs-lookup"><span data-stu-id="a0816-164">**Edit As Text**</span></span>|<span data-ttu-id="a0816-165">Переключение в режим текстового конструктора запросов, чтобы просмотреть или изменить автоматически созданный запрос.</span><span class="sxs-lookup"><span data-stu-id="a0816-165">Toggle to the text-based query designer to view the automatically generated query or to modify the query.</span></span>|  
|<span data-ttu-id="a0816-166">**Импорт**</span><span class="sxs-lookup"><span data-stu-id="a0816-166">**Import**</span></span>|<span data-ttu-id="a0816-167">Импорт существующего запроса из файла или отчета.</span><span class="sxs-lookup"><span data-stu-id="a0816-167">Import an existing query from a file or report.</span></span> <span data-ttu-id="a0816-168">Поддерживаются SQL и RDL-файлы.</span><span class="sxs-lookup"><span data-stu-id="a0816-168">File types .sql and .rdl are supported.</span></span>|  
|<span data-ttu-id="a0816-169">**Выполнить запрос**</span><span class="sxs-lookup"><span data-stu-id="a0816-169">**Run Query**</span></span>|<span data-ttu-id="a0816-170">Выполните запрос.</span><span class="sxs-lookup"><span data-stu-id="a0816-170">Run the query.</span></span> <span data-ttu-id="a0816-171">Результирующий набор отображается на панели результатов запроса.</span><span class="sxs-lookup"><span data-stu-id="a0816-171">The Query results pane displays the result set.</span></span>|  
|<span data-ttu-id="a0816-172">**Показать скрытые поля**</span><span class="sxs-lookup"><span data-stu-id="a0816-172">**Show Hidden Fields**</span></span>|<span data-ttu-id="a0816-173">Переключите, чтобы показать или скрыть поля, которые создаются SharePoint автоматически (например, ProgId и Level для элементов ссылок SharePoint), но, как правило, не используются в отчетах.</span><span class="sxs-lookup"><span data-stu-id="a0816-173">Toggle to show or hide the fields that were automatically generated by SharePoint such as the ProgId and Level for SharePoint link items, but are typically not used in reports..</span></span> <span data-ttu-id="a0816-174">Скрытие этих полей позволяет сделать список полей короче и удобнее в использовании.</span><span class="sxs-lookup"><span data-stu-id="a0816-174">Hiding these fields makes the field list shorter and easier to use.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="a0816-175">См. также:</span><span class="sxs-lookup"><span data-stu-id="a0816-175">See Also</span></span>  
 [<span data-ttu-id="a0816-176">Конструкторы запросов (построитель отчетов)</span><span class="sxs-lookup"><span data-stu-id="a0816-176">Query Designers &#40;Report Builder&#41;</span></span>](../query-designers-report-builder.md)  
  
  
