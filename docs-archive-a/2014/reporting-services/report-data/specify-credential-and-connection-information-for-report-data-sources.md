---
title: Задание учетных данных и сведений о соединении для источников данных отчета | Документы Майкрософт
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- no credentials option [Reporting Services]
- impersonation [Reporting Services]
- user impersonation [Reporting Services]
- Windows authentication [Reporting Services]
- data sources [Reporting Services], security
- connection strings [Reporting Services]
- unattended report processing [Reporting Services]
- reports [Reporting Services], security
- remote data sources [Reporting Services]
- credentials [Reporting Services]
- authentication [Reporting Services]
- external data sources [Reporting Services]
- prompted credentials [Reporting Services]
- multiple connections
- stored credentials [Reporting Services]
- security [Reporting Services], data sources
- Windows integrated security [Reporting Services]
ms.assetid: fee1a663-a313-424a-aed2-5082bfd114b3
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 2d1e804282459972b21303cf795a9c3a88ea93d5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666452"
---
# <a name="specify-credential-and-connection-information-for-report-data-sources"></a>Задание учетных данных и сведениях о соединении для источников данных отчета
  Сервер отчетов использует учетные данные для подключения к внешним источникам данных, предоставляющих содержимое для отчетов или сведения о получателе для подписок, управляемых данными. Можно задать учетные данные, использующие проверку подлинности Windows, проверку подлинности базы данных, нестандартную проверку подлинности, или учетные данные, не использующие проверку подлинности. При отправке по сети запроса на соединение сервер отчетов олицетворяет или учетную запись пользователя, или учетную запись автоматического выполнения. Дополнительные сведения о контексте безопасности, в котором выполняется запрос соединения, см. в подразделе [Настройка источника данных и сетевые подключения](#DataSourceConfigurationConnections) далее в этом разделе.  
  
> [!NOTE]  
>  Учетные данные также используются для авторизации пользователей, имеющих доступ к серверу отчетов. Сведения об авторизации пользователей на сервере отчетов содержатся в другом разделе.  
  
 Соединение с внешним источником данных определяется при создании отчета. Им можно управлять отдельно после публикации отчета. Можно указать статическую строку соединения или выражение, которые позволяют пользователям выбрать источник данных из динамического списка. Дополнительные сведения о том, как указать тип источника данных и строку подключения, см. [в разделе подключения к данным, источники данных и строки подключения в Reporting Services](../data-connections-data-sources-and-connection-strings-in-reporting-services.md).  
  
## <a name="using-remote-data-sources"></a>Использование удаленных источников данных  
 Если отчет получает данные с удаленного сервера базы данных, проверьте следующее.  
  
-   Допустимость учетных данных, предоставленных серверу базы данных. Если используются учетные данные пользователя Windows, проверьте, что у этого пользователя есть разрешение на доступ к серверу и базе данных.  
  
-   Порты, используемые сервером базы данных, открыты. При обращении к реляционным базам данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на внешних компьютерах или в случае, если база данных сервера отчетов находится на внешнем экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , необходимо открыть порт 1433 и 1434 на внешнем компьютере. Не забудьте перезапустить сервер после того, как будут открыты порты. Дополнительные сведения о брандмауэре Windows см. в статье [Настройка брандмауэра Windows для доступа к компоненту Database Engine](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md).  
  
-   Удаленные соединения должны быть разрешены. При доступе к реляционным базам данных SQL Server на внешних компьютерах можно использовать средство «Диспетчер конфигурации SQL Server», чтобы проверить, что удаленные соединения по протоколу TCP включены.  
  
## <a name="ways-to-specify-credentials-for-connecting-to-remote-data-sources"></a>Способы указания учетных данных для соединения с удаленными источниками данных  
 Источники данных, предоставляющие содержимое для отчетов, обычно размещаются на удаленных серверах. Чтобы получить данные для отчета, сервер отчетов должен соединиться с этим сервером, используя набор учетных данных, предоставляемых заранее или получаемых во время выполнения. При настройке источника данных учетные данные можно задать следующими способами.  
  
-   Выдавать приглашение пользователю на ввод учетных данных.  
  
-   Хранить учетные данные.  
  
-   Использовать встроенную безопасность Windows.  
  
-   Не использовать учетные данные.  
  
 Сетевая среда определяет поддерживаемые типы подключения. Например, если включен протокол Kerberos версии 5, можно использовать возможности делегирования и олицетворения, доступные при проверке подлинности Windows, для поддержки соединений через несколько серверов. Если сеть не поддерживает эти средства безопасности, понадобится доработать ограничения подключения. Если делегирование и олицетворение не включены, учетные данные Windows могут передаваться на другой компьютер до истечения срока их действия. Соединение пользователя с клиентского компьютера с компьютером сервера отчетов считается первым подключением. Если пользователь открывает отчет, получающий данные с удаленного сервера, соответствующее имя входа считается именем второго соединения, и соединение не будет успешным, если используется встроенная безопасность Windows при отключенном делегировании.  
  
 Если для завершения полного обхода от клиентского компьютера к внешнему источнику данных отчета требуется несколько подключений, выберите одну из следующих стратегий для успешного подключения.  
  
-   Включите функции делегирования и олицетворения в домене, чтобы передавать учетные данные на другой компьютер без ограничения.  
  
-   Использовать сохраненные или запрошенные учетные данные для запроса данных отчета у внешних источников данных. Учетные данные могут представлять собой или учетную запись домена Windows, или имя входа базы данных.  
  
### <a name="prompted-credentials"></a>Запрошенные учетные данные  
 Если соединение с источником данных для отчета настроено на запрос учетных данных, то каждый пользователь, который обращается к отчету, должен ввести имя пользователя и пароль для получения данных. Этот подход рекомендуется для отчетов, содержащих конфиденциальные данные. Запрошенные учетные данные могут использоваться только в отчетах, запускаемых по запросу. Учетные данные, для которых выдается приглашение, могут быть или учетной записью Windows, или именем входа базы данных. Для использования проверки подлинности Windows выберите **Использовать учетные данные Windows при подключении к источнику данных**. В противном случае сервер отчетов передает учетные данные серверу базы данных для проверки подлинности пользователя. Если сервер базы данных не сможет проверить предоставленные учетные данные, соединение не установится.  
  
### <a name="windows-integrated-security"></a>Встроенная безопасность Windows  
 При использовании параметра **Встроенная безопасность Windows** сервер отчетов передает токен безопасности пользователя, получающего доступ к отчету, на сервер, размещающий внешний источник данных. В этом случае у пользователя не будут запрашиваться имя и пароль. Этот подход рекомендуется в том случае, если включены функции делегирования и олицетворения. Если эти функции не включены, этот подход нужно использовать только в том случае, если все серверы, к которым нужно получить доступ, размещены на одном компьютере.  
  
### <a name="stored-credentials"></a>Сохраненные учетные данные  
 Можно сохранить учетные данные, используемые для доступа к внешнему источнику данных. Учетные данные хранятся в виде обратимого шифрования в базе данных сервера отчетов. Может быть указан единый набор сохраненных учетных данных для каждого источника данных, используемого в отчете. Предоставленные учетные данные извлекают одни и те же данные для всех пользователей, запустивших отчет.  
  
 Сохраненные учетные данные рекомендованы как часть стратегии для доступа к удаленным серверам баз данных. Сохраненные учетные данные запрашиваются, если нужно поддержать подписки, формирование журнала отчетов или обновление моментального снимка отчета. Если отчет запускается в виде фонового процесса, сервер отчетов является агентом, выполняющим отчет. Так как контекст пользователя отсутствует, для соединения с источником данных сервер отчетов должен получить сведения об учетных данных из базы данных сервера отчетов.  
  
 Указанные имя пользователя и пароль могут быть учетными данными Windows или именем входа базы данных. Если указаны учетные данные Windows, сервер отчетов передает учетные данные системе Windows для последующей проверки подлинности. В противном случае для проверки подлинности учетные данные передаются серверу базы данных.  
  
#### <a name="how-to-grant-allow-log-on-locally-permissions-to-domain-user-accounts"></a>Предоставление разрешений «Локальный вход в систему» учетным записям пользователей домена  
 Если для подключения к внешнему источнику данных используются сохраненные учетные данные, учетная запись пользователя домена Windows должна иметь разрешение на локальный вход. Это разрешение позволяет серверу отчетов олицетворять пользователя на сервере отчетов и отправлять запросы во внешний источник данных от имени олицетворенного пользователя.  
  
 Чтобы предоставить это разрешение, выполните следующие действия.  
  
1.  На компьютере сервера отчетов в окне **Администрирование**откройте **Локальную политику безопасности**.  
  
2.  В разделе **Настройки безопасности**разверните узел **Локальные политики**и щелкните **Назначение прав пользователя**.  
  
3.  На панели подробностей щелкните правой кнопкой мыши пункт **Локальный вход в систему** , а затем выберите пункт **Свойства**.  
  
4.  Щелкните **Добавить пользователя или группу**.  
  
5.  Нажмите кнопку **Размещение**, укажите домен или другое местоположение, в котором должен осуществляться поиск, и нажмите кнопку **ОК**.  
  
6.  Введите имя учетной записи Windows, которой необходимо разрешить интерактивный вход в систему, и нажмите кнопку **ОК**.  
  
7.  В диалоговом окне **Свойства: Локальный вход в систему** нажмите кнопку **ОК**.  
  
8.  Проверьте, что у выбранной учетной записи нет запретов разрешений.  
  
    1.  Правой кнопкой мыши щелкните элемент **Отклонить локальный вход в систему** , а затем выберите пункт **Свойства**.  
  
    2.  Если учетная запись присутствует в списке, выделите ее и нажмите кнопку **Удалить**.  
  
#### <a name="using-impersonation-with-stored-credentials"></a>Использование олицетворения с сохраненными учетными данными  
 Учетные данные можно использовать также для олицетворения идентификации другого пользователя. Для баз данных SQL Server при олицетворении устанавливается функция [SETUSER](/sql/t-sql/statements/setuser-transact-sql) .  
  
> [!IMPORTANT]  
>  Не используйте олицетворение для отчетов, поддерживающих подписки или использующих расписания для создания журнала отчета или обновления снимка состояния выполнения отчета.  
  
### <a name="no-credentials"></a>Без учетных данных  
 Можно настроить подключение к источнику данных без запроса учетных данных. Поскольку корпорация Майкрософт рекомендует всегда запрашивать учетные данные для доступа к источнику данных, отказ от использования учетных данных нежелателен. Запуск отчета без запроса учетных данных можно выбрать в следующих случаях.  
  
-   Удаленный источник данных не запрашивает учетные данные.  
  
-   Учетные данные передаются в строке соединений (рекомендовано только для безопасных соединений).  
  
-   Отчет является вложенным отчетом, использующим учетные данные родительского отчета.  
  
 В этом случае сервер отчетов подключается к удаленному источнику данных, используя учетную запись автоматического выполнения, которую необходимо указать заранее. Поскольку сервер отчетов не подключается к удаленному серверу, используя учетные данные служб, нужно задать учетную запись, которую сервер отчетов может использовать для соединения. Дополнительные сведения о создании такой учетной записи см. в разделе [Настройка учетной записи автоматического выполнения (диспетчер конфигурации служб SSRS)](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).  
  
##  <a name="data-source-configuration-and-network-connections"></a><a name="DataSourceConfigurationConnections"></a> Настройка источника данных и сетевые подключения  
 В следующей таблице приводятся способы соединения для конкретных комбинаций типов учетных данных и модулей обработки данных. Если используется пользовательский модуль обработки данных, см. раздел [Указание соединений для пользовательских модулей обработки данных](specify-connections-for-custom-data-processing-extensions.md).  
  
|**Тип**|**Контекст сетевого подключения**|**Типы источников данных**<br /><br /> **(SQL Server, Oracle, ODBC, OLE DB, службы Analysis Services, XML, SAP NetWeaver BI, Hyperion Essbase)**|  
|--------------|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|  
|Встроенные функции безопасности|Олицетворение текущего пользователя|Для всех типов источников данных при соединении используется учетная запись текущего пользователя.|  
|Учетные данные Windows|Олицетворение заданного пользователя|Для источников [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], Oracle, ODBC и OLE DB установите соединение с помощью олицетворенной учетной записи.|  
|Учетные данные базы данных|Олицетворение учетной записи автоматического выполнения или учетной записи службы<br /><br /> (Службы Reporting Services удаляют разрешения администратора при отправке запроса на соединение при помощи идентификатора служб.)|Для [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], Oracle, ODBC и OLE DB:<br /><br /> добавление имени пользователя и пароля к строке соединения.<br /><br /> Для [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]:<br /><br /> соединение выполняется успешно при использовании протокола TCP/IP, в противном случае происходит сбой соединения.<br /><br /> Для XML:<br /><br /> сбой соединения на сервере отчетов при использовании учетных данных базы данных.|  
|Нет|Олицетворение учетной записи автоматического выполнения|Для [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], Oracle, ODBC и OLE DB:<br /><br /> используются учетные данные, определенные в строке соединения. Сбой соединения на сервере отчетов, если не задана учетная запись автоматического выполнения.<br /><br /> Для [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]:<br /><br /> всегда сбой соединения, если не заданы учетные данные, даже если определена учетная запись автоматического выполнения.<br /><br /> Для XML:<br /><br /> соединение в качестве анонимного пользователя, если определена учетная запись автоматического выполнения, в противном случае сбой соединения.|  
  
## <a name="setting-credentials-programmatically"></a>Программная установка учетных данных  
 Чтобы контролировать доступ к отчету и серверу отчетов, можно задать учетные данные в своем коде. Дополнительные сведения см. в статье [Data Sources and Connection Methods](../report-server-web-service/methods/data-sources-and-connection-methods.md).  
  
## <a name="see-also"></a>См. также:  
 [Источники данных, поддерживаемые службами Reporting Services &#40;SSRS&#41;](../create-deploy-and-manage-mobile-and-paginated-reports.md)   
 [Подключения к данным, источники данных и строки подключения в Reporting Services](../data-connections-data-sources-and-connection-strings-in-reporting-services.md)   
 [Управление источниками данных отчета](../../integration-services/connection-manager/data-sources.md)   
 [Диспетчер отчетов (службы Reporting Services в основном режиме)](../report-manager-ssrs-native-mode.md)   
 [Создание, удаление или изменение общего источника данных &#40;диспетчер отчетов&#41;](../create-delete-or-modify-a-shared-data-source-report-manager.md)   
 [Настройка свойств источника данных для отчета (диспетчер отчетов)](configure-data-source-properties-for-a-report-report-manager.md)  
  
  
