---
title: Защищенные отчеты и ресурсы | Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- security [Reporting Services], reports
- security [Reporting Services], resources
- reports [Reporting Services], security
- confidential reports [Reporting Services]
- resources [Reporting Services], security
ms.assetid: 63cd55c7-fd2a-49e3-a3f8-59eb1a1c6e83
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 6c8eef86da2fe9c7dcc92488a08516a73aa37e92
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664692"
---
# <a name="secure-reports-and-resources"></a><span data-ttu-id="23cc5-102">Защищенные отчеты и ресурсы</span><span class="sxs-lookup"><span data-stu-id="23cc5-102">Secure Reports and Resources</span></span>
  <span data-ttu-id="23cc5-103">Можно управлять степенью предоставляемого пользователям доступа к отдельным отчетам и ресурсам.</span><span class="sxs-lookup"><span data-stu-id="23cc5-103">You can set security for individual reports and resources to control the degree of access that users have to these items.</span></span> <span data-ttu-id="23cc5-104">По умолчанию только пользователи, являющиеся членами встроенной группы **Администраторы** , могут выполнять отчеты, просматривать ресурсы, изменять свойства и удалять элементы.</span><span class="sxs-lookup"><span data-stu-id="23cc5-104">By default, only users who are members of the **Administrators** built-in group can run reports, view resources, modify properties, and delete the items.</span></span> <span data-ttu-id="23cc5-105">Остальные пользователи должны иметь созданные для них назначения ролей, предоставляющие доступ к отчету или ресурсу.</span><span class="sxs-lookup"><span data-stu-id="23cc5-105">All other users must have role assignments created for them that allow access to a report or resource.</span></span>  
  
## <a name="role-based-access-to-reports-and-resources"></a><span data-ttu-id="23cc5-106">Доступ к отчетам и ресурсам на основе ролей</span><span class="sxs-lookup"><span data-stu-id="23cc5-106">Role-based Access to Reports and Resources</span></span>  
 <span data-ttu-id="23cc5-107">Чтобы предоставить доступ к отчетам и ресурсам, можно разрешить пользователям наследовать существующие назначения ролей родительской папки или создать новые назначения ролей для нужного элемента.</span><span class="sxs-lookup"><span data-stu-id="23cc5-107">To grant access to reports and resources, you can allow users to inherit existing role assignments from a parent folder or create a new role assignment on the item itself.</span></span>  
  
 <span data-ttu-id="23cc5-108">В большинстве случаев используются разрешения, унаследованные от родительской папки.</span><span class="sxs-lookup"><span data-stu-id="23cc5-108">In most cases, you will probably want to use the permissions that are inherited from a parent folder.</span></span> <span data-ttu-id="23cc5-109">Установка параметров безопасности для конкретного отчета или ресурса необходима только в том случае, если нужно скрыть отчет или ресурс от пользователей, которым не нужно знать о его существовании, или для расширения доступа к отчету или элементу.</span><span class="sxs-lookup"><span data-stu-id="23cc5-109">Setting security on individual reports and resources should only be necessary if you want to hide the report or resource from users who do not need to know that the report or resource exists, or to increase the level of access for a report or item.</span></span> <span data-ttu-id="23cc5-110">Эти цели не исключают друг друга.</span><span class="sxs-lookup"><span data-stu-id="23cc5-110">These objectives are not mutually exclusive.</span></span> <span data-ttu-id="23cc5-111">Можно сделать отчет доступным для меньшего количества пользователей и одновременно предоставить всем или некоторым из них дополнительные права доступа для управления отчетом.</span><span class="sxs-lookup"><span data-stu-id="23cc5-111">You can restrict access to a report to a smaller set of users, and provide all or some of them with additional privileges to manage the report.</span></span>  
  
 <span data-ttu-id="23cc5-112">Возможно, для решения поставленной задачи придется выполнить несколько назначений ролей.</span><span class="sxs-lookup"><span data-stu-id="23cc5-112">You may need to create multiple role assignments to achieve your objectives.</span></span> <span data-ttu-id="23cc5-113">Допустим, нужно предоставить доступ к отчету двум пользователям (Анне и Фернандо) и членам группы менеджеров по управлению персоналом.</span><span class="sxs-lookup"><span data-stu-id="23cc5-113">For example, suppose you have a report that you want to make accessible to two users, Ann and Fernando, and to the Human Resource Managers group.</span></span> <span data-ttu-id="23cc5-114">Анна и Фернандо должны иметь возможность управлять отчетом, а члены группы менеджеров по управлению персоналом — только выполнять его.</span><span class="sxs-lookup"><span data-stu-id="23cc5-114">Ann and Fernando must be able to manage the report, but the Human Resource Managers members need only to run it.</span></span> <span data-ttu-id="23cc5-115">Для согласования всех этих пользователей необходимо создать три отдельных назначения ролей: первое, чтобы сделать Анну диспетчером содержимого отчета; второе, чтобы сделать Фернандо диспетчером содержимого отчета; и третье, чтобы предоставить членам группы менеджеров по управлению персоналом право только на просмотр отчета.</span><span class="sxs-lookup"><span data-stu-id="23cc5-115">To accommodate all of these users, you would create three separate role assignments: one to make Ann a content manager of the report, one to make Fernando a content manager of the report, and one to support view-only tasks for the Human Resource Managers group.</span></span>  
  
 <span data-ttu-id="23cc5-116">Если заданы параметры безопасности для отчета или ресурса, эти параметры продолжают действовать даже после перемещения элемента в новое место.</span><span class="sxs-lookup"><span data-stu-id="23cc5-116">Once you set security on a report or resource, those settings stay with the item even if you move the item to a new location.</span></span> <span data-ttu-id="23cc5-117">Например, если отчет, обращаться к которому могут только несколько пользователей, будет перемещен в папку, на которую распространяется сравнительно свободная политика обеспечения безопасности, отчет по-прежнему будет доступен только этим пользователям.</span><span class="sxs-lookup"><span data-stu-id="23cc5-117">For example, if you move a report that only a few people are authorized to access, the report continues to be available to just those users even if you move it to a folder that has a relatively open security policy.</span></span>  
  
## <a name="mitigating-html-injection-attacks-in-a-published-report-or-document"></a><span data-ttu-id="23cc5-118">Сдерживание атак, осуществляемых путем инжекции HTML-кода, в опубликованном отчете или документе</span><span class="sxs-lookup"><span data-stu-id="23cc5-118">Mitigating HTML Injection Attacks in a Published Report or Document</span></span>  
 <span data-ttu-id="23cc5-119">В службах [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]отчеты и ресурсы обрабатываются с использованием идентификатора безопасности пользователя, который запустил отчет.</span><span class="sxs-lookup"><span data-stu-id="23cc5-119">In [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], reports and resources are processed under the security identity of the user who is running the report.</span></span> <span data-ttu-id="23cc5-120">Если отчет содержит выражения, скрипт, пользовательские элементы отчета или пользовательские сборки, код выполняется с использованием учетных данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="23cc5-120">If the report contains expressions, script, custom report items, or custom assemblies, the code runs under the user's credentials.</span></span> <span data-ttu-id="23cc5-121">Если ресурсом является HTML-документ, содержащий скрипт, скрипт начнет выполняться, когда пользователь откроет документ на сервере отчетов.</span><span class="sxs-lookup"><span data-stu-id="23cc5-121">If a resource is an HTML document that contains script, the script will run when the user opens the document on the report server.</span></span> <span data-ttu-id="23cc5-122">Возможность запустить код или скрипт без отчета — мощная функция, несущая в себе определенную долю риска.</span><span class="sxs-lookup"><span data-stu-id="23cc5-122">The ability to run script or code within a report is a powerful feature that comes with a certain level of risk.</span></span> <span data-ttu-id="23cc5-123">Если код вредоносен, сервер отчетов и пользователь, запустивший отчет, становятся уязвимыми для атаки.</span><span class="sxs-lookup"><span data-stu-id="23cc5-123">If the code is malicious, the report server and the user who is running the report are vulnerable to attack.</span></span>  
  
 <span data-ttu-id="23cc5-124">Предоставляя доступ к отчетам и ресурсам, обрабатываемым как HTML, важно помнить, что отчеты обрабатываются с полным уровнем доверия и что потенциально вредоносный скрипт может быть отослан клиенту.</span><span class="sxs-lookup"><span data-stu-id="23cc5-124">When granting access to reports and to resources that are processed as HTML, it is important to remember that reports are processed in full trust and that potentially malicious script might be sent to the client.</span></span> <span data-ttu-id="23cc5-125">В зависимости от настроек браузера клиент будет выполнять HTML-код с уровнем доверия, установленным в браузере.</span><span class="sxs-lookup"><span data-stu-id="23cc5-125">Depending on browser settings, the client will execute the HTML at the level of trust that is specified in the browser.</span></span>  
  
 <span data-ttu-id="23cc5-126">Можно снизить риск выполнения вредоносных скриптов, приняв следующие меры предосторожности.</span><span class="sxs-lookup"><span data-stu-id="23cc5-126">You can mitigate the risk of running malicious script by taking the following precautions:</span></span>  
  
-   <span data-ttu-id="23cc5-127">Избирательно решайте, кто может публиковать содержимое на сервере отчетов.</span><span class="sxs-lookup"><span data-stu-id="23cc5-127">Be selective when deciding who can publish content to a report server.</span></span> <span data-ttu-id="23cc5-128">Поскольку всегда существует возможность публикации вредоносного содержимого, лучше ограничить число пользователей, которые могут публиковать содержимое.</span><span class="sxs-lookup"><span data-stu-id="23cc5-128">Because the potential for publishing malicious content exists, you should limit users who can publish content to a small number of trusted users.</span></span>  
  
-   <span data-ttu-id="23cc5-129">Все издатели также должны избегать публикации отчетов и ресурсов, поступивших из неизвестных или не заслуживающих доверия источников.</span><span class="sxs-lookup"><span data-stu-id="23cc5-129">All publishers should avoid publishing reports and resources that come from unknown or untrusted sources.</span></span> <span data-ttu-id="23cc5-130">При необходимости откройте файл в текстовом редакторе и поищите подозрительный скрипт или URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="23cc5-130">If necessary, open the file in a text editor and look for suspicious script and URLs.</span></span>  
  
## <a name="report-parameters-and-script-injection"></a><span data-ttu-id="23cc5-131">Параметры отчета и внедрение скриптов</span><span class="sxs-lookup"><span data-stu-id="23cc5-131">Report Parameters and Script Injection</span></span>  
 <span data-ttu-id="23cc5-132">Параметры отчета обеспечивают гибкость общего проектирования и выполнения отчетов.</span><span class="sxs-lookup"><span data-stu-id="23cc5-132">Report Parameters provide flexibility for the overall report design and execution.</span></span> <span data-ttu-id="23cc5-133">Однако в некоторых случаях этой гибкостью может воспользоваться злоумышленник для организации атаки с заманиванием.</span><span class="sxs-lookup"><span data-stu-id="23cc5-133">However, this same flexibility can, in some cases be used by an attacker in luring attacks.</span></span> <span data-ttu-id="23cc5-134">Чтобы снизить риск неумышленного запуска вредоносных скриптов, открывайте только готовые для просмотра отчеты из надежных источников.</span><span class="sxs-lookup"><span data-stu-id="23cc5-134">To mitigate the risk of inadvertently running malicious scripts, only open rendered reports from trusted sources.</span></span> <span data-ttu-id="23cc5-135">Рекомендуется ознакомиться со следующим сценарием, представляющим потенциальную возможность атаки путем внедрения скрипта в модуль подготовки к просмотру в формате HTML:</span><span class="sxs-lookup"><span data-stu-id="23cc5-135">It is recommended you consider the following scenario that is a potential HTML Renderer script injection attack:</span></span>  
  
1.  <span data-ttu-id="23cc5-136">Отчет содержит текстовое поле с действием гиперссылки, равным значению параметра, который может содержать опасный текст.</span><span class="sxs-lookup"><span data-stu-id="23cc5-136">A report contains a text box with the hyperlink action set to the value of a parameter which could contain malicious text.</span></span>  
  
2.  <span data-ttu-id="23cc5-137">Отчет публикуется на сервере отчетов или делается доступным другим образом, при этом значением параметра отчета можно управлять через URL-адрес веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="23cc5-137">The report is published to a report server or otherwise made available in such a way that the report parameter value can be controlled from the URL of a web page.</span></span>  
  
3.  <span data-ttu-id="23cc5-138">Злоумышленник создает ссылку на веб-страницу или сервер отчетов, задавая значение параметра в виде «JavaScript: \<malicious script here> », и отправляет эту ссылку другому лицу при атаке «отвлекающих».</span><span class="sxs-lookup"><span data-stu-id="23cc5-138">An attacker creates a link to the web page or report server specifying the value of the parameter in the form "javascript:\<malicious script here>" and sends that link to someone else in a luring attack.</span></span>  
  
## <a name="mitigating-script-injection-attacks-in-a-hyperlink-in-a-published-report-or-document"></a><span data-ttu-id="23cc5-139">Противодействие атакам путем внедрения скриптов в гиперссылки в опубликованном отчете или документе</span><span class="sxs-lookup"><span data-stu-id="23cc5-139">Mitigating Script Injection Attacks in a Hyperlink in a Published Report or Document</span></span>  
 <span data-ttu-id="23cc5-140">Отчеты могут содержать внедренные гиперссылки в значении свойства Action элемента отчета или части элемента отчета.</span><span class="sxs-lookup"><span data-stu-id="23cc5-140">Reports can contain embedded hyperlinks in the value of the Action property on a report item or part of a report item.</span></span> <span data-ttu-id="23cc5-141">Гиперссылки могут быть привязаны к данным, извлекаемым из внешнего источника данных при обработке отчетов.</span><span class="sxs-lookup"><span data-stu-id="23cc5-141">Hyperlinks can be bound to data that is retrieved from an external data source when the report is processed.</span></span> <span data-ttu-id="23cc5-142">Если злоумышленник изменит базовые данные, возникает опасность использования гиперссылки для атаки с помощью уязвимости в реализации обработки сценариев.</span><span class="sxs-lookup"><span data-stu-id="23cc5-142">If a malicious user modifies the underlying data, the hyperlink might be at risk for scripting exploits.</span></span> <span data-ttu-id="23cc5-143">Когда пользователь щелкает ссылку в опубликованном или экспортированном отчете, может выполниться скрипт злоумышленника.</span><span class="sxs-lookup"><span data-stu-id="23cc5-143">If a user clicks the link in the published or exported report, malicious script could run.</span></span>  
  
 <span data-ttu-id="23cc5-144">Чтобы уменьшить риск включения в отчеты ссылок, через которые можно запускать вредоносные скрипты, привязывайте гиперссылки только к данным из надежных источников.</span><span class="sxs-lookup"><span data-stu-id="23cc5-144">To mitigate the risk of including links in a report that inadvertently run malicious scripts, only bind hyperlinks to data from trusted sources.</span></span> <span data-ttu-id="23cc5-145">Убедитесь, что данные результатов запросов и выражения, привязывающие данные к гиперссылкам, не создают ссылок, которыми может воспользоваться злоумышленник.</span><span class="sxs-lookup"><span data-stu-id="23cc5-145">Verify that data from the query results and the expressions that bind data to hyperlinks do not create links that can be exploited.</span></span> <span data-ttu-id="23cc5-146">Например, не основывайте гиперссылку на выражении, объединяющем данные из нескольких полей набора данных.</span><span class="sxs-lookup"><span data-stu-id="23cc5-146">For example, do not base a hyperlink on an expression that concatenates data from multiple dataset fields.</span></span> <span data-ttu-id="23cc5-147">При необходимости перейдите к отчету и воспользуйтесь функцией «Просмотр исходного кода», чтобы проверить код на наличие подозрительных скриптов и URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="23cc5-147">If necessary, browse to the report and use "View Source" to check for suspicious scripts and URLs.</span></span>  
  
## <a name="mitigating-sql-injection-attacks-in-a-parameterized-report"></a><span data-ttu-id="23cc5-148">Сдерживание атак, осуществляемых путем инжекции кода SQL, в параметризованном отчете</span><span class="sxs-lookup"><span data-stu-id="23cc5-148">Mitigating SQL Injection Attacks in a Parameterized Report</span></span>  
 <span data-ttu-id="23cc5-149">В любом отчете, содержащем параметры типа `String`, используйте список доступных значений (иначе называемый списком допустимых значений) и убедитесь, что у любого пользователя, запускающего отчеты, есть разрешение только на просмотр данных в отчете.</span><span class="sxs-lookup"><span data-stu-id="23cc5-149">In any report that includes a parameter of type `String`, be sure to use an available values list (also known as a valid values list) and ensure that any user running the report has only the permissions required to view the data in the report.</span></span> <span data-ttu-id="23cc5-150">При определении параметра типа `String` пользователю предоставляется текстовое поле, в которое можно ввести любое значение.</span><span class="sxs-lookup"><span data-stu-id="23cc5-150">When you define a parameter of type `String`, the user is presented with a text box that can take any value.</span></span> <span data-ttu-id="23cc5-151">Список допустимых значений ограничивает значения, которые могут быть введены.</span><span class="sxs-lookup"><span data-stu-id="23cc5-151">An available values list limits the values that can be entered.</span></span> <span data-ttu-id="23cc5-152">Если параметр отчета привязан к параметру запроса и не использует список допустимых значений, пользователь отчета может ввести в это текстовое поле команду на языке SQL и выполнить атаку встроенными командами SQL в отношении этого отчета и всего сервера.</span><span class="sxs-lookup"><span data-stu-id="23cc5-152">If the report parameter is tied to a query parameter and you do not use an available values list, it is possible for a report user to type SQL syntax into the text box, potentially opening the report and your server to a SQL injection attack.</span></span> <span data-ttu-id="23cc5-153">Наличие у этого пользователя достаточных разрешений для выполнения новой инструкции SQL может привести к нежелательным последствиям на сервере.</span><span class="sxs-lookup"><span data-stu-id="23cc5-153">If the user has sufficient permissions to execute the new SQL statement, it may produce unwanted results on the server.</span></span>  
  
 <span data-ttu-id="23cc5-154">Если параметр отчета не привязан к параметру запроса и значения параметра включены в отчет, пользователь отчета может ввести синтаксис выражения или URL-адрес в значение параметра и подготовить отчет для просмотра через Excel или HTML.</span><span class="sxs-lookup"><span data-stu-id="23cc5-154">If a report parameter is not tied to a query parameter and the parameter values are included in the report, it is possible for a report user to type expression syntax or a URL into the parameter value and render the report to Excel or HTML.</span></span> <span data-ttu-id="23cc5-155">Если затем другой пользователь при просмотре отчета щелкнет содержимое параметра, он может неумышленно выполнить вредоносный скрипт или перейти по ссылке.</span><span class="sxs-lookup"><span data-stu-id="23cc5-155">If another user then views the report and clicks the rendered parameter contents, the user may inadvertently execute the malicious script or link.</span></span>  
  
 <span data-ttu-id="23cc5-156">Чтобы снизить риск неумышленного запуска вредоносных скриптов, открывайте отчеты, готовые для просмотра, только из проверенных источников.</span><span class="sxs-lookup"><span data-stu-id="23cc5-156">To mitigate the risk of inadvertently running malicious scripts, open rendered reports only from trusted sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="23cc5-157">В предыдущих версиях документации был включен пример создания динамического запроса в виде выражения.</span><span class="sxs-lookup"><span data-stu-id="23cc5-157">In previous releases of the documentation, an example of creating a dynamic query as an expression was included.</span></span> <span data-ttu-id="23cc5-158">Этот тип запроса не рекомендуется использовать, так как он создает уязвимость для атак, осуществляемых путем инжекции SQL-кода.</span><span class="sxs-lookup"><span data-stu-id="23cc5-158">This type of query creates a vulnerability to SQL injection attacks and therefore is not recommended.</span></span>  
  
## <a name="securing-confidential-reports"></a><span data-ttu-id="23cc5-159">Защита конфиденциальных отчетов</span><span class="sxs-lookup"><span data-stu-id="23cc5-159">Securing Confidential Reports</span></span>  
 <span data-ttu-id="23cc5-160">Отчеты, содержащие конфиденциальные данные, следует защищать на уровне доступа к данным, требуя от пользователей, чтобы они предоставили учетные данные, дающие право на доступ к этим данным.</span><span class="sxs-lookup"><span data-stu-id="23cc5-160">Reports that contain confidential information should be secured at the data-access level, by requiring users to provide credentials to access sensitive data.</span></span> <span data-ttu-id="23cc5-161">Дополнительные сведения см. в статье [Задание учетных данных и сведениях о соединении для источников данных отчета](../report-data/specify-credential-and-connection-information-for-report-data-sources.md).</span><span class="sxs-lookup"><span data-stu-id="23cc5-161">For more information, see [Specify Credential and Connection Information for Report Data Sources](../report-data/specify-credential-and-connection-information-for-report-data-sources.md).</span></span> <span data-ttu-id="23cc5-162">Кроме того, можно защитить папку, сделав ее недоступной для неавторизованных пользователей.</span><span class="sxs-lookup"><span data-stu-id="23cc5-162">You can also secure a folder to make it inaccessible to unauthorized users.</span></span> <span data-ttu-id="23cc5-163">Дополнительные сведения см. в подразделе [Обеспечение защиты папок](secure-folders.md).</span><span class="sxs-lookup"><span data-stu-id="23cc5-163">For more information, see [Secure Folders](secure-folders.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="23cc5-164">См. также:</span><span class="sxs-lookup"><span data-stu-id="23cc5-164">See Also</span></span>  
 <span data-ttu-id="23cc5-165">(create-and-manage-role-assignments.md)</span><span class="sxs-lookup"><span data-stu-id="23cc5-165">(create-and-manage-role-assignments.md)</span></span>   
 <span data-ttu-id="23cc5-166">[Настройка доступа к построитель отчетов](../report-server/configure-report-builder-access.md) </span><span class="sxs-lookup"><span data-stu-id="23cc5-166">[Configure Report Builder Access](../report-server/configure-report-builder-access.md) </span></span>  
 <span data-ttu-id="23cc5-167">[Предоставление разрешений на сервер отчетов в собственном режиме](granting-permissions-on-a-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="23cc5-167">[Granting Permissions on a Native Mode Report Server](granting-permissions-on-a-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="23cc5-168">[Защита общих элементов источника данных](secure-shared-data-source-items.md) </span><span class="sxs-lookup"><span data-stu-id="23cc5-168">[Secure Shared Data Source Items](secure-shared-data-source-items.md) </span></span>  
 [<span data-ttu-id="23cc5-169">Сохраненные учетные данные в источнике данных Reporting Services</span><span class="sxs-lookup"><span data-stu-id="23cc5-169">Store Credentials in a Reporting Services Data Source</span></span>](../report-data/store-credentials-in-a-reporting-services-data-source.md)  
  
  
