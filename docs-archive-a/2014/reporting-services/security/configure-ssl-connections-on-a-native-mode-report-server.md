---
title: Настройка SSL-подключений для сервера отчетов в собственном режиме | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- Secure Sockets Layer (SSL)
ms.assetid: 212f2042-456a-4c0a-8d76-480b18f02431
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 5fde13ea7637a04b80224dd40a496491ea25d2b7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668088"
---
# <a name="configure-ssl-connections-on-a-native-mode-report-server"></a>Настройка соединений SSL для сервера отчетов, работающего в собственном режиме
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] В собственном режиме используется HTTP-служба протокола SSL для установления зашифрованного соединения с сервером отчетов. Если в локальном хранилище сертификатов на компьютере сервера отчетов установлен CER-файл сертификата, можно связать его с резервированием URL-адресов служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] для поддержки соединений сервера отчетов через зашифрованный канал.  
  
> [!TIP]  
>  Если используется режим интеграции служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] с SharePoint, см. дополнительные сведения в документации по SharePoint. Например, руководство по [включению SSL в веб-приложении SharePoint 2010 (https://docs.microsoft.com/archive/blogs/sowmyancs/how-to-enable-ssl-on-a-sharepoint-2010-web-application)](https://docs.microsoft.com/archive/blogs/sowmyancs/how-to-enable-ssl-on-a-sharepoint-2010-web-application).  
  
 Поскольку службы IIS также используют HTTP-службу SSL, возникает ряд важных проблем взаимодействия, которые необходимо учитывать при запуске служб IIS и служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] на одном компьютере. Ознакомьтесь с разделом «Проблемы взаимодействия со службами IIS», где приводятся рекомендации по решению данных проблем.  
  
## <a name="server-certificate-requirements"></a>Требования к сертификату сервера  
 Сертификат сервера должен быть установлен на компьютере (клиентские сертификаты не поддерживаются). Службы Reporting Services не содержат функций запроса, формирования, загрузки или установки сертификата. [!INCLUDE[winxpsvr](../../includes/winxpsvr-md.md)] предоставляет оснастку "Сертификаты", с помощью которой можно запрашивать сертификаты из надежного центра сертификации.  
  
 Для тестовых целей можно сформировать локальный сертификат. Если используется программа **MakeCert** и пример команды в качестве шаблона, то перед выполнением команды задайте в качестве узла имя сервера и удалите все разрывы строки. Если команда выполняется в DOS-окне, то может понадобиться увеличить размер оконного буфера, чтобы в него вошла вся команда.  
  
 Если службы IIS и [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] работают вместе на одном компьютере, для установки сертификата на компьютер можно использовать консольное приложение "Диспетчер IIS". Оно включает возможности создания и упаковки запроса файла сертификата (CRT) для последующей обработки надежным центром сертификации. Центр сертификации создаст файл сертификата (CER) и вышлет его обратно. Установку файла сертификата в локальное хранилище можно выполнить при помощи консоли управления службами IIS. Дополнительные сведения см. в разделе [Использование SSL для шифрования конфиденциальных данных](https://go.microsoft.com/fwlink/?LinkId=71123) на веб-узле TechNet.  
  
## <a name="interoperability-issues-with-iis"></a>Проблемы взаимодействия со службами IIS  
 Присутствие на одном компьютере служб IIS и служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] оказывает значительное влияние на SSL-соединения с сервером отчетов.  
  
-   Если установлены службы IIS, то должна быть постоянно запущена служба W3SVC. HTTP-служба SSL создает зависимость от служб IIS, если обнаружит, что они запущены. Это означает, что если службы IIS и [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] установлены на одном компьютере и URL-адреса серверов отчетов настроены на SSL-соединения, то должна быть запущена служба W3SVC.  
  
-   Удаление службы IIS может нарушить работу службы по привязанному к SSL-соединению URL-адресу сервера отчетов. По этой причине настоятельно рекомендуется после удаления служб IIS перезапустить компьютер.  
  
     Это необходимо, чтобы удалить из кэша все SSL-сеансы. В некоторых операционных системах время кэширования SSL-сеансов составляет до 10 часов, в результате чего URL-адрес https:// продолжает работать даже после удаления привязки SSL из резервирования URL-адресов в компоненте HTTP.SYS. Перезагрузка компьютера позволит закрыть все открытые соединения, использующие этот канал.  
  
## <a name="bind-ssl-to-a-reporting-services-url-reservation"></a>Привязка SSL к резервированию URL-адресов служб Reporting Services  
 Следующие шаги не содержат инструкций для запроса формирования, загрузки или установки сертификата. Сертификат должен быть установлен и доступен для использования. Главное, что при этом требуется, — правильно задать свойства сертификата, получить его из центра сертификации и пользоваться средствами и программами для запроса и установки сертификата.  
  
 Привязку сертификата можно выполнить при помощи программы настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Если сертификат правильно установлен в хранилище локального компьютера, то программа настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] обнаружит его и отобразит в списке **Сертификаты SSL** на страницах **URL-адрес веб-службы** и **URL-адрес диспетчера отчетов** .  
  
### <a name="to-configure-a-report-server-url-for-ssl"></a>Настройка URL-адреса сервера отчетов для SSL  
  
1.  Запустите программу настройки служб Reporting Services и подключитесь к серверу отчетов.  
  
2.  Щелкните **URL-адрес веб-службы**.  
  
3.  Разверните список SSL-сертификатов. [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] производят в локальном хранилище поиск сертификатов проверки подлинности сервера. Если сертификат установлен, но его нет в списке, то может понадобиться перезапустить службу. Это можно сделать при помощи кнопок **Стоп** и **Пуск** на странице **Состояние сервера отчетов** в программе настройки служб Reporting Services.  
  
4.  Выберите сертификат.  
  
5.  Нажмите кнопку **Применить**.  
  
6.  Щелкните URL-адрес, чтобы проверить работоспособность.  
  
 Для тестирования URL-адреса необходима настройка базы данных сервера отчетов. Если база данных сервера отчетов еще не создана, то это необходимо сделать до начала тестирования URL-адреса.  
  
 Резервирования URL-адресов для диспетчера отчетов и веб-службы сервера отчетов настраиваются независимо. Если нужно также настроить доступ к диспетчеру отчетов через канал с SSL-шифрованием, выполните следующие шаги.  
  
1.  Нажмите кнопку **URL-адрес диспетчера отчетов**.  
  
2.  Нажмите кнопку **Дополнительно**.  
  
3.  В разделе **Несколько удостоверений SSL для диспетчера отчетов**нажмите **Добавить**.  
  
4.  Выберите сертификат, нажмите кнопку **ОК**, а затем кнопку **Применить**.  
  
5.  Щелкните URL-адрес, чтобы проверить работоспособность.  
  
## <a name="how-certificate-bindings-are-stored"></a>Хранение привязок к сертификату  
 Привязки к сертификату хранятся в файле HTTP.SYS. Представление определенных пользователем привязок также сохраняется в разделе `URLReservations` файла RSReportServer.config. Настройки в файле конфигурации являются только представлением фактических значений, указанных в другом месте. Изменять значения непосредственно в файле конфигурации нельзя. Параметры настройки появятся в файле только в результате использования программы настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] или поставщика инструментария управления Windows (WMI) для привязки сертификата.  
  
> [!NOTE]  
>  Если настройка привязки выполняется при помощи SSL-сертификата в службах [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] , а в дальнейшем потребуется удалить сертификат из компьютера, обеспечьте удаление привязки из служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] перед удалением сертификата из компьютера. В противном случае будет невозможно удалить привязку при помощи программы настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] или WMI и появится уведомление об ошибке «Недопустимый параметр». Если сертификат уже удален из компьютера, можно использовать средство Httpcfg.exe для удаления привязки из компонента HTTP.SYS. Дополнительные сведения о Httpcfg.exe см. в документации по продукту Windows.  
  
 Привязки SSL являются общими ресурсами в Microsoft Windows. Изменения, проведенные в диспетчере конфигурации служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] или других программах наподобие диспетчера IIS, могут отразиться на работе других приложений, работающих на этом же компьютере. Рекомендуется пользоваться для изменения привязок тем же средством, которое использовалось для их создания.  Например, если создание привязок SSL производилось в диспетчере конфигурации, то рекомендуется работать с ними в той же программе в течение всего срока их службы. Если же для создания привязок использовался диспетчер IIS, то рекомендуется и все дальнейшие операции с этими привязками выполнять также с помощью диспетчера IIS. Если службы IIS установлены на компьютере до установки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] , рекомендуется проверить конфигурацию SSL в IIS перед настройкой служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].  
  
 Если удаление привязок SSL для служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] выполняется с помощью диспетчера конфигурации служб Reporting Services, то может перестать работать SSL для веб-сайтов на сервере, где работают службы IIS, или на другом сервере HTTP.SYS. [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Диспетчер конфигурации удаляет следующий раздел реестра. Если этот раздел реестра удаляется, привязка SSL для IIS также удаляется. Без этой привязки SSL для протокола HTTPS не поддерживается. Выполнить диагностику этой проблемы можно с помощью диспетчера IIS или программы HTTPCFG.exe. Чтобы решить эту проблему, восстановите привязку SSL для своих веб-сайтов с помощью диспетчера IIS. Чтобы предотвратить возникновение этой проблемы в будущем, с помощью диспетчера IIS удалите привязки SSL, а затем с помощью диспетчера IIS восстановите привязку для нужных веб-сайтов. Дополнительные сведения см. в статье базы знаний [SSL перестает работать после удаления привязки SSL (https://support.microsoft.com/kb/956209/n)](https://support.microsoft.com/kb/956209/n).  
  
## <a name="see-also"></a>См. также:  
 [Проверка подлинности с использованием сервера отчетов](authentication-with-the-report-server.md)   
 [Настройка и администрирование сервера отчетов (службы Reporting Services в собственном режиме)](../report-server/configure-and-administer-a-report-server-ssrs-native-mode.md)   
 [Файл конфигурации RSReportServer](../report-server/rsreportserver-config-configuration-file.md)   
 [Диспетчер конфигурации служб Reporting Services &#40;del&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md)   
 [Настройка URL-адресов сервера отчетов (диспетчер конфигурации служб SSRS)](../install-windows/configure-report-server-urls-ssrs-configuration-manager.md)  
  
  
