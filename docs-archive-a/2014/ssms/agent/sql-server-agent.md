---
title: Агент SQL Server | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- SQL Server Agent, about SQL Server Agent
- automatic administration steps
ms.assetid: 8d1dc600-aabb-416f-b3af-fbc9fccfd0ec
author: stevestein
ms.author: sstein
ms.openlocfilehash: e9de43e6bbb62deecd83b80095689c0ccbb8aedc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87737418"
---
# <a name="sql-server-agent"></a><span data-ttu-id="ccab6-102">Агент SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-102">SQL Server Agent</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-103">— это служба Microsoft Windows, выполняющая запланированные административные задачи, которые называются *заданиями* в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ccab6-103">Agent is a Microsoft Windows service that executes scheduled administrative tasks, which are called *jobs* in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="ccab6-104">**В этом разделе**</span><span class="sxs-lookup"><span data-stu-id="ccab6-104">**In This Topic**</span></span>  
  
-   [<span data-ttu-id="ccab6-105">Преимущества агент SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-105">Benefits of SQL Server Agent</span></span>](#Benefits)  
  
-   [<span data-ttu-id="ccab6-106">Компоненты агента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-106">Components of SQL Server Agent</span></span>](#Components)  
  
-   [<span data-ttu-id="ccab6-107">Безопасность при администрировании агента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-107">Security for SQL Server Agent Administration</span></span>](#Security)  
  
##  <a name="benefits-of-sql-server-agent"></a><a name="Benefits"></a><span data-ttu-id="ccab6-108">Преимущества агент SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-108">Benefits of SQL Server Agent</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-109">Агент использует [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для хранения сведений о заданиях.</span><span class="sxs-lookup"><span data-stu-id="ccab6-109">Agent uses [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to store job information.</span></span> <span data-ttu-id="ccab6-110">Задание состоит из одного или нескольких шагов.</span><span class="sxs-lookup"><span data-stu-id="ccab6-110">Jobs contain one or more job steps.</span></span> <span data-ttu-id="ccab6-111">Каждый шаг содержит собственную задачу, например создание резервной копии базы данных.</span><span class="sxs-lookup"><span data-stu-id="ccab6-111">Each step contains its own task, for example, backing up a database.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-112">Агент может выполнять задания по расписанию в ответ на определенное событие или по требованию.</span><span class="sxs-lookup"><span data-stu-id="ccab6-112">Agent can run a job on a schedule, in response to a specific event, or on demand.</span></span> <span data-ttu-id="ccab6-113">Например, можно автоматизировать задачу создания резервной копии всех серверов компании, чтобы она выполнялась ежедневно по окончании рабочего дня.</span><span class="sxs-lookup"><span data-stu-id="ccab6-113">For example, if you want to back up all the company servers every weekday after hours, you can automate this task.</span></span> <span data-ttu-id="ccab6-114">Запланируйте запуск резервного копирования после 22:00 с понедельника по пятницу; если во время создания резервной копии возникает проблема, агент SQL Server регистрирует соответствующее событие и выдает уведомление.</span><span class="sxs-lookup"><span data-stu-id="ccab6-114">Schedule the backup to run after 22:00 Monday through Friday; if the backup encounters a problem, SQL Server Agent can record the event and notify you.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ccab6-115">Служба агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] по умолчанию отключена, если во время установки [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] явно не выбран автоматический запуск службы.</span><span class="sxs-lookup"><span data-stu-id="ccab6-115">By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service is disabled when [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is installed unless the user explicitly chooses to autostart the service.</span></span>  
  
##  <a name="sql-server-agent-components"></a><a name="Components"></a><span data-ttu-id="ccab6-116">Компоненты агент SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-116">SQL Server Agent Components</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-117">Агент использует следующие компоненты, чтобы определить задачи для выполнения, время для выполнения задач и порядок уведомления об успешном или неудачном завершении задач.</span><span class="sxs-lookup"><span data-stu-id="ccab6-117">Agent uses the following components to define the tasks to be performed, when to perform the tasks, and how to report the success or failure of the tasks.</span></span>  
  
### <a name="jobs"></a><span data-ttu-id="ccab6-118">Задания</span><span class="sxs-lookup"><span data-stu-id="ccab6-118">Jobs</span></span>  
 <span data-ttu-id="ccab6-119">*Задание* — это заданная последовательность действий, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] выполняемых агентом.</span><span class="sxs-lookup"><span data-stu-id="ccab6-119">A *job* is a specified series of actions that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent performs.</span></span> <span data-ttu-id="ccab6-120">Используйте задания, чтобы определить задачу администрирования, которую можно запустить один или несколько раз и отслеживать ее успешное выполнение или сбой.</span><span class="sxs-lookup"><span data-stu-id="ccab6-120">Use jobs to define an administrative task that can be run one or more times and monitored for success or failure.</span></span> <span data-ttu-id="ccab6-121">Задание может выполняться на одном локальном или на нескольких удаленных серверах.</span><span class="sxs-lookup"><span data-stu-id="ccab6-121">A job can run on one local server or on multiple remote servers.</span></span>  
  
> [!IMPORTANT]  
>  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-122">Задания агента, которые выполнялись во время отработки отказа на экземпляре отказоустойчивого кластера [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], не возобновляются после отработки отказа и переключения на другой узел отказоустойчивого кластера.</span><span class="sxs-lookup"><span data-stu-id="ccab6-122">Agent jobs that are running at the time of a failover event on a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster instance do not resume after failover to another failover cluster node.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-123">Задания агента, которые выполнялись во время приостановки работы узла Hyper-V, не возобновляются, если приостановка вызывает отработку отказа с переходом на другой узел.</span><span class="sxs-lookup"><span data-stu-id="ccab6-123">Agent jobs that are running at the time a Hyper-V node is paused do not resume if the pause causes a failover to another node.</span></span> <span data-ttu-id="ccab6-124">Задания, выполнение которых было начато, но не завершилось в связи с событием отработки отказа, регистрируются в журнале как начатые, но дополнительных записей журнала о завершении или сбое нет.</span><span class="sxs-lookup"><span data-stu-id="ccab6-124">Jobs that begin but fail to complete because of a failover event are logged as started, but do not show additional log entries for completion or failure.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-125">Задания агента выглядят как незавершенные.</span><span class="sxs-lookup"><span data-stu-id="ccab6-125">Agent jobs in these scenarios appear to have never ended.</span></span>  
  
 <span data-ttu-id="ccab6-126">Выполнять задания можно несколькими способами:</span><span class="sxs-lookup"><span data-stu-id="ccab6-126">You can run jobs in several ways:</span></span>  
  
-   <span data-ttu-id="ccab6-127">по одному или нескольким расписаниям;</span><span class="sxs-lookup"><span data-stu-id="ccab6-127">According to one or more schedules.</span></span>  
  
-   <span data-ttu-id="ccab6-128">в ответ на одно или несколько предупреждений;</span><span class="sxs-lookup"><span data-stu-id="ccab6-128">In response to one or more alerts.</span></span>  
  
-   <span data-ttu-id="ccab6-129">посредством выполнения хранимой процедуры sp_start_job;</span><span class="sxs-lookup"><span data-stu-id="ccab6-129">By executing the sp_start_job stored procedure.</span></span>  
  
 <span data-ttu-id="ccab6-130">Каждое действие в задании является *шагом задания*.</span><span class="sxs-lookup"><span data-stu-id="ccab6-130">Each action in a job is a *job step*.</span></span> <span data-ttu-id="ccab6-131">Например, шаг задания может состоять из выполнения инструкции [!INCLUDE[tsql](../../includes/tsql-md.md)], выполнения пакета служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] или выдачи команды серверу служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ccab6-131">For example, a job step might consist of running a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement, executing an [!INCLUDE[ssIS](../../includes/ssis-md.md)] package, or issuing a command to an Analysis Services server.</span></span> <span data-ttu-id="ccab6-132">Шагами задания управляют как частью задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-132">Job steps are managed as part of a job.</span></span>  
  
 <span data-ttu-id="ccab6-133">Каждый шаг задания выполняется в указанном контексте безопасности.</span><span class="sxs-lookup"><span data-stu-id="ccab6-133">Each job step runs in a specific security context.</span></span> <span data-ttu-id="ccab6-134">Для шагов заданий, использующих [!INCLUDE[tsql](../../includes/tsql-md.md)], применяйте инструкцию EXECUTE AS, чтобы указать контекст безопасности для шага задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-134">For job steps that use [!INCLUDE[tsql](../../includes/tsql-md.md)], use the EXECUTE AS statement to set the security context for the job step.</span></span> <span data-ttu-id="ccab6-135">Для других типов шагов заданий используйте учетную запись-посредник, чтобы указать контекст безопасности для шага задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-135">For other types of job steps, use a proxy account to set the security context for the job step.</span></span>  
  
### <a name="schedules"></a><span data-ttu-id="ccab6-136">Расписания</span><span class="sxs-lookup"><span data-stu-id="ccab6-136">Schedules</span></span>  
 <span data-ttu-id="ccab6-137">*Расписание* указывает, когда выполняется задание.</span><span class="sxs-lookup"><span data-stu-id="ccab6-137">A *schedule* specifies when a job runs.</span></span> <span data-ttu-id="ccab6-138">Несколько заданий могут выполняться по тому же расписанию, а несколько расписаний могут применяться для одного задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-138">More than one job can run on the same schedule, and more than one schedule can apply to the same job.</span></span> <span data-ttu-id="ccab6-139">Расписание может определить следующие условия для времени выполнения задания:</span><span class="sxs-lookup"><span data-stu-id="ccab6-139">A schedule can define the following conditions for the time when a job runs:</span></span>  
  
-   <span data-ttu-id="ccab6-140">при каждом запуске агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)];</span><span class="sxs-lookup"><span data-stu-id="ccab6-140">Whenever [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent starts.</span></span>  
  
-   <span data-ttu-id="ccab6-141">каждый раз, когда использование ЦП компьютера будет достигать уровня, который определен как уровень простоя;</span><span class="sxs-lookup"><span data-stu-id="ccab6-141">Whenever CPU utilization of the computer is at a level you have defined as idle.</span></span>  
  
-   <span data-ttu-id="ccab6-142">однажды, в указанные дату и время;</span><span class="sxs-lookup"><span data-stu-id="ccab6-142">One time, at a specific date and time.</span></span>  
  
-   <span data-ttu-id="ccab6-143">Для повторяющегося расписания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-143">On a recurring schedule.</span></span>  
  
 <span data-ttu-id="ccab6-144">Дополнительные сведения см. в разделе [Создание и присоединение расписаний к заданиям](create-and-attach-schedules-to-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="ccab6-144">For more information, see [Create and Attach Schedules to Jobs](create-and-attach-schedules-to-jobs.md).</span></span>  
  
### <a name="alerts"></a><span data-ttu-id="ccab6-145">Предупреждения</span><span class="sxs-lookup"><span data-stu-id="ccab6-145">Alerts</span></span>  
 <span data-ttu-id="ccab6-146">*Предупреждение* — это автоматический ответ на наступление указанного события.</span><span class="sxs-lookup"><span data-stu-id="ccab6-146">An *alert* is an automatic response to a specific event.</span></span> <span data-ttu-id="ccab6-147">Например, событие может быть заданием, которое начинает выполняться, или системным ресурсом, достигшим указанного порогового значения.</span><span class="sxs-lookup"><span data-stu-id="ccab6-147">For example, an event can be a job that starts or system resources that reach a specific threshold.</span></span> <span data-ttu-id="ccab6-148">Пользователь определяет условия, при которых выдается предупреждение.</span><span class="sxs-lookup"><span data-stu-id="ccab6-148">You define the conditions under which an alert occurs.</span></span>  
  
 <span data-ttu-id="ccab6-149">Предупреждение может быть реакцией на одно из следующих условий:</span><span class="sxs-lookup"><span data-stu-id="ccab6-149">An alert can respond to one of the following conditions:</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-150">события;</span><span class="sxs-lookup"><span data-stu-id="ccab6-150">events</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-151">условия производительности;</span><span class="sxs-lookup"><span data-stu-id="ccab6-151">performance conditions</span></span>  
  
-   <span data-ttu-id="ccab6-152">события инструментария управления Microsoft Windows (WMI) на компьютере, где работает агент SQL Server;</span><span class="sxs-lookup"><span data-stu-id="ccab6-152">Microsoft Windows Management Instrumentation (WMI) events on the computer where SQL Server Agent is running</span></span>  
  
 <span data-ttu-id="ccab6-153">Предупреждение может выполнять следующие действия:</span><span class="sxs-lookup"><span data-stu-id="ccab6-153">An alert can perform the following actions:</span></span>  
  
-   <span data-ttu-id="ccab6-154">уведомить один или несколько операторов;</span><span class="sxs-lookup"><span data-stu-id="ccab6-154">Notify one or more operators</span></span>  
  
-   <span data-ttu-id="ccab6-155">Выполнение задания</span><span class="sxs-lookup"><span data-stu-id="ccab6-155">Run a job</span></span>  
  
 <span data-ttu-id="ccab6-156">Дополнительные сведения см. в статье [Оповещения](alerts.md).</span><span class="sxs-lookup"><span data-stu-id="ccab6-156">For more information, see [Alerts](alerts.md).</span></span>  
  
### <a name="operators"></a><span data-ttu-id="ccab6-157">Операторы</span><span class="sxs-lookup"><span data-stu-id="ccab6-157">Operators</span></span>  
 <span data-ttu-id="ccab6-158">*Оператор* определяет контактные сведения о лице, ответственном за обслуживание одного или нескольких экземпляров [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ccab6-158">An *operator* defines contact information for an individual responsible for the maintenance of one or more instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ccab6-159">В некоторых организациях обязанности оператора возлагаются на одно лицо.</span><span class="sxs-lookup"><span data-stu-id="ccab6-159">In some enterprises, operator responsibilities are assigned to one individual.</span></span> <span data-ttu-id="ccab6-160">В организациях, использующих несколько серверов, обязанности оператора могут быть разделены между несколькими лицами.</span><span class="sxs-lookup"><span data-stu-id="ccab6-160">In enterprises with multiple servers, many individuals can share operator responsibilities.</span></span> <span data-ttu-id="ccab6-161">Оператор не содержит сведений о безопасности и не определяет субъект безопасности.</span><span class="sxs-lookup"><span data-stu-id="ccab6-161">An operator does not contain security information, and does not define a security principal.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-162">может уведомлять операторов о предупреждениях одним из следующих способов или ненсколькими:</span><span class="sxs-lookup"><span data-stu-id="ccab6-162">can notify operators of alerts through one or more of the following:</span></span>  
  
-   <span data-ttu-id="ccab6-163">электронная почта;</span><span class="sxs-lookup"><span data-stu-id="ccab6-163">E-mail</span></span>  
  
-   <span data-ttu-id="ccab6-164">пейджер (через электронную почту);</span><span class="sxs-lookup"><span data-stu-id="ccab6-164">Pager (through e-mail)</span></span>  
  
-   <span data-ttu-id="ccab6-165">**команда net send.**</span><span class="sxs-lookup"><span data-stu-id="ccab6-165">**net send**</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ccab6-166">Чтобы отправлять уведомления с помощью **net send**, служба Windows Messenger должна быть запущена на компьютере, где работает агент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-166">To send notifications by using **net send**, the Windows Messenger service must be started on the computer where [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent resides.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ccab6-167">Режимы отправки уведомлений с помощью пейджера и команды **net send** будут удалены из агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в следующей версии [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ccab6-167">The Pager and **net send** options will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ccab6-168">Старайтесь не использовать эти функции в новых разработках и предусмотрите соответствующие изменения в приложениях, которые используют их в настоящее время.</span><span class="sxs-lookup"><span data-stu-id="ccab6-168">Avoid using these features in new development work, and plan to modify applications that currently use these features.</span></span>  
  
 <span data-ttu-id="ccab6-169">Для отправки операторам уведомлений по электронной почте или на пейджер необходимо настроить агент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для использования компонента Database Mail.</span><span class="sxs-lookup"><span data-stu-id="ccab6-169">To send notifications to operators by using e-mail or pagers, you must configure [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to use Database Mail.</span></span> <span data-ttu-id="ccab6-170">Дополнительные сведения см. в разделе о [компоненте Database Mail](../../relational-databases/database-mail/database-mail.md).</span><span class="sxs-lookup"><span data-stu-id="ccab6-170">For more information, see [Database Mail](../../relational-databases/database-mail/database-mail.md).</span></span>  
  
 <span data-ttu-id="ccab6-171">Можно определить оператора как псевдоним для группы лиц.</span><span class="sxs-lookup"><span data-stu-id="ccab6-171">You can define an operator as the alias for a group of individuals.</span></span> <span data-ttu-id="ccab6-172">Таким способом все члены этого псевдонима будут уведомлены одновременно.</span><span class="sxs-lookup"><span data-stu-id="ccab6-172">In this way, all members of that alias are notified at the same time.</span></span> <span data-ttu-id="ccab6-173">Дополнительные сведения см. в разделе [Операторы](operators.md).</span><span class="sxs-lookup"><span data-stu-id="ccab6-173">For more information, see [Operators](operators.md).</span></span>  
  
##  <a name="security-for-sql-server-agent-administration"></a><a name="Security"></a><span data-ttu-id="ccab6-174">Безопасность для администрирования агент SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-174">Security for SQL Server Agent Administration</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="ccab6-175">Агент использует предопределенные роли базы данных **SQLAgentUserRole**, **SQLAgentReaderRole**и **SQLAgentOperatorRole** в базе данных **msdb** для управления доступом к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] агенту для пользователей, не являющихся членами `sysadmin` предопределенной роли сервера.</span><span class="sxs-lookup"><span data-stu-id="ccab6-175">Agent uses the **SQLAgentUserRole**, **SQLAgentReaderRole**, and **SQLAgentOperatorRole** fixed database roles in the **msdb** database to control access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent for users who are not members of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="ccab6-176">Помимо этих предопределенных ролей базы данных, подсистемы и учетные записи-посредники позволяют администраторам базы данных гарантировать, что каждый шаг задания выполняется с минимальными разрешениями, необходимыми для выполнения задачи.</span><span class="sxs-lookup"><span data-stu-id="ccab6-176">In addition to these fixed database roles, subsystems and proxies help database administrators ensure that each job step runs with the minimum permissions required to perform its task.</span></span>  
  
### <a name="roles"></a><span data-ttu-id="ccab6-177">Роли</span><span class="sxs-lookup"><span data-stu-id="ccab6-177">Roles</span></span>  
 <span data-ttu-id="ccab6-178">Члены предопределенных ролей базы данных **SQLAgentUserRole**, **SQLAgentReaderRole**и **SQLAgentOperatorRole** в **msdb**, а также члены `sysadmin` предопределенной роли сервера имеют доступ к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] агенту.</span><span class="sxs-lookup"><span data-stu-id="ccab6-178">Members of the **SQLAgentUserRole**, **SQLAgentReaderRole**, and **SQLAgentOperatorRole** fixed database roles in **msdb**, and members of the `sysadmin` fixed server role have access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span></span> <span data-ttu-id="ccab6-179">Пользователь, не принадлежащий ни к одной из этих ролей, не может использовать агент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-179">A user that does not belong to any of these roles cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span></span> <span data-ttu-id="ccab6-180">Дополнительные сведения о ролях, используемых агентом [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], см. в разделе [Обеспечение безопасности агента SQL Server](implement-sql-server-agent-security.md).</span><span class="sxs-lookup"><span data-stu-id="ccab6-180">For more information on the roles used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, see [Implement SQL Server Agent Security](implement-sql-server-agent-security.md).</span></span>  
  
### <a name="subsystems"></a><span data-ttu-id="ccab6-181">Подсистемы</span><span class="sxs-lookup"><span data-stu-id="ccab6-181">Subsystems</span></span>  
 <span data-ttu-id="ccab6-182">Подсистема — это предопределенный объект, который содержит функции, доступные шагу задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-182">A subsystem is a predefined object that represents functionality that is available to a job step.</span></span> <span data-ttu-id="ccab6-183">Каждая учетная запись-посредник имеет доступ к одной или нескольким подсистемам.</span><span class="sxs-lookup"><span data-stu-id="ccab6-183">Each proxy has access to one or more subsystems.</span></span> <span data-ttu-id="ccab6-184">Подсистемы обеспечивают безопасность, поскольку разграничивают доступ учетных записей-посредников к функциям.</span><span class="sxs-lookup"><span data-stu-id="ccab6-184">Subsystems provide security because they delimit access to the functionality that is available to a proxy.</span></span> <span data-ttu-id="ccab6-185">Каждый шаг задания выполняется в контексте учетной записи-посредника, за исключением этапов задания [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-185">Each job step runs in the context of a proxy, except for [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)]<span data-ttu-id="ccab6-186">, применяйте команду EXECUTE AS, чтобы задать контекст безопасности для шага задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-186">job steps use the EXECUTE AS command to set the security context.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-187">определяет подсистемы, перечисленные в следующей таблице:</span><span class="sxs-lookup"><span data-stu-id="ccab6-187">defines the subsystems listed in the following table:</span></span>  
  
|<span data-ttu-id="ccab6-188">Имя подсистемы</span><span class="sxs-lookup"><span data-stu-id="ccab6-188">Subsystem name</span></span>|<span data-ttu-id="ccab6-189">Описание</span><span class="sxs-lookup"><span data-stu-id="ccab6-189">Description</span></span>|  
|--------------------|-----------------|  
|<span data-ttu-id="ccab6-190">Скрипт Microsoft ActiveX</span><span class="sxs-lookup"><span data-stu-id="ccab6-190">Microsoft ActiveX Script</span></span>|<span data-ttu-id="ccab6-191">Выполните шаг задания со скриптом ActiveX.</span><span class="sxs-lookup"><span data-stu-id="ccab6-191">Run an ActiveX scripting job step.</span></span><br /><br /> <span data-ttu-id="ccab6-192">\*\* \* \* Важно \* ! \* \*\* подсистема сценариев ActiveX будет удалена из [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] агента в следующей версии [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-192">**\*\* Important \*\*** The ActiveX Scripting subsystem will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ccab6-193">Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется.</span><span class="sxs-lookup"><span data-stu-id="ccab6-193">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>|  
|<span data-ttu-id="ccab6-194">Операционная система (**CmdExec**)</span><span class="sxs-lookup"><span data-stu-id="ccab6-194">Operating System (**CmdExec**)</span></span>|<span data-ttu-id="ccab6-195">Запустите исполняемую программу.</span><span class="sxs-lookup"><span data-stu-id="ccab6-195">Run an executable program.</span></span>|  
|<span data-ttu-id="ccab6-196">PowerShell</span><span class="sxs-lookup"><span data-stu-id="ccab6-196">PowerShell</span></span>|<span data-ttu-id="ccab6-197">Выполните шаг задания со скриптом PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ccab6-197">Run a PowerShell scripting job step.</span></span>|  
|<span data-ttu-id="ccab6-198">Распространитель репликации</span><span class="sxs-lookup"><span data-stu-id="ccab6-198">Replication Distributor</span></span>|<span data-ttu-id="ccab6-199">Выполните шаг задания, на котором активируется агент распространителя репликации.</span><span class="sxs-lookup"><span data-stu-id="ccab6-199">Run a job step that activates the replication Distribution Agent.</span></span>|  
|<span data-ttu-id="ccab6-200">Репликация слиянием</span><span class="sxs-lookup"><span data-stu-id="ccab6-200">Replication Merge</span></span>|<span data-ttu-id="ccab6-201">Выполните шаг задания, на котором активируется агент репликации слиянием.</span><span class="sxs-lookup"><span data-stu-id="ccab6-201">Run a job step that activates the replication Merge Agent.</span></span>|  
|<span data-ttu-id="ccab6-202">Агент чтения очереди репликации</span><span class="sxs-lookup"><span data-stu-id="ccab6-202">Replication Queue Reader</span></span>|<span data-ttu-id="ccab6-203">Выполните шаг задания, на котором активируется агент чтения очереди репликации.</span><span class="sxs-lookup"><span data-stu-id="ccab6-203">Run a job step that activates the replication Queue Reader Agent.</span></span>|  
|<span data-ttu-id="ccab6-204">Моментальный снимок репликации</span><span class="sxs-lookup"><span data-stu-id="ccab6-204">Replication Snapshot</span></span>|<span data-ttu-id="ccab6-205">Выполните шаг задания, на котором активируется агент моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="ccab6-205">Run a job step that activates the replication Snapshot Agent.</span></span>|  
|<span data-ttu-id="ccab6-206">Агент чтения журнала транзакций репликации</span><span class="sxs-lookup"><span data-stu-id="ccab6-206">Replication Transaction Log Reader</span></span>|<span data-ttu-id="ccab6-207">Выполните шаг задания, на котором активируется агент чтения журнала.</span><span class="sxs-lookup"><span data-stu-id="ccab6-207">Run a job step that activates the replication Log Reader Agent.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="ccab6-208">Command</span><span class="sxs-lookup"><span data-stu-id="ccab6-208">Command</span></span>|<span data-ttu-id="ccab6-209">Выполните команду служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-209">Run an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="ccab6-210">Запрос</span><span class="sxs-lookup"><span data-stu-id="ccab6-210">Query</span></span>|<span data-ttu-id="ccab6-211">Выполните запрос служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-211">Run an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query.</span></span>|  
|[!INCLUDE[ssIS](../../includes/ssis-md.md)] <span data-ttu-id="ccab6-212">выполнение пакетов служб</span><span class="sxs-lookup"><span data-stu-id="ccab6-212">package execution</span></span>|<span data-ttu-id="ccab6-213">Выполните пакет служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-213">Run an [!INCLUDE[ssIS](../../includes/ssis-md.md)] package.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="ccab6-214">Поскольку в шагах задания [!INCLUDE[tsql](../../includes/tsql-md.md)] учетные записи-посредники не используются, какие-либо подсистемы агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для шагов задания [!INCLUDE[tsql](../../includes/tsql-md.md)] отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="ccab6-214">Because [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps do not use proxies, there is no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent subsystem for [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-215">применяет ограничения подсистемы принудительно, даже если обычно субъект безопасности для учетной записи-посредника имеет разрешение на выполнение задачи на шаге задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-215">Agent enforces subsystem restrictions even when the security principal for the proxy would normally have permission to run the task in the job step.</span></span> <span data-ttu-id="ccab6-216">Например, пользователь, являющийся членом предопределенной роли администратора сервера, не сможет выполнить шаг задания служб [!INCLUDE[ssIS](../../includes/ssis-md.md)], если его учетная запись-посредник не имеет доступа к подсистеме служб [!INCLUDE[ssIS](../../includes/ssis-md.md)], несмотря на то, что пользователь может выполнять пакеты служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-216">For example, a proxy for a user that is a member of the sysadmin fixed server role cannot run an [!INCLUDE[ssIS](../../includes/ssis-md.md)] job step unless the proxy has access to the [!INCLUDE[ssIS](../../includes/ssis-md.md)] subsystem, even though the user can run [!INCLUDE[ssIS](../../includes/ssis-md.md)] packages.</span></span>  
  
### <a name="proxies"></a><span data-ttu-id="ccab6-217">прокси-серверы;</span><span class="sxs-lookup"><span data-stu-id="ccab6-217">Proxies</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ccab6-218">для управления контекстами безопасности использует учетные записи-посредники.</span><span class="sxs-lookup"><span data-stu-id="ccab6-218">Agent uses proxies to manage security contexts.</span></span> <span data-ttu-id="ccab6-219">Учетная запись-посредник может быть использована на нескольких шагах задания.</span><span class="sxs-lookup"><span data-stu-id="ccab6-219">A proxy can be used in more than one job step.</span></span> <span data-ttu-id="ccab6-220">Члены `sysadmin` предопределенной роли сервера могут создавать учетные записи-посредники.</span><span class="sxs-lookup"><span data-stu-id="ccab6-220">Members of the `sysadmin` fixed server role can create proxies.</span></span>  
  
 <span data-ttu-id="ccab6-221">Каждой учетной записи-посреднику соответствует учетная запись системы безопасности.</span><span class="sxs-lookup"><span data-stu-id="ccab6-221">Each proxy corresponds to a security credential.</span></span> <span data-ttu-id="ccab6-222">и может быть связана с множеством подсистем и множеством имен входа.</span><span class="sxs-lookup"><span data-stu-id="ccab6-222">Each proxy can be associated with a set of subsystems and a set of logins.</span></span> <span data-ttu-id="ccab6-223">Учетная запись-посредник может применяться только для шагов задания, которые используют связанную с этой учетной записью-посредником подсистему.</span><span class="sxs-lookup"><span data-stu-id="ccab6-223">The proxy can be used only for job steps that use a subsystem associated with the proxy.</span></span> <span data-ttu-id="ccab6-224">Чтобы создать шаг задания, использующий определенную учетную запись-посредник, владелец задания должен либо использовать связанное с ней имя входа, либо быть членом роли, имеющей неограниченный доступ к учетным записям-посредникам.</span><span class="sxs-lookup"><span data-stu-id="ccab6-224">To create a job step that uses a specific proxy, the job owner must either use a login associated with that proxy or be a member of a role with unrestricted access to proxies.</span></span> <span data-ttu-id="ccab6-225">Члены `sysadmin` предопределенной роли сервера имеют неограниченный доступ к учетным записям-посредникам.</span><span class="sxs-lookup"><span data-stu-id="ccab6-225">Members of the `sysadmin` fixed server role have unrestricted access to proxies.</span></span> <span data-ttu-id="ccab6-226">Члены ролей **SQLAgentUserRole**, **SQLAgentReaderRole**и **SQLAgentOperatorRole** могут использовать только учетные записи-посредники, на которые им был предоставлен особый доступ.</span><span class="sxs-lookup"><span data-stu-id="ccab6-226">Members of **SQLAgentUserRole**, **SQLAgentReaderRole**, or **SQLAgentOperatorRole** can only use proxies to which they have been granted specific access.</span></span> <span data-ttu-id="ccab6-227">Каждому пользователю, входящему в одну из предопределенных ролей базы данных агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], необходимо предоставить доступ к конкретным учетным записям-посредникам, чтобы пользователь мог создавать шаги задания, которые будут использовать эти учетные записи-посредники.</span><span class="sxs-lookup"><span data-stu-id="ccab6-227">Each user that is a member of any of these [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent fixed database roles must be granted access to specific proxies so that the user can create job steps that use those proxies.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="ccab6-228">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="ccab6-228">Related Tasks</span></span>  
 <span data-ttu-id="ccab6-229">Используйте следующие шаги для настройки агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для автоматического администрирования [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="ccab6-229">Use the following steps to configure [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to automate [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] administration:</span></span>  
  
1.  <span data-ttu-id="ccab6-230">Определите, какие административные задачи или события сервера происходят регулярно, а также можно ли эти задачи или события администрировать программным путем.</span><span class="sxs-lookup"><span data-stu-id="ccab6-230">Establish which administrative tasks or server events occur regularly and whether these tasks or events can be administered programmatically.</span></span> <span data-ttu-id="ccab6-231">Подходящей для автоматизации является такая задача, которая включает предсказуемую последовательность шагов и выполняется в определенное время или в ответ на определенное событие.</span><span class="sxs-lookup"><span data-stu-id="ccab6-231">A task is a good candidate for automation if it involves a predictable sequence of steps and occurs at a specific time or in response to a specific event.</span></span>  
  
2.  <span data-ttu-id="ccab6-232">Определите набор заданий, расписаний, предупреждений и операторов, используя среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], скрипты [!INCLUDE[tsql](../../includes/tsql-md.md)] или управляющие объекты (SMO) [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-232">Define a set of jobs, schedules, alerts, and operators by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts, or [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Objects (SMO).</span></span> <span data-ttu-id="ccab6-233">Дополнительные сведения см. в разделе [Создание заданий](create-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="ccab6-233">For more information, see [Create Jobs](create-jobs.md).</span></span>  
  
3.  <span data-ttu-id="ccab6-234">Запустите назначенные задания агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ccab6-234">Run the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent jobs you have defined.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ccab6-235">В экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]по умолчанию служба [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] имеет имя SQLSERVERAGENT.</span><span class="sxs-lookup"><span data-stu-id="ccab6-235">For the default instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service is named SQLSERVERAGENT.</span></span> <span data-ttu-id="ccab6-236">В именованных экземплярах служба агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] имеет имя SQLAgent$*имя_экземпляра*.</span><span class="sxs-lookup"><span data-stu-id="ccab6-236">For named instances, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service is named SQLAgent$*instancename*.</span></span>  
  
 <span data-ttu-id="ccab6-237">Если запущено несколько экземпляров [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], то чтобы автоматизировать общие для всех экземпляров задания, можно использовать администрирование нескольких серверов.</span><span class="sxs-lookup"><span data-stu-id="ccab6-237">If you are running multiple instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you can use multiserver administration to automate tasks common across all instances.</span></span> <span data-ttu-id="ccab6-238">Дополнительные сведения см. в статье [Автоматизация администрирования в масштабах предприятия](automated-administration-across-an-enterprise.md).</span><span class="sxs-lookup"><span data-stu-id="ccab6-238">For more information, see [Automated Administration Across an Enterprise](automated-administration-across-an-enterprise.md).</span></span>  
  
 <span data-ttu-id="ccab6-239">Используйте следующие задачи, чтобы начать работу с агентом [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="ccab6-239">Use the following tasks to get started with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent:</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="ccab6-240">**Описание**</span><span class="sxs-lookup"><span data-stu-id="ccab6-240">**Description**</span></span>|<span data-ttu-id="ccab6-241">**Раздел**</span><span class="sxs-lookup"><span data-stu-id="ccab6-241">**Topic**</span></span>|  
|<span data-ttu-id="ccab6-242">Содержит инструкции по настройке агента SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ccab6-242">Describes how to configure SQL Server Agent.</span></span>|[<span data-ttu-id="ccab6-243">Настройка агента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-243">Configure SQL Server Agent</span></span>](configure-sql-server-agent.md)|  
|<span data-ttu-id="ccab6-244">Описывает запуск, остановку и приостановку службы агента SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ccab6-244">Describes how to start, stop, and pause the SQL Server Agent service.</span></span>|[<span data-ttu-id="ccab6-245">Запуск, остановка или приостановка службы агента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-245">Start, Stop, or Pause the SQL Server Agent Service</span></span>](start-stop-or-pause-the-sql-server-agent-service.md)|  
|<span data-ttu-id="ccab6-246">Описывает вопросы задания учетных записей для службы агента SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ccab6-246">Describes considerations for specifying an account for the SQL Server Agent service.</span></span>|[<span data-ttu-id="ccab6-247">Выбор учетной записи для службы агента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-247">Select an Account for the SQL Server Agent Service</span></span>](select-an-account-for-the-sql-server-agent-service.md)|  
|<span data-ttu-id="ccab6-248">Описывает использование журнала ошибок агента SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ccab6-248">Describes how to use the SQL Server Agent error log.</span></span>|[<span data-ttu-id="ccab6-249">Журнал ошибок агента SQL Server</span><span class="sxs-lookup"><span data-stu-id="ccab6-249">SQL Server Agent Error Log</span></span>](sql-server-agent-error-log.md)|  
|||  
|<span data-ttu-id="ccab6-250">Содержит инструкции по использованию объектов производительности.</span><span class="sxs-lookup"><span data-stu-id="ccab6-250">Describes how to use performance objects.</span></span>|[<span data-ttu-id="ccab6-251">Использование объектов производительности</span><span class="sxs-lookup"><span data-stu-id="ccab6-251">Use Performance Objects</span></span>](use-performance-objects.md)|  
|<span data-ttu-id="ccab6-252">Описывает мастер планов обслуживания программу, которая используется для создания заданий, оповещений и операторов для автоматизации администрирования экземпляра SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ccab6-252">Describes the Maintenance Plan Wizard, which is a utility that you can use to help create jobs, alerts, and operators to automate administration of an instance of SQL Server.</span></span>|[<span data-ttu-id="ccab6-253">Использование мастера планов обслуживания</span><span class="sxs-lookup"><span data-stu-id="ccab6-253">Use the Maintenance Plan Wizard</span></span>](../../relational-databases/maintenance-plans/use-the-maintenance-plan-wizard.md)|  
|<span data-ttu-id="ccab6-254">Описывает автоматизацию задач администрирования с помощью агента SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ccab6-254">Describes how to automate administrative tasks using SQL Server Agent.</span></span>|[<span data-ttu-id="ccab6-255">Задачи автоматизированного администрирования (агент SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ccab6-255">Automated Administration Tasks &#40;SQL Server Agent&#41;</span></span>](automated-administration-tasks-sql-server-agent.md)|  
  
## <a name="see-also"></a><span data-ttu-id="ccab6-256">См. также:</span><span class="sxs-lookup"><span data-stu-id="ccab6-256">See Also</span></span>  
 [<span data-ttu-id="ccab6-257">Настройка контактной зоны</span><span class="sxs-lookup"><span data-stu-id="ccab6-257">Surface Area Configuration</span></span>](../../relational-databases/security/surface-area-configuration.md)  
  
  
