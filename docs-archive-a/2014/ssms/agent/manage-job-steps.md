---
title: Управление шагами задания | Документация Майкрософт
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- job steps [SQL Server replication]
- job steps [SQL Server Agent]
- jobs [SQL Server Agent], Integration Services package step
- executable programs as job steps
- operating systems [SQL Server], job steps
- Transact-SQL job step
- job steps [Transact-SQL]
- Integration Services packages, job steps
- replication job steps [SQL Server]
- logs [SQL Server], jobs
- SQL Server Agent jobs, job steps
- ActiveX scripting jobs [SQL Server]
- job steps [Analysis Services]
ms.assetid: 51352afc-a0a4-428b-8985-f9e58bb57c31
author: stevestein
ms.author: sstein
ms.openlocfilehash: 7362df13956e44b73d6984691e882bec2f39a1e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87665757"
---
# <a name="manage-job-steps"></a><span data-ttu-id="0e79a-102">Управление шагами задания</span><span class="sxs-lookup"><span data-stu-id="0e79a-102">Manage Job Steps</span></span>
  <span data-ttu-id="0e79a-103">Шаг задания — это действие, производимое заданием над базой данных или сервером.</span><span class="sxs-lookup"><span data-stu-id="0e79a-103">A job step is an action that the job takes on a database or a server.</span></span> <span data-ttu-id="0e79a-104">Каждое задание должно иметь, по крайней мере, один шаг.</span><span class="sxs-lookup"><span data-stu-id="0e79a-104">Every job must have at least one job step.</span></span> <span data-ttu-id="0e79a-105">Шагами задания могут быть:</span><span class="sxs-lookup"><span data-stu-id="0e79a-105">Job steps can be:</span></span>  
  
-   <span data-ttu-id="0e79a-106">Исполняемые программы и команды операционной системы.</span><span class="sxs-lookup"><span data-stu-id="0e79a-106">Executable programs and operating system commands.</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="0e79a-107">инструкции, включающие хранимые процедуры и расширенные хранимые процедуры.</span><span class="sxs-lookup"><span data-stu-id="0e79a-107">statements, including stored procedures and extended stored procedures.</span></span>  
  
-   <span data-ttu-id="0e79a-108">Скрипты PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0e79a-108">PowerShell scripts.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="0e79a-109">скрипты ActiveX.</span><span class="sxs-lookup"><span data-stu-id="0e79a-109">ActiveX scripts.</span></span>  
  
-   <span data-ttu-id="0e79a-110">Задачи репликации.</span><span class="sxs-lookup"><span data-stu-id="0e79a-110">Replication tasks.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="0e79a-111">задачи.</span><span class="sxs-lookup"><span data-stu-id="0e79a-111">tasks.</span></span>  
  
-   [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="0e79a-112">пакеты.</span><span class="sxs-lookup"><span data-stu-id="0e79a-112">packages.</span></span>  
  
 <span data-ttu-id="0e79a-113">Каждый шаг задания выполняется в определенном контексте безопасности.</span><span class="sxs-lookup"><span data-stu-id="0e79a-113">Every job step runs in a specific security context.</span></span> <span data-ttu-id="0e79a-114">Если шаг задания указывает учетную запись-посредник, он выполняется в контексте безопасности учетных данных для учетной записи-посредника.</span><span class="sxs-lookup"><span data-stu-id="0e79a-114">If the job step specifies a proxy, the job step runs in the security context of the credential for the proxy.</span></span> <span data-ttu-id="0e79a-115">Если шаг задания не указывает учетную запись-посредник, этот шаг выполняется в контексте учетной записи службы агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-115">If a job step does not specify a proxy, the job step runs in the context of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account.</span></span> <span data-ttu-id="0e79a-116">Только члены предопределенной роли сервера "sysadmin" могут создавать задания, которые не указывают учетную запись-посредник явным образом.</span><span class="sxs-lookup"><span data-stu-id="0e79a-116">Only members of the sysadmin fixed server role can create jobs that do not explicitly specify a proxy.</span></span>  
  
 <span data-ttu-id="0e79a-117">Так как шаги задания выполняются в контексте определенного пользователя [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows, этот пользователь должен иметь разрешения и конфигурацию, необходимые для выполнения шага.</span><span class="sxs-lookup"><span data-stu-id="0e79a-117">Because job steps run in the context of a specific [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows user, that user must have the permissions and configuration necessary for the job step to execute.</span></span> <span data-ttu-id="0e79a-118">Например, если создается задание, в котором требуется буква диска или путь в формате UNC, шаги задания могут выполняться под учетной записью пользователя Windows во время проверки задач.</span><span class="sxs-lookup"><span data-stu-id="0e79a-118">For example, if you create a job that requires a drive letter or a Universal Naming Convention (UNC) path, the job steps may run under your Windows user account while testing the tasks.</span></span> <span data-ttu-id="0e79a-119">Однако для шага задания пользователь Windows должен иметь необходимые разрешения, конфигурации буквы диска или доступ к требуемому диску.</span><span class="sxs-lookup"><span data-stu-id="0e79a-119">However, the Windows user for the job step must also have the necessary permissions, drive letter configurations, or access to the required drive.</span></span> <span data-ttu-id="0e79a-120">В противном случае шаг задания завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="0e79a-120">Otherwise, the job step fails.</span></span> <span data-ttu-id="0e79a-121">Во избежание этой проблемы нужно, чтобы учетная запись-посредник для каждого шага задания имела необходимые разрешения для задачи, которую выполняет шаг задания.</span><span class="sxs-lookup"><span data-stu-id="0e79a-121">To prevent this problem, ensure that the proxy for each job step has the necessary permissions for the task that the job step performs.</span></span> <span data-ttu-id="0e79a-122">Дополнительные сведения см. в статье [Центр безопасности для SQL Server ядро СУБД и базы данных SQL Azure](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span><span class="sxs-lookup"><span data-stu-id="0e79a-122">For more information, see [Security Center for SQL Server Database Engine and Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span></span>  
  
## <a name="job-step-logs"></a><span data-ttu-id="0e79a-123">Журналы шагов задания</span><span class="sxs-lookup"><span data-stu-id="0e79a-123">Job Step Logs</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="0e79a-124">Агент может записывать выходные данные из определенных шагов задания в файл операционной системы или в таблицу "sysjobstepslogs" базы данных "msdb".</span><span class="sxs-lookup"><span data-stu-id="0e79a-124">Agent can write output from some job steps either to an operating system file or to the sysjobstepslogs table in the msdb database.</span></span> <span data-ttu-id="0e79a-125">Следующие шаги задания могут записывать выходные данные в оба адресата:</span><span class="sxs-lookup"><span data-stu-id="0e79a-125">The following job step types can write output to both destinations:</span></span>  
  
-   <span data-ttu-id="0e79a-126">Исполняемые программы и команды операционной системы.</span><span class="sxs-lookup"><span data-stu-id="0e79a-126">Executable programs and operating system commands.</span></span>  
  
-   <span data-ttu-id="0e79a-127">Инструкции[!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-127">[!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="0e79a-128">задачи.</span><span class="sxs-lookup"><span data-stu-id="0e79a-128">tasks.</span></span>  
  
 <span data-ttu-id="0e79a-129">Только шаги задания, которые выполняются пользователями, являющимися членами предопределенной роли сервера "sysadmin", могут записывать выходные данные шагов задания в файлы операционной системы.</span><span class="sxs-lookup"><span data-stu-id="0e79a-129">Only job steps that are executed by users who are members of the sysadmin fixed server role can write job step output to operating system files.</span></span> <span data-ttu-id="0e79a-130">Если шаги задания выполняются пользователями, которые являются членами предопределенной роли базы данных SQLAgentUserRole, SQLAgentReaderRole или SQLAgentOperatorRole в базе данных "msdb", то выходные данные этих шагов задания могут быть записаны только в таблицу "sysjobstepslogs".</span><span class="sxs-lookup"><span data-stu-id="0e79a-130">If job steps are executed by users who are members of the SQLAgentUserRole, SQLAgentReaderRole, or the SQLAgentOperatorRole fixed database roles in the msdb database, then the output from these job steps can be written only to the sysjobstepslogs table.</span></span>  
  
 <span data-ttu-id="0e79a-131">Журналы шагов задания автоматически удаляются при удалении заданий или шагов заданий.</span><span class="sxs-lookup"><span data-stu-id="0e79a-131">Job step logs are automatically deleted when jobs or job steps are deleted.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0e79a-132">Задача репликации и ведение журнала шагов задания пакета служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] осуществляется соответствующей подсистемой.</span><span class="sxs-lookup"><span data-stu-id="0e79a-132">Replication task and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step logging is handled by their respective subsystem.</span></span> <span data-ttu-id="0e79a-133">Чтобы настроить регистрацию шагов задания для этих типов шагов задания, нельзя использовать агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-133">You cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to configure jog step logging for these types of job steps.</span></span>  
  
## <a name="executable-programs-and-operating-system-commands-as-job-steps"></a><span data-ttu-id="0e79a-134">Исполняемые программы и команды операционной системы в качестве шагов задания</span><span class="sxs-lookup"><span data-stu-id="0e79a-134">Executable Programs and Operating-System Commands As Job Steps</span></span>  
 <span data-ttu-id="0e79a-135">В качестве шагов задания можно использовать исполняемые программы и команды операционной системы.</span><span class="sxs-lookup"><span data-stu-id="0e79a-135">Executable programs and operating-system commands can be used as job steps.</span></span> <span data-ttu-id="0e79a-136">Эти файлы могут иметь расширения BAT, CMD, COM и EXE.</span><span class="sxs-lookup"><span data-stu-id="0e79a-136">These files may have .bat, .cmd, .com, or .exe file extensions.</span></span>  
  
 <span data-ttu-id="0e79a-137">При использовании исполняемой программы или команды операционной системы в качестве шага задания необходимо указать следующее.</span><span class="sxs-lookup"><span data-stu-id="0e79a-137">When you use an executable program or an operating-system command as a job step, you must specify:</span></span>  
  
-   <span data-ttu-id="0e79a-138">Код завершения процесса, возвращаемый при успешном выполнении команды.</span><span class="sxs-lookup"><span data-stu-id="0e79a-138">The process exit code returned if the command was successful.</span></span>  
  
-   <span data-ttu-id="0e79a-139">Команда для выполнения.</span><span class="sxs-lookup"><span data-stu-id="0e79a-139">The command to execute.</span></span> <span data-ttu-id="0e79a-140">Чтобы выполнить команду операционной системы, необходимо просто выполнить саму команду.</span><span class="sxs-lookup"><span data-stu-id="0e79a-140">To execute an operating system command, this is simply the command itself.</span></span> <span data-ttu-id="0e79a-141">Для внешней программы это ее имя и аргументы, например: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span><span class="sxs-lookup"><span data-stu-id="0e79a-141">For an external program, this is the name of the program and the arguments to the program, for example: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="0e79a-142">Необходимо предоставить полный путь к исполняемой программе, если только она не размещена в каталоге, указанном в системном пути или в пути пользователя, от имени которого выполняется шаг задания.</span><span class="sxs-lookup"><span data-stu-id="0e79a-142">You must provide the full path to the executable if the executable is not located in a directory specified in the system path or the path for the user that the job step runs as.</span></span>  
  
## <a name="transact-sql-job-steps"></a><span data-ttu-id="0e79a-143">Шаги задания Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="0e79a-143">Transact-SQL Job Steps</span></span>  
 <span data-ttu-id="0e79a-144">При создании шага задания [!INCLUDE[tsql](../../includes/tsql-md.md)] необходимо выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="0e79a-144">When you create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step, you must:</span></span>  
  
-   <span data-ttu-id="0e79a-145">Указать базу данных, в которой нужно выполнить задание.</span><span class="sxs-lookup"><span data-stu-id="0e79a-145">Identify the database in which to run the job.</span></span>  
  
-   <span data-ttu-id="0e79a-146">Ввести инструкцию [!INCLUDE[tsql](../../includes/tsql-md.md)] для выполнения.</span><span class="sxs-lookup"><span data-stu-id="0e79a-146">Type the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to execute.</span></span> <span data-ttu-id="0e79a-147">Инструкция может вызывать хранимую процедуру или расширенную хранимую процедуру.</span><span class="sxs-lookup"><span data-stu-id="0e79a-147">The statement may call a stored procedure or an extended stored procedure.</span></span>  
  
 <span data-ttu-id="0e79a-148">При необходимости можно открыть существующий файл [!INCLUDE[tsql](../../includes/tsql-md.md)] в качестве команды для шага задания.</span><span class="sxs-lookup"><span data-stu-id="0e79a-148">Optionally, you can open an existing [!INCLUDE[tsql](../../includes/tsql-md.md)] file as the command for the job step.</span></span>  
  
 [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="0e79a-149">в шагах задания не используются учетные записи-посредники агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-149">job steps do not use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxies.</span></span> <span data-ttu-id="0e79a-150">Вместо этого шаг задания выполняется как владелец шага задания или как учетная запись службы агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , если владелец шага задания является членом предопределенной роли сервера "sysadmin".</span><span class="sxs-lookup"><span data-stu-id="0e79a-150">Instead, the job step runs as the owner of the job step, or as the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account if the owner of the job step is a member of the sysadmin fixed server role.</span></span> <span data-ttu-id="0e79a-151">Члены предопределенной роли сервера "sysadmin" также могут указывать, что шаги задания [!INCLUDE[tsql](../../includes/tsql-md.md)] выполняются в контексте другого пользователя, с помощью параметра *database_user_name* хранимой процедуры "sp_add_jobstep stored".</span><span class="sxs-lookup"><span data-stu-id="0e79a-151">Members of the sysadmin fixed server role can also specify that [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps run under the context of another user by using the *database_user_name* parameter of the sp_add_jobstep stored procedure.</span></span> <span data-ttu-id="0e79a-152">Дополнительные сведения см. в разделе [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0e79a-152">For more information, see [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0e79a-153">Один шаг задания [!INCLUDE[tsql](../../includes/tsql-md.md)] может содержать несколько пакетов.</span><span class="sxs-lookup"><span data-stu-id="0e79a-153">A single [!INCLUDE[tsql](../../includes/tsql-md.md)] job step can contain multiple batches.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="0e79a-154">шаги задания могут содержать внедренные команды GO.</span><span class="sxs-lookup"><span data-stu-id="0e79a-154">job steps can contain embedded GO commands.</span></span>  
  
## <a name="powershell-scripting-job-steps"></a><span data-ttu-id="0e79a-155">Шаги заданий со скриптами PowerShell</span><span class="sxs-lookup"><span data-stu-id="0e79a-155">PowerShell Scripting Job Steps</span></span>  
 <span data-ttu-id="0e79a-156">При создании шага задания со скриптом PowerShell необходимо указать в качестве команды для шага одно из двух.</span><span class="sxs-lookup"><span data-stu-id="0e79a-156">When you create a PowerShell script job step, you must specify one of two things as the command for the step:</span></span>  
  
-   <span data-ttu-id="0e79a-157">Текст скрипта PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0e79a-157">The text of a PowerShell script.</span></span>  
  
-   <span data-ttu-id="0e79a-158">Существующий файл скрипта PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0e79a-158">An existing PowerShell script file to be opened.</span></span>  
  
 <span data-ttu-id="0e79a-159">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Подсистема агента PowerShell открывает сеанс PowerShell и загружает [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] оснастки PowerShell. Сценарий PowerShell, используемый в качестве команды шага задания, может ссылаться на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] поставщика и командлеты PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0e79a-159">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell subsystem opens a PowerShell session and loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The PowerShell script used as the job step command can reference the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider and cmdlets.</span></span> <span data-ttu-id="0e79a-160">Дополнительные сведения о написании скриптов PowerShell с помощью оснасток [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell см. в разделе [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="0e79a-160">For more information about writing PowerShell scripts using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins, see the [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span></span>  
  
## <a name="activex-scripting-job-steps"></a><span data-ttu-id="0e79a-161">Шаги задания скрипта ActiveX</span><span class="sxs-lookup"><span data-stu-id="0e79a-161">ActiveX Scripting Job Steps</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="0e79a-162">Шаг задания скрипта ActiveX будет удален из агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в следующей версии [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e79a-162">The ActiveX scripting job step will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="0e79a-163">Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется.</span><span class="sxs-lookup"><span data-stu-id="0e79a-163">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>  
  
 <span data-ttu-id="0e79a-164">При создании шага задания скрипта ActiveX необходимо:</span><span class="sxs-lookup"><span data-stu-id="0e79a-164">When you create an ActiveX scripting job step, you must:</span></span>  
  
-   <span data-ttu-id="0e79a-165">Указать язык скрипта, на котором будет записан шаг задания.</span><span class="sxs-lookup"><span data-stu-id="0e79a-165">Identify the scripting language in which the job step is written.</span></span>  
  
-   <span data-ttu-id="0e79a-166">Записать скрипт ActiveX.</span><span class="sxs-lookup"><span data-stu-id="0e79a-166">Write the ActiveX script.</span></span>  
  
 <span data-ttu-id="0e79a-167">Также можно открыть существующий файл скрипта ActiveX как команду для шага задания.</span><span class="sxs-lookup"><span data-stu-id="0e79a-167">You can also open an existing ActiveX script file as the command for the job step.</span></span> <span data-ttu-id="0e79a-168">В противном случае команды скрипта ActiveX могут быть скомпилированы с помощью внешних средств (например, при помощи Microsoft Visual Basic), а затем выполнены как исполняемые программы.</span><span class="sxs-lookup"><span data-stu-id="0e79a-168">Alternatively, ActiveX script commands can be externally compiled (for example, using Microsoft Visual Basic) and then run as executable programs.</span></span>  
  
 <span data-ttu-id="0e79a-169">Если команда шага задания является скриптом ActiveX, можно использовать объект "SQLActiveScriptHost" для печати выходных данных в журнал шагов задания или для создания объектов COM.</span><span class="sxs-lookup"><span data-stu-id="0e79a-169">When a job step command is an ActiveX script, you can use the SQLActiveScriptHost object to print output to the job step history log or create COM objects.</span></span> <span data-ttu-id="0e79a-170">"SQLActiveScriptHost" — это глобальный объект, введенный системой размещения агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в пространство имен скрипта.</span><span class="sxs-lookup"><span data-stu-id="0e79a-170">SQLActiveScriptHost is a global object that is introduced by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent hosting system into the script name space.</span></span> <span data-ttu-id="0e79a-171">Объект содержит два метода (Print и CreateObject).</span><span class="sxs-lookup"><span data-stu-id="0e79a-171">The object has two methods (Print and CreateObject).</span></span> <span data-ttu-id="0e79a-172">Представленный пример показывает, как скрипт ActiveX работает в Visual Basic Scripting Edition (VBScript).</span><span class="sxs-lookup"><span data-stu-id="0e79a-172">The following example shows how ActiveX scripting works in Visual Basic Scripting Edition (VBScript).</span></span>  
  
```  
' VBScript example for ActiveX Scripting job step  
' Create a Dmo.Server object. The object connects to the  
' server on which the script is running.  
  
Set oServer = CreateObject("SQLDmo.SqlServer")  
oServer.LoginSecure = True  
oServer.Connect "(local)"  
'Disconnect and destroy the server object  
oServer.DisConnect  
Set oServer = nothing
```  
  
## <a name="replication-job-steps"></a><span data-ttu-id="0e79a-173">Шаги задания репликации</span><span class="sxs-lookup"><span data-stu-id="0e79a-173">Replication Job Steps</span></span>  
 <span data-ttu-id="0e79a-174">При создании публикаций и подписок с помощью репликации задания репликации создаются по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0e79a-174">When you create publications and subscriptions using replication, replication jobs are created by default.</span></span> <span data-ttu-id="0e79a-175">Тип создаваемого задания определяется типом репликации (моментальный снимок, транзакционная репликация или репликация слиянием) и используемыми параметрами.</span><span class="sxs-lookup"><span data-stu-id="0e79a-175">The type of job created is determined by the type of replication (snapshot, transactional, or merge) and the options used.</span></span>  
  
 <span data-ttu-id="0e79a-176">Шаги задания репликации активируют один из следующих агентов репликации:</span><span class="sxs-lookup"><span data-stu-id="0e79a-176">Replication job steps activate one of these replication agents:</span></span>  
  
-   <span data-ttu-id="0e79a-177">Агент моментальных снимков (задание Snapshot)</span><span class="sxs-lookup"><span data-stu-id="0e79a-177">Snapshot Agent (Snapshot job)</span></span>  
  
-   <span data-ttu-id="0e79a-178">Агент чтения журнала (задание LogReader)</span><span class="sxs-lookup"><span data-stu-id="0e79a-178">Log Reader Agent (LogReader job)</span></span>  
  
-   <span data-ttu-id="0e79a-179">Агент распространителя (задание Distribution)</span><span class="sxs-lookup"><span data-stu-id="0e79a-179">Distribution Agent (Distribution job)</span></span>  
  
-   <span data-ttu-id="0e79a-180">Агент слияния (задание Merge)</span><span class="sxs-lookup"><span data-stu-id="0e79a-180">Merge Agent (Merge job)</span></span>  
  
-   <span data-ttu-id="0e79a-181">Агент чтения очереди (задание QueueReader)</span><span class="sxs-lookup"><span data-stu-id="0e79a-181">Queue Reader Agent (QueueReader job)</span></span>  
  
 <span data-ttu-id="0e79a-182">Настроив репликацию, можно указать выполнение агентов репликации одним из следующих способов: постоянно после запуска агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , по запросу или по расписанию.</span><span class="sxs-lookup"><span data-stu-id="0e79a-182">When replication is set up, you can specify to run the replication agents in one of three ways: continuously after [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is started, on demand, or according to a schedule.</span></span> <span data-ttu-id="0e79a-183">Дополнительные сведения об агентах репликации см. в разделе [Обзор агентов репликации](../../relational-databases/replication/agents/replication-agents-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0e79a-183">For more information about replication agents, see [Replication Agents Overview](../../relational-databases/replication/agents/replication-agents-overview.md).</span></span>  
  
## <a name="analysis-services-job-steps"></a><span data-ttu-id="0e79a-184">Шаги задания служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="0e79a-184">Analysis Services Job Steps</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="0e79a-185">Агент поддерживает два определенных типа шагов заданий служб Analysis Services: шаги задания команды и шаги задания запроса.</span><span class="sxs-lookup"><span data-stu-id="0e79a-185">Agent supports two distinct types of Analysis Services job steps, command job steps, and query job steps.</span></span>  
  
### <a name="analysis-services-command-job-steps"></a><span data-ttu-id="0e79a-186">Шаги задания команды служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="0e79a-186">Analysis Services Command Job Steps</span></span>  
 <span data-ttu-id="0e79a-187">При создании шага задания служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] необходимо выполнить следующее.</span><span class="sxs-lookup"><span data-stu-id="0e79a-187">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command job step, you must:</span></span>  
  
-   <span data-ttu-id="0e79a-188">Определить сервер базы данных OLAP, на котором необходимо выполнить шаг задания.</span><span class="sxs-lookup"><span data-stu-id="0e79a-188">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="0e79a-189">Ввести инструкцию, которую необходимо выполнить.</span><span class="sxs-lookup"><span data-stu-id="0e79a-189">Type the statement to execute.</span></span> <span data-ttu-id="0e79a-190">Для метода  **Execute** служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] инструкция должна быть в формате XML.</span><span class="sxs-lookup"><span data-stu-id="0e79a-190">The statement must be an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute** method.</span></span> <span data-ttu-id="0e79a-191">Инструкция может не содержать полный конверт SOAP или XML-файл для метода  **Discover** служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e79a-191">The statement may not contain a complete SOAP envelope or an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover** method.</span></span> <span data-ttu-id="0e79a-192">Обратите внимание, что в среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] поддерживаются полные конверты SOAP и метод **Discover** , но поддержки шагов заданий агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] нет.</span><span class="sxs-lookup"><span data-stu-id="0e79a-192">Notice that, while [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports complete SOAP envelopes and the **Discover** method, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps do not.</span></span>  
  
### <a name="analysis-services-query-job-steps"></a><span data-ttu-id="0e79a-193">Шаги задания запроса служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="0e79a-193">Analysis Services Query Job Steps</span></span>  
 <span data-ttu-id="0e79a-194">При создании шага задания с запросом служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] необходимо:</span><span class="sxs-lookup"><span data-stu-id="0e79a-194">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query job step, you must:</span></span>  
  
-   <span data-ttu-id="0e79a-195">Определить сервер базы данных OLAP, на котором необходимо выполнить шаг задания.</span><span class="sxs-lookup"><span data-stu-id="0e79a-195">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="0e79a-196">Ввести инструкцию, которую необходимо выполнить.</span><span class="sxs-lookup"><span data-stu-id="0e79a-196">Type the statement to execute.</span></span> <span data-ttu-id="0e79a-197">Эта инструкция должна быть запросом многомерных выражений (MDX).</span><span class="sxs-lookup"><span data-stu-id="0e79a-197">The statement must be a multidimensional expressions (MDX) query.</span></span>  
  
 <span data-ttu-id="0e79a-198">Дополнительные сведения о многомерных выражениях см. в разделе [основные принципы запросов многомерных выражений &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span><span class="sxs-lookup"><span data-stu-id="0e79a-198">For more information on MDX, see [MDX Query Fundamentals &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span></span>  
  
## <a name="integration-services-packages"></a><span data-ttu-id="0e79a-199">Пакеты служб Integration Services</span><span class="sxs-lookup"><span data-stu-id="0e79a-199">Integration Services Packages</span></span>  
 <span data-ttu-id="0e79a-200">При создании шага задания с пакетом служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] необходимо выполнить следующее.</span><span class="sxs-lookup"><span data-stu-id="0e79a-200">When you create an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step, you must do the following:</span></span>  
  
-   <span data-ttu-id="0e79a-201">Указать источник пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-201">Identify the source of the package.</span></span>  
  
-   <span data-ttu-id="0e79a-202">Указать размещение пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-202">Identify the location of the package.</span></span>  
  
-   <span data-ttu-id="0e79a-203">Указать файлы конфигурации, если они необходимы для пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-203">If configuration files are required for the package, identify the configuration files.</span></span>  
  
-   <span data-ttu-id="0e79a-204">Указать файлы команд, если они необходимы для пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-204">If command files are required for the package, identify the command files.</span></span>  
  
-   <span data-ttu-id="0e79a-205">Указать необходимую для пакета проверку.</span><span class="sxs-lookup"><span data-stu-id="0e79a-205">Identify the verification to use for the package.</span></span> <span data-ttu-id="0e79a-206">Например, можно указать, что пакет должен быть подписанным или иметь определенный идентификатор пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-206">For example, you can specify that the package must be signed, or that the package must have a specific package ID.</span></span>  
  
-   <span data-ttu-id="0e79a-207">Указать источники данных для пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-207">Identify the data sources for the package.</span></span>  
  
-   <span data-ttu-id="0e79a-208">Указать регистраторы для пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-208">Identify the log providers for the package.</span></span>  
  
-   <span data-ttu-id="0e79a-209">Указать переменные и значения, которые необходимо установить до запуска пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-209">Specify variables and values to set before running the package.</span></span>  
  
-   <span data-ttu-id="0e79a-210">Указать параметры выполнения.</span><span class="sxs-lookup"><span data-stu-id="0e79a-210">Identify execution options.</span></span>  
  
-   <span data-ttu-id="0e79a-211">Добавить или изменить параметры командной строки.</span><span class="sxs-lookup"><span data-stu-id="0e79a-211">Add or modify command-line options.</span></span>  
  
 <span data-ttu-id="0e79a-212">Обратите внимание, что если пакет был развернут в каталоге служб SSIS и в качестве источника пакета был указан **Каталог служб SSIS** , значительная часть этих конфигурационных данных берется автоматически из пакета.</span><span class="sxs-lookup"><span data-stu-id="0e79a-212">Note that if you deployed the package to the SSIS Catalog and you specify **SSIS Catalog** as the package source, much of this configuration information is obtained automatically from the package.</span></span> <span data-ttu-id="0e79a-213">На вкладке **Конфигурация** можно указать среду, значения параметров, значения диспетчера подключений, переопределения свойств и выполняется ли пакет в 32-разрядной среде.</span><span class="sxs-lookup"><span data-stu-id="0e79a-213">Under the **Configuration** tab you can specify the environment, parameter values, connection manager values, property overrides, and whether the package runs in a 32-bit runtime environment.</span></span>  
  
 <span data-ttu-id="0e79a-214">Дополнительные сведения о создании шагов заданий, которые выполняют пакеты служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , см. в разделе [Пакеты служб из заданий агента SQL Server](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span><span class="sxs-lookup"><span data-stu-id="0e79a-214">For more information about creating job steps that run [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [SQL Server Agent Jobs for Packages](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="0e79a-215">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="0e79a-215">Related Tasks</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="0e79a-216">**Описание**</span><span class="sxs-lookup"><span data-stu-id="0e79a-216">**Description**</span></span>|<span data-ttu-id="0e79a-217">**Раздел**</span><span class="sxs-lookup"><span data-stu-id="0e79a-217">**Topic**</span></span>|  
|<span data-ttu-id="0e79a-218">Описывает создание шага задания с помощью исполняемой программы.</span><span class="sxs-lookup"><span data-stu-id="0e79a-218">Describes how to create a job step with an executable program.</span></span>|[<span data-ttu-id="0e79a-219">Create a CmdExec Job Step</span><span class="sxs-lookup"><span data-stu-id="0e79a-219">Create a CmdExec Job Step</span></span>](create-a-cmdexec-job-step.md)|  
|<span data-ttu-id="0e79a-220">Описывает, как сбросить разрешения агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-220">Describes how to reset [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent permissions.</span></span>|[<span data-ttu-id="0e79a-221">Configure a User to Create and Manage SQL Server Agent Jobs</span><span class="sxs-lookup"><span data-stu-id="0e79a-221">Configure a User to Create and Manage SQL Server Agent Jobs</span></span>](configure-a-user-to-create-and-manage-sql-server-agent-jobs.md)|  
|<span data-ttu-id="0e79a-222">Описывает создание шага задания [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-222">Describes how to create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step.</span></span>|[<span data-ttu-id="0e79a-223">Создание шага задания Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="0e79a-223">Create a Transact-SQL Job Step</span></span>](create-a-transact-sql-job-step.md)|  
|<span data-ttu-id="0e79a-224">Описывает определение параметров для шагов заданий Transact-SQL агента Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-224">Describes how to define options for Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Transact-SQL job steps.</span></span>|[<span data-ttu-id="0e79a-225">Определение параметров для шагов заданий Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="0e79a-225">Define Transact-SQL Job Step Options</span></span>](define-transact-sql-job-step-options.md)|  
|<span data-ttu-id="0e79a-226">Описывает создание шага задания скрипта ActiveX.</span><span class="sxs-lookup"><span data-stu-id="0e79a-226">Describes how to create an ActiveX script job step.</span></span>|[<span data-ttu-id="0e79a-227">Create an ActiveX Script Job Step</span><span class="sxs-lookup"><span data-stu-id="0e79a-227">Create an ActiveX Script Job Step</span></span>](create-an-activex-script-job-step.md)|  
|<span data-ttu-id="0e79a-228">Описывает процесс создания и определения шагов заданий агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , выполняющих команды и запросы служб [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="0e79a-228">Describes how to create and define [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps that execute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services commands and queries.</span></span>|[<span data-ttu-id="0e79a-229">Create an Analysis Services Job Step</span><span class="sxs-lookup"><span data-stu-id="0e79a-229">Create an Analysis Services Job Step</span></span>](create-an-analysis-services-job-step.md)|  
|<span data-ttu-id="0e79a-230">Описывает, какое действие будет выполнять [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , если при выполнении задания происходит ошибка.</span><span class="sxs-lookup"><span data-stu-id="0e79a-230">Describes what action [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should take if a failure occurs during job execution.</span></span>|[<span data-ttu-id="0e79a-231">Настройка потока действий системы при успешном или неуспешном выполнении шага задания</span><span class="sxs-lookup"><span data-stu-id="0e79a-231">Set Job Step Success or Failure Flow</span></span>](set-job-step-success-or-failure-flow.md)|  
|<span data-ttu-id="0e79a-232">Описывает, как просмотреть сведения о шаге задания в окне «Свойства шага задания».</span><span class="sxs-lookup"><span data-stu-id="0e79a-232">Describes how to view job step details in the Job Step Properties dialog.</span></span>|[<span data-ttu-id="0e79a-233">View Job Step Information</span><span class="sxs-lookup"><span data-stu-id="0e79a-233">View Job Step Information</span></span>](view-job-step-information.md)|  
|<span data-ttu-id="0e79a-234">Описывает, как удалить журнал шага задания агента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0e79a-234">Describes how to delete a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job step log.</span></span>|[<span data-ttu-id="0e79a-235">Delete a Job Step Log</span><span class="sxs-lookup"><span data-stu-id="0e79a-235">Delete a Job Step Log</span></span>](delete-a-job-step-log.md)|  
  
## <a name="see-also"></a><span data-ttu-id="0e79a-236">См. также:</span><span class="sxs-lookup"><span data-stu-id="0e79a-236">See Also</span></span>  
 <span data-ttu-id="0e79a-237">[dbo.sysжобстепслогс &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="0e79a-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span></span>  
 <span data-ttu-id="0e79a-238">[Создание заданий](create-jobs.md) </span><span class="sxs-lookup"><span data-stu-id="0e79a-238">[Create Jobs](create-jobs.md) </span></span>  
 [<span data-ttu-id="0e79a-239">sp_add_job (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="0e79a-239">sp_add_job &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql)  
