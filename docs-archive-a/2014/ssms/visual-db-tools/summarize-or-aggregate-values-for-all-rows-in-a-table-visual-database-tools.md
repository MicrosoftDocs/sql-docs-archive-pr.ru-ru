---
title: Суммировать или агрегировать значения для всех строк в таблице (визуальные инструменты для баз данных) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- summarizing query results
- aggregate functions [SQL Server], summarizing query results
ms.assetid: f5af876e-f937-4110-ba09-07999c35a699
author: stevestein
ms.author: sstein
ms.openlocfilehash: 5c4d80c8ab2b811b8e796f0a37b2180a2866c332
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87735794"
---
# <a name="summarize-or-aggregate-values-for-all-rows-in-a-table-visual-database-tools"></a>Получение суммарных или статистических значений для всех строк в таблице (визуальные инструменты для баз данных)
  Агрегатные функции позволяют вычислять сумму всех значений, содержащихся в таблице. Например, можно создать запрос наподобие того, что приведен ниже, для отображения общей стоимости всех книг, содержащихся в таблице `titles` :  
  
```  
SELECT SUM(price)  
FROM titles  
```  
  
 Один запрос может вычислять сразу несколько статистических выражений, используя агрегатные функции для одного или нескольких столбцов. Например, можно создать запрос, вычисляющий общую сумму по столбцу `price` и среднеарифметическое значение столбца `discount` .  
  
 В одном запросе можно также для одного и того же столбца определять несколько статистических операций (подведение общей суммы, подсчет, усреднение). Например, следующий запрос определяет среднеарифметическое значение и общую сумму столбца `price` в таблице `titles` :  
  
```  
SELECT AVG(price), SUM(price)  
FROM titles  
```  
  
 Если добавить условия поиска, можно вычислять статистические значения на основе подмножества строк, удовлетворяющих заданному условию.  
  
> [!NOTE]  
>  Можно также подсчитать, сколько всего в таблице содержится строк, или строк, удовлетворяющих определенному условию. Дополнительные сведения см. в разделе [Подсчет строк в таблице (визуальные инструменты для баз данных)](visual-database-tools.md).  
  
 Если в запросе указано статистическое выражение, то для всех строк в таблице отображается только само это статистическое значение. Например, при подсчете итогового значения столбца `price` в таблице `titles` названия, имена издателей и другие столбцы не отображаются.  
  
> [!NOTE]  
>  При создании подытогов (например, групп) можно выводить значения столбцов для каждой группы. Дополнительные сведения см. в разделе [Группирование строк в результатах запроса (визуальные инструменты для баз данных)](group-rows-in-query-results-visual-database-tools.md).  
  
### <a name="to-aggregate-values-for-all-rows"></a>Статистические выражения по всем строкам  
  
1.  Убедитесь, что таблица, в которой необходимо вычислить статистическую величину, присутствует на панели диаграмм  
  
2.  Щелкните правой кнопкой мыши фон панели диаграммы, а затем в контекстном меню выберите пункт **Группировать** . [Конструктор запросов и представлений](query-and-view-designer-tools-visual-database-tools.md) добавляет столбец **Group By** в сетку на панели критериев.  
  
3.  Добавьте на панель критериев столбец, по которому необходимо вычислить статистическую величину. Убедитесь, что столбец помечен для вывода.  
  
     Конструктор запросов и представлений автоматически назначает суммируемому столбцу псевдоним, который можно заменить более понятным. Дополнительные сведения см. в разделе [Создание псевдонимов столбцов (визуальные инструменты для баз данных)](create-column-aliases-visual-database-tools.md).  
  
4.  В столбце сетки **Группировать** выберите нужную агрегатную функцию, например **Sum**, **Avg**, **Min**, **Max**, **Count**. Если необходимо вычислить статистические значения только для уникальных строк результирующего набора, выберите агрегатную функцию с параметром DISTINCT, например **Min Distinct**. Не выбирайте параметры **Группировать**, **Выражение**или **Где**, так как они не применяются при статистической обработке всех строк.  
  
     Конструктор запросов и представлений заменяет указанной агрегатной функцией имя столбца в инструкции, представленной на [панели SQL](sql-pane-visual-database-tools.md) . Например, инструкция SQL может иметь такой вид:  
  
    ```  
    SELECT SUM(price)  
    FROM titles  
    ```  
  
5.  Если необходимо создать в запросе несколько статистических выражений, повторите шаги 3 и 4.  
  
     Если в список выводов запроса или в список сортировки добавляется другой столбец, конструктор запросов и представлений автоматически заполняет термин **Группировать** в столбце сетки **Группировать** . Выберите соответствующую агрегатную функцию.  
  
6.  Если необходимо, добавьте условия поиска для задания подмножества строк, для которых вычисляется сумма.  
  
 При выполнении запроса на панели результатов отображаются указанные статистические выражения.  
  
> [!NOTE]  
>  Конструктор запросов и представлений обслуживает агрегатные функции в инструкции, отображаемой на панели SQL до тех пор, пока режим «Группировать по» явно не будет выключен. Поэтому при изменении типа запроса или изменении состава таблиц и возвращающих табличное значение объектов, присутствующих на панелях диаграмм, конечный запрос может содержать недопустимые агрегатные функции.  
  
## <a name="see-also"></a>См. также:  
 [Сортировка и Группировка результатов запроса &#40;визуальных инструментов для баз данных&#41;](sort-and-group-query-results-visual-database-tools.md)   
 [Резюмирование результатов запросов (визуальные инструменты для баз данных)](summarize-query-results-visual-database-tools.md)  
  
  
