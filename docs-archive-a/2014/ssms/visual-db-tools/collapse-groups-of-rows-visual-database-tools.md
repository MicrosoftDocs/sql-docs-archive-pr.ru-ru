---
title: Сворачивание групп строк (визуальные инструменты для баз данных) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- group collapsing [SQL Server]
- collapsing rows
- row collapsing [SQL Server]
ms.assetid: 7338dad0-965d-44ba-8c1a-b993acb7156d
author: stevestein
ms.author: sstein
ms.openlocfilehash: f7ec2f3072f9fea7c96179934924421080e75821
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87658007"
---
# <a name="collapse-groups-of-rows-visual-database-tools"></a><span data-ttu-id="400a0-102">Сворачивание групп строк (визуальные инструменты для баз данных)</span><span class="sxs-lookup"><span data-stu-id="400a0-102">Collapse Groups of Rows (Visual Database Tools)</span></span>
  <span data-ttu-id="400a0-103">Может быть создан результат запроса, в котором каждая результирующая строка соответствует всей группе строк исходных данных.</span><span class="sxs-lookup"><span data-stu-id="400a0-103">You can create a query result in which each result row corresponds to an entire group of rows from the original data.</span></span> <span data-ttu-id="400a0-104">При сворачивании строк следует помнить о следующих моментах.</span><span class="sxs-lookup"><span data-stu-id="400a0-104">When collapsing rows, there are several things to keep in mind:</span></span>  
  
-   <span data-ttu-id="400a0-105">**Можно устранить дублирование строк** Некоторые запросы могут создавать результирующие наборы, в которых есть несколько одинаковых строк.</span><span class="sxs-lookup"><span data-stu-id="400a0-105">**You can eliminate duplicate rows** Some queries can create result sets in which multiple identical rows appear.</span></span> <span data-ttu-id="400a0-106">Например, может быть создан результирующий набор, в котором каждая строка содержит название страны и города, где проживает автор; но, если в одном городе проживает несколько авторов, будет несколько одинаковых строк.</span><span class="sxs-lookup"><span data-stu-id="400a0-106">For example, you can create a result set in which each row contains the city and state name of a city containing an author - but if a city contains several authors, there will be several identical rows.</span></span> <span data-ttu-id="400a0-107">Конечный код SQL может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="400a0-107">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state  
    FROM authors  
    ```  
  
     <span data-ttu-id="400a0-108">Результирующий набор, формируемый предыдущим запросом, не очень удобен.</span><span class="sxs-lookup"><span data-stu-id="400a0-108">The result set generated by the preceding query is not very useful.</span></span> <span data-ttu-id="400a0-109">Если в городе проживает четыре автора, результирующий набор будет включать в себя четыре одинаковые строки.</span><span class="sxs-lookup"><span data-stu-id="400a0-109">If a city contains four authors, the result set will include four identical rows.</span></span> <span data-ttu-id="400a0-110">Так как результирующий набор не включает никаких других столбцов, кроме столбцов города и страны, отличить одну строку от другой нельзя.</span><span class="sxs-lookup"><span data-stu-id="400a0-110">Since the result set does not include any columns other than city and state, there is no way to distinguish the identical rows from each other.</span></span> <span data-ttu-id="400a0-111">Одним из способов избежать повторяющихся строк является включение дополнительных столбцов, которые позволят различать строки.</span><span class="sxs-lookup"><span data-stu-id="400a0-111">One way to avoid such duplicate rows is to include additional columns that can make the rows different.</span></span> <span data-ttu-id="400a0-112">Например, если включить имя автора, каждая строка будет отличаться от всех остальных (при условии, что в городе не проживают два автора-однофамильца).</span><span class="sxs-lookup"><span data-stu-id="400a0-112">For example, if you include author name, each row will be different (provided no two like-named authors live within any one city).</span></span> <span data-ttu-id="400a0-113">Конечный код SQL может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="400a0-113">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, fname, minit, lname  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="400a0-114">Хотя предыдущий запрос позволяет обойти затруднение, в действительности он не решает проблему.</span><span class="sxs-lookup"><span data-stu-id="400a0-114">Of course, the preceding query eliminates the symptom, but does not really solve the problem.</span></span> <span data-ttu-id="400a0-115">Это значит, что в результирующем наборе нет дублированных строк, но теперь это уже не результирующий набор, относящийся к городам.</span><span class="sxs-lookup"><span data-stu-id="400a0-115">That is, the result set has no duplicates, but it is no longer a result set about cities.</span></span> <span data-ttu-id="400a0-116">Чтобы избежать повторов в исходном результирующем наборе и в то же время иметь строки, описывающие только город, можно создать запрос, возвращающий только различающиеся строки.</span><span class="sxs-lookup"><span data-stu-id="400a0-116">To eliminate duplicates in the original result set, and still have each row describe a city, you can create a query returning only distinct rows.</span></span> <span data-ttu-id="400a0-117">Конечный код SQL может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="400a0-117">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT DISTINCT city, state  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="400a0-118">Подробности об устранении повторов см. в разделе [Исключение повторяющихся строк (визуальные инструменты для баз данных)](visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="400a0-118">For details about eliminating duplicates, see [Exclude Duplicate Rows &#40;Visual Database Tools&#41;](visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="400a0-119">**Можно производить вычисления на группах строк** Это означает, что можно обобщать информацию в группах строк.</span><span class="sxs-lookup"><span data-stu-id="400a0-119">**You can calculate on groups of rows** That is, you can summarize information in groups of rows.</span></span> <span data-ttu-id="400a0-120">Например, может быть создан результирующий набор, в котором каждая строка содержит название страны и города, в котором проживает один из авторов, плюс количество авторов, проживающих в этом городе.</span><span class="sxs-lookup"><span data-stu-id="400a0-120">For example, you can create a result set in which each row contains the city and state name of a city containing an author, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="400a0-121">Конечный код SQL может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="400a0-121">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
  
    ```  
  
     <span data-ttu-id="400a0-122">Подробности о вычислении на группах строк см. в разделах [Резюмирование результатов запросов (визуальные инструменты для баз данных)](summarize-query-results-visual-database-tools.md) и [Результаты запросов сортировки и группирования (визуальные инструменты для баз данных)](sort-and-group-query-results-visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="400a0-122">For details about calculating on groups of rows, see [Summarize Query Results &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) and [Sort and Group Query Results &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="400a0-123">**Можно использовать критерии выбора для включения в группы строк** Например, может быть создан результирующий набор, в котором каждая строка содержит название страны и города, в котором проживают несколько авторов, плюс количество авторов, проживающих в этом городе.</span><span class="sxs-lookup"><span data-stu-id="400a0-123">**You can use selection criteria to include groups of rows** For example, you can create a result set in which each row contains the city and state name of a city containing several authors, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="400a0-124">Конечный код SQL может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="400a0-124">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
    HAVING COUNT(*) > 1  
  
    ```  
  
     <span data-ttu-id="400a0-125">Сведения о применении критериев выбора на группах строк см. в разделах [Задание условий для групп (визуальные инструменты для баз данных)](specify-conditions-for-groups-visual-database-tools.md) и [Использование предложения HAVING и WHERE в одном запросе (визуальные инструменты для баз данных)](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="400a0-125">For details about applying selection criteria on groups of rows, see [Specify Conditions for Groups &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) and [Use HAVING and WHERE Clauses in the Same Query &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="400a0-126">См. также:</span><span class="sxs-lookup"><span data-stu-id="400a0-126">See Also</span></span>  
 <span data-ttu-id="400a0-127">[Укажите условия поиска &#40;визуальные инструменты для баз данных&#41;](specify-search-criteria-visual-database-tools.md) </span><span class="sxs-lookup"><span data-stu-id="400a0-127">[Specify Search Criteria &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span></span>  
 [<span data-ttu-id="400a0-128">Разделы по конструированию запросов и представлений (визуальные инструменты для баз данных)</span><span class="sxs-lookup"><span data-stu-id="400a0-128">Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;</span></span>](design-queries-and-views-how-to-topics-visual-database-tools.md)  
  
  
