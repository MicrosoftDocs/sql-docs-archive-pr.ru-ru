---
title: Сопоставление данных | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: data-quality-services
ms.topic: conceptual
ms.assetid: fe66d098-bec3-4258-b42a-479ae460feb3
author: lrtoyou1223
ms.author: lle
ms.openlocfilehash: 42fcb346e46229d28c62b256d328d6af4fc6cfec
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656592"
---
# <a name="data-matching"></a><span data-ttu-id="e6b1a-102">Сопоставление данных</span><span class="sxs-lookup"><span data-stu-id="e6b1a-102">Data Matching</span></span>
  <span data-ttu-id="e6b1a-103">Процесс сопоставления данных [!INCLUDE[ssDQSnoversion](../includes/ssdqsnoversion-md.md)] (DQS) позволяет сократить дублирование данных и повысить их точность в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-103">The [!INCLUDE[ssDQSnoversion](../includes/ssdqsnoversion-md.md)] (DQS) data matching process enables you to reduce data duplication and improve data accuracy in a data source.</span></span> <span data-ttu-id="e6b1a-104">Сопоставление анализирует степень дублирования во всех записях одного источника данных, возвращая взвешенные вероятности совпадения между всеми наборами сравниваемых записей.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-104">Matching analyzes the degree of duplication in all records of a single data source, returning weighted probabilities of a match between each set of records compared.</span></span> <span data-ttu-id="e6b1a-105">Затем вы можете принять решение, какие записи совпадают, и предпринять соответствующие действия в исходных данных.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-105">You can then decide which records are matches and take the appropriate action on the source data.</span></span>

 <span data-ttu-id="e6b1a-106">Процесс сопоставления DQS имеет следующие преимущества.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-106">The DQS matching process has the following benefits:</span></span>

-   <span data-ttu-id="e6b1a-107">Сопоставление позволяет устранить различия между значениями данными, которые должны быть равны, определяя правильное значение и уменьшая риск возникновения ошибок, которые может вызвать такая разница в данных.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-107">Matching enables you to eliminate differences between data values that should be equal, determining the correct value and reducing the errors that data differences can cause.</span></span> <span data-ttu-id="e6b1a-108">К примеру, имена и адреса часто являются данными идентификации для источника данных, особенно пользовательских данных, но эти данные могут со временем стать «грязными» и устареть.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-108">For example, names and addresses are often the identifying data for a data source, particularly customer data, but the data can become dirty and deteriorate over time.</span></span> <span data-ttu-id="e6b1a-109">Выполнение сопоставления для выявления и исправления этих ошибок делает использование и обслуживание данных намного проще.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-109">Performing matching to identify and correct these errors can make data use and maintenance much easier.</span></span>

-   <span data-ttu-id="e6b1a-110">Сопоставление позволяет убедиться, что значения, которые являются эквивалентными, но введены в разных форматах или стилях, отображаются в единой форме.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-110">Matching enables you to ensure that values that are equivalent, but were entered in a different format or style, are rendered uniform.</span></span>

-   <span data-ttu-id="e6b1a-111">Сопоставление определяет точные и приблизительные совпадения, позволяя удалить повторяющиеся данные по мере их обнаружения.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-111">Matching identifies exact and approximate matches, enabling you to remove duplicate data as you define it.</span></span> <span data-ttu-id="e6b1a-112">Можно определить точку, в которой приблизительное совпадение является фактическим совпадением.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-112">You define the point at which an approximate match is in fact a match.</span></span> <span data-ttu-id="e6b1a-113">Можно определить, какие поля оцениваются для сопоставления, а какие — нет.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-113">You define which fields are assessed for matching, and which are not.</span></span>

-   <span data-ttu-id="e6b1a-114">DQS позволяет создавать политику сопоставления с помощью автоматизированного процесса, выполнить ее интерактивное изменение, исходя из результатов сопоставления, и добавить эту политику в повторно используемую базу знаний.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-114">DQS enables you to create a matching policy using a computer-assisted process, modify it interactively based upon matching results, and add it to a knowledge base that is reusable.</span></span>

-   <span data-ttu-id="e6b1a-115">Вы можете повторно проиндексировать данные, скопированные из источника в промежуточную таблицу, или не индексировать их повторно, в зависимости от состояния политики сопоставления и исходных данных.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-115">You can re-index data copied from the source to the staging table, or not re-index, depending on the state of the matching policy and the source data.</span></span> <span data-ttu-id="e6b1a-116">Производительность может улучшиться, если не индексировать данные повторно.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-116">Not re-indexing can improve performance.</span></span>

 <span data-ttu-id="e6b1a-117">Для повышения общего качества данных процесс сопоставления вы можете выполнять совместно с другими процессами очистки данных.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-117">You can perform the matching process in conjunction with other data cleansing processes to improve overall data quality.</span></span> <span data-ttu-id="e6b1a-118">Также вы можете выполнить операцию удаления дубликатов данных с помощью функциональных возможностей DQS, встроенных в Master Data Services.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-118">You can also perform data de-duplication using DQS functionality built into Master Data Services.</span></span> <span data-ttu-id="e6b1a-119">Дополнительные сведения см. в статье [Master Data Services Overview](../master-data-services/master-data-services-overview-mds.md).</span><span class="sxs-lookup"><span data-stu-id="e6b1a-119">For more information, see [Master Data Services Overview](../master-data-services/master-data-services-overview-mds.md).</span></span>

 <span data-ttu-id="e6b1a-120">На приведенном ниже рисунке отображен процесс сопоставления данных в DQS.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-120">The following illustration displays how data matching is done in DQS:</span></span>

 <span data-ttu-id="e6b1a-121">![Процесс сопоставления данных в DQS](../../2014/data-quality-services/media/dqs-matchingprocess.gif "Процесс сопоставления данных в DQS")</span><span class="sxs-lookup"><span data-stu-id="e6b1a-121">![Matching Process in DQS](../../2014/data-quality-services/media/dqs-matchingprocess.gif "Matching Process in DQS")</span></span>

##  <a name="how-to-perform-data-matching"></a><a name="How"></a><span data-ttu-id="e6b1a-122">Как выполнить сопоставление данных</span><span class="sxs-lookup"><span data-stu-id="e6b1a-122">How to Perform Data Matching</span></span>
 <span data-ttu-id="e6b1a-123">Как и в случае с процессами качества данных в DQS, сопоставление выполняется с помощью построения базы знаний и выполнения операции сопоставления в проекте служб DQS путем следующих действий.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-123">As with other data quality processes in DQS, you perform matching by building a knowledge base and executing a matching activity in a data quality project in the following steps:</span></span>

1.  <span data-ttu-id="e6b1a-124">Создание политики сопоставления в базе знаний</span><span class="sxs-lookup"><span data-stu-id="e6b1a-124">Create a matching policy in the knowledge base</span></span>

2.  <span data-ttu-id="e6b1a-125">Выполнение процесса удаления дубликатов в операции сопоставления, которая является частью проекта служб DQS.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-125">Perform a de-duplication process in a matching activity that is part of a data quality project.</span></span>

###  <a name="building-a-matching-policy"></a><a name="Policy"></a> <span data-ttu-id="e6b1a-126">Построение политики сопоставления</span><span class="sxs-lookup"><span data-stu-id="e6b1a-126">Building a Matching Policy</span></span>
 <span data-ttu-id="e6b1a-127">База знаний подготавливается для выполнения сопоставления с помощью создания политики сопоставления в базе знаний, чтобы определить, каким образом DQS назначает вероятность сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-127">You prepare the knowledge base for performing matching by creating a matching policy in the knowledge base to define how DQS assigns matching probability.</span></span> <span data-ttu-id="e6b1a-128">Политика сопоставления состоит из одного или нескольких правил сопоставления, которые определяют, какие домены будут использованы, когда DQS оценит, насколько одна запись совпадает с другой, и задаст вес, который каждое значение домена вносит в оценку сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-128">A matching policy consists of one or more matching rules that identify which domains will be used when DQS assesses how well one record matches to another, and specify the weight that each domain value carries in the matching assessment.</span></span> <span data-ttu-id="e6b1a-129">Можно задать в правиле, должны ли значения домена иметь точное совпадение или могут быть просто подобны, а также степень подобности.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-129">You specify in the rule whether domain values have to be an exact match or can just be similar, and to what degree of similarity.</span></span> <span data-ttu-id="e6b1a-130">Также можно указать, является ли совпадение домена обязательным требованием.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-130">You also specify whether a domain match is a prerequisite.</span></span>

 <span data-ttu-id="e6b1a-131">Операция политики сопоставления в мастере управления базами знаний анализирует образец данных, используя каждое правило сопоставления для одновременного сравнения двух записей по всему диапазону записей.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-131">The matching policy activity in the Knowledge Base Management wizard analyzes sample data by applying each matching rule to compare two records at a time throughout the range of records.</span></span> <span data-ttu-id="e6b1a-132">Записи, чьи показатели сопоставления больше, чем заданное минимальное значение, группируются в кластеры в результатах сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-132">Records whose matching scores are greater than a specified minimum are grouped in clusters in the matching results.</span></span> <span data-ttu-id="e6b1a-133">Эти результаты сопоставления не добавляются в базу знаний; они используются для настройки правила сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-133">These matching results are not added to the knowledge base; you use them to tune the matching rules.</span></span> <span data-ttu-id="e6b1a-134">Создание политики сопоставления может быть интерактивным процессом, в котором правила сопоставления изменяются, исходя из результатов сопоставления или статистических данных профилирования.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-134">Creating a matching policy can be an iterative process in which you modify matching rules based on the matching results or profiling statistics.</span></span>

 <span data-ttu-id="e6b1a-135">Для домена вы можете задать нормализацию строк данных при загрузке данных из источника данных в домен.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-135">You can specify for a domain that data strings will be normalized when you load data from the data source into the domain.</span></span> <span data-ttu-id="e6b1a-136">Этот процесс заключается в замене особых символов на ноль или пробел, что в большинстве случаев стирает разницу между двумя строками.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-136">This process consists of replacing special characters with a null or a space, which often removes the difference between two strings.</span></span> <span data-ttu-id="e6b1a-137">Это может повысить точность сопоставления и зачастую позволяет результатам сопоставления преодолеть минимальный порог сопоставления, что без нормализации выполнить невозможно.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-137">This can increase matching accuracy, and can often enable a matching result to surpass the minimum matching threshold, when without normalization it would not pass.</span></span>

> [!NOTE]
>  <span data-ttu-id="e6b1a-138">Значения NULL в соответствующих полях двух записей будут считаться совпадающими.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-138">Null values in the corresponding fields of two records will be considered a match.</span></span>

 <span data-ttu-id="e6b1a-139">Политика сопоставления выполняется на доменах, сопоставленных с образцами данных.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-139">The matching policy is run on domains mapped to the sample data.</span></span> <span data-ttu-id="e6b1a-140">Можно задать, будет ли выполняться копирование данных из источника данных в промежуточную таблицу, а также повторное индексирование при запуске политики сопоставления, или не будет.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-140">You can specify whether data is copied from the data source into the staging table and re-indexed when you run the matching policy, or not.</span></span> <span data-ttu-id="e6b1a-141">Это вы можете сделать, как при создании базы знаний, так и при запуске проекта сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-141">You can do so both when building the knowledge base and when running the matching project.</span></span> <span data-ttu-id="e6b1a-142">Отказ от повторной индексации может привести к улучшению производительности.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-142">Not re-indexing could result in improved performance.</span></span> <span data-ttu-id="e6b1a-143">Повторная индексация не требуется, когда выполняются следующие условия: политика сопоставления не изменялась, не обновлялся источник данных, не выполнялось повторное сопоставление политики, не был выбран новый источник данных, а также не выполнялось сопоставление с одним или несколькими новыми доменами.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-143">Re-indexing is not necessary if the following is true: the matching policy has not changed, and you have not updated the data source, remapped the policy, selected a new data source, or mapped one or more new domains.</span></span>

 <span data-ttu-id="e6b1a-144">Каждое правило сопоставления при его создании сохраняется в базе знаний.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-144">Each matching rule is saved in the knowledge base when it is created.</span></span> <span data-ttu-id="e6b1a-145">Однако база знаний доступна для использования в проекте служб DQS только тогда, когда она опубликована.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-145">However, a knowledge base is available for use in a data quality project only when it is published.</span></span> <span data-ttu-id="e6b1a-146">Кроме того, пока база знаний не опубликована, правила сопоставления в них не могут быть изменены пользователем, который не является создателем.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-146">In addition, until the knowledge base is published, the matching rules in it cannot be changed by a user other than the person who created it.</span></span>

###  <a name="running-a-matching-project"></a><a name="Project"></a> <span data-ttu-id="e6b1a-147">Запуск проекта сопоставления</span><span class="sxs-lookup"><span data-stu-id="e6b1a-147">Running a Matching Project</span></span>
 <span data-ttu-id="e6b1a-148">DQS выполняет удаление дубликатов данных, сравнивая каждую строку в исходных данных с каждой другой строкой с помощью политики сопоставления, определенной в базе знаний, и задавая вероятность того, что строки совпадают.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-148">DQS performs data de-duplication by comparing each row in the source data to every other row, using the matching policy defined in the knowledge base, and producing a probability that the rows are a match.</span></span> <span data-ttu-id="e6b1a-149">Это делается в проекте служб DQS с типом «Сопоставление».</span><span class="sxs-lookup"><span data-stu-id="e6b1a-149">This is done in a data quality project with a type of Matching.</span></span> <span data-ttu-id="e6b1a-150">Сопоставление является одним из основных действий в проекте служб DQS.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-150">Matching is one of the major steps in a data quality project.</span></span> <span data-ttu-id="e6b1a-151">Оно выполняется наилучшим образом после очистки данных так, чтобы в сопоставляемых данных не было ошибок.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-151">It is best performed after data cleansing, so that the data to be matched is free from error.</span></span> <span data-ttu-id="e6b1a-152">Перед тем как запустить процесс сопоставления, можно экспортировать результаты проекта очистки в таблицу данных или CSV-файл, а затем создать проект сопоставления, в котором можно сопоставить результаты очистки с доменами в проекте сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-152">Before running a matching process, you can export the results of the cleansing project into a data table or .csv file, and then create a matching project in which you map the cleansing results to domains in the matching project.</span></span>

 <span data-ttu-id="e6b1a-153">Проект сопоставления данных состоит из автоматизированного и интерактивного процесса.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-153">A data matching project consists of a computer-assisted process and an interactive process.</span></span> <span data-ttu-id="e6b1a-154">Проект сопоставления применяет правила сопоставления в политике сопоставления к оцениваемому источнику данных.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-154">The matching project applies the matching rules in the matching policy to the data source to be assessed.</span></span> <span data-ttu-id="e6b1a-155">Этот процесс оценивает вероятность того, что любые две строки совпадают по показателю сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-155">This process assesses the likelihood that any two rows are matches in a matching score.</span></span> <span data-ttu-id="e6b1a-156">Совпадающими считаются только записи с вероятностью совпадения большей, чем значение, установленное администратором данных в политике сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-156">Only those records with a probability of a match greater than a value set by the data steward in the matching policy will be considered a match.</span></span>

 <span data-ttu-id="e6b1a-157">При выполнении анализа сопоставления служба DQS создает кластеры записей, которые эта служба считает совпадающими.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-157">When DQS performs the matching analysis, it creates clusters of records that DQS considers matches.</span></span> <span data-ttu-id="e6b1a-158">DQS произвольно определяет одну из записей в каждом кластере в качестве сводной или старшей записи.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-158">DQS randomly identifies one of the records in each cluster as the pivot, or leading, record.</span></span> <span data-ttu-id="e6b1a-159">Администратор данных проверяет результаты сопоставления и отвергает любые записи, которые являются неподходящим совпадением для кластера.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-159">The data steward verifies the matching results, and rejects any record that is not an appropriate match for a cluster.</span></span> <span data-ttu-id="e6b1a-160">Затем администратор данных выбирает правило выживания, которое DQS будет использовать для определения записи, успешно прошедшей процесс сопоставления, и замены записи сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-160">The data steward then selects a survivorship rule that DQS will use to determine the record that will survive the matching process and replace the matching records.</span></span> <span data-ttu-id="e6b1a-161">Правилом выживания может быть "Сводная запись" (по умолчанию), "наиболее полная и длинная запись", "наиболее полная запись" или "наиболее длинная запись".</span><span class="sxs-lookup"><span data-stu-id="e6b1a-161">The survivorship rule can be "Pivot record" (the default), "most complete and longest record", "most complete record", or "longest record".</span></span> <span data-ttu-id="e6b1a-162">Служба DQS определяет «выжившую» (старшую) запись в каждом кластере, исходя из чего определяется запись, которая наилучшим образом соответствует критерию правила выживания.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-162">DQS determines the survivor (leading) record in each cluster based upon which record most closely matches the criteria or criterion in the survivorship rule.</span></span> <span data-ttu-id="e6b1a-163">Если несколько записей в данном кластере соблюдают правило выживания, DQS случайным образом выбирает одну из этих записей.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-163">If multiple records in a given cluster comply with the survivorship rule, DQS selects one of those records randomly.</span></span> <span data-ttu-id="e6b1a-164">DQS предлагает осуществить выбор единственного кластера из отображаемых кластеров с общими записями, выбрав параметр "Показать неперекрывающиеся кластеры".</span><span class="sxs-lookup"><span data-stu-id="e6b1a-164">DQS gives you the choice of displaying clusters that have records in common as a single cluster by selecting "show non-overlapping clusters".</span></span> <span data-ttu-id="e6b1a-165">Для отображения результатов в соответствии с этим параметром необходимо выполнить процесс сопоставления.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-165">You must execute the matching process in order to display the results according to this setting.</span></span>

 <span data-ttu-id="e6b1a-166">Вы можете экспортировать результаты процесса сопоставления в таблицу SQL Server или CSV-файл.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-166">You can export the results of the matching process either to a SQL Server table or a .csv file.</span></span> <span data-ttu-id="e6b1a-167">Экспортировать результаты сопоставления вы можете в двух форматах: первый — совпадающие и несовпадающие записи; второй — «выжившие» записи, которые содержат только «выжившую» запись для кластера, и несовпадающие результаты.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-167">You can export matching results in two forms: first, the matched records and the unmatched records, or second, survivorship records that include only the survivor record for a cluster and the unmatched results.</span></span> <span data-ttu-id="e6b1a-168">При использовании правила выживания записей, если одна и та же запись определена как «выжившая» для нескольких кластеров, она будет экспортирована только один раз.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-168">In the survivorship records, if the same record is identified as the survivor for multiple clusters, that record will only be exported once.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="e6b1a-169">в этом разделе</span><span class="sxs-lookup"><span data-stu-id="e6b1a-169">In This Section</span></span>
 <span data-ttu-id="e6b1a-170">Можно выполнять следующие задачи, связанные с сопоставлением в службах DQS.</span><span class="sxs-lookup"><span data-stu-id="e6b1a-170">You can perform the following tasks related to matching in DQS:</span></span>

|||
|-|-|
|<span data-ttu-id="e6b1a-171">Создание и тестирование правил сопоставления в политике сопоставления</span><span class="sxs-lookup"><span data-stu-id="e6b1a-171">Create and test matching rules in a matching policy</span></span>|[<span data-ttu-id="e6b1a-172">Создание политики сопоставления</span><span class="sxs-lookup"><span data-stu-id="e6b1a-172">Create a Matching Policy</span></span>](../../2014/data-quality-services/create-a-matching-policy.md)|
|<span data-ttu-id="e6b1a-173">Запуск сопоставления в проекте служб DQS</span><span class="sxs-lookup"><span data-stu-id="e6b1a-173">Run matching in a data quality project</span></span>|[<span data-ttu-id="e6b1a-174">Запуск проекта сопоставления</span><span class="sxs-lookup"><span data-stu-id="e6b1a-174">Run a Matching Project</span></span>](../../2014/data-quality-services/run-a-matching-project.md)|


