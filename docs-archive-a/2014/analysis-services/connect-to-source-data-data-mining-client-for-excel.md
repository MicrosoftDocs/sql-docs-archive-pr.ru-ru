---
title: Подключение к источнику данных (клиент интеллектуального анализа данных для Excel) | Документация Майкрософт
ms.custom: ''
ms.date: 12/29/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- connections
ms.assetid: 548672ce-e403-4aca-b67a-c2c797f053dd
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4b4759d94043fdccacdf5b285de50697a18965e8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656711"
---
# <a name="connect-to-source-data-data-mining-client-for-excel"></a>Подключение к источнику данных (клиент интеллектуального анализа данных для Excel)
  В этом разделе описано, как создавать и использовать новые соединения, используемые для хранения моделей интеллектуального анализа данных, а также для доступа к внешним данным, хранящимся в [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].  
  
 **Подключения интеллектуального анализа данных.** Созданное при запуске надстроек первоначальное соединение используется для доступа к алгоритмам, анализа данных и сохранения моделей и структур интеллектуального анализа данных.  
  
 Требуется подключение к экземпляру [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] для использования средств визуализации и моделирования в надстройках, поскольку надстройки зависят от алгоритмов и структур данных, предоставляемых службами [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].  
  
 **Подключения к внешним источникам данных.** Можно также создавать подключения к внешним источникам данных при построении моделей или сохранении результатов. Например, можно создать модель интеллектуального анализа данных на одном сервере, а затем выполнить прогнозирующий запрос к этой модели интеллектуального анализа данных, используя данные, хранимые на другом экземпляре служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], в таблице Excel или во внешнем источнике данных, таком как [!INCLUDE[msCoName](../includes/msconame-md.md)] Access. Каждый раз при обращении к новому источнику данных будет появляться диалоговое окно с предложением создать соединение.  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq2"></a> Предварительные требования  
 Эта версия надстройки требует, чтобы ваш экземпляр [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] был на основе SQL Server 2012. Если требуется подключиться к более ранней версии служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], имеется отдельная версия этих надстроек. Существуют версии надстроек, которые поддерживают SQL Server 2005, SQL Server 2008 и SQL Server 2008 R2.  
  
 Чтобы установить соединение с базой данных [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], необходимо наличие разрешений на доступ к серверу баз данных. Кроме того, необходимо включить сеансы интеллектуального анализа данных и иметь разрешения на чтение или чтение и запись объектов базы данных, сохраненных на сервере.  
  
##  <a name="creating-data-mining-server-connections"></a><a name="bkmk_connect"></a>Создание подключений к серверу интеллектуального анализа данных  
 Группа **соединений** в клиенте интеллектуального анализа данных для Excel и средства анализа таблиц для Excel предоставляет средства для управления соединениями с экземпляром служб [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] .  
  
-   Можно создать соединение при установке надстройки или добавить его позже.  
  
-   Можно создать несколько соединений и менять их в любое время, кроме случаев, когда запущен процесс создания или отправки запросов к модели.  
  
     Не изменяйте и не закрывайте подключение во время обработки модели интеллектуального анализа данных. Модель интеллектуального анализа данных может потерять данные или стать непригодной для использования.  
  
-   Только одно соединение может быть активно одновременно.  
  
### <a name="connections-in-the-excel-add-ins"></a>Соединения в надстройках Excel  
 Группа **Connections** в клиенте интеллектуального анализа данных для Excel и средства анализа таблиц для Excel — это место, где вы управляете соединениями с экземпляром [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] .  
  
##### <a name="create-a-new-server-connection-in-the-excel-add-ins"></a>Создание нового соединения с сервером в надстройках Excel  
  
1.  Нажмите кнопку **Connection (соединение** ) на ленте **анализ** или **интеллектуального анализа данных** .  
  
    > [!NOTE]  
    >  Надпись на кнопке указывает наличие соединения. Если на листе не установлено соединение, кнопка содержит текст " \<No connection> ." Если подключение было ранее установлено в книге, в кнопке появится имя этого соединения.  
  
2.  В диалоговом окне **Analysis Services соединения** нажмите кнопку **создать**.  
  
3.  В диалоговом окне **новое подключение Analysis Services** введите имя сервера.  
  
4.  Выберите метод проверки подлинности.  
  
5.  Выберите базу данных из раскрывающегося списка **имя каталога** . Если на экземпляре не существует базы данных, выберите **значение (по умолчанию)**.  
  
6.  Введите понятное имя для соединения.  
  
7.  Нажмите кнопку **проверить подключение** , чтобы убедиться, что сервер и база данных доступны.  
  
8.  Нажмите кнопку **ОК**, затем кнопку **Закрыть**.  
  
### <a name="connections-using-a-web-service"></a>Соединения с использованием веб-службы  
 При использовании архитектуры тонкого клиента, разрешающей просмотр кубов и данных служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], можно также настроить соединение с сервером служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] с помощью веб-служб. Дополнительные сведения об определении веб-клиента см. в электронной документации по [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].  
  
 При наличии доступа к серверу, настроенному для веб-служб, тип соединения можно указать при первом создании соединения.  
  
##### <a name="create-an-http-connection-to-analysis-services"></a>Создание HTTP-соединения со службами Analysis Services  
  
1.  Откройте диалоговое окно **Создание соединения Analysis Services** .  
  
2.  В качестве имени введите http:// и URL-адрес сервера служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].  
  
3.  Введите имя пользователя и пароль, необходимые для доступа к веб-службе.  
  
### <a name="connections-in-the-visio-add-in"></a>Соединения в надстройке Visio  
 В отличие от Excel, программа Visio не содержит ленты средств и кнопок, специально предназначенных для создания и наблюдения за соединением. Вместо этого подключение к данным создается при первоначальном выборе фигуры интеллектуального анализа данных и перетаскивании ее на страницу Visio. Мастер предложит выбрать модель для фигуры и задать другие параметры.  
  
 Если ранее использовались соединения с источниками данных служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] в Excel, эти соединения будут перечислены в списке источников данных для выбора.  
  
##### <a name="create-a-connection-for-a-visio-shape"></a>Создание соединения для фигуры Visio  
  
1.  Откройте шаблон интеллектуального анализа данных и выберите одну из фигур интеллектуального анализа данных.  
  
2.  Перетащите эту фигуру на пустую страницу.  
  
3.  В диалоговом окне **Выбор источника данных** выберите из списка источник данных или нажмите кнопку **создать**.  
  
4.  Если выбран вариант **создать**, выполните процедуру, описанную выше, чтобы указать имя сервера и каталога или подключиться через веб-службу.  
  
##  <a name="changing-connections"></a><a name="bkmk_change"></a>Изменение подключений  
 Можно создать несколько соединений на одном листе, но одновременно может быть активно только одно соединение. Имя текущего соединения отображается в кнопке **Подключение** .  
  
 В клиенте интеллектуального анализа данных для Excel можно также проверить строку подключения и состояние текущего соединения, щелкнув **Трассировка** , а затем выбрав **текущее соединение**.  
  
#### <a name="use-a-different-server-connection"></a>Используйте другое соединение с сервером  
  
1.  Щелкните **Подключение**.  
  
2.  В области **подключения Analysis Services** выберите соединение из списка **другие подключения** и щелкните **сделать текущим**.  
  
3.  Нажмите кнопку **проверить подключение** , чтобы убедиться, что подключение доступно.  
  
 После завершения обработки модели интеллектуального анализа данных результаты сохраняются на локальном компьютере и на них не повлияет завершение соединения с одним сервером и подключение к другому. Однако надо избегать смены или завершения соединения во время обработки модели интеллектуального анализа данных, так как это может повредить данные.  
  
#### <a name="modify-an-existing-server-connection"></a>Изменение существующего соединения с сервером.  
  
1.  Нельзя изменить существующее соединение. Если необходимо подключиться к другой базе данных или к другому серверу, необходимо создать новое соединение.  
  
2.  Если необходимо изменить строку подключения, чтобы увеличить время ожидания запроса или добавить другие параметры, относящиеся к экземпляру [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], одно из возможных решений — изменить DMC-файл, в котором хранится строка подключения.  
  
     \<drive:>\\ \> Надстройка интеллектуального анализа данных \Users<myusername \аппдата\локал\микрософт\дата  
  
##  <a name="connecting-to-external-data-sources"></a><a name="bkmk_extconnections"></a>Подключение к внешним источникам данных  
 В то время как средства на ленте « **анализ** » работают исключительно с данными в Excel, средства на ленте **интеллектуального анализа данных** позволяют подключаться непосредственно к внешним источникам данных для использования в качестве входных для модели или для выборки.  
  
 Следующие средства в этих надстройках поддерживают использование внешних данных для интеллектуального анализа.  
  
-   [Примеры &#40;данных SQL Server надстройки интеллектуального анализа данных&#41;](sample-data-sql-server-data-mining-add-ins.md)  
  
-   [Мастер классификации &#40;надстройки интеллектуального анализа данных для Excel&#41;](classify-wizard-data-mining-add-ins-for-excel.md)  
  
-   [Мастер оценки &#40;надстройки интеллектуального анализа данных для Excel&#41;](estimate-wizard-data-mining-add-ins-for-excel.md)  
  
-   [Мастер кластеров &#40;надстройки интеллектуального анализа данных для Excel&#41;](cluster-wizard-data-mining-add-ins-for-excel.md)  
  
-   [Мастер прогнозов &#40;надстройки интеллектуального анализа данных для Excel&#41;](forecast-wizard-data-mining-add-ins-for-excel.md)  
  
-   [Создание структуры интеллектуального анализа &#40;SQL Server надстроек интеллектуального анализа данных&#41;](create-mining-structure-sql-server-data-mining-add-ins.md)  
  
-   [Диаграмма точности &#40;SQL Server надстроек интеллектуального анализа данных&#41;](accuracy-chart-sql-server-data-mining-add-ins.md)  
  
-   [Диаграмма роста прибыли &#40;SQL Server надстройки интеллектуального анализа данных&#41;](profit-chart-sql-server-data-mining-add-ins.md)  
  
-   [Матрица классификации &#40;SQL Server надстройки интеллектуального анализа данных&#41;](classification-matrix-sql-server-data-mining-add-ins.md)  
  
### <a name="using-analysis-services-as-a-data-source"></a>Использование служб Analysis Services в качестве источника данных  
 Нельзя напрямую получать доступ к данным, сохраненным в кубе или в табличной модели [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]. Вместо этого создайте соединение в Excel с сервером [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] и используйте данные для создания модели.  
  
### <a name="relational-data-sources"></a>Реляционные источники данных  
 Если нужно использовать данные из реляционного источника в качестве вводных данных для модели, можно подключиться к следующим версиям SQL Server:  
  
-   SQL Server 2008  
  
-   SQL Server 2008 R2  
  
-   SQL Server 2012  
  
 Также можно получить данные из любого реляционного источника данных, которые поддерживается в качестве источника данных в [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]. Дополнительные сведения о поддерживаемых источниках данных см. [в разделе источники данных в многомерных моделях](multidimensional-models/data-sources-in-multidimensional-models.md) .  
  
 Обратите внимание, что следующие типы данных нельзя использовать для интеллектуального анализа данных. При включении этих данных в процесс создания модели возникнет ошибка.  
  
-   ntext  
  
-   binary  
  
## <a name="see-also"></a>См. также:  
 [Трассировка &#40;клиента интеллектуального анализа данных для Excel&#41;](trace-data-mining-client-for-excel.md)  
  
  
