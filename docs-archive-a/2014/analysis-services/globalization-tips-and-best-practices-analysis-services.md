---
title: Советы и рекомендации по глобализации (Analysis Services) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- translations [Analysis Services], client applications
- date comparisons
- day-of-week comparisons [Analysis Services]
- time [Analysis Services]
- month comparisons [Analysis Services]
ms.assetid: 71a8c438-1370-4c69-961e-d067ee4e47c2
author: minewiskan
ms.author: owend
ms.openlocfilehash: c5bf99878a08e3d2ca57b76e3f902fded2099381
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87668497"
---
# <a name="globalization-tips-and-best-practices-analysis-services"></a><span data-ttu-id="0fa12-102">Советы и рекомендации по глобализации (службы Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="0fa12-102">Globalization Tips and Best Practices (Analysis Services)</span></span>
  <span data-ttu-id="0fa12-103">**[!INCLUDE[applies](../includes/applies-md.md)]** Только многомерные</span><span class="sxs-lookup"><span data-stu-id="0fa12-103">**[!INCLUDE[applies](../includes/applies-md.md)]**  Multidimensional only</span></span>  
  
 <span data-ttu-id="0fa12-104">Эти советы и рекомендации помогут улучшить переносимость решений для бизнес-аналитики и избежать ошибок, которые непосредственно связаны с языковыми параметрами и параметрами сортировки.</span><span class="sxs-lookup"><span data-stu-id="0fa12-104">These tips and guidelines can help increase the portability of your business intelligence solutions and avoid errors that are directly related to language and collation settings.</span></span>  
  
-   [<span data-ttu-id="0fa12-105">Использование одинаковых параметров сортировки во всем стеке</span><span class="sxs-lookup"><span data-stu-id="0fa12-105">Use similar collations throughout the stack</span></span>](#bkmk_sameColl)  
  
-   [<span data-ttu-id="0fa12-106">Общие рекомендации по параметрам сортировки</span><span class="sxs-lookup"><span data-stu-id="0fa12-106">Common collation recommendations</span></span>](#bkmk_recos)  
  
-   [<span data-ttu-id="0fa12-107">Чувствительность к регистру идентификаторов объектов</span><span class="sxs-lookup"><span data-stu-id="0fa12-107">Case sensitivity of object identifiers</span></span>](#bkmk_objid)  
  
-   [<span data-ttu-id="0fa12-108">Тестирование языкового стандарта с помощью Excel и SQL Server Profiler</span><span class="sxs-lookup"><span data-stu-id="0fa12-108">Locale testing using Excel and SQL Server Profiler</span></span>](#bkmk_test)  
  
-   [<span data-ttu-id="0fa12-109">Написание запросов многомерных выражений в решении, содержащем переводы</span><span class="sxs-lookup"><span data-stu-id="0fa12-109">Writing MDX queries in a solution containing Translations</span></span>](#bkmk_mdx)  
  
-   [<span data-ttu-id="0fa12-110">Написание запросов многомерных выражений, содержащих значения даты и времени</span><span class="sxs-lookup"><span data-stu-id="0fa12-110">Writing MDX queries containing Date and Time Values</span></span>](#bkmk_datetime)  
  
##  <a name="use-similar-collations-throughout-the-stack"></a><a name="bkmk_sameColl"></a><span data-ttu-id="0fa12-111">Использовать аналогичные параметры сортировки во всем стеке</span><span class="sxs-lookup"><span data-stu-id="0fa12-111">Use similar collations throughout the stack</span></span>  
 <span data-ttu-id="0fa12-112">Если это возможно, попробуйте использовать те же параметры сортировки в [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] , которые применяются для компонента Database Engine, чтобы добиться соответствия чувствительности к ширине, регистру и диакритическим знакам.</span><span class="sxs-lookup"><span data-stu-id="0fa12-112">If possible, try to use the same collation settings in [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] that you use for the database engine, striving for correspondence in width-sensitivity and case-sensitivity, and access-sensitivity.</span></span>  
  
 <span data-ttu-id="0fa12-113">Каждая служба имеет свои собственные параметры сортировки. По умолчанию для ядра СУБД используется SQL_Latin1_General_CP1_CI_AS, а для Analysis Services — Latin1_General_AS.</span><span class="sxs-lookup"><span data-stu-id="0fa12-113">Each service has its own collation settings, with the database engine default set to SQL_Latin1_General_CP1_CI_AS and Analysis Services set to Latin1_General_AS.</span></span> <span data-ttu-id="0fa12-114">Значения по умолчанию совместимы с точки зрения чувствительности к регистру, ширине и диакритическим знакам.</span><span class="sxs-lookup"><span data-stu-id="0fa12-114">The defaults are compatible in term of case, width, and accent sensitivity.</span></span> <span data-ttu-id="0fa12-115">Помните, что, если изменить какие-либо параметры сортировки, могут возникнуть проблемы, если свойства параметров сортировки существенно отличаются.</span><span class="sxs-lookup"><span data-stu-id="0fa12-115">Be forewarned that if you vary the settings of either collation, you can run into problems when the collation properties diverge in fundamental ways.</span></span>  
  
 <span data-ttu-id="0fa12-116">Даже если параметры сортировки функционально эквивалентны, может возникнуть особый случай, где пустое место в любом месте строки интерпретируется каждой службой по-разному.</span><span class="sxs-lookup"><span data-stu-id="0fa12-116">Even when collation settings are functionally equivalent, you can run into a special case where an empty space anywhere within a string is interpreted differently by each service.</span></span>  
  
 <span data-ttu-id="0fa12-117">Символ пробела — это особый случай, так как он может быть представлен однобайтовым (SBCS) или двухбайтовым (DBCS) набором символов в кодировке Юникод.</span><span class="sxs-lookup"><span data-stu-id="0fa12-117">The space character is a 'special case' because it can be represented as a single-byte (SBCS) or double-byte character set (DBCS) in Unicode.</span></span> <span data-ttu-id="0fa12-118">В реляционном механизме две составные строки, разделенные пробелом (одна из которых использует SBCS, а другая —DBCS), считаются идентичными.</span><span class="sxs-lookup"><span data-stu-id="0fa12-118">In the relational engine, two compound strings separated by a space -- one using SBCS, the other in DBCS -- are considered identical.</span></span> <span data-ttu-id="0fa12-119">Во время обработки в службах Analysis Services те же составные строки не совпадают, а второй экземпляр будет отмечен как дубликат.</span><span class="sxs-lookup"><span data-stu-id="0fa12-119">In Analysis Services, during processing, the same two compound strings are not identical, and the second instance will be flagged as a duplicate.</span></span>  
  
 <span data-ttu-id="0fa12-120">Дополнительные сведения и рекомендуемые пути устранения проблем см. в разделе [Пробелы в строке Юникода обрабатываются по-разному в зависимости от параметров сортировки](https://social.technet.microsoft.com/wiki/contents/articles/23979.ssas-processing-error-blanks-in-a-unicode-string-have-different-processing-outcomes-based-on-collation-and-character-set.aspx).</span><span class="sxs-lookup"><span data-stu-id="0fa12-120">For more details and suggested workarounds, see [Blanks in a Unicode string have different processing outcomes based on collation](https://social.technet.microsoft.com/wiki/contents/articles/23979.ssas-processing-error-blanks-in-a-unicode-string-have-different-processing-outcomes-based-on-collation-and-character-set.aspx).</span></span>  
  
##  <a name="common-collation-recommendations"></a><a name="bkmk_recos"></a> <span data-ttu-id="0fa12-121">Общие рекомендации для параметров сортировки</span><span class="sxs-lookup"><span data-stu-id="0fa12-121">Common collation recommendations</span></span>  
 <span data-ttu-id="0fa12-122">В Analysis Services всегда представлен полный список всех доступных языков и параметров сортировки; список параметров сортировки не отфильтровывается в зависимости от выбранного языка.</span><span class="sxs-lookup"><span data-stu-id="0fa12-122">Analysis Services always presents the full list of all available languages and collations; it does not filter the collations based on the language you selected.</span></span> <span data-ttu-id="0fa12-123">Обязательно выберите пригодное для работы сочетание.</span><span class="sxs-lookup"><span data-stu-id="0fa12-123">Be sure to choose a workable combination.</span></span>  
  
 <span data-ttu-id="0fa12-124">Некоторые из наиболее часто используемых параметров сортировки перечислены в следующем списке.</span><span class="sxs-lookup"><span data-stu-id="0fa12-124">Some of the more commonly used collations include those in the following list.</span></span>  
  
 <span data-ttu-id="0fa12-125">Этот список следует считать основой для дальнейшей работы, но не окончательной рекомендацией, исключающей другие варианты.</span><span class="sxs-lookup"><span data-stu-id="0fa12-125">You should consider this list to be a starting point for further investigation, rather than a definitive recommendation that excludes other options.</span></span> <span data-ttu-id="0fa12-126">Может оказаться, что для ваших данных лучше всего подходят параметры сортировки, не рекомендованные явным образом.</span><span class="sxs-lookup"><span data-stu-id="0fa12-126">You might find that a collation not specifically recommended is the one that works best for your data.</span></span> <span data-ttu-id="0fa12-127">Тщательное тестирование является единственным способом проверить правильность сортировки и сравнения данных.</span><span class="sxs-lookup"><span data-stu-id="0fa12-127">Thorough testing is the only way to verify whether data values are sorted and compared appropriately.</span></span> <span data-ttu-id="0fa12-128">При тестировании параметров сортировки всегда запускайте нагрузку по обработке и по запросам.</span><span class="sxs-lookup"><span data-stu-id="0fa12-128">As always, be sure to run both processing and query workloads when testing collation.</span></span>  
  
-   <span data-ttu-id="0fa12-129">Latin1_General_100_AS часто используется для приложений, использующих 26 букв [основного латинского алфавита ISO](http://en.wikipedia.org/wiki/ISO_basic_Latin_alphabet).</span><span class="sxs-lookup"><span data-stu-id="0fa12-129">Latin1_General_100_AS is often used for applications that use the 26 characters of the [ISO basic Latin alphabet](http://en.wikipedia.org/wiki/ISO_basic_Latin_alphabet).</span></span>  
  
-   <span data-ttu-id="0fa12-130">В языках стран Северной Европы, где встречаются скандинавские буквы (например, ø), можно использовать Finnish_Swedish_100.</span><span class="sxs-lookup"><span data-stu-id="0fa12-130">North European languages that include Scandinavian letters (such as ø) can use Finnish_Swedish_100.</span></span>  
  
-   <span data-ttu-id="0fa12-131">В языках Восточной Европы, например в русском, часто используется Cyrillic_General_100.</span><span class="sxs-lookup"><span data-stu-id="0fa12-131">East European languages, such as Russian, often use Cyrillic_General_100.</span></span>  
  
-   <span data-ttu-id="0fa12-132">Китайский язык и параметры сортировки различаются в зависимости от региона, но чаще всего это либо китайский (упрощенное письмо), либо китайский (традиционное письмо).</span><span class="sxs-lookup"><span data-stu-id="0fa12-132">Chinese language and collations vary by region, but are generally either Chinese Simplified or Chinese Traditional.</span></span>  
  
     <span data-ttu-id="0fa12-133">В КНР и Сингапуре служба поддержки Майкрософт обычно применяет китайский (упрощенное письмо) и порядок сортировки пиньинь.</span><span class="sxs-lookup"><span data-stu-id="0fa12-133">In PRC and Singapore, Microsoft Support tends to see Simplified Chinese, with Pinyin as the preferred sort order.</span></span> <span data-ttu-id="0fa12-134">Рекомендуемые параметры сортировки: Chinese_PRC (для SQL Server 2000), Chinese_PRC_90 (для SQL Server 2005) или Chinese_Simplified_Pinyin_100 (SQL Server 2008 и более поздних версий).</span><span class="sxs-lookup"><span data-stu-id="0fa12-134">The recommended collations are Chinese_PRC (for SQL Server 2000), Chinese_PRC_90 (for SQL Server 2005) or Chinese_Simplified_Pinyin_100 (for SQL Server 2008 and later).</span></span>  
  
     <span data-ttu-id="0fa12-135">На Тайване чаще используется китайский (традиционное письмо), а порядок сортировки основывается на количестве штрихов: Chinese_Taiwan_Stroke (для SQL Server 2000), Chinese_Taiwan_Stroke_90 (для SQL Server 2005) или Chinese_Traditional_Stroke_Count_100 (для SQL Server 2008 и более поздних версий).</span><span class="sxs-lookup"><span data-stu-id="0fa12-135">In Taiwan, it is more common to see Traditional Chinese with the recommended sort order is based on Stroke Count: Chinese_Taiwan_Stroke (for SQL Server 2000), Chinese_Taiwan_Stroke_90 (for SQL Server 2005) or Chinese_Traditional_Stroke_Count_100 (for SQL Server 2008 and later).</span></span>  
  
     <span data-ttu-id="0fa12-136">Другие регионы (например, Гонконг, САР и Макао) также используют традиционный китайский.</span><span class="sxs-lookup"><span data-stu-id="0fa12-136">Other regions (such as Hong Kong SAR and Macao SAR) also use Traditional Chinese.</span></span> <span data-ttu-id="0fa12-137">Для сортировке в Гонконге часто используется Chinese_Hong_Kong_Stroke_90 (в SQL Server 2005).</span><span class="sxs-lookup"><span data-stu-id="0fa12-137">For collations, in Hong Kong, it's not unusual to see Chinese_Hong_Kong_Stroke_90 (on SQL Server 2005).</span></span> <span data-ttu-id="0fa12-138">В Макао Chinese_Traditional_Stroke_Count_100 (в SQL Server 2008 и более поздних версиях) используется довольно часто.</span><span class="sxs-lookup"><span data-stu-id="0fa12-138">In Macao, Chinese_Traditional_Stroke_Count_100 (on SQL Server 2008 and later) is used fairly often.</span></span>  
  
-   <span data-ttu-id="0fa12-139">Для японского языка наиболее часто используется Japanese_CI_AS.</span><span class="sxs-lookup"><span data-stu-id="0fa12-139">For Japanese, the most commonly used collation is Japanese_CI_AS.</span></span> <span data-ttu-id="0fa12-140">Japanese_XJIS_100 применяется в установках, поддерживающих [JIS2004](http://en.wikipedia.org/wiki/JIS_X_0213).</span><span class="sxs-lookup"><span data-stu-id="0fa12-140">Japanese_XJIS_100 is used in installations supporting [JIS2004](http://en.wikipedia.org/wiki/JIS_X_0213).</span></span> <span data-ttu-id="0fa12-141">Japanese_BIN2 обычно применяется в проектах миграции данных, где исходные данные получены с платформ, отличных от Windows, или из источников данных, отличных от реляционной СУБД SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0fa12-141">Japanese_BIN2 is typically seen in data migration projects, with data originating from non-Windows platforms, or from data sources other than the SQL Server relational database engine.</span></span>  
  
     <span data-ttu-id="0fa12-142">Japanese_Bushu_Kakusu_100 редко встречается на серверах с Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="0fa12-142">Japanese_Bushu_Kakusu_100 is rarely seen in servers that run Analysis Services workloads.</span></span>  
  
-   <span data-ttu-id="0fa12-143">Для корейского языка рекомендуется использовать Korean_100.</span><span class="sxs-lookup"><span data-stu-id="0fa12-143">Korean_100 is recommended for Korean.</span></span> <span data-ttu-id="0fa12-144">В списке есть и Korean_Wansung_Unicode, но эта сортировка считается устаревшей.</span><span class="sxs-lookup"><span data-stu-id="0fa12-144">Although Korean_Wansung_Unicode is still available in the list, it has been deprecated.</span></span>  
  
##  <a name="case-sensitivity-of-object-identifiers"></a><a name="bkmk_objid"></a> <span data-ttu-id="0fa12-145">Чувствительность к регистру идентификаторов объекта</span><span class="sxs-lookup"><span data-stu-id="0fa12-145">Case sensitivity of object identifiers</span></span>  
 <span data-ttu-id="0fa12-146">Начиная с SQL Server 2012 SP2 учет регистра идентификаторов объектов применяется независимо от параметров сортировки, но поведение зависит от языка.</span><span class="sxs-lookup"><span data-stu-id="0fa12-146">Starting in SQL Server 2012 SP2, case sensitivity of object IDs is enforced independently of the collation, but the behavior varies by language:</span></span>  
  
|<span data-ttu-id="0fa12-147">Набор знаков</span><span class="sxs-lookup"><span data-stu-id="0fa12-147">Language script</span></span>|<span data-ttu-id="0fa12-148">Чувствительность к регистру</span><span class="sxs-lookup"><span data-stu-id="0fa12-148">Case sensitivity</span></span>|  
|---------------------|----------------------|  
|<span data-ttu-id="0fa12-149">**Основной латинский алфавит**</span><span class="sxs-lookup"><span data-stu-id="0fa12-149">**Basic Latin alphabet**</span></span>|<span data-ttu-id="0fa12-150">Идентификаторы объектов, выраженные латинским алфавитом (любой из 26 английских символов верхнего или нижнего регистра), обрабатываются без учета регистра независимо от параметров сортировки.</span><span class="sxs-lookup"><span data-stu-id="0fa12-150">Object identifiers expressed in Latin script (any of the 26 English upper or lower case letters) are treated as case-insensitive, regardless of collation.</span></span> <span data-ttu-id="0fa12-151">Например, следующие идентификаторы объектов считаются равнозначными: 54321**abcdef**, 54321**ABCDEF**, 54321**AbCdEf**.</span><span class="sxs-lookup"><span data-stu-id="0fa12-151">For example, the following object IDs are considered identical: 54321**abcdef**, 54321**ABCDEF**, 54321**AbCdEf**.</span></span> <span data-ttu-id="0fa12-152">Службы Analysis Services обрабатывают символы в строке так, будто все они прописные, а затем выполняют простое побайтное сравнение, которое не зависит от языка.</span><span class="sxs-lookup"><span data-stu-id="0fa12-152">Internally, Analysis Services treats the characters in the string as if all are uppercase, and then performs a simple byte comparison that is independent of language.</span></span><br /><br /> <span data-ttu-id="0fa12-153">Обратите внимание, что затрагиваются только 26 символов.</span><span class="sxs-lookup"><span data-stu-id="0fa12-153">Note that only the 26 characters are affected.</span></span> <span data-ttu-id="0fa12-154">У западноевропейских языков со скандинавскими символами дополнительные символы не будут в верхнем регистре.</span><span class="sxs-lookup"><span data-stu-id="0fa12-154">If the language is West European, but uses Scandinavian characters, the additional character will not be upper-cased.</span></span>|  
|<span data-ttu-id="0fa12-155">**Кириллица, греческий, коптский, армянский**</span><span class="sxs-lookup"><span data-stu-id="0fa12-155">**Cyrillic, Greek, Coptic, Armenian**</span></span>|<span data-ttu-id="0fa12-156">В идентификаторах объектов на языках с письмом, отличным от латинского, где строчные и заглавные буквы различаются, всегда учитывается регистр.</span><span class="sxs-lookup"><span data-stu-id="0fa12-156">Object identifiers in non-Latin bicameral script, such as Cyrillic, are always case-sensitive.</span></span> <span data-ttu-id="0fa12-157">Например, "Измерение" и "измерение" считаются различными значениями, хотя единственная разница — первая буква.</span><span class="sxs-lookup"><span data-stu-id="0fa12-157">For example, Измерение and измерение are considered two distinct values, even though the only difference is the case of the first letter.</span></span>|  
  
 <span data-ttu-id="0fa12-158">**Влияния учета регистра в идентификаторах объектов**</span><span class="sxs-lookup"><span data-stu-id="0fa12-158">**Implications of case-sensitivity for object identifiers**</span></span>  
  
 <span data-ttu-id="0fa12-159">Только к идентификаторам, а не именам объектов применяются типы поведения, описанные в таблице.</span><span class="sxs-lookup"><span data-stu-id="0fa12-159">Only object identifiers, and not object names, are subject to the casing behaviors described in the table.</span></span> <span data-ttu-id="0fa12-160">Если вы заметите изменения в работе решения (после установки SQL Server 2012 SP2 или более поздней версии), то это изменение, по всей видимости, будет связано с обработкой.</span><span class="sxs-lookup"><span data-stu-id="0fa12-160">If you see a change in how your solution works (a before and after comparison -- after installing SQL Server 2012 SP2 or later), it will most likely be a processing issue.</span></span> <span data-ttu-id="0fa12-161">Идентификаторы объектов не влияют на запросы.</span><span class="sxs-lookup"><span data-stu-id="0fa12-161">Queries are not impacted by object identifiers.</span></span> <span data-ttu-id="0fa12-162">Для обоих языков запросов (DAX и MDX) механизм обработки формул использует имя объекта (а не идентификатор).</span><span class="sxs-lookup"><span data-stu-id="0fa12-162">For both query languages (DAX and MDX), the formula engine uses the object name (not the identifier).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0fa12-163">Изменения кода, связанные с учета регистра, были критическими изменениями для некоторых приложений.</span><span class="sxs-lookup"><span data-stu-id="0fa12-163">Code changes related to case-sensitivity have been a breaking change for some applications.</span></span> <span data-ttu-id="0fa12-164">Дополнительные сведения см. [в разделе критические изменения Analysis Services функций в SQL Server 2014](breaking-changes-to-analysis-services-features-in-sql-server-2014.md) .</span><span class="sxs-lookup"><span data-stu-id="0fa12-164">See [Breaking Changes to Analysis Services Features in SQL Server 2014](breaking-changes-to-analysis-services-features-in-sql-server-2014.md) for more information.</span></span>  
  
##  <a name="locale-testing-using-excel-sql-server-profiler-and-sql-server-management-studio"></a><a name="bkmk_test"></a> <span data-ttu-id="0fa12-165">Тестирования языков с помощью Excel, SQL Server Profiler и SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="0fa12-165">Locale testing using Excel, SQL Server Profiler and SQL Server Management Studio</span></span>  
 <span data-ttu-id="0fa12-166">При тестировании переводов соединение должно указывать код языка перевода.</span><span class="sxs-lookup"><span data-stu-id="0fa12-166">When testing translations, the connection must specify the LCID of the translation.</span></span> <span data-ttu-id="0fa12-167">Как указано в разделе [Получение другого языка из служб SSAS в Excel](http://extremeexperts.com/sql/Tips/ExcelDiffLocale.aspx), для тестирования переводов можно использовать Excel.</span><span class="sxs-lookup"><span data-stu-id="0fa12-167">As documented in [Get Different Language from SSAS into Excel](http://extremeexperts.com/sql/Tips/ExcelDiffLocale.aspx), you can use Excel to test your translations.</span></span>  
  
 <span data-ttu-id="0fa12-168">Это можно сделать вручную, добавив в ODC-файл свойство строки подключения кода языка.</span><span class="sxs-lookup"><span data-stu-id="0fa12-168">You can do this by hand editing the .odc file to include the locale identifier connection string property.</span></span> <span data-ttu-id="0fa12-169">Попробуйте этот подход с примером многомерной базы данных Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="0fa12-169">Try this out with the Adventure Works sample multidimensional database.</span></span>  
  
-   <span data-ttu-id="0fa12-170">Найдите существующие ODC-файлы.</span><span class="sxs-lookup"><span data-stu-id="0fa12-170">Search for existing .odc files.</span></span> <span data-ttu-id="0fa12-171">Затем найдите файл для многомерной базы данных Adventure Works и щелкните правой кнопкой мыши файл, чтобы открыть его в программе "Блокнот".</span><span class="sxs-lookup"><span data-stu-id="0fa12-171">When you find the one for Adventure Works multidimensional, right-click the file to open it in Notepad.</span></span>  
  
-   <span data-ttu-id="0fa12-172">Добавьте `Locale Identifier=1036` в строку подключения.</span><span class="sxs-lookup"><span data-stu-id="0fa12-172">Add `Locale Identifier=1036` to the connection string.</span></span> <span data-ttu-id="0fa12-173">Сохраните файл и закройте его.</span><span class="sxs-lookup"><span data-stu-id="0fa12-173">Save and close the file.</span></span>  
  
-   <span data-ttu-id="0fa12-174">Открыть Excel | **Данные**  |  **Существующие соединения**.</span><span class="sxs-lookup"><span data-stu-id="0fa12-174">Open Excel | **Data** | **Existing Connections**.</span></span> <span data-ttu-id="0fa12-175">Отфильтруйте список, чтобы показать только файлы подключений на этом компьютере.</span><span class="sxs-lookup"><span data-stu-id="0fa12-175">Filter the list to just connections files on this computer.</span></span> <span data-ttu-id="0fa12-176">Найдите подключение для Adventure Works (внимательно посмотрите на имя, их может быть несколько).</span><span class="sxs-lookup"><span data-stu-id="0fa12-176">Find the connection for Adventure Works (look at the name carefully; you might have more than one).</span></span> <span data-ttu-id="0fa12-177">открывает подключение;</span><span class="sxs-lookup"><span data-stu-id="0fa12-177">Open the connection.</span></span>  
  
     <span data-ttu-id="0fa12-178">Вы увидите переводы на французский из образца базы данных Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="0fa12-178">You should see the French translations from the Adventure Works sample database.</span></span>  
  
     <span data-ttu-id="0fa12-179">![Сводная таблица Excel с переводами на французский](media/ssas-localetest-excel.png "Сводная таблица Excel с переводами на французский")</span><span class="sxs-lookup"><span data-stu-id="0fa12-179">![Excel PivotTable with French translations](media/ssas-localetest-excel.png "Excel PivotTable with French translations")</span></span>  
  
 <span data-ttu-id="0fa12-180">Затем можно использовать приложение SQL Server Profiler для подтверждения кода языка.</span><span class="sxs-lookup"><span data-stu-id="0fa12-180">As a follow up, you can use SQL Server Profiler to confirm the locale.</span></span> <span data-ttu-id="0fa12-181">Щелкните событие `Session Initialize` , а затем найдите `<localeidentifier>1036</localeidentifier>`в текстовом поле под списком свойств.</span><span class="sxs-lookup"><span data-stu-id="0fa12-181">Click a `Session Initialize` event and then look at the property list in the text area below to find `<localeidentifier>1036</localeidentifier>`.</span></span>  
  
 <span data-ttu-id="0fa12-182">В среде Management Studio можно указать код языка для соединения с сервером.</span><span class="sxs-lookup"><span data-stu-id="0fa12-182">In Management Studio, you can specify Locale Identifier on a server connection.</span></span>  
  
-   <span data-ttu-id="0fa12-183">В обозревателе объектов | **Подключение к**  |  **Analysis Services**  |  **Параметры**, перейдите на вкладку **Дополнительные параметры соединения** .</span><span class="sxs-lookup"><span data-stu-id="0fa12-183">In Object Explorer | **Connect** | **Analysis Services** | **Options**, click the **Additional Connection Parameters** tab.</span></span>  
  
-   <span data-ttu-id="0fa12-184">Введите `Local Identifier=1036` и нажмите кнопку **Подключение**.</span><span class="sxs-lookup"><span data-stu-id="0fa12-184">Enter `Local Identifier=1036` and then click **Connect**.</span></span>  
  
-   <span data-ttu-id="0fa12-185">Выполните MDX-запрос к базе данных Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="0fa12-185">Execute an MDX query against the Adventure Works database.</span></span> <span data-ttu-id="0fa12-186">Результатами запроса должны быть переводы на французский.</span><span class="sxs-lookup"><span data-stu-id="0fa12-186">The query results should be the French translations.</span></span>  
  
     <span data-ttu-id="0fa12-187">![Запрос многомерных выражений с переводами на французский в SSMS](media/ssas-localetest-ssms.png "Запрос многомерных выражений с переводами на французский в SSMS")</span><span class="sxs-lookup"><span data-stu-id="0fa12-187">![MDX query with French translations in SSMS](media/ssas-localetest-ssms.png "MDX query with French translations in SSMS")</span></span>  
  
##  <a name="writing-mdx-queries-in-a-solution-containing-translations"></a><a name="bkmk_mdx"></a> <span data-ttu-id="0fa12-188">Написание MDX-запросов в решении, содержащем переводы</span><span class="sxs-lookup"><span data-stu-id="0fa12-188">Writing MDX queries in a solution containing Translations</span></span>  
 <span data-ttu-id="0fa12-189">Переводы предоставляют отображаемые сведения об именах объектов служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] , однако идентификаторы тех же самых объектов не переводятся.</span><span class="sxs-lookup"><span data-stu-id="0fa12-189">Translations provide display information for the names of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] objects, but the identifiers for the same objects are not translated.</span></span> <span data-ttu-id="0fa12-190">По возможности для объектов служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] необходимо использовать идентификаторы и ключи, а не переведенные заголовки и имена.</span><span class="sxs-lookup"><span data-stu-id="0fa12-190">Whenever possible, use the identifiers and keys for [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] objects instead of the translated captions and names.</span></span> <span data-ttu-id="0fa12-191">Например, для обеспечения мобильности в нескольких языках необходимо использовать ключи элементов, а не имена элементов для инструкций многомерных выражений и скриптов.</span><span class="sxs-lookup"><span data-stu-id="0fa12-191">For example, use member keys instead of member names for Multidimensional Expressions (MDX) statements and scripts to ensure portability across multiple languages.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0fa12-192">Помните, что в именах табличных объектов регистр никогда не учитывается, независимо от параметров сортировки.</span><span class="sxs-lookup"><span data-stu-id="0fa12-192">Recall that tabular object names are always case-insensitive, regardless of collation.</span></span> <span data-ttu-id="0fa12-193">В именах многомерных объектов, напротив, регистр учитывается таким же образом, как в параметрах сортировки.</span><span class="sxs-lookup"><span data-stu-id="0fa12-193">Multidimensional object names, on the other hand, follow the case sensitivity of the collation.</span></span> <span data-ttu-id="0fa12-194">Поскольку регистр учитывается только в именах многомерных объектов, убедитесь, что все запросы MDX, ссылающиеся на многомерные объекты, имеют правильный регистр.</span><span class="sxs-lookup"><span data-stu-id="0fa12-194">Since only multidimensional object names are case-sensitive make sure that all MDX queries referencing multidimensional objects are cased correctly.</span></span>  
  
##  <a name="writing-mdx-queries-containing-date-and-time-values"></a><a name="bkmk_datetime"></a> <span data-ttu-id="0fa12-195">Написание MDX-запросов, содержащих значения даты и времени</span><span class="sxs-lookup"><span data-stu-id="0fa12-195">Writing MDX queries containing Date and Time Values</span></span>  
 <span data-ttu-id="0fa12-196">Следующие рекомендации помогут удобнее переносить запросы MDX на основе даты и времени на разные языки:</span><span class="sxs-lookup"><span data-stu-id="0fa12-196">The following suggestions to make your date and time-based MDX queries more portable across different languages:</span></span>  
  
1.  <span data-ttu-id="0fa12-197">**Использование числовых частей для сравнения и операций**</span><span class="sxs-lookup"><span data-stu-id="0fa12-197">**Use numeric parts for comparisons and operations**</span></span>  
  
     <span data-ttu-id="0fa12-198">При выполнении операций и сравнений месяцев и дней недели используйте числовые части даты и времени, а не строковые эквиваленты (например, используйте MonthNumberofYear вместо MonthName).</span><span class="sxs-lookup"><span data-stu-id="0fa12-198">When you perform month and day-of-week comparisons and operations, use the numeric date and time parts instead of the string equivalents (for example, use MonthNumberofYear instead of MonthName).</span></span> <span data-ttu-id="0fa12-199">Числовые значения в меньше степени затрагиваются различиями в переводах.</span><span class="sxs-lookup"><span data-stu-id="0fa12-199">Numeric values are least affected by differences in language translations.</span></span>  
  
2.  <span data-ttu-id="0fa12-200">**Использование строковых эквивалентов в результирующем наборе**</span><span class="sxs-lookup"><span data-stu-id="0fa12-200">**Use string equivalents in a result set**</span></span>  
  
     <span data-ttu-id="0fa12-201">При построении результирующих наборов, видимых конечным пользователям, используйте строки (например, MonthName), чтобы многоязычная аудитория могла пользоваться предоставленными переводами.</span><span class="sxs-lookup"><span data-stu-id="0fa12-201">When building result sets seen by end-users, consider using the string (such as MonthName) so that your multi-lingual audience can benefit from the translations you've provided.</span></span>  
  
3.  <span data-ttu-id="0fa12-202">**Использование форматов даты ISO для получения универсальных сведений о дате и времени**</span><span class="sxs-lookup"><span data-stu-id="0fa12-202">**Use ISO date formats for universal date and time information**</span></span>  
  
     <span data-ttu-id="0fa12-203">Один [эксперт по службам Analysis Services](http://geekswithblogs.net/darrengosbell/Default.aspx) дает следующую рекомендацию: "Я всегда использую ISO-формат даты гггг-мм-дд для любой строки даты, которая передается в запросах SQL или MDX, так как он однозначный и будет работать независимо от региональных параметров клиента или сервера.</span><span class="sxs-lookup"><span data-stu-id="0fa12-203">One [Analysis Services expert](http://geekswithblogs.net/darrengosbell/Default.aspx) has this recommendation: "I always use the ISO date format yyyy-mm-dd for any date strings that I pass in to queries in SQL or MDX because it's unambiguous and will work regardless of the client or server's regional settings.</span></span> <span data-ttu-id="0fa12-204">Я соглашусь с тем, что сервер должен игнорировать свои региональные настройки при синтаксическом анализе неоднозначного формата даты, но я также думаю, если у вас есть вариант, интерпретируемый одинаково, лучше остановиться на нем".</span><span class="sxs-lookup"><span data-stu-id="0fa12-204">I would agree that the server should defer to its regional settings when parsing an ambiguous date format, but I also think that if you've got an option that is not open to interpretation that you are better choosing that anyway".</span></span>  
  
4.  `Use the Format function to enforce a specific format, regardless of regional language settings`  
  
     <span data-ttu-id="0fa12-205">В следующем запросе MDX, взятом из публикации на форуме, показано использование параметра Format для возврата данных в определенном формате вне зависимости от базовых региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="0fa12-205">The following MDX query, borrowed from a forum post, illustrates how to use Format to return dates in a specific format, irrespective of the underlying regional settings.</span></span>  
  
     <span data-ttu-id="0fa12-206">Исходное сообщение см. в записи на форуме [SSAS 2012 создает недопустимые даты (Network Steve)](http://www.networksteve.com/forum/topic.php/SSAS_2012_generates_invalid_dates/?TopicId=40504&Posts=2) .</span><span class="sxs-lookup"><span data-stu-id="0fa12-206">See [SSAS 2012 generates invalid dates (forum post on Network Steve](http://www.networksteve.com/forum/topic.php/SSAS_2012_generates_invalid_dates/?TopicId=40504&Posts=2) for the original post.</span></span>  
  
    ```  
    WITH MEMBER [LinkTimeAdd11Date_Manual] as Format(dateadd("d",15,"2014-12-11"), "mm/dd/yyyy")  
    member [LinkTimeAdd15Date_Manual] as Format(dateadd("d",11,"2014-12-13"), "mm/dd/yyyy")  
    SELECT  
    { [LinkTimeAdd11Date_Manual]  
    ,[LinkTimeAdd15Date_Manual]  
    }  
    ON COLUMNS   
    FROM [Adventure Works]  
  
    ```  
  
## <a name="see-also"></a><span data-ttu-id="0fa12-207">См. также:</span><span class="sxs-lookup"><span data-stu-id="0fa12-207">See Also</span></span>  
 <span data-ttu-id="0fa12-208">[Сценарии глобализации для многомерных Analysis Services](globalization-scenarios-for-analysis-services-multiidimensional.md) </span><span class="sxs-lookup"><span data-stu-id="0fa12-208">[Globalization scenarios for Analysis Services Multidimensional](globalization-scenarios-for-analysis-services-multiidimensional.md) </span></span>  
 [<span data-ttu-id="0fa12-209">Написание инструкций Transact-SQL, адаптированных к международному использованию</span><span class="sxs-lookup"><span data-stu-id="0fa12-209">Write International Transact-SQL Statements</span></span>](../relational-databases/collations/write-international-transact-sql-statements.md)  
