---
title: Изменение измерения даты | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 4689d780-4bf6-4cf8-8fde-eb3f15dd668a
author: minewiskan
ms.author: owend
ms.openlocfilehash: b4978e9fe3acd93ddfdca707d2c2353bf171ba12
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87665654"
---
# <a name="modifying-the-date-dimension"></a>Изменение измерения Date
  В ходе выполнения задач этого раздела мы создадим определяемую пользователем иерархию и изменим имена элементов, отображаемых для атрибутов «Дата», «Месяц», «Календарный квартал» и «Календарное полугодие». Также мы определим составные ключи для атрибутов, настроим порядок сортировки элементов измерения и зададим связи атрибутов.  
  
## <a name="adding-a-named-calculation"></a>Добавление именованного вычисления  
 К таблице в представлении источника данных можно добавить именованное вычисление, которое является выражением SQL и представляет собой вычисляемый столбец, Это выражение имеет вид и функции столбца таблицы. Именованные вычисления позволяют расширять реляционную схему таблиц, существующих в представлении источника данных, не изменяя таблицы в базовом источнике данных. Дополнительные сведения см. в разделе [Определение именованных вычислений в представлении источника данных (службы Analysis Services)](multidimensional-models/define-named-calculations-in-a-data-source-view-analysis-services.md)  
  
#### <a name="to-add-a-named-calculation"></a>Добавление именованного вычисления  
  
1.  Чтобы открыть представление источника данных **Adventure Works DW 2012** , дважды щелкните его в папке **Представления источников данных** в обозревателе решений.  
  
2.  В нижней части панели **таблицы** щелкните правой кнопкой мыши `Date` и выберите команду **Создать именованное вычисление**.  
  
3.  В диалоговом окне **Создание именованного вычисления** введите `SimpleDate` в поле **имя столбца** , а затем в поле Выражение введите или скопируйте и вставьте следующую `DATENAME` инструкцию **Expression** :  
  
    ```  
    DATENAME(mm, FullDateAlternateKey) + ' ' +  
    DATENAME(dd, FullDateAlternateKey) + ', ' +  
    DATENAME(yy, FullDateAlternateKey)  
    ```  
  
     Инструкция `DATENAME` извлекает из столбца FullDateAlternateKey значения числа, месяца и года. Этот новый столбец будет содержать отображаемое имя для атрибута FullDateAlternateKey.  
  
4.  Нажмите кнопку **ОК**, а затем разверните узел `Date` на панели **таблицы** .  
  
     `SimpleDate`Именованное вычисление отображается в списке столбцов в таблице Date со значком, указывающим на то, что это именованное вычисление.  
  
5.  В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
6.  На панели **таблицы** щелкните правой кнопкой мыши `Date` и выберите **Просмотр данных**.  
  
7.  Прокрутите вправо и просмотрите последний столбец в представлении **Просмотр таблицы "Дата"** .  
  
     Обратите внимание, что `SimpleDate` столбец отображается в представлении источника данных и правильно объединяет данные из нескольких столбцов из базового источника данных, не изменяя исходный источник данных.  
  
8.  Закройте представление **Просмотр таблицы "Дата"** .  
  
## <a name="using-the-named-calculation-for-member-names"></a>Использование именованных вычислений в качестве имен элементов  
 После создания именованного вычисления в представлении источника данных это вычисление можно использовать в качестве свойства атрибута.  
  
#### <a name="to-use-the-named-calculation-for-member-names"></a>Использование именованного вычисления в качестве имен элементов  
  
1.  Откройте измерение Date в **конструкторе измерений** среды [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)]. Для этого дважды щелкните `Date` измерение в узле **измерения** **Обозреватель решений**.  
  
2.  На панели **Атрибуты** на вкладке **Структура измерения** выберите атрибут **Date Key** .  
  
3.  Если окно "Свойства" не открыто, откройте его и нажмите в строке заголовка кнопку **Автоматически скрывать** , чтобы оно оставалось открытым.  
  
4.  Щелкните поле свойства **NameColumn** в нижней части окна, а затем нажмите кнопку обзора (**...**), чтобы открыть диалоговое окно **Столбец имени** .  
  
5.  Выберите `SimpleDate` в нижней части списка **Исходный столбец** , а затем нажмите кнопку **ОК**.  
  
6.  В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
## <a name="creating-a-hierarchy"></a>Создание иерархии  
 Иерархию можно создать, перетащив атрибут с панели **Атрибуты** на панель **Иерархии** .  
  
#### <a name="to-create-a-hierarchy"></a>Создание иерархии  
  
1.  На вкладке **Структура измерения** конструктора измерений для `Date` измерения перетащите атрибут **календарный год** с панели **атрибуты** на панель **иерархии** .  
  
2.  Перетащите атрибут **Календарное полугодие** с панели **Атрибуты** в ячейку **\<new level>** на панели **Иерархии** под уровнем **Календарный год** .  
  
3.  Перетащите атрибут **Календарный квартал** с панели **Атрибуты** в ячейку **\<new level>** на панели **Иерархии** под уровнем **Календарное полугодие** .  
  
4.  Перетащите атрибут **English Month Name** с панели **Атрибуты** в ячейку **\<new level>** на панели **Иерархии** под уровнем **Календарный квартал** .  
  
5.  Перетащите атрибут **Date Key** с панели **Атрибуты** в ячейку **\<new level>** на панели **Иерархии** под уровнем **English Month Name** .  
  
6.  На панели **иерархии** щелкните правой кнопкой мыши строку заголовка иерархии **Иерархия** , выберите команду **Переименовать**, а затем введите `Calendar Date` .  
  
7.  При щелчке правой кнопкой мыши контекстного меню в `Calendar Date` иерархии переименуйте уровень **английское название месяца** на `Calendar Month` , а затем переименуйте уровень **ключа даты** в `Date` .  
  
8.  Удалите атрибут **Full Date Alternate Key** на панели **Атрибуты** , так как он больше не понадобится. Нажмите кнопку **OK** в окне подтверждения **Удалить объекты** .  
  
9. В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
## <a name="defining-attribute-relationships"></a>Определение связей атрибутов  
 Необходимо определять связи между атрибутами, если базовые данные это поддерживают. Определение связей между атрибутами ускоряет обработку измерений, секций и запросов.  
  
#### <a name="to-define-attribute-relationships"></a>Определение связей атрибутов  
  
1.  В **конструкторе измерений** для `Date` измерения перейдите на вкладку **связи атрибутов** .  
  
2.  На диаграмме щелкните правой кнопкой мыши атрибут **English Month Name** и выберите команду **Создать связь атрибутов**.  
  
3.  В диалоговом окне **Создание связи атрибутов** свойство **Исходный атрибут** имеет значение **English Month Name**. Задайте для поля **Связанный атрибут** значение **Календарный квартал**.  
  
4.  В списке **Тип связи** выберите тип **Жесткая**.  
  
     Связь имеет тип **Жесткая** , так как связи между элементами не будут меняться с течением времени.  
  
5.  Нажмите кнопку **ОК**.  
  
6.  На диаграмме щелкните правой кнопкой мыши атрибут **Календарный квартал** и выберите команду **Создать связь атрибутов**.  
  
7.  В диалоговом окне **Создание связи атрибутов** поле **Исходный атрибут** имеет значение **Calendar Quarter**. Задайте для поля **Связанный атрибут** значение **Календарное полугодие**.  
  
8.  В списке **Тип связи** выберите тип **Жесткая**.  
  
9. Нажмите кнопку **ОК**.  
  
10. На диаграмме щелкните правой кнопкой мыши атрибут **Календарное полугодие** , а затем выберите команду **Создать связь атрибутов**.  
  
11. В диалоговом окне **Создание связи атрибутов** поле **Исходный атрибут** имеет значение **Календарное полугодие**. Задайте для поля **Связанный атрибут** значение **Календарный год**.  
  
12. В списке **Тип связи** выберите тип **Жесткая**.  
  
13. Нажмите кнопку **ОК**.  
  
14. В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
## <a name="providing-unique-dimension-member-names"></a>Создание уникальных имен для элементов измерения  
 В этой задаче будут созданы столбцы понятных имен, которые будут использоваться для атрибутов **EnglishMonthName**, **CalendarQuarter**и **CalendarSemester** .  
  
#### <a name="to-provide-unique-dimension-member-names"></a>Создание уникальных имен для элементов измерения  
  
1.  Чтобы переключиться на представление источника данных ** [!INCLUDE[ssSampleDBCoShort](../includes/sssampledbcoshort-md.md)] DW 2012** , дважды щелкните его в папке **представления источников данных** в Обозреватель решений.  
  
2.  На панели **таблицы** щелкните правой кнопкой мыши `Date` и выберите команду **Создать именованное вычисление**.  
  
3.  В диалоговом окне **Создание именованного вычисления** введите `MonthName` в поле **имя столбца** , а затем в поле **выражение** введите или скопируйте и вставьте следующую инструкцию:  
  
    ```  
    EnglishMonthName+' '+ CONVERT(CHAR (4), CalendarYear)  
    ```  
  
     Эта инструкция объединяет месяц и год для каждого месяца в таблице в новый столбец.  
  
4.  Нажмите кнопку **ОК**.  
  
5.  На панели **таблицы** щелкните правой кнопкой мыши `Date` и выберите команду **Создать именованное вычисление**.  
  
6.  В диалоговом окне **Создание именованного вычисления** введите `CalendarQuarterDesc` в поле **имя столбца** , а затем в поле **выражение** введите или скопируйте и вставьте следующий скрипт SQL:  
  
    ```  
    'Q' + CONVERT(CHAR (1), CalendarQuarter) +' '+ 'CY ' +  
    CONVERT(CHAR (4), CalendarYear)  
    ```  
  
     Этот скрипт SQL помещает в новый столбец объединение календарного квартала и года для каждого квартала в таблице.  
  
7.  Нажмите кнопку **ОК**.  
  
8.  На панели **таблицы** щелкните правой кнопкой мыши `Date` и выберите команду **Создать именованное вычисление**.  
  
9. В диалоговом окне **Создание именованного вычисления** введите `CalendarSemesterDesc` в поле **имя столбца** , а затем в поле **выражение** введите или скопируйте и вставьте следующий скрипт SQL:  
  
    ```  
    CASE  
    WHEN CalendarSemester = 1 THEN 'H1' + ' ' + 'CY' + ' '   
           + CONVERT(CHAR(4), CalendarYear)  
    ELSE  
    'H2' + ' ' + 'CY' + ' ' + CONVERT(CHAR(4), CalendarYear)  
    END  
    ```  
  
     Этот скрипт SQL помещает в новый столбец объединение календарного полугодия и года для каждого полугодия в таблице.  
  
10. Нажмите кнопку **ОК.**  
  
11. В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
## <a name="defining-composite-keycolumns-and-setting-the-name-column"></a>Определение составного свойства KeyColumns и задание столбца имени  
 Свойство **KeyColumns** содержит столбец или столбцы, представляющие ключ для атрибута. В этой задаче будет определено составное свойство **KeyColumns**.  
  
#### <a name="to-define-composite-keycolumns-for-the-english-month-name-attribute"></a>Определение составного свойства KeyColumns для атрибута English Month Name  
  
1.  Откройте измерение Date и перейдите на вкладку **Структура измерения** .  
  
2.  На панели **Атрибуты** щелкните атрибут **English Month Name** .  
  
3.  В окне **Свойства** щелкните в поле **KeyColumns** и нажмите кнопку обзора (**...**).  
  
4.  В диалоговом окне **Ключевые столбцы** в списке **Доступные столбцы** выберите столбец **CalendarYear**и нажмите кнопку **>** .  
  
5.  Столбцы **EnglishMonthName** и **CalendarYear** отображаются в списке **Ключевые столбцы** .  
  
6.  Нажмите кнопку **ОК**.  
  
7.  Чтобы задать свойство **NameColumn** атрибута **EnglishMonthName** , щелкните поле **NameColumn** в окне свойств и нажмите кнопку обзора (**...**).  
  
8.  В диалоговом окне **Столбец имени** в списке **Исходный столбец** выберите `MonthName` , а затем нажмите кнопку **ОК**.  
  
9. В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
#### <a name="to-define-composite-keycolumns-for-the-calendar-quarter-attribute"></a>Определение составного свойства KeyColumns для атрибута Calendar Quarter  
  
1.  На панели **Атрибуты** щелкните атрибут **Календарный квартал** .  
  
2.  В окне **Свойства** щелкните в поле **KeyColumns** и нажмите кнопку обзора (**...**).  
  
3.  В диалоговом окне **Ключевые столбцы** в списке **Доступные столбцы** выберите столбец **CalendarYear**и нажмите кнопку **>** .  
  
     Столбцы **CalendarQuarter** и **CalendarYear** отображаются в списке **Ключевые столбцы** .  
  
4.  Нажмите кнопку **ОК**.  
  
5.  Чтобы задать свойство **NameColumn** атрибута **Календарный квартал** , щелкните поле **NameColumn** в окне свойств и нажмите кнопку обзора (**...**).  
  
6.  В диалоговом окне **Столбец имени** в списке **Исходный столбец** выберите `CalendarQuarterDesc` , а затем нажмите кнопку **ОК**.  
  
7.  В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
#### <a name="to-define-composite-keycolumns-for-the-calendar-semester-attribute"></a>Определение составного свойства KeyColumns для атрибута Calendar Semester  
  
1.  На панели **Атрибуты** щелкните атрибут **Календарное полугодие** .  
  
2.  В окне **Свойства** щелкните в поле **KeyColumns** и нажмите кнопку обзора (**...**).  
  
3.  В диалоговом окне **Ключевые столбцы** выберите из списка **Доступные столбцы** столбец **CalendarYear**, а затем нажмите кнопку **>** .  
  
     Столбцы **CalendarSemester** и **CalendarYear** отображаются в списке **Ключевые столбцы** .  
  
4.  Нажмите кнопку **ОК**.  
  
5.  Чтобы задать свойство **NameColumn** атрибута **Календарное полугодие** , щелкните поле **NameColumn** в окне свойств и нажмите кнопку обзора (**...**).  
  
6.  В диалоговом окне **Столбец имени** в списке **Исходный столбец** выберите `CalendarSemesterDesc` , а затем нажмите кнопку **ОК**.  
  
7.  В меню **File** (Файл) выберите команду **Save All** (Сохранить все).  
  
## <a name="deploying-and-viewing-the-changes"></a>Развертывание и просмотр изменений  
 После изменения атрибутов и иерархий необходимо произвести развертывание произведенных изменений и повторную обработку связанных объектов, прежде чем эти изменения можно будет просмотреть.  
  
#### <a name="to-deploy-and-view-the-changes"></a>Развертывание и просмотр изменений  
  
1.  В меню **Построение** среды [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)]выберите команду **Развернуть Analysis Services Tutorial**.  
  
2.  Получив сообщение **Развертывание завершено успешно** , щелкните вкладку **браузер** в **конструкторе измерений** для `Date` измерения, а затем нажмите кнопку Повторное соединение на панели инструментов конструктора.  
  
3.  В списке **Иерархия** выберите значение **Календарный квартал** . Просмотрите элементы иерархии атрибута **Календарный квартал** .  
  
     Обратите внимание, что имена элементов иерархии атрибута **Календарный квартал** выглядят понятнее и проще в использовании, так как для их отображения создано именованное вычисление. Теперь в иерархии атрибута **Календарный квартал** есть элементы для каждого квартала каждого года. Элементы не отсортированы в хронологическом порядке. Вместо этого они отсортированы сначала по кварталам, а затем по годам. В следующей задаче этого раздела требуется изменить поведение этой иерархии атрибута, чтобы отсортировать ее элементы сначала по годам, а затем по кварталам.  
  
4.  Просмотрите элементы иерархий атрибутов **English Month Name** и **Календарное полугодие** .  
  
     Обратите внимание, что элементы этих иерархий также не отсортированы в хронологическом порядке. Вместо этого они отсортированы сначала соответственно по месяцам или полугодиям, а затем — по годам. В следующей задаче этого раздела поведение этих иерархий атрибутов будет изменено, чтобы изменить порядок сортировки.  
  
## <a name="changing-the-sort-order-by-modifying-composite-key-member-order"></a>Изменение порядка сортировки путем изменения порядка элементов составных ключей  
 В этой задаче будет изменен порядок сортировки посредством изменения порядка ключей, составляющих составной ключ.  
  
#### <a name="to-modify-the-composite-key-member-order"></a>Изменение порядка элементов составных ключей  
  
1.  Откройте вкладку **Структура измерения** в конструкторе измерений для `Date` измерения, а затем выберите **Календарное полугодие** на панели **атрибуты** .  
  
2.  В окне свойств просмотрите значение свойства **OrderBy** . Оно имеет значение **Ключ**.  
  
     Элементы иерархии атрибута **Календарное полугодие** отсортированы по значению ключа. При составном ключе сортировка ключей элементов ведется упорядочение сначала по значению первого ключа элемента, а затем — по значению второго ключа элемента. Иными словами, элементы иерархии атрибута **Календарное полугодие** отсортированы сначала по полугодиям, а затем по годам.  
  
3.  В окне свойств нажмите кнопку обзора (**...**), чтобы изменить значение свойства **KeyColumns** .  
  
4.  В списке **Ключевые столбцы** в диалоговом окне **Ключевые столбцы** выберите столбец **CalendarSemester** , а затем нажмите стрелку вниз, чтобы изменить порядок элементов составного ключа. Нажмите кнопку **ОК**.  
  
     Теперь элементы этой иерархии атрибута отсортированы сначала по годам, а затем по полугодиям.  
  
5.  Выберите **Календарный квартал** на панели **Атрибуты** и нажмите кнопку обзора (**...**) для свойства **KeyColumns** в окне свойств.  
  
6.  В списке **Ключевые столбцы** диалогового окна **Ключевые столбцы** выделите столбец **CalendarQuarter** , а затем нажмите стрелку вниз, чтобы изменить порядок элементов составного ключа. Нажмите кнопку **ОК**.  
  
     Теперь элементы этой иерархии атрибута отсортированы сначала по годам, а затем по кварталам.  
  
7.  На панели **Атрибуты** выберите элемент **English Month Name** , а затем в окне свойств нажмите кнопку с многоточием (**...**) для свойства **KeyColumns** .  
  
8.  В списке **Ключевые столбцы** диалогового окна **Ключевые столбцы** выделите столбец **EnglishMonthName** , а затем нажмите стрелку вниз, чтобы изменить порядок элементов составного ключа. Нажмите кнопку **ОК**.  
  
     Теперь элементы этой иерархии атрибута отсортированы сначала по годам, а затем по месяцам.  
  
9. В меню **Построение** среды [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)]выберите команду **Развернуть Analysis Services Tutorial**. После успешного завершения развертывания перейдите на вкладку **браузер** в конструкторе измерений для `Date` измерения.  
  
10. На панели инструментов вкладки **Браузер** нажмите кнопку повторного соединения.  
  
11. Просмотрите элементы иерархий атрибутов **Календарный квартал** и **Календарное полугодие** .  
  
     Обратите внимание, что теперь элементы этих иерархий атрибутов сортируются в хронологическом порядке, по годам, а затем по полугодиям или кварталам соответственно.  
  
12. Просмотрите элементы иерархии атрибута **English Month Name** .  
  
     Обратите внимание, что теперь элементы этой иерархии атрибута сортируются сначала по годам, а затем по месяцам в алфавитном порядке. Причина этого заключается в том, что столбец EnglishCalendarMonth в представлении источника данных имеет строковый тип данных, который основан на типе данных nvarchar базовой реляционной базы данных. Сведения о сортировке по месяцам хронологически внутри года см. в разделе [Сортировка элементов атрибута по вторичному атрибуту](lesson-4-5-sorting-attribute-members-based-on-a-secondary-attribute.md).  
  
## <a name="next-task-in-lesson"></a>Следующая задача занятия  
 [Просмотр развернутого куба](lesson-3-5-browsing-the-deployed-cube.md)  
  
## <a name="see-also"></a>См. также:  
 [Измерения в многомерных моделях](multidimensional-models/dimensions-in-multidimensional-models.md)  
  
  
