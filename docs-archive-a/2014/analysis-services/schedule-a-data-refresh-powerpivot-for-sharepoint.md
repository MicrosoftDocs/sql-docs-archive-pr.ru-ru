---
title: Планирование обновления данных (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 8571208f-6aae-4058-83c6-9f916f5e2f9b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9d6078cf59c27c15ead8f22047ba9add20757be7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656635"
---
# <a name="schedule-a-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="86e42-102">Планирование обновления данных (PowerPivot для SharePoint)</span><span class="sxs-lookup"><span data-stu-id="86e42-102">Schedule a Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="86e42-103">Предусмотрена возможность планирования автоматического обновления данных PowerPivot в книге Excel, опубликованной на сайте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="86e42-103">You can schedule data refresh to get automatic updates to PowerPivot data inside an Excel workbook that you published to a SharePoint site.</span></span>  
  
 <span data-ttu-id="86e42-104">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="86e42-104">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="86e42-105">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="86e42-105">**In this topic:**</span></span>  
  
 [<span data-ttu-id="86e42-106">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="86e42-106">Prerequisites</span></span>](#prereq)  
  
 [<span data-ttu-id="86e42-107">Общие сведения об обновлении данных</span><span class="sxs-lookup"><span data-stu-id="86e42-107">Data Refresh Overview</span></span>](#intro)  
  
 [<span data-ttu-id="86e42-108">Включение и планирование обновления данных</span><span class="sxs-lookup"><span data-stu-id="86e42-108">Enable and schedule data refresh</span></span>](#drenablesched)  
  
 [<span data-ttu-id="86e42-109">Проверка обновления данных</span><span class="sxs-lookup"><span data-stu-id="86e42-109">Verify Data Refresh</span></span>](#drverify)  
  
> [!NOTE]  
>  <span data-ttu-id="86e42-110">Обновление данных PowerPivot осуществляется экземплярами серверов служб Analysis Services на ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="86e42-110">PowerPivot data refresh is performed by Analysis Services server instances in the SharePoint farm.</span></span> <span data-ttu-id="86e42-111">Оно не связано с функцией обновления данных, предусмотренной в службах Excel.</span><span class="sxs-lookup"><span data-stu-id="86e42-111">It is not related to the data refresh feature that is provided in Excel Services.</span></span> <span data-ttu-id="86e42-112">Функция планирования обновления данных PowePivot не будет обновлять данные, не относящиеся к PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="86e42-112">The PowePivot Schedule data refresh feature will not refresh non PowerPivot data.</span></span>  
  
##  <a name="prerequisites"></a><a name="prereq"></a> <span data-ttu-id="86e42-113">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="86e42-113">Prerequisites</span></span>  
 <span data-ttu-id="86e42-114">Для создания расписания обновления данных необходимо иметь для книги уровень разрешения «Участие» или выше.</span><span class="sxs-lookup"><span data-stu-id="86e42-114">You must have Contribute level of permission or greater on the workbook to create a data refresh schedule.</span></span>  
  
 <span data-ttu-id="86e42-115">Должны быть доступны внешние источники данных, доступ к которым производится во время обновления данных, а для учетных данных, указываемых в расписании, должно быть предоставлено разрешение на доступ к этим источникам данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-115">External data sources that are accessed during data refresh must be available and the credentials you specify in the schedule must have permission to access those data sources.</span></span> <span data-ttu-id="86e42-116">Для запланированного обновления данных требуется доступ к расположению источника данных, доступному по сетевому подключению (например, из сетевой общей папки, а не из локальной папки на рабочей станции).</span><span class="sxs-lookup"><span data-stu-id="86e42-116">Scheduled data refresh requires a data source location that is accessible over a network connection (for example, from a network file share rather than a local folder on your workstation).</span></span>  
  
 <span data-ttu-id="86e42-117">Источник данных не может быть документом Office или базой данных Access.</span><span class="sxs-lookup"><span data-stu-id="86e42-117">The data source cannot be an Office document or Access database.</span></span> <span data-ttu-id="86e42-118">Office не поддерживает использование компонентов подключения к данным Office в серверной среде.</span><span class="sxs-lookup"><span data-stu-id="86e42-118">Office does not support the use of the Office data connectivity components in a server environment.</span></span> <span data-ttu-id="86e42-119">Если книга содержит данные из этих источников, необходимо удалить эти источники из списка источников данных в расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-119">If your workbook contains data from these sources, be sure to remove those sources from the data source list in your data refresh schedule.</span></span>  
  
 <span data-ttu-id="86e42-120">Книга должна иметь версию [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="86e42-120">The workbook must be a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version.</span></span> <span data-ttu-id="86e42-121">При использовании книг, созданных в предыдущем выпуске PowerPivot для Excel, планирование обновления данных работать не будет, пока база данных не будет обновлена до новейшей версии.</span><span class="sxs-lookup"><span data-stu-id="86e42-121">If you use workbooks that were created in the previous release of PowerPivot for Excel, schedule data refresh will not work unless you upgrade the database to the most recent version.</span></span>  
  
 <span data-ttu-id="86e42-122">К моменту завершения операции обновления книга должна быть проверена.</span><span class="sxs-lookup"><span data-stu-id="86e42-122">The workbook must be checked in at the time the refresh operation is finished.</span></span> <span data-ttu-id="86e42-123">Блокировка книги устанавливается на файл в конце обновления данных при сохранении файла, а не в начале обновления.</span><span class="sxs-lookup"><span data-stu-id="86e42-123">A lock on the workbook is placed on the file at the end of data refresh, when the file is saved, rather than when refresh starts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="86e42-124">Сервер не блокирует книгу, пока происходит обновление данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-124">The server does not lock the workbook while the data refresh is in progress.</span></span> <span data-ttu-id="86e42-125">Тем не менее он блокирует файл по окончании обновления данных для проверки обновленного файла.</span><span class="sxs-lookup"><span data-stu-id="86e42-125">However, it does lock the file at the end of data refresh for the purpose of checking in the updated file.</span></span> <span data-ttu-id="86e42-126">Если в данный момент файл извлечен другим пользователем, обновленные данные будут выдаваться. Аналогично, если файл возвращен, но он значительно отличается от копии, полученной на сервере при начале обновления данных, обновленные данные будут удалены.</span><span class="sxs-lookup"><span data-stu-id="86e42-126">If at this time, the file is checked out to another user, the refreshed data will be thrown out. Similarly, if the file is checked in, but it is significantly different from the copy retrieved by the server at the start of data refresh, the refreshed data will be discarded.</span></span>  
  
##  <a name="data-refresh-overview"></a><a name="intro"></a><span data-ttu-id="86e42-127">Общие сведения об обновлении данных</span><span class="sxs-lookup"><span data-stu-id="86e42-127">Data Refresh Overview</span></span>  
 <span data-ttu-id="86e42-128">Данные PowerPivot в книге Excel могут быть получены из нескольких внешних источников данных, в том числе из внешних баз данных или файлов данных, доступ к которым осуществляется с удаленных серверов или из сетевых общих папок.</span><span class="sxs-lookup"><span data-stu-id="86e42-128">PowerPivot data in an Excel workbook can originate from multiple external data sources, including external databases or data files that you access from remote servers or network file shares.</span></span> <span data-ttu-id="86e42-129">Для книг PowerPivot, которые содержат импортированные данные из подключенных или внешних источников данных, можно настроить обновление данных, чтобы запланировать автоматический импорт данных из этих источников.</span><span class="sxs-lookup"><span data-stu-id="86e42-129">For PowerPivot workbooks that contain imported data from connected or external data sources, you can configure data refresh to schedule an automatic import of updated data from those original sources.</span></span>  
  
 <span data-ttu-id="86e42-130">Доступ к внешнему источнику данных осуществляется с помощью внедренной строки подключения, URL-адреса или пути в формате UNC, которые указаны при импорте исходных данных в книгу с использованием клиентского приложения PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="86e42-130">An external data source is accessed through an embedded connection string, URL, or UNC path that you specified when you imported the original data into the workbook using the PowerPivot client application.</span></span> <span data-ttu-id="86e42-131">Исходные сведения о соединении, хранящиеся в книге PowerPivot, повторно используются в последующих операциях обновления данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-131">Original connection information that is stored in the PowerPivot workbook is reused for subsequent data refresh operations.</span></span> <span data-ttu-id="86e42-132">Несмотря на то, что учетные данные, используемые для соединения с источником данных, можно изменить, строку соединения для обновления данных изменить нельзя; используются только сведения о существующих соединениях.</span><span class="sxs-lookup"><span data-stu-id="86e42-132">Although you can overwrite credentials used to connect to data sources, you cannot overwrite connection strings for data refresh purposes; only existing connection information is used.</span></span>  
  
 <span data-ttu-id="86e42-133">Для каждой книги существует только одна страница расписания обновления данных, на которой указаны все сведения.</span><span class="sxs-lookup"><span data-stu-id="86e42-133">There is only one data refresh schedule page for each workbook, and all schedule information is specified on that page.</span></span> <span data-ttu-id="86e42-134">Как правило, расписание определяет пользователь, создающий книгу.</span><span class="sxs-lookup"><span data-stu-id="86e42-134">Typically, the person who authored the workbook defines the schedule.</span></span>  
  
 <span data-ttu-id="86e42-135">Владелец расписания выполняет следующие задачи.</span><span class="sxs-lookup"><span data-stu-id="86e42-135">As the schedule owner, you perform the following tasks:</span></span>  
  
-   <span data-ttu-id="86e42-136">Определение расписания по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="86e42-136">Define the default schedule.</span></span> <span data-ttu-id="86e42-137">Это расписание, которое используется, когда на уровне источника данных не определены расписания.</span><span class="sxs-lookup"><span data-stu-id="86e42-137">This is the schedule that is used if there are no scheduled defined at the data source level.</span></span>  
  
-   <span data-ttu-id="86e42-138">Указание учетных данных для обновления данных</span><span class="sxs-lookup"><span data-stu-id="86e42-138">Specify the credentials used to run data refresh</span></span>  
  
-   <span data-ttu-id="86e42-139">Выберите, какие источники данных будут включены в операцию обновления.</span><span class="sxs-lookup"><span data-stu-id="86e42-139">Choose which data sources to include in the refresh operation.</span></span>  
  
-   <span data-ttu-id="86e42-140">Укажите встроенные отдельные расписания и учетные данные для каждого источника данных, который запрашивается в ходе обновления данных (необязательно).</span><span class="sxs-lookup"><span data-stu-id="86e42-140">Optionally, specify in-line, individual schedules and credentials for each data source that is queried during data refresh.</span></span> <span data-ttu-id="86e42-141">Каждый источник данных можно обновлять независимо.</span><span class="sxs-lookup"><span data-stu-id="86e42-141">Each data source can be refreshed independently.</span></span> <span data-ttu-id="86e42-142">Если создать пользовательские расписания для каждого источника данных, то расписание по умолчанию не действует.</span><span class="sxs-lookup"><span data-stu-id="86e42-142">If you create custom schedules for every data source, the default schedule is ignored.</span></span>  
  
 <span data-ttu-id="86e42-143">Создание подробных расписаний для отдельных источников данных позволяет учесть в расписании обновления непостоянные изменения, происходящие во внешних источниках данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-143">Creating granular schedules for individual data sources enables you to match the refresh schedule to fluctuations in the external data sources.</span></span> <span data-ttu-id="86e42-144">Например, если внешний источник данных содержит данные о транзакциях, происходящих в течение дня, то можно создать отдельное расписание обновления данных для этого источника данных для получения обновлений ближе к вечеру.</span><span class="sxs-lookup"><span data-stu-id="86e42-144">For example, if an external data source contains transactional data that is generated throughout the day, you can create an individual data refresh schedule for that data source to get its updated information nightly.</span></span>  
  
##  <a name="enable-and-schedule-data-refresh"></a><a name="drenablesched"></a><span data-ttu-id="86e42-145">Включение и планирование обновления данных</span><span class="sxs-lookup"><span data-stu-id="86e42-145">Enable and schedule data refresh</span></span>  
 <span data-ttu-id="86e42-146">Следующие инструкции описывают процесс планирования обновления данных PowerPivot в книге Excel, опубликованной в библиотеке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="86e42-146">Use the following instructions to schedule data refresh for PowerPivot data in an Excel workbook that is published to a SharePoint library.</span></span>  
  
1.  <span data-ttu-id="86e42-147">В библиотеке, которая содержит книгу, выберите книгу, а затем нажмите стрелку вниз, чтобы открыть список команд.</span><span class="sxs-lookup"><span data-stu-id="86e42-147">In the library that contains the workbook, select the workbook and then click the down arrow to display a list of commands.</span></span>  
  
2.  <span data-ttu-id="86e42-148">Щелкните ссылку **Управление обновлением данных PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="86e42-148">Click **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="86e42-149">Если расписание обновления данных уже определено, то вместо этого появится страница «Просмотр журнала обновления данных».</span><span class="sxs-lookup"><span data-stu-id="86e42-149">If a data refresh schedule is already defined, you will see the View Data Refresh history page instead.</span></span> <span data-ttu-id="86e42-150">Можно нажать **Настройка обновления данных** , чтобы открыть страницу определения расписания.</span><span class="sxs-lookup"><span data-stu-id="86e42-150">You can click **Configure data refresh** to open the schedule definition page.</span></span>  
  
3.  <span data-ttu-id="86e42-151">На странице определения расписания установите флажок **Включить** .</span><span class="sxs-lookup"><span data-stu-id="86e42-151">In the schedule definition page, select the **Enable** checkbox.</span></span>  
  
4.  <span data-ttu-id="86e42-152">На странице «Подробности расписания» укажите тип расписания и подробные данные расписания.</span><span class="sxs-lookup"><span data-stu-id="86e42-152">In Schedule Details, specify the type of schedule and specify its details.</span></span> <span data-ttu-id="86e42-153">На этом шаге создается расписание по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="86e42-153">This step creates the default schedule.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="86e42-154">Обязательно установите флажок **Кроме того, как можно скорее обновить данные** .</span><span class="sxs-lookup"><span data-stu-id="86e42-154">Be sure to select the **Also refresh as soon as possible** checkbox.</span></span> <span data-ttu-id="86e42-155">Выполнение этих действий позволит проверить работоспособность обновления данных для этой книги.</span><span class="sxs-lookup"><span data-stu-id="86e42-155">Doing so lets you verify that data refresh is operational for this workbook.</span></span> <span data-ttu-id="86e42-156">Следует учитывать, что может потребоваться определенное время для запуска обновления данных после сохранения расписания.</span><span class="sxs-lookup"><span data-stu-id="86e42-156">Note that after you save schedule, it can take up to a minute for data refresh to start.</span></span>  
  
5.  <span data-ttu-id="86e42-157">В поле «Самое раннее время запуска» выберите одно из следующих значений.</span><span class="sxs-lookup"><span data-stu-id="86e42-157">In Earliest Start Time, choose one of the following:</span></span>  
  
    1.  <span data-ttu-id="86e42-158">Параметр**По окончании рабочего времени** указывает период обработки в нерабочее время, в который на серверах баз данных, вероятнее всего, будут находиться текущие данные, созданные на протяжении рабочего дня.</span><span class="sxs-lookup"><span data-stu-id="86e42-158">**After business hours** specifies an off-hours processing period when database servers are more likely to have current data that was generated throughout the business day.</span></span>  
  
    2.  <span data-ttu-id="86e42-159">Параметр**Заданное самое раннее время запуска** указывает часы и минуты самого раннего времени дня, в которое к очереди обработки добавляется запрос на обновление данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-159">**Specific earliest start time** is the hour and minutes of the earliest time of day the data refresh request is added to a process queue.</span></span> <span data-ttu-id="86e42-160">Время задается с интервалами в 15 минут.</span><span class="sxs-lookup"><span data-stu-id="86e42-160">You can specify minutes in 15-minute intervals.</span></span> <span data-ttu-id="86e42-161">Этот параметр относится к текущему дню, а также к будущим датам.</span><span class="sxs-lookup"><span data-stu-id="86e42-161">The setting applies to the current day as well as future dates.</span></span> <span data-ttu-id="86e42-162">Например, если указано значение 6:30,</span><span class="sxs-lookup"><span data-stu-id="86e42-162">For example, if you specify a value of 6:30 A.M.</span></span> <span data-ttu-id="86e42-163">а текущее время — 16:30, то запрос на обновление будет добавлен к очереди в текущий день, поскольку время 16:30 следует</span><span class="sxs-lookup"><span data-stu-id="86e42-163">and the current time is 4:30 P.M., the refresh request will be added to the queue in the current day because 4:30 P.M.</span></span> <span data-ttu-id="86e42-164">за 6:30.</span><span class="sxs-lookup"><span data-stu-id="86e42-164">is after 6:30 A.M.</span></span>  
  
     <span data-ttu-id="86e42-165">Самое раннее время начала определяет, когда происходит добавление запроса к очереди процессов.</span><span class="sxs-lookup"><span data-stu-id="86e42-165">Earliest start time defines when a request is added to the process queue.</span></span> <span data-ttu-id="86e42-166">Фактическая обработка происходит после того, как на сервере освободится достаточно ресурсов, чтобы можно было начать обработку данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-166">Actual processing occurs when the server has adequate resources to begin data processing.</span></span> <span data-ttu-id="86e42-167">Фактическое время обработки записывается в журнал обновления данных после завершения обработки.</span><span class="sxs-lookup"><span data-stu-id="86e42-167">Actual processing time will be recorded in data refresh history after processing is complete.</span></span>  
  
6.  <span data-ttu-id="86e42-168">Установите флажок **Также обновлять как можно скорее** для запуска обновления при первой же возможности, как только сервер сможет его выполнить.</span><span class="sxs-lookup"><span data-stu-id="86e42-168">Select the checkbox **Also refresh as soon as possible** to run data refresh as soon as the server can process it.</span></span> <span data-ttu-id="86e42-169">Успешный результат задания обновления данных говорит о том, что источники данных доступны, а разрешения и конфигурация сервера настроены правильно.</span><span class="sxs-lookup"><span data-stu-id="86e42-169">A successful outcome of a data refresh job verifies that the data sources are available and that permissions and server configuration are set correctly.</span></span>  
  
7.  <span data-ttu-id="86e42-170">В окне «Уведомления по электронной почте» введите адрес электронной почты пользователя, который должен получать уведомление в случае ошибки обработки.</span><span class="sxs-lookup"><span data-stu-id="86e42-170">In E-mail notifications, enter the e-mail address of the person who should be notified in the event of a processing error.</span></span>  
  
8.  <span data-ttu-id="86e42-171">В учетных данных укажите учетную запись, используемую для запуска задания обновления данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-171">In Credentials, specify an account used to run the data refresh job.</span></span> <span data-ttu-id="86e42-172">Учетная запись должна иметь разрешения «Участие» по отношению к книге, чтобы можно было открыть книгу для обновления в ней данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-172">The account must have Contribute permissions on the workbook so that it can open the workbook to refresh its data.</span></span> <span data-ttu-id="86e42-173">Это должна быть учетная запись пользователя домена Windows.</span><span class="sxs-lookup"><span data-stu-id="86e42-173">It must be a Windows domain user account.</span></span> <span data-ttu-id="86e42-174">Во многих случаях эта учетная запись должна также иметь разрешения на чтение внешних источников данных, которые используются при обновлении данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-174">In many cases, this account must also have read permissions on the external data sources used during data refresh.</span></span> <span data-ttu-id="86e42-175">В частности, если изначально данные импортировались с параметром «Использовать проверку подлинности Windows», то строка подключения будет содержать учетные данные Windows текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="86e42-175">Specifically, if you originally imported the data using the Use Windows Authentication option, then the connection string is built to use the Windows credentials of the current user.</span></span> <span data-ttu-id="86e42-176">Если текущим пользователем является учетная запись обновления данных, то для успешного обновления данных у нее должны быть разрешения на внешний источник данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-176">If the current user is the data refresh account, that account must have read permissions on the external data source in order for data refresh to succeed.</span></span> <span data-ttu-id="86e42-177">Выберите один из следующих вариантов.</span><span class="sxs-lookup"><span data-stu-id="86e42-177">Choose one of the following options:</span></span>  
  
    1.  <span data-ttu-id="86e42-178">Выберите вариант **Использовать учетную запись обновления данных, настроенную администратором** , чтобы обрабатывать операцию обновления данных с помощью учетной записи автоматического обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="86e42-178">Choose **Use the data refresh account configured by the administrator** to process the data refresh operation using the PowerPivot unattended data refresh account.</span></span>  
  
    2.  <span data-ttu-id="86e42-179">Выберите вариант **Подключение со следующими учетными данными пользователя Windows** , если нужно вводить имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="86e42-179">Choose **Connect using the following Windows user credentials** if you want to enter a user name and password.</span></span> <span data-ttu-id="86e42-180">Данные учетной записи вводятся в формате «домен\пользователь».</span><span class="sxs-lookup"><span data-stu-id="86e42-180">Enter the account information in domain\user format.</span></span>  
  
    3.  <span data-ttu-id="86e42-181">Выберите вариант **Подключение с учетными данными, сохраненными в службе Secure Store** , если известен идентификатор целевого приложения, содержащего ранее сохраненные учетные данные, которые нужно использовать.</span><span class="sxs-lookup"><span data-stu-id="86e42-181">Choose **Connect using the credentials saved in Secure Store Service** if you know the ID of a target application that contains previously stored credentials you want to use.</span></span>  
  
     <span data-ttu-id="86e42-182">Дополнительные сведения об этих параметрах см. в статьях [Настройка сохраненных учетных данных для обновления данных powerpivot &#40;PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) и [Настройка учетной записи автоматического обновления данных powerpivot &#40;PowerPivot для SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="86e42-182">For more information about these options, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
9. <span data-ttu-id="86e42-183">В окне «Источники данных» отметьте флажок **Все источники данных** , если нужно, чтобы при обновлении данных были выполнены повторные запросы ко всем исходным источникам данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-183">In Data Sources, select the **All data sources** checkbox if you want data refresh to re-query all of the original data sources.</span></span>  
  
     <span data-ttu-id="86e42-184">Если выбран этот параметр, то любой внешний источник данных, который предоставляет данные PowerPivot, автоматически включается в обновление, даже если список источников данных изменился в результате добавления или удаления источников данных, которые предоставляют данные для книги.</span><span class="sxs-lookup"><span data-stu-id="86e42-184">If you select this option, any external data source that provides PowerPivot data is automatically included in the refresh, even if the list of data sources changes over time as you add or remove data sources that provide data to the workbook.</span></span>  
  
     <span data-ttu-id="86e42-185">Снимите флажок **Все источники данных** , если необходимо выбрать включаемые источники данных вручную.</span><span class="sxs-lookup"><span data-stu-id="86e42-185">Clear the **All data sources** checkbox if you want to manually select which data sources to include.</span></span> <span data-ttu-id="86e42-186">Если в дальнейшем в книге будет производиться добавление нового источника данных, то следует обязательно обновить список источников данных в расписании.</span><span class="sxs-lookup"><span data-stu-id="86e42-186">If you later modify the workbook by adding a new data source, be sure to update the data source list in the schedule.</span></span> <span data-ttu-id="86e42-187">В противном случае новые источники данных не будут включены в операцию обновления.</span><span class="sxs-lookup"><span data-stu-id="86e42-187">Otherwise, newer data sources will not be included in the refresh operation.</span></span>  
  
     <span data-ttu-id="86e42-188">Список источников данных, которые можно выбирать, получается из книги PowerPivot при открытии страницы «Управление обновлением данных PowerPivot» для книги.</span><span class="sxs-lookup"><span data-stu-id="86e42-188">The list of data sources that you can choose from is retrieved from the PowerPivot workbook when you open the Manage PowerPivot Data Refresh page for the workbook.</span></span>  
  
     <span data-ttu-id="86e42-189">Следует выбирать только те источники данных, которые соответствуют следующим критериям.</span><span class="sxs-lookup"><span data-stu-id="86e42-189">Be sure to select only those data sources that meet the following criteria:</span></span>  
  
    -   <span data-ttu-id="86e42-190">Источник данных должен быть доступен в указанном расположении в момент обновления данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-190">The data source must be available at the time that data refresh occurs and at the stated location.</span></span> <span data-ttu-id="86e42-191">Если исходный источник данных находится на локальном диске пользователя, который создал книгу, то необходимо либо исключить этот источник из операции обновления данных, либо опубликовать его в расположении, доступном через сетевое соединение.</span><span class="sxs-lookup"><span data-stu-id="86e42-191">If the original data source is on a local disk drive of the person who authored the workbook, you must either exclude that data source from the data refresh operation, or find a way to publish that data source to a location that is accessible through a network connection.</span></span> <span data-ttu-id="86e42-192">Если переместить источник данных в сетевую папку, необходимо открыть книгу в [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] и обновить данные о соединении с источником данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-192">If you move a data source to a network location, be sure to open the workbook in [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] and update the data source connection information.</span></span> <span data-ttu-id="86e42-193">Это необходимо для повторного задания сведений о соединении, которые хранятся в книге PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="86e42-193">This is necessary to re-establish the connection information that is stored in the PowerPivot workbook.</span></span>  
  
    -   <span data-ttu-id="86e42-194">Доступ к источнику данных должен производиться с использованием учетных данных, внедренных в книгу PowerPivot или указанных в расписании.</span><span class="sxs-lookup"><span data-stu-id="86e42-194">The data source must be accessed using the credential information that is embedded in the PowerPivot workbook or that is specified in the schedule.</span></span> <span data-ttu-id="86e42-195">Внедренные учетные данные хранятся в книге PowerPivot при импорте данных с помощью PowerPivot для Excel.</span><span class="sxs-lookup"><span data-stu-id="86e42-195">Embedded credential information is stored in the PowerPivot workbook when you import data using PowerPivot for Excel.</span></span> <span data-ttu-id="86e42-196">Внедренные учетные данные часто содержат параметр «SSPI = IntegratedSecurity» или «SSPI = TrustedConnection», что означает использование учетных данных текущего пользователя для подключения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-196">Embedded credential information is often SSPI=IntegratedSecurity or SSPI=TrustedConnection, which means use the credentials of the current user to connect to the data source.</span></span> <span data-ttu-id="86e42-197">Если требуется переопределить учетные данные в расписании обновления данных, можно указать стандартные сохраненные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="86e42-197">If you want to override the credential information in your data refresh schedule, you can specify predefined, stored credentials.</span></span> <span data-ttu-id="86e42-198">Дополнительные сведения см. в разделе [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="86e42-198">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
    -   <span data-ttu-id="86e42-199">Обновление данных должно завершиться успешно для всех указанных источников данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-199">Data refresh must succeed for all of the data sources that you specify.</span></span> <span data-ttu-id="86e42-200">В противном случае обновленные данные будут отвергнуты и в распоряжении пользователя останется последняя сохраненная версия книги.</span><span class="sxs-lookup"><span data-stu-id="86e42-200">Otherwise, the refreshed data is discarded, leaving you with the last saved version of the workbook.</span></span> <span data-ttu-id="86e42-201">Исключите все источники данных, в отношении которых нет полной уверенности.</span><span class="sxs-lookup"><span data-stu-id="86e42-201">Exclude any data sources that you are not sure about.</span></span>  
  
    -   <span data-ttu-id="86e42-202">Обновление данных не должно приводить к тому, что другие данные в книге станут недействительными.</span><span class="sxs-lookup"><span data-stu-id="86e42-202">Data refresh must not invalidate other data in your workbook.</span></span> <span data-ttu-id="86e42-203">При обновлении подмножества данных важно знать, останутся ли данные книги действительными после объединения новых данных с данными, оставшимися неизменными, которые относятся к другому периоду времени.</span><span class="sxs-lookup"><span data-stu-id="86e42-203">When you refresh a subset of your data, it is important that you understand whether the workbook is still valid once newer data is aggregated with static data that is not from the same time period.</span></span> <span data-ttu-id="86e42-204">Задача изучения зависимостей в данных и обеспечения приемлемости обновления данных для самой книги возлагается на ее автора.</span><span class="sxs-lookup"><span data-stu-id="86e42-204">As a workbook author, it is up to you to know your data dependencies and ensure that data refresh is appropriate for the workbook itself.</span></span>  
  
10. <span data-ttu-id="86e42-205">При необходимости можно определить отдельные расписания для конкретных источников данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-205">Optionally, you can define individual schedules for specific data sources.</span></span> <span data-ttu-id="86e42-206">Это может потребоваться в том случае, если имеются такие исходные источники данных, которые сами обновляются по расписанию.</span><span class="sxs-lookup"><span data-stu-id="86e42-206">This is useful if you have original data sources that are themselves updated on a schedule.</span></span> <span data-ttu-id="86e42-207">Например, если в источнике данных PowerPivot используются данные из киоска данных, обновление которой происходит по понедельникам в 02:00, то можно определить встроенное расписание получения обновлений по понедельникам в 04:00.</span><span class="sxs-lookup"><span data-stu-id="86e42-207">For example, if a PowerPivot data source uses data from a data mart that is refreshed every Monday at 02:00 hours, you can define an inline schedule for the data mart to retrieve its refreshed data every Monday at 04:00 hours.</span></span>  
  
11. <span data-ttu-id="86e42-208">Нажмите кнопку **ОК** , чтобы сохранить расписание.</span><span class="sxs-lookup"><span data-stu-id="86e42-208">Click **OK** to save your schedule.</span></span>  
  
##  <a name="verify-data-refresh"></a><a name="drverify"></a><span data-ttu-id="86e42-209">Проверка обновления данных</span><span class="sxs-lookup"><span data-stu-id="86e42-209">Verify Data Refresh</span></span>  
 <span data-ttu-id="86e42-210">Наилучший способ проверить обновление данных — выполнить обновление данных сразу, затем проверить на странице журнала, успешно ли оно выполнено.</span><span class="sxs-lookup"><span data-stu-id="86e42-210">The best way to verify data refresh is to execute data refresh right away and then review the history page to see whether it completed successfully.</span></span> <span data-ttu-id="86e42-211">Наличие установленного флажка **Также обновлять как можно скорее** в расписании обеспечивает проверку работоспособности обновления данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-211">Selecting the **Also refresh as soon as possible** checkbox on your schedule will provide the verification that data refresh is operational.</span></span>  
  
 <span data-ttu-id="86e42-212">Просмотреть регистрацию текущей и прошлой операций обновления данных можно на странице «Журнал обновления данных» для данной книги.</span><span class="sxs-lookup"><span data-stu-id="86e42-212">You can view the current and past record of data refresh operations in the Data Refresh History page for the workbook.</span></span> <span data-ttu-id="86e42-213">Эта страница отображается только в том случае, если для книги запланировано обновление данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-213">This page only appears if data refresh has been scheduled for a workbook.</span></span> <span data-ttu-id="86e42-214">Если расписание обновления данных отсутствует, то вместо этого появляется страница определения расписания.</span><span class="sxs-lookup"><span data-stu-id="86e42-214">If there is no data refresh schedule, the schedule definition page appears instead.</span></span>  
  
 <span data-ttu-id="86e42-215">Для просмотра журнала обновления данных необходим уровень разрешений «Участие» или выше.</span><span class="sxs-lookup"><span data-stu-id="86e42-215">You must have Contribute permissions or greater to view data refresh history.</span></span>  
  
1.  <span data-ttu-id="86e42-216">На сайте SharePoint откройте библиотеку, которая содержит книгу PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="86e42-216">On a SharePoint site, open the library that contains a PowerPivot workbook.</span></span>  
  
     <span data-ttu-id="86e42-217">Визуальный индикатор, указывающий, какие книги в библиотеке SharePoint содержат данные PowerPivot, отсутствует.</span><span class="sxs-lookup"><span data-stu-id="86e42-217">There is no visual indicator that identifies which workbooks in a SharePoint library contain PowerPivot data.</span></span> <span data-ttu-id="86e42-218">Книги, содержащие обновляемые данные PowerPivot, должны быть известны заранее.</span><span class="sxs-lookup"><span data-stu-id="86e42-218">You must know in advance which workbooks contain refreshable PowerPivot data.</span></span>  
  
2.  <span data-ttu-id="86e42-219">Выберите книгу и нажмите стрелку вниз, которая появляется справа.</span><span class="sxs-lookup"><span data-stu-id="86e42-219">Select the document, and then click the down arrow that appears to the right.</span></span>  
  
3.  <span data-ttu-id="86e42-220">Щелкните ссылку **Управление обновлением данных PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="86e42-220">Select **Manage PowerPivot Data Refresh**.</span></span>  
  
 <span data-ttu-id="86e42-221">Отображается страница истории, показывающая полную запись всех действий обновления для данных PowerPivot в текущей книге Excel, включая состояние последней операции обновления данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-221">The history page appears, showing a complete record for all refresh activity for PowerPivot data in the current Excel workbook, including the status of the most recent data refresh operation.</span></span>  
  
 <span data-ttu-id="86e42-222">В некоторых случаях могут быть показаны фактические значения времени обработки, которые отличаются от времени, указанного пользователем.</span><span class="sxs-lookup"><span data-stu-id="86e42-222">In some cases, you might see actual processing times that differ from the time you specified.</span></span> <span data-ttu-id="86e42-223">Это происходит в том случае, если сервер испытывает интенсивную рабочую нагрузку.</span><span class="sxs-lookup"><span data-stu-id="86e42-223">This will occur if there is a heavy processing load on the server.</span></span> <span data-ttu-id="86e42-224">При сильной нагрузке экземпляр службы [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] ожидает освобождения достаточного объема системных ресурсов и только после этого приступает к обновлению данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-224">Under heavy load, the [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] service instance will wait until enough system resources are free before it begins a data refresh.</span></span>  
  
 <span data-ttu-id="86e42-225">После завершения операции обновления книга должна быть возвращена.</span><span class="sxs-lookup"><span data-stu-id="86e42-225">The workbook must be checked in when the refresh operation is finished.</span></span> <span data-ttu-id="86e42-226">Вслед за этим происходит сохранение книги с обновленными данными.</span><span class="sxs-lookup"><span data-stu-id="86e42-226">The workbook will be saved with the refreshed data at that time.</span></span> <span data-ttu-id="86e42-227">Если файл извлечен, то обновление данных пропускается до следующего запланированного времени.</span><span class="sxs-lookup"><span data-stu-id="86e42-227">If the file is checked out, data refresh is skipped until the next scheduled time.</span></span>  
  
 <span data-ttu-id="86e42-228">Если обнаруживается непредвиденное сообщение о состоянии (например, о том, что операция обновления завершилась сбоем или была отменена), то причины возникшей проблемы можно узнать, проверив разрешения и доступность сервера.</span><span class="sxs-lookup"><span data-stu-id="86e42-228">If you see a status message that is unexpected (for example, a refresh operation failed or was cancelled), you can investigate the problem by checking permissions and server availability.</span></span>  
  
 <span data-ttu-id="86e42-229">Просмотрите страницу устранения неполадок обновления данных PowerPivot в сети TechNet WIKI для получения справки по разрешению проблем обновления данных.</span><span class="sxs-lookup"><span data-stu-id="86e42-229">Review the PowerPivot data refresh troubleshooting page on the TechNet WIKI for help on resolving data refresh problems.</span></span> <span data-ttu-id="86e42-230">Дополнительные сведения см. в разделе [Устранение неполадок обновления данных PowerPivot](https://go.microsoft.com/fwlink/?LinkId=251594)</span><span class="sxs-lookup"><span data-stu-id="86e42-230">For more information see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkId=251594).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="86e42-231">Администраторы SharePoint могут помочь в устранении неполадок с обновлением данных, просмотрев сводные отчеты по обновлению данных на панели мониторинга PowerPivot в центре администрирования.</span><span class="sxs-lookup"><span data-stu-id="86e42-231">SharePoint administrators can help you troubleshoot data refresh problems by viewing the consolidated data refresh reports in the PowerPivot Management Dashboard in Central Administration.</span></span> <span data-ttu-id="86e42-232">Дополнительные сведения см. в разделе [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="86e42-232">For more information, see [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="86e42-233">См. также:</span><span class="sxs-lookup"><span data-stu-id="86e42-233">See Also</span></span>  
 <span data-ttu-id="86e42-234">[Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="86e42-234">[PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="86e42-235">[Просмотр журнала обновления данных &#40;PowerPivot для SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="86e42-235">[View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="86e42-236">Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="86e42-236">Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;</span></span>](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)  
  
  
