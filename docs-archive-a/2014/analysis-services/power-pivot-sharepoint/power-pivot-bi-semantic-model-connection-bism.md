---
title: Соединение семантической модели бизнес-аналитики PowerPivot (. BISM) | Документация Майкрософт
ms.custom: ''
ms.date: 04/19/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 08828eec-4f8c-4f34-a145-e442f7b7031d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 14a30128986a5ba23cb093be771c036c94fa25ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667430"
---
# <a name="powerpivot-bi-semantic-model-connection-bism"></a>Соединение семантической модели бизнес-аналитики PowerPivot (BISM)
  Соединение семантической модели бизнес-аналитики (BISM-файл) — это переносимое соединение, связывающее отчеты Excel или [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] с базой данных табличной модели [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] или экземпляром [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] во многомерном режиме. Определение и использование BISM-файлов в определенной степени аналогично файлам подключения к данным Оffice (ODC).  
  
 Создание семантической модели бизнес-аналитики и доступ к ней через SharePoint. Создание соединения семантической модели бизнес-аналитики позволяет использовать команды быстрого запуска соединения семантической модели с библиотекой. Команды быстрого запуска открывают новую книгу Excel или параметры файла соединения. При установке [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] также появится команда для создания отчета [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] .  
  
 ![Снимок экрана: команда быстрого запуска BISM](../media/ssas-bism-quicklaunch.gif "Снимок экрана: команда быстрого запуска BISM")  
  
##  <a name="supported-databases"></a><a name="bkmk_prereq"></a>Поддерживаемые базы данных  
 Соединение семантической модели бизнес-аналитики указывает на данные табличной модели. Существует три источника этих данных.  
  
-   Табличный шаблон базы данных, запущенный на отдельном экземпляре служб Analysis Services в режиме табличного сервера. Развертывание отдельного экземпляра служб Analysis Services выполняется вне пределов фермы. Для доступа к источникам данных, находящимся за пределами фермы, требуются дополнительные разрешения, о которых можно прочитать в следующем разделе: [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).  
  
-   Книги PowerPivot, сохраненные в SharePoint. Базы данных PowerPivot, внедренные в книги Excel, эквивалентны табличным шаблонам баз данных, запущенным на отдельном сервере Analysis Services в табличном режиме. Если PowerPivot для Excel и PowerPivot для SharePoint уже используются, то можно определить соединение семантической модели бизнес-аналитики, указывающее на книги PowerPivot из библиотеки SharePoint, и создавать отчеты [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] с использованием существующих данных PowerPivot.  Можно использовать книги, созданные в версиях PowerPivot для Excel в SQL Server 2008 R2 или [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] .  
  
-   Модель многомерных данных в экземпляре [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
 Сравнение источников данных см. в содержимом сообщества, посвященном [семантической модели бизнес-аналитики SQL Server 2012 (BISM)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/).  
  
## <a name="understanding-the-connection-sequence-for-bi-semantic-connections"></a>Основные сведения о последовательности соединения для семантической модели бизнес-аналитики  
 В этом разделе описывается работа соединений между различными клиентскими приложениями, в том числе Excel или клиентом отчетов Power View в SharePoint, и базой данных табличной модели, находящейся в пределах или вне пределов фермы SharePoint.  
  
 Все соединения с базой данных табличной модели устанавливаются с учетными данными пользователя, запрашивающего данные. Однако механизм соединения различается в зависимости от того, устанавливается ли оно в пределах фермы, состоит ли из одного или двух этапов и включен ли протокол Kerberos. Дополнительные сведения об аутентификации соединений между SharePoint и серверными источниками данных см. в разделе [Double-hop authentication: Why NTLM fails and Kerberos works](https://go.microsoft.com/fwlink/?LinkId=237137)(Двухэтапная аутентификация: почему Kerberos работает, а NTLM — нет).  
  
 **Соединение с табличными данными из Excel по сети**  
  
 Когда пользователь Excel указывает соединение семантической модели бизнес-аналитики в качестве источника данных, сведения о соединении в BISM-файле загружаются в клиентское приложение, которое затем создает собственный прямой запрос к базе данных табличной модели в службах Analysis Services. Для доступа к BISM-соединению пользователь Excel должен быть пользователем SharePoint с разрешениями на чтение BISM-файла соединения. После загрузки сведений о соединении все последующие соединения устанавливаются без участия SharePoint, непосредственно от Excel к серверной базе данных табличной модели.  
  
 На следующем рисунке показана эта последовательность соединения. Она начинается с запроса BISM-соединения, затем сведения о соединении загружаются на клиент, и, наконец, устанавливается одноэтапное соединение с базой данных. Соединение устанавливается с использованием учетных данных Windows пользователя Excel, обладающего разрешениями на чтение базы данных служб Analysis Services. Поскольку соединение устанавливается в один этап, то, даже когда включен протокол Kerberos, он необязателен в таком сценарии.  
  
 ![Соединения из Excel с табличной моделью шаблона базы данных](../media/ssas-powerpivotbismconnection-1.gif "Соединения из Excel с табличной моделью шаблона базы данных")  
  
 **Соединение с табличными данными из Power View по сети**  
  
 Когда пользователь SharePoint выбирает соединение семантической модели бизнес-аналитики в библиотеке документов, то немедленно запускается приложение Power View (если оно установлено) и открывает соединение с базой данных табличной модели.  
  
 В соединениях между Power View и базой данных табличной модели применяется двухэтапная последовательность проверки подлинности, когда удостоверение пользователя передается от клиента в SharePoint, а затем от SharePoint в серверную базу данных табличной модели служб Analysis Services, которая работает вне фермы. Клиентская библиотека ADOMD.NET, которая обрабатывает запрос на соединение, сначала всегда применяет протокол Kerberos. Если настроен протокол Kerberos, то выполняется олицетворение пользователя в соединении с базой данных табличной модели и подключение устанавливается успешно.  
  
 Если протокол Kerberos не настроен и первый запрос соединения не выполняется, то службы Reporting Services создают второй запрос. В этом случае клиентская библиотека подключается к службам Analysis Services с использованием удостоверения службы Reporting Services и проверки подлинности NTLM. Удостоверение пользователя Power View передается в строке подключения в параметре `effectiveusername`.  
  
 Только член роли системного администратора в экземпляре служб Analysis Services имеет разрешение на подключение с параметром `effectiveusername` и олицетворение другого пользователя в экземпляре сервера. Поэтому учетная запись выполнения для общей службы Reporting Services должна иметь права администратора в экземпляре служб Analysis Services.  Инструкции по предоставлению административных разрешений учетной записи службы приведены в подразделе [Создание подключения между семантической моделью бизнес-аналитики и книгой PowerPivot](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)этого раздела.  
  
 На следующем рисунке показана последовательность, в которой для каждого соединения используется одно и то же удостоверение пользователя Windows. Последнее соединение со службами Analysis Services устанавливается удостоверением приложения службы Reporting Services без удостоверения пользователя Windows. Для этого используется параметр `effectiveusername`.  
  
 ![Олицетворенное соединение с табличной базой данных](../media/ssas-powerpivotbismconnection-2.gif "Олицетворенное соединение с табличной базой данных")  
  
 **Соединение с данными PowerPivot в SharePoint из Power View**  
  
 Когда пользователь SharePoint выбирает соединение семантической модели бизнес-аналитики, которое указывает на книгу PowerPivot на той же ферме, то соединение выполняется в контексте среды SharePoint. Приложение службы PowerPivot обрабатывает запрос на соединение и направляет его в экземпляр служб Analysis Services на том же компьютере. Экземпляр служб Analysis Services извлекает данные PowerPivot из книги и загружает их. Все последующие соединения управляются приложением службы PowerPivot на ферме.  
  
 В этом случае все соединения устанавливаются в пределах фермы и нет необходимости применять протокол Kerberos или ограниченное делегирование.  
  
##  <a name="related-tasks"></a><a name="bkmk_rel"></a> Связанные задачи  
 [Добавление типа содержимого соединения семантической модели бизнес-аналитики в библиотеку &#40;PowerPivot для SharePoint&#41;](add-bi-semantic-model-connection-content-type-to-library.md)  
  
 [Создание соединения семантической модели бизнес-аналитики с книгой PowerPivot](create-a-bi-semantic-model-connection-to-a-power-pivot-workbook.md)  
  
 [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)  
  
 [Использование соединения семантической модели бизнес-аналитики в службах Excel или Reporting Services](use-a-bi-semantic-model-connection-in-excel-or-reporting-services.md)  
  
## <a name="see-also"></a>См. также:  
 [Определение режима работы сервера для экземпляра Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md)   
 [Подключение к службам Analysis Services](../instances/connect-to-analysis-services.md)  
  
  
