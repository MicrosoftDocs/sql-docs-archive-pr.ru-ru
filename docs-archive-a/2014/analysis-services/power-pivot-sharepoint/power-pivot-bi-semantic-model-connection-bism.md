---
title: Соединение семантической модели бизнес-аналитики PowerPivot (. BISM) | Документация Майкрософт
ms.custom: ''
ms.date: 04/19/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 08828eec-4f8c-4f34-a145-e442f7b7031d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 14a30128986a5ba23cb093be771c036c94fa25ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667430"
---
# <a name="powerpivot-bi-semantic-model-connection-bism"></a><span data-ttu-id="5a7fa-102">Соединение семантической модели бизнес-аналитики PowerPivot (BISM)</span><span class="sxs-lookup"><span data-stu-id="5a7fa-102">PowerPivot BI Semantic Model Connection (.bism)</span></span>
  <span data-ttu-id="5a7fa-103">Соединение семантической модели бизнес-аналитики (BISM-файл) — это переносимое соединение, связывающее отчеты Excel или [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] с базой данных табличной модели [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] или экземпляром [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] во многомерном режиме.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-103">A BI semantic model connection (.bism) is a portable connection that connects Excel or [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports to an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model database or an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in multidimensional mode.</span></span> <span data-ttu-id="5a7fa-104">Определение и использование BISM-файлов в определенной степени аналогично файлам подключения к данным Оffice (ODC).</span><span class="sxs-lookup"><span data-stu-id="5a7fa-104">If you are familiar with office data connection (.odc) files, you will notice a similarity in how a .bism connection file is defined and used.</span></span>  
  
 <span data-ttu-id="5a7fa-105">Создание семантической модели бизнес-аналитики и доступ к ней через SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-105">A BI semantic model connection is created and accessed via SharePoint.</span></span> <span data-ttu-id="5a7fa-106">Создание соединения семантической модели бизнес-аналитики позволяет использовать команды быстрого запуска соединения семантической модели с библиотекой.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-106">Creating BI semantic model connections enables quick launch commands on a BI semantic model connection in a library.</span></span> <span data-ttu-id="5a7fa-107">Команды быстрого запуска открывают новую книгу Excel или параметры файла соединения.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-107">Quick launch commands open a new Excel workbook or options for editing the connection file.</span></span> <span data-ttu-id="5a7fa-108">При установке [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] также появится команда для создания отчета [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="5a7fa-108">If [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] is installed, you will also see a command to create a [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] report.</span></span>  
  
 <span data-ttu-id="5a7fa-109">![Снимок экрана: команда быстрого запуска BISM](../media/ssas-bism-quicklaunch.gif "Снимок экрана: команда быстрого запуска BISM")</span><span class="sxs-lookup"><span data-stu-id="5a7fa-109">![Screenshot of BISM quick launch command](../media/ssas-bism-quicklaunch.gif "Screenshot of BISM quick launch command")</span></span>  
  
##  <a name="supported-databases"></a><a name="bkmk_prereq"></a><span data-ttu-id="5a7fa-110">Поддерживаемые базы данных</span><span class="sxs-lookup"><span data-stu-id="5a7fa-110">Supported databases</span></span>  
 <span data-ttu-id="5a7fa-111">Соединение семантической модели бизнес-аналитики указывает на данные табличной модели.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-111">A BI semantic model connection points to tabular model data.</span></span> <span data-ttu-id="5a7fa-112">Существует три источника этих данных.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-112">There are three sources for this data:</span></span>  
  
-   <span data-ttu-id="5a7fa-113">Табличный шаблон базы данных, запущенный на отдельном экземпляре служб Analysis Services в режиме табличного сервера.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-113">A tabular model database running on a standalone Analysis Services instance in tabular server mode.</span></span> <span data-ttu-id="5a7fa-114">Развертывание отдельного экземпляра служб Analysis Services выполняется вне пределов фермы.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-114">A deployment of a standalone Analysis Services instance is external to the farm.</span></span> <span data-ttu-id="5a7fa-115">Для доступа к источникам данных, находящимся за пределами фермы, требуются дополнительные разрешения, о которых можно прочитать в следующем разделе: [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span><span class="sxs-lookup"><span data-stu-id="5a7fa-115">Accessing data sources off the farm requires additional permissions, which you can read about in this topic: [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
-   <span data-ttu-id="5a7fa-116">Книги PowerPivot, сохраненные в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-116">PowerPivot workbooks saved to SharePoint.</span></span> <span data-ttu-id="5a7fa-117">Базы данных PowerPivot, внедренные в книги Excel, эквивалентны табличным шаблонам баз данных, запущенным на отдельном сервере Analysis Services в табличном режиме.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-117">Embedded PowerPivot databases inside Excel workbooks are equivalent to tabular model databases that run on a standalone Analysis Services tabular mode server.</span></span> <span data-ttu-id="5a7fa-118">Если PowerPivot для Excel и PowerPivot для SharePoint уже используются, то можно определить соединение семантической модели бизнес-аналитики, указывающее на книги PowerPivot из библиотеки SharePoint, и создавать отчеты [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] с использованием существующих данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-118">If you already use PowerPivot for Excel and PowerPivot for SharePoint, you can define a BI semantic model connection that points to PowerPivot workbooks in a SharePoint library and build [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports using existing PowerPivot data.</span></span>  <span data-ttu-id="5a7fa-119">Можно использовать книги, созданные в версиях PowerPivot для Excel в SQL Server 2008 R2 или [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="5a7fa-119">You can use workbooks created in either SQL Server 2008 R2 or [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] versions of PowerPivot for Excel.</span></span>  
  
-   <span data-ttu-id="5a7fa-120">Модель многомерных данных в экземпляре [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="5a7fa-120">A multidimensional data model on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="5a7fa-121">Сравнение источников данных см. в содержимом сообщества, посвященном [семантической модели бизнес-аналитики SQL Server 2012 (BISM)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/).</span><span class="sxs-lookup"><span data-stu-id="5a7fa-121">For a comparison of the data sources, see the community  content [Understanding the SQL Server 2012 BI Semantic Model (BISM)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/).</span></span>  
  
## <a name="understanding-the-connection-sequence-for-bi-semantic-connections"></a><span data-ttu-id="5a7fa-122">Основные сведения о последовательности соединения для семантической модели бизнес-аналитики</span><span class="sxs-lookup"><span data-stu-id="5a7fa-122">Understanding the Connection Sequence for BI Semantic Connections</span></span>  
 <span data-ttu-id="5a7fa-123">В этом разделе описывается работа соединений между различными клиентскими приложениями, в том числе Excel или клиентом отчетов Power View в SharePoint, и базой данных табличной модели, находящейся в пределах или вне пределов фермы SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-123">This section explains the connection behavior between various client applications, such as the Excel desktop application or the Power View reporting client on SharePoint, and a tabular model database inside or outside the SharePoint farm.</span></span>  
  
 <span data-ttu-id="5a7fa-124">Все соединения с базой данных табличной модели устанавливаются с учетными данными пользователя, запрашивающего данные.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-124">All connections to a tabular model database are made using the credentials of the user who is requesting the data.</span></span> <span data-ttu-id="5a7fa-125">Однако механизм соединения различается в зависимости от того, устанавливается ли оно в пределах фермы, состоит ли из одного или двух этапов и включен ли протокол Kerberos.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-125">However, the mechanics of that connection will vary depending on whether the connection is an in-farm connection, a single or double-hop connection, and whether Kerberos is enabled.</span></span> <span data-ttu-id="5a7fa-126">Дополнительные сведения об аутентификации соединений между SharePoint и серверными источниками данных см. в разделе [Double-hop authentication: Why NTLM fails and Kerberos works](https://go.microsoft.com/fwlink/?LinkId=237137)(Двухэтапная аутентификация: почему Kerberos работает, а NTLM — нет).</span><span class="sxs-lookup"><span data-stu-id="5a7fa-126">For more information about authenticated connections between SharePoint and backend data sources, see [Double-hop authentication: Why NTLM fails and Kerberos works](https://go.microsoft.com/fwlink/?LinkId=237137).</span></span>  
  
 <span data-ttu-id="5a7fa-127">**Соединение с табличными данными из Excel по сети**</span><span class="sxs-lookup"><span data-stu-id="5a7fa-127">**Connecting from Excel to tabular data on a network**</span></span>  
  
 <span data-ttu-id="5a7fa-128">Когда пользователь Excel указывает соединение семантической модели бизнес-аналитики в качестве источника данных, сведения о соединении в BISM-файле загружаются в клиентское приложение, которое затем создает собственный прямой запрос к базе данных табличной модели в службах Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-128">When an Excel user specifies a BI semantic model connection as a data source, the connection information inside the .bism file is downloaded to the client application, which then issues its own direct request to the tabular model database on Analysis Services.</span></span> <span data-ttu-id="5a7fa-129">Для доступа к BISM-соединению пользователь Excel должен быть пользователем SharePoint с разрешениями на чтение BISM-файла соединения.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-129">To access the .bism connection, the Excel user must be a SharePoint user with read permissions on the .bism connection file.</span></span> <span data-ttu-id="5a7fa-130">После загрузки сведений о соединении все последующие соединения устанавливаются без участия SharePoint, непосредственно от Excel к серверной базе данных табличной модели.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-130">Once the connection information is downloaded, all subsequent connections bypass SharePoint, flowing directly from Excel to the backend tabular model database.</span></span>  
  
 <span data-ttu-id="5a7fa-131">На следующем рисунке показана эта последовательность соединения.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-131">The following illustration shows this connection sequence.</span></span> <span data-ttu-id="5a7fa-132">Она начинается с запроса BISM-соединения, затем сведения о соединении загружаются на клиент, и, наконец, устанавливается одноэтапное соединение с базой данных.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-132">It starts with a request for the .bism connection, followed by the download of connection information to the client, and finally the single-hop connection to the database.</span></span> <span data-ttu-id="5a7fa-133">Соединение устанавливается с использованием учетных данных Windows пользователя Excel, обладающего разрешениями на чтение базы данных служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-133">The connection is made using the Windows credentials of the Excel user, who has read permissions on the Analysis Services database.</span></span> <span data-ttu-id="5a7fa-134">Поскольку соединение устанавливается в один этап, то, даже когда включен протокол Kerberos, он необязателен в таком сценарии.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-134">It is a single hop, so even if Kerberos is enabled, it is not required for this scenario.</span></span>  
  
 <span data-ttu-id="5a7fa-135">![Соединения из Excel с табличной моделью шаблона базы данных](../media/ssas-powerpivotbismconnection-1.gif "Соединения из Excel с табличной моделью шаблона базы данных")</span><span class="sxs-lookup"><span data-stu-id="5a7fa-135">![Connections from Excel to tabular model database](../media/ssas-powerpivotbismconnection-1.gif "Connections from Excel to tabular model database")</span></span>  
  
 <span data-ttu-id="5a7fa-136">**Соединение с табличными данными из Power View по сети**</span><span class="sxs-lookup"><span data-stu-id="5a7fa-136">**Connecting from Power View to tabular data on a network**</span></span>  
  
 <span data-ttu-id="5a7fa-137">Когда пользователь SharePoint выбирает соединение семантической модели бизнес-аналитики в библиотеке документов, то немедленно запускается приложение Power View (если оно установлено) и открывает соединение с базой данных табличной модели.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-137">When a SharePoint user clicks on a BI semantic connection in a document library, Power View (if it is installed), starts immediately and opens a connection to the tabular model database.</span></span>  
  
 <span data-ttu-id="5a7fa-138">В соединениях между Power View и базой данных табличной модели применяется двухэтапная последовательность проверки подлинности, когда удостоверение пользователя передается от клиента в SharePoint, а затем от SharePoint в серверную базу данных табличной модели служб Analysis Services, которая работает вне фермы.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-138">Connections between Power View and a tabular model database follow a double-hop authentication sequence where the user identity is flowed from the client to SharePoint, and then from SharePoint to a back-end Analysis Services tabular model database that runs outside of the farm.</span></span> <span data-ttu-id="5a7fa-139">Клиентская библиотека ADOMD.NET, которая обрабатывает запрос на соединение, сначала всегда применяет протокол Kerberos.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-139">The ADOMD.NET client library that handles the connection request always tries Kerberos on the first attempt.</span></span> <span data-ttu-id="5a7fa-140">Если настроен протокол Kerberos, то выполняется олицетворение пользователя в соединении с базой данных табличной модели и подключение устанавливается успешно.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-140">If Kerberos is configured, the user identity is impersonated on the connection to the tabular model database, and the connection succeeds.</span></span>  
  
 <span data-ttu-id="5a7fa-141">Если протокол Kerberos не настроен и первый запрос соединения не выполняется, то службы Reporting Services создают второй запрос.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-141">If Kerberos is not configured and the request fails, Reporting Services makes a second attempt.</span></span> <span data-ttu-id="5a7fa-142">В этом случае клиентская библиотека подключается к службам Analysis Services с использованием удостоверения службы Reporting Services и проверки подлинности NTLM.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-142">Under this scenario, the client library connects to Analysis Services using the Reporting Services service identity and NTLM authentication.</span></span> <span data-ttu-id="5a7fa-143">Удостоверение пользователя Power View передается в строке подключения в параметре `effectiveusername`.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-143">The identity of the Power View user is passed on the connection string using the `effectiveusername` parameter.</span></span>  
  
 <span data-ttu-id="5a7fa-144">Только член роли системного администратора в экземпляре служб Analysis Services имеет разрешение на подключение с параметром `effectiveusername` и олицетворение другого пользователя в экземпляре сервера.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-144">Only a member of the system administrator role on the Analysis Services instance has permission to make a connection using the `effectiveusername` parameter and impersonate another user on the server instance.</span></span> <span data-ttu-id="5a7fa-145">Поэтому учетная запись выполнения для общей службы Reporting Services должна иметь права администратора в экземпляре служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-145">For this reason, the execution account of the Reporting Services shared service must have administrative rights on the Analysis Services instance.</span></span>  <span data-ttu-id="5a7fa-146">Инструкции по предоставлению административных разрешений учетной записи службы приведены в подразделе [Создание подключения между семантической моделью бизнес-аналитики и книгой PowerPivot](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)этого раздела.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-146">Instructions for granting administrative permissions to the service account is provided in this topic, [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
 <span data-ttu-id="5a7fa-147">На следующем рисунке показана последовательность, в которой для каждого соединения используется одно и то же удостоверение пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-147">The following illustration shows a connection sequence that uses the same Windows user identity for each connection.</span></span> <span data-ttu-id="5a7fa-148">Последнее соединение со службами Analysis Services устанавливается удостоверением приложения службы Reporting Services без удостоверения пользователя Windows. Для этого используется параметр `effectiveusername`.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-148">On the last connection to Analysis Services, the connection is made by the Reporting Services service application identity, passing the Windows user identity using `effectiveusername`.</span></span>  
  
 <span data-ttu-id="5a7fa-149">![Олицетворенное соединение с табличной базой данных](../media/ssas-powerpivotbismconnection-2.gif "Олицетворенное соединение с табличной базой данных")</span><span class="sxs-lookup"><span data-stu-id="5a7fa-149">![Imersonated connection to tabular db](../media/ssas-powerpivotbismconnection-2.gif "Imersonated connection to tabular db")</span></span>  
  
 <span data-ttu-id="5a7fa-150">**Соединение с данными PowerPivot в SharePoint из Power View**</span><span class="sxs-lookup"><span data-stu-id="5a7fa-150">**Connecting from Power View to PowerPivot data in SharePoint**</span></span>  
  
 <span data-ttu-id="5a7fa-151">Когда пользователь SharePoint выбирает соединение семантической модели бизнес-аналитики, которое указывает на книгу PowerPivot на той же ферме, то соединение выполняется в контексте среды SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-151">When a SharePoint user clicks on a BI semantic connection that resolves to a PowerPivot workbook in the same farm, the connections occur within the context of the SharePoint environment.</span></span> <span data-ttu-id="5a7fa-152">Приложение службы PowerPivot обрабатывает запрос на соединение и направляет его в экземпляр служб Analysis Services на том же компьютере.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-152">A PowerPivot service application handles the connection request, which it forwards to the Analysis Services instance on the same computer.</span></span> <span data-ttu-id="5a7fa-153">Экземпляр служб Analysis Services извлекает данные PowerPivot из книги и загружает их.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-153">The Analysis Services instance extracts the PowerPivot data from the workbook and loads it.</span></span> <span data-ttu-id="5a7fa-154">Все последующие соединения управляются приложением службы PowerPivot на ферме.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-154">All subsequent connections are managed by PowerPivot service applications in the farm.</span></span>  
  
 <span data-ttu-id="5a7fa-155">В этом случае все соединения устанавливаются в пределах фермы и нет необходимости применять протокол Kerberos или ограниченное делегирование.</span><span class="sxs-lookup"><span data-stu-id="5a7fa-155">In this scenario, all connections occur within the same farm, so there is no requirement for Kerberos or constrained delegation.</span></span>  
  
##  <a name="related-tasks"></a><a name="bkmk_rel"></a> <span data-ttu-id="5a7fa-156">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="5a7fa-156">Related Tasks</span></span>  
 [<span data-ttu-id="5a7fa-157">Добавление типа содержимого соединения семантической модели бизнес-аналитики в библиотеку &#40;PowerPivot для SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="5a7fa-157">Add a BI Semantic Model Connection Content Type to a Library &#40;PowerPivot for SharePoint&#41;</span></span>](add-bi-semantic-model-connection-content-type-to-library.md)  
  
 [<span data-ttu-id="5a7fa-158">Создание соединения семантической модели бизнес-аналитики с книгой PowerPivot</span><span class="sxs-lookup"><span data-stu-id="5a7fa-158">Create a BI Semantic Model Connection to a PowerPivot Workbook</span></span>](create-a-bi-semantic-model-connection-to-a-power-pivot-workbook.md)  
  
 [<span data-ttu-id="5a7fa-159">Create a BI Semantic Model Connection to a Tabular Model Database</span><span class="sxs-lookup"><span data-stu-id="5a7fa-159">Create a BI Semantic Model Connection to a Tabular Model Database</span></span>](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)  
  
 [<span data-ttu-id="5a7fa-160">Использование соединения семантической модели бизнес-аналитики в службах Excel или Reporting Services</span><span class="sxs-lookup"><span data-stu-id="5a7fa-160">Use a BI Semantic Model Connection in Excel or Reporting Services</span></span>](use-a-bi-semantic-model-connection-in-excel-or-reporting-services.md)  
  
## <a name="see-also"></a><span data-ttu-id="5a7fa-161">См. также:</span><span class="sxs-lookup"><span data-stu-id="5a7fa-161">See Also</span></span>  
 <span data-ttu-id="5a7fa-162">[Определение режима работы сервера для экземпляра Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span><span class="sxs-lookup"><span data-stu-id="5a7fa-162">[Determine the Server Mode of an Analysis Services Instance](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span></span>  
 [<span data-ttu-id="5a7fa-163">Подключение к службам Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5a7fa-163">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
  
