---
title: Аутентификация и авторизация PowerPivot | Документация Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 48230cc0-4037-4f99-8360-dadf4bc169bd
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cf777960b24d9c65c7e7f7d9651eeb48e0fe42b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87728870"
---
# <a name="powerpivot-authentication-and-authorization"></a><span data-ttu-id="d9eb5-102">Проверка подлинности и авторизация PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d9eb5-102">PowerPivot Authentication and Authorization</span></span>
  <span data-ttu-id="d9eb5-103">Развертывание PowerPivot для SharePoint, работающее в пределах фермы SharePoin 2010, использует подсистему проверки подлинности и модель авторизации, предоставляемые серверами SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-103">A PowerPivot for SharePoint deployment that runs within a SharePoint 2010 farm uses the authentication subsystem and authorization model provided by SharePoint servers.</span></span> <span data-ttu-id="d9eb5-104">Инфраструктура безопасности SharePoint распространяется на содержимое и операции PowerPivot, поскольку все содержимое PowerPivot хранится в базах данных содержимого SharePoint, а все операции, связанные с PowerPivot, выполняются общими службами PowerPivot на ферме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-104">SharePoint security infrastructure extends to PowerPivot content and operations because all PowerPivot-related content is stored in SharePoint content databases and all PowerPivot-related operations are performed by PowerPivot shared services in the farm.</span></span> <span data-ttu-id="d9eb5-105">Перед запросом книги, содержащей данные PowerPivot, пользователь должен пройти проверку подлинности при помощи удостоверения пользователя SharePoint, которое основано на учетных данных пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-105">Users who request a workbook that contains PowerPivot data are authenticated using a SharePoint user identity that is based on their Windows user identity.</span></span> <span data-ttu-id="d9eb5-106">Разрешения на просмотр книги определяют, возможно ли выполнение запроса.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-106">View permissions on the workbook determine whether the request is granted or denied.</span></span>  
  
 <span data-ttu-id="d9eb5-107">Поскольку интеграция со службами Excel Services необходима для анализа данных в режиме самообслуживания, для овладения основами безопасности сервера PowerPivot необходимо знание основ безопасности служб Excel.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-107">Because integration with Excel Services is required for self-service data analytics, securing a PowerPivot server requires that you also understand Excel Services security.</span></span> <span data-ttu-id="d9eb5-108">Когда пользователь запрашивает сводную таблицу, имеющую подключение к данным PowerPivot, службы Excel перенаправляют запрос подключения к данным на сервер PowerPivot на ферме для загрузки данных.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-108">When a user queries a PivotTable that has a data connection to PowerPivot data, Excel Services forwards a data connection request to a PowerPivot server in the farm to load the data.</span></span> <span data-ttu-id="d9eb5-109">Такое взаимодействие между серверами требует понимания принципов настройки параметров безопасности для обоих серверов.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-109">This interaction between the servers requires that you understand how to configure security settings for both servers.</span></span>  
  
 <span data-ttu-id="d9eb5-110">Перейдите по одной из следующих ссылок к соответствующему подразделу:</span><span class="sxs-lookup"><span data-stu-id="d9eb5-110">Click the following links to read specific sections in this topic:</span></span>  
  
 [<span data-ttu-id="d9eb5-111">Проверка подлинности Windows с использованием классического режима входа</span><span class="sxs-lookup"><span data-stu-id="d9eb5-111">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>](power-pivot-authentication-and-authorization.md#bkmk_auth)  
  
 [<span data-ttu-id="d9eb5-112">Операции PowerPivot, требующие авторизации пользователей</span><span class="sxs-lookup"><span data-stu-id="d9eb5-112">PowerPivot Operations Requiring User Authorization</span></span>](#UserConnections)  
  
 [<span data-ttu-id="d9eb5-113">Разрешения SharePoint для доступа к данным PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d9eb5-113">SharePoint Permissions for PowerPivot Data Access</span></span>](#Permissions)  
  
 [<span data-ttu-id="d9eb5-114">Вопросы безопасности служб Excel для книг PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d9eb5-114">Excel Services security considerations for PowerPivot workbooks</span></span>](#excel)  
  
##  <a name="windows-authentication-using-classic-mode-sign-in-requirement"></a><a name="bkmk_auth"></a><span data-ttu-id="d9eb5-115">Проверка подлинности Windows с использованием классического режима входа</span><span class="sxs-lookup"><span data-stu-id="d9eb5-115">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>  
 <span data-ttu-id="d9eb5-116">PowerPivot для SharePoint поддерживает часть параметров проверки подлинности, доступных в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-116">PowerPivot for SharePoint supports a reduced set of the authentication options that are available in SharePoint.</span></span> <span data-ttu-id="d9eb5-117">При развертывании PowerPivot для SharePoint из доступных параметров проверки подлинности поддерживается только проверка подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-117">Of the available authentication options, only Windows authentication is supported for a PowerPivot for SharePoint deployment.</span></span> <span data-ttu-id="d9eb5-118">Кроме того, веб-приложение, через которое выполняется вход, должно быть настроено на классический режим.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-118">In addition, the web application through which sign-in occurs must be configured for classic mode.</span></span>  
  
 <span data-ttu-id="d9eb5-119">Проверка подлинности Windows требуется потому, что при развертывании PowerPivot для SharePoint подсистема обработки данных служб Analysis Services поддерживает только проверку подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-119">Windows authentication is required because the Analysis Services data engine in a PowerPivot for SharePoint deployment supports only Windows authentication.</span></span> <span data-ttu-id="d9eb5-120">Службы Excel устанавливают соединения со службами Analysis Services через поставщик OLE DB MSOLAP, используя удостоверение пользователя, подлинность которого была проверена через NTLM или по протоколу Kerberos.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-120">Excel Services establishes connections to Analysis Services via the MSOLAP OLE DB provider using a Windows user identity that was authenticated via NTLM or the Kerberos protocol.</span></span>  
  
 <span data-ttu-id="d9eb5-121">Второе требование: чтобы гарантировать работоспособность работы веб-службы PowerPivot, требуется проверка подлинности в классическом режиме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-121">The second requirement, classic mode authentication on the web application, is required to ensure the operability of the PowerPivot web service.</span></span> <span data-ttu-id="d9eb5-122">Веб-служба PowerPivot — это компонент, который запускается на веб-сервере и обеспечивает перенаправление HTTP-запросов на сервер PowerPivot для SharePoint на ферме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-122">The web service is a component that runs on a Web front-end and provides HTTP redirection to a PowerPivot for SharePoint server in the farm.</span></span> <span data-ttu-id="d9eb5-123">Веб-служба поддерживает утверждения в маркере безопасности для связи между службами, но не поддерживает их для запросов подключения к данным, которые маршрутизируются в общую службу PowerPivot на ферме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-123">While the web service is claims aware for service-to-service communications, it is not claims aware for the data connection requests that it routes to a PowerPivot shared service in the farm.</span></span> <span data-ttu-id="d9eb5-124">Запросы на загрузку данных PowerPivot поддерживаются только для проверенных соединений, поступающих из IIS с удостоверением Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-124">Requests to load PowerPivot data are only supported for authenticated connections that come from IIS using a Windows identity.</span></span> <span data-ttu-id="d9eb5-125">Классический режим входа в веб-приложение обеспечивает успешное подключение веб-служб PowerPivot к общим службам PowerPivot на ферме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-125">Classic mode sign-in on the web application is what enables a successful connection from the PowerPivot web service to PowerPivot shared services in the farm.</span></span>  
  
 <span data-ttu-id="d9eb5-126">Хотя классический режим входа не требуется для более распространенного способа доступа к данным (когда данные PowerPivot извлекаются из той же книги Excel, где производится подготовка к просмотру), не пытайтесь использовать PowerPivot для SharePoint с веб-приложениями SharePoint, настроенными на использование других поставщиков проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-126">Although classic mode sign-in is not required for the more common data access scenario (where PowerPivot data is extracted from the same Excel workbook that renders it) do not attempt to use PowerPivot for SharePoint with SharePoint web applications that are configured to use other authentication providers.</span></span> <span data-ttu-id="d9eb5-127">Подобные действия приведут к сбою соединения при каждой попытке пользователя подключиться к книге PowerPivot как к внешнему источнику данных.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-127">Doing so will result in a connection failure whenever users try to connect to PowerPivot workbooks as an external data source.</span></span>  
  
 <span data-ttu-id="d9eb5-128">Без классического входа в систему следующие типы запросов, управляемые веб-службой PowerPivot, завершатся ошибкой:</span><span class="sxs-lookup"><span data-stu-id="d9eb5-128">Without classic mode sign-in, the following types of requests that are handled by PowerPivot Web service will fail:</span></span>  
  
-   <span data-ttu-id="d9eb5-129">Любой запрос данных PowerPivot, поступивший из-за пределов фермы (например, создание отчетов в конструкторе отчетов или построителе отчетов, где источник данных — это URL-адрес SharePoint для подключения к книге PowerPivot)</span><span class="sxs-lookup"><span data-stu-id="d9eb5-129">Any request for PowerPivot data that originates from outside the farm (for example, creating a report in Report Designer or Report Builder, where the data source is a SharePoint URL to a PowerPivot workbook)</span></span>  
  
-   <span data-ttu-id="d9eb5-130">Запросы внутри фермы от клиентского приложения или отчета, которые используют книгу PowerPivot в качестве внешнего источника данных (например, создание книги в приложении Excel, когда в качестве источника данных используется вторая опубликованная книга Excel с данными PowerPivot)</span><span class="sxs-lookup"><span data-stu-id="d9eb5-130">In-farm requests from a client application or report that uses the PowerPivot workbook as an external data source (for example, creating a workbook in the Excel desktop application, using as your data source a second published Excel workbook containing PowerPivot data)</span></span>  
  
### <a name="how-to-check-the-authentication-provider-for-your-application"></a><span data-ttu-id="d9eb5-131">Проверка поставщика проверки подлинности для приложения</span><span class="sxs-lookup"><span data-stu-id="d9eb5-131">How to check the authentication provider for your application</span></span>  
 <span data-ttu-id="d9eb5-132">При создании новых веб-приложений следует обязательно выбирать параметр **Классический режим проверки подлинности** на странице «Создание нового веб-приложения».</span><span class="sxs-lookup"><span data-stu-id="d9eb5-132">When creating new web applications, be sure to select the **Classic mode authentication** option in the Create New Web Application page.</span></span>  
  
 <span data-ttu-id="d9eb5-133">Для существующих веб-приложений выполните следующие инструкции, чтобы проверить, настроено ли веб-приложение на использование проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-133">For existing web applications, use the following instructions to verify the web application is configured to use Windows authentication.</span></span>  
  
1.  <span data-ttu-id="d9eb5-134">В центре администрирования в окне "Управление приложениями" щелкните **Управление веб-приложениями**.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-134">In Central Administration, in Application Management, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="d9eb5-135">Выберите веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-135">Select the web application.</span></span>  
  
3.  <span data-ttu-id="d9eb5-136">Нажмите кнопку **Поставщики проверки подлинности**.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-136">Click **Authentication Providers**.</span></span>  
  
4.  <span data-ttu-id="d9eb5-137">Проверьте, что для каждой зоны есть только один поставщик, а для зоны, используемой по умолчанию, поставщиком проверки подлинности является Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-137">Verify that you have one provider for each zone, and the Default zone is set to Windows.</span></span>  
  
##  <a name="powerpivot-operations-requiring-user-authorization"></a><a name="UserConnections"></a><span data-ttu-id="d9eb5-138">Операции PowerPivot, для которых необходима авторизация пользователя</span><span class="sxs-lookup"><span data-stu-id="d9eb5-138">PowerPivot Operations Requiring User Authorization</span></span>  
 <span data-ttu-id="d9eb5-139">Для всех уровней доступа к обработке запросов и данных PowerPivot используется исключительно авторизация SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-139">SharePoint authorization is used exclusively for all levels of access to PowerPivot query and data processing.</span></span>  
  
 <span data-ttu-id="d9eb5-140">Авторизация на основе ролей служб Analysis Services не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-140">The Analysis Services role-based authorization model is not supported.</span></span> <span data-ttu-id="d9eb5-141">Авторизация на основе ролей на уровне ячеек, строк или таблицы не существует.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-141">There is no role-based authorization for PowerPivot data at the cell, row, or table level.</span></span> <span data-ttu-id="d9eb5-142">Невозможна частичная защита книги, позволяющая предоставлять или запрещать доступ отдельных пользователей к конфиденциальным данным, содержащимся в книге.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-142">You cannot secure different parts of the workbook to grant or deny access to sensitive data within it for specific users.</span></span> <span data-ttu-id="d9eb5-143">Внедренные данные PowerPivot в полном объеме доступны пользователям, имеющим разрешения на просмотр книг Excel в библиотеке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-143">Embedded PowerPivot data is wholly available to users who have View permissions on the Excel workbook in a SharePoint library.</span></span>  
  
 <span data-ttu-id="d9eb5-144">PowerPivot для SharePoint будет выполнять олицетворение пользователя SharePoint в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="d9eb5-144">PowerPivot for SharePoint will impersonate a SharePoint user in the following cases:</span></span>  
  
-   <span data-ttu-id="d9eb5-145">Запросы к сводным таблицам или диаграммам, которые имеют соединения с базой данных PowerPivot, когда приложение службы PowerPivot от имени пользователя устанавливает соединения с конкретной общей службой PowerPivot, обрабатывающей данные.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-145">Queries to PivotTables or PivotCharts that have data connections to a PowerPivot database, where a PowerPivot service application establishes connections on behalf of a user to a specific PowerPivot shared service instance that processes the data.</span></span>  
  
-   <span data-ttu-id="d9eb5-146">Загрузка данных PowerPivot из кэша или библиотеки, если данные не доступны другими способами.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-146">Loading PowerPivot data from cache or a library if the data is not otherwise available.</span></span> <span data-ttu-id="d9eb5-147">Если подключение к данным производится для данных PowerPivot, еще не загруженных в систему, то экземпляр [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] пользуется удостоверением пользователя SharePoint для получения источника данных из библиотеки содержимого и его загрузки в память.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-147">If a data connection request is made for PowerPivot data that is not already loaded in the system, the [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] instance will use the identity of the SharePoint user to retrieve the data source from a content library and load it into memory.</span></span>  
  
-   <span data-ttu-id="d9eb5-148">Операции обновления данных, которые сохраняют обновленную копию источника данных в книге в библиотеке содержимого.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-148">Data refresh operations that save an updated copy of the data source to the workbook in a content library.</span></span> <span data-ttu-id="d9eb5-149">В этом случае фактическая операция входа выполняется с использованием имени пользователя и пароля, полученных из целевого приложения в службе Secure Store.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-149">In this case, an actual log on operation is performed using the user name and password that is retrieved from a target application in Secure Store Service.</span></span> <span data-ttu-id="d9eb5-150">Учетные данные могут представлять учетную запись автоматического обновления данных или учетные данные, сохраненные вместе с расписанием обновления данных во время создания.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-150">Credentials can be the PowerPivot unattended data refresh account, or credentials that were stored with the data refresh schedule when it was created.</span></span> <span data-ttu-id="d9eb5-151">Дополнительные сведения см. в статьях [Настройка сохраненных учетных данных для обновления данных powerpivot &#40;PowerPivot для SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) и [Настройка учетной записи автоматического обновления данных powerpivot &#40;PowerPivot для SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="d9eb5-151">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
##  <a name="sharepoint-permissions-for-powerpivot-data-access"></a><a name="Permissions"></a><span data-ttu-id="d9eb5-152">Разрешения SharePoint для доступа к данным PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d9eb5-152">SharePoint Permissions for PowerPivot Data Access</span></span>  
 <span data-ttu-id="d9eb5-153">Публикация, обеспечение безопасности книги PowerPivot и управление ею поддерживаются только через интеграцию с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-153">Publishing, managing, and securing a PowerPivot workbook is supported solely through SharePoint integration.</span></span> <span data-ttu-id="d9eb5-154">Серверы SharePoint имеют подсистемы проверки подлинности и авторизации, обеспечивающие санкционированный доступ к данным.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-154">SharePoint servers provide authentication and authorization subsystems that ensure legitimate access to data.</span></span> <span data-ttu-id="d9eb5-155">Не существует поддерживаемых сценариев для безопасного развертывания книги PowerPivot за пределами фермы SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-155">There are no supported scenarios for securely deploying a PowerPivot workbook outside of a SharePoint farm.</span></span>  
  
 <span data-ttu-id="d9eb5-156">Имея разрешения на просмотр или выше, пользователи могут производить доступ к данным PowerPivot на сервере только для чтения.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-156">User access to PowerPivot data is read-only on the server through View permissions or higher.</span></span> <span data-ttu-id="d9eb5-157">Разрешения на участие позволяют добавлять и изменять файлы.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-157">Contribute permissions allow for adding and editing the file.</span></span> <span data-ttu-id="d9eb5-158">Чтобы изменять данные PowerPivot, необходимо загрузить книгу в приложение Excel для настольной системы, на котором установлена надстройка PowerPivot для Excel.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-158">Changes to PowerPivot data require that you download the workbook to an Excel desktop application that has PowerPivot for Excel installed.</span></span> <span data-ttu-id="d9eb5-159">Разрешения на участие для файла определяют, может ли пользователь загрузить файл в свою систему, а затем сохранить изменения в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-159">Contribute permissions on the file will determine whether the user can download the file locally and then save changes back to SharePoint.</span></span>  
  
 <span data-ttu-id="d9eb5-160">Сами по себе уровни «Участие» и «Только просмотр» определяют эффективный набор разрешений для доступа пользователя к данным PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-160">As such, Contribute and View Only levels of permission define the effective set of permissions for user access to PowerPivot data.</span></span> <span data-ttu-id="d9eb5-161">Другие уровни разрешений тоже будут работать в той степени, в какой им предоставлены те же разрешения, что и для уровней «Участие» и «Только просмотр» (например, поскольку уровень «Чтение» включает разрешения уровня «Только просмотр», пользователь с уровнем «Чтение» будет иметь тот же уровень доступа, что и пользователь с уровнем «Только просмотр»).</span><span class="sxs-lookup"><span data-stu-id="d9eb5-161">Other permission levels work to the extent that they have the same permissions as Contribute and View Only (For example, because Read includes View Only permissions, a user who is assigned to Read will have same level of access as View Only).</span></span>  
  
 <span data-ttu-id="d9eb5-162">В следующей таблице обобщены сведения по уровням разрешений, которые определяют доступ к данным PowerPivot и операциям сервера отчетов.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-162">The following table summarizes the permission levels that determine access to PowerPivot data and server operations:</span></span>  
  
|<span data-ttu-id="d9eb5-163">Уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="d9eb5-163">Permission level</span></span>|<span data-ttu-id="d9eb5-164">Разрешает следующие задачи</span><span class="sxs-lookup"><span data-stu-id="d9eb5-164">Allows these tasks</span></span>|  
|----------------------|------------------------|  
|<span data-ttu-id="d9eb5-165">Администратор фермы или службы</span><span class="sxs-lookup"><span data-stu-id="d9eb5-165">Farm or service administrator</span></span>|<span data-ttu-id="d9eb5-166">Установка, включение и настройка служб и приложений.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-166">Install, enable, and configure services and applications.</span></span><br /><br /> <span data-ttu-id="d9eb5-167">Использование панели мониторинга PowerPivot и просмотр административных отчетов.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-167">Use PowerPivot Management Dashboard and view administrative reports.</span></span>|  
|<span data-ttu-id="d9eb5-168">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="d9eb5-168">Full control</span></span>|<span data-ttu-id="d9eb5-169">Активация интеграции функции PowerPivot на уровне семейств веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-169">Activate PowerPivot feature integration at the site collection level.</span></span><br /><br /> <span data-ttu-id="d9eb5-170">Создание библиотеки галереи PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-170">Create a PowerPivot Gallery library.</span></span><br /><br /> <span data-ttu-id="d9eb5-171">Создание библиотеки веб-каналов данных.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-171">Create a data feed library.</span></span>|  
|<span data-ttu-id="d9eb5-172">Участие</span><span class="sxs-lookup"><span data-stu-id="d9eb5-172">Contribute</span></span>|<span data-ttu-id="d9eb5-173">Добавление, изменение, удаление и загрузка книг PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-173">Add, edit, delete, and download PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="d9eb5-174">Настройка обновления данных.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-174">Configure data refresh.</span></span><br /><br /> <span data-ttu-id="d9eb5-175">Создание новых отчетов или книг на основе книг PowerPivot, расположенных на сайте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-175">Create new workbooks and reports based on PowerPivot workbooks on a SharePoint site.</span></span><br /><br /> <span data-ttu-id="d9eb5-176">Создание сервисных документов данных в библиотеке веб-каналов данных.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-176">Create data service documents in a data feed library</span></span>|  
|<span data-ttu-id="d9eb5-177">Чтение</span><span class="sxs-lookup"><span data-stu-id="d9eb5-177">Read</span></span>|<span data-ttu-id="d9eb5-178">Доступ к книгам PowerPivot как к внешнему источнику данных, где URL-адрес книги явно указан в диалоговом окне соединения (например, в мастере подключения к данным Excel).</span><span class="sxs-lookup"><span data-stu-id="d9eb5-178">Access PowerPivot workbooks as an external data source, where the workbook URL is explicitly entered in a connection dialog box (for example, in Excel's Data Connection Wizard).</span></span>|  
|<span data-ttu-id="d9eb5-179">Только просмотр</span><span class="sxs-lookup"><span data-stu-id="d9eb5-179">View Only</span></span>|<span data-ttu-id="d9eb5-180">Просмотр книг PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-180">View PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="d9eb5-181">Просмотр журнала обновления данных.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-181">View data refresh history.</span></span><br /><br /> <span data-ttu-id="d9eb5-182">Подключение локальной книги к книге PowerPivot на сайте SharePoint для повторного использования ее данных в других целях.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-182">Connect a local workbook to a PowerPivot workbook on a SharePoint site, to repurpose its data in other ways.</span></span><br /><br /> <span data-ttu-id="d9eb5-183">Загрузите моментальный снимок книги.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-183">Download a snapshot of the workbook.</span></span> <span data-ttu-id="d9eb5-184">Моментальный снимок является статической копией данных, без срезов, фильтров, формул или подключений к данным.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-184">The snapshot is a static copy of the data, without slicers, filters, formulas, or data connections.</span></span> <span data-ttu-id="d9eb5-185">Содержимое моментального снимка аналогично копии значений ячеек из окна браузера.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-185">The contents of the snapshot are similar to copying cell values from the browser window.</span></span>|  
  
##  <a name="excel-services-security-considerations-for-powerpivot-workbooks"></a><a name="excel"></a><span data-ttu-id="d9eb5-186">Вопросы безопасности служб Excel для книг PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d9eb5-186">Excel Services security considerations for PowerPivot workbooks</span></span>  
 <span data-ttu-id="d9eb5-187">Обработка запросов на сервере PowerPivot тесно связана со службами Excel.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-187">PowerPivot server-side query processing is tightly coupled with Excel services.</span></span> <span data-ttu-id="d9eb5-188">Интеграция продукта начинается с уровня документа, поскольку книги PowerPivot представляют собой файлы книг Excel (XLSX-файлы), в которых содержатся данные PowerPivot или ссылки на них.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-188">Product integration begins at the document level, in that PowerPivot workbooks are Excel workbook (.xlsx) files that either contain or reference PowerPivot data.</span></span> <span data-ttu-id="d9eb5-189">Отдельного расширения файла для книги PowerPivot не существует.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-189">There is no separate file extension for a PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="d9eb5-190">Когда книга PowerPivot открывается на сайте SharePoint, службы Excel считывают внедренную в нее строку подключения к данным PowerPivot и передают запрос локальному поставщику данных OLE DB для служб SQL Server Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-190">When a PowerPivot workbook is opened on a SharePoint site, Excel Services reads the embedded PowerPivot data connection string and forwards the request to the local SQL Server Analysis Services OLE DB provider.</span></span> <span data-ttu-id="d9eb5-191">Затем этот поставщик передает сведения о соединении серверу PowerPivot в ферме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-191">The provider then passes the connection information to a PowerPivot server in the farm.</span></span> <span data-ttu-id="d9eb5-192">Для беспрепятственного обмена запросами между двумя серверами службы Excel должны быть настроены с параметрами, требуемыми PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-192">In order for requests to flow seamlessly between the two servers, Excel Services must be configured to use settings that are required by PowerPivot for SharePoint.</span></span>  
  
 <span data-ttu-id="d9eb5-193">В службах Excel параметры конфигурации, связанные с безопасностью, указываются в надежных расположениях, у надежных поставщиков данных и в надежных библиотеках подключения к данным.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-193">In Excel Services, security-related configuration settings are specified on trusted locations, trusted data providers, and trusted data connection libraries.</span></span> <span data-ttu-id="d9eb5-194">В приведенной ниже таблице описаны параметры, включающие или улучшающие доступ к данным PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-194">The following table describes the settings that enable or enhance PowerPivot data access.</span></span> <span data-ttu-id="d9eb5-195">Параметры, которых нет в этом списке, не влияют на серверные подключения PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-195">If a setting is not listed here, it has no effect on PowerPivot server connections.</span></span> <span data-ttu-id="d9eb5-196">Инструкции по заданию этих параметров см. в разделе "Включение служб Excel" раздела [Начальная настройка &#40;PowerPivot для SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="d9eb5-196">For instructions on how to specify these settings step by step, see the section "Enable Excel Services" in [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d9eb5-197">Большинство параметров безопасности применяется к надежным расположениям.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-197">Most security-related settings apply to trusted locations.</span></span> <span data-ttu-id="d9eb5-198">Если необходимо сохранить значения по умолчанию или использовать различные значения для различных сайтов, можно создать дополнительное надежное расположение для сайтов, которые содержат данные PowerPivot, а затем настроить следующие параметры только для этих сайтов.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-198">If you want to preserve default values or use different values for different sites, you can create an additional trusted location for sites that contain PowerPivot data, and then configure the following settings for just that site.</span></span> <span data-ttu-id="d9eb5-199">Дополнительные сведения см. в разделе [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span><span class="sxs-lookup"><span data-stu-id="d9eb5-199">For more information, see [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span></span>  
  
|<span data-ttu-id="d9eb5-200">Область</span><span class="sxs-lookup"><span data-stu-id="d9eb5-200">Area</span></span>|<span data-ttu-id="d9eb5-201">Параметр</span><span class="sxs-lookup"><span data-stu-id="d9eb5-201">Setting</span></span>|<span data-ttu-id="d9eb5-202">Описание</span><span class="sxs-lookup"><span data-stu-id="d9eb5-202">Description</span></span>|  
|----------|-------------|-----------------|  
|<span data-ttu-id="d9eb5-203">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="d9eb5-203">Web application</span></span>|<span data-ttu-id="d9eb5-204">Поставщик проверки подлинности Windows</span><span class="sxs-lookup"><span data-stu-id="d9eb5-204">Windows authentication provider</span></span>|<span data-ttu-id="d9eb5-205">PowerPivot преобразует токен утверждений, получаемый от служб Excel, в удостоверение пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-205">PowerPivot converts a claims token that it gets from Excel Services to a Windows user identity.</span></span> <span data-ttu-id="d9eb5-206">Каждое веб-приложение, которое использует службы Excel в качестве ресурса, должно быть настроено для использования поставщика проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-206">Any web application that uses Excel Services as a resource must be configured to use the Windows authentication provider.</span></span>|  
|<span data-ttu-id="d9eb5-207">Надежное расположение</span><span class="sxs-lookup"><span data-stu-id="d9eb5-207">Trusted location</span></span>|<span data-ttu-id="d9eb5-208">Тип расположения</span><span class="sxs-lookup"><span data-stu-id="d9eb5-208">Location Type</span></span>|<span data-ttu-id="d9eb5-209">Это значение должно быть равно **Microsoft SharePoint Foundation**.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-209">This value must be set to **Microsoft SharePoint Foundation**.</span></span> <span data-ttu-id="d9eb5-210">Серверы PowerPivot получают копию XLSX-файла и загружают ее на сервер служб Analysis Services в ферме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-210">PowerPivot servers retrieve a copy of the .xlsx file and load it on an Analysis Services server in the farm.</span></span> <span data-ttu-id="d9eb5-211">Этот сервер может получить XLSX-файл только из библиотеки содержимого.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-211">The server can only retrieve .xlsx files from a content library.</span></span>|  
||<span data-ttu-id="d9eb5-212">Разрешить внешние данные</span><span class="sxs-lookup"><span data-stu-id="d9eb5-212">Allow External Data</span></span>|<span data-ttu-id="d9eb5-213">Это значение должно быть установлено равным **Надежные библиотеки подключений к данным и внедренные**.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-213">This value must be set to **Trusted data connection libraries and embedded**.</span></span> <span data-ttu-id="d9eb5-214">Подключения к данным PowerPivot внедряются в книгу.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-214">PowerPivot data connections are embedded in the workbook.</span></span> <span data-ttu-id="d9eb5-215">Если запретить внедренные соединения, то пользователи смогут просматривать кэш сводных таблиц, но не смогут взаимодействовать с данными PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-215">If you disallow embedded connections, users can view the PivotTable cache, but they will not be able to interact with the PowerPivot data.</span></span>|  
||<span data-ttu-id="d9eb5-216">Предупреждать при обновлении</span><span class="sxs-lookup"><span data-stu-id="d9eb5-216">Warn on Refresh</span></span>|<span data-ttu-id="d9eb5-217">Этот параметр должен быть отключен, если галерея PowerPivot используется для хранения книг и отчетов.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-217">This value should be disabled if you are using PowerPivot Gallery to store workbooks and reports.</span></span> <span data-ttu-id="d9eb5-218">Галерея PowerPivot имеет функцию предварительного просмотра документов, которая работает лучше, если отключены оба предупреждения на открытие и обновление.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-218">PowerPivot Gallery includes a document preview feature that works best if both refresh on open and Warn on Refresh are turned off.</span></span>|  
|<span data-ttu-id="d9eb5-219">Надежные поставщики данных</span><span class="sxs-lookup"><span data-stu-id="d9eb5-219">Trusted data providers</span></span>|<span data-ttu-id="d9eb5-220">MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="d9eb5-220">MSOLAP.4</span></span><br /><br /> <span data-ttu-id="d9eb5-221">MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="d9eb5-221">MSOLAP.5</span></span>|<span data-ttu-id="d9eb5-222">MSOLAP.4 включается по умолчанию, но для доступа к PowerPivot поставщиком MSOLAP.4 должна быть версия SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-222">MSOLAP.4 is included by default, but PowerPivot data access requires that the MSOLAP.4 provider be the SQL Server 2008 R2 version.</span></span><br /><br /> <span data-ttu-id="d9eb5-223">MSOLAP.5 устанавливается с PowerPivot для SharePoint версии [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d9eb5-223">MSOLAP.5 is installed with the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of PowerPivot for SharePoint.</span></span><br /><br /> <span data-ttu-id="d9eb5-224">Не удаляйте эти поставщики из списка надежных поставщиков данных.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-224">Do not remove these providers from the trusted data provider list.</span></span> <span data-ttu-id="d9eb5-225">В некоторых случаях может потребоваться установка дополнительных копий этого поставщика на других серверах SharePoint на ферме.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-225">In some cases, you might need to install additional copies of this provider on other SharePoint servers in your farm.</span></span> <span data-ttu-id="d9eb5-226">Дополнительные сведения см. в статье [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span><span class="sxs-lookup"><span data-stu-id="d9eb5-226">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>|  
|<span data-ttu-id="d9eb5-227">Надежные библиотеки подключений к данным</span><span class="sxs-lookup"><span data-stu-id="d9eb5-227">Trusted data connection libraries</span></span>|<span data-ttu-id="d9eb5-228">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-228">Optional.</span></span>|<span data-ttu-id="d9eb5-229">Можно использовать файлы подключения к данным Office (ODC), хранящиеся в книгах PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-229">You can use Office Data Connection (.odc) files in PowerPivot workbooks.</span></span> <span data-ttu-id="d9eb5-230">Если сведения о соединении с локальными книгами PowerPivot поставляются из ODC-файла, то эти же ODC-файлы можно добавить в данную библиотеку.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-230">If you use .odc files to provide connection information to local PowerPivot workbooks, you can add the same .odc files to this library.</span></span>|  
|<span data-ttu-id="d9eb5-231">Определяемая пользователем сборка функций</span><span class="sxs-lookup"><span data-stu-id="d9eb5-231">User defined function assembly</span></span>|<span data-ttu-id="d9eb5-232">Не применяется</span><span class="sxs-lookup"><span data-stu-id="d9eb5-232">Not applicable.</span></span>|<span data-ttu-id="d9eb5-233">PowerPivot для SharePoint игнорирует сборки пользовательских функций, созданные и развернутые для служб Excel.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-233">PowerPivot for SharePoint ignores user-defined function assemblies that you build deploy for Excel Services.</span></span> <span data-ttu-id="d9eb5-234">Если пользовательские сборки необходимы для каких-то операций, помните, что подсистема обработки запросов PowerPivot не будет использовать созданные функции, определяемые пользователем.</span><span class="sxs-lookup"><span data-stu-id="d9eb5-234">If you rely on user-defined assemblies for a specific behavior, be aware that PowerPivot query processing will not use the user-defined functions you created.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="d9eb5-235">См. также:</span><span class="sxs-lookup"><span data-stu-id="d9eb5-235">See Also</span></span>  
 <span data-ttu-id="d9eb5-236">[Настройка учетных записей служб PowerPivot](configure-power-pivot-service-accounts.md) </span><span class="sxs-lookup"><span data-stu-id="d9eb5-236">[Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) </span></span>  
 <span data-ttu-id="d9eb5-237">[Настройте учетную запись автоматического обновления данных PowerPivot &#40;PowerPivot для SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="d9eb5-237">[Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span></span>  
 <span data-ttu-id="d9eb5-238">[Создание надежного расположения для сайтов PowerPivot в центре администрирования](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span><span class="sxs-lookup"><span data-stu-id="d9eb5-238">[Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span></span>  
 [<span data-ttu-id="d9eb5-239">Архитектура безопасности PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d9eb5-239">PowerPivot Security Architecture</span></span>](https://go.microsoft.com/fwlink/?linkID=220970)  
  
  
