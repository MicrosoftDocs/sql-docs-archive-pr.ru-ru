---
title: Справочник по параметрам конфигурации (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 3b57dd3f-7820-4ba8-b233-01dc68908273
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01a1c0d4c5273dccb6ba7057d1cd5c26a6f8890c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729913"
---
# <a name="configuration-setting-reference-powerpivot-for-sharepoint"></a>Справочник по параметрам конфигурации (PowerPivot для SharePoint)
  В этом разделе содержатся сведения о параметрах настройки, используемых приложениями служб PowerPivot на ферме SharePoint. В этом разделе можно найти подробные сведения об использовании скриптов PowerShell для настройки сервера, а также обо всех параметрах.  
  
 Параметры конфигурации задаются для каждого приложения службы PowerPivot. На ферме можно создать несколько приложений служб, чтобы настроить независимые логические экземпляры одного и того же физического экземпляра службы. Параметры конфигурации хранятся в базе данных приложения PowerPivot для каждого настроенного приложения службы.  
  
 При изменении параметров конфигурации изменения применяются сразу и используются для последующих запросов и соединений. При выполнении операций используются параметры, которые были определены на момент начала операции.  
  
 По нижеприведенным ссылкам можно ознакомиться с различными областями конфигурации:  
  
 [Время ожидания загрузки данных](#LoadingData)  
  
 [Пулы соединений](#ConnectionPool)  
  
 [Балансировка нагрузки](#AllocationScheme)  
  
 [Обновление данных](#DataRefresh)  
  
 [Сбор данных об использовании](#UsageData)  
  
 Инструкции по созданию приложения службы PowerPivot см. [в разделе Создание и настройка приложения службы PowerPivot в центре администрирования](create-and-configure-power-pivot-service-application-in-ca.md).  
  
##  <a name="data-load-timeout"></a><a name="LoadingData"></a> Время ожидания для загрузки данных  
 Данные PowerPivot извлекаются и загружаются экземплярами службы Analysis Services на ферме. В зависимости от того, когда и каким образом к данным осуществлялся доступ в последний раз, они будут загружены либо из библиотеки содержимого, либо из локального файлового кэша. Данные загружаются в память каждый раз при получении запроса. Для повышения общего уровня доступности сервера можно задать время ожидания, которое укажет серверу остановить запрос на загрузку данных, если он не может быть завершен в течение заданного периода времени.  
  
|Имя|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Время ожидания для загрузки данных|1800 (в секундах)|От 1 до 3600|Определяет время, в течение которого приложение службы PowerPivot будет ждать отклика от определенного экземпляра сервера служб Analysis Services.<br /><br /> По умолчанию приложение службы ожидает получения полезных данных от экземпляра службы Engine, которому был направлен специальный запрос, в течение 30 минут.<br /><br /> Если источник данных PowerPivot не будет загружен в течение этого времени, поток будет остановлен и запустится новый поток.|  
  
##  <a name="connection-pools"></a><a name="ConnectionPool"></a>Пулы подключений  
 Приложение службы PowerPivot создает пулы соединений и управляет ими, обеспечивая повторное использование соединений. Существует два типа пулов соединений: для подключения к данным только для чтения и для соединений с сервером.  
  
 Пулы подключения к данным содержат кэшируемые подключения к источнику данных PowerPivot. Каждый пул соединений создается на основе контекста, заданного при загрузке базы данных. Этот контекст включает идентификатор физического экземпляра службы, идентификатор базы данных и идентификатор пользователя SharePoint, который запрашивает данные. Для каждого сочетания создается отдельный пул соединений. Например, запросы разных пользователей к одной и той же базе данных, находящейся на одном сервере, будут находиться в разных пулах соединений.  
  
 Назначением пула соединений является кэширование соединений для запросов к данным только для чтения к одной базе данных служб Analysis Services одним пользователем SharePoint. Экземпляр службы PowerPivot Ї это сервер, в память которого загружены данные. Идентификатор базы данных — это внутренний идентификатор для структур данных модели в памяти (для модели создается экземпляр в виде базы данных куба служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ). Сведения о версии неявным образом включаются в идентификатор.  
  
 Пулы соединений с сервером содержат кэшируемые соединения из экземпляра приложения службы PowerPivot с экземпляром сервера служб Analysis Services, где приложение службы входит на сервер служб Analysis Services с разрешениями системного администратора служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Эти соединения служат для отправки запросов на загрузку базы данных и мониторинга исправности системы.  
  
 Каждый из типов пулов соединений имеет настраиваемые верхние предельные значения, позволяющие обеспечить оптимальное использование системной памяти для управления соединениями.  
  
|Имя|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Время ожидания пула соединений|1800 (в секундах)|От 1 до 3600.|Этот параметр применяется к пулам подключений к данным.<br /><br /> Он определяет время, в течение которого неактивное соединение может оставаться в пуле соединений, прежде чем оно будет удалено.<br /><br /> По умолчанию приложение службы удаляет соединение после пяти минут отсутствия активности.|  
|Максимальный размер пула пользовательских соединений|1000|От -1, 0 или 1 до 10000.<br /><br /> -1 означает неограниченное количество неактивных соединений.<br /><br /> 0 означает, что неактивные соединения не сохраняются. Новые соединения с источником данных PowerPivot создаются каждый раз.|Этот параметр применяется к числу неактивных соединений во всех пулах подключений к данным, созданных для экземпляра приложения службы PowerPivot.<br /><br /> Отдельные пулы соединений создаются для уникальных сочетаний пользователя SharePoint, данных PowerPivot и экземпляра службы. Если несколько пользователей обращаются к нескольким источникам данных PowerPivot, то это может положительно повлиять на производительность сервера за счет увеличения размера пула соединений.<br /><br /> Если создано более 100 неактивных соединений с экземпляром службы PowerPivot, то новые неактивные соединения отключаются, а не возвращаются в пул.|  
|Максимальный размер пула административных соединений|200|От -1, 0 или 1 до 10000.<br /><br /> -1 означает неограниченное количество неактивных соединений.|Максимальное число неактивных соединений сервера во всех пулах административных соединений для соединений приложения службы PowerPivot с экземпляром сервера служб Analysis Services. Соединения сервера используются для запросов на загрузку баз данных и сохранения изменений в базе данных SharePoint.|  
  
##  <a name="load-balancing"></a><a name="AllocationScheme"></a>Балансировка нагрузки  
 Одной из функций, реализованной в службе PowerPivot, является выбор одного из доступных экземпляров службы PowerPivot для загрузки данных служб Analysis Services. Параметр `AllocationMethod` определяет условия, по которым выбирается экземпляр службы.  
  
|Имя|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Способ распределения|RoundRobin|Циклический перебор<br /><br /> По исправности|Схема распределения запросов загрузки между двумя и более экземплярами сервера служб Analysis Services.<br /><br /> По умолчанию служба PowerPivot распределяет запросы с учетом работоспособности серверов. Параметр «На основе исправности системы» определяет передачу запросов на сервер, который имеет наибольший объем доступных ресурсов (память и загрузка ЦП).<br /><br /> Циклический список предусматривает циклическое распределение запросов по доступным серверам в последовательном порядке, без учета текущей загруженности или работоспособности сервера.|  
  
##  <a name="data-refresh"></a><a name="DataRefresh"></a> Обновление данных  
 Укажите временной интервал, который считается типичным рабочим временем в вашей организации. Эти параметры конфигурации определяют, во сколько должно выполняться обновление данных после окончания рабочего дня. Она начнется по истечении этого интервала. Обработка после окончания рабочего дня — это параметр расписания для владельцев документов, которые хотят вносить в источник данных PowerPivot данные о транзакциях, созданных в течение рабочего дня.  
  
|Имя|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Время начала|04:00|От 1 до 12 часов, где значение представляет собой допустимое целое число в данном диапазоне.<br /><br /> Тип Time.|Определяет нижнюю границу диапазона рабочего времени.|  
|Время окончания|20:00|От 1 до 12 часов, где значение представляет собой допустимое целое число в данном диапазоне.<br /><br /> Тип Time.|Определяет верхнюю границу диапазона рабочего времени.|  
|Учетная запись автоматического обновления данных PowerPivot|Нет|Идентификатор целевого приложения|Эта учетная запись используется для выполнения заданий по обновлению данных от имени владельца расписания.<br /><br /> Учетную запись автоматического обновления данных необходимо определить до того, как она указывается на странице настройки приложения службы. Дополнительные сведения см. [в статье Настройка учетной записи автоматического обновления данных PowerPivot &#40;PowerPivot для SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).|  
|Разрешить пользователям вводить пользовательские учетные данные Windows|Активировано|Логическое|Определяет, выводится ли на странице настройки планового обновления данных параметр, который позволяет владельцу расписания указать учетную запись пользователя и пароль Windows для выполнения задания по обновлению данных.<br /><br /> Для работы этого параметра должна быть включена служба Secure Store. Дополнительные сведения см. в разделе [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).|  
|Максимальный размер журнала обработки|365|От 1 до 5000 дней|Определяет продолжительность хранения для журнала обработки данных в базе данных приложения службы PowerPivot. Дополнительные сведения см. в статье [PowerPivot Usage Data Collection](power-pivot-usage-data-collection.md).|  
  
##  <a name="usage-data-collection"></a><a name="UsageData"></a>Сбор данных об использовании  
 Отчеты об использовании, выводимые на панели управления PowerPivot, могут дать важные сведения о том, как используются книги с поддержкой PowerPivot. Следующие параметры конфигурации управляют аспектами сбора данных о событиях сервера PowerPivot, которые последовательно регистрируются в отчетах об использовании или активности.  
  
|Имя|По умолчанию|Допустимые значения|Описание|  
|----------|-------------|------------------|-----------------|  
|Период составления отчетов о запросах|300 (в секундах)|От 1 до n секунд, где n — допустимое целое число.|Чтобы затрачивать на сбор данных об использовании слишком много ресурсов фермы, статистика запросов собирается по каждому соединению и отправляется в виде единого события. Параметр «Интервал отчетов о запросах» определяет частоту передачи события. По умолчанию отчет по статистике запросов отправляется раз в 5 минут.<br /><br /> Поскольку соединение закрывается сразу после отправки запроса, система формирует очень большое количество соединений даже для одного пользователя, который обращается к одному источнику данных PowerPivot. Поэтому пулы соединений создаются для каждого сочетания пользователя с источником данных PowerPivot, чтобы после создания соединения оно могло быть использовано повторно тем же пользователем для тех же данных. Периодически с интервалами, которые определяются этим параметром конфигурации, приложение службы PowerPivot составляет отчет по данным использования для каждого соединения в пуле соединений.<br /><br /> Увеличение этого значения приведет к сокращению числа событий, регистрируемых в журнал. Однако, если оно будет слишком большим, существует риск потери данных о событиях в случае перезапуска сервера или закрытия соединения.<br /><br /> Уменьшение этого значения приведет к тому, что запись событий в журнал будет производиться с большей частотой и вырастет объем данных об использовании функций PowerPivot, передаваемых системой сбора данных в базу данных SharePoint.<br /><br /> Как правило, этот параметр конфигурации не требует изменения, кроме тех случаев, когда необходимо разрешить какую-либо особую проблему (например, если база данных использования слишком быстро растет и причина этого — данные об использовании PowerPivot).|  
|Журнал данных об использовании|365 (дни)|0 или от 1 до n дней, где n — допустимое целое число.<br /><br /> 0 означает, что история сохраняется всегда и никогда не удаляется.|По умолчанию данные об использовании хранятся в базе данных приложения службы PowerPivot в течение одного года. По истечении одного года записи удаляются из базы данных.<br /><br /> Проверка статистических данных с истекшим сроком происходит ежедневно при запуске задания по обработке данных об использовании Microsoft SharePoint Foundation. Задание таймера считывает этот параметр и выполняет команду удаления данных для записей с истекшим сроком хранения в базе данных приложения службы PowerPivot.|  
|Верхняя граница тривиального ответа|500 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для обычных запросов составляет полсекунды.<br /><br /> Обычные запросы включают команды ping для сервера, запросы метаданных и установление сеансов.|  
|Верхняя граница быстрого ответа|1000 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для быстрых запросов составляет одну секунду.<br /><br /> Быстрые запросы оперируют чрезвычайно малыми объемами наборами данных либо запрашивают метаданные, которые распространяются на большие наборы элементов.|  
|Верхняя граница ожидаемого времени ответа|3000 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для ожидаемых запросов составляет 3 секунды.<br /><br /> Это значение определяет верхнюю границу времени ожидаемого запроса.|  
|Верхний предел для долгих ответов|10000 (в миллисекундах)|От 1 до n миллисекунд, где n представляет собой допустимое целое число.|По умолчанию пороговое значение для длинных запросов составляет десять секунд.<br /><br /> Такие запросы выполняются дольше ожидаемых, но все же попадают в приемлемый диапазон.|  
  
## <a name="see-also"></a>См. также:  
 [Создание и настройка приложения службы PowerPivot в центре администрирования](create-and-configure-power-pivot-service-application-in-ca.md)   
 [Обновление данных PowerPivot с SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md)   
 [Настройка сбора данных об использовании для &#40;PowerPivot для SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md)   
 [Настройка учетных записей служб PowerPivot](configure-power-pivot-service-accounts.md)   
 [Панель мониторинга управления PowerPivot и данные об использовании](power-pivot-management-dashboard-and-usage-data.md)  
  
  
