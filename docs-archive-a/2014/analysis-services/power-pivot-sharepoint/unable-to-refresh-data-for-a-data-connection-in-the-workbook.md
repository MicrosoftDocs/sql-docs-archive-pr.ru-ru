---
title: 'Не удалось обновить данные для подключения к данным в книге. Повторите попытку или обратитесь к системному администратору. Не удалось обновить следующие соединения: данные PowerPivot | Документация Майкрософт'
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 0f6fd52d-ac72-43e3-aa08-05a2d2bb873d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9c25c2597bbc7aa16fb8b66d4ffddbf0df14515e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736935"
---
# <a name="unable-to-refresh-data-for-a-data-connection-in-the-workbook-try-again-or-contact-your-system-administrator-the-following-connections-failed-to-refresh-powerpivot-data"></a><span data-ttu-id="25620-104">Не удалось обновить данные для подключения к данным в книге.</span><span class="sxs-lookup"><span data-stu-id="25620-104">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="25620-105">Повторите попытку или обратитесь к системному администратору.</span><span class="sxs-lookup"><span data-stu-id="25620-105">Try again or contact your system administrator.</span></span> <span data-ttu-id="25620-106">Следующие соединения не удалось обновить: данные PowerPivot</span><span class="sxs-lookup"><span data-stu-id="25620-106">The following connections failed to refresh: PowerPivot Data</span></span>
  <span data-ttu-id="25620-107">Применительно к книгам Excel, содержащим данные PowerPivot, службы Excel возвращают эту ошибку, если при передаче запроса на соединение серверу PowerPivot запрос завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="25620-107">For Excel workbooks that contain PowerPivot data, Excel Services returns this error if it submits a connection request to a PowerPivot server and the request fails.</span></span>  
  
## <a name="details"></a><span data-ttu-id="25620-108">Сведения</span><span class="sxs-lookup"><span data-stu-id="25620-108">Details</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="25620-109">Область применения:</span><span class="sxs-lookup"><span data-stu-id="25620-109">Applies to:</span></span>|<span data-ttu-id="25620-110">Установка PowerPivot для SharePoint</span><span class="sxs-lookup"><span data-stu-id="25620-110">PowerPivot for SharePoint installation</span></span>|  
|<span data-ttu-id="25620-111">Версия продукта</span><span class="sxs-lookup"><span data-stu-id="25620-111">Product Version</span></span>|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="25620-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="25620-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span></span>|  
|<span data-ttu-id="25620-113">Причина</span><span class="sxs-lookup"><span data-stu-id="25620-113">Cause</span></span>|<span data-ttu-id="25620-114">См. ниже.</span><span class="sxs-lookup"><span data-stu-id="25620-114">See below.</span></span>|  
|<span data-ttu-id="25620-115">Текст сообщения</span><span class="sxs-lookup"><span data-stu-id="25620-115">Message Text</span></span>|<span data-ttu-id="25620-116">Не удалось обновить данные для подключения к данным в книге.</span><span class="sxs-lookup"><span data-stu-id="25620-116">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="25620-117">Повторите попытку или обратитесь к системному администратору.</span><span class="sxs-lookup"><span data-stu-id="25620-117">Try again or contact your system administrator.</span></span> <span data-ttu-id="25620-118">Следующие соединения не удалось обновить: данные PowerPivot</span><span class="sxs-lookup"><span data-stu-id="25620-118">The following connections failed to refresh: PowerPivot Data</span></span>|  
  
## <a name="explanation-and-resolution"></a><span data-ttu-id="25620-119">Описание проблемы и действия по ее разрешению</span><span class="sxs-lookup"><span data-stu-id="25620-119">Explanation and Resolution</span></span>  
 <span data-ttu-id="25620-120">Службы Excel не могут установить соединение или загрузить данные PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="25620-120">Excel Services cannot connect to or load the PowerPivot data.</span></span> <span data-ttu-id="25620-121">Эта ошибка возникает, в частности, при следующих условиях.</span><span class="sxs-lookup"><span data-stu-id="25620-121">Conditions that cause this error to occur include the following:</span></span>  
  
 <span data-ttu-id="25620-122">**Сценарий 1. Служба не запущена.**</span><span class="sxs-lookup"><span data-stu-id="25620-122">**Scenario 1: Service is not started**</span></span>  
  
 <span data-ttu-id="25620-123">Не запущен экземпляр служб SQL Server Analysis Services (PowerPivot).</span><span class="sxs-lookup"><span data-stu-id="25620-123">The SQL Server Analysis Services (PowerPivot) instance is not started.</span></span> <span data-ttu-id="25620-124">Истечение срока действия пароля стало причиной остановки выполнения службы.</span><span class="sxs-lookup"><span data-stu-id="25620-124">An expired password will cause the service to stop running.</span></span> <span data-ttu-id="25620-125">Дополнительные сведения об изменении пароля см. в разделах [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) и [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span><span class="sxs-lookup"><span data-stu-id="25620-125">For more information about changing the password, see [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) and [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span></span>  
  
 <span data-ttu-id="25620-126">**Сценарий 2a: открытие более ранней версии книги на сервере**</span><span class="sxs-lookup"><span data-stu-id="25620-126">**Scenario 2a: Opening an earlier version workbook n the server**</span></span>  
  
 <span data-ttu-id="25620-127">Возможно книга, которую вы пытаетесь открыть, создана в другой версии PowerPivot для Excel для SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="25620-127">The workbook you are attempting to open might have been created in the SQL Server 2008 R2 version of PowerPivot for Excel.</span></span> <span data-ttu-id="25620-128">Наиболее вероятно, что указанный в строке подключения поставщик данных служб Analysis Services, отсутствует на компьютере, который обрабатывает этот запрос.</span><span class="sxs-lookup"><span data-stu-id="25620-128">Most likely, the Analysis Services data provider that is specified in the data connection string is not present on the computer that is handling the request.</span></span>  
  
 <span data-ttu-id="25620-129">В этом случае вы увидите это сообщение в журнале ULS: "сбой обновления для данных PowerPivot" в книге " \<URL to workbook> " ", а затем —" не удается получить соединение ".</span><span class="sxs-lookup"><span data-stu-id="25620-129">If this is the case, you will find this message in the ULS log: "Refresh failed for 'PowerPivot Data' in the workbook '\<URL to workbook>'", followed by "Unable to get a connection".</span></span>  
  
 <span data-ttu-id="25620-130">Чтобы определить версию книги, необходимо открыть ее в Excel и проверить, какой поставщик данных указан в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="25620-130">To determine the version of the workbook, open it in Excel and check which data provider is specified in the connection string.</span></span> <span data-ttu-id="25620-131">Книга SQL Server 2008 R2 использует в качестве поставщика данных MSOLAP.4.</span><span class="sxs-lookup"><span data-stu-id="25620-131">A SQL Server 2008 R2 workbook uses MSOLAP.4 as its data provider.</span></span>  
  
 <span data-ttu-id="25620-132">Для решения этой проблемы вы можете обновить книгу.</span><span class="sxs-lookup"><span data-stu-id="25620-132">To work around this issue, you can upgrade the workbook.</span></span> <span data-ttu-id="25620-133">В качестве альтернативы можно установить клиентские библиотеки из версии служб Analysis Services для SQL Server 2008 R2 на физических ПК, на которых запускается PowerPivot для служб SharePoint или Excel:</span><span class="sxs-lookup"><span data-stu-id="25620-133">Alternatively, you can install client libraries from the SQL Server 2008 R2 version of Analysis Services on the physical computers running PowerPivot for SharePoint or Excel Services:</span></span>  
  
 [<span data-ttu-id="25620-134">Установка поставщика OLE DB служб Analysis Services на серверах SharePoint</span><span class="sxs-lookup"><span data-stu-id="25620-134">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)  
  
 <span data-ttu-id="25620-135">**Сценарий 2b: службы Excel выполняются на сервере приложений, на котором находится неправильная версия клиентских библиотек**</span><span class="sxs-lookup"><span data-stu-id="25620-135">**Scenario 2b: Excel Services is running on an application server that has the wrong version of the client libraries**</span></span>  
  
 <span data-ttu-id="25620-136">По умолчанию, SharePoint Server 2010 устанавливает на серверы приложений со службами Excel поставщик OLE DB для версии служб Analysis Services, предназначенной для SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="25620-136">By default, SharePoint Server 2010 installs the SQL Server 2008 version of the Analysis Services OLE DB provider on application servers that run Excel Services.</span></span> <span data-ttu-id="25620-137">В ферме, которая поддерживает доступ к данным PowerPivot, все физические серверы, на которых запущены приложения, запрашивающие данные PowerPivot, например службы Excel и PowerPivot для SharePoint, должны использовать более позднюю версию поставщика данных.</span><span class="sxs-lookup"><span data-stu-id="25620-137">In a farm that supports PowerPivot data access, all physical servers running applications that request PowerPivot data, such as Excel Services and PowerPivot for SharePoint, must use a later version of the data provider.</span></span>  
  
 <span data-ttu-id="25620-138">Серверы под управлением PowerPivot для SharePoint автоматически получают обновленный поставщик OLE DB.</span><span class="sxs-lookup"><span data-stu-id="25620-138">Servers that run PowerPivot for SharePoint get the updated OLE DB data provider automatically.</span></span> <span data-ttu-id="25620-139">Другие серверы, например такие, на которых запущен отдельный экземпляр служб Excel без служб PowerPivot для SharePoint, установленных на этом же компьютере, должны быть исправлены, чтобы использовать клиентские библиотеки более новой версии.</span><span class="sxs-lookup"><span data-stu-id="25620-139">Other servers, such as those running a standalone instance Excel Services without PowerPivot for SharePoint on the same computer, must be patched to use the newer client libraries.</span></span> <span data-ttu-id="25620-140">Дополнительные сведения см. в статье [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span><span class="sxs-lookup"><span data-stu-id="25620-140">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>  
  
 <span data-ttu-id="25620-141">**Сценарий 3: недоступен контроллер домена**</span><span class="sxs-lookup"><span data-stu-id="25620-141">**Scenario 3: Domain controller is unavailable**</span></span>  
  
 <span data-ttu-id="25620-142">Причина может заключаться в том, что контроллер домена недоступен для проверки удостоверения пользователя.</span><span class="sxs-lookup"><span data-stu-id="25620-142">The cause might be that a domain controller is not available to validate the user identity.</span></span> <span data-ttu-id="25620-143">Для проверки подлинности пользователя SharePoint службе Claims to Windows Token Service требуется контроллер домена при каждом соединении.</span><span class="sxs-lookup"><span data-stu-id="25620-143">A domain controller is required by the Claims to Windows Token Service to authenticate the SharePoint user on each connection.</span></span> <span data-ttu-id="25620-144">Служба Claims to Windows Token Service не использует кэшированные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="25620-144">The Claims to Windows Token Service does not use cached credentials.</span></span> <span data-ttu-id="25620-145">Она проверяет удостоверение пользователя для каждого соединения.</span><span class="sxs-lookup"><span data-stu-id="25620-145">It validates the user identity for each connection.</span></span>  
  
 <span data-ttu-id="25620-146">Подтвердить причину этой ошибки можно, открыв файл журнала SharePoint.</span><span class="sxs-lookup"><span data-stu-id="25620-146">You can confirm the cause of this error by viewing the SharePoint log file.</span></span> <span data-ttu-id="25620-147">Если в журналах SharePoint есть сообщение «Не удалось получить WindowsIdentity от IClaimsIdentity», то подлинность удостоверения пользователя не удалось проверить.</span><span class="sxs-lookup"><span data-stu-id="25620-147">If the SharePoint logs include the message "Failed to get WindowsIdentity from IClaimsIdentity", the user identity could not be authenticated.</span></span>  
  
 <span data-ttu-id="25620-148">Чтобы решить эту проблему, присоедините компьютер к домену, в котором находится сервер PowerPivot, или установите контроллер домена на локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="25620-148">To work around this problem, join the computer to the same domain as the PowerPivot server, or install a domain controller on your local computer.</span></span> <span data-ttu-id="25620-149">Второе решение, установка контроллера домена, потребует создания локальных учетных записей домена для всех служб и пользователей.</span><span class="sxs-lookup"><span data-stu-id="25620-149">The second solution, installing the domain controller, will require you to create local domain accounts for all services and users.</span></span> <span data-ttu-id="25620-150">Для создаваемых учетных записей потребуется настроить учетные записи служб и разрешения SharePoint.</span><span class="sxs-lookup"><span data-stu-id="25620-150">You will need to configure service accounts and SharePoint permissions for the accounts you define.</span></span>  
  
 <span data-ttu-id="25620-151">Установка контроллера домена на компьютер рекомендуется в случае, если стоит задача использовать PowerPivot для SharePoint без подключения к сети (вне сети).</span><span class="sxs-lookup"><span data-stu-id="25620-151">Installing a domain controller on your computer is useful if your objective is to use PowerPivot for SharePoint in an offline state.</span></span> <span data-ttu-id="25620-152">Подробные инструкции по использованию PowerPivot в автономном режиме см. в записи блога "перевод сервера PowerPivot в сеть" [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241) .</span><span class="sxs-lookup"><span data-stu-id="25620-152">For detailed instructions on how to use PowerPivot offline, see the blog entry for "Taking your PowerPivot server off the network" on [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241).</span></span>  
  
 <span data-ttu-id="25620-153">**Сценарий 4: сервер работает нестабильно**</span><span class="sxs-lookup"><span data-stu-id="25620-153">**Scenario 4: Unstable server**</span></span>  
  
 <span data-ttu-id="25620-154">Одна или несколько служб могут находиться в несогласованном состоянии.</span><span class="sxs-lookup"><span data-stu-id="25620-154">One or more services might be in an inconsistent state.</span></span> <span data-ttu-id="25620-155">В некоторых случаях решить эту проблему можно, выполнив команду IISRESET.</span><span class="sxs-lookup"><span data-stu-id="25620-155">In some cases, running IISRESET will resolve the problem.</span></span>  
  
  
