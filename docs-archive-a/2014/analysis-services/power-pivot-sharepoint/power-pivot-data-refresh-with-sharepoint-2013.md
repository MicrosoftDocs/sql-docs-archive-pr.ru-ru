---
title: Обновление данных PowerPivot с SharePoint 2013 | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87664550"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="fc8e7-102">Обновление данных PowerPivot с SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="fc8e7-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="fc8e7-103">Проектирование для обновления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] моделей данных в SharePoint 2013 использует службы Excel в качестве основного компонента для загрузки и обновления моделей данных на экземпляре, [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] работающем в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="fc8e7-104">Сервер [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] работает на внешней ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="fc8e7-105">Ранее использовавшаяся архитектура обновления данных при загрузке и обновлении моделей данных полагалась исключительно на системные службы PowerPivot экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="fc8e7-106">Экземпляр служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] запускался локально на сервере приложений PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="fc8e7-107">В новой архитектуре появился новый метод поддержания актуальности информации в виде метаданных элемента книги, находящейся в библиотеке документов.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="fc8e7-108">Архитектура служб SharePoint 2013 Excel поддерживает как **интерактивное** , так и **плановое**обновление данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="fc8e7-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="fc8e7-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="fc8e7-110">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="fc8e7-111">Интерактивное обновление данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="fc8e7-112">Проверка подлинности Windows с подключением к данным книги и интерактивным обновлением данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="fc8e7-113">Запланированное обновление данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="fc8e7-114">Архитектура планового обновления данных в SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="fc8e7-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="fc8e7-115">Другие вопросы проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="fc8e7-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="fc8e7-116">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="fc8e7-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="fc8e7-117">Историческая справка</span><span class="sxs-lookup"><span data-stu-id="fc8e7-117">Background</span></span>  
 <span data-ttu-id="fc8e7-118">SharePoint Server 2013 службы Excel управляют обновлением данных для книг Excel 2013 и запускает обработку модели данных на [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] сервере, работающем в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="fc8e7-119">Для книг Excel 2010 службы Excel также управляют загрузкой и сохранением книг и моделей данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="fc8e7-120">Однако при этом службы Excel при отправке и обработке команд к модели данных полагаются на системные службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="fc8e7-121">В следующей таблице сведены компоненты, которые отправляют команды на обновление данных, в зависимости он версии книги.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="fc8e7-122">В качестве рабочей среды подразумевается ферма SharePoint 2013, настроенная на использование служб [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="fc8e7-123">Книги Excel 2013</span><span class="sxs-lookup"><span data-stu-id="fc8e7-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="fc8e7-124">Книги Excel 2010</span><span class="sxs-lookup"><span data-stu-id="fc8e7-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="fc8e7-125">Запуск обновления данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-125">Trigger Data Refresh</span></span>|<span data-ttu-id="fc8e7-126">**Интерактивное:** пользователь, прошедший проверку подлинности</span><span class="sxs-lookup"><span data-stu-id="fc8e7-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="fc8e7-127">**Запланировано:** Системная служба PowerPivot</span><span class="sxs-lookup"><span data-stu-id="fc8e7-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="fc8e7-128">Системная служба PowerPivot</span><span class="sxs-lookup"><span data-stu-id="fc8e7-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="fc8e7-129">Загрузка книги из баз данных содержимого</span><span class="sxs-lookup"><span data-stu-id="fc8e7-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="fc8e7-130">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fc8e7-131">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="fc8e7-132">Загрузка модели данных на экземпляр служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fc8e7-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="fc8e7-133">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fc8e7-134">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="fc8e7-135">Отправка команд обработки на экземпляр служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fc8e7-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="fc8e7-136">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fc8e7-137">Системная служба PowerPivot</span><span class="sxs-lookup"><span data-stu-id="fc8e7-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="fc8e7-138">Обновление данных книги</span><span class="sxs-lookup"><span data-stu-id="fc8e7-138">Update Workbook Data</span></span>|<span data-ttu-id="fc8e7-139">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fc8e7-140">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="fc8e7-141">Сохранение книги и модели данных в базе данных содержимого</span><span class="sxs-lookup"><span data-stu-id="fc8e7-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="fc8e7-142">**Интерактивное:** Н/Д</span><span class="sxs-lookup"><span data-stu-id="fc8e7-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="fc8e7-143">**Плановое:** службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fc8e7-144">Службы SharePoint 2013 Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="fc8e7-145">В следующей таблице сведены поддерживаемые возможности обновления на ферме SharePoint 2013, настроенной на использование служб [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="fc8e7-146">Книга создана в</span><span class="sxs-lookup"><span data-stu-id="fc8e7-146">Workbook created in</span></span>|<span data-ttu-id="fc8e7-147">Обновление данных по расписанию</span><span class="sxs-lookup"><span data-stu-id="fc8e7-147">Scheduled data refresh</span></span>|<span data-ttu-id="fc8e7-148">Интерактивное обновление данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="fc8e7-149">2008 R2 PowerPivot для Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="fc8e7-150">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-150">Not supported.</span></span> <span data-ttu-id="fc8e7-151">Обновление книги **( \* )**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="fc8e7-152">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-152">Not supported.</span></span> <span data-ttu-id="fc8e7-153">Обновление книги **( \* )**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="fc8e7-154">2012 PowerPivot для Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="fc8e7-155">Поддерживается</span><span class="sxs-lookup"><span data-stu-id="fc8e7-155">Supported</span></span>|<span data-ttu-id="fc8e7-156">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-156">Not supported.</span></span> <span data-ttu-id="fc8e7-157">Обновление книги **( \* )**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="fc8e7-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="fc8e7-158">Excel 2013</span></span>|<span data-ttu-id="fc8e7-159">Поддерживается</span><span class="sxs-lookup"><span data-stu-id="fc8e7-159">Supported</span></span>|<span data-ttu-id="fc8e7-160">Поддерживается</span><span class="sxs-lookup"><span data-stu-id="fc8e7-160">Supported</span></span>|  
  
 <span data-ttu-id="fc8e7-161">**( \* )** Дополнительные сведения об обновлении книги см. в статье [обновление книг и запланированное обновление данных &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="fc8e7-162">Interactive Data Refresh</span><span class="sxs-lookup"><span data-stu-id="fc8e7-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="fc8e7-163">Интерактивное или ручное обновление данных в службах SharePoint Server 2013 Excel Services может обновить модели сведениями из оригинальных источников данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="fc8e7-164">Интерактивное обновление данных становится доступным после настройки приложения служб Excel путем регистрации сервера [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="fc8e7-165">Дополнительные сведения см. в разделе [Управление параметрами модели данных служб Excel (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fc8e7-166">Интерактивное обновление данных доступно только для книг, созданных в Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="fc8e7-167">При попытке обновить книгу Excel 2010 службы Excel выводят сообщение об ошибке, похожее на "сбой операции PowerPivot: книга была создана в более ранней версии Excel, и PowerPivot не может быть обновлен до обновления файла".</span><span class="sxs-lookup"><span data-stu-id="fc8e7-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="fc8e7-168">Дополнительные сведения об обновлении книг см. в статье [Обновление книг и создание расписания обновления данных (SharePoint 2013)](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="fc8e7-169">**Основная особенность интерактивного обновления**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="fc8e7-170">При интерактивном обновлении данных обновляются только данные в сеансе текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="fc8e7-171">Данные автоматически не сохраняются в книге, хранящейся в базе данных содержимого SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="fc8e7-172">**Учетные данные.** При интерактивном обновлении данных в качестве учетных данных для подключения к источнику данных можно использовать удостоверение текущего, вошедшего в систему пользователя либо сохраненные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="fc8e7-173">Какие именно учетные данные используются, зависит от настроек проверки подлинности служб Excel при подключении к внешнему источнику данных для книги.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="fc8e7-174">**Поддерживаемые книги:**  книги, созданные в Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="fc8e7-175">**Обновление данных**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="fc8e7-176">См. порядок действий на иллюстрации.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="fc8e7-177">В библиотеке документов SharePoint откройте книгу PowerPivot в браузере.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="fc8e7-178">В окне браузера в меню **Данные** выберите пункт **Обновить выбранное соединение** или **Обновить все соединения**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="fc8e7-179">Службы Excel загружают базу данных PowerPivot, обрабатывают ее и затем выполняют к ней запрос, чтобы обновить кэш книги Excel.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="fc8e7-180">**Примечание.** Обновленная книга в библиотеку документов автоматически не сохраняется.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="fc8e7-181">![Интерактивное обновление данных](../media/as-interactive-datarefresh-sharepoint2013.gif "интерактивное")</span><span class="sxs-lookup"><span data-stu-id="fc8e7-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="fc8e7-182">Проверка подлинности Windows с подключением к данным книги и интерактивным обновлением данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="fc8e7-183">Службы Excel отправляют серверу службы Analysis Services команду обработки на олицетворение учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="fc8e7-184">Чтобы получить системные права, достаточные для выполнения процедуры делегирования и олицетворения для пользователя, учетная запись службы Analysis Services запрашивает право доступа **Работа в режиме операционной системы** на локальном сервере.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="fc8e7-185">Кроме того, сервер службы Analysis Services должен иметь возможность делегировать учетные записи пользователя источникам данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="fc8e7-186">Результат запроса отправляется службам Excel.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="fc8e7-187">Типичное взаимодействие с пользователем. когда клиент выбирает команду "обновить все подключения" в книге Excel 2013, содержащей модель PowerPivot, выводится сообщение об ошибке следующего вида:</span><span class="sxs-lookup"><span data-stu-id="fc8e7-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="fc8e7-188">**Ошибка обновления внешних данных.** Возникла ошибка при обработке модели данных в книге.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="fc8e7-189">Повторите попытку.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-189">Please try again.</span></span> <span data-ttu-id="fc8e7-190">Не удалось обновить одно или несколько подключений в данной книге.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="fc8e7-191">В зависимости от используемого поставщика данных вы увидите в журнале ULS сообщение, аналогичное следующему.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="fc8e7-192">**С помощью SQL Native Client:**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="fc8e7-193">Не удалось создать внешнее соединение или выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="fc8e7-194">Сообщение поставщика. Был задан, но не используется внешний объект «DataSource», ссылающийся на идентификаторы «20102481-39c8-4d21-bf63-68f583ad22bb».</span><span class="sxs-lookup"><span data-stu-id="fc8e7-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="fc8e7-195">Ошибка OLE DB или ODBC. При установлении соединения с сервером SQL Server произошла ошибка, связанная с сетью или с определенным экземпляром.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="fc8e7-196">Сервер не найден или недоступен.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-196">Server is not found or not accessible.</span></span> <span data-ttu-id="fc8e7-197">Проверьте, правильно ли указано имя экземпляра и настроен ли SQL Server для открытия удаленных соединений.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="fc8e7-198">Дополнительные сведения см. в электронной документации по SQL Server; 08001; Поставщик SSL: затребованный пакет безопасности не существует; 08001; Клиенту не удается установить связь; 08001; Клиент не поддерживает шифрование; 08001,</span><span class="sxs-lookup"><span data-stu-id="fc8e7-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="fc8e7-199">, имя соединения: ThisWorkbookDataModel, книга: book1.xlsx.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="fc8e7-200">**Для поставщика Microsoft OLE DB для SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="fc8e7-201">Не удалось создать внешнее соединение или выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="fc8e7-202">Сообщение поставщика: «Задан, но не используется внешний объект DataSource, соответствующий идентификатору 6e711bfa-b62f-4879-a177-c5dd61d9c242».</span><span class="sxs-lookup"><span data-stu-id="fc8e7-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="fc8e7-203">Ошибка OLE DB или ODBC.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="fc8e7-204">, имя соединения: ThisWorkbookDataModel, книга: OLEDB Provider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="fc8e7-205">**Для поставщика данных .NET Framework для SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="fc8e7-206">Не удалось создать внешнее соединение или выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="fc8e7-207">Сообщение поставщика. Был задан, но не используется внешний объект «DataSource», ссылающийся на идентификаторы f5fb916c-3eac-4d07-a542-531524c0d44a.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="fc8e7-208">Ошибки в реляционном модуле высокого уровня.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="fc8e7-209">Следующее исключение возникло при использовании управляемого интерфейса IDbConnection: не удалось загрузить файл или сборку «System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089» или один из его зависимых компонентов.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="fc8e7-210">Либо не обеспечен необходимый уровень олицетворения, либо уровень олицетворения недопустим.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="fc8e7-211">(Исключение HRESULT: 0x80070542.)</span><span class="sxs-lookup"><span data-stu-id="fc8e7-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="fc8e7-212">, имя соединения: ThisWorkbookDataModel, книга: NETProvider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="fc8e7-213">**Сводка шагов настройки** Настройка права доступа **Работа в качества части операционной системы** на локальном сервере</span><span class="sxs-lookup"><span data-stu-id="fc8e7-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="fc8e7-214">На Analysis Services сервере, работающем в режиме интеграции с SharePoint, добавьте учетную запись службы Analysis Services в привилегию "**Работа в качестве части операционной системы**":</span><span class="sxs-lookup"><span data-stu-id="fc8e7-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="fc8e7-215">Выполните команду " `secpol.msc` "</span><span class="sxs-lookup"><span data-stu-id="fc8e7-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="fc8e7-216">Выберите **Параметр локальной безопасности**, затем **Локальные политики**, а затем **Назначение прав пользователя**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="fc8e7-217">Добавьте учетную запись службы.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="fc8e7-218">Перезапустите службы Excel и перезагрузите сервер службы Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="fc8e7-219">Делегирование от учетной записи службы Excel или службы токенов Claims to Windows (C2WTS) экземпляру служб Analysis services не требуется.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="fc8e7-220">Поэтому никакая настройка KCD из служб Excel или C2WTS службе PowerPivot AS не нужна.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="fc8e7-221">Если серверный источник данных находится на том же сервере, что и экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , ограниченное делегирование Kerberos не требуется.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="fc8e7-222">Однако учетной записи службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] необходимо право на работу в качестве части операционной системы.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="fc8e7-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="fc8e7-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="fc8e7-224">Дополнительные сведения см. [в разделе Работа в составе операционной системы](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="fc8e7-225">Запланированное обновление данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="fc8e7-226">**Основные особенности планового обновления данных**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="fc8e7-227">Требует развертывания надстройки PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="fc8e7-228">Дополнительные сведения см. в разделе [Установка или удаление надстройки PowerPivot для SharePoint &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="fc8e7-229">Пользователь настраивает расписание обновления для книги.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="fc8e7-230">В запланированное время системная служба PowerPivot отправляет службе Excel запрос:</span><span class="sxs-lookup"><span data-stu-id="fc8e7-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="fc8e7-231">на загрузку и обработку базы данных PowerPivot;</span><span class="sxs-lookup"><span data-stu-id="fc8e7-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="fc8e7-232">обновление книги;</span><span class="sxs-lookup"><span data-stu-id="fc8e7-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="fc8e7-233">сохранение книги в базе данных содержимого.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="fc8e7-234">**Учетные данные.** Используется сохраненные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="fc8e7-235">Удостоверение текущего пользователя не используется.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="fc8e7-236">**Поддерживаемые книги.** Книги, созданные с помощью надстройки служб [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot для Excel 2010 или с помощью Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="fc8e7-237">Не поддерживаются книги, созданные в Excel 2010 с надстройкой [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="fc8e7-238">Обновите книгу по крайней мере до формата [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="fc8e7-239">Дополнительные сведения об обновлении книг см. в статье [Обновление книг и создание расписания обновления данных (SharePoint 2013)](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="fc8e7-240">Отображение страницы **Управление обновлением данных**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="fc8e7-241">См. порядок действий на иллюстрации.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="fc8e7-242">В библиотеке документов SharePoint нажмите кнопку **Меню открытия** (**…**) для книги PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="fc8e7-243">Нажмите вторую кнопку **Меню открытия** и выберите **Управление обновлением данных PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="fc8e7-244">На странице **Управление обновлением данных** щелкните **Включить** , а затем настройте расписание обновления.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="fc8e7-245">В заданное время системная служба PowerPivot отправляет службе Excel запрос:</span><span class="sxs-lookup"><span data-stu-id="fc8e7-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="fc8e7-246">на загрузку и обработку модели данных PowerPivot;</span><span class="sxs-lookup"><span data-stu-id="fc8e7-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="fc8e7-247">обновление книги;</span><span class="sxs-lookup"><span data-stu-id="fc8e7-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="fc8e7-248">сохранение книги в базе данных содержимого.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="fc8e7-249">![управление контекстным меню обновления данных](../media/as-manage-datarefresh-sharepoint2013.gif "управление контекстным меню обновления данных")</span><span class="sxs-lookup"><span data-stu-id="fc8e7-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="fc8e7-250">Сведения об обновлении книг из SharePoint Online см. в разделе [обновление книг Excel с внедренными моделями PowerPivot из SharePoint Online (технический документ)](https://technet.microsoft.com/library/jj992650.aspx) ( https://technet.microsoft.com/library/jj992650.aspx) .</span><span class="sxs-lookup"><span data-stu-id="fc8e7-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="fc8e7-251">Архитектура запланированного обновления данных в SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="fc8e7-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="fc8e7-252">На следующем рисунке показана архитектура обновления данных для SharePoint 2013 и SQL Server 2012 с пакетом обновления 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="fc8e7-253">![архитектура обновления данных SQL Server 2012 с пакетом обновления 1 (SP1)](../media/as-scheduled-data-refresh2012sp1-architecture.gif "архитектура обновления данных SQL Server 2012 с пакетом обновления 1 (SP1)")</span><span class="sxs-lookup"><span data-stu-id="fc8e7-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="fc8e7-254">Описание</span><span class="sxs-lookup"><span data-stu-id="fc8e7-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="fc8e7-255">**одного**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-255">**(1)**</span></span>|<span data-ttu-id="fc8e7-256">Подсистема служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fc8e7-256">Analysis Services Engine</span></span>|<span data-ttu-id="fc8e7-257">Сервер [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , работающем в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="fc8e7-258">Сервер работает за пределами фермы SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="fc8e7-259">**открыт**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-259">**(2)**</span></span>|<span data-ttu-id="fc8e7-260">Пользовательский интерфейс</span><span class="sxs-lookup"><span data-stu-id="fc8e7-260">User Interface</span></span>|<span data-ttu-id="fc8e7-261">Пользовательский интерфейс состоит из двух страниц.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="fc8e7-262">На одной из них определяется расписание, а на второй можно просмотреть журнал обновления.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="fc8e7-263">Эти страницы не осуществляют прямого доступа к базам данных приложения службы PowerPivot, но пользуются системной службой PowerPivot для доступа к этим базам данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="fc8e7-264">**3-5**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-264">**(3)**</span></span>|<span data-ttu-id="fc8e7-265">Системная служба PowerPivot</span><span class="sxs-lookup"><span data-stu-id="fc8e7-265">PowerPivot System Service</span></span>|<span data-ttu-id="fc8e7-266">Эта служба устанавливается при развертывании надстройки PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="fc8e7-267">Она служит для выполнения следующих действий.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="fc8e7-268">В этой службе размещается исполняющий механизм планирования обновления, который вызывает API служб Excel для обновления данных в книгах Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="fc8e7-269">Для книг Excel 2010 эта служба непосредственно выполняет обработку модели данных, но продолжает обрабатывать запросы служб Excel на загрузку модели данных и обновление книги.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="fc8e7-270">Эта служба содержит методы для таких компонентов, как страницы пользовательского интерфейса, для обмена данными с системной службой.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="fc8e7-271">Управляет запросами на внешний доступ к книгам как к источнику данных, принимаемыми через веб-службу PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="fc8e7-272">Управление запросами на плановое обновление данных по заданиям таймера и страницам конфигурации.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="fc8e7-273">Эта служба управляет запросами на считывание данных из базы данных приложения службы и запускает обновление данных вместе со службами Excel.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="fc8e7-274">Обработка использования и связанные задания таймера.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="fc8e7-275">**четырех**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-275">**(4)**</span></span>|<span data-ttu-id="fc8e7-276">Службы вычислений Excel</span><span class="sxs-lookup"><span data-stu-id="fc8e7-276">Excel Calculation Services</span></span>|<span data-ttu-id="fc8e7-277">Отвечают за загрузку моделей данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="fc8e7-278">**5.0**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-278">**(5)**</span></span>|<span data-ttu-id="fc8e7-279">Служба Secure Store</span><span class="sxs-lookup"><span data-stu-id="fc8e7-279">Secure Store Service</span></span>|<span data-ttu-id="fc8e7-280">Если параметры проверки подлинности в книге настроены для **использования учетной записи пользователя, прошедшего проверку подлинности** , или **нет**, то для обновления данных используются учетные данные, хранящиеся в идентификаторе целевого приложения Secure Store.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="fc8e7-281">Дополнительные сведения см. в подразделе [Другие вопросы проверки подлинности](#datarefresh_additional_authentication) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="fc8e7-282">**1-6**</span><span class="sxs-lookup"><span data-stu-id="fc8e7-282">**(6)**</span></span>|<span data-ttu-id="fc8e7-283">Задание таймера обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="fc8e7-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="fc8e7-284">Указывает системной службе PowerPivot подключиться к службам Excel для обновления моделей данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="fc8e7-285">требуются соответствующие поставщики данных и клиентские библиотеки, чтобы сервер [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в режиме интеграции с SharePoint мог обращаться к источникам данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fc8e7-286">Поскольку системная служба PowerPivot больше не загружает и не сохраняет модели PowerPivot, большинство настроек кэширования на сервере приложений на ферме SharePoint 2013 не действуют.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="fc8e7-287">Данные журнала обновления данных</span><span class="sxs-lookup"><span data-stu-id="fc8e7-287">Data refresh log data</span></span>  
 <span data-ttu-id="fc8e7-288">**Данные об использовании.** Сведения об обновлении данных можно просмотреть на панели управления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="fc8e7-289">Просмотр данных об использовании</span><span class="sxs-lookup"><span data-stu-id="fc8e7-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="fc8e7-290">В центре администрирования SharePoint выберите **Панель управления PowerPivot** в группе **Общие параметры приложения** .</span><span class="sxs-lookup"><span data-stu-id="fc8e7-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="fc8e7-291">В нижней части панели мониторинга см. статью **Обновление данных — последние действия** и **Обновление данных — последние ошибки**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="fc8e7-292">Дополнительные сведения об использовании и о том, как включить сбор этих данных, см. в разделе [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="fc8e7-293">**Данные журнала диагностики.** Можно просмотреть журнал диагностики SharePoint, связанный с обновлением данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="fc8e7-294">Сначала проверьте конфигурацию ведения журнала диагностики в разделе **Служба PowerPivot** на странице **Мониторинг** центра администрирования SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="fc8e7-295">Может потребоваться увеличить уровень ведения журнала для журнала "минимальное критическое событие".</span><span class="sxs-lookup"><span data-stu-id="fc8e7-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="fc8e7-296">Например, временно установите значение **Подробно** и снова выполните операцию обновления данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="fc8e7-297">Журнал содержит следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="fc8e7-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="fc8e7-298">**Область\*\*\*\*Службы PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="fc8e7-299">Категория **Обновления данных**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="fc8e7-300">Просмотрите **Настройка ведения журнала диагностики**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="fc8e7-301">Дополнительные сведения см. в статьях [Настройка и просмотр файлов журнала SharePoint и журнала диагностики &#40;PowerPivot для SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="fc8e7-302">Дополнительные рекомендации по проверке подлинности</span><span class="sxs-lookup"><span data-stu-id="fc8e7-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="fc8e7-303">Параметры в диалоговом окне **Параметры проверки подлинности служб Excel** в Excel 2013 задают удостоверение Windows, которым службы Excel и [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] пользуются для обновления данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="fc8e7-304">**Использовать учетную запись пользователя, прошедшего проверку подлинности**. службы Excel выполняют обновление данных под удостоверением пользователя, вошедшего в систему.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="fc8e7-305">**Использовать сохраненные учетные данные**. Предполагается использование идентификатора приложения в службе SharePoint Secure Store, по которому службы Excel извлекают имя пользователя и пароль для проверки подлинности при обновлении данных.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="fc8e7-306">**Нет.** Используются **Учетная запись службы для автоматической обработки** службы Excel.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="fc8e7-307">Эта учетная запись службы связана с прокси-сервером Secure Store.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="fc8e7-308">Настройте параметры на странице **Параметры приложения служб Excel** в разделе **Внешние данные** .</span><span class="sxs-lookup"><span data-stu-id="fc8e7-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="fc8e7-309">Открытие диалогового окна «Параметры проверки подлинности»</span><span class="sxs-lookup"><span data-stu-id="fc8e7-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="fc8e7-310">Откройте вкладку **Данные** в Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="fc8e7-311">Нажмите на ленте **Соединения** .</span><span class="sxs-lookup"><span data-stu-id="fc8e7-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="fc8e7-312">В диалоговом окне **Соединения книги**выберите соединение и нажмите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="fc8e7-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="fc8e7-313">В диалоговом окне **Свойства соединения** щелкните **Определение**, а затем нажмите кнопку **Параметры проверки подлинности...** .</span><span class="sxs-lookup"><span data-stu-id="fc8e7-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="fc8e7-314">![Параметры проверки подлинности служб Excel](../media/as-authentication-settings-4-ecs-in-excel2013.gif "Параметры проверки подлинности служб Excel")</span><span class="sxs-lookup"><span data-stu-id="fc8e7-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="fc8e7-315">Дополнительные сведения о проверке подлинности при обновлении данных и использовании учетных данных см. в записи блога [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx)(на английском языке).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="fc8e7-316">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="fc8e7-316">More Information</span></span>  
 <span data-ttu-id="fc8e7-317">[Устранение неполадок при обновлении данных PowerPivot](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="fc8e7-318">[Службы Excel в SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span><span class="sxs-lookup"><span data-stu-id="fc8e7-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="fc8e7-319">См. также:</span><span class="sxs-lookup"><span data-stu-id="fc8e7-319">See Also</span></span>  
 <span data-ttu-id="fc8e7-320">[Обновление книг и обновление данных по расписанию &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="fc8e7-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="fc8e7-321">Установка PowerPivot для SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="fc8e7-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  
