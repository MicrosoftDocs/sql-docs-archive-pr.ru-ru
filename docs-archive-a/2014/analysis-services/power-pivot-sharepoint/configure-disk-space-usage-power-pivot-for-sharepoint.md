---
title: Настройка использования места на диске (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 201a3fda-f162-45d7-bf39-74dcb92fd0e6
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4f2c0df1673f523259d090cf85542739115c35b3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87727385"
---
# <a name="configure-disk-space-usage-powerpivot-for-sharepoint"></a>Настройка использования места на диске (PowerPivot для SharePoint)
  Чтобы обеспечить ускоренную перезагрузку, PowerPivot для SharePoint кэширует базу данных PowerPivot в свободном месте на диске главного компьютера. Каждая база данных PowerPivot, загружаемая в память, сначала кэшируется на диске, чтобы впоследствии ее можно было быстро перезагрузить для обслуживания поступающих запросов. По умолчанию PowerPivot для SharePoint использует свободное место на диске для кэширования баз данных, однако это можно изменить, задав параметры, ограничивающие использование дискового пространства.  
  
 В этом разделе описано, как установить ограничения на использование места на диске.  
  
 В этом разделе не представлены инструкции по управлению места на диске баз данных PowerPivot (внедренных в книги Excel), которые хранятся в базах данных содержимого. Базы данных PowerPivot могут иметь большой размер, в связи с чем требования к емкости подсистемы хранения фермы возрастают. Кроме того, если включено управление версиями, в одной базе данных содержимого вполне могут появиться несколько копий данных, что еще больше повышает потребность в месте на диске для хранения содержимого. Хотя базы данных PowerPivot важно учитывать для управления дисками, ими невозможно управлять обособленно от другого содержимого, хранящегося в ферме SharePoint. По мере того как книги PowerPivot используются в компании все чаще, следует внимательнее отслеживать загрузку места на диске. Операции с книгами PowerPivot также можно отслеживать на панели управления PowerPivot и удалять книги, которые больше не используются.  
  
## <a name="how-powerpivot-for-sharepoint-manages-cached-databases"></a>Управление кэшированными базами данных в PowerPivot для SharePoint  
 Для управления кэшем служба PowerPivot через равные интервалы времени выполняет фоновое задание по очистке неиспользуемых или устаревших баз данных и загрузке в текущую библиотеку последних версий. Цель очистки заключается в выгрузке неактивных баз данных из памяти и удалении неиспользуемых кэшированных баз данных из файловой системы. Задание по очистке служит для долгосрочного обслуживания и позволяет добиться того, чтобы базы данных не сохранялись в системе неограниченное время. На активном сервере базы данных могут удаляться чаще в силу большой загрузки памяти на сервере, удаления баз данных в SharePoint или появления более новых версий базы данных в текущей библиотеке.  
  
 Несмотря на то что изменить расписание выполнения задания по очистке нельзя, можно настроить управление файлом кэша с помощью серверных свойств конфигурации, отвечающих за следующие параметры:  
  
-   Ограничение объема места на диске, используемого кэшем.  
  
-   Объем данных, удаляемых при достижении максимального дискового пространства.  
  
## <a name="how-to-check-disk-space-usage"></a>Как проверить использование места на диске  
 PowerPivot для SharePoint устанавливается на сервере приложений в ферме SharePoint. Каждая установка имеет каталог данных, включающий папку Backup. В папке Backup содержатся все файлы данных, закэшированные экземпляром служб Analysis Services на компьютере. По умолчанию папка Backup находится по следующему пути:  
  
 `%drive%:\Program Files\Microsoft SQL Server\MSAS10_50.PowerPivot\OLAP\Backup\Sandboxes\<serviceApplicationName>`  
  
 Чтобы проверить, какой объем общего места на диске занимает кэш, необходимо проверить размер папки Backup. В центре администрирования нет свойства, которое указывает текущий размер кэша.  
  
 В папке Backup находится общее хранилище кэша для любой базы данных PowerPivot, загруженной в память на локальном компьютере. Если на ферме определены несколько приложений службы PowerPivot, то любое из них может использовать локальный сервер для загрузки и последующего кэширования данных PowerPivot. Как загрузка данных, так и их кэширование являются серверными операциями служб Analysis Services. В силу этого использование дискового пространства управляется на уровне экземпляра служб Analysis Services с учетом папки Backup. Параметры конфигурации, ограничивающие использование дискового пространства, таким образом, задаются на одном экземпляре служб Analysis Services SQL Server, который запущен на сервере приложений SharePoint.  
  
 В кэше содержатся только данные PowerPivot. Базы данных PowerPivot хранятся в нескольких файлах, находящихся в одной родительской папке Backup. Базы данных PowerPivot предназначены для использования в книге Excel в качестве внутренних данных, поэтому имеют имена на основе идентификаторов GUID, а не описательные имена. Папка GUID в разделе **\<serviceApplicationName>** является родительской папкой базы данных PowerPivot. По мере загрузки баз данных PowerPivot на сервер для каждой из них создаются дополнительные папки.  
  
 Поскольку данные PowerPivot могут быть загружены на любой экземпляр служб Analysis Services в ферме, одни и те же данные могут одновременно быть кэшированы на нескольких компьютерах в ферме. Такой подход позволяет повысить производительность за счет использования места на диске, в результате пользователи получают более быстрый доступ к данным, уже имеющимся на диске.  
  
 Чтобы немедленно уменьшить объем занятого места на диске, можно отключить службу, а затем удалить базы данных PowerPivot из папки Backup. Удаление файлов вручную является временной мерой, поскольку более новая копия базы данных будет снова помещена в кэш при следующем запросе данных PowerPivot. Постоянное решение предполагает ограничение использования дискового пространства кэшем.  
  
 На уровне системы можно создать оповещения по электронной почте, сообщающие о нехватке места на диске. Microsoft System Center имеет функцию отправки уведомлений по электронной почте. Для настройки уведомлений также можно использовать диспетчер ресурсов сервера файлов, планировщик заданий или скрипт PowerShell. Следующие ссылки предоставляют полезные сведения о настройке уведомлений о недостатке места на диске:  
  
-   [Новые возможности файлового сервера диспетчер ресурсов](https://technet.microsoft.com/library/hh831746.aspx) ( https://technet.microsoft.com/library/hh831746.aspx) .  
  
-   [Файловый сервер диспетчер ресурсов пошаговые инструкции для Windows Server 2008 R2](https://go.microsoft.com/fwlink/?LinkID=204875) ( https://go.microsoft.com/fwlink/?LinkID=204875) .  
  
-   [Установка предупреждений о нехватке места на диске в Windows Server 2008](https://go.microsoft.com/fwlink/?LinkID=204870) ( https://go.microsoft.com/fwlink/?LinkID=204870) .  
  
## <a name="how-to-limit-the-amount-of-disk-space-used-for-storing-cached-files"></a>Ограничение объема места на диске, используемого для хранения кэшированных файлов  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление службами на сервере**.  
  
2.  Нажмите **Службы SQL Server Analysis Services**.  
  
     Обратите внимание, что ограничения задаются для экземпляра служб Analysis Services, который выполняется на физическом сервере, а не на уровне приложения службы. Единственный предел максимального объема места на диске, заданный для экземпляра служб Analysis Services, распространяется на все приложения службы, использующие этот локальный экземпляр.  
  
3.  В разделе "Использование диска" задайте значение (в гигабайтах) для параметра **Общее дисковое пространство** , чтобы указать верхний предел объема дискового пространства, используемого для кэширования. 0 — значение по умолчанию, которое позволяет службам Analysis Services использовать все свободное место на диске.  
  
4.  В поле использование диска в параметре **Удалять кэшированные базы данных за последние n часов** укажите критерии последнего использования для очистки кэша, если место на диске превышает максимально допустимое значение.  
  
     Значение по умолчанию — 4 часа, т. е. все базы данных, которые были неактивными в течение последних 4 часов и более, удаляются из файловой системы. Базы данных, которые являются неактивными, но все еще находятся в памяти, выгружаются, а затем удаляются из файловой системы.  
  
## <a name="how-to-limit-how-long-a-database-is-kept-in-the-cache"></a>Ограничение времени хранения базы данных в кэше  
  
1.  В центре администрирования в окне "Управление приложениями" выберите **Управление приложения службы**.  
  
2.  Щелкните **приложение службы PowerPivot по умолчанию** , чтобы открыть панель мониторинга управления.  
  
3.  В меню действия выберите пункт **настроить параметры приложения службы**.  
  
4.  В разделе «Кэш на диске» можно указать время хранения неактивной базы данных в памяти для обслуживания новых запросов (по умолчанию 48 часов), а также время ее хранения в кэше (по умолчанию 120 часов).  
  
     Параметр**Хранить неактивную базу данных в памяти** указывает время хранения неактивной базы данных в памяти для обслуживания новых запросов к этим данным. Активная база данных всегда остается в памяти, пока к ней поступают запросы, но после того, как она перестает быть активной, система будет хранить эту базу данных в памяти в течение определенного периода времени на случай поступления новых запросов к этим данным.  
  
     Поскольку базы данных PowerPivot сначала кэшируются, а затем загружаются в память, файлы базы данных занимают место на диске немедленно. Тем не менее, пока база данных активна (и в течение 48 часов после этого), все запросы направляются сначала к базе данных, находящейся в памяти, при этом кэшированная база данных игнорируется. После того как база данных была неактивна в течение 48 часов, ее файл выгружается из памяти, но остается в кэше, откуда его можно быстро загрузить в память в случае поступления в локальный экземпляр сервера PowerPivot нового запроса на соединение с этими данными. Запросы на соединение с неактивными базами данных обслуживаются из кэша, а не из библиотеки содержимого, что сводит влияние на базы данных содержимого к минимуму.  
  
     Важно отметить, что библиотека содержимого является единственным постоянным местом расположения баз данных PowerPivot. Кэшированные копии используются только в том случае, если в библиотеке находится такая же база данных, как и копия на диске.  
  
     Параметр**Хранить неактивную базу данных в кэше** указывает время хранения неактивной базы данных в файловой системе после ее выгрузки из памяти. С помощью этого параметра задание очистки определяет, какие файлы подлежат удалению. Все базы данных PowerPivot, остающиеся неактивными в течение 168 часов (48 часов в памяти и 120 часов в кэше), удаляются с диска заданием очистки.  
  
5.  Нажмите кнопку **ОК** , чтобы сохранить внесенные изменения.  
  
## <a name="next-steps"></a>Next Steps  
 Установка PowerPivot для SharePoint предусматривает определение правил исправности, позволяющих выполнять действия по исправлению при обнаружении проблем с исправностью сервера, конфигурацией или доступностью. Некоторые из этих правил определяют условия срабатывания правила с помощью параметров конфигурации. Если настройка производительности сервера выполняется своевременно, можно также обратиться к этим параметрам, чтобы удостовериться, что значения по умолчанию наилучшим образом подходят для данной системы. Дополнительные сведения см. в разделе [правила определения исправности PowerPivot — Настройка](configure-power-pivot-health-rules.md).  
  
## <a name="see-also"></a>См. также:  
 [Настройка и администрирование сервера PowerPivot в центре администрирования](power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
