---
title: Доступ к данным PowerPivot | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 83dc82da-91fb-4e47-91a8-0e0db67339b8
author: minewiskan
ms.author: owend
ms.openlocfilehash: 8faeec7b2e12871467b93f136360e9a68a0e5acb
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87667415"
---
# <a name="powerpivot-data-access"></a><span data-ttu-id="badf6-102">Доступ к данным PowerPivot</span><span class="sxs-lookup"><span data-stu-id="badf6-102">PowerPivot Data Access</span></span>
  <span data-ttu-id="badf6-103">Данный раздел описывает способы, с помощью которых данные извлекаются из книги PowerPivot, опубликованной в библиотеке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="badf6-103">This topic describes the ways in which data is retrieved from a PowerPivot workbook that is published to a SharePoint library.</span></span>  
  
 <span data-ttu-id="badf6-104">Данные PowerPivot хранятся в книге Excel.</span><span class="sxs-lookup"><span data-stu-id="badf6-104">PowerPivot data is stored inside an Excel workbook.</span></span> <span data-ttu-id="badf6-105">Строка подключения — это URL-адрес книги на сайте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="badf6-105">The connection string is a URL to a workbook on a SharePoint site.</span></span>  
  
 <span data-ttu-id="badf6-106">Данные PowerPivot чаще всего используются книгой, в которой они содержатся, в качестве данных сводных таблиц и диаграмм.</span><span class="sxs-lookup"><span data-stu-id="badf6-106">PowerPivot data is most often used by the workbook that contains it, as the data behind PivotTables and PivotCharts.</span></span> <span data-ttu-id="badf6-107">Также данные PowerPivot могут быть использованы в качестве внешнего источника данных, когда книга, панель или отчет подключается к отдельному XLSX-файлу Excel на SharePoint и получает данные для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="badf6-107">Alternatively, PowerPivot data can also be used as an external data source, where a workbook, dashboard, or report connects to a separate Excel (.xlsx) file in SharePoint and retrieves the data for subsequent use.</span></span> <span data-ttu-id="badf6-108">Клиентские средства, которые обычно используют данные PowerPivot, — это Excel, [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)], другие отчеты служб Reporting Services и PerformancePoint.</span><span class="sxs-lookup"><span data-stu-id="badf6-108">Client tools that typically use PowerPivot data are Excel, [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)], other Reporting Services reports, and PerformancePoint.</span></span>  
  
 <span data-ttu-id="badf6-109">На рабочем столе надстройка PowerPivot использует объекты AMO и ADOMD.NET для создания, обработки и отправки запросов данных PowerPivot в клиентской рабочей области.</span><span class="sxs-lookup"><span data-stu-id="badf6-109">On the desktop, the PowerPivot add-in uses AMO and ADOMD.NET to create, process, and query the PowerPivot data in the client workspace.</span></span>  
  
 <span data-ttu-id="badf6-110">На ферме SharePoint службы Excel используют локальный поставщик MSOLAP OLE DB для подключения к данным PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="badf6-110">On a SharePoint farm, Excel Services uses the local MSOLAP OLE DB provider to connect to PowerPivot data.</span></span> <span data-ttu-id="badf6-111">Поставщик отправляет запрос соединения к PowerPivot для SharePoint на ферме.</span><span class="sxs-lookup"><span data-stu-id="badf6-111">The provider sends the connection request to a PowerPivot for SharePoint server in the farm.</span></span> <span data-ttu-id="badf6-112">Сервер загружает данные, выполняет запрос и возвращает результирующий набор.</span><span class="sxs-lookup"><span data-stu-id="badf6-112">That server loads the data, runs the query, and returns the result set.</span></span>  
  
##  <a name="querying-powerpivot-data-in-sharepoint"></a><a name="queryproc"></a><span data-ttu-id="badf6-113">Запросы к данным PowerPivot в SharePoint</span><span class="sxs-lookup"><span data-stu-id="badf6-113">Querying PowerPivot Data in SharePoint</span></span>  
 <span data-ttu-id="badf6-114">При просмотре книги PowerPivot из библиотеки SharePoint данные PowerPivot, содержащиеся в книге, обнаруживаются, извлекаются и обрабатываются отдельными экземплярами сервера служб Analysis Services в ферме, пока службы Excel подготавливают слой представления.</span><span class="sxs-lookup"><span data-stu-id="badf6-114">When you view a PowerPivot workbook from a SharePoint library, the PowerPivot data that is inside the workbook is detected, extracted, and processed separately on Analysis Services server instances within the farm, while Excel Services renders the presentation layer.</span></span> <span data-ttu-id="badf6-115">Полностью обработанную книгу можно просмотреть в окне браузера или в приложении для настольных компьютеров Excel 2010, имеющем надстройку PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="badf6-115">You can view the fully-processed workbook in a browser window or in an Excel 2010 desktop application that has the PowerPivot add-in.</span></span>  
  
 <span data-ttu-id="badf6-116">Следующая диаграмма иллюстрирует путь обработки запроса в ферме.</span><span class="sxs-lookup"><span data-stu-id="badf6-116">The following diagram shows how a request for query processing moves through the farm.</span></span> <span data-ttu-id="badf6-117">Поскольку данные PowerPivot входят в состав книги Excel 2010, обработка запроса осуществляется при открытии книги Excel из библиотеки SharePoint и обращении к компонентам PivotTable или PivotChart, содержащим данные PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="badf6-117">Because PowerPivot data is part of an Excel 2010 workbook, a request for query processing occurs when a user opens an Excel workbook from a SharePoint library and interacts with a PivotTable or PivotChart that contains PowerPivot data.</span></span>  
  
 <span data-ttu-id="badf6-118">![GMNI_DataProcReq](../media/gmni-dataprocreq.gif "GMNI_DataProcReq")</span><span class="sxs-lookup"><span data-stu-id="badf6-118">![GMNI_DataProcReq](../media/gmni-dataprocreq.gif "GMNI_DataProcReq")</span></span>  
  
 <span data-ttu-id="badf6-119">Компоненты служб Excel и PowerPivot для SharePoint обрабатывают различные фрагменты одного и того же XLSX-файла книги.</span><span class="sxs-lookup"><span data-stu-id="badf6-119">Excel Services and PowerPivot for SharePoint components process different parts of the same workbook (.xlsx) file.</span></span> <span data-ttu-id="badf6-120">Службы Excel обнаруживают данные PowerPivot и запрашивают обработку на сервере PowerPivot в ферме.</span><span class="sxs-lookup"><span data-stu-id="badf6-120">Excel Services detects PowerPivot data and requests processing from a PowerPivot server in the farm.</span></span> <span data-ttu-id="badf6-121">Сервер PowerPivot выделяет запрос к экземпляру [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] , который извлекает данные из книги в библиотеке содержимого и загружает их.</span><span class="sxs-lookup"><span data-stu-id="badf6-121">The PowerPivot server allocates the request to an [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] instance, which extracts the data from the workbook in the content library and loads the data.</span></span> <span data-ttu-id="badf6-122">Данные, сохраненные в памяти, присоединяются к подготовленной книге и передаются обратно в веб-службу доступа Excel для отображения в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="badf6-122">Data that is stored in memory is merged back into the rendered workbook, and passed back to Excel Web Access for presentation in a browser window.</span></span>  
  
 <span data-ttu-id="badf6-123">Не все данные в книге PowerPivot обрабатываются компонентом PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="badf6-123">Not all data in a PowerPivot workbook is handled by PowerPivot for SharePoint.</span></span> <span data-ttu-id="badf6-124">Службы Excel обрабатывают данные таблиц и ячеек листа.</span><span class="sxs-lookup"><span data-stu-id="badf6-124">Excel Services processes tables and cell data in a worksheet.</span></span> <span data-ttu-id="badf6-125">PowerPivot для SharePoint обрабатывает только сводные таблицы, диаграммы и срезы, связанные с данными PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="badf6-125">Only PivotTables, PivotCharts, and Slicers that go against PowerPivot data are handled by the PowerPivot for SharePoint.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="badf6-126">См. также:</span><span class="sxs-lookup"><span data-stu-id="badf6-126">See Also</span></span>  
 <span data-ttu-id="badf6-127">[Подключение к Analysis Services](../instances/connect-to-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="badf6-127">[Connect to Analysis Services](../instances/connect-to-analysis-services.md) </span></span>  
 [<span data-ttu-id="badf6-128">Доступ к данным табличной модели</span><span class="sxs-lookup"><span data-stu-id="badf6-128">Tabular Model Data Access</span></span>](../tabular-models/tabular-model-data-access.md)  
  
  
