---
title: Создание и настройка приложения службы PowerPivot в центре администрирования | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b2e5693e-4af3-453f-83f3-07481ab1ac6a
author: minewiskan
ms.author: owend
ms.openlocfilehash: 8becac1ecce25b6798dc727a00a3f5b0afed572c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729910"
---
# <a name="create-and-configure-a-powerpivot-service-application-in-central-administration"></a><span data-ttu-id="6857e-102">Создание и настройка приложения службы PowerPivot в центре администрирования</span><span class="sxs-lookup"><span data-stu-id="6857e-102">Create and Configure a PowerPivot Service Application in Central Administration</span></span>
  <span data-ttu-id="6857e-103">Приложение службы PowerPivot — это экземпляр общей службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-103">A PowerPivot service application is a shared service instance of the PowerPivot System Service.</span></span> <span data-ttu-id="6857e-104">Каждое приложение службы имеет свое удостоверение, параметры настройки, свойства и внутреннее хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="6857e-104">Each service application has its own application identity, configuration settings, properties, and internal data storage.</span></span>  
  
 <span data-ttu-id="6857e-105">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="6857e-105">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="6857e-106">Определение необходимости создания нового приложения службы PowerPivot</span><span class="sxs-lookup"><span data-stu-id="6857e-106">Determine whether to create a new PowerPivot Service Application</span></span>](#determine)  
  
 [<span data-ttu-id="6857e-107">Создание приложения службы PowerPivot</span><span class="sxs-lookup"><span data-stu-id="6857e-107">Create a PowerPivot Service Application</span></span>](#CreateApp)  
  
 [<span data-ttu-id="6857e-108">Настройка приложения службы PowerPivot</span><span class="sxs-lookup"><span data-stu-id="6857e-108">Configure the PowerPivot Service Application</span></span>](#ConfigApp)  
  
 [<span data-ttu-id="6857e-109">Назначение приложения службы PowerPivot веб-приложению</span><span class="sxs-lookup"><span data-stu-id="6857e-109">Assign a PowerPivot Service Application to a Web Application</span></span>](#AssignGSA)  
  
 [<span data-ttu-id="6857e-110">Изменение свойств приложения службы</span><span class="sxs-lookup"><span data-stu-id="6857e-110">Edit Service Application Properties</span></span>](#EditGSA)  
  
##  <a name="determine-whether-to-create-a-new-powerpivot-service-application"></a><a name="determine"></a><span data-ttu-id="6857e-111">Определение необходимости создания нового приложения службы PowerPivot</span><span class="sxs-lookup"><span data-stu-id="6857e-111">Determine whether to create a new PowerPivot Service Application</span></span>  
 <span data-ttu-id="6857e-112">Для установки PowerPivot для SharePoint на ферме должно быть как минимум одно приложение службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-112">A PowerPivot for SharePoint installation must have at least one PowerPivot service application in the farm.</span></span> <span data-ttu-id="6857e-113">Приложение службы создается автоматически, если при настройке сервера использовалось средство настройки PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-113">A service application is created automatically if you used the PowerPivot Configuration Tool to configure the server.</span></span> <span data-ttu-id="6857e-114">Иначе необходимо создать приложение службы PowerPivot вручную в центре администрирования.</span><span class="sxs-lookup"><span data-stu-id="6857e-114">Otherwise, you must create a PowerPivot service application manually in Central Administration.</span></span>  
  
 <span data-ttu-id="6857e-115">Создание приложения службы открывает доступ к службе и формирует базу данных приложения службы.</span><span class="sxs-lookup"><span data-stu-id="6857e-115">Creating a service application makes the service available and generates the service application database.</span></span> <span data-ttu-id="6857e-116">В зависимости от параметров, выбранных при создании приложения службы, соединение со службой PowerPivot добавляется в группу соединений служб по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6857e-116">Depending on options you select when creating the service application, a PowerPivot service connection is added to the default service connection group.</span></span> <span data-ttu-id="6857e-117">Все веб-приложения SharePoint, которые подписаны на группу соединений служб по умолчанию, автоматически получают немедленный доступ к приложению службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-117">All SharePoint Web applications that subscribe to the default service connection group will get immediate access to the PowerPivot service application automatically.</span></span>  
  
 <span data-ttu-id="6857e-118">Может быть создано несколько приложений службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-118">You can create multiple PowerPivot service applications.</span></span> <span data-ttu-id="6857e-119">Хотя одного приложения службы достаточно для большинства сценариев развертывания, может оказаться целесообразным создание дополнительного приложения службы PowerPivot при наличии следующих бизнес-требований.</span><span class="sxs-lookup"><span data-stu-id="6857e-119">Although one service application is sufficient for most deployment scenarios, you might consider creating an additional PowerPivot service application if your business requirements include the following:</span></span>  
  
-   <span data-ttu-id="6857e-120">Использование разных учетных записей автоматического обновления данных PowerPivot для каждого из приложений.</span><span class="sxs-lookup"><span data-stu-id="6857e-120">Using a different unattended PowerPivot data refresh account for each application.</span></span>  
  
-   <span data-ttu-id="6857e-121">Использование разных значений времени ожидания, журналов использования и пороговых значений для отчетов об ответах на запросы.</span><span class="sxs-lookup"><span data-stu-id="6857e-121">Using different timeouts, usage history, and thresholds for query response reporting.</span></span>  
  
-   <span data-ttu-id="6857e-122">Делегирование прав администрирования службы другому пользователю.</span><span class="sxs-lookup"><span data-stu-id="6857e-122">Delegating service administration to different people.</span></span> <span data-ttu-id="6857e-123">Администратор получает доступ к журналу обновления данных, журналу использования и другим свойствам только того приложения, которое администрирует.</span><span class="sxs-lookup"><span data-stu-id="6857e-123">An administrator will see data refresh history, usage data, and other properties only for the application he or she is administering.</span></span> <span data-ttu-id="6857e-124">Если необходимо изолировать данные для разных веб-приложений SharePoint (например, для компаний, которые предлагают услуги размещения с гарантией изоляции данных для веб-приложений SharePoint разных клиентов), то для удовлетворения требований по изоляции можно создать отдельные приложения службы PowerPivot и предоставить каждому администратору в отдельности доступ только к параметрам конфигурации и свойствам того приложения, которым он управляет.</span><span class="sxs-lookup"><span data-stu-id="6857e-124">If you are required to isolate SharePoint web applications (for example, if your company is a hosting service that must guarantee data isolation for the SharePoint Web applications that belong to different customers), creating separate PowerPivot service applications can help meet isolation requirements by ensuring each service administrator sees only the configuration settings and properties for the application he or she manages.</span></span>  
  
 <span data-ttu-id="6857e-125">При создании дополнительных приложений службы возникают новые требования по ассоциациям управления службами.</span><span class="sxs-lookup"><span data-stu-id="6857e-125">Creating additional service application introduces new requirements for managing service associations.</span></span> <span data-ttu-id="6857e-126">А именно, потребуется создание и использование пользовательского списка ассоциаций служб для каждого дополнительного приложения службы.</span><span class="sxs-lookup"><span data-stu-id="6857e-126">Namely, it will require that you create and use custom service association lists for each additional service application that you create.</span></span>  
  
 <span data-ttu-id="6857e-127">Если никаких особых причин для создания нового приложения службы PowerPivot нет, то лучше пользоваться одним приложением службы для всех веб-приложений фермы.</span><span class="sxs-lookup"><span data-stu-id="6857e-127">If you do not have a specific reason for creating additional PowerPivot service application, you should use a single service application for all of the Web applications in the farm.</span></span>  
  
##  <a name="create-a-powerpivot-service-application"></a><a name="CreateApp"></a><span data-ttu-id="6857e-128">Создание приложения службы PowerPivot</span><span class="sxs-lookup"><span data-stu-id="6857e-128">Create a PowerPivot Service Application</span></span>  
  
1.  <span data-ttu-id="6857e-129">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="6857e-129">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="6857e-130">В ленте **Приложение службы** нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="6857e-130">In the **Service Applications** ribbon, click **New**.</span></span>  
  
3.  <span data-ttu-id="6857e-131">Выберите **SQL Server приложение службы PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="6857e-131">Select **SQL Server PowerPivot Service Application**.</span></span> <span data-ttu-id="6857e-132">Если этого пункта нет в списке, это означает, что PowerPivot для SharePoint не установлен или установлен неправильно.</span><span class="sxs-lookup"><span data-stu-id="6857e-132">If it does not appear in the list, PowerPivot for SharePoint is not installed or configured correctly.</span></span>  
  
4.  <span data-ttu-id="6857e-133">На странице **Создание нового приложения службы PowerPivot** введите имя приложения.</span><span class="sxs-lookup"><span data-stu-id="6857e-133">In the **Create New PowerPivot Service Application** page, enter a name for the application.</span></span> <span data-ttu-id="6857e-134">Значение по умолчанию — PowerPivotServiceApplication \<number> .</span><span class="sxs-lookup"><span data-stu-id="6857e-134">The default is PowerPivotServiceApplication\<number>.</span></span> <span data-ttu-id="6857e-135">При создании нескольких приложений службы PowerPivot описательное имя поможет другим администраторам понять, как используется это приложение.</span><span class="sxs-lookup"><span data-stu-id="6857e-135">If you are creating multiple PowerPivot service applications, a descriptive name will help other administrators understand how the application is used.</span></span>  
  
5.  <span data-ttu-id="6857e-136">В разделе «Пул приложений» создайте для данного приложения новый пул (рекомендуется).</span><span class="sxs-lookup"><span data-stu-id="6857e-136">In Application Pool, create a new application pool for the application (recommended).</span></span> <span data-ttu-id="6857e-137">Выберите или создайте управляемую учетную запись для пула приложений.</span><span class="sxs-lookup"><span data-stu-id="6857e-137">Select or create a managed account for the application pool.</span></span> <span data-ttu-id="6857e-138">Обязательно укажите учетную запись домена.</span><span class="sxs-lookup"><span data-stu-id="6857e-138">Be sure to specify a domain user account.</span></span> <span data-ttu-id="6857e-139">Учетная запись пользователя домена позволяет использовать функцию управляемой учетной записи SharePoint, с помощью которой пароли и данные учетной записи можно изменять в одном месте.</span><span class="sxs-lookup"><span data-stu-id="6857e-139">A domain user account enables the use of SharePoint's managed account feature, which lets you update passwords and account information in one place.</span></span> <span data-ttu-id="6857e-140">Учетные записи домена также требуются, если планируется расширение развернутой системы и включение дополнительных экземпляров службы, которые будут работать под одним идентификатором.</span><span class="sxs-lookup"><span data-stu-id="6857e-140">Domain accounts are also required if you plan to scale out the deployment to include additional service instances that will run under the same identity.</span></span>  
  
6.  <span data-ttu-id="6857e-141">В поле **Сервер базы данных**значением по умолчанию является экземпляр компонента SQL Server Database Engine, на котором размещены базы данных конфигурации фермы.</span><span class="sxs-lookup"><span data-stu-id="6857e-141">In **Database Server**, the default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span> <span data-ttu-id="6857e-142">Можно использовать этот сервер либо выбрать другой SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6857e-142">You can use this server or choose a different SQL Server.</span></span>  
  
7.  <span data-ttu-id="6857e-143">В поле **имя базы данных**значение по умолчанию — PowerPivotServiceApplication1_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="6857e-143">In **Database Name**, the default value is PowerPivotServiceApplication1_\<guid>.</span></span> <span data-ttu-id="6857e-144">Необходимо создать уникальную базу данных для каждого приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-144">You must create a unique database for each PowerPivot service application.</span></span> <span data-ttu-id="6857e-145">Имя базы данных по умолчанию соответствует используемому по умолчанию имени приложения службы.</span><span class="sxs-lookup"><span data-stu-id="6857e-145">The default database name corresponds to the default name of the service application.</span></span> <span data-ttu-id="6857e-146">Если было введено уникальное имя приложения службы, следуйте аналогичным соглашениях об именах при выборе имени базы данных, чтобы ими можно было управлять совместно.</span><span class="sxs-lookup"><span data-stu-id="6857e-146">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>  
  
8.  <span data-ttu-id="6857e-147">В списке **Проверка подлинности базы данных**по умолчанию выбрано значение «Проверка подлинности Windows».</span><span class="sxs-lookup"><span data-stu-id="6857e-147">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="6857e-148">Если выбран параметр **Проверка подлинности SQL**, то рекомендации по использованию этого типа проверки подлинности в развернутой системе SharePoint см. в руководстве администратора SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6857e-148">If you choose **SQL Authentication**, refer to the SharePoint administrator guide for best practices on how to use this authentication type in a SharePoint deployment.</span></span>  
  
9. <span data-ttu-id="6857e-149">При необходимости установите флажок **Добавить прокси-сервер для этого приложения службы PowerPivot в группу прокси-серверов по умолчанию для фермы.**</span><span class="sxs-lookup"><span data-stu-id="6857e-149">Optionally, select the checkbox for **Add the proxy for this PowerPivot Service Application to the farm's default proxy group.**</span></span> <span data-ttu-id="6857e-150">. При этом соединение с приложением службы будет добавлено в список группы соединений служб по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6857e-150">This adds the service application connection to the default service connection group.</span></span>  
  
     <span data-ttu-id="6857e-151">Этот флажок должен быть выбран при создании первого приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-151">You must select this checkbox if you are creating your first PowerPivot service application.</span></span> <span data-ttu-id="6857e-152">Наличие приложения службы PowerPivot в группе соединений по умолчанию необходимо для правильной работы панели управления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-152">There must be one PowerPivot service application in the default connection group in order for PowerPivot Management Dashboard to work properly.</span></span>  
  
     <span data-ttu-id="6857e-153">Если группа соединений по умолчанию уже существует, то добавление в нее вновь создаваемых приложений службы PowerPivot не требуется.</span><span class="sxs-lookup"><span data-stu-id="6857e-153">Do not add the PowerPivot service application to the default connection group if one already exists.</span></span> <span data-ttu-id="6857e-154">Добавление нескольких записей приложений службы одного типа не поддерживается, это может привести к возникновению ошибок.</span><span class="sxs-lookup"><span data-stu-id="6857e-154">Adding multiple entries of the same service application type is not a supported configuration and might cause errors.</span></span> <span data-ttu-id="6857e-155">При создании дополнительных приложений службы не вносите их в группу соединений по умолчанию, вместо этого добавьте в пользовательские списки.</span><span class="sxs-lookup"><span data-stu-id="6857e-155">If you are creating additional service applications, leave them out of the default connection group and add them to custom lists instead.</span></span>  
  
     <span data-ttu-id="6857e-156">Дополнительные сведения о взаимосвязи служб см. [в разделе Подключение приложения службы PowerPivot к веб-приложению SharePoint в центре администрирования](connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md).</span><span class="sxs-lookup"><span data-stu-id="6857e-156">For more information about service associations, see [Connect a PowerPivot Service Application to a SharePoint Web Application in Central Administration](connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md).</span></span>  
  
10. <span data-ttu-id="6857e-157">Нажмите кнопку **ОК.**</span><span class="sxs-lookup"><span data-stu-id="6857e-157">Click **OK.**</span></span> <span data-ttu-id="6857e-158">Эта служба появится в списке приложений служб фермы рядом с другими управляемыми службами.</span><span class="sxs-lookup"><span data-stu-id="6857e-158">The service will appear alongside other managed services in the farm's service application list.</span></span>  
  
##  <a name="configure-powerpivot-service-application"></a><a name="ConfigApp"></a><span data-ttu-id="6857e-159">Настройка приложения службы PowerPivot</span><span class="sxs-lookup"><span data-stu-id="6857e-159">Configure PowerPivot Service Application</span></span>  
 <span data-ttu-id="6857e-160">Приложение службы PowerPivot создается с использованием конфигурации по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6857e-160">A PowerPivot service application is created using a default configuration.</span></span> <span data-ttu-id="6857e-161">В большинстве случаев рекомендуется использовать параметры по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="6857e-161">The default settings are recommended for most scenarios.</span></span> <span data-ttu-id="6857e-162">Изменять их следует только в том случае, если соединения обрываются или время ответа слишком велико, либо если для разных веб-приложений SharePoint используются различные параметры службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-162">Change them only if you encounter slow response time or dropped connections, or if you are varying PowerPivot service configuration for specific SharePoint Web applications.</span></span>  
  
1.  <span data-ttu-id="6857e-163">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="6857e-163">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
     <span data-ttu-id="6857e-164">В списке приложений служб должно отображаться только что созданное приложение службы.</span><span class="sxs-lookup"><span data-stu-id="6857e-164">In the list of service applications, you should see the service application you just created and named.</span></span> <span data-ttu-id="6857e-165">Приложение по умолчанию — **PowerPivotServiceApplication1**.</span><span class="sxs-lookup"><span data-stu-id="6857e-165">The default is **PowerPivotServiceApplication1**.</span></span>  
  
2.  <span data-ttu-id="6857e-166">Щелкните приложение службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-166">Click the PowerPivot service application.</span></span> <span data-ttu-id="6857e-167">Откроется панель управления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-167">This opens the PowerPivot Management Dashboard.</span></span>  
  
3.  <span data-ttu-id="6857e-168">В списке **Действия** (в правом верхнем углу панели мониторинга) выберите **Настройка параметров приложения службы**.</span><span class="sxs-lookup"><span data-stu-id="6857e-168">In the **Actions** list on the top right corner of the dashboard, click **Configure service application settings**.</span></span>  
  
4.  <span data-ttu-id="6857e-169">В поле **время ожидания загрузки базы данных**увеличьте или уменьшите значение, чтобы изменить время ожидания службой PowerPivot ответа от экземпляра SQL Server Analysis Services (PowerPivot), которому перенаправляется запрос на загрузку данных.</span><span class="sxs-lookup"><span data-stu-id="6857e-169">In **Database Load Timeout**, increase or decrease the value to change how long the PowerPivot service waits for a response from the SQL Server Analysis Services (PowerPivot) instance to which it forwarded a load data request.</span></span> <span data-ttu-id="6857e-170">Поскольку очень большие наборы данных требуют большого времени для передачи по каналу, должно быть установлено время, достаточное для того, чтобы экземпляр службы Powerpivot извлек книгу Excel и передал данные PowerPivot экземпляру службы Analysis Services для обработки запроса.</span><span class="sxs-lookup"><span data-stu-id="6857e-170">Because very large datasets take time to move over the wire, you must allow sufficient time for the PowerPivot service instance to retrieve the Excel workbook and move the PowerPivot data to an Analysis Services instance for query processing.</span></span> <span data-ttu-id="6857e-171">Поскольку PowerPivot работает с особенно большими наборами данных, значение по умолчанию равно 30 минутам.</span><span class="sxs-lookup"><span data-stu-id="6857e-171">Because PowerPivot data can be unusually large, the default value is 30 minutes.</span></span>  
  
5.  <span data-ttu-id="6857e-172">Измените значение в поле **Время ожидания соединения**, указав время, в течение которого неактивное подключение к данным будет оставаться открытым.</span><span class="sxs-lookup"><span data-stu-id="6857e-172">In **Connection Pool Timeout**, increase or decrease the value to change how many minutes an idle data connection will remain open.</span></span> <span data-ttu-id="6857e-173">Значение по умолчанию составляет 30 минут.</span><span class="sxs-lookup"><span data-stu-id="6857e-173">The default value is 30 minutes.</span></span> <span data-ttu-id="6857e-174">В течение этого времени служба PowerPivot будет использовать неактивное подключение к данным только для запросов на чтение от одного и того же пользователя SharePoint к одним и тем же данным PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-174">During this period, the PowerPivot service will reuse an idle data connection for read-only requests from the same SharePoint user for the same PowerPivot data.</span></span> <span data-ttu-id="6857e-175">При отсутствии других запросов к данным за указанный период соединение удаляется из пула.</span><span class="sxs-lookup"><span data-stu-id="6857e-175">If no further requests are received for that data during the period specified, the connection is removed from the pool.</span></span> <span data-ttu-id="6857e-176">Допустимые значения: от 1 до 3600 секунд.</span><span class="sxs-lookup"><span data-stu-id="6857e-176">Valid values are 1 to 3600 seconds.</span></span> <span data-ttu-id="6857e-177">Дополнительные сведения о пулах соединений см. в разделе [Справочник по параметрам конфигурации &#40;PowerPivot для SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="6857e-177">For more information about connection pools, see [Configuration Setting Reference &#40;PowerPivot for SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md).</span></span>  
  
6.  <span data-ttu-id="6857e-178">В поле **максимальный размер пула пользовательских соединений**увеличьте или уменьшите значение, чтобы изменить максимальное число неактивных соединений, создаваемых службой PowerPivot в отдельных пулах соединений для каждого сочетания пользователя SharePoint, набора данных PowerPivot и версии.</span><span class="sxs-lookup"><span data-stu-id="6857e-178">In **Maximum User Connection Pool Size**, increase or decrease the value to change the maximum number of idle connections the PowerPivot service will create in individual connection pools for each SharePoint user, PowerPivot dataset, and version combinations.</span></span>  
  
     <span data-ttu-id="6857e-179">Значением по умолчанию является 1000 неактивных соединений.</span><span class="sxs-lookup"><span data-stu-id="6857e-179">The default value is 1000 idle connections.</span></span> <span data-ttu-id="6857e-180">Допустимыми значениями являются -1 (не ограничено), 0 (отключает использование пулов соединений пользователя) или от 1 до 10000.</span><span class="sxs-lookup"><span data-stu-id="6857e-180">Valid values are -1 (unlimited), 0 (disables user connection pooling), or 1 to 10000.</span></span>  
  
     <span data-ttu-id="6857e-181">Эти пулы соединений позволяют службе более эффективно поддерживать текущие соединения к одним и тем же данным только для чтения для одного и того же пользователя.</span><span class="sxs-lookup"><span data-stu-id="6857e-181">These connection pools enable the service to more efficiently support ongoing connections to the same read-only data by the same user.</span></span> <span data-ttu-id="6857e-182">Если использование пулов соединений отключено, то каждое соединение будет создаваться заново.</span><span class="sxs-lookup"><span data-stu-id="6857e-182">If you disable connection pooling, every connection will be created anew.</span></span>  
  
     <span data-ttu-id="6857e-183">Имейте в виду, что изменение ограничения на размер пула соединений, в том числе установка значения 0, не влияет на потерянные соединения.</span><span class="sxs-lookup"><span data-stu-id="6857e-183">Note that changing the limit on connection pool size, including setting it to 0, will not result in dropped connections.</span></span> <span data-ttu-id="6857e-184">Пулы соединений используются для сокращения времени ожидания при подключении к данным.</span><span class="sxs-lookup"><span data-stu-id="6857e-184">Connection pools exist to reduce wait times when connecting to data.</span></span> <span data-ttu-id="6857e-185">Служба PowerPivot никогда не запрещает создание соединений из-за параметров пула соединений.</span><span class="sxs-lookup"><span data-stu-id="6857e-185">The PowerPivot service will never deny a connection based on connection pool settings.</span></span>  
  
7.  <span data-ttu-id="6857e-186">В поле **максимальный размер пула административных соединений**увеличьте или уменьшите значение, чтобы изменить число открытых соединений в пуле соединений, созданном для подключения службы PowerPivot к Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6857e-186">In **Maximum Administrative Connection Pool Size**, increase or decrease the value to change the number of open connections in a connection pool created for a PowerPivot service connection to Analysis Services.</span></span> <span data-ttu-id="6857e-187">Каждый экземпляр службы PowerPivot открывает отдельное административное соединение с экземпляром Analysis Services, находящимся на том же компьютере.</span><span class="sxs-lookup"><span data-stu-id="6857e-187">Each PowerPivot service instance opens a separate administrative connection to the Analysis Services instance on the same computer.</span></span> <span data-ttu-id="6857e-188">Служба PowerPivot создает отдельный пул для повторного использования административных соединений с целью проверки неактивных соединений и наблюдения за исправностью сервера.</span><span class="sxs-lookup"><span data-stu-id="6857e-188">PowerPivot service creates a separate pool to reuse administrative connections for the purpose of checking for idle connections and monitoring server health.</span></span> <span data-ttu-id="6857e-189">Значением по умолчанию является 200 соединений.</span><span class="sxs-lookup"><span data-stu-id="6857e-189">The default value is 200 connections.</span></span> <span data-ttu-id="6857e-190">Допустимыми значениями являются -1 (неограниченно), 0 (отключение использования пулов административных соединений) или от 1 до 10000.</span><span class="sxs-lookup"><span data-stu-id="6857e-190">Valid values are -1 (unlimited), 0 (disables administrative connection pooling), or 1 to 10000.</span></span> <span data-ttu-id="6857e-191">Если выбрано значение 0, то каждое соединение будет создаваться заново.</span><span class="sxs-lookup"><span data-stu-id="6857e-191">If you select 0, every connection will be created anew.</span></span>  
  
8.  <span data-ttu-id="6857e-192">В **методе распределения**можно указать схему балансировки нагрузки, которую системная служба PowerPivot использует для выбора конкретного приложения службы PowerPivot для балансировки нагрузки исходного запроса.</span><span class="sxs-lookup"><span data-stu-id="6857e-192">In **Allocation Method**, you can specify the load balancing schema that the PowerPivot System Service uses to select a specific PowerPivot service application for load balancing an initial request.</span></span> <span data-ttu-id="6857e-193">По умолчанию применяется режим **По исправности**, при котором запросы распределяются исходя из состояния сервера, определяемого с учетом объема доступной памяти и загрузки ЦП.</span><span class="sxs-lookup"><span data-stu-id="6857e-193">The default is **Health Based**, which allocates requests based on server state, as measured by available memory and processor utilization.</span></span> <span data-ttu-id="6857e-194">Также при необходимости можно выбрать режим **Циклический перебор** , предусматривающий распределение запросов по службам в цикле в одном и том же порядке, независимо от того, занят сервер или простаивает.</span><span class="sxs-lookup"><span data-stu-id="6857e-194">Alternatively, you can choose **Round Robin** to allocate requests to servers in the same repeating order, regardless of whether a server is busy or idle.</span></span>  
  
9. <span data-ttu-id="6857e-195">На странице «Обновление данных» в поле **Рабочие часы**можно указать диапазон часов, определяющих рабочий день.</span><span class="sxs-lookup"><span data-stu-id="6857e-195">In Data Refresh, in **Business Hours**, you can specify a range of hours that defines a business day.</span></span> <span data-ttu-id="6857e-196">Обновление данных по расписанию может быть запущено после окончания бизнес-дня для заведения данных транзакций, созданных в течение рабочих часов.</span><span class="sxs-lookup"><span data-stu-id="6857e-196">Data refresh schedules can run after the close of a business day to pick up transactional data that was generated during normal business hours.</span></span>  
  
10. <span data-ttu-id="6857e-197">В **учетной записи автоматического обновления данных PowerPivot**можно указать предопределенное служба Secure Store целевое приложение, в котором хранится предопределенная учетная запись для выполнения заданий обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-197">In **PowerPivot Unattended Data Refresh Account**, you can specify a predefined Secure Store Service target application that stores a predefined account for running PowerPivot data refresh jobs.</span></span> <span data-ttu-id="6857e-198">Следует указывать имя, а не идентификатор целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="6857e-198">Be sure to specify the target application name, and not the ID.</span></span> <span data-ttu-id="6857e-199">Целевое приложение для автоматического обновления данных создается автоматически, если при установке PowerPivot для SharePoint в программе установки SQL Server был выбран параметр «Новый сервер».</span><span class="sxs-lookup"><span data-stu-id="6857e-199">The target application for unattended data refresh is created automatically if you used the New Server option in SQL Server Setup to install PowerPivot for SharePoint.</span></span> <span data-ttu-id="6857e-200">В противном случае целевое приложение необходимо создать вручную.</span><span class="sxs-lookup"><span data-stu-id="6857e-200">Otherwise, you must create the target application manually.</span></span> <span data-ttu-id="6857e-201">Инструкции по настройке учетной записи см. в статье [Настройка учетной записи автоматического обновления данных PowerPivot &#40;PowerPivot для SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="6857e-201">For instructions on how to configure the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
11. <span data-ttu-id="6857e-202">В разделе **Разрешить пользователям вводить пользовательские учетные данные Windows**можно установить или снять флажок, указывающий, могут ли владельцы расписания вводить произвольные учетные данные Windows для запуска обновления данных по расписанию.</span><span class="sxs-lookup"><span data-stu-id="6857e-202">In **Allow users to enter custom Windows credentials**, you can select or clear the checkbox to specify whether schedule owners can enter arbitrary Windows credentials to run a data refresh schedule.</span></span> <span data-ttu-id="6857e-203">Если этот флажок установлен, то приложение службы PowerPivot создает и обслуживает целевое приложение для каждого набора этих сохраненных учетных данных.</span><span class="sxs-lookup"><span data-stu-id="6857e-203">If you select this checkbox, PowerPivot service application will create and manage a target application each set of stored credentials.</span></span> <span data-ttu-id="6857e-204">Дополнительные сведения см. в разделе [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="6857e-204">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
12. <span data-ttu-id="6857e-205">В поле **Максимальный размер журнала обработки**можно указать время, в течение которого исторические записи о процессе обновления данных будут сохраняться.</span><span class="sxs-lookup"><span data-stu-id="6857e-205">In **Maximum Processing History Length**, you can specify how long to retain a historical record of data refresh processing.</span></span> <span data-ttu-id="6857e-206">Эта информация отображается на страницах истории обновления данных, содержащихся в каждой книге с обновленными данными.</span><span class="sxs-lookup"><span data-stu-id="6857e-206">This information appears in data refresh history pages that are kept for each workbook that uses data refresh.</span></span> <span data-ttu-id="6857e-207">Также отображается на панели управления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-207">It also appears in the PowerPivot Management Dashboard.</span></span>  
  
13. <span data-ttu-id="6857e-208">На странице «Сбор данных об использовании» в поле **Интервал отчетов о запросах**задайте интервал времени для сбора статистики в отчете о запросах.</span><span class="sxs-lookup"><span data-stu-id="6857e-208">In Usage Data Collection, in **Query Reporting Interval**, specify an interval of time for reporting query statistics.</span></span> <span data-ttu-id="6857e-209">Статистика о запросах передается в виде одиночного события, позволяя свести к минимуму обмен данными между серверами.</span><span class="sxs-lookup"><span data-stu-id="6857e-209">Query statistics are reported as a single event to minimize server-to-server communication.</span></span>  
  
14. <span data-ttu-id="6857e-210">В поле «Журнал данных об использовании» укажите время, в течение которого должны храниться записи данных об использовании.</span><span class="sxs-lookup"><span data-stu-id="6857e-210">In Usage Data History, specify how long to keep a historical record of usage data.</span></span> <span data-ttu-id="6857e-211">Сведения об использовании отображаются на панели управления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-211">Usage information appears in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="6857e-212">Эффективность этих отчетов будет невелика, если для журнала данных об использовании указано слишком низкое значение.</span><span class="sxs-lookup"><span data-stu-id="6857e-212">The reports will be less effective if you specify too low a value for usage data history.</span></span>  
  
15. <span data-ttu-id="6857e-213">На странице «Сбор данных об использовании» для каждого порогового значения ответа укажите верхнее ограничение, определяющее, когда заканчивается одна категория и начинается другая.</span><span class="sxs-lookup"><span data-stu-id="6857e-213">In Usage Data Collection, in each query response threshold, specify an upper limit that determines where one category stops and another begins.</span></span> <span data-ttu-id="6857e-214">Эти категории устанавливают базовый уровень, по которому оценивается запрос.</span><span class="sxs-lookup"><span data-stu-id="6857e-214">These categories establish a baseline against which query behavior is measured.</span></span> <span data-ttu-id="6857e-215">Эти категории могут быть использованы для наблюдения за трендом продолжительности обработки запросов системой.</span><span class="sxs-lookup"><span data-stu-id="6857e-215">You can use these categories to monitor trends in query response times for your system.</span></span> <span data-ttu-id="6857e-216">Эти сведения также отображаются на панели управления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-216">This information appears in the PowerPivot Management Dashboard.</span></span>  
  
16. <span data-ttu-id="6857e-217">Нажмите кнопку **ОК** , чтобы сохранить внесенные изменения.</span><span class="sxs-lookup"><span data-stu-id="6857e-217">Click **OK** to save your changes.</span></span>  
  
     <span data-ttu-id="6857e-218">Изменения времени ожидания загрузки или метода распределения применяются только для новых входящих запросов.</span><span class="sxs-lookup"><span data-stu-id="6857e-218">Changes to the load timeout or allocation method are only applied to new incoming requests.</span></span> <span data-ttu-id="6857e-219">Для запросов, которые уже обрабатываются, применяются те значения, которые были установлены при получении запроса.</span><span class="sxs-lookup"><span data-stu-id="6857e-219">Requests that are already in progress are subject to the values that were in effect when the request was received.</span></span>  
  
##  <a name="assign-a-powerpivot-service-application-to-a-web-application"></a><a name="AssignGSA"></a><span data-ttu-id="6857e-220">Назначение приложения службы PowerPivot веб-приложению</span><span class="sxs-lookup"><span data-stu-id="6857e-220">Assign a PowerPivot Service Application to a Web Application</span></span>  
 <span data-ttu-id="6857e-221">После настройки приложения службы PowerPivot можно назначить ее веб-приложению путем добавления в список соединений приложений служб для этого веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="6857e-221">After you configure a PowerPivot service application, you can assign it to a Web application by adding it to the service application connection list for that Web application.</span></span> <span data-ttu-id="6857e-222">Это можно сделать двумя способами.</span><span class="sxs-lookup"><span data-stu-id="6857e-222">There are two ways to do this:</span></span>  
  
-   <span data-ttu-id="6857e-223">Добавьте его в группу соединения **По умолчанию** .</span><span class="sxs-lookup"><span data-stu-id="6857e-223">Add it to the **Default** connection group.</span></span> <span data-ttu-id="6857e-224">*Группа соединений по умолчанию* — это набор соединений с приложениями служб, которые доступны любому веб-приложению, ссылающемуся на них.</span><span class="sxs-lookup"><span data-stu-id="6857e-224">The *default connection group* is a collection of service application connections that are available to any Web application that references it.</span></span> <span data-ttu-id="6857e-225">В этот список необходимо добавить приложение службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-225">You must add a PowerPivot service application to this list.</span></span>  
  
-   <span data-ttu-id="6857e-226">Создайте **пользовательский** список соединений для веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="6857e-226">Create a **Custom** connection list for a specific Web application.</span></span> <span data-ttu-id="6857e-227">Если было создано несколько приложений службы PowerPivot, то для использования необходимо выбрать одно, добавив его в пользовательский список.</span><span class="sxs-lookup"><span data-stu-id="6857e-227">If you created multiple PowerPivot service applications, you can choose which one to use by selecting it in a custom list.</span></span>  
  
 <span data-ttu-id="6857e-228">Группа соединений по умолчанию может принимать более одного приложения службы одного типа.</span><span class="sxs-lookup"><span data-stu-id="6857e-228">The default connection group will accept more than one service application of the same type.</span></span> <span data-ttu-id="6857e-229">Имейте в виду, что добавление нескольких приложений службы PowerPivot в этот список не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="6857e-229">Be aware, however, that adding more than one PowerPivot service applications to this list is not a supported configuration.</span></span>  
  
1.  <span data-ttu-id="6857e-230">В разделе **Управление приложениями**центра администрирования выберите **Управление веб-приложениями**.</span><span class="sxs-lookup"><span data-stu-id="6857e-230">In Central Administration, in **Application Management**, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="6857e-231">Выберите приложение, которому должно быть назначено соединение (например, SharePoint-80).</span><span class="sxs-lookup"><span data-stu-id="6857e-231">Select the application for which you want to assign a connection (for example, SharePoint -80).</span></span>  
  
3.  <span data-ttu-id="6857e-232">Нажмите **Соединения службы**.</span><span class="sxs-lookup"><span data-stu-id="6857e-232">Click **Service Connections**.</span></span>  
  
4.  <span data-ttu-id="6857e-233">В поле **изменить следующую группу ассоциаций**выберите **значение по умолчанию** или **[пользовательский]**.</span><span class="sxs-lookup"><span data-stu-id="6857e-233">In **Edit the following group of associations**, select **default** or **[custom]**.</span></span>  
  
5.  <span data-ttu-id="6857e-234">Для **[Custom]** установите флажок рядом с каждым подключением приложения службы, которое вы хотите использовать.</span><span class="sxs-lookup"><span data-stu-id="6857e-234">For **[custom]**, select the checkbox next to each service application connection you want to use.</span></span> <span data-ttu-id="6857e-235">Если есть несколько приложений службы PowerPivot (обозначены типом `PowerPivot Service Application Proxy`), то должно быть выбрано только одно.</span><span class="sxs-lookup"><span data-stu-id="6857e-235">If you have multiple PowerPivot service applications (indicated by Type set to `PowerPivot Service Application Proxy`), be sure to choose just one.</span></span>  
  
6.  <span data-ttu-id="6857e-236">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="6857e-236">Click **OK**.</span></span>  
  
##  <a name="edit-service-application-properties"></a><a name="EditGSA"></a> <span data-ttu-id="6857e-237">Изменение свойств приложения службы</span><span class="sxs-lookup"><span data-stu-id="6857e-237">Edit Service Application Properties</span></span>  
 <span data-ttu-id="6857e-238">Повторное открытие страницы свойств, на которой указаны имя приложения службы, пул приложений, параметры базы данных и взаимосвязи служб, производится следующим образом.</span><span class="sxs-lookup"><span data-stu-id="6857e-238">Use the following instructions to re-open the property page that specifies the service application name, application pool, database settings, and service associations.</span></span>  
  
1.  <span data-ttu-id="6857e-239">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="6857e-239">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="6857e-240">Выделите, но не щелкайте ссылку на приложение службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="6857e-240">Select, but do not click, the PowerPivot service application.</span></span> <span data-ttu-id="6857e-241">Чтобы выбрать строку целиком можно щелкнуть имя типа.</span><span class="sxs-lookup"><span data-stu-id="6857e-241">You can click the type name to select the entire row.</span></span>  
  
3.  <span data-ttu-id="6857e-242">На ленте нажмите **Свойства** .</span><span class="sxs-lookup"><span data-stu-id="6857e-242">Click **Properties** on the ribbon.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6857e-243">См. также:</span><span class="sxs-lookup"><span data-stu-id="6857e-243">See Also</span></span>  
 [<span data-ttu-id="6857e-244">Настройка и администрирование сервера PowerPivot в центре администрирования</span><span class="sxs-lookup"><span data-stu-id="6857e-244">PowerPivot Server Administration and Configuration in Central Administration</span></span>](power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
