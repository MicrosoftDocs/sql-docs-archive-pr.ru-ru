---
title: Настройка учетной записи автоматического обновления данных PowerPivot (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 81401eac-c619-4fad-ad3e-599e7a6f8493
author: minewiskan
ms.author: owend
ms.openlocfilehash: d6f53d7272dc48ed55ffb175e0ace3e97263946c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656745"
---
# <a name="configure-the-powerpivot-unattended-data-refresh-account-powerpivot-for-sharepoint"></a><span data-ttu-id="34194-102">Настройка учетной записи автоматического обновления данных PowerPivot (PowerPivot для SharePoint)</span><span class="sxs-lookup"><span data-stu-id="34194-102">Configure the PowerPivot Unattended Data Refresh Account (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="34194-103">Учетная запись автоматического обновления данных PowerPivot специально предназначена для выполнения заданий по обновлению данных PowerPivot на ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="34194-103">The PowerPivot unattended data refresh account is a designated account for running PowerPivot data refresh jobs in a SharePoint farm.</span></span> <span data-ttu-id="34194-104">Настроив его, вы включаете параметр **использовать учетную запись обновления данных, настроенную администратором** на странице расписания обновления данных (см. ниже).</span><span class="sxs-lookup"><span data-stu-id="34194-104">By configuring it, you enable the **Use the data refresh account configured by the administrator** option in a data refresh schedule page (see below).</span></span> <span data-ttu-id="34194-105">Авторы книг, планирующие обновление данных, могут выбрать этот параметр, если желают использовать учетную запись автоматического обновления данных PowerPivot для выполнения задания по обновлению данных.</span><span class="sxs-lookup"><span data-stu-id="34194-105">Workbook authors who schedule data refresh can choose this option if they want to use the PowerPivot unattended data refresh account to run a data refresh job.</span></span> <span data-ttu-id="34194-106">Дополнительные сведения о просмотре параметров учетных данных в расписании обновления данных см. в разделе [планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="34194-106">For more information about how to view the Credentials options in a data refresh schedule, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
 <span data-ttu-id="34194-107">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="34194-107">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>  
  
 <span data-ttu-id="34194-108">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="34194-108">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="34194-109">В зависимости от параметров, выбранных при настройке сервера, учетная запись автоматического обновления данных может быть уже создана.</span><span class="sxs-lookup"><span data-stu-id="34194-109">Depending on which options you selected when configuring the server, the unattended data refresh account might already be created.</span></span> <span data-ttu-id="34194-110">В конфигурации по умолчанию в качестве идентификатора учетной записи автоматического обновления данных первоначально задается учетная запись фермы.</span><span class="sxs-lookup"><span data-stu-id="34194-110">In a default configuration, the identity of the unattended data refresh account is initially set to the farm account.</span></span> <span data-ttu-id="34194-111">Чтобы повысить безопасность среды, можно изменить учетную запись для выполнения от имени другого пользователя.</span><span class="sxs-lookup"><span data-stu-id="34194-111">You can improve the security of your deployment by changing the account to run as a different user.</span></span> <span data-ttu-id="34194-112">Выполните следующие инструкции, чтобы изменить учетную запись. [обновите учетные данные, используемые существующей учетной записью автоматического обновления данных PowerPivot](#bkmk_editUA).</span><span class="sxs-lookup"><span data-stu-id="34194-112">Follow these instructions to change the account: [Update the credentials used by an existing PowerPivot unattended data refresh account](#bkmk_editUA).</span></span>  
  
 <span data-ttu-id="34194-113">Для всех остальных сценариев установки эту учетную запись необходимо настраивать вручную с использованием приведенных ниже инструкций.</span><span class="sxs-lookup"><span data-stu-id="34194-113">For all other installation scenarios, you must configure this account manually using the instructions below.</span></span>  
  
 <span data-ttu-id="34194-114">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="34194-114">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="34194-115">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="34194-115">Prerequisites</span></span>](#bkmk_prereq)  
  
 [<span data-ttu-id="34194-116">Шаг 1. Создание целевого приложения и Задание учетных данных</span><span class="sxs-lookup"><span data-stu-id="34194-116">Step 1: Create a target application and set the credentials</span></span>](#bkmk_create)  
  
 [<span data-ttu-id="34194-117">Шаг 2. Указание автоматической учетной записи на страницах конфигурации сервера PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-117">Step 2: Specify the unattended account in PowerPivot server configuration pages</span></span>](#bkmk_specifyUA)  
  
 [<span data-ttu-id="34194-118">Шаг 3. Предоставление разрешений на участие в учетной записи</span><span class="sxs-lookup"><span data-stu-id="34194-118">Step 3: Grant contribute permissions to the account</span></span>](#bkmk_grant)  
  
 [<span data-ttu-id="34194-119">Шаг 4. Предоставление разрешений на чтение для доступа к внешним источникам данных, используемым при обновлении данных</span><span class="sxs-lookup"><span data-stu-id="34194-119">Step 4: Grant read permissions to access external data sources used in data refresh</span></span>](#bkmk_dbread)  
  
 [<span data-ttu-id="34194-120">Шаг 5. Проверка доступности учетной записи на страницах конфигурации обновления данных</span><span class="sxs-lookup"><span data-stu-id="34194-120">Step 5: Verify account availability in data refresh configuration pages</span></span>](#bkmk_verify)  
  
 [<span data-ttu-id="34194-121">Использование учетной записи для автоматического обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-121">Using the PowerPivot Unattended Data Refresh Account</span></span>](#bkmk_use)  
  
 [<span data-ttu-id="34194-122">Обновление учетных данных данными из существующей учетной записи автоматического обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-122">Update the credentials used by an existing PowerPivot unattended data refresh account</span></span>](#bkmk_editUA)  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="34194-123">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="34194-123">Prerequisites</span></span>  
 <span data-ttu-id="34194-124">Служба Secure Store должна быть включена и настроена, и должен быть создан главный ключ.</span><span class="sxs-lookup"><span data-stu-id="34194-124">Secure Store Service must be enabled and configured, and a master key must be generated.</span></span> <span data-ttu-id="34194-125">Инструкции по выполнению этой задачи см. в статье [Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) .</span><span class="sxs-lookup"><span data-stu-id="34194-125">For instructions on how to do this, see [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span></span>  
  
 <span data-ttu-id="34194-126">Необходимо заранее определить, какая учетная запись пользователя домена Windows будет использоваться в качестве учетной записи автоматического обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-126">You must decide in advance which Windows domain user account to use as the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="34194-127">Эта учетная запись должна специально создаваться для этой задачи, чтобы отслеживать ее использование.</span><span class="sxs-lookup"><span data-stu-id="34194-127">This should be an account that is created specifically for this purpose so that you can monitor how it is used.</span></span>  
  
 <span data-ttu-id="34194-128">Пользователю необходимо знать идентификатор приложения системной службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-128">You must know the application identity of the PowerPivot System Service.</span></span> <span data-ttu-id="34194-129">Вы предоставляете этой учетной записи службы разрешения на **полный** доступ для учетной записи автоматического обновления данных при создании целевого приложения на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="34194-129">You will give this service account **Full Control** permissions over the unattended data refresh account when you create the target application for it in step 1.</span></span> <span data-ttu-id="34194-130">Эти разрешения позволяют системной службе PowerPivot получить учетные данные учетной записи автоматического обновления данных во время обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-130">These permissions allow the PowerPivot System Service to retrieve the credentials of the unattended data refresh account during data refresh.</span></span> <span data-ttu-id="34194-131">Чтобы получить необходимые сведения об учетной записи службы, откройте страницу **Настройка учетных записей служб** в центре администрирования и выберите пул приложений службы, используемый приложением службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-131">To get the required service account information, open the **Configure service accounts** page in Central Administration and select the service application pool used by the PowerPivot service application.</span></span> <span data-ttu-id="34194-132">По умолчанию это **пул приложений службы — система веб-служб SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="34194-132">By default, this is the **Service Application Pool - SharePoint Web Services System**.</span></span>  
  
## <a name="configure-the-unattended-powerpivot-data-refresh-account"></a><span data-ttu-id="34194-133">Настройка учетной записи автоматического обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-133">Configure the unattended PowerPivot data refresh account</span></span>  
 <span data-ttu-id="34194-134">Для каждого приложения службы PowerPivot можно настроить только одну учетную запись автоматического обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-134">You can configure only one PowerPivot unattended data refresh account for each PowerPivot service application.</span></span> <span data-ttu-id="34194-135">Сведения об учетной записи хранятся в службе Secure Store в целевом приложении, для которого задается готовая учетная запись пользователя домена Windows.</span><span class="sxs-lookup"><span data-stu-id="34194-135">Account information is stored in Secure Store Service in a target application that is set to a predefined Windows domain user account.</span></span> <span data-ttu-id="34194-136">После создания целевого приложения можно указать его в качестве учетной записи обновления данных PowerPivot на страницах конфигурации приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-136">Once the target application is created, you can specify it as the PowerPivot data refresh account in the configuration pages of a PowerPivot service application.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="34194-137">Если обновление данных выполняется с учетной записью автоматического обновления данных, то отчеты об использовании и журнал обновления данных записываются для учетной записи пользователя Windows, которая используется для автоматического обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-137">When data refresh is performed under the unattended data refresh account, usage reporting and data refresh history is recorded against the Windows user account used for unattended data refresh.</span></span> <span data-ttu-id="34194-138">Если требуется более точная регистрация пользователей, запрашивающих обновление данных или владеющих расписаниям, рекомендуется один из других вариантов обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-138">If you require a more accurate record of the individuals who are requesting data refresh or who own schedules, consider one of the other options for running data refresh.</span></span> <span data-ttu-id="34194-139">В частности, пользователи могут указывать собственные учетные данные (режим по умолчанию). Также можно создавать дополнительные целевые приложения для хранения учетных данных Windows, используемых для обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-139">Namely, having users specify their own credentials (this is the default), or creating additional target applications for storing any Windows credentials that you want to use for data refresh purposes.</span></span> <span data-ttu-id="34194-140">Дополнительные сведения см. в разделе [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="34194-140">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
 <span data-ttu-id="34194-141">Создание учетной записи автоматического обновления данных включает пять этапов.</span><span class="sxs-lookup"><span data-stu-id="34194-141">There are five parts to creating the unattended data refresh account.</span></span>  
  
-   <span data-ttu-id="34194-142">В службах Secure Store создайте целевое приложение для учетной записи и укажите учетные данные.</span><span class="sxs-lookup"><span data-stu-id="34194-142">Create a target application in Secure Store Service for the account and specify the credentials.</span></span>  
  
-   <span data-ttu-id="34194-143">На странице настройки сервера PowerPivot укажите идентификатор целевого приложения для учетной записи автоматического обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-143">Specify the target application ID for the unattended data refresh account in the PowerPivot server configuration page.</span></span>  
  
-   <span data-ttu-id="34194-144">Предоставьте учетной записи разрешения «Участие».</span><span class="sxs-lookup"><span data-stu-id="34194-144">Grant Contribute permissions to the account.</span></span>  
  
-   <span data-ttu-id="34194-145">Предоставьте учетной записи разрешения на чтение для обеспечения доступа к внешним источникам данных при обновлении данных.</span><span class="sxs-lookup"><span data-stu-id="34194-145">Grant the account read permissions to access external data sources during data refresh.</span></span>  
  
-   <span data-ttu-id="34194-146">Убедитесь, что учетная запись появилась на странице «Управление расписанием обновления данных» для опубликованной книги PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-146">Verify the account is available in the Manage Data Refresh schedule page for a published PowerPivot workbook.</span></span>  
  
###  <a name="step-1-create-a-target-application-and-set-the-credentials"></a><a name="bkmk_create"></a><span data-ttu-id="34194-147">Шаг 1. Создание целевого приложения и Задание учетных данных</span><span class="sxs-lookup"><span data-stu-id="34194-147">Step 1: Create a target application and set the credentials</span></span>  
  
1.  <span data-ttu-id="34194-148">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="34194-148">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="34194-149">Щелкните **Служба Secure Store**.</span><span class="sxs-lookup"><span data-stu-id="34194-149">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="34194-150">В окне Управление целевыми приложениями нажмите кнопку **создать**.</span><span class="sxs-lookup"><span data-stu-id="34194-150">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="34194-151">В окне идентификатор целевого приложения введите **PowerPivotDataRefresh**.</span><span class="sxs-lookup"><span data-stu-id="34194-151">In Target application ID, type **PowerPivotDataRefresh**.</span></span>  
  
5.  <span data-ttu-id="34194-152">В окне отображаемое имя введите **PowerPivot Data Refresh**.</span><span class="sxs-lookup"><span data-stu-id="34194-152">In Display Name, type **PowerPivot Data Refresh**.</span></span>  
  
6.  <span data-ttu-id="34194-153">В поле «Адрес электронной почты» введите адрес.</span><span class="sxs-lookup"><span data-stu-id="34194-153">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="34194-154">В списке Тип целевого приложения выберите значение **отдельно**.</span><span class="sxs-lookup"><span data-stu-id="34194-154">In Target Application Type, select **Individual**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="34194-155">Для этого сценария является правильным определение типа учетной записи «Отдельный», поскольку лишь приложение службы PowerPivot будет запрашивать учетные данные учетной записи автоматического обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-155">Specifying an Individual account type is correct for this scenario because only the PowerPivot service application will request the credentials of the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="34194-156">С точки зрения практики это приложение службы является единственным пользователем учетной записи автоматического обновления данных, поэтому применение типа учетной записи «Отдельный» является наилучшим выбором для этого целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="34194-156">In practice, the service application is the sole user of the unattended data refresh account, making the Individual account type the best choice for this target application.</span></span>  
  
8.  <span data-ttu-id="34194-157">Пропустите URL-адрес страницы целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="34194-157">Skip Target Application Page URL.</span></span> <span data-ttu-id="34194-158">Обновление данных PowerPivot не использует его.</span><span class="sxs-lookup"><span data-stu-id="34194-158">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="34194-159">Щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="34194-159">Click **Next**.</span></span>  
  
10. <span data-ttu-id="34194-160">На странице **Укажите поля учетных данных для целевого приложения Secure Store** примите значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="34194-160">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values.</span></span> <span data-ttu-id="34194-161">Имена полей и типы должны быть следующими: «Имя пользователя Windows» и «Пароль Windows»</span><span class="sxs-lookup"><span data-stu-id="34194-161">Field names and types should be Windows User Name and Windows Password</span></span>  
  
11. <span data-ttu-id="34194-162">Щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="34194-162">Click **Next**.</span></span>  
  
12. <span data-ttu-id="34194-163">На странице «Администраторы целевого приложения» укажите идентификатор пула приложений, соответствующий приложению службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-163">In Target Application Administrators, specify the application pool identity of the PowerPivot service application.</span></span> <span data-ttu-id="34194-164">Служба требует разрешений **полного** доступа, чтобы она могла получать данные учетной записи автоматического обновления данных во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="34194-164">The service requires **Full Control** permissions so that it can retrieve unattended data refresh account information at run time.</span></span> <span data-ttu-id="34194-165">Кроме того, задайте учетные записи пользователей домена Windows для любых других пользователей SharePoint, которые должны иметь права администратора для доступа к настройкам приложения.</span><span class="sxs-lookup"><span data-stu-id="34194-165">In addition, specify the Windows domain user accounts of any other SharePoint user who should have administrative access to the application settings.</span></span>  
  
13. <span data-ttu-id="34194-166">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="34194-166">Click **OK**.</span></span>  
  
14. <span data-ttu-id="34194-167">Выберите только что созданное целевое приложение, нажмите кнопку со стрелкой вниз и выберите **задать учетные данные.**</span><span class="sxs-lookup"><span data-stu-id="34194-167">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
15. <span data-ttu-id="34194-168">В поле **владельцы учетных данных**введите учетную запись пользователя домена Windows, которая должна иметь разрешения на обновление учетных данных.</span><span class="sxs-lookup"><span data-stu-id="34194-168">In **Credential Owners**, type a Windows domain user account that you want to have permissions to update the credentials.</span></span> <span data-ttu-id="34194-169">Учетные данные используются для новых действий с данными, а **владельцы учетных данных** имеют разрешения на изменение учетных данных.</span><span class="sxs-lookup"><span data-stu-id="34194-169">The credentials are used for data fresh actions and the **Credential Owners** have permissions to modify the credentials.</span></span>  
  
16. <span data-ttu-id="34194-170">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="34194-170">Click **OK**.</span></span>  
  
###  <a name="step-2-specify-the-unattended-account-in-powerpivot-server-configuration-pages"></a><a name="bkmk_specifyUA"></a><span data-ttu-id="34194-171">Шаг 2. Указание автоматической учетной записи на страницах конфигурации сервера PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-171">Step 2: Specify the unattended account in PowerPivot server configuration pages</span></span>  
  
1.  <span data-ttu-id="34194-172">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="34194-172">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="34194-173">Найдите приложение службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-173">Find the PowerPivot Service application.</span></span> <span data-ttu-id="34194-174">Определить приложение службы можно по его типу.</span><span class="sxs-lookup"><span data-stu-id="34194-174">You can identify a service application by its type.</span></span> <span data-ttu-id="34194-175">Типом приложения службы PowerPivot является **Приложение службы PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="34194-175">A PowerPivot service application type is **PowerPivot Service Application**.</span></span>  
  
3.  <span data-ttu-id="34194-176">Щелкните имя приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-176">Click the PowerPivot service application name.</span></span> <span data-ttu-id="34194-177">Подождите, пока появится панель управления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-177">Wait for the PowerPivot Management Dashboard to appear.</span></span>  
  
4.  <span data-ttu-id="34194-178">В области действия в правом верхнем углу щелкните **Настройка параметров приложения службы**.</span><span class="sxs-lookup"><span data-stu-id="34194-178">In Actions, in the top right corner, click **Configure service application settings**.</span></span>  
  
5.  <span data-ttu-id="34194-179">В поле обновление данных в поле Учетная запись автоматического обновления данных PowerPivot введите идентификатор целевого приложения, созданный на предыдущем шаге: **PowerPivotDataRefresh**.</span><span class="sxs-lookup"><span data-stu-id="34194-179">In Data Refresh, in PowerPivot Unattended Data Refresh Account, type the target application ID you created in a previous step: **PowerPivotDataRefresh**.</span></span>  
  
6.  <span data-ttu-id="34194-180">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="34194-180">Click **OK**.</span></span>  
  
###  <a name="step-3-grant-contribute-permissions-to-the-account"></a><a name="bkmk_grant"></a><span data-ttu-id="34194-181">Шаг 3. Предоставление разрешений на участие в учетной записи</span><span class="sxs-lookup"><span data-stu-id="34194-181">Step 3: Grant contribute permissions to the account</span></span>  
 <span data-ttu-id="34194-182">Перед использованием учетной записи автоматического обновления данных PowerPivot ей необходимо назначить разрешения «Участие» во всех книгах PowerPivot, где она будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="34194-182">Before you can use the PowerPivot unattended data refresh account, it must be assigned Contribute permissions on any PowerPivot workbook for which it is used.</span></span> <span data-ttu-id="34194-183">Этот уровень разрешений необходим для открытия книги из библиотеки и сохранения книги в библиотеке после обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-183">This permission level is necessary to open the workbook from a library and then save it back to the library after the data is refreshed.</span></span>  
  
 <span data-ttu-id="34194-184">Назначение разрешений выполняется администратором семейства веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="34194-184">Assigning permissions is a step that is performed by the site collection administrator.</span></span> <span data-ttu-id="34194-185">Разрешения SharePoint можно назначать в корневом семействе сайтов или на любом уровне ниже, включая уровень отдельных документов и элементов.</span><span class="sxs-lookup"><span data-stu-id="34194-185">SharePoint permissions can be assigned at the root site collection or at any level below that, including on individual documents and items.</span></span> <span data-ttu-id="34194-186">Порядок задания разрешений зависит от требуемой гранулярности разрешений.</span><span class="sxs-lookup"><span data-stu-id="34194-186">How you set permissions will vary depending on how granular you need them to be.</span></span> <span data-ttu-id="34194-187">В следующих действиях показан один из способов предоставления разрешений.</span><span class="sxs-lookup"><span data-stu-id="34194-187">The following steps show you one approach for granting permissions.</span></span>  
  
1.  <span data-ttu-id="34194-188">На сайте SharePoint в меню Действия сайта выберите **разрешения сайта**.</span><span class="sxs-lookup"><span data-stu-id="34194-188">On a SharePoint site, in Site Actions, click **Site Permissions**.</span></span>  
  
2.  <span data-ttu-id="34194-189">Нажмите кнопку **Предоставить разрешения**.</span><span class="sxs-lookup"><span data-stu-id="34194-189">Click **Grant Permissions**.</span></span>  
  
3.  <span data-ttu-id="34194-190">В поле «Выберите пользователей» введите имя учетной записи пользователя домена Windows, выбранной в качестве учетной записи автоматического обновления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-190">In Select users, type the name of the Windows domain user account that you designated as the PowerPivot unattended account.</span></span> <span data-ttu-id="34194-191">Это имя учетной записи пользователя домена Windows, указанной в целевом приложении в службе Secure Store.</span><span class="sxs-lookup"><span data-stu-id="34194-191">This is the name of the Windows domain user account that you specified in target application in Secure Store Service.</span></span>  
  
4.  <span data-ttu-id="34194-192">В окне предоставление разрешений выберите **предоставить разрешения пользователям напрямую**.</span><span class="sxs-lookup"><span data-stu-id="34194-192">In Grant Permissions, select **Grant users permission directly**.</span></span>  
  
5.  <span data-ttu-id="34194-193">Выберите элемент **Contribute**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="34194-193">Select **Contribute**, and then click **OK**.</span></span>  
  
###  <a name="step-4-grant-read-permissions-to-access-external-data-sources-used-in-data-refresh"></a><a name="bkmk_dbread"></a><span data-ttu-id="34194-194">Шаг 4. Предоставление разрешений на чтение для доступа к внешним источникам данных, используемым при обновлении данных</span><span class="sxs-lookup"><span data-stu-id="34194-194">Step 4: Grant read permissions to access external data sources used in data refresh</span></span>  
 <span data-ttu-id="34194-195">При импорте данных в книгу PowerPivot соединения с внешними данными часто основываются на доверенных соединениях или олицетворенных подключениях, использующих идентификатор текущего пользователя для подключения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="34194-195">When importing data into a PowerPivot workbook, connections to external data are often based on trusted connections or impersonated connections that use the identity of the current user to connect to the data source.</span></span> <span data-ttu-id="34194-196">Эти типы подключений работают только тогда, когда текущий пользователь имеет разрешение на чтение данных, которые импортирует.</span><span class="sxs-lookup"><span data-stu-id="34194-196">These types of connections work only when the current user has permission to read the data that he or she is importing.</span></span>  
  
 <span data-ttu-id="34194-197">В сценарии обновления данных для обновления данных повторно используется та же строка подключения, которая использовалась для импорта данных.</span><span class="sxs-lookup"><span data-stu-id="34194-197">In a data refresh scenario, the same connection string that was used to import data is now reused to refresh the data.</span></span> <span data-ttu-id="34194-198">Если строка подключения предполагает текущего пользователя (например, включает параметр Integrated_Security=SSPI), то системная служба PowerPivot передает идентификатор пользователя учетной записи автоматического обновления данных PowerPivot в качестве текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="34194-198">If the connection string assumes the current user (for example, a string that includes Integrated_Security=SSPI), then the PowerPivot System Service will pass the user identity of the PowerPivot unattended data refresh account as the current user.</span></span> <span data-ttu-id="34194-199">Это соединение завершится успешно только в том случае, если учетная запись автоматического обновления данных PowerPivot имеет разрешения на чтение для внешнего источника данных.</span><span class="sxs-lookup"><span data-stu-id="34194-199">This connection will only succeed if the PowerPivot unattended data refresh account has read permissions on the external data source.</span></span>  
  
 <span data-ttu-id="34194-200">По этой причине необходимо предоставить учетной записи автоматического обновления данных PowerPivot разрешения только на чтение для всех внешних источников данных, используемых в операциях обновления данных, которые выполняются под этой автоматической учетной записью.</span><span class="sxs-lookup"><span data-stu-id="34194-200">For this reason, you must grant the PowerPivot unattended data refresh account read-only permissions on all of the external data sources that are used in any data refresh operation that runs under the unattended account.</span></span>  
  
 <span data-ttu-id="34194-201">Администратор источников данных, используемых в организации, может создать имя входа и назначить необходимые разрешения.</span><span class="sxs-lookup"><span data-stu-id="34194-201">If you are an administrator of the data sources used in your organization, you can create a login and assign the necessary permissions.</span></span> <span data-ttu-id="34194-202">В противном случае необходимо обратиться к владельцам данных и получить сведения об учетной записи.</span><span class="sxs-lookup"><span data-stu-id="34194-202">Otherwise, you must contact the data owners and provide the account information.</span></span> <span data-ttu-id="34194-203">Необходимо заранее определить, какая учетная запись пользователя домена Windows будет использоваться в качестве учетной записи автоматического обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-203">Be sure to specify the Windows domain user account that maps to the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="34194-204">Это учетная запись, указанная в "(шаг 1): создание целевого приложения и Настройка учетных данных" в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="34194-204">This is the account you specified in "(Step 1): Create a target application and set the credentials" in this topic.</span></span>  
  
###  <a name="step-5-verify-account-availability-in-data-refresh-configuration-pages"></a><a name="bkmk_verify"></a><span data-ttu-id="34194-205">Шаг 5. Проверка доступности учетной записи на страницах конфигурации обновления данных</span><span class="sxs-lookup"><span data-stu-id="34194-205">Step 5: Verify account availability in data refresh configuration pages</span></span>  
  
1.  <span data-ttu-id="34194-206">Откройте страницу настройки обновления данных для опубликованной книги, которая содержит данные PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-206">Open a data refresh configuration page for a published workbook that contains PowerPivot data.</span></span> <span data-ttu-id="34194-207">Инструкции по открытию страницы см. в разделе [планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="34194-207">For instructions on how to open the page, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="34194-208">Убедитесь, что на странице Настройка обновления данных включен параметр **использовать учетную запись обновления данных, настроенную администратором** .</span><span class="sxs-lookup"><span data-stu-id="34194-208">Verify that the **Use the data refresh account configured by the administrator** option is enabled in the data refresh configuration page.</span></span>  
  
3.  <span data-ttu-id="34194-209">Установите флажок **также обновлять как можно скорее** , а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="34194-209">Select the **Also refresh as soon as possible** checkbox, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="34194-210">В библиотеке, содержащей книгу, выберите книгу, щелкните стрелку вниз, которая отображается справа, а затем выберите **Управление обновлением данных PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="34194-210">In the library that contains the workbook, select the workbook, click the down arrow that appears to right, and then select **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="34194-211">Может потребоваться подождать в течение нескольких минут, если задание обновления данных возвращает большой объем данных.</span><span class="sxs-lookup"><span data-stu-id="34194-211">You might need to wait several minutes if the data refresh job is returning a large amount of data.</span></span>  
  
 <span data-ttu-id="34194-212">При возникновении ошибки можно нажать кнопку **настроить расписание** на странице Журнал обновления данных, чтобы попробовать использовать другие учетные данные.</span><span class="sxs-lookup"><span data-stu-id="34194-212">If an error occurs, you can click **Configure schedule** in the data refresh history page to try different credentials.</span></span> <span data-ttu-id="34194-213">Может также потребоваться проверка сведений о соединении с источником данных в исходной книге для просмотра строки подключения, которая используется во время обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-213">You might also need to inspect the data source connection information in the original workbook to view the connection string that is used during data refresh.</span></span> <span data-ttu-id="34194-214">Строка подключения предоставляет сведения о местонахождении сервера и базы данных, которые можно использовать для устранения проблемы.</span><span class="sxs-lookup"><span data-stu-id="34194-214">The connection string will provide information about the server location and database that you can use to troubleshoot the problem.</span></span>  
  
 <span data-ttu-id="34194-215">Дополнительные сведения об устранении неполадок см. в разделе [Устранение неполадок при обновлении данных PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) на вики-сайте TechNet.</span><span class="sxs-lookup"><span data-stu-id="34194-215">For more information about troubleshooting, see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/p/?LinkID=223279) on the TechNet Wiki.</span></span>  
  
##  <a name="using-the-powerpivot-unattended-data-refresh-account"></a><a name="bkmk_use"></a><span data-ttu-id="34194-216">Использование учетной записи автоматического обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-216">Using the PowerPivot Unattended Data Refresh Account</span></span>  
 <span data-ttu-id="34194-217">На странице подготовки расписания обновления данных PowerPivot только первый вариант определения параметров учетных данных из трех соответствует учетной записи автоматического обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-217">Of the three credential options in PowerPivot data refresh scheduling page, only the first one corresponds to the unattended data refresh account.</span></span> <span data-ttu-id="34194-218">Обязательно выберите этот вариант при настройке расписания обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-218">Be sure to select this option when setting up the data refresh schedule.</span></span>  
  
 <span data-ttu-id="34194-219">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="34194-219">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>  
  
 <span data-ttu-id="34194-220">Не используйте третий вариант определения учетных данных (тот, который требует ввода идентификатора целевого приложения) для получения доступа к учетной записи автоматического обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-220">Do not use the third credential option (the one that requires you to enter the target application ID) to access the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="34194-221">При использовании этого варианта предусмотрена дополнительная проверка олицетворения, которая приводит к ошибке проверки при попытке выполнения ее по отношению к учетной записи автоматического обновления данных PowerPivot (или к любому целевому приложению, основанному на применении типа учетной записи «Отдельный»).</span><span class="sxs-lookup"><span data-stu-id="34194-221">There is an additional impersonation check that is performed with that option that will result in a validation error if you try to use it with the PowerPivot unattended data refresh account (or any target application that is based on the Individual account type).</span></span> <span data-ttu-id="34194-222">Дополнительные сведения об использовании третьего варианта см. в статье [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="34194-222">For more information about how to use the third option, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
##  <a name="update-the-credentials-used-by-an-existing-powerpivot-unattended-data-refresh-account"></a><a name="bkmk_editUA"></a><span data-ttu-id="34194-223">Обновление учетных данных, используемых существующей учетной записью автоматического обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-223">Update the credentials used by an existing PowerPivot unattended data refresh account</span></span>  
 <span data-ttu-id="34194-224">Если учетная запись автоматического обновления данных уже настроена в процессе установки или настроена администратором, можно обновить имя пользователя или пароль, внеся изменения в целевом приложении, где хранятся учетные данные.</span><span class="sxs-lookup"><span data-stu-id="34194-224">If the unattended data refresh account is already configured through setup or by an administrator, you can update the user name or password by editing the target application that stores the credentials.</span></span> <span data-ttu-id="34194-225">Следует учитывать, что при изменении учетных данных в службе Secure Store исходный идентификатор Windows, который был перед этим связан с учетной записью автоматического обновления данных PowerPivot, не будет видимым.</span><span class="sxs-lookup"><span data-stu-id="34194-225">Note that the original Windows identity that was previously associated with PowerPivot unattended data refresh account will not be visible when you edit the credentials in Secure Store Service.</span></span> <span data-ttu-id="34194-226">В службе Secure Store необходимо всегда повторно вводить и имя пользователя, и пароль для данного целевого приложения, независимо от того, обновляется ли пароль с истекшим сроком действия или задается другая учетная запись.</span><span class="sxs-lookup"><span data-stu-id="34194-226">Whether you are updating an expired password or specifying different account, you must always re-type both the user name and password for that target application in Secure Store Service.</span></span>  
  
1.  <span data-ttu-id="34194-227">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="34194-227">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="34194-228">Щелкните **Служба Secure Store**.</span><span class="sxs-lookup"><span data-stu-id="34194-228">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="34194-229">Установите флажок рядом с **PowerPivotDataRefresh**.</span><span class="sxs-lookup"><span data-stu-id="34194-229">Select the checkbox next to **PowerPivotDataRefresh**.</span></span>  
  
4.  <span data-ttu-id="34194-230">В окне Учетные данные нажмите кнопку **задать**.</span><span class="sxs-lookup"><span data-stu-id="34194-230">In Credentials, click **Set**.</span></span>  
  
5.  <span data-ttu-id="34194-231">В поле **владельцы учетных данных**введите учетную запись пользователя домена Windows, которая должна иметь разрешения на обновление учетных данных.</span><span class="sxs-lookup"><span data-stu-id="34194-231">In **Credential Owners**, type a Windows domain user account that you want to have permissions to update the credentials.</span></span> <span data-ttu-id="34194-232">Учетные данные используются для новых действий с данными, а **владельцы учетных данных** имеют разрешения на изменение учетных данных.</span><span class="sxs-lookup"><span data-stu-id="34194-232">The credentials are used for data fresh actions and the **Credential Owners** have permissions to modify the credentials.</span></span>  
  
6.  <span data-ttu-id="34194-233">В поле «Имя пользователя» введите учетную запись пользователя домена Windows, которая будет частью учетных данных автоматического обновления данных.</span><span class="sxs-lookup"><span data-stu-id="34194-233">In User Name, type the Windows domain user account that will be part of the unattended data refresh credentials.</span></span>  
  
7.  <span data-ttu-id="34194-234">В поле «Пароль» ведите пароль для учетной записи и повторите ввод для подтверждения.</span><span class="sxs-lookup"><span data-stu-id="34194-234">In Password, type the password for the account, and then re-type it to confirm the password.</span></span>  
  
8.  <span data-ttu-id="34194-235">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="34194-235">Click **OK**.</span></span>  
  
 <span data-ttu-id="34194-236">Если происходит смена не только пароля, но и имени пользователя учетной записи, то, по всей видимости, потребуется выполнение дополнительных шагов настройки, таких как предоставление разрешений на чтение для внешних источников данных и разрешений SharePoint на обновление книги PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="34194-236">If you are changing not just the password, but the account user name as well, you will most likely need to perform additional configuration steps, such as granting read permissions to external data sources and SharePoint permissions to update the PowerPivot workbook.</span></span> <span data-ttu-id="34194-237">Инструкции см. в разделе Настройка учетной записи автоматического обновления данных PowerPivot: [Шаг 3. Предоставление учетной записи разрешений на участие пользователя](#bkmk_grant), а затем продолжение выполнения всех оставшихся действий с проверкой правильности настройки учетной записи.</span><span class="sxs-lookup"><span data-stu-id="34194-237">For instructions, go to this step in PowerPivot unattended data refresh account configuration: [Step 3: Grant contribute permissions to the account](#bkmk_grant), and then continue with all remaining steps, concluding with verification that the account is configured correctly.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="34194-238">См. также:</span><span class="sxs-lookup"><span data-stu-id="34194-238">See Also</span></span>  
 <span data-ttu-id="34194-239">[Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="34194-239">[PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="34194-240">[Планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="34194-240">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="34194-241">Обновление данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="34194-241">PowerPivot Data Refresh</span></span>](power-pivot-sharepoint/power-pivot-data-refresh.md)  
  
  
