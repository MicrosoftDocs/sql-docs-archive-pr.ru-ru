---
title: Настройка учетной записи автоматического обновления данных PowerPivot (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 81401eac-c619-4fad-ad3e-599e7a6f8493
author: minewiskan
ms.author: owend
ms.openlocfilehash: d6f53d7272dc48ed55ffb175e0ace3e97263946c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656745"
---
# <a name="configure-the-powerpivot-unattended-data-refresh-account-powerpivot-for-sharepoint"></a>Настройка учетной записи автоматического обновления данных PowerPivot (PowerPivot для SharePoint)
  Учетная запись автоматического обновления данных PowerPivot специально предназначена для выполнения заданий по обновлению данных PowerPivot на ферме SharePoint. Настроив его, вы включаете параметр **использовать учетную запись обновления данных, настроенную администратором** на странице расписания обновления данных (см. ниже). Авторы книг, планирующие обновление данных, могут выбрать этот параметр, если желают использовать учетную запись автоматического обновления данных PowerPivot для выполнения задания по обновлению данных. Дополнительные сведения о просмотре параметров учетных данных в расписании обновления данных см. в разделе [планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).  
  
 ![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010  
  
 В зависимости от параметров, выбранных при настройке сервера, учетная запись автоматического обновления данных может быть уже создана. В конфигурации по умолчанию в качестве идентификатора учетной записи автоматического обновления данных первоначально задается учетная запись фермы. Чтобы повысить безопасность среды, можно изменить учетную запись для выполнения от имени другого пользователя. Выполните следующие инструкции, чтобы изменить учетную запись. [обновите учетные данные, используемые существующей учетной записью автоматического обновления данных PowerPivot](#bkmk_editUA).  
  
 Для всех остальных сценариев установки эту учетную запись необходимо настраивать вручную с использованием приведенных ниже инструкций.  
  
 Этот раздел состоит из следующих подразделов.  
  
 [Предварительные требования](#bkmk_prereq)  
  
 [Шаг 1. Создание целевого приложения и Задание учетных данных](#bkmk_create)  
  
 [Шаг 2. Указание автоматической учетной записи на страницах конфигурации сервера PowerPivot](#bkmk_specifyUA)  
  
 [Шаг 3. Предоставление разрешений на участие в учетной записи](#bkmk_grant)  
  
 [Шаг 4. Предоставление разрешений на чтение для доступа к внешним источникам данных, используемым при обновлении данных](#bkmk_dbread)  
  
 [Шаг 5. Проверка доступности учетной записи на страницах конфигурации обновления данных](#bkmk_verify)  
  
 [Использование учетной записи для автоматического обновления данных PowerPivot](#bkmk_use)  
  
 [Обновление учетных данных данными из существующей учетной записи автоматического обновления данных PowerPivot](#bkmk_editUA)  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> Предварительные требования  
 Служба Secure Store должна быть включена и настроена, и должен быть создан главный ключ. Инструкции по выполнению этой задачи см. в статье [Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) .  
  
 Необходимо заранее определить, какая учетная запись пользователя домена Windows будет использоваться в качестве учетной записи автоматического обновления данных PowerPivot. Эта учетная запись должна специально создаваться для этой задачи, чтобы отслеживать ее использование.  
  
 Пользователю необходимо знать идентификатор приложения системной службы PowerPivot. Вы предоставляете этой учетной записи службы разрешения на **полный** доступ для учетной записи автоматического обновления данных при создании целевого приложения на шаге 1. Эти разрешения позволяют системной службе PowerPivot получить учетные данные учетной записи автоматического обновления данных во время обновления данных. Чтобы получить необходимые сведения об учетной записи службы, откройте страницу **Настройка учетных записей служб** в центре администрирования и выберите пул приложений службы, используемый приложением службы PowerPivot. По умолчанию это **пул приложений службы — система веб-служб SharePoint**.  
  
## <a name="configure-the-unattended-powerpivot-data-refresh-account"></a>Настройка учетной записи автоматического обновления данных PowerPivot  
 Для каждого приложения службы PowerPivot можно настроить только одну учетную запись автоматического обновления данных PowerPivot. Сведения об учетной записи хранятся в службе Secure Store в целевом приложении, для которого задается готовая учетная запись пользователя домена Windows. После создания целевого приложения можно указать его в качестве учетной записи обновления данных PowerPivot на страницах конфигурации приложения службы PowerPivot.  
  
> [!NOTE]  
>  Если обновление данных выполняется с учетной записью автоматического обновления данных, то отчеты об использовании и журнал обновления данных записываются для учетной записи пользователя Windows, которая используется для автоматического обновления данных. Если требуется более точная регистрация пользователей, запрашивающих обновление данных или владеющих расписаниям, рекомендуется один из других вариантов обновления данных. В частности, пользователи могут указывать собственные учетные данные (режим по умолчанию). Также можно создавать дополнительные целевые приложения для хранения учетных данных Windows, используемых для обновления данных. Дополнительные сведения см. в разделе [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).  
  
 Создание учетной записи автоматического обновления данных включает пять этапов.  
  
-   В службах Secure Store создайте целевое приложение для учетной записи и укажите учетные данные.  
  
-   На странице настройки сервера PowerPivot укажите идентификатор целевого приложения для учетной записи автоматического обновления данных.  
  
-   Предоставьте учетной записи разрешения «Участие».  
  
-   Предоставьте учетной записи разрешения на чтение для обеспечения доступа к внешним источникам данных при обновлении данных.  
  
-   Убедитесь, что учетная запись появилась на странице «Управление расписанием обновления данных» для опубликованной книги PowerPivot.  
  
###  <a name="step-1-create-a-target-application-and-set-the-credentials"></a><a name="bkmk_create"></a>Шаг 1. Создание целевого приложения и Задание учетных данных  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Щелкните **Служба Secure Store**.  
  
3.  В окне Управление целевыми приложениями нажмите кнопку **создать**.  
  
4.  В окне идентификатор целевого приложения введите **PowerPivotDataRefresh**.  
  
5.  В окне отображаемое имя введите **PowerPivot Data Refresh**.  
  
6.  В поле «Адрес электронной почты» введите адрес.  
  
7.  В списке Тип целевого приложения выберите значение **отдельно**.  
  
    > [!NOTE]  
    >  Для этого сценария является правильным определение типа учетной записи «Отдельный», поскольку лишь приложение службы PowerPivot будет запрашивать учетные данные учетной записи автоматического обновления данных PowerPivot. С точки зрения практики это приложение службы является единственным пользователем учетной записи автоматического обновления данных, поэтому применение типа учетной записи «Отдельный» является наилучшим выбором для этого целевого приложения.  
  
8.  Пропустите URL-адрес страницы целевого приложения. Обновление данных PowerPivot не использует его.  
  
9. Щелкните **Далее**.  
  
10. На странице **Укажите поля учетных данных для целевого приложения Secure Store** примите значения по умолчанию. Имена полей и типы должны быть следующими: «Имя пользователя Windows» и «Пароль Windows»  
  
11. Щелкните **Далее**.  
  
12. На странице «Администраторы целевого приложения» укажите идентификатор пула приложений, соответствующий приложению службы PowerPivot. Служба требует разрешений **полного** доступа, чтобы она могла получать данные учетной записи автоматического обновления данных во время выполнения. Кроме того, задайте учетные записи пользователей домена Windows для любых других пользователей SharePoint, которые должны иметь права администратора для доступа к настройкам приложения.  
  
13. Нажмите кнопку **ОК**.  
  
14. Выберите только что созданное целевое приложение, нажмите кнопку со стрелкой вниз и выберите **задать учетные данные.**  
  
15. В поле **владельцы учетных данных**введите учетную запись пользователя домена Windows, которая должна иметь разрешения на обновление учетных данных. Учетные данные используются для новых действий с данными, а **владельцы учетных данных** имеют разрешения на изменение учетных данных.  
  
16. Нажмите кнопку **ОК**.  
  
###  <a name="step-2-specify-the-unattended-account-in-powerpivot-server-configuration-pages"></a><a name="bkmk_specifyUA"></a>Шаг 2. Указание автоматической учетной записи на страницах конфигурации сервера PowerPivot  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Найдите приложение службы PowerPivot. Определить приложение службы можно по его типу. Типом приложения службы PowerPivot является **Приложение службы PowerPivot**.  
  
3.  Щелкните имя приложения службы PowerPivot. Подождите, пока появится панель управления PowerPivot.  
  
4.  В области действия в правом верхнем углу щелкните **Настройка параметров приложения службы**.  
  
5.  В поле обновление данных в поле Учетная запись автоматического обновления данных PowerPivot введите идентификатор целевого приложения, созданный на предыдущем шаге: **PowerPivotDataRefresh**.  
  
6.  Нажмите кнопку **ОК**.  
  
###  <a name="step-3-grant-contribute-permissions-to-the-account"></a><a name="bkmk_grant"></a>Шаг 3. Предоставление разрешений на участие в учетной записи  
 Перед использованием учетной записи автоматического обновления данных PowerPivot ей необходимо назначить разрешения «Участие» во всех книгах PowerPivot, где она будет использоваться. Этот уровень разрешений необходим для открытия книги из библиотеки и сохранения книги в библиотеке после обновления данных.  
  
 Назначение разрешений выполняется администратором семейства веб-сайтов. Разрешения SharePoint можно назначать в корневом семействе сайтов или на любом уровне ниже, включая уровень отдельных документов и элементов. Порядок задания разрешений зависит от требуемой гранулярности разрешений. В следующих действиях показан один из способов предоставления разрешений.  
  
1.  На сайте SharePoint в меню Действия сайта выберите **разрешения сайта**.  
  
2.  Нажмите кнопку **Предоставить разрешения**.  
  
3.  В поле «Выберите пользователей» введите имя учетной записи пользователя домена Windows, выбранной в качестве учетной записи автоматического обновления PowerPivot. Это имя учетной записи пользователя домена Windows, указанной в целевом приложении в службе Secure Store.  
  
4.  В окне предоставление разрешений выберите **предоставить разрешения пользователям напрямую**.  
  
5.  Выберите элемент **Contribute**и нажмите кнопку **ОК**.  
  
###  <a name="step-4-grant-read-permissions-to-access-external-data-sources-used-in-data-refresh"></a><a name="bkmk_dbread"></a>Шаг 4. Предоставление разрешений на чтение для доступа к внешним источникам данных, используемым при обновлении данных  
 При импорте данных в книгу PowerPivot соединения с внешними данными часто основываются на доверенных соединениях или олицетворенных подключениях, использующих идентификатор текущего пользователя для подключения к источнику данных. Эти типы подключений работают только тогда, когда текущий пользователь имеет разрешение на чтение данных, которые импортирует.  
  
 В сценарии обновления данных для обновления данных повторно используется та же строка подключения, которая использовалась для импорта данных. Если строка подключения предполагает текущего пользователя (например, включает параметр Integrated_Security=SSPI), то системная служба PowerPivot передает идентификатор пользователя учетной записи автоматического обновления данных PowerPivot в качестве текущего пользователя. Это соединение завершится успешно только в том случае, если учетная запись автоматического обновления данных PowerPivot имеет разрешения на чтение для внешнего источника данных.  
  
 По этой причине необходимо предоставить учетной записи автоматического обновления данных PowerPivot разрешения только на чтение для всех внешних источников данных, используемых в операциях обновления данных, которые выполняются под этой автоматической учетной записью.  
  
 Администратор источников данных, используемых в организации, может создать имя входа и назначить необходимые разрешения. В противном случае необходимо обратиться к владельцам данных и получить сведения об учетной записи. Необходимо заранее определить, какая учетная запись пользователя домена Windows будет использоваться в качестве учетной записи автоматического обновления данных PowerPivot. Это учетная запись, указанная в "(шаг 1): создание целевого приложения и Настройка учетных данных" в этом разделе.  
  
###  <a name="step-5-verify-account-availability-in-data-refresh-configuration-pages"></a><a name="bkmk_verify"></a>Шаг 5. Проверка доступности учетной записи на страницах конфигурации обновления данных  
  
1.  Откройте страницу настройки обновления данных для опубликованной книги, которая содержит данные PowerPivot. Инструкции по открытию страницы см. в разделе [планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).  
  
2.  Убедитесь, что на странице Настройка обновления данных включен параметр **использовать учетную запись обновления данных, настроенную администратором** .  
  
3.  Установите флажок **также обновлять как можно скорее** , а затем нажмите кнопку **ОК**.  
  
4.  В библиотеке, содержащей книгу, выберите книгу, щелкните стрелку вниз, которая отображается справа, а затем выберите **Управление обновлением данных PowerPivot**. Может потребоваться подождать в течение нескольких минут, если задание обновления данных возвращает большой объем данных.  
  
 При возникновении ошибки можно нажать кнопку **настроить расписание** на странице Журнал обновления данных, чтобы попробовать использовать другие учетные данные. Может также потребоваться проверка сведений о соединении с источником данных в исходной книге для просмотра строки подключения, которая используется во время обновления данных. Строка подключения предоставляет сведения о местонахождении сервера и базы данных, которые можно использовать для устранения проблемы.  
  
 Дополнительные сведения об устранении неполадок см. в разделе [Устранение неполадок при обновлении данных PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) на вики-сайте TechNet.  
  
##  <a name="using-the-powerpivot-unattended-data-refresh-account"></a><a name="bkmk_use"></a>Использование учетной записи автоматического обновления данных PowerPivot  
 На странице подготовки расписания обновления данных PowerPivot только первый вариант определения параметров учетных данных из трех соответствует учетной записи автоматического обновления данных. Обязательно выберите этот вариант при настройке расписания обновления данных.  
  
 ![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")  
  
 Не используйте третий вариант определения учетных данных (тот, который требует ввода идентификатора целевого приложения) для получения доступа к учетной записи автоматического обновления данных PowerPivot. При использовании этого варианта предусмотрена дополнительная проверка олицетворения, которая приводит к ошибке проверки при попытке выполнения ее по отношению к учетной записи автоматического обновления данных PowerPivot (или к любому целевому приложению, основанному на применении типа учетной записи «Отдельный»). Дополнительные сведения об использовании третьего варианта см. в статье [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).  
  
##  <a name="update-the-credentials-used-by-an-existing-powerpivot-unattended-data-refresh-account"></a><a name="bkmk_editUA"></a>Обновление учетных данных, используемых существующей учетной записью автоматического обновления данных PowerPivot  
 Если учетная запись автоматического обновления данных уже настроена в процессе установки или настроена администратором, можно обновить имя пользователя или пароль, внеся изменения в целевом приложении, где хранятся учетные данные. Следует учитывать, что при изменении учетных данных в службе Secure Store исходный идентификатор Windows, который был перед этим связан с учетной записью автоматического обновления данных PowerPivot, не будет видимым. В службе Secure Store необходимо всегда повторно вводить и имя пользователя, и пароль для данного целевого приложения, независимо от того, обновляется ли пароль с истекшим сроком действия или задается другая учетная запись.  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Щелкните **Служба Secure Store**.  
  
3.  Установите флажок рядом с **PowerPivotDataRefresh**.  
  
4.  В окне Учетные данные нажмите кнопку **задать**.  
  
5.  В поле **владельцы учетных данных**введите учетную запись пользователя домена Windows, которая должна иметь разрешения на обновление учетных данных. Учетные данные используются для новых действий с данными, а **владельцы учетных данных** имеют разрешения на изменение учетных данных.  
  
6.  В поле «Имя пользователя» введите учетную запись пользователя домена Windows, которая будет частью учетных данных автоматического обновления данных.  
  
7.  В поле «Пароль» ведите пароль для учетной записи и повторите ввод для подтверждения.  
  
8.  Нажмите кнопку **ОК**.  
  
 Если происходит смена не только пароля, но и имени пользователя учетной записи, то, по всей видимости, потребуется выполнение дополнительных шагов настройки, таких как предоставление разрешений на чтение для внешних источников данных и разрешений SharePoint на обновление книги PowerPivot. Инструкции см. в разделе Настройка учетной записи автоматического обновления данных PowerPivot: [Шаг 3. Предоставление учетной записи разрешений на участие пользователя](#bkmk_grant), а затем продолжение выполнения всех оставшихся действий с проверкой правильности настройки учетной записи.  
  
## <a name="see-also"></a>См. также:  
 [Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)   
 [Планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)   
 [Обновление данных PowerPivot](power-pivot-sharepoint/power-pivot-data-refresh.md)  
  
  
