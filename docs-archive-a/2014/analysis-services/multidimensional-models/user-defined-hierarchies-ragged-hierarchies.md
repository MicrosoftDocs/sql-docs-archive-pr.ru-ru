---
title: Неоднородные иерархии | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ragged hierarchies [Analysis Services]
ms.assetid: e40a5788-7ede-4b0f-93ab-46ca33d0cace
author: minewiskan
ms.author: owend
ms.openlocfilehash: 02cbb24b7ae80facf0ddbb1495fccc8f848df377
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87740529"
---
# <a name="ragged-hierarchies"></a><span data-ttu-id="f0689-102">Неоднородные иерархии</span><span class="sxs-lookup"><span data-stu-id="f0689-102">Ragged Hierarchies</span></span>
  <span data-ttu-id="f0689-103">неоднородная иерархия — это пользовательская иерархия, которая имеет нечетное количество уровней.</span><span class="sxs-lookup"><span data-stu-id="f0689-103">A ragged hierarchy is a user-defined hierarchy that has an uneven number of levels.</span></span> <span data-ttu-id="f0689-104">Распространенные примеры включают организационную диаграмму, на которой менеджеры высокого уровня координируют работу как менеджеров отделов, так и их подчиненных, или географические иерархии, состоящие из страны, региона и города, которые включают города без родительского элемента штата или провинции, например Вашингтон О. К., Ватикан или Новый Дели.</span><span class="sxs-lookup"><span data-stu-id="f0689-104">Common examples include an organizational chart where a high-level manager has both departmental managers and non-managers as direct reports, or geographic hierarchies composed of Country-Region-City, where some cities lack a parent State or Province, such as Washington D.C., Vatican City, or New Delhi.</span></span>  
  
 <span data-ttu-id="f0689-105">В большинстве иерархий из измерения на каждом уровне иерархии имеется столько же родительских элементов, сколько у любого другого элемента на том же уровне.</span><span class="sxs-lookup"><span data-stu-id="f0689-105">For most hierarchies in a dimension, each level has the same number of members above it as any other member at the same level.</span></span> <span data-ttu-id="f0689-106">Неоднородная иерархия отличается тем, что иерархия, в которой по крайней мере у одного элемента логический родительский элемент не находится ровно на один уровень выше самого элемента.</span><span class="sxs-lookup"><span data-stu-id="f0689-106">A ragged hierarchy is different in that the logical parent of at least one member is not in the level immediately above the member.</span></span> <span data-ttu-id="f0689-107">В этом случае различные ветви иерархии заканчиваются на разных уровнях.</span><span class="sxs-lookup"><span data-stu-id="f0689-107">When this occurs, the hierarchy descends to different levels for different drilldown paths.</span></span> <span data-ttu-id="f0689-108">Из-за этого пути углубленной детализации в клиентском приложении могут быть необоснованно сложными.</span><span class="sxs-lookup"><span data-stu-id="f0689-108">In a client application, this can make drilldown paths unnecessarily complicated.</span></span>  
  
 <span data-ttu-id="f0689-109">Клиентские приложения по-разному обрабатывают неоднородную иерархию.</span><span class="sxs-lookup"><span data-stu-id="f0689-109">Client applications vary in how well they handle a ragged hierarchy.</span></span> <span data-ttu-id="f0689-110">Если в модели существуют неоднородные иерархии, будьте готовы выполнить дополнительную работу, прежде чем получится нужный результат.</span><span class="sxs-lookup"><span data-stu-id="f0689-110">If ragged hierarchies exist in your model, be prepared to do a little extra work to get the rendering behavior you expect.</span></span>  
  
 <span data-ttu-id="f0689-111">Прежде всего проверьте, каким образом клиентское приложение обрабатывает путь углубленной детализации.</span><span class="sxs-lookup"><span data-stu-id="f0689-111">As a first step, check the client application to see how it handles the drilldown path.</span></span> <span data-ttu-id="f0689-112">Например, Excel повторяет имена родительских элементов как метки-заполнители для отсутствующих значений.</span><span class="sxs-lookup"><span data-stu-id="f0689-112">For example, Excel repeats the parent names as placeholders for missing values.</span></span> <span data-ttu-id="f0689-113">Чтобы посмотреть, как это работает, постройте сводную таблицу на основе измерения Sales Territory в многомерной модели Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="f0689-113">To see this behavior yourself, build a PivotTable using the Sales Territory dimension in the Adventure Works multidimensional model.</span></span> <span data-ttu-id="f0689-114">В сводной таблице с атрибутами Group, Country и Region измерения Sales Territory будет видно, что страны, у которых нет значения региона, получает заполнитель, в данном случае повторение названия страны (родительского элемента).</span><span class="sxs-lookup"><span data-stu-id="f0689-114">In a PivotTable having the Sales Territory attributes Group, Country, and Region, you will see that countries missing a region value will get a placeholder, in this case a repeat of the parent above it (Country name).</span></span> <span data-ttu-id="f0689-115">Такое поведение является производным от свойства строки подключения MDX Compatibility=1, сохраненного в Excel.</span><span class="sxs-lookup"><span data-stu-id="f0689-115">This behavior derives from the MDX Compatibility=1 connection string property that is fixed within Excel.</span></span> <span data-ttu-id="f0689-116">Если в клиентском приложении автоматически не сформировалась та детализация углублением, которую требуется получить, то в модели можно задать свойства, чтобы изменить хотя бы какие-то из этих аспектов.</span><span class="sxs-lookup"><span data-stu-id="f0689-116">If the client does not naturally provide the drill-down behaviors you are looking for, you can set properties in the model to change at least some of those behaviors.</span></span>  
  
 <span data-ttu-id="f0689-117">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="f0689-117">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="f0689-118">Подходы к изменению навигации углубленной детализации в неоднородной иерархии</span><span class="sxs-lookup"><span data-stu-id="f0689-118">Approaches for modifying drilldown navigation in a ragged hierarchy</span></span>](#bkmk_approach)  
  
-   [<span data-ttu-id="f0689-119">Установка HideMemberIf для скрытия элементов в обычной иерархии</span><span class="sxs-lookup"><span data-stu-id="f0689-119">Set HideMemberIf to hide members in a regular hierarchy</span></span>](#bkmk_Hide)  
  
-   [<span data-ttu-id="f0689-120">Задайте совместимость многомерных выражений, чтобы определить, как заполнители представлены в клиентских приложениях.</span><span class="sxs-lookup"><span data-stu-id="f0689-120">Set MDX Compatibility to determine how placeholders are represented in client applications</span></span>](#bkmk_Mdx)  
  
##  <a name="approaches-for-modifying-drilldown-navigation-in-a-ragged-hierarchy"></a><a name="bkmk_approach"></a> <span data-ttu-id="f0689-121">Способы изменения углубленной детализации в неоднородных иерархиях</span><span class="sxs-lookup"><span data-stu-id="f0689-121">Approaches for modifying drilldown navigation in a ragged hierarchy</span></span>  
 <span data-ttu-id="f0689-122">Наличие неоднородной иерархии становится проблемой, когда навигация углубленной детализацией не возвращает нужных значений либо ей просто неудобно пользоваться.</span><span class="sxs-lookup"><span data-stu-id="f0689-122">The presence of a ragged hierarchy becomes a problem when drilldown navigation does not return expected values or is perceived as awkward to use.</span></span> <span data-ttu-id="f0689-123">Чтобы решить проблемы, связанные с неоднородными иерархиями, рассмотрим следующие варианты.</span><span class="sxs-lookup"><span data-stu-id="f0689-123">To fix navigation problems that result from ragged hierarchies, consider these options:</span></span>  
  
-   <span data-ttu-id="f0689-124">Использовать однородную иерархию, для каждого уровня с помощью свойства `HideMemberIf` указав, будет ли отсутствующий уровень отображаться для пользователя.</span><span class="sxs-lookup"><span data-stu-id="f0689-124">Use a regular hierarchy but set the `HideMemberIf` property on each level to specify whether a missing level is visualized to the user.</span></span> <span data-ttu-id="f0689-125">При задании свойства `HideMemberIf` также следует задать свойство `MDXCompatibility` в строке подключения, чтобы переопределить навигацию по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f0689-125">When setting `HideMemberIf`, you should also set `MDXCompatibility` on the connection string to override default navigation behaviors.</span></span> <span data-ttu-id="f0689-126">Инструкции по заданию этих свойств содержатся в данном разделе.</span><span class="sxs-lookup"><span data-stu-id="f0689-126">Instructions for setting these properties are in this topic.</span></span>  
  
-   <span data-ttu-id="f0689-127">Создать иерархию типа «родители-потомки», которая явным образом управляет элементами уровня.</span><span class="sxs-lookup"><span data-stu-id="f0689-127">Create a parent-child hierarchy that explicitly manages the level members.</span></span> <span data-ttu-id="f0689-128">См. иллюстрацию этого метода в разделе [Неоднородная иерархия в службах SSAS (запись блога)](http://dwbi1.wordpress.com/2011/03/30/ragged-hierarchy-in-ssas/).</span><span class="sxs-lookup"><span data-stu-id="f0689-128">For an illustration of the technique, see [Ragged Hierarchy in SSAS (blog post)](http://dwbi1.wordpress.com/2011/03/30/ragged-hierarchy-in-ssas/).</span></span> <span data-ttu-id="f0689-129">Дополнительные сведения в электронной документации по см. в разделе [Иерархия "родители-потомки](parent-child-dimension.md)".</span><span class="sxs-lookup"><span data-stu-id="f0689-129">For more information in Books Online, see [Parent-Child Hierarchy](parent-child-dimension.md).</span></span> <span data-ttu-id="f0689-130">Недостаток создания иерархии типа «родители-потомки» заключается в том, что можно иметь только одну такую иерархию на измерение, и обычно при вычислении агрегатов для промежуточных элементов страдает производительность.</span><span class="sxs-lookup"><span data-stu-id="f0689-130">Downsides to creating a parent-child hierarchy are that you can only have one per dimension, and you typically incur a performance penalty when calculating aggregations for intermediate members.</span></span>  
  
 <span data-ttu-id="f0689-131">Если в измерении есть несколько неоднородных иерархий, следует воспользоваться первым способом, задав свойство `HideMemberIf`.</span><span class="sxs-lookup"><span data-stu-id="f0689-131">If your dimension contains more than one ragged hierarchy, you should use the first approach, setting `HideMemberIf`.</span></span> <span data-ttu-id="f0689-132">Разработчики бизнес-аналитики, имеющие практический опыт работы с неоднородными иерархиями, рекомендуют вносить дополнительные изменения в физические таблицы данных путем создания отдельных таблиц для каждого уровня.</span><span class="sxs-lookup"><span data-stu-id="f0689-132">BI Developers with practical experience in working with ragged hierarchies go further in advocating for additional changes in the physical data tables, creating separate tables for each level.</span></span> <span data-ttu-id="f0689-133">Дополнительные сведения об этой методике см. в статье о [финансовом кубе SSAS. часть 1A – неоднородные иерархии (блог)](http://martinmason.wordpress.com/2012/03/03/the-ssas-financial-cubepart-1aragged-hierarchies-cont/) .</span><span class="sxs-lookup"><span data-stu-id="f0689-133">See [Martin Mason's the SSAS Financial Cube-Part 1a-Ragged Hierarchies (blog)](http://martinmason.wordpress.com/2012/03/03/the-ssas-financial-cubepart-1aragged-hierarchies-cont/) for details about this technique.</span></span>  
  
##  <a name="set-hidememberif-to-hide-members-in-a-regular-hierarchy"></a><a name="bkmk_Hide"></a> <span data-ttu-id="f0689-134">Задание свойства Set HideMemberIf для скрытия элементов в обычной иерархии</span><span class="sxs-lookup"><span data-stu-id="f0689-134">Set HideMemberIf to hide members in a regular hierarchy</span></span>  
 <span data-ttu-id="f0689-135">В таблице переменного измерения логически отсутствующие элементы могут представляться различными способами.</span><span class="sxs-lookup"><span data-stu-id="f0689-135">In a ragged dimension's table, the logically missing members can be represented in different ways.</span></span> <span data-ttu-id="f0689-136">Ячейки таблицы могут содержать правила, пустые строки или значения родительских элементов (когда они служат заполнителями).</span><span class="sxs-lookup"><span data-stu-id="f0689-136">The table cells can contain nulls or empty strings, or they can contain the same value as their parent to serve as a placeholder.</span></span> <span data-ttu-id="f0689-137">Представление заполнителей определяется состоянием заполнителя дочернего элемента, которое задается свойством `HideMemberIf` и свойством строки подключения `MDX Compatibility` для клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="f0689-137">The representation of placeholders is determined by the placeholder status of child members, as determined by the `HideMemberIf` property, and the `MDX Compatibility` connection string property for the client application.</span></span>  
  
 <span data-ttu-id="f0689-138">Для клиентских приложений, поддерживающих отображение неоднородных иерархий, с помощью этих свойств можно скрыть логически отсутствующие элементы.</span><span class="sxs-lookup"><span data-stu-id="f0689-138">For client applications that support the display of ragged hierarchies, you can use these properties to hide logically missing members.</span></span>  
  
1.  <span data-ttu-id="f0689-139">В SSDT дважды щелкните измерение, чтобы открыть его в конструкторе измерений.</span><span class="sxs-lookup"><span data-stu-id="f0689-139">In SSDT, double-click a dimension to open it in Dimension Designer.</span></span> <span data-ttu-id="f0689-140">На первой вкладке «Структура измерения» на панели «Иерархии» отображается иерархия атрибутов.</span><span class="sxs-lookup"><span data-stu-id="f0689-140">The first tab, Dimension Structure, shows attribute hierarchies in the Hierarchies pane.</span></span>  
  
2.  <span data-ttu-id="f0689-141">Щелкните правой кнопкой мыши элемент в иерархии и выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="f0689-141">Right-click a member within the hierarchy and select **Properties**.</span></span> <span data-ttu-id="f0689-142">Установите свойство `HideMemberIf` в одно из описанных далее значений.</span><span class="sxs-lookup"><span data-stu-id="f0689-142">Set `HideMemberIf` to one of the values described below.</span></span>  
  
    |<span data-ttu-id="f0689-143">Значение свойства HideMemberIf</span><span class="sxs-lookup"><span data-stu-id="f0689-143">HideMemberIf Setting</span></span>|<span data-ttu-id="f0689-144">Описание</span><span class="sxs-lookup"><span data-stu-id="f0689-144">Description</span></span>|  
    |--------------------------|-----------------|  
    |`Never`|<span data-ttu-id="f0689-145">Элементы уровня никогда не скрываются.</span><span class="sxs-lookup"><span data-stu-id="f0689-145">Level members are never hidden.</span></span> <span data-ttu-id="f0689-146">Это значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f0689-146">This is the default value.</span></span>|  
    |<span data-ttu-id="f0689-147">**OnlyChildWithNoName**</span><span class="sxs-lookup"><span data-stu-id="f0689-147">**OnlyChildWithNoName**</span></span>|<span data-ttu-id="f0689-148">Элемент уровня скрывается, только когда он является единственным дочерним элементом и его имя не задано (значение NULL или пустая строка).</span><span class="sxs-lookup"><span data-stu-id="f0689-148">A level member is hidden when it is the only child of its parent and its name is null or an empty string.</span></span>|  
    |<span data-ttu-id="f0689-149">**OnlyChildWithParentName**</span><span class="sxs-lookup"><span data-stu-id="f0689-149">**OnlyChildWithParentName**</span></span>|<span data-ttu-id="f0689-150">Элемент уровня скрывается, только когда он является единственным дочерним элементом и его имя совпадает с именем родительского элемента.</span><span class="sxs-lookup"><span data-stu-id="f0689-150">A level member is hidden when it is the only child of its parent and its name is the same as the name of its parent.</span></span>|  
    |<span data-ttu-id="f0689-151">**NoName**</span><span class="sxs-lookup"><span data-stu-id="f0689-151">**NoName**</span></span>|<span data-ttu-id="f0689-152">Элемент уровня скрывается, если его имя пустое.</span><span class="sxs-lookup"><span data-stu-id="f0689-152">A level member is hidden when its name is empty.</span></span>|  
    |<span data-ttu-id="f0689-153">**ParentName**</span><span class="sxs-lookup"><span data-stu-id="f0689-153">**ParentName**</span></span>|<span data-ttu-id="f0689-154">Элемент уровня скрывается, если его имя совпадает с именем родительского элемента.</span><span class="sxs-lookup"><span data-stu-id="f0689-154">A level member is hidden when its name is identical to that of its parent.</span></span>|  
  
##  <a name="set-mdx-compatibility-to-determine-how-placeholders-are-represented-in-client-applications"></a><a name="bkmk_Mdx"></a><span data-ttu-id="f0689-155">Настройка совместимости многомерных выражений для определения того, как заполнители представлены в клиентских приложениях</span><span class="sxs-lookup"><span data-stu-id="f0689-155">Set MDX Compatibility to determine how placeholders are represented in client applications</span></span>  
 <span data-ttu-id="f0689-156">После задания свойства `HideMemberIf` на уровне иерархии также необходимо задать свойство `MDX Compatibility` в строке подключения, которая передается из клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="f0689-156">After setting `HideMemberIf` on a hierarchy level, you should also set the `MDX Compatibility` property in the connection string sent from the client application.</span></span> <span data-ttu-id="f0689-157">Значение свойства `MDX Compatibility` определяет, будет ли использоваться свойство `HideMemberIf`.</span><span class="sxs-lookup"><span data-stu-id="f0689-157">The `MDX Compatibility` setting determines whether the `HideMemberIf` is used.</span></span>  
  
|<span data-ttu-id="f0689-158">Задание свойства MDX Compatibility</span><span class="sxs-lookup"><span data-stu-id="f0689-158">MDX Compatibility Setting</span></span>|<span data-ttu-id="f0689-159">Описание</span><span class="sxs-lookup"><span data-stu-id="f0689-159">Description</span></span>|<span data-ttu-id="f0689-160">Использование</span><span class="sxs-lookup"><span data-stu-id="f0689-160">Usage</span></span>|  
|-------------------------------|-----------------|-----------|  
|<span data-ttu-id="f0689-161">**1**</span><span class="sxs-lookup"><span data-stu-id="f0689-161">**1**</span></span>|<span data-ttu-id="f0689-162">Показать значение заполнителя.</span><span class="sxs-lookup"><span data-stu-id="f0689-162">Show a placeholder value.</span></span>|<span data-ttu-id="f0689-163">Это значение по умолчанию, которое используют Excel, SSDT и SSMS.</span><span class="sxs-lookup"><span data-stu-id="f0689-163">This is the default used by Excel, SSDT, and SSMS.</span></span> <span data-ttu-id="f0689-164">Оно указывает серверу возвращать значения заполнителей при детализации углублением пустых уровней в неоднородной иерархии.</span><span class="sxs-lookup"><span data-stu-id="f0689-164">It instructs the server to return placeholder values when drilling down empty levels in a ragged hierarchy.</span></span> <span data-ttu-id="f0689-165">Если щелкнуть значение заполнителя, то детализацию углублением можно будет продолжить вплоть до дочерних (конечных) узлов.</span><span class="sxs-lookup"><span data-stu-id="f0689-165">If you click the placeholder value, you can continue down to get to the child (leaf) nodes.</span></span><br /><br /> <span data-ttu-id="f0689-166">В Excel задается строка подключения к службам Analysis Services. В ней для каждого нового подключения свойство `MDX Compatibility` всегда устанавливается в значение 1.</span><span class="sxs-lookup"><span data-stu-id="f0689-166">Excel owns the connection string used to connect to Analysis Services, and it always sets `MDX Compatibility` to 1 on each new connection.</span></span> <span data-ttu-id="f0689-167">Это сделано для обеспечения обратной совместимости.</span><span class="sxs-lookup"><span data-stu-id="f0689-167">This behavior preserves backward compatibility.</span></span>|  
|<span data-ttu-id="f0689-168">**2**</span><span class="sxs-lookup"><span data-stu-id="f0689-168">**2**</span></span>|<span data-ttu-id="f0689-169">Скрыть значение заполнителя (значение NULL или копия значения с родительского уровня), но показывать другие уровни и узлы, имеющие соответствующие значения.</span><span class="sxs-lookup"><span data-stu-id="f0689-169">Hide a placeholder value (either a null value or a duplicate of the parent level), but show other levels and nodes having relevant values.</span></span>|<span data-ttu-id="f0689-170">Для неоднородных иерархий обычно предпочтительнее указывать `MDX Compatibility`=2.</span><span class="sxs-lookup"><span data-stu-id="f0689-170">`MDX Compatibility`=2 is typically viewed as the preferred setting in terms of ragged hierarchies.</span></span> <span data-ttu-id="f0689-171">Отчет служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и некоторые сторонние приложения могут сохранять это значение.</span><span class="sxs-lookup"><span data-stu-id="f0689-171">A [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] report and some third-party client applications can persist this setting.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="f0689-172">См. также:</span><span class="sxs-lookup"><span data-stu-id="f0689-172">See Also</span></span>  
 <span data-ttu-id="f0689-173">[Создание определяемых пользователем иерархий](user-defined-hierarchies-create.md) </span><span class="sxs-lookup"><span data-stu-id="f0689-173">[Create User-Defined Hierarchies](user-defined-hierarchies-create.md) </span></span>  
 <span data-ttu-id="f0689-174">[Пользовательские иерархии](../multidimensional-models-olap-logical-dimension-objects/user-hierarchies.md) </span><span class="sxs-lookup"><span data-stu-id="f0689-174">[User Hierarchies](../multidimensional-models-olap-logical-dimension-objects/user-hierarchies.md) </span></span>  
 <span data-ttu-id="f0689-175">[Иерархия "родители-потомки"](parent-child-dimension.md) </span><span class="sxs-lookup"><span data-stu-id="f0689-175">[Parent-Child Hierarchy](parent-child-dimension.md) </span></span>  
 [<span data-ttu-id="f0689-176">Свойства строки подключения (службы Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="f0689-176">Connection String Properties &#40;Analysis Services&#41;</span></span>](https://docs.microsoft.com/analysis-services/instances/connection-string-properties-analysis-services)  
  
  
