---
title: Требования к архитектуре клиента для разработки Analysis Services | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- local mining models [Analysis Services]
- Analysis Services, architecture
- providers [Analysis Services]
- data pumps [Analysis Services]
- client architecture [Analysis Services]
- local cubes [Analysis Services]
ms.assetid: 03a8eb6b-159f-4a0a-afbe-06a2424b6090
author: minewiskan
ms.author: owend
ms.openlocfilehash: d1dae97cc76eb09ce0ac4ef9d61d571a6d10c1bc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666811"
---
# <a name="client-architecture-requirements-for-analysis-services-development"></a><span data-ttu-id="ce124-102">Требования к архитектуре клиента для разработки служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ce124-102">Client Architecture Requirements for Analysis Services Development</span></span>
  [!INCLUDE[msCoName](../../../includes/msconame-md.md)]<span data-ttu-id="ce124-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] поддерживает архитектуру с тонким клиентом.</span><span class="sxs-lookup"><span data-stu-id="ce124-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] supports a thin-client architecture.</span></span> <span data-ttu-id="ce124-104">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]Подсистема вычислений полностью основана на сервере, поэтому все запросы разрешаются на сервере.</span><span class="sxs-lookup"><span data-stu-id="ce124-104">The [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] calculation engine is entirely server-based, so all queries are resolved on the server.</span></span> <span data-ttu-id="ce124-105">В результате для каждого запроса требуется только одно перемещение данных от клиента к серверу и обратно, что позволяет масштабировать производительность по мере роста сложности запросов.</span><span class="sxs-lookup"><span data-stu-id="ce124-105">As a result, only a single round trip between the client and the server is required for each query, resulting in scalable performance as queries increase in complexity.</span></span>

 <span data-ttu-id="ce124-106">Собственный протокол [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] — это XML для аналитики (XML/A).</span><span class="sxs-lookup"><span data-stu-id="ce124-106">The native protocol for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] is XML for Analysis (XML/A).</span></span> [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="ce124-107">содержит несколько интерфейсов доступа для клиентских приложений, но все эти компоненты взаимодействуют с экземпляром [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] с использованием XML для аналитики.</span><span class="sxs-lookup"><span data-stu-id="ce124-107">provides several data access interfaces for client applications, but all of these components communicate with an instance of [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] using XML for Analysis.</span></span>

 <span data-ttu-id="ce124-108">В службы [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] входят несколько различных поставщиков для поддержки различных языков программирования.</span><span class="sxs-lookup"><span data-stu-id="ce124-108">Several different providers are provided with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] to support different programming languages.</span></span> <span data-ttu-id="ce124-109">Поставщик обменивается данными с сервером служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)], отправляя и принимая данные XML для аналитики в пакетах SOAP по протоколу TCP/IP или HTTP через службы IIS.</span><span class="sxs-lookup"><span data-stu-id="ce124-109">A provider communicates with an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server by sending and receiving XML for Analysis in SOAP packets over TCP/IP or over HTTP through Internet Information Services (IIS).</span></span> <span data-ttu-id="ce124-110">HTTP-сеанс использует СОМ-объект, экземпляр которого создается службами IIS и который называется средством переноса данных. Этот объект действует в качестве канала для данных служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ce124-110">An HTTP connection uses a COM object instantiated by IIS, called a data pump, which acts as a conduit for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="ce124-111">Средство переноса данных никак не просматривает базовые данные, которые содержатся в HTTP-потоке, и никакие структуры базовых данных не доступны никакому коду в самой библиотеке данных.</span><span class="sxs-lookup"><span data-stu-id="ce124-111">The data pump does not examine the underlying data contained in the HTTP stream in any way, nor are any of the underlying data structures available to any of the code in the data library itself.</span></span>

 <span data-ttu-id="ce124-112">![Архитектура логического клиента для Analysis Services](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Архитектура логического клиента для Analysis Services")</span><span class="sxs-lookup"><span data-stu-id="ce124-112">![Logical client architecture for Analysis Services](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Logical client architecture for Analysis Services")</span></span>

 <span data-ttu-id="ce124-113">Клиентские приложения Win32 могут подключаться к серверу служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] с помощью интерфейсов OLE DB для OLAP объектной модели Microsoft® ActiveX® (ADO) для языков автоматизации модели СОМ, например Microsoft Visual Basic®.</span><span class="sxs-lookup"><span data-stu-id="ce124-113">Win32 client applications can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using OLE DB for OLAP interfaces or the Microsoft® ActiveX® Data Objects (ADO) object model for Component Object Model (COM) automation languages, such as Microsoft Visual Basic®.</span></span> <span data-ttu-id="ce124-114">Приложения, написанные на языках платформы .NET, могут подключаться к серверу служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] с помощью ADOMD.NET.</span><span class="sxs-lookup"><span data-stu-id="ce124-114">Applications coded with .NET languages can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using ADOMD.NET.</span></span>

 <span data-ttu-id="ce124-115">Существующие приложения могут сообщаться со службами [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] без изменений, просто используя один из поставщиков служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ce124-115">Existing applications can communicate with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without modification simply by using one of the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] providers.</span></span>

|<span data-ttu-id="ce124-116">Язык программирования</span><span class="sxs-lookup"><span data-stu-id="ce124-116">Programming Language</span></span>|<span data-ttu-id="ce124-117">Интерфейс доступа к данным</span><span class="sxs-lookup"><span data-stu-id="ce124-117">Data Access Interface</span></span>|
|--------------------------|---------------------------|
|<span data-ttu-id="ce124-118">C++</span><span class="sxs-lookup"><span data-stu-id="ce124-118">C++</span></span>|<span data-ttu-id="ce124-119">OLE DB для OLAP</span><span class="sxs-lookup"><span data-stu-id="ce124-119">OLE DB for OLAP</span></span>|
|<span data-ttu-id="ce124-120">Visual Basic 6</span><span class="sxs-lookup"><span data-stu-id="ce124-120">Visual Basic 6</span></span>|<span data-ttu-id="ce124-121">ADO MD</span><span class="sxs-lookup"><span data-stu-id="ce124-121">ADO MD</span></span>|
|<span data-ttu-id="ce124-122">Языки платформы .NET</span><span class="sxs-lookup"><span data-stu-id="ce124-122">.NET languages</span></span>|<span data-ttu-id="ce124-123">ADO MD.NET</span><span class="sxs-lookup"><span data-stu-id="ce124-123">ADO MD.NET</span></span>|
|<span data-ttu-id="ce124-124">Любой язык с поддержкой SOAP</span><span class="sxs-lookup"><span data-stu-id="ce124-124">Any language that supports SOAP</span></span>|<span data-ttu-id="ce124-125">XML для аналитики</span><span class="sxs-lookup"><span data-stu-id="ce124-125">XML for Analysis</span></span>|

 <span data-ttu-id="ce124-126">Службы [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] отличаются веб-архитектурой с полностью масштабируемым средним уровнем для развертывания как в больших, так и в малых организациях.</span><span class="sxs-lookup"><span data-stu-id="ce124-126">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] has a Web architecture with a fully scalable middle tier for deployment by both small and large organizations.</span></span> <span data-ttu-id="ce124-127">Службы [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] предоставляют широкий спектр средств поддержки среднего уровня для веб-служб.</span><span class="sxs-lookup"><span data-stu-id="ce124-127">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] provides broad middle tier support for Web services.</span></span> <span data-ttu-id="ce124-128">Поддержка приложений ASP реализована в OLE DB для OLAP, а приложений ADO MD, ASP.NET — в ADOMD.NET.</span><span class="sxs-lookup"><span data-stu-id="ce124-128">ASP applications are supported by OLE DB for OLAP and ADO MD, ASP.NET applications are supported by ADOMD.NET.</span></span> <span data-ttu-id="ce124-129">Средний уровень, проиллюстрированный на приведенном ниже рисунке, масштабируется для одновременной поддержки большого количества пользователей.</span><span class="sxs-lookup"><span data-stu-id="ce124-129">The middle tier, illustrated in the following figure, is scalable to many concurrent users.</span></span>

 <span data-ttu-id="ce124-130">![Логическая диаграмма архитектуры среднего уровня](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "Логическая диаграмма архитектуры среднего уровня")</span><span class="sxs-lookup"><span data-stu-id="ce124-130">![Logical diagram for middle-tier architecture](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "Logical diagram for middle-tier architecture")</span></span>

 <span data-ttu-id="ce124-131">И клиентские приложения, и приложения промежуточного уровня могут непосредственно связываться со службами [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] без использования поставщика.</span><span class="sxs-lookup"><span data-stu-id="ce124-131">Both client and middle tier applications can communicate directly with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without using a provider.</span></span> <span data-ttu-id="ce124-132">Клиентские приложения и приложения промежуточного уровня могут отправлять данные XML для аналитики в SOAP-пакетах по протоколам TCP/IP, HTTP или HTTPS.</span><span class="sxs-lookup"><span data-stu-id="ce124-132">Client and middle tier applications may send XML for Analysis in SOAP packets over TCP/IP, HTTP, or HTTPS.</span></span> <span data-ttu-id="ce124-133">Клиент может быть написан на любом языке, поддерживающем SOAP.</span><span class="sxs-lookup"><span data-stu-id="ce124-133">The client may be coded using any language that supports SOAP.</span></span> <span data-ttu-id="ce124-134">В этом случае сообщением проще всего управлять посредством служб IIS, используя протокол HTTP, хотя также можно запрограммировать прямое соединение с сервером по протоколу TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="ce124-134">Communication in this case is most easily managed by Internet Information Services (IIS) using HTTP, although a direct connection to the server using TCP/IP may also be coded.</span></span> <span data-ttu-id="ce124-135">Это наиболее тонкое из возможных клиентских решений для служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ce124-135">This is the thinnest possible client solution for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span></span>

## <a name="analysis-services-in-tabular-or-sharepoint-mode"></a><span data-ttu-id="ce124-136">Службы Analysis Services в табличном режиме или режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ce124-136">Analysis Services in Tabular or SharePoint Mode</span></span>
 <span data-ttu-id="ce124-137">В [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] сервер может быть запущен в режиме подсистемы VertiPaq аналитики в памяти xVelocity для табличных баз данных и для книг [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)], опубликованных на сайте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ce124-137">In [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], the server can be started in xVelocity in-memory analytics engine (VertiPaq) mode for tabular databases and for [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbooks that have been published to a SharePoint site.</span></span>

 [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] <span data-ttu-id="ce124-138">и [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] — единственные клиентские среды, которые поддерживаются при создании размещенных в памяти баз данных, использующих режим SharePoint или табличный режим соответственно.</span><span class="sxs-lookup"><span data-stu-id="ce124-138">and [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] are the only client environments that are supported for creating and querying in-memory databases that use SharePoint or Tabular mode, respectively.</span></span> <span data-ttu-id="ce124-139">Внедренная база данных PowerPivot, созданная с помощью Excel и [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] средств, содержится в книге Excel и сохраняется как часть файла Excel. xlsx.</span><span class="sxs-lookup"><span data-stu-id="ce124-139">The embedded PowerPivot database that you create by using the Excel and [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] tools is contained within the Excel workbook, and is saved as part of the Excel .xlsx file.</span></span>

 <span data-ttu-id="ce124-140">Однако в книге [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] могут использоваться данные, которые хранятся в традиционном кубе, если данные куба импортированы в книгу.</span><span class="sxs-lookup"><span data-stu-id="ce124-140">However, a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook can use data that is stored in a traditional cube if you import the cube data into the workbook.</span></span> <span data-ttu-id="ce124-141">Кроме того, можно импортировать данные из другой книги [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)], если она была опубликована на сайте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ce124-141">You can also import data from another [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook if it has been published to a SharePoint site.</span></span>

> [!NOTE]
>  <span data-ttu-id="ce124-142">При использовании куба в качестве источника данных для книги [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] получаемые из куба данные определяются как запрос многомерного выражения, но при этом данные импортируются как плоский моментальный снимок.</span><span class="sxs-lookup"><span data-stu-id="ce124-142">When you use a cube as a data source for a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook, the data that you get from the cube is defined as an MDX query; however, the data is imported as a flattened snapshot.</span></span> <span data-ttu-id="ce124-143">Нельзя ни работать с данными в интерактивном режиме, ни обновлять их из куба.</span><span class="sxs-lookup"><span data-stu-id="ce124-143">You cannot interactively work with the data or refresh the data from the cube.</span></span>

### <a name="interfaces-for-powerpivot-client"></a><span data-ttu-id="ce124-144">Интерфейсы для клиента PowerPivot</span><span class="sxs-lookup"><span data-stu-id="ce124-144">Interfaces for PowerPivot Client</span></span>
 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)]<span data-ttu-id="ce124-145">взаимодействует с подсистемой хранилища подсистемы аналитики в памяти xVelocity (VertiPaq) в книге, используя установленные интерфейсы и языки для Analysis Services: AMO и ADOMD.NET, а также многомерные выражения и XMLA.</span><span class="sxs-lookup"><span data-stu-id="ce124-145">interacts with the xVelocity in-memory analytics engine (VertiPaq) storage engine within the workbook by using the established interfaces and languages for Analysis Services: AMO and ADOMD.NET, and MDX and XMLA.</span></span> <span data-ttu-id="ce124-146">В надстройке меры определяются с помощью языка формул, аналогичного языку формул Excel и DAX (выражения анализа данных).</span><span class="sxs-lookup"><span data-stu-id="ce124-146">Within the add-in, measures are defined by using a formula language similar to Excel, Data Analysis Expressions (DAX).</span></span> <span data-ttu-id="ce124-147">Выражения анализа данных внедряются в сообщения XMLA, отправляемые внутрипроцессному серверу.</span><span class="sxs-lookup"><span data-stu-id="ce124-147">DAX expressions are embedded within the XMLA messages that are sent to the in-process server.</span></span>

### <a name="providers"></a><span data-ttu-id="ce124-148">Поставщики</span><span class="sxs-lookup"><span data-stu-id="ce124-148">Providers</span></span>
 <span data-ttu-id="ce124-149">При обмене данными между [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] и Excel используется поставщик MSOLAP OLEDB (версия 11,0).</span><span class="sxs-lookup"><span data-stu-id="ce124-149">Communications between [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] and Excel use the MSOLAP OLEDB provider (version 11.0).</span></span> <span data-ttu-id="ce124-150">В поставщике MSOLAP имеется четыре модуля (также называемых транспортами), которые можно использовать для пересылки сообщений между клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="ce124-150">Within the MSOLAP provider, there are four different modules, or transports, that can be used for sending messages between the client and server.</span></span>

 <span data-ttu-id="ce124-151">**протокол TCP/IP** Используется для обычных подключений "клиент-сервер".</span><span class="sxs-lookup"><span data-stu-id="ce124-151">**TCP/IP** Used for normal client-server connections.</span></span>

 <span data-ttu-id="ce124-152">**Протокол HTTP** Используется для HTTP-соединений через службу обработки данных SSAS или путем вызова компонента SharePoint Web Service (WS).</span><span class="sxs-lookup"><span data-stu-id="ce124-152">**HTTP** Used for HTTP connections via the SSAS data pump service, or by a call to the SharePoint PowerPivot Web Service (WS) component.</span></span>

 <span data-ttu-id="ce124-153">**INPROC** Используется для соединений с внутрипроцессный подсистемой.</span><span class="sxs-lookup"><span data-stu-id="ce124-153">**INPROC** Used for connections to the in-process engine.</span></span>

 <span data-ttu-id="ce124-154">**Канал** связи Зарезервировано для обмена данными с системная служба PowerPivot в ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ce124-154">**CHANNEL** Reserved for communications with the PowerPivot System Service in the SharePoint farm.</span></span>

## <a name="see-also"></a><span data-ttu-id="ce124-155">См. также:</span><span class="sxs-lookup"><span data-stu-id="ce124-155">See Also</span></span>
 [<span data-ttu-id="ce124-156">Серверные компоненты ядра OLAP</span><span class="sxs-lookup"><span data-stu-id="ce124-156">OLAP Engine Server Components</span></span>](olap-engine-server-components.md)


