---
title: Создание вычислений ячеек с областью действия запроса (многомерные выражения) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- WITH keyword
- query-scoped cell calculations [MDX]
ms.assetid: 45987daa-4400-41e9-add7-2428fd75709b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5a9c9d529bfeb26b959b2521e4ce3c3d7f10d082
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750291"
---
# <a name="creating-query-scoped-cell-calculations-mdx"></a><span data-ttu-id="3c2af-102">Создание вычислений ячеек с областью действия запроса (многомерные выражения)</span><span class="sxs-lookup"><span data-stu-id="3c2af-102">Creating Query-Scoped Cell Calculations (MDX)</span></span>
  <span data-ttu-id="3c2af-103">Ключевое слово `WITH` в многомерном выражении описывает вычисляемые ячейки в контексте запроса.</span><span class="sxs-lookup"><span data-stu-id="3c2af-103">You use the `WITH` keyword in Multidimensional Expressions (MDX) to describe calculated cells within the context of a query.</span></span> <span data-ttu-id="3c2af-104">Синтаксис ключевого слова `WITH` имеет следующий вид:</span><span class="sxs-lookup"><span data-stu-id="3c2af-104">The `WITH` keyword has the following syntax:</span></span>  
  
```  
WITH CELL CALCULATION Cube_Name.CellCalc_Identifier  String_Expression  
```  
  
 <span data-ttu-id="3c2af-105">Значение `CellCalc_Identifier` — это имя вычисляемых ячеек.</span><span class="sxs-lookup"><span data-stu-id="3c2af-105">The `CellCalc_Identifier` value is the name of the calculated cells.</span></span> <span data-ttu-id="3c2af-106">Значение `String_Expression` — это перечень ортогональных одномерных выражений набора многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="3c2af-106">The `String_Expression` value contains a list of orthogonal, single-dimensional MDX set expressions.</span></span> <span data-ttu-id="3c2af-107">Каждое выражение набора должно разрешаться к одной из перечисленных ниже категорий.</span><span class="sxs-lookup"><span data-stu-id="3c2af-107">Each of these set expressions must resolve to one of the categories listed in the following table.</span></span>  
  
|<span data-ttu-id="3c2af-108">Категория</span><span class="sxs-lookup"><span data-stu-id="3c2af-108">Category</span></span>|<span data-ttu-id="3c2af-109">Описание</span><span class="sxs-lookup"><span data-stu-id="3c2af-109">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="3c2af-110">Пустой набор</span><span class="sxs-lookup"><span data-stu-id="3c2af-110">Empty set</span></span>|<span data-ttu-id="3c2af-111">Выражение набора многомерных выражений, которое разрешается к пустому набору.</span><span class="sxs-lookup"><span data-stu-id="3c2af-111">An MDX set expression that resolves into an empty set.</span></span> <span data-ttu-id="3c2af-112">В этом случае областью вычисляемой ячейки является весь куб.</span><span class="sxs-lookup"><span data-stu-id="3c2af-112">In this case, the scope of the calculated cell is the whole cube.</span></span>|  
|<span data-ttu-id="3c2af-113">Одноэлементный набор</span><span class="sxs-lookup"><span data-stu-id="3c2af-113">Single member set</span></span>|<span data-ttu-id="3c2af-114">Выражение набора многомерных выражений, которое разрешается к единственному элементу.</span><span class="sxs-lookup"><span data-stu-id="3c2af-114">An MDX set expression that resolves into a single member.</span></span>|  
|<span data-ttu-id="3c2af-115">Набор элементов уровня</span><span class="sxs-lookup"><span data-stu-id="3c2af-115">Set of level members</span></span>|<span data-ttu-id="3c2af-116">Выражение набора многомерных выражений, которое разрешается к элементам одного уровня.</span><span class="sxs-lookup"><span data-stu-id="3c2af-116">An MDX set expression that resolves into the members of a single level.</span></span> <span data-ttu-id="3c2af-117">Примером такого выражения набора является *Level_Expression*.`Members`</span><span class="sxs-lookup"><span data-stu-id="3c2af-117">An example of such a set expression is the *Level_Expression*.`Members`</span></span> <span data-ttu-id="3c2af-118">Функция многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="3c2af-118">MDX function.</span></span> <span data-ttu-id="3c2af-119">Чтобы включить вычисляемые элементы, используйте *Level_Expression*.`AllMembers`</span><span class="sxs-lookup"><span data-stu-id="3c2af-119">To include calculated members, use the *Level_Expression*.`AllMembers`</span></span> <span data-ttu-id="3c2af-120">Функция многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="3c2af-120">MDX function.</span></span> <span data-ttu-id="3c2af-121">Дополнительные сведения см. в разделе [AllMembers (многомерные выражения)](/sql/mdx/allmembers-mdx).</span><span class="sxs-lookup"><span data-stu-id="3c2af-121">For more information, see [AllMembers &#40;MDX&#41;](/sql/mdx/allmembers-mdx).</span></span>|  
|<span data-ttu-id="3c2af-122">Набор потомков</span><span class="sxs-lookup"><span data-stu-id="3c2af-122">Set of descendants</span></span>|<span data-ttu-id="3c2af-123">Выражение набора многомерных выражений, которое разрешается к потомкам одного элемента.</span><span class="sxs-lookup"><span data-stu-id="3c2af-123">An MDX set expression that resolves into the descendants of a specified member.</span></span> <span data-ttu-id="3c2af-124">Примером такого выражения набора является `Descendants` функция многомерных выражений (*Member_Expression*, *Level_Expresion*, *Desc_Flag*).</span><span class="sxs-lookup"><span data-stu-id="3c2af-124">An example of such a set expression is the `Descendants`(*Member_Expression*, *Level_Expresion*, *Desc_Flag*) MDX function.</span></span> <span data-ttu-id="3c2af-125">Дополнительные сведения см. в разделе [Descendants (многомерные выражения)](/sql/mdx/descendants-mdx).</span><span class="sxs-lookup"><span data-stu-id="3c2af-125">For more information, see [Descendants &#40;MDX&#41;](/sql/mdx/descendants-mdx).</span></span>|  
  
 <span data-ttu-id="3c2af-126">Если аргумент `String_Expression` не описывает измерение, считается, что в набор включаются все элементы с целью создания вложенного куба вычисления.</span><span class="sxs-lookup"><span data-stu-id="3c2af-126">If the `String_Expression` argument does not describe a dimension, MDX assumes that all members are included for the purposes of constructing the calculation subcube.</span></span> <span data-ttu-id="3c2af-127">Поэтому, если аргумент `String_Expression` имеет значение NULL, определение вычисляемых ячеек относится ко всему кубу.</span><span class="sxs-lookup"><span data-stu-id="3c2af-127">Therefore, if the `String_Expression` argument is NULL, the calculated cells definition applies to the whole cube.</span></span>  
  
 <span data-ttu-id="3c2af-128">Аргумент `MDX_Expression` содержит многомерное выражение, из которого вычисляется значение ячейки для всех ячеек, определенных аргументом `String_Expression` .</span><span class="sxs-lookup"><span data-stu-id="3c2af-128">The `MDX_Expression` argument contains an MDX expression that evaluates to a cell value for all the cells defined in the `String_Expression` argument.</span></span>  
  
## <a name="additional-considerations"></a><span data-ttu-id="3c2af-129">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="3c2af-129">Additional Considerations</span></span>  
 <span data-ttu-id="3c2af-130">В многомерных выражениях условие вычисления, заданное свойством `CONDITION`, обрабатывается только один раз.</span><span class="sxs-lookup"><span data-stu-id="3c2af-130">MDX processes the calculation condition, specified by the `CONDITION` property, only once.</span></span> <span data-ttu-id="3c2af-131">Однократная обработка позволяет повысить производительность при расчете нескольких определений вычисляемых ячеек, особенно если вычисляемые ячейки перекрываются на различных этапах обработки куба.</span><span class="sxs-lookup"><span data-stu-id="3c2af-131">This single processing provides increased performance for the evaluation of multiple calculated cells definitions, especially with overlapping calculated cells across cube passes.</span></span>  
  
 <span data-ttu-id="3c2af-132">Время выполнения этой единственной обработки зависит от области определения вычисляемых ячеек, заданной при создании определения.</span><span class="sxs-lookup"><span data-stu-id="3c2af-132">When this single processing occurs depends on the creation scope of the calculated cells definition:</span></span>  
  
-   <span data-ttu-id="3c2af-133">Если определение было создано в глобальной области как часть куба, многомерное выражение обрабатывает условие вычисления при обработке куба.</span><span class="sxs-lookup"><span data-stu-id="3c2af-133">If created at global scope, as part of a cube, MDX process the calculation condition when the cube is processed.</span></span> <span data-ttu-id="3c2af-134">Если ячейки каким-либо образом изменяются внутри куба, и если они включены во вложенный куб вычисления в определении вычисляемых ячеек, условие вычисления может оставаться неточным до повторной обработки куба.</span><span class="sxs-lookup"><span data-stu-id="3c2af-134">If cells are modified in the cube in any way, and the cells are included in the calculation subcube of a calculated cells definition, the calculation condition may not be accurate until the cube is reprocessed.</span></span> <span data-ttu-id="3c2af-135">Например, ячейки могут изменяться при обратной записи.</span><span class="sxs-lookup"><span data-stu-id="3c2af-135">Cell modification can occur from writebacks, for example.</span></span> <span data-ttu-id="3c2af-136">Условие вычисления обрабатывается повторно при повторной обработке куба.</span><span class="sxs-lookup"><span data-stu-id="3c2af-136">The calculation condition is reprocessed when the cube is reprocessed.</span></span>  
  
-   <span data-ttu-id="3c2af-137">Если определение было создано в области сеанса, многомерное выражение обрабатывает условие вычисления при получении инструкции в течение сеанса.</span><span class="sxs-lookup"><span data-stu-id="3c2af-137">If created at session scope, MDX process the calculation condition when the statement is issued during the session.</span></span> <span data-ttu-id="3c2af-138">Как и в случае определения вычисляемых ячеек в глобальном контексте, при изменении ячеек условие вычисления может стать неточным для определения выбранных ячеек.</span><span class="sxs-lookup"><span data-stu-id="3c2af-138">As with calculated cells definitions created globally, if the cells are modified, the calculation condition may not be accurate for the calculated cells definition.</span></span>  
  
-   <span data-ttu-id="3c2af-139">Если условие вычисления создано в области сеанса, многомерное выражение обрабатывает его при выполнении запроса.</span><span class="sxs-lookup"><span data-stu-id="3c2af-139">If created at query scope, MDX processes the calculation condition when the query runs.</span></span> <span data-ttu-id="3c2af-140">В этом случае также действует условие изменения ячеек, хотя проблемы задержки данных минимальны благодаря малому времени обработки при выполнении запроса многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="3c2af-140">The cell modification issue applies here, also, although data latency issues are minimal because of the low processing time of MDX query execution.</span></span>  
  
 <span data-ttu-id="3c2af-141">С другой стороны, многомерное выражение обрабатывает формулу вычисления всякий раз, когда в кубе выполняется запрос многомерных выражений, работающий с ячейками, входящими в определение вычисляемых ячеек.</span><span class="sxs-lookup"><span data-stu-id="3c2af-141">On the other hand, MDX processes the calculation formula whenever an MDX query is issued against the cube involving cells included in the calculated cells definition.</span></span> <span data-ttu-id="3c2af-142">Такая обработка выполняется независимо от области при создании определения.</span><span class="sxs-lookup"><span data-stu-id="3c2af-142">This processing occurs regardless of the creation scope.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3c2af-143">См. также:</span><span class="sxs-lookup"><span data-stu-id="3c2af-143">See Also</span></span>  
 [<span data-ttu-id="3c2af-144">Инструкция CREATE CELL CALCULATION (многомерные выражения)</span><span class="sxs-lookup"><span data-stu-id="3c2af-144">CREATE CELL CALCULATION Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-cell-calculation)  
  
  
