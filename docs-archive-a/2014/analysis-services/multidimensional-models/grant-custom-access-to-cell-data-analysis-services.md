---
title: Предоставление настраиваемого доступа к данным ячейки (Analysis Services) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
f1_keywords:
- sql12.asvs.roledesignerdialog.celldata.f1
helpviewer_keywords:
- user access rights [Analysis Services], cell data
- permissions [Analysis Services], cells
- read contingent permissions
- read permissions
- cells [Analysis Services]
- custom cell data access [Analysis Services]
ms.assetid: 3b13a4ae-f3df-4523-bd30-b3fdf71e95cf
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9ac8113348a749837867a6dacba7fa23fb5e85f2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87727425"
---
# <a name="grant-custom-access-to-cell-data-analysis-services"></a>Предоставление настраиваемого доступа к данным ячейки (службы Analysis Services)
  Настройка безопасности ячеек используется для предоставления доступа или отказа в доступе с целью распределения данных в кубе. Следующая иллюстрация демонстрирует комбинацию разрешенных и запрещенных мер в Сводной Таблице при подключении в качестве пользователя, роль которого предоставляет доступ только к определенным мерам. В этом примере используемой роли доступны только меры **Объем продаж торгового посредника** и **Совокупная стоимость продуктов торгового посредника** . Все остальные меры безоговорочно запрещены (шаги, используемые для достижения данного результата, приведены ниже в следующем разделе, Предоставление доступа к специальным мерам).  
  
 ![Сводная таблица, которая показывает доступные и запрещенные ячейки](../media/ssas-permscellsallowed.png "Сводная таблица, которая показывает доступные и запрещенные ячейки")  
  
 Разрешения для ячейки применяются к данным внутри ячейки, и не применяются к ее метаданным. Обратите внимание, как ячейка выводится на экран в результатах запроса, отображая значение `#N/A` вместо фактического значения ячейки. `#N/A`Значение отображается в ячейке, если только клиентское приложение не переводит значение или не задано другое значение путем установки свойства защищенного значения ячейки в строке подключения.  
  
 Чтобы полностью скрыть ячейку, необходимо ограничить количество видимых элементов — измерений, атрибутов измерения и атрибутов измерения. Дополнительные сведения см. в разделе [Предоставление настраиваемого доступа к данным измерений (службы Analysis Services)](grant-custom-access-to-dimension-data-analysis-services.md).  
  
 В качестве администратора вы можете определять, имеют ли пользователи разрешение на чтение, производное чтение или на чтение/запись в ячейках внутри куба. Размещение разрешений в ячейке является самым нижним разрешенным уровнем безопасности, поэтому перед тем, как вы начнете применять разрешения на этом уровне, необходимо помнить о нескольких фактах:  
  
-   Безопасность на уровне ячейки не может расширить права, которые были ограничены на более высоком уровне. Пример: если роль запрещает доступ к данным измерения, безопасность на уровне ячейки не может переопределить заданное множество. Еще один пример. рассмотрим роль с `Read` разрешениями на куб и разрешение на **чтение и запись** в ячейке ─ разрешение на доступ к данным ячейки не будет **доступно для чтения и записи**. оно будет иметь значение `Read` .  
  
-   Пользовательские разрешения часто необходимо согласовывать между элементами измерения и ячейками в рамках единой роли. Предположим, например, что вы хотите запретить доступ к нескольким мерам, касающимся скидок, для разных комбинаций посредников. Используя данные измерения **Торговые посредники** и меру **Сумма скидки** , нужно сочетать в рамках одной и той же роли разрешения и для меры (с помощью инструкций, приведенных в этом разделе), и для членов измерения. Сведения о настройке разрешений для измерения см. в разделе [Предоставление настраиваемого доступа к данным измерений (службы Analysis Services)](grant-custom-access-to-dimension-data-analysis-services.md) .  
  
 Безопасность на уровне ячейки определяется посредством выражений MDX. Так как ячейка является кортежем (говоря иными словами - точкой пересечения между многими измерениями и мерами), необходимо использовать многомерные выражения для идентификации определенных ячеек.  
  
## <a name="allow-access-to-specific-measures"></a>Предоставление доступа к специальным мерам  
 Вы можете использовать безопасность ячейки для того, чтобы явно указать доступные меры. После того, как вы точно определите разрешенные элементы, все остальные меры станут недоступными. Это, возможно, самый простой сценарий реализации через скрипт многомерных выражений, проиллюстрированный нижеследующими этапами.  
  
1.  В [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] подключитесь к экземпляру [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], выберите базу данных, откройте папку **Роли** , а затем выберите роль базы данных (или создайте новую). Членство уже должно быть определено, а роль должна иметь `Read` доступ к кубу. Дополнительные сведения см. в разделе [Предоставление разрешений кубу или модели (службы Analysis Services)](grant-cube-or-model-permissions-analysis-services.md) .  
  
2.  В **Данных Ячейки**, проверьте выбор куба, чтобы удостовериться, что вы выбрали правильный, затем выберите **Включить разрешения на чтение**.  
  
     Если вы выбираете только этот флажок и не осуществляете многомерное выражение, эффект будет таким же, как и от отказа в доступе ко всем ячейкам в кубе. Так происходит потому, что допустимым множеством по умолчанию является пустое множество всякий раз, когда [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] разрешает подмножество ячеек куба.  
  
3.  Введите следующее многомерное выражение.  
  
    ```  
    (Measures.CurrentMember IS [Measures].[Reseller Sales Amount]) OR (Measures.CurrentMember IS [Measures].[Reseller Total Product Cost])  
    ```  
  
     Данное выражение точно определяет, какие меры видны пользователям. Никакие другие меры не будут доступны пользователям, подключенным посредством данной роли. Обратите внимание, что [CurrentMember (многомерные выражения)](/sql/mdx/current-mdx) устанавливает контекст и сопровождается разрешенной мерой. Это выражение действует так: если текущий элемент содержит меру **Объем продаж торгового посредника** или **Совокупная стоимость продуктов торгового посредника**, значение отображается. В противном случае - ограничение доступа. Выражение состоит из нескольких частей, каждая часть заключена в скобки. Оператор `OR` используется для определения нескольких мер.  
  
## <a name="deny-access-to-specific-measures"></a>Отказ в доступе к специальным мерам  
 Следующее многомерное выражение, также заданное в столбце **Создание**  |  **данных ячейки**  |  ,**разрешающее чтение содержимого куба**, имеет противоположный результат, делая определенные меры недоступными. В этом примере **Сумма скидки** и **процент скидки** становятся недоступными с помощью `NOT` `AND` операторов и. Все другие меры будут доступны пользователям, подключенным посредством данной роли.  
  
```  
(NOT Measures.CurrentMember IS [Measures].[Discount Amount]) AND (NOT Measures.CurrentMember IS [Measures].[Discount Percentage])  
```  
  
 В Excel, безопасность ячеек раскрывается на следующей иллюстрации:  
  
 ![Столбцы Excel, которые показывают ячейки как недоступные](../media/ssas-permscellshidemeasure.png "Столбцы Excel, которые показывают ячейки как недоступные")  
  
## <a name="set-read-permissions-on-calculated-measures"></a>Настройка разрешений на чтение на вычисляемых мерах  
 Разрешения на вычисляемых мерах могут быть настроены независимо от их составных частей. Перейдите вперед к следующему разделу относительно Производного Чтения, если вы хотите согласовать разрешения между вычисляемыми мерами и их зависимыми мерами.  
  
 Для того, чтобы понять, как Разрешения на чтение работают для вычисляемых мер, рассмотрим **Валовую Прибыль Посредника** в AdventureWorks. Она выводится из мер **Объема Товарооборота Посредника** и **Общей Стоимости Товаров Посредника** . Поскольку роль обладает Разрешением на чтение ячеек **Валовой Прибыли Посредника** , данная мера является видимой даже если разрешения на других мерах прямо запрещены. В качестве примера скопируйте следующее многомерное выражение в поле **Создание**  |  **данных ячейки**роли  |  **Разрешить чтение содержимого куба**.  
  
```  
(NOT Measures.CurrentMember IS [Measures].[Reseller Sales Amount])  
AND (NOT Measures.CurrentMember IS [Measures].[Reseller Total Product Cost])  
```  
  
 В Excel, подключитесь к кубу, используя текущую роль, и выберите все три меры, чтобы увидеть эффекты безопасности ячейки. Обратите внимание на то, что меры в заданных значениях не доступны, однако вычисляемая мера доступна пользователю.  
  
 ![Таблица Excel с доступными и недоступными ячейками](../media/ssas-permscalculatedcells.png "Таблица Excel с доступными и недоступными ячейками")  
  
## <a name="set-read-contingent-permissions-on-calculated-measures"></a>Настройка разрешений Производного Чтение на вычисляемых мерах  
 Безопасность ячеек предлагает альтернативу, Производное Чтение, для настройки разрешений на соответствующих ячейках, участвующих в вычислении. Снова рассмотрим пример **Валовая Прибыль Посредника** . При вводе того же выражения многомерных выражений, которое было указано в предыдущем разделе, оно помещается во вторую **Create Role**область текста  |  диалогового окна Создание**данных ячейки** роли (в текстовой области, **разрешающей чтение содержимого ячейки в зависимости от безопасности ячейки**) результат становится очевидным при просмотре в Excel. Поскольку **Валовая Прибыль Посредника** обусловлена **Объемом Товарооборота Посредника** и **Общей Стоимостью Товаров Посредника**, валовая прибыль в настоящее время недоступна, поскольку недоступны ее составные части.  
  
> [!NOTE]  
>  Что произойдет, если вы установите в ячейке и разрешения Чтения и разрешения Производного Чтения в рамках единой роли? Роль предоставит в ячейке разрешения Чтения, а не разрешения Производного Чтения.  
  
 Как следует из предыдущих разделов, выбор только лишь флажка **Включить разрешения на производное чтение** , без предоставления любого многомерного выражения, запретит доступ ко всем ячейкам в кубе. Так происходит потому, что допустимым множеством по умолчанию является пустое множество всякий раз, когда [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] разрешает подмножество ячеек куба.  
  
## <a name="set-readwrite-permissions-on-a-cell"></a>Установка разрешений Чтение/Запись в ячейке  
 Разрешения Чтение/запись в ячейке используются для разрешения обратной записи только в том случае, если элементы имеют разрешения чтение/запись на самом кубе. Разрешения, предоставляемые на уровне ячеек, не могут превосходить прав, предоставленных на уровне куба. Дополнительные сведения см. в разделе [Set Partition Writeback](set-partition-writeback.md) .  
  
## <a name="see-also"></a>См. также:  
 [Конструктор многомерных выражений &#40;Analysis Services многомерных данных&#41;](../mdx-builder-analysis-services-multidimensional-data.md)   
 [Базовый скрипт многомерных выражений &#40;многомерные выражения&#41;](mdx/the-basic-mdx-script-mdx.md)   
 [Предоставление разрешений на обработку &#40;Analysis Services&#41;](grant-process-permissions-analysis-services.md)   
 [Предоставление разрешений на Analysis Services &#40;измерения&#41;](grant-permissions-on-a-dimension-analysis-services.md)   
 [Предоставление настраиваемого доступа к данным измерения &#40;Analysis Services&#41;](grant-custom-access-to-dimension-data-analysis-services.md)   
 [Предоставление разрешений кубу или модели (службы Analysis Services)](grant-cube-or-model-permissions-analysis-services.md)  
  
  
