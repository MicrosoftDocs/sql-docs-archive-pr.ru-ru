---
title: Резервное копирование и восстановление баз данных Analysis Services | Документация Майкрософт
ms.custom: ''
ms.date: 03/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
f1_keywords:
- sql12.asvs.ssmsimbi.Backup.f1
- sql12.asvs.ssmsimbi.Restore.f1
helpviewer_keywords:
- backing up databases [Analysis Services]
- encryption [Analysis Services]
- databases [Analysis Services], restoring
- cryptography [Analysis Services]
- databases [Analysis Services], backing up
- restoring databases [Analysis Services]
- recovery [Analysis Services]
ms.assetid: 947eebd2-3622-479e-8aa6-57c11836e4ec
author: minewiskan
ms.author: owend
ms.openlocfilehash: 00a05fa39b57836490dde3dc6d4a1095e4b3ccaa
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87733218"
---
# <a name="backup-and-restore-of-analysis-services-databases"></a>Создание и восстановление резервных копий баз данных служб Analysis Services
  [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] предусмотрено резервное копирование и восстановление базы данных и ее объектов на определенный момент времени. Резервное копирование и восстановление подходит для переноса баз данных на модернизированные серверы, между серверами или для развертывания базы данных на рабочем сервере. Если есть ценные данные, но пока нет плана резервного копирования, то необходимо как можно скорее разработать и реализовать такой план на случай последующего восстановления данных.  
  
 Команды резервного копирования и восстановления выполняются в развернутой базе данных служб Analysis Services. Для проектов и решений в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]следует использовать систему управления версиями, позволяющую восстанавливать определенные версии исходных файлов, а затем создавать план восстановления данных для репозитория используемой системы управления версиями.  
  
 Чтобы создать полную резервную копию, включающую исходные данные, необходимо создать резервную копию базы данных, содержащей подробные данные. В частности, если используется режим хранения базы данных ROLAP или DirectQuery, подробные данные хранятся во внешней реляционной базе данных SQL Server отдельно от базы данных служб Analysis Services. В противном случае, если все объекты являются табличными или многомерными, резервная копия служб Analysis Services будет содержать и метаданные, и исходные данные.  
  
 Одной из явных выгод автоматизации резервного копирования является то, что моментальный снимок данных будет всегда настолько обновленным, насколько это задано частотой автоматического резервного копирования. Автоматические планировщики гарантируют, что резервное копирование будет произведено вовремя. Восстановление базы данных тоже можно автоматизировать, и оно может быть хорошим способом репликации данных, но необходимо обязательно создать резервную копию файла ключа шифрования в экземпляре, на который осуществляется репликация. Функция синхронизации предназначена для репликации баз данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , но относится только к устаревшим данным. Все описываемые здесь функции могут быть реализованы через пользовательский интерфейс посредством команд XML/A или запущены программным путем через объекты AMO.  
  
 Этот раздел включает следующие подразделы:  
  
-   [Подготовка к резервному копированию](#bkmk_prep)  
  
-   [Резервное копирование многомерной или табличной базы данных](#bkmk_cube)  
  
-   [Восстановление базы данных служб Analysis Services](#bkmk_restore)  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> Предварительные требования  
 Пользователь, создающий резервную копию базы данных, должен иметь разрешения администратора в экземпляре служб Analysis Services или разрешения полного доступа (администратора) в этой базе данных.  
  
 Расположение, из которого выполняется восстановление, должно быть экземпляром служб Analysis Services, который имеет ту же или более позднюю версию, что и экземпляр, резервная копия которого хранится в этом расположении. Несмотря на то что нельзя восстановить базу данных из экземпляра [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] до более ранней версии служб Analysis Services, часто можно восстановить старую версию базы данных, например SQL Server 2012, на более новом экземпляре [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] .  
  
 Расположение, из которого производится восстановление, должно находиться на сервере того же типа. Табличные базы данных могут быть восстановлены только для служб Analysis Services, работающих в табличном режиме. Многомерные базы данных требуют экземпляр, работающий в многомерном режиме.  
  
##  <a name="preparing-for-backup"></a><a name="bkmk_prep"></a>Подготовка к резервному копированию  
 Для подготовки к резервному копированию применяется следующий контрольный список.  
  
-   Проверьте расположение, в котором будет храниться файл резервной копии. Если используется удаленное расположение, необходимо указать его как папку в формате UNC. Проверьте доступ по UNC-пути.  
  
-   Проверьте разрешения на папку, чтобы убедиться, что учетная запись службы Analysis Services имеет на нее разрешения для чтения и записи.  
  
-   Проверьте наличие достаточного места на диске целевого сервера.  
  
-   Проверьте наличие существующих файлов с таким именем. Когда файл с таким именем уже существует, резервное копирование завершится ошибкой, если только не заданы параметры, позволяющие перезаписать файл.  
  
##  <a name="backing-up-a-multidimensional-or-a-tabular-database"></a><a name="bkmk_cube"></a> Резервное копирование многомерной или табличной базы данных  
 Администратор может создать резервную копию базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в одном файле резервной копии служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] (ABF) независимо от размера базы данных. Пошаговые инструкции см. в разделах [Резервное копирование базы данных служб Analysis Services (TechMantra)](http://www.mytechmantra.com/LearnSQLServer/Backup_an_Analysis_Services_Database.html) и [Автоматизация резервного копирования базы данных служб Analysis Services (TechMantra)](http://www.mytechmantra.com/LearnSQLServer/Automate_Backup_of_Analysis_Services_Database.html).  
  
> [!NOTE]  
>  [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], используемый для загрузки и запросов к моделям данных PowerPivot в среде SharePoint, загружает свои модели из баз данных содержимого SharePoint. Эти базы данных содержимого являются реляционными и работают на базе ядра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Стратегии резервного копирования и восстановления служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] для моделей данных PowerPivot как таковой не существует. Если для содержимого SharePoint есть план аварийного восстановления, то этот план охватывает модели данных PowerPivot, хранящиеся в базах данных содержимого.  
  
 **Удаленные секции**  
  
 Если база данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] содержит удаленные секции, то необходимо также осуществить резервное копирование этих удаленных секций. При создании резервной копии базы данных с удаленными секциями создание резервных копий всех удаленных секций на каждом удаленном сервере осуществляется в одном файле на каждом из этих удаленных серверов соответственно. Таким образом, если нужно создать эти удаленные резервные копии вне соответствующих главных компьютеров, вручную скопируйте эти файлы в предназначенные для них места хранения.  
  
 **Содержимое файла резервной копии**  
  
 В результате резервного копирования базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] создается файл резервной копии, содержимое которого различается в зависимости от режима хранения, используемого объектами базы данных. Это различие содержимого резервной копии получается вследствие того факта, что при различных режимах хранения в базе данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в реальности хранятся различные наборы данных. Например, многомерные секции и измерения гибридного OLAP (HOLAP) хранят агрегаты и метаданные в базе данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , в то время как секции и измерения реляционного OLAP (ROLAP) хранят в базе данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] только метаданные. Поскольку реальное содержимое базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] различается в зависимости от режима хранения для каждой секции, содержимое файла резервной копии также различается. В следующей таблице приведена связь содержимого файла резервной копии с режимом хранения, используемым объектами.  
  
|Режим хранения|Содержимое файла резервной копии|  
|------------------|-----------------------------|  
|Многомерные секции и измерения MOLAP|Метаданные, исходные данные и агрегаты|  
|Многомерные секции и измерения HOLAP|Метаданные и агрегаты|  
|Многомерные секции и измерения ROLAP|Метаданные|  
|Табличные модели в памяти|Метаданные и исходные данные|  
|Табличные модели DirectQuery|Только метаданные|  
  
> [!NOTE]  
>  При создании резервной копии базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] не создается резервная копия данных из базовых источников данных, например из реляционной базы данных. Создается только резервная копия содержимого базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
 При создании резервной копии базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] можно выбирать следующие параметры:  
  
-   Необходимость сжатия всех резервных копий базы данных. По умолчанию резервные копии сжимаются.  
  
-   Необходимость шифрования содержимого файлов резервных копий и запрашивания пароля перед расшифровкой и восстановлением файла. По умолчанию шифрование резервных копий данных не производится.  
  
    > [!IMPORTANT]  
    >  Пользователь, выполняющий команду резервного копирования, должен иметь разрешение на запись в папку резервного копирования, указанную для каждого копируемого файла. Кроме того, пользователь должен быть членом одной из следующих ролей: роль сервера для экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] или роль базы данных с разрешениями "Полный доступ (администратор)" в базе данных, для которой создается резервная копия.  
  
 Дополнительные сведения о создании резервных копий базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] см. в разделе [Параметры резервного копирования](backup-options.md).  
  
##  <a name="restoring-an-analysis-services-database"></a><a name="bkmk_restore"></a>Восстановление базы данных Analysis Services  
 Администраторы могут восстанавливать базу данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] из одного или нескольких файлов резервной копии.  
  
> [!NOTE]  
>  Если файл резервной копии зашифрован, то необходимо ввести пароль, заданный во время создания резервной копии, перед тем как можно будет использовать этот файл для восстановления базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
 Во время восстановления возможны следующие варианты:  
  
-   Можно восстановить базу данных, используя первоначальное имя базы данных, или указать новое имя базы данных.  
  
-   Можно перезаписать существующую базу данных. При выборе перезаписывания базы данных нужно явно указать, что ее необходимо перезаписать.  
  
-   Можно выбрать необходимость восстановления существующих сведений о безопасности или пропустить сведения о вхождении в группы безопасности.  
  
-   Можно выбрать, чтобы команда восстановления изменяла папку восстановления для каждой восстанавливаемой секции. Локальные секции можно восстанавливать в любое местоположение папки, являющееся локальным для экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , на который производится восстановление базы данных. Удаленные секции можно восстанавливать в любую папку на любом сервере, кроме локального; удаленные секции не могут становиться локальными.  
  
    > [!IMPORTANT]  
    >  Пользователь, выполняющий команду восстановления, должен иметь разрешение на чтение из папки резервного копирования, указанной для каждого восстанавливаемого файла. Чтобы восстановить базу данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , которая не установлена на сервере, пользователь также должен быть членом роли сервера для этого экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] . Чтобы перезаписать базу данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , пользователь должен быть членом одной из следующих ролей: роль сервера для экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] или роль базы данных с разрешениями "Полный доступ (администратор)" в восстанавливаемой базе данных.  
  
    > [!NOTE]  
    >  После восстановления существующей базы данных пользователь, выполнявший восстановление, может утратить доступ к этой базе данных. Потеря доступа может произойти в случае, если на время создания резервной копии этот пользователь не был членом роли сервера и роли базы данных с разрешением «Полный доступ (Администратор)».  
  
 Дополнительные сведения о восстановлении базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] см. в разделе [Параметры восстановления](restore-options.md).  
  
## <a name="see-also"></a>См. также:  
 [Резервное копирование, восстановление и синхронизация баз данных &#40;XMLA&#41;](../multidimensional-models-scripting-language-assl-xmla/backing-up-restoring-and-synchronizing-databases-xmla.md)   
 [Analysis Services PowerShell](../analysis-services-powershell.md)  
  
  
