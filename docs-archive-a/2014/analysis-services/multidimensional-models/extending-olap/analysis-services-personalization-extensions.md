---
title: Analysis Services расширения персонализации | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- personalization extensions [Multidimensional Databases]
ms.assetid: 0f144059-24e0-40c0-bde4-d48c75e46598
author: minewiskan
ms.author: owend
ms.openlocfilehash: 0cd36cb2882659bff902d9830af0c5acefd98444
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669127"
---
# <a name="analysis-services-personalization-extensions"></a><span data-ttu-id="925ba-102">Модули персонализации служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="925ba-102">Analysis Services Personalization Extensions</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="925ba-103">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]расширения персонализации являются основой реализации архитектуры подключаемых модулей.</span><span class="sxs-lookup"><span data-stu-id="925ba-103">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions are the foundation of the idea of implementing a plug-in architecture.</span></span> <span data-ttu-id="925ba-104">С помощью архитектуры подключаемых модулей можно динамически разрабатывать новые объекты кубов и функциональность и легко обмениваться ими с другими разработчиками.</span><span class="sxs-lookup"><span data-stu-id="925ba-104">In a plug-in architecture, you can develop new cube objects and functionality dynamically and share them easily with other developers.</span></span> <span data-ttu-id="925ba-105">Таким образом, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] расширения персонализации предоставляют функциональные возможности, позволяющие достичь следующих возможностей:</span><span class="sxs-lookup"><span data-stu-id="925ba-105">As such, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions provide the functionality that makes it possible to achieve the following:</span></span>  
  
-   <span data-ttu-id="925ba-106">**Динамическое проектирование и развертывание** Сразу после проектирования и развертывания [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] расширений персонализации пользователи получают доступ к объектам и функциям в начале следующего сеанса пользователя.</span><span class="sxs-lookup"><span data-stu-id="925ba-106">**Dynamic design and deployment** Immediately after you design and deploy [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions, users have access to the objects and functionality at the start of the next user session.</span></span>  
  
-   <span data-ttu-id="925ba-107">**Независимость от интерфейса** Независимо от интерфейса, используемого для создания [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] расширений персонализации, пользователи могут использовать любой интерфейс для доступа к объектам и функциональным возможностям.</span><span class="sxs-lookup"><span data-stu-id="925ba-107">**Interface independence** Regardless of the interface that you use to create the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions, users can use any interface to access the objects and functionality.</span></span>  
  
-   <span data-ttu-id="925ba-108">**Контекст сеанса** [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] расширения персонализации не являются постоянными объектами в существующей инфраструктуре и не нуждаются в повторной обработке куба.</span><span class="sxs-lookup"><span data-stu-id="925ba-108">**Session context** [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions are not permanent objects in the existing infrastructure and do not require the cube to be reprocessed.</span></span> <span data-ttu-id="925ba-109">Они создаются для пользователя, когда он подключается к базе данных, и остаются доступными на протяжении пользовательского сеанса.</span><span class="sxs-lookup"><span data-stu-id="925ba-109">They become exposed and created for the user at the time that the user connects to the database, and remain available for the length of that user session.</span></span>  
  
-   <span data-ttu-id="925ba-110">**Быстрое распределение** Обменивайтесь [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] расширениями персонализации с другими разработчиками программного обеспечения, не обращаясь к подробным сведениям о том, где или как найти эту расширенную функциональность.</span><span class="sxs-lookup"><span data-stu-id="925ba-110">**Rapid distribution** Share [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions with other software developers without having to go into detailed specifications about where or how to find this extended functionality.</span></span>  
  
 <span data-ttu-id="925ba-111">Модули персонализации служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] имеют множество возможных применений.</span><span class="sxs-lookup"><span data-stu-id="925ba-111">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions have many uses.</span></span> <span data-ttu-id="925ba-112">Например, компания продает товар за различные виды валют.</span><span class="sxs-lookup"><span data-stu-id="925ba-112">For example, your company has sales that involve different currencies.</span></span> <span data-ttu-id="925ba-113">Можно создать вычисляемый элемент, возвращающий общую цифру продаж в местной валюте пользователя, который просматривает куб.</span><span class="sxs-lookup"><span data-stu-id="925ba-113">You create a calculated member that returns the consolidated sales in the local currency of the person who is accessing the cube.</span></span> <span data-ttu-id="925ba-114">Этот элемент создается как модуль персонализации.</span><span class="sxs-lookup"><span data-stu-id="925ba-114">You create this member as a personalization extension.</span></span> <span data-ttu-id="925ba-115">Затем этот вычисляемый элемент можно сделать общим для группы пользователей.</span><span class="sxs-lookup"><span data-stu-id="925ba-115">You then share this calculated member to a group of users.</span></span> <span data-ttu-id="925ba-116">Как только элемент сделан общим, пользователи немедленно получают доступ к вычисляемому элементу, как только подключатся к серверу.</span><span class="sxs-lookup"><span data-stu-id="925ba-116">Once shared, those users have immediate access to the calculated member as soon as they connect to the server.</span></span> <span data-ttu-id="925ba-117">Они получат доступ к элементу, даже если интерфейс, которым они пользуются, отличен от использованного при создании вычисляемого элемента.</span><span class="sxs-lookup"><span data-stu-id="925ba-117">They have access even if they are not using the same interface as the one that was used to create the calculated member.</span></span>  
  
 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]<span data-ttu-id="925ba-118">расширения персонализации — это простое и элегантное изменение существующей архитектуры управляемой сборки. они доступны во всей [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] объектной модели [Microsoft. AnalysisServices. того объектная AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) , синтаксисе многомерных выражений и наборах строк схемы.</span><span class="sxs-lookup"><span data-stu-id="925ba-118">personalization extensions are a simple and elegant modification to the existing managed assembly architecture and are exposed throughout the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] [Microsoft.AnalysisServices.AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) object model, Multidimensional Expressions (MDX) syntax, and schema rowsets.</span></span>  
  
## <a name="logical-architecture"></a><span data-ttu-id="925ba-119">Логическая архитектура</span><span class="sxs-lookup"><span data-stu-id="925ba-119">Logical Architecture</span></span>  
 <span data-ttu-id="925ba-120">Архитектура модулей персонализации служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] основана на архитектуре управляемых сборок и следующих четырех основных элементах.</span><span class="sxs-lookup"><span data-stu-id="925ba-120">The architecture for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions is based on the managed assembly architecture and the following four basic elements:</span></span>  
  
 <span data-ttu-id="925ba-121">Специальный атрибут [PlugInAttribute]</span><span class="sxs-lookup"><span data-stu-id="925ba-121">The [PlugInAttribute] custom attribute</span></span>  
 <span data-ttu-id="925ba-122">При запуске службы [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] загружает необходимые сборки и определяет, какие классы имеют настраиваемый атрибут [Microsoft. AnalysisServices. того объектная AdomdServer. плугинаттрибуте](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) .</span><span class="sxs-lookup"><span data-stu-id="925ba-122">When starting the service, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] loads the required assemblies and determines which classes have the [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) custom attribute.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="925ba-123">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] определяет специальные атрибуты как способ описания программного кода и влияния на поведение времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="925ba-123">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] defines custom attributes as a way to describe your code and affect run-time behavior.</span></span> <span data-ttu-id="925ba-124">Дополнительные сведения см. в разделе «[Общие сведения об атрибутах](https://go.microsoft.com/fwlink/?LinkId=82929)» в [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Руководстве разработчика на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="925ba-124">For more information, see the topic, "[Attributes Overview](https://go.microsoft.com/fwlink/?LinkId=82929)," in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Developer's Guide on MSDN.</span></span>  
  
 <span data-ttu-id="925ba-125">Для всех классов с пользовательским атрибутом [Microsoft. AnalysisServices. того объектная AdomdServer. плугинаттрибуте](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] вызывает конструкторы по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="925ba-125">For all classes with the [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) custom attribute, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] invokes their default constructors.</span></span> <span data-ttu-id="925ba-126">Вызов всех конструкторов при запуске представляет собой удобный момент для построения новых объектов независимо от действий пользователя.</span><span class="sxs-lookup"><span data-stu-id="925ba-126">Invoking all the constructors at startup provides a common location from which to build new objects and that is independent of any user activity.</span></span>  
  
 <span data-ttu-id="925ba-127">Помимо создания небольшого кэша информации о создании и управлении расширениями персонализации, конструктор класса обычно подписывается на события [Microsoft. AnalysisServices. того объектная AdomdServer. Server. SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) и [Microsoft. AnalysisServices. того объектная AdomdServer. Server. SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) .</span><span class="sxs-lookup"><span data-stu-id="925ba-127">In addition to building a small cache of information about authoring and managing personalization extensions, the class constructor typically subscribes to the [Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) and [Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) events.</span></span> <span data-ttu-id="925ba-128">Если класс не подписан на эти события, он может быть ошибочно помечен для удаления сборщиком мусора среды CLR.</span><span class="sxs-lookup"><span data-stu-id="925ba-128">Failing to subscribe to these events may cause the class to be inappropriately marked for cleanup by the common language runtime (CLR) garbage collector.</span></span>  
  
 <span data-ttu-id="925ba-129">Контекст сеанса</span><span class="sxs-lookup"><span data-stu-id="925ba-129">Session context</span></span>  
 <span data-ttu-id="925ba-130">Для объектов, основанных на модулях персонализации, службы [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] создают среду выполнения во время клиентского сеанса и динамически строят большинство объектов этой среды.</span><span class="sxs-lookup"><span data-stu-id="925ba-130">For those objects that are based on personalization extensions, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] creates an execution environment during the client session and dynamically builds most of those objects in this environment.</span></span> <span data-ttu-id="925ba-131">Эта среда выполнения, как и любая другая сборка CLR, имеет доступ к другим функциям и хранимым процедурам.</span><span class="sxs-lookup"><span data-stu-id="925ba-131">Like any other CLR assembly, this execution environment also has access to other functions and stored procedures.</span></span> <span data-ttu-id="925ba-132">По окончании сеанса пользователя [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] удаляет динамически созданные объекты и закрывает среду выполнения.</span><span class="sxs-lookup"><span data-stu-id="925ba-132">When the user session ends, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] removes the dynamically created objects and closes the execution environment.</span></span>  
  
 <span data-ttu-id="925ba-133">События</span><span class="sxs-lookup"><span data-stu-id="925ba-133">Events</span></span>  
 <span data-ttu-id="925ba-134">Создание объекта запускается событиями сеанса `On-Cube-OpenedCubeOpened` и `On-Cube-ClosingCubeClosing`.</span><span class="sxs-lookup"><span data-stu-id="925ba-134">Object creation is triggered by the session events `On-Cube-OpenedCubeOpened` and `On-Cube-ClosingCubeClosing`.</span></span>  
  
 <span data-ttu-id="925ba-135">Связь между клиентом и сервером происходит посредством определенных событий.</span><span class="sxs-lookup"><span data-stu-id="925ba-135">Communication between the client and the server occurs through specific events.</span></span> <span data-ttu-id="925ba-136">Эти события сообщают клиенту о ситуациях, в результате которых создаются клиентские объекты.</span><span class="sxs-lookup"><span data-stu-id="925ba-136">These events make the client aware of the situations that lead to the client's objects being built.</span></span> <span data-ttu-id="925ba-137">Среда клиента создается динамически с помощью двух наборов событий: события сеанса и события куба.</span><span class="sxs-lookup"><span data-stu-id="925ba-137">The client's environment is dynamically created using two sets of events: session events and cube events.</span></span>  
  
 <span data-ttu-id="925ba-138">События сеанса связаны с объектом сервера.</span><span class="sxs-lookup"><span data-stu-id="925ba-138">Session events are associated with the server object.</span></span> <span data-ttu-id="925ba-139">Когда клиент входит в систему на сервере, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] создает сеанс и запускает событие [Microsoft. AnalysisServices. того объектная AdomdServer. Server. SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) .</span><span class="sxs-lookup"><span data-stu-id="925ba-139">When a client logs on to a server, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] creates a session and triggers the [Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) event.</span></span> <span data-ttu-id="925ba-140">Когда клиент завершает сеанс на сервере, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] запускает событие [Microsoft. AnalysisServices. того объектная AdomdServer. Server. SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) .</span><span class="sxs-lookup"><span data-stu-id="925ba-140">When a client ends the session on the server, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] triggers the [Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) event.</span></span>  
  
 <span data-ttu-id="925ba-141">События куба связаны с объектом соединения.</span><span class="sxs-lookup"><span data-stu-id="925ba-141">Cube events are associated with the connection object.</span></span> <span data-ttu-id="925ba-142">При подключении к кубу вызывается событие [Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection. CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120)) .</span><span class="sxs-lookup"><span data-stu-id="925ba-142">Connecting to a cube triggers the [Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120)) event.</span></span> <span data-ttu-id="925ba-143">Закрытие соединения с кубом путем закрытия куба или перехода к другому Кубу вызывает событие [Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection. CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120)) .</span><span class="sxs-lookup"><span data-stu-id="925ba-143">Closing the connection to a cube, by either closing the cube or by changing to a different cube, triggers a [Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120)) event.</span></span>  
  
 <span data-ttu-id="925ba-144">Трассировка и обработка ошибок</span><span class="sxs-lookup"><span data-stu-id="925ba-144">Traceability and error handling</span></span>  
 <span data-ttu-id="925ba-145">С помощью приложения [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] можно трассировать любые действия.</span><span class="sxs-lookup"><span data-stu-id="925ba-145">All activity is traceable by using [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="925ba-146">Необработанные ошибки заносятся в журнал событий Windows.</span><span class="sxs-lookup"><span data-stu-id="925ba-146">Unhandled errors are reported to the Windows event log.</span></span>  
  
 <span data-ttu-id="925ba-147">Всякое создание объектов и управление ими происходит независимо от этой архитектуры, и за него отвечают разработчики этих объектов.</span><span class="sxs-lookup"><span data-stu-id="925ba-147">All object authoring and management is independent of this architecture and is the sole responsibility of the developers of the objects.</span></span>  
  
## <a name="infrastructure-foundations"></a><span data-ttu-id="925ba-148">Основания инфраструктуры</span><span class="sxs-lookup"><span data-stu-id="925ba-148">Infrastructure Foundations</span></span>  
 <span data-ttu-id="925ba-149">Модули персонализации служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] основаны на существующих компонентах.</span><span class="sxs-lookup"><span data-stu-id="925ba-149">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions are based on existing components.</span></span> <span data-ttu-id="925ba-150">Далее следует сводка усовершенствований и улучшений, обеспечивающих функциональность модулей персонализации.</span><span class="sxs-lookup"><span data-stu-id="925ba-150">The following is a summary of enhancements and improvements that provide the personalization extensions functionality.</span></span>  
  
### <a name="assemblies"></a><span data-ttu-id="925ba-151">Сборки</span><span class="sxs-lookup"><span data-stu-id="925ba-151">Assemblies</span></span>  
 <span data-ttu-id="925ba-152">Пользовательский атрибут [Microsoft. AnalysisServices. того объектная AdomdServer. плугинаттрибуте](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120))можно добавить в пользовательские сборки для обнаружения [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] классов расширений персонализации.</span><span class="sxs-lookup"><span data-stu-id="925ba-152">The custom attribute, [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)), can be added to your custom assemblies to identify [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions classes.</span></span>  
  
### <a name="changes-to-the-adomdserver-object-model"></a><span data-ttu-id="925ba-153">Изменения модели объектов AdomdServer</span><span class="sxs-lookup"><span data-stu-id="925ba-153">Changes to the AdomdServer Object Model</span></span>  
 <span data-ttu-id="925ba-154">Следующие объекты в объектной модели [Microsoft. AnalysisServices. того объектная AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) были расширены или добавлены в модель.</span><span class="sxs-lookup"><span data-stu-id="925ba-154">The following objects in the [Microsoft.AnalysisServices.AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) object model have been enhanced or added to the model.</span></span>  
  
#### <a name="new-adomdconnection-class"></a><span data-ttu-id="925ba-155">Новый класс AdomdConnection</span><span class="sxs-lookup"><span data-stu-id="925ba-155">New AdomdConnection Class</span></span>  
 <span data-ttu-id="925ba-156">Класс [Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) является новым и предоставляет несколько расширений персонализации через свойства и события.</span><span class="sxs-lookup"><span data-stu-id="925ba-156">The [Microsoft.AnalysisServices.AdomdServer.AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) class is new and exposes several personalization extensions through both properties and events.</span></span>  
  
 <span data-ttu-id="925ba-157">**Свойства**</span><span class="sxs-lookup"><span data-stu-id="925ba-157">**Properties**</span></span>  
  
-   <span data-ttu-id="925ba-158">[Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection. SessionID \*](/previous-versions/sql/sql-server-2014/bb678099(v=sql.120)), доступное только для чтения строковое значение, представляющее идентификатор сеанса текущего соединения.</span><span class="sxs-lookup"><span data-stu-id="925ba-158">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.SessionID\*](/previous-versions/sql/sql-server-2014/bb678099(v=sql.120)), a read-only string value representing the session Id of the current connection.</span></span>  
  
-   <span data-ttu-id="925ba-159">[Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection. клиенткултуре \*](/previous-versions/sql/sql-server-2014/bb677433(v=sql.120)), доступная только для чтения ссылка на язык и региональные параметры клиента, связанные с текущим сеансом.</span><span class="sxs-lookup"><span data-stu-id="925ba-159">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.ClientCulture\*](/previous-versions/sql/sql-server-2014/bb677433(v=sql.120)), a read-only reference to the client culture associated with current session.</span></span>  
  
-   <span data-ttu-id="925ba-160">[Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection. User \*](/previous-versions/sql/sql-server-2014/bb630315(v=sql.120))— доступная только для чтения ссылка на интерфейс идентификации, представляющий текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="925ba-160">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.User\*](/previous-versions/sql/sql-server-2014/bb630315(v=sql.120)), a read-only reference to the identity interface representing the current user.</span></span>  
  
 <span data-ttu-id="925ba-161">**События**</span><span class="sxs-lookup"><span data-stu-id="925ba-161">**Events**</span></span>  
  
-   <span data-ttu-id="925ba-162">[Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection. CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="925ba-162">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))</span></span>  
  
-   <span data-ttu-id="925ba-163">[Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection. CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="925ba-163">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))</span></span>  
  
#### <a name="new-properties-in-the-context-class"></a><span data-ttu-id="925ba-164">Новые свойства в классе Context</span><span class="sxs-lookup"><span data-stu-id="925ba-164">New Properties in the Context class</span></span>  
 <span data-ttu-id="925ba-165">Класс [Microsoft. AnalysisServices. того объектная AdomdServer. Context](/previous-versions/sql/sql-server-2014/ms143353(v=sql.120)) имеет два новых свойства:</span><span class="sxs-lookup"><span data-stu-id="925ba-165">The [Microsoft.AnalysisServices.AdomdServer.Context](/previous-versions/sql/sql-server-2014/ms143353(v=sql.120)) class has two new properties:</span></span>  
  
-   <span data-ttu-id="925ba-166">[Microsoft. AnalysisServices. того объектная AdomdServer. Context. Server \*](/previous-versions/sql/sql-server-2014/bb678098(v=sql.120))— доступная только для чтения ссылка на новый объект Server.</span><span class="sxs-lookup"><span data-stu-id="925ba-166">[Microsoft.AnalysisServices.AdomdServer.Context.Server\*](/previous-versions/sql/sql-server-2014/bb678098(v=sql.120)), a read-only reference to the new server object.</span></span>  
  
-   <span data-ttu-id="925ba-167">[Microsoft. AnalysisServices. того объектная AdomdServer. Context. куррентконнектион \*](/previous-versions/sql/sql-server-2014/bb630975(v=sql.120))— это доступная только для чтения ссылка на новый объект [Microsoft. AnalysisServices. того объектная AdomdServer. AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) .</span><span class="sxs-lookup"><span data-stu-id="925ba-167">[Microsoft.AnalysisServices.AdomdServer.Context.CurrentConnection\*](/previous-versions/sql/sql-server-2014/bb630975(v=sql.120)), a read-only reference to the new [Microsoft.AnalysisServices.AdomdServer.AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) object.</span></span>  
  
#### <a name="new-server-class"></a><span data-ttu-id="925ba-168">Новый класс Server</span><span class="sxs-lookup"><span data-stu-id="925ba-168">New Server class</span></span>  
 <span data-ttu-id="925ba-169">Класс [Microsoft. AnalysisServices. того объектная AdomdServer. Server](/previous-versions/sql/sql-server-2014/bb677955(v=sql.120)) является новым и предоставляет несколько расширений персонализации через свойства и события класса.</span><span class="sxs-lookup"><span data-stu-id="925ba-169">The [Microsoft.AnalysisServices.AdomdServer.Server](/previous-versions/sql/sql-server-2014/bb677955(v=sql.120)) class is new and exposes several personalization extensions through both class properties and events.</span></span>  
  
 <span data-ttu-id="925ba-170">**Свойства**</span><span class="sxs-lookup"><span data-stu-id="925ba-170">**Properties**</span></span>  
  
-   <span data-ttu-id="925ba-171">[Microsoft.AnalysisServices.AdomdServer.Server.Name \*](/previous-versions/sql/sql-server-2014/bb677694(v=sql.120))— доступное только для чтения строковое значение, представляющее имя сервера.</span><span class="sxs-lookup"><span data-stu-id="925ba-171">[Microsoft.AnalysisServices.AdomdServer.Server.Name\*](/previous-versions/sql/sql-server-2014/bb677694(v=sql.120)), a read-only string value representing the server name.</span></span>  
  
-   <span data-ttu-id="925ba-172">[Microsoft. AnalysisServices. того объектная AdomdServer. Server. culture \*](/previous-versions/sql/sql-server-2014/bb677437(v=sql.120)), доступная только для чтения ссылка на глобальный язык и региональные параметры, связанные с сервером.</span><span class="sxs-lookup"><span data-stu-id="925ba-172">[Microsoft.AnalysisServices.AdomdServer.Server.Culture\*](/previous-versions/sql/sql-server-2014/bb677437(v=sql.120)), A read-only reference to the global culture associated with the server.</span></span>  
  
 <span data-ttu-id="925ba-173">**События**</span><span class="sxs-lookup"><span data-stu-id="925ba-173">**Events**</span></span>  
  
-   <span data-ttu-id="925ba-174">[Microsoft. AnalysisServices. того объектная AdomdServer. Server. SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="925ba-174">[Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span></span>  
  
-   <span data-ttu-id="925ba-175">[Microsoft. AnalysisServices. того объектная AdomdServer. Server. SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="925ba-175">[Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span></span>  
  
#### <a name="adomdcommand-class"></a><span data-ttu-id="925ba-176">Класс AdomdCommand</span><span class="sxs-lookup"><span data-stu-id="925ba-176">AdomdCommand class</span></span>  
 <span data-ttu-id="925ba-177">Класс [Microsoft. AnalysisServices. того объектная AdomdServer. AdomdCommand](/previous-versions/sql/sql-server-2014/ms143286(v=sql.120)) теперь поддерживает следующие команды многомерных выражений:</span><span class="sxs-lookup"><span data-stu-id="925ba-177">The [Microsoft.AnalysisServices.AdomdServer.AdomdCommand](/previous-versions/sql/sql-server-2014/ms143286(v=sql.120)) class now supports of the following MDX commands:</span></span>  
  
-   [<span data-ttu-id="925ba-178">Инструкция CREATE MEMBER (многомерные выражения)</span><span class="sxs-lookup"><span data-stu-id="925ba-178">CREATE MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-member)  
  
-   [<span data-ttu-id="925ba-179">Инструкция обновления элемента &#40;многомерных выражений&#41;</span><span class="sxs-lookup"><span data-stu-id="925ba-179">UPDATE MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-update-member)  
  
-   [<span data-ttu-id="925ba-180">Инструкция DROP MEMBER &#40;&#41;многомерных выражений</span><span class="sxs-lookup"><span data-stu-id="925ba-180">DROP MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-member)  
  
-   [<span data-ttu-id="925ba-181">Инструкция CREATE SET (многомерные выражения)</span><span class="sxs-lookup"><span data-stu-id="925ba-181">CREATE SET Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-set)  
  
-   [<span data-ttu-id="925ba-182">Инструкция DROP SET &#40;&#41;многомерных выражений</span><span class="sxs-lookup"><span data-stu-id="925ba-182">DROP SET Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-set)  
  
-   [<span data-ttu-id="925ba-183">Инструкция CREATE KPI &#40;&#41;многомерных выражений</span><span class="sxs-lookup"><span data-stu-id="925ba-183">CREATE KPI Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-kpi)  
  
-   [<span data-ttu-id="925ba-184">Инструкция DROP KPI &#40;&#41;многомерных выражений</span><span class="sxs-lookup"><span data-stu-id="925ba-184">DROP KPI Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-kpi)  
  
### <a name="mdx-extensions-and-enhancements"></a><span data-ttu-id="925ba-185">Расширения и усовершенствования многомерных выражений</span><span class="sxs-lookup"><span data-stu-id="925ba-185">MDX extensions and enhancements</span></span>  
 <span data-ttu-id="925ba-186">Команда CREATE MEMBER улучшена добавлением свойств `caption`,  `display_folder` и `associated_measure_group`.</span><span class="sxs-lookup"><span data-stu-id="925ba-186">The CREATE MEMBER command is enhanced with the `caption` property, the `display_folder` property, and the `associated_measure_group` property.</span></span>  
  
 <span data-ttu-id="925ba-187">Добавлена новая команда UPDATE MEMBER, чтобы избежать повторного создания элемента, если необходимо обновление с последующей потерей порядка вычислений.</span><span class="sxs-lookup"><span data-stu-id="925ba-187">The UPDATE MEMBER command is added to avoid member re-creation when an update is needed with the consequent loss of precedence in solving calculations.</span></span> <span data-ttu-id="925ba-188">Обновления не могут изменить область вычисляемого элемента, переместить вычисляемый элемент к другому родителю или определить другой `solveorder`.</span><span class="sxs-lookup"><span data-stu-id="925ba-188">Updates cannot change the scope of the calculated member, move the calculated member to a different parent, or define a different `solveorder`.</span></span>  
  
 <span data-ttu-id="925ba-189">Команда CREATE SET улучшена добавлением свойств `caption` и `display_folder` и новым ключевым словом `STATIC | DYNAMIC`.</span><span class="sxs-lookup"><span data-stu-id="925ba-189">The CREATE SET command is enhanced with the `caption` property, the `display_folder` property, and the new `STATIC | DYNAMIC` keyword.</span></span> <span data-ttu-id="925ba-190">*Статическое* значение означает, что набор вычисляется только во время создания.</span><span class="sxs-lookup"><span data-stu-id="925ba-190">*Static* means that set is evaluated only at creation time.</span></span> <span data-ttu-id="925ba-191">*Dynamic* означает, что набор вычисляется каждый раз, когда набор используется в запросе.</span><span class="sxs-lookup"><span data-stu-id="925ba-191">*Dynamic* means that the set is evaluated every time that the set is used in a query.</span></span> <span data-ttu-id="925ba-192">Если ключевое слово отсутствует, значение по умолчанию — `STATIC`.</span><span class="sxs-lookup"><span data-stu-id="925ba-192">The default value is `STATIC` if a keyword is omitted.</span></span>  
  
 <span data-ttu-id="925ba-193">В синтаксис многомерных выражений добавлены команды CREATE KPI и DROP KPI.</span><span class="sxs-lookup"><span data-stu-id="925ba-193">CREATE KPI and DROP KPI commands are added to the MDX syntax.</span></span> <span data-ttu-id="925ba-194">Ключевые показатели эффективности можно создавать динамически из любого скрипта многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="925ba-194">KPIs can be created dynamically from any MDX script.</span></span>  
  
### <a name="schema-rowsets-extensions"></a><span data-ttu-id="925ba-195">Расширения наборов строк схем</span><span class="sxs-lookup"><span data-stu-id="925ba-195">Schema Rowsets extensions</span></span>  
 <span data-ttu-id="925ba-196">Добавляется столбец *области* MDSCHEMA_MEMBERS.</span><span class="sxs-lookup"><span data-stu-id="925ba-196">On MDSCHEMA_MEMBERS *scope* column is added.</span></span> <span data-ttu-id="925ba-197">Значения области выглядят следующим образом: MDMEMBER_SCOPE_GLOBAL = 1, MDMEMBER_SCOPE_SESSION = 2.</span><span class="sxs-lookup"><span data-stu-id="925ba-197">Scope values are as follows: MDMEMBER_SCOPE_GLOBAL=1, MDMEMBER_SCOPE_SESSION=2.</span></span>  
  
 <span data-ttu-id="925ba-198">В MDSCHEMA_SETS столбец *set_evaluation_context* добавлен.</span><span class="sxs-lookup"><span data-stu-id="925ba-198">On MDSCHEMA_SETS *set_evaluation_context* column is added.</span></span> <span data-ttu-id="925ba-199">Задайте следующие значения контекста вычисления: MDSET_RESOLUTION_STATIC = 1, MDSET_RESOLUTION_DYNAMIC = 2.</span><span class="sxs-lookup"><span data-stu-id="925ba-199">Set evaluation context values are as follows: MDSET_RESOLUTION_STATIC = 1, MDSET_RESOLUTION_DYNAMIC = 2.</span></span>  
  
 <span data-ttu-id="925ba-200">Добавлен столбец scope  в набор строк схемы MDSCHEMA_KPIS.</span><span class="sxs-lookup"><span data-stu-id="925ba-200">On MDSCHEMA_KPIS scope column is added.</span></span> <span data-ttu-id="925ba-201">Значения области выглядят следующим образом: MDKPI_SCOPE_GLOBAL = 1, MDKPI_SCOPE_SESSION = 2.</span><span class="sxs-lookup"><span data-stu-id="925ba-201">Scope values are as follows: MDKPI_SCOPE_GLOBAL=1, MDKPI_SCOPE_SESSION=2.</span></span>  
  
  
