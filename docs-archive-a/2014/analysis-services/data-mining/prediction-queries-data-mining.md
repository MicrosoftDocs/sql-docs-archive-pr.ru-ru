---
title: Прогнозирующие запросы (интеллектуальный анализ данных) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: e5e6686c-1360-480e-8c0d-8a56204fbed9
author: minewiskan
ms.author: owend
ms.openlocfilehash: 543055aaed5d8991ed2c913a6ae46575c774e216
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87734621"
---
# <a name="prediction-queries-data-mining"></a><span data-ttu-id="d3c12-102">Прогнозирующие запросы (интеллектуальный анализ данных)</span><span class="sxs-lookup"><span data-stu-id="d3c12-102">Prediction Queries (Data Mining)</span></span>
  <span data-ttu-id="d3c12-103">Целью стандартного проекта интеллектуального анализа данных является создание прогнозов с помощью моделей интеллектуального анализа данных.</span><span class="sxs-lookup"><span data-stu-id="d3c12-103">The goal of a typical data mining project is to use the mining model to make predictions.</span></span> <span data-ttu-id="d3c12-104">Например, пользователю может потребоваться спрогнозировать возможное время простоя определенного кластера серверов либо сформировать оценку, показывающую вероятность отклика покупателей из разных сегментов на рекламную кампанию.</span><span class="sxs-lookup"><span data-stu-id="d3c12-104">For example, you might want to predict the amount of expected downtime for a certain cluster of servers, or generate a score that indicates whether segments of customers are likely to respond to an advertising campaign.</span></span> <span data-ttu-id="d3c12-105">Чтобы выполнить все это, следует создать прогнозирующий запрос.</span><span class="sxs-lookup"><span data-stu-id="d3c12-105">To do all these things, you would create a prediction query.</span></span>  
  
 <span data-ttu-id="d3c12-106">С точки зрения практики в SQL Server поддерживаются разные типы прогнозирующих запросов, в зависимости от типа входных данных запроса.</span><span class="sxs-lookup"><span data-stu-id="d3c12-106">Functionally, there are different types of prediction queries supported in SQL Server, depending on the type of inputs to the query:</span></span>  
  
|<span data-ttu-id="d3c12-107">Тип запроса</span><span class="sxs-lookup"><span data-stu-id="d3c12-107">Query Type</span></span>|<span data-ttu-id="d3c12-108">Параметры запроса</span><span class="sxs-lookup"><span data-stu-id="d3c12-108">Query Options</span></span>|  
|----------------|-------------------|  
|<span data-ttu-id="d3c12-109">Одноэлементные прогнозирующие запросы</span><span class="sxs-lookup"><span data-stu-id="d3c12-109">Singleton prediction queries</span></span>|<span data-ttu-id="d3c12-110">Одноэлементный прогнозирующий запрос следует использовать, когда требуется предсказать результаты одного или нескольких новых вариантов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-110">Use a singleton query when you want to predict outcomes for a single new case, or multiple new cases.</span></span> <span data-ttu-id="d3c12-111">Входные значения передаются непосредственно в запрос, а сам запрос выполняется как один сеанс.</span><span class="sxs-lookup"><span data-stu-id="d3c12-111">You provide the input values directly in the query, and the query is executed as a single session.</span></span>|  
|<span data-ttu-id="d3c12-112">Пакетные прогнозы</span><span class="sxs-lookup"><span data-stu-id="d3c12-112">Batch predictions</span></span>|<span data-ttu-id="d3c12-113">Пакетные прогнозы используются при наличии внешних данных, которые требуется передать в модель для использования в качестве основы для прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="d3c12-113">Use batch predictions when you have external data that you want to feed into the model, to use as the basis for predictions.</span></span> <span data-ttu-id="d3c12-114">Чтобы можно было сделать прогноз по всему набору данных, данные из внешнего источника сопоставляются со столбцами в модели, а затем задается тип прогнозирующих данных, которые требуется получить.</span><span class="sxs-lookup"><span data-stu-id="d3c12-114">To make predictions for an entire set of data, you map the data in the external source to the columns in the model, and then specify the type of predictive data you want to output.</span></span><br /><br /> <span data-ttu-id="d3c12-115">Запрос для всего набора данных выполняется в рамках одного сеанса, поэтому такой вариант является намного более эффективным, чем отправка нескольких повторяющихся запросов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-115">The query for the entire dataset is executed in a single session, making this option much more efficient than sending multiple repeated queries.</span></span>|  
|<span data-ttu-id="d3c12-116">Прогнозы временных рядов</span><span class="sxs-lookup"><span data-stu-id="d3c12-116">Time Series predictions</span></span>|<span data-ttu-id="d3c12-117">Запрос к временному ряду используется, если требуется спрогнозировать значение на протяжении определенного числа будущих этапов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-117">Use a time series query when you want to predict a value over some number of future steps.</span></span> <span data-ttu-id="d3c12-118">Интеллектуальный анализ данных SQL Server предоставляет также для запросов к временным рядам следующие функции.</span><span class="sxs-lookup"><span data-stu-id="d3c12-118">SQL Server Data Mining also provides the following functionality in time series queries:</span></span><br /><br /> <span data-ttu-id="d3c12-119">Существующую модель можно расширить путем добавления новых данных в составе запроса и осуществлять прогнозы на основе составных рядов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-119">You can extend an existing model by adding new data as part of the query, and make predictions based on the composite series.</span></span><br /><br /> <span data-ttu-id="d3c12-120">Можно применить существующую модель к новому ряду данных с помощью параметра REPLACE_MODEL_CASES.</span><span class="sxs-lookup"><span data-stu-id="d3c12-120">You can apply an existing model to a new data series by using the REPLACE_MODEL_CASES option.</span></span><br /><br /> <span data-ttu-id="d3c12-121">Можно выполнять перекрестные прогнозы.</span><span class="sxs-lookup"><span data-stu-id="d3c12-121">You can perform cross-prediction.</span></span>|  
  
 <span data-ttu-id="d3c12-122">Ниже приведены сценарии, которые описывают общий синтаксис прогнозирующих запросов, различные типы прогнозирующих запросов, а также способы работы с результатами прогнозирующих запросов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-122">The following sections describe the general syntax of prediction queries, the different types of prediction queries, and how to work with the results of prediction queries.</span></span>  
  
 [<span data-ttu-id="d3c12-123">Базовый проект прогнозирующих запросов</span><span class="sxs-lookup"><span data-stu-id="d3c12-123">Basic Prediction Query Design</span></span>](#bkmk_PredQuery)  
  
-   [<span data-ttu-id="d3c12-124">Добавление прогнозирующих функций</span><span class="sxs-lookup"><span data-stu-id="d3c12-124">Adding Prediction Functions</span></span>](#bkmk_PredFunc)  
  
-   [<span data-ttu-id="d3c12-125">Одноэлементные запросы</span><span class="sxs-lookup"><span data-stu-id="d3c12-125">Singleton Queries</span></span>](#bkmk_SingletonQuery)  
  
-   [<span data-ttu-id="d3c12-126">Пакетные прогнозирующие запросы</span><span class="sxs-lookup"><span data-stu-id="d3c12-126">Batch Prediction Queries</span></span>](#bkmk_BatchQuery)  
  
 [<span data-ttu-id="d3c12-127">Работа с результатами запросов</span><span class="sxs-lookup"><span data-stu-id="d3c12-127">Working with the Results of Queries</span></span>](#bkmk_WorkResults)  
  
##  <a name="basic-prediction-query-design"></a><a name="bkmk_PredQuery"></a> <span data-ttu-id="d3c12-128">Конструирование простого прогнозирующего запроса</span><span class="sxs-lookup"><span data-stu-id="d3c12-128">Basic Prediction Query Design</span></span>  
 <span data-ttu-id="d3c12-129">При создании прогноза в модель обычно вводятся новые данные, и на их основе создается прогноз.</span><span class="sxs-lookup"><span data-stu-id="d3c12-129">When you create a prediction, you typically provide some piece of new data and ask the model to generate a prediction based on the new data.</span></span>  
  
-   <span data-ttu-id="d3c12-130">В пакетном прогнозирующем запросе модель сопоставляется с существующими данными с помощью *прогнозируемого соединения*.</span><span class="sxs-lookup"><span data-stu-id="d3c12-130">In a batch prediction query, you map the model to an external source of data by using a *prediction join*.</span></span>  
  
-   <span data-ttu-id="d3c12-131">В одноэлементном прогнозирующем запросе в качестве входных данных вводится одно или несколько значений.</span><span class="sxs-lookup"><span data-stu-id="d3c12-131">In a singleton prediction query, you type one or more values to use as inputs.</span></span> <span data-ttu-id="d3c12-132">С помощью одноэлементного прогнозирующего запроса можно создать несколько прогнозов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-132">You can create multiple predictions using a singleton prediction query.</span></span> <span data-ttu-id="d3c12-133">Однако если требуется создать несколько прогнозов, то использование пакетного запроса обеспечивает более высокую производительность.</span><span class="sxs-lookup"><span data-stu-id="d3c12-133">However, if you need to create many predictions, performance is better when you use a batch query.</span></span>  
  
 <span data-ttu-id="d3c12-134">Для определения новых данных и в одноэлементных и в пакетных прогнозирующих запросах используется синтаксис PREDICTION JOIN.</span><span class="sxs-lookup"><span data-stu-id="d3c12-134">Both singleton and batch prediction queries use the PREDICTION JOIN syntax to define the new data.</span></span> <span data-ttu-id="d3c12-135">Отличаются они способом указания входной части прогнозируемого соединения.</span><span class="sxs-lookup"><span data-stu-id="d3c12-135">The difference is in how the input side of the prediction join is specified.</span></span>  
  
-   <span data-ttu-id="d3c12-136">В пакетном прогнозирующем запросе данные поступают из внешнего источника данных, задаваемого конструкцией OPENQUERY.</span><span class="sxs-lookup"><span data-stu-id="d3c12-136">In a batch prediction query, the data comes from an external data source that is specified by using the OPENQUERY syntax.</span></span>  
  
-   <span data-ttu-id="d3c12-137">В одноэлементном прогнозирующем запросе данные передаются встроенными как часть запроса.</span><span class="sxs-lookup"><span data-stu-id="d3c12-137">In a singleton prediction query, the data is supplied inline as part of the query.</span></span>  
  
 <span data-ttu-id="d3c12-138">Для моделей временных рядов входные данные требуются не всегда. Прогнозы можно строить с помощью данных, которые уже есть в модели.</span><span class="sxs-lookup"><span data-stu-id="d3c12-138">For time series models, input data is not always required; it is possible to make predictions using just the data already in the model.</span></span> <span data-ttu-id="d3c12-139">Однако, если все же заданы новые входные данные, необходимо решить, будет ли использоваться обновление новых данных с расширением модели, или будут заменяться исходные ряды данных, использовавшиеся в модели.</span><span class="sxs-lookup"><span data-stu-id="d3c12-139">However, if you do specify new input data, you must decide whether you will use the new data to update and extend the model, or to replace the original series of data that was used in the model.</span></span>  <span data-ttu-id="d3c12-140">Дополнительные сведения об этих параметрах см. в разделе [Time Series Model Query Examples](time-series-model-query-examples.md).</span><span class="sxs-lookup"><span data-stu-id="d3c12-140">For more information about these options, see [Time Series Model Query Examples](time-series-model-query-examples.md).</span></span>  
  
###  <a name="adding-prediction-functions"></a><a name="bkmk_PredFunc"></a><span data-ttu-id="d3c12-141">Добавление прогнозирующих функций</span><span class="sxs-lookup"><span data-stu-id="d3c12-141">Adding Prediction Functions</span></span>  
 <span data-ttu-id="d3c12-142">Кроме предсказания значения, прогнозирующий запрос можно настроить таким образом, чтобы он возвращал различного рода сведения, связанные с прогнозом.</span><span class="sxs-lookup"><span data-stu-id="d3c12-142">In addition to predicting a value, you can customize a prediction query to return various kinds of information that are related to the prediction.</span></span> <span data-ttu-id="d3c12-143">Например, если прогноз вырабатывает список продуктов, которые стоит порекомендовать клиенту, то можно также настроить выдачу вероятности каждого прогноза так, чтобы их можно было ранжировать и предлагать пользователю только лучшие рекомендации.</span><span class="sxs-lookup"><span data-stu-id="d3c12-143">For example, if the prediction creates a list of products to recommend to a customer, you might also want to return the probability for each prediction, so that you can rank them and present only the top recommendations to the user.</span></span>  
  
 <span data-ttu-id="d3c12-144">Для этого добавьте *прогнозирующие функции* в запрос.</span><span class="sxs-lookup"><span data-stu-id="d3c12-144">To do this, you add *prediction functions* to the query.</span></span> <span data-ttu-id="d3c12-145">Каждый тип модели или запроса поддерживает конкретные функции.</span><span class="sxs-lookup"><span data-stu-id="d3c12-145">Each model or query type supports specific functions.</span></span> <span data-ttu-id="d3c12-146">Например, в моделях кластеризации поддерживаются особые прогнозирующие функции, предоставляющие дополнительные сведения о созданных в модели кластерах, тогда как модели временных рядов содержат функции, вычисляющие разницу между определенными моментами времени.</span><span class="sxs-lookup"><span data-stu-id="d3c12-146">For example, clustering models support special prediction functions that provide extra detail about the clusters created by the model, whereas time series models have functions that calculate differences over time.</span></span> <span data-ttu-id="d3c12-147">Существуют также общие прогнозирующие функции, работающие почти для всех типов моделей.</span><span class="sxs-lookup"><span data-stu-id="d3c12-147">There are also general prediction functions that work with almost all model types.</span></span> <span data-ttu-id="d3c12-148">Список прогнозирующих функций, поддерживаемых различными типами запросов, см. в этом разделе справочника по расширениям интеллектуального анализа данных: [Общие функции прогнозирования (расширения интеллектуального анализа данных)](/sql/dmx/general-prediction-functions-dmx).</span><span class="sxs-lookup"><span data-stu-id="d3c12-148">For a list of the prediction functions supported in different types of queries, see this topic the DMX reference:  [General Prediction Functions &#40;DMX&#41;](/sql/dmx/general-prediction-functions-dmx).</span></span>  
  
###  <a name="creating-singleton-prediction-queries"></a><a name="bkmk_SingletonQuery"></a><span data-ttu-id="d3c12-149">Создание одноэлементных прогнозирующих запросов</span><span class="sxs-lookup"><span data-stu-id="d3c12-149">Creating Singleton Prediction Queries</span></span>  
 <span data-ttu-id="d3c12-150">Одноэлементный прогнозирующий запрос удобен для создания простых прогнозов в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="d3c12-150">A singleton prediction query is useful when you want to create quick predictions in real time.</span></span> <span data-ttu-id="d3c12-151">Стандартная ситуация: вы получили сведения от клиента, например с помощью формы на веб-сайте, которые требуется передать в качестве входных данных в одноэлементный прогнозирующий запрос.</span><span class="sxs-lookup"><span data-stu-id="d3c12-151">A common scenario might be that you have obtained information from a customer, perhaps by using a form on a Web site, and you want to submit that data as the input to a singleton prediction query.</span></span> <span data-ttu-id="d3c12-152">Например, когда клиент выбирает продукт из списка, этот выбор можно использовать в качестве входных данных запроса, который прогнозирует, какие продукты лучше порекомендовать.</span><span class="sxs-lookup"><span data-stu-id="d3c12-152">For example, when a customer chooses a product from a list, you could use that selection as the input to a query that predicts the best products to recommend.</span></span>  
  
 <span data-ttu-id="d3c12-153">Одноэлементные прогнозирующие запросы не требуют отдельной таблицы, содержащей входные данные.</span><span class="sxs-lookup"><span data-stu-id="d3c12-153">Singleton prediction queries do not require a separate table that contains input.</span></span> <span data-ttu-id="d3c12-154">Вместо этого можно предоставить модели в качестве входных данных одну или несколько строк значений, при этом прогноз или прогнозы будут возвращаться в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="d3c12-154">Instead, you provide one or multiple rows of values as input to the model, and the prediction or predictions are returned in real time.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="d3c12-155">Несмотря на имя, Одноэлементные прогнозирующие запросы не просто делают единичные прогнозы. Вы можете создать несколько прогнозов для каждого набора входных данных.</span><span class="sxs-lookup"><span data-stu-id="d3c12-155">Despite the name, singleton prediction queries do not just make single predictions-you can generate multiple predictions for each set of inputs.</span></span> <span data-ttu-id="d3c12-156">Несколько входных вариантов передаются путем создания инструкции SELECT для каждого из них с последующим объединением этих вариантов с помощью оператора UNION.</span><span class="sxs-lookup"><span data-stu-id="d3c12-156">You provide multiple input cases by creating a SELECT statement for each input case and combining them with the UNION operator.</span></span>  
  
 <span data-ttu-id="d3c12-157">При создании одноэлементного прогнозирующего запроса нужно предоставить модели новые данные в виде PREDICTION JOIN (прогнозируемого соединения).</span><span class="sxs-lookup"><span data-stu-id="d3c12-157">When you create a singleton prediction query, you must provide the new data to the model in the form of a PREDICTION JOIN.</span></span> <span data-ttu-id="d3c12-158">Это означает, что, даже если сопоставление с существующей таблицей не производится, нужно убедиться, что новые данные соответствуют существующим столбцам модели интеллектуального анализа данных.</span><span class="sxs-lookup"><span data-stu-id="d3c12-158">This means that even though you are not mapping to an actual table, you must make sure that the new data matches the existing columns in the mining model.</span></span> <span data-ttu-id="d3c12-159">Если новые столбцы данных и новые данные полностью соответствуют, службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] установят соответствие столбцов автоматически.</span><span class="sxs-lookup"><span data-stu-id="d3c12-159">If the new data columns and the new data match exactly, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] will map the columns for you.</span></span> <span data-ttu-id="d3c12-160">Такое прогнозирующее соединение называется естественным ( *NATURAL PREDICTION JOIN*).</span><span class="sxs-lookup"><span data-stu-id="d3c12-160">This is called a *NATURAL PREDICTION JOIN*.</span></span> <span data-ttu-id="d3c12-161">Однако если столбцы не совпадают или новые данные не имеют такого же типа и объема, как данные модели, то необходимо задать соответствие столбцов модели новым данным или указать, какие данные отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="d3c12-161">However, if the columns do not match, or if the new data does not contain the same kind and amount of data that is in the model, you must specify which columns in the model map to the new data, or specify the missing values.</span></span>  
  
###  <a name="batch-prediction-queries"></a><a name="bkmk_BatchQuery"></a> <span data-ttu-id="d3c12-162">Пакетные прогнозирующие запросы</span><span class="sxs-lookup"><span data-stu-id="d3c12-162">Batch Prediction Queries</span></span>  
 <span data-ttu-id="d3c12-163">Пакетный прогнозирующий запрос полезен при наличии внешних данных, которые требуется использовать при составлении прогнозов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-163">A batch prediction query is useful when you have external data that you want to use in making predictions.</span></span> <span data-ttu-id="d3c12-164">Например, предположим, что имеется модель, которая разбивает клиентов на категории по их действиям на сайте и истории покупок.</span><span class="sxs-lookup"><span data-stu-id="d3c12-164">For example, you might have built a model that categorizes customers by their online activity and purchasing history.</span></span> <span data-ttu-id="d3c12-165">Можно применить эту модель к списку новых клиентов, чтобы создать прогнозы объемов продаж или определить цели предлагаемых рекламных кампаний.</span><span class="sxs-lookup"><span data-stu-id="d3c12-165">You could apply that model to a list of newly acquired leads, to create projections for sales, or to identify targets for proposed campaigns.</span></span>  
  
 <span data-ttu-id="d3c12-166">При выполнении прогнозируемого соединения необходимо сопоставить столбцы модели со столбцами из нового источника данных.</span><span class="sxs-lookup"><span data-stu-id="d3c12-166">When you perform a prediction join, you must map the columns the model to the columns in the new data source.</span></span> <span data-ttu-id="d3c12-167">Поэтому источник данных, выбранный в качестве входного, должен содержать данные, которые подобны данным из модели.</span><span class="sxs-lookup"><span data-stu-id="d3c12-167">Therefore, the data source that you choose for an input must data that is somewhat similar to the data in the model.</span></span> <span data-ttu-id="d3c12-168">Новые сведения не должны быть точно такими же и могут быть неполными.</span><span class="sxs-lookup"><span data-stu-id="d3c12-168">The new information does not have to match exactly, and can be incomplete.</span></span> <span data-ttu-id="d3c12-169">Например, предположим, что в обучении модели использовались сведения о доходе и возрасте, однако в списке клиентов, используемом для прогнозов, есть только возраст и ничего не сказано о доходе.</span><span class="sxs-lookup"><span data-stu-id="d3c12-169">For example, suppose the model was trained using information about income and age, but the customer list you are using for predictions has age but nothing about income.</span></span> <span data-ttu-id="d3c12-170">В этом случае все-таки можно сопоставить новые данные с моделью и создать прогноз для каждого клиента.</span><span class="sxs-lookup"><span data-stu-id="d3c12-170">In this scenario, you could still map the new data to the model and create a prediction for each customer.</span></span> <span data-ttu-id="d3c12-171">Однако если уровень дохода является важным показателем прогнозирования для данной модели, то отсутствие полных сведений может влиять на качество прогнозов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-171">However, if income was an important predictor for the model, the lack of complete information would affect the quality of predictions.</span></span>  
  
 <span data-ttu-id="d3c12-172">Чтобы получить наилучший результат, нужно соединить как можно больше совпадающих столбцов данных со столбцами модели.</span><span class="sxs-lookup"><span data-stu-id="d3c12-172">To get the best results, you should join as many of the matching columns as possible between the new data and the model.</span></span> <span data-ttu-id="d3c12-173">Однако запрос завершится успешно, даже если вообще не указать сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="d3c12-173">However, the query will succeed even if there are no matches.</span></span> <span data-ttu-id="d3c12-174">Если столбцы данных не соединить со столбцами модели, результатом запроса будет граничный прогноз, эквивалентный инструкции `SELECT <predictable-column> FROM <model>` без предложения PREDICTION JOIN.</span><span class="sxs-lookup"><span data-stu-id="d3c12-174">If no columns are joined, the query will return the marginal prediction, which is equivalent to the statement `SELECT <predictable-column> FROM <model>` without a PREDICTION JOIN clause.</span></span>  
  
 <span data-ttu-id="d3c12-175">После успешного сопоставления всех соответствующих столбцов выполняется запрос и службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] делают прогнозы для каждой строки новых данных на основе шаблонов из модели.</span><span class="sxs-lookup"><span data-stu-id="d3c12-175">After you have successfully mapped all relevant columns, you run the query, and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] makes predictions for each row in the new data based on patterns in the model.</span></span> <span data-ttu-id="d3c12-176">Результаты можно возвратить в новую таблицу, которая будет создана в представлении источников данных, содержащем внешние данные, либо скопировать и вставить с помощью среды [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] или [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d3c12-176">You can save the results back to a new table in the data source view that contains the external data, or you can copy and paste the data is you are using [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] or [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="d3c12-177">При использовании конструктора из среды [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]сначала необходимо определить внешний источник данных в качестве представления источников данных.</span><span class="sxs-lookup"><span data-stu-id="d3c12-177">If you use the designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], the external data source must first be defined as a data source view.</span></span>  
  
 <span data-ttu-id="d3c12-178">если для создания прогнозируемого соединения используются расширения интеллектуального анализа данных, внешний источник данных можно задать одной из следующих команд: OPENQUERY, OPENROWSET или SHAPE.</span><span class="sxs-lookup"><span data-stu-id="d3c12-178">If you use DMX to create a prediction join, you can specify the external data source by using the OPENQUERY, OPENROWSET, or SHAPE commands.</span></span> <span data-ttu-id="d3c12-179">По умолчанию для доступа к данным в шаблонах расширений интеллектуального анализа данных используется команда OPENQUERY.</span><span class="sxs-lookup"><span data-stu-id="d3c12-179">The default data access method in the DMX templates is OPENQUERY.</span></span> <span data-ttu-id="d3c12-180">Сведения об этих методах см. в разделе [&#60;запрос источника данных&#62;](/sql/dmx/source-data-query).</span><span class="sxs-lookup"><span data-stu-id="d3c12-180">For information about these methods, see [&#60;source data query&#62;](/sql/dmx/source-data-query).</span></span>  
  
###  <a name="predictions-in-time-series-mining-models"></a><a name="bkmk_TSQuery"></a> <span data-ttu-id="d3c12-181">Прогнозы для моделей временных рядов</span><span class="sxs-lookup"><span data-stu-id="d3c12-181">Predictions in Time Series Mining Models</span></span>  
 <span data-ttu-id="d3c12-182">Модели временных рядов отличаются от моделей других типов. Такую модель можно использовать в непосредственном виде для создания прогнозов либо предоставить новые данные, чтобы обновить модель и создать прогнозы на основе последних тенденций.</span><span class="sxs-lookup"><span data-stu-id="d3c12-182">Time series models are different from other models types; you can either use the model as it is to create predictions, or you can provide new data to the model to update the model and create predictions based on recent trends.</span></span> <span data-ttu-id="d3c12-183">В случае добавления новых данных можно указать, как эти новые данные должны использоваться.</span><span class="sxs-lookup"><span data-stu-id="d3c12-183">If you add new data, you can specify the way the new data should be used.</span></span>  
  
-   <span data-ttu-id="d3c12-184">*Увеличение количества обучающих вариантов модели* означает, что в существующие ряды данных модели временных рядов добавляются новые данные.</span><span class="sxs-lookup"><span data-stu-id="d3c12-184">*Extending the model cases* means that you add the new data onto the existing series of data in the time series model.</span></span> <span data-ttu-id="d3c12-185">Исходя из этого прогнозы основываются на новых, объединенных рядах.</span><span class="sxs-lookup"><span data-stu-id="d3c12-185">Henceforth, predictions are based on the new, combined series.</span></span> <span data-ttu-id="d3c12-186">Этот вариант удобен, если требуется просто добавить несколько точек данных в существующую модель.</span><span class="sxs-lookup"><span data-stu-id="d3c12-186">This option is good when you want to simply add a few data points to an existing model.</span></span>  
  
     <span data-ttu-id="d3c12-187">Допустим, существующая модель временных рядов обучалась на прошлогодних данных по продажам.</span><span class="sxs-lookup"><span data-stu-id="d3c12-187">For example, suppose that you have an existing time series model that has been trained on the sales data from the previous year.</span></span> <span data-ttu-id="d3c12-188">За несколько месяцев накопились новые данные по продажам, и теперь нужно обновить прогноз продаж для текущего года.</span><span class="sxs-lookup"><span data-stu-id="d3c12-188">After you have collected several months of new sales data, you decide to update your sales forecasts for the current year.</span></span> <span data-ttu-id="d3c12-189">Можно создать прогнозируемое соединение, которое обновит модель, добавив новые данные, и расширит ее для выполнения новых прогнозов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-189">You can create a prediction join that updates the model by adding new data and extends the model to make new predictions.</span></span>  
  
-   <span data-ttu-id="d3c12-190">*Замена обучающих вариантов модели* означает, что обученная модель сохраняется, но ее базовые варианты заменяются новыми данными.</span><span class="sxs-lookup"><span data-stu-id="d3c12-190">*Replacing the model cases* means that you keep the trained model, but replace the underlying cases with a new set of case data.</span></span> <span data-ttu-id="d3c12-191">Этот вариант полезен, если требуется сохранить тренд в модели и применить его к другому набору данных.</span><span class="sxs-lookup"><span data-stu-id="d3c12-191">This option is useful when you want to keep the trend in the model, but apply it to a different set of data.</span></span>  
  
     <span data-ttu-id="d3c12-192">Например, исходная модель могла быть обучена на наборе данных с очень высокими объемами продаж. При замене базовых данных новыми рядами (скажем, из магазина, объем продаж которого ниже) вы сохраняете тренд, но прогнозы начинаются со значений из новых рядов.</span><span class="sxs-lookup"><span data-stu-id="d3c12-192">For example, your original model might have been trained on a set of data with very high sales volumes; when you replace the underlying data with a new series (perhaps from a store with lower sales volume), you preserve the trend, but the predictions begin from the values in the replacement series.</span></span>  
  
 <span data-ttu-id="d3c12-193">При любом из этих подходов начальной точкой прогноза всегда будет конец исходной последовательности.</span><span class="sxs-lookup"><span data-stu-id="d3c12-193">Regardless of which approach you use, the starting point for predictions is always the end of the original series.</span></span>  
  
 <span data-ttu-id="d3c12-194">Дополнительные сведения о создании прогнозируемых соединений на моделях временных рядов см. в разделах [Примеры запросов моделей временных рядов](time-series-model-query-examples.md) и [PredictTimeSeries (расширения интеллектуального анализа данных)](/sql/dmx/predicttimeseries-dmx).</span><span class="sxs-lookup"><span data-stu-id="d3c12-194">For more information about how to create prediction joins on time series models, see [Time Series Model Query Examples](time-series-model-query-examples.md) or [PredictTimeSeries &#40;DMX&#41;](/sql/dmx/predicttimeseries-dmx).</span></span>  
  
##  <a name="working-with-the-results-of-a-prediction-query"></a><a name="bkmk_WorkResults"></a> <span data-ttu-id="d3c12-195">Работа с результатами прогнозирующего запроса</span><span class="sxs-lookup"><span data-stu-id="d3c12-195">Working with the Results of a Prediction Query</span></span>  
 <span data-ttu-id="d3c12-196">Варианты сохранения результатов прогнозирующего запроса интеллектуального анализа данных различаются в зависимости от способа создания запроса.</span><span class="sxs-lookup"><span data-stu-id="d3c12-196">Your options for saving the results of a data mining prediction query are different depending on how you create the query.</span></span>  
  
-   <span data-ttu-id="d3c12-197">Если построение запроса выполняется с помощью построителя прогнозирующих запросов в [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], результаты прогнозирующего запроса можно сохранять в существующем источнике данных [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d3c12-197">When you build a query using Prediction Query Builder in either [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], you can save the results of a prediction query to an existing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data source.</span></span> <span data-ttu-id="d3c12-198">Дополнительные сведения см. в разделе [Просмотр и сохранение результатов прогнозирующего запроса](view-and-save-the-results-of-a-prediction-query.md).</span><span class="sxs-lookup"><span data-stu-id="d3c12-198">For more information, see [View and Save the Results of a Prediction Query](view-and-save-the-results-of-a-prediction-query.md).</span></span>  
  
-   <span data-ttu-id="d3c12-199">При создании прогнозирующих запросов с помощью расширений интеллектуального анализа данных на панели запросов в [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]можно с помощью различных вариантов вывода запроса сохранять результаты в файле, на панели результатов запроса в виде текста либо в сетке.</span><span class="sxs-lookup"><span data-stu-id="d3c12-199">When you create prediction queries using DMX in the Query pane of [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], you can use the query output options to save the results to a file, or to the Query Results pane as text or in a grid.</span></span> <span data-ttu-id="d3c12-200">Дополнительные сведения см. в статье [Редакторы запросов и текста (SQL Server Management Studio)](../../relational-databases/scripting/query-and-text-editors-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="d3c12-200">For more information, see [Query and Text Editors &#40;SQL Server Management Studio&#41;](../../relational-databases/scripting/query-and-text-editors-sql-server-management-studio.md).</span></span>  
  
-   <span data-ttu-id="d3c12-201">При запуске прогнозирующего запроса с помощью компонентов служб Integration Services, задачи позволяют записывать результаты в базу данных с помощью доступного диспетчера соединений ADO.NET или OLEDB.</span><span class="sxs-lookup"><span data-stu-id="d3c12-201">When you run a prediction query using the Integration Services components, the tasks provides the ability to write the results to a database by using an available ADO.NET connection manager or OLEDB connection manager.</span></span> <span data-ttu-id="d3c12-202">Дополнительные сведения см. в статье [Data Mining Query Task](../../integration-services/control-flow/data-mining-query-task.md).</span><span class="sxs-lookup"><span data-stu-id="d3c12-202">For more information, see [Data Mining Query Task](../../integration-services/control-flow/data-mining-query-task.md).</span></span>  
  
 <span data-ttu-id="d3c12-203">Важно понимать, что результаты прогнозирующего запроса отличаются от результатов запроса к реляционной базе данных, который всегда возвращает одну строку связанных значений.</span><span class="sxs-lookup"><span data-stu-id="d3c12-203">It is important to understand that the results of a prediction query are not like the results of a query on a relational database, which always returns a single row of related values.</span></span> <span data-ttu-id="d3c12-204">Для каждой прогнозирующей функции расширений интеллектуального анализа данных, добавляемой к запросу, возвращается отдельный набор строк.</span><span class="sxs-lookup"><span data-stu-id="d3c12-204">Each DMX prediction function that you add to a query returns its own rowset.</span></span> <span data-ttu-id="d3c12-205">Поэтому при прогнозировании для одного варианта результатом может быть прогноз значения и в дополнение к нему — несколько столбцов вложенных таблиц с дополнительными сведениями.</span><span class="sxs-lookup"><span data-stu-id="d3c12-205">Therefore, when you make a prediction on a single case, the result might be a predicted value together with several columns of nested tables containing additional detail.</span></span>  
  
 <span data-ttu-id="d3c12-206">При сочетании нескольких функций в одном запросе возвращаемые результаты объединяются в иерархический набор строк.</span><span class="sxs-lookup"><span data-stu-id="d3c12-206">If you combine multiple functions in one query, the return results are combined as a hierarchical rowset.</span></span> <span data-ttu-id="d3c12-207">Например, допустим, для прогнозирования будущих значений суммы и количества продаж используется модель временных рядов, например как в приведенной ниже инструкции расширений интеллектуального анализа данных:</span><span class="sxs-lookup"><span data-stu-id="d3c12-207">For example, say you use a time series model to predict future values for sales amount and sales quantity, using a query such as this DMX statement:</span></span>  
  
```  
SELECT  
  PredictTimeSeries([Forecasting].[Amount]) as [PredictedAmount]  
, PredictTimeSeries([Forecasting].[Quantity]) as [PredictedQty]  
FROM  
  [Forecasting]  
  
```  
  
 <span data-ttu-id="d3c12-208">Результаты этого запроса представляют собой два столбца, по одному для каждого из прогнозируемых рядов, где каждая строка содержит вложенную таблицу с прогнозируемыми значениями.</span><span class="sxs-lookup"><span data-stu-id="d3c12-208">The results of this query are two columns, one for each predicted series, where each row contains a nested table with the predicted values:</span></span>  
  
 <span data-ttu-id="d3c12-209">**PredictedAmount**</span><span class="sxs-lookup"><span data-stu-id="d3c12-209">**PredictedAmount**</span></span>  
  
|<span data-ttu-id="d3c12-210">$TIME</span><span class="sxs-lookup"><span data-stu-id="d3c12-210">$TIME</span></span>|<span data-ttu-id="d3c12-211">"Сумма";</span><span class="sxs-lookup"><span data-stu-id="d3c12-211">Amount</span></span>|  
|-----------|------------|  
|<span data-ttu-id="d3c12-212">201101</span><span class="sxs-lookup"><span data-stu-id="d3c12-212">201101</span></span>|<span data-ttu-id="d3c12-213">172067.11</span><span class="sxs-lookup"><span data-stu-id="d3c12-213">172067.11</span></span>|  
  
|<span data-ttu-id="d3c12-214">$TIME</span><span class="sxs-lookup"><span data-stu-id="d3c12-214">$TIME</span></span>|<span data-ttu-id="d3c12-215">"Сумма";</span><span class="sxs-lookup"><span data-stu-id="d3c12-215">Amount</span></span>|  
|-----------|------------|  
|<span data-ttu-id="d3c12-216">201102</span><span class="sxs-lookup"><span data-stu-id="d3c12-216">201102</span></span>|<span data-ttu-id="d3c12-217">363390.68</span><span class="sxs-lookup"><span data-stu-id="d3c12-217">363390.68</span></span>|  
  
 <span data-ttu-id="d3c12-218">**PredictedQty**</span><span class="sxs-lookup"><span data-stu-id="d3c12-218">**PredictedQty**</span></span>  
  
|<span data-ttu-id="d3c12-219">$TIME</span><span class="sxs-lookup"><span data-stu-id="d3c12-219">$TIME</span></span>|<span data-ttu-id="d3c12-220">Количество</span><span class="sxs-lookup"><span data-stu-id="d3c12-220">Quantity</span></span>|  
|-----------|--------------|  
|<span data-ttu-id="d3c12-221">201101</span><span class="sxs-lookup"><span data-stu-id="d3c12-221">201101</span></span>|<span data-ttu-id="d3c12-222">77</span><span class="sxs-lookup"><span data-stu-id="d3c12-222">77</span></span>|  
  
|<span data-ttu-id="d3c12-223">$TIME</span><span class="sxs-lookup"><span data-stu-id="d3c12-223">$TIME</span></span>|<span data-ttu-id="d3c12-224">Количество</span><span class="sxs-lookup"><span data-stu-id="d3c12-224">Quantity</span></span>|  
|-----------|--------------|  
|<span data-ttu-id="d3c12-225">201102</span><span class="sxs-lookup"><span data-stu-id="d3c12-225">201102</span></span>|<span data-ttu-id="d3c12-226">260</span><span class="sxs-lookup"><span data-stu-id="d3c12-226">260</span></span>|  
  
 <span data-ttu-id="d3c12-227">Если данный поставщик не может обрабатывать иерархические наборы строк, то результаты можно перевести в плоский формат, добавив в прогнозирующий запрос ключевое слово FLATTEN.</span><span class="sxs-lookup"><span data-stu-id="d3c12-227">If your provider cannot handle hierarchical rowsets, you can flatten the results by using the FLATTEN keyword in the prediction query.</span></span> <span data-ttu-id="d3c12-228">Дополнительные сведения и примеры плоских наборов строк см. в разделе [SELECT (расширения интеллектуального анализа данных)](/sql/dmx/select-dmx).</span><span class="sxs-lookup"><span data-stu-id="d3c12-228">For more information, including examples of flattened rowsets, see [SELECT &#40;DMX&#41;](/sql/dmx/select-dmx).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d3c12-229">См. также:</span><span class="sxs-lookup"><span data-stu-id="d3c12-229">See Also</span></span>  
 <span data-ttu-id="d3c12-230">[Запросы содержимого &#40;интеллектуального анализа данных&#41;](content-queries-data-mining.md) </span><span class="sxs-lookup"><span data-stu-id="d3c12-230">[Content Queries &#40;Data Mining&#41;](content-queries-data-mining.md) </span></span>  
 [<span data-ttu-id="d3c12-231">Запросы, определяющие данные (интеллектуальный анализ данных)</span><span class="sxs-lookup"><span data-stu-id="d3c12-231">Data Definition Queries &#40;Data Mining&#41;</span></span>](data-definition-queries-data-mining.md)  
  
  
