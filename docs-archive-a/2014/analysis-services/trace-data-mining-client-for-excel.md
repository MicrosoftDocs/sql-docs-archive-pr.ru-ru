---
title: Трассировка (клиент интеллектуального анализа данных для Excel) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- tracer
- connections
ms.assetid: 4aea3e17-cd0f-48dd-8f22-b54a6c716426
author: minewiskan
ms.author: owend
ms.openlocfilehash: 74e1a5be21aa6981ccefa76f7bb1892d8d517be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738774"
---
# <a name="trace-data-mining-client-for-excel"></a>Трассировка (клиент интеллектуального анализа данных для Excel)
  ![Кнопка «Трассировка»](media/misc-trace.gif "Кнопка «Трассировка»")

 Диалоговое окно **Трассировщик** служит для наблюдения за инструкциями, которые передаются в экземпляр служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] , используемый для интеллектуального анализа данных. После создания соединения с экземпляром служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]взаимодействие клиента и сервера регистрируется в области **Трассировка** , в том числе инструкции создания структур, добавления моделей интеллектуального анализа данных, прогнозирования, а также некоторые сообщения, возвращаемые с сервера.

 В зависимости от запрашиваемого действия инструкция может быть запросом определения данных или запросом обработки данных расширений интеллектуального анализа данных, пакетом языка ASSL или вызовом хранимой процедуры служб Analysis Services. Однако фактические числовые результаты и значения данных не показываются.

 На панели**Трассировка** отслеживаются только текущие соединения, а содержимое диалогового окна **Трассировкаr** не сохраняется.

## <a name="options"></a>Варианты
 В панели трассировщика перечислены все инструкции, отправленные с клиента Excel на сервер.

 В зависимости от запрашиваемого действия инструкция может быть инструкцией расширений интеллектуального анализа данных для обработки или определения данных, вызовом хранимой процедуры служб Analysis Services или пакетом XML/A.

 **Текущее соединение** Выберите эту команду, чтобы отобразить описание текущего соединения. Это описание включает имя соединения, поставщика, источник данных, каталог, время соединения, использовавшееся для транзакции, и текущее состояние (активное, неактивное).

 **Использовать модели сеанса** Установите этот флажок, чтобы сохранить на сервере модели и структуры интеллектуального анализа данных как временные объекты. Создаваемые модели и структуры доступны только до конца текущего сеанса.

 Снимите этот флажок, чтобы сохранить модели или структуры на сервере служб Analysis Services.

 **Примечание.** Возможность использовать временные объекты доступна только в том случае, если используются средства анализа таблиц для Excel. Для шаблонов интеллектуального анализа данных Visio и клиента интеллектуального анализа данных для Excel требуется, чтобы структуры и модели сохранялись на сервере.

## <a name="tracing-temporary-structures-and-models"></a>Временные структуры и модели трассировки
 При использовании средств анализа таблиц, по умолчанию создающих временные структуры и модели, действия сервера и клиента регистрируются, но созданные модели или структуры не сохраняются на сервере.

 Если нужно сохранить результаты работы с одним из средств анализа таблиц, можно снять флажок **Использовать модели сеанса**, в результате чего модели будут сохранены на сервере. Можно также скопировать инструкции из области **Трассировка** в файл, чтобы позже можно было создать повторно проделанную работу.

## <a name="understanding-sessions"></a>Основные сведения о сеансах
 При соединении с экземпляром служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]надстройка интеллектуального анализа данных инициирует сеанс. Каждый сеанс получает идентификатор сеанса, определяющий его в экземпляре служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] . Однако идентификатор сеанса не гарантирует того, что сеанс остается допустимым. Срок действия сеанса может истечь, если будет превышено время ожидания или произойдет отключение соединения, связанного с этим сеансом. Если время сеанса истекает и он становится недействительным, службы [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] завершают сеанс и выполняют откат текущих транзакций. Если сообщение отправляется с идентификатором недействительного сеанса, то происходит возврат ошибки, указывающей, что заданный сеанс не найден.

 Несмотря на то, что некоторые модели интеллектуального анализа данных хранятся на сервере в явном виде, на нем не сохраняются применяемые в сеансе модели и структуры интеллектуального анализа данных, а также не сохраняются записи о действиях по интеллектуальному анализу данных во время сеанса. Так как временные модели и структуры интеллектуального анализа данных удаляются сразу же после завершения сеанса, не следует закрывать книгу Excel, не сохранив ту работу, которая понадобится в дальнейшем.

## <a name="changing-connections"></a>Изменение соединений
 При смене соединения трассировки предыдущих соединений не удаляются. Сеанс удаляется только закрытием книги.

 Если изменить соединение, продолжая работать в книге Excel, это изменение не отражается на панели **Трассировка** . Чтобы явно отобразить имя и состояние текущего соединения, нужно щелкнуть **Текущее соединение**.

## <a name="understanding-statements-in-the-tracer"></a>Основные сведения об инструкциях в трассировщике
 На языке расширений интеллектуального анализа данных можно создавать модели интеллектуального анализа данных в службах [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]и работать с ними. Расширения интеллектуального анализа данных могут использоваться для создания структуры новых моделей интеллектуального анализа данных, обучения этих моделей, а также для их просмотра, управления и выполнения прогнозов с их помощью. Расширения интеллектуального анализа данных состоят из инструкций языка определения данных (DDL), инструкций языка обработки данных (DML), а также функций и операторов.

 Подробное обсуждение инструкций расширений интеллектуального анализа данных и их синтаксиса не является темой этого раздела. Однако сведения на панели **Трассировка** позволяют использовать для поиска подробных сведений о работе инструкции расширений интеллектуального анализа данных. Надстройки интеллектуального анализа данных для Excel дают возможность легко создавать сложные инструкции расширений интеллектуального анализа данных и взаимодействовать с сервером служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] . Дополнительные сведения см. в разделе [Query &#40;SQL Server надстроек интеллектуального анализа данных&#41;](query-sql-server-data-mining-add-ins.md).

> [!NOTE]
>  Многие инструкции DMX параметризируются. Для простых типов значения параметров перечисляются в инструкции. Однако для сложных типов перечисляются только типы параметров.

 Службы SQL Server Analysis Services используют протокол XML для аналитики (XMLA) для обработки любого взаимодействия клиентских приложений (включая клиент интеллектуального анализа данных для Excel) и экземпляра служб [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].

 Дополнительные сведения о синтаксисе расширений интеллектуального анализа данных и о командах и элементах XMLA см. в электронной документации по [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .

 Некоторые инструкции, посылаемые на сервер, могут включать запросы, вызывающие системные хранимые процедуры служб Analysis Services. Дополнительные сведения см. в электронной документации по SQL Server.


