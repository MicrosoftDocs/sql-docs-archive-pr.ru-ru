---
title: Создание хранимых процедур | Документация Майкрософт
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- registering assemblies
- database assemblies [Analysis Services]
- server assemblies [Analysis Services]
- stored procedures [Analysis Services], creating
- assemblies [Analysis Services]
ms.assetid: a12ff02f-6d0b-4488-9846-3609fc0d0554
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9a997244a2d54cca8732196107dd21927b5f9e2f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87732166"
---
# <a name="creating-stored-procedures"></a>Создание хранимых процедур
  Для использования любой хранимой процедуры необходимо, чтобы она была связана с классом среды CLR или модели COM. Класс должен быть установлен на сервере — обычно в виде [!INCLUDE[msCoName](../../includes/msconame-md.md)] библиотеки динамической компоновки ActiveX® (DLL) и регистрируется как сборка на сервере или в [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] базе данных.  
  
 Хранимые процедуры регистрируются на сервере или в базе данных. Серверные хранимые процедуры могут вызываться из контекста любого запроса. Доступ к хранимым процедурам базы данных имеется, только если контекст базы данных представляет собой базу данных, в которой определена хранимая процедура. Если функции из одной сборки вызывают функции из другой сборки, то необходимо зарегистрировать обе сборки в одном и том же контексте (сервера или базы данных). Для сервера или развернутой [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] базы данных на сервере можно использовать [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] для регистрации сборки. Для проекта служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] можно использовать конструктор служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] для регистрации сборки в проекте.  
  
> [!IMPORTANT]  
>  Использование сборок COM может представлять угрозу безопасности. По этой причине, а также по ряду других сборки COM в службах [!INCLUDE[ssASversion10](../../includes/ssasversion10-md.md)]являются устаревшими. Поддержка сборок COM в последующих версиях может быть прекращена.  
  
## <a name="registering-a-server-assembly"></a>Регистрация серверной сборки  
 В обозревателе объектов в среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] список серверных сборок приведен в папке «Сборки» под экземпляром служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Серверные сборки могут содержать как сборки .NET (среды CLR), так и библиотеки COM.  
  
### <a name="to-create-a-server-assembly"></a>Создание серверной сборки  
  
1.  Разверните экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в обозревателе объектов, щелкните правой кнопкой мыши папку **сборки** и выберите пункт **создать сборку**. Откроется диалоговое окно **Регистрация сборки сервера** .  
  
2.  В поле **тип** укажите тип сборки:  
  
    -   Для DLL-библиотеки управляемого кода (среда CLR) задайте сборку .NET.  
  
    -   Для DLL-библиотеки собственного кода (COM) укажите COM DLL.  
  
3.  В поле **имя файла**укажите библиотеку DLL, содержащую хранимые процедуры.  
  
4.  В поле **имя сборки**укажите имя сборки.  
  
5.  Если это отладочная сборка библиотеки, которую вы собираетесь использовать для отладки хранимых процедур, установите флажок **включить отладочную информацию** . Дополнительные сведения об отладке хранимых процедур см. в разделе [Отладка хранимых процедур](debugging-stored-procedures.md).  
  
6.  Можно нажать кнопку **ОК** для немедленной регистрации сборки или на панели инструментов диалогового окна, **чтобы создать скрипт** действия регистрации в окне запроса, в файле или в буфере обмена.  
  
 После регистрации серверной сборки ее можно настроить, щелкнув правой кнопкой мыши сборку в обозревателе объектов и выбрав пункт **Свойства**.  
  
## <a name="registering-a-database-assembly-on-the-server"></a>Регистрация сборки базы данных на сервере  
 В обозревателе объектов в среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] список сборок базы данных приведен в папке «Сборки» под базой данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Сборки баз данных могут содержать как сборки .NET (среда CLR), так и библиотеки COM.  
  
### <a name="to-create-a-database-assembly-on-a-server"></a>Создание сборки базы данных на сервере  
  
1.  Разверните экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] базы данных в обозревателе объектов, щелкните правой кнопкой мыши папку **сборки** и выберите пункт **создать сборку**. Откроется диалоговое окно **Регистрация сборки базы данных** .  
  
2.  В поле **тип** укажите тип сборки:  
  
    -   Для DLL-библиотеки управляемого кода (среда CLR) задайте сборку .NET.  
  
    -   Для DLL-библиотеки собственного кода (COM) укажите COM DLL.  
  
3.  В поле **имя файла**укажите библиотеку DLL, содержащую хранимые процедуры.  
  
4.  В поле **имя сборки**укажите имя сборки.  
  
5.  Если это отладочная сборка библиотеки, которую вы собираетесь использовать для отладки хранимых процедур, установите флажок **включить отладочную информацию** . Дополнительные сведения об отладке хранимых процедур см. в разделе [Отладка хранимых процедур](debugging-stored-procedures.md).  
  
6.  Можно нажать кнопку **ОК** для немедленной регистрации сборки или на панели инструментов диалогового окна, **чтобы создать скрипт** действия регистрации в окне запроса, в файле или в буфере обмена.  
  
 После регистрации сборки базы данных ее можно настроить, щелкнув правой кнопкой мыши сборку в обозревателе объектов и выбрав пункт **Свойства**.  
  
## <a name="registering-a-database-assembly-in-a-project"></a>Регистрация сборки базы данных в проекте  
 В обозревателе объектов в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] список сборок базы данных приведен в папке «Сборки» под проектом служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Сборки баз данных могут содержать как сборки .NET (среда CLR), так и библиотеки COM.  
  
### <a name="to-create-a-database-assembly-in-an-analysis-service-project"></a>Создание сборки базы данных в проекте служб Analysis Service  
  
1.  Разверните экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] базы данных в обозревателе объектов, щелкните правой кнопкой мыши папку **сборки** и выберите пункт **создать ссылку на сборку**. Откроется диалоговое окно **Добавление ссылки** . На вкладке **.NET** диалогового окна **Добавление ссылки** перечислены существующие сборки .NET (среда CLR), а на вкладке **проекты** перечислены проекты.  
  
2.  Можно щелкнуть существующий компонент или проект и нажать кнопку **Добавить** , чтобы добавить его в [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] проект. Чтобы добавить ссылку на DLL-библиотеку COM, щелкните вкладку **Обзор** , чтобы найти файл. В списке **Выбранные проекты и компоненты** отображаются имя, тип, версия и расположение для каждого компонента, добавляемого в проект.  
  
3.  Завершив выбор компонентов для добавления, нажмите кнопку **ОК** , чтобы добавить их в [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] проект.  
  
## <a name="script-format-for-an-assembly"></a>Формат скрипта для сборки  
 Регистрация сборки .NET довольно проста. Сборка .NET добавляется к базе данных в бинарном виде с использованием следующего формата:  
  
```  
<Create>  
   <ObjectDefinition>  
      <Assembly>  
         <Files>  
            <File>  
               <Name>filename</Name>  
               <Type>filetype</Type>  
               <Data>  
                  <Block>binarydatablock</Block>  
                  <Block>binarydatablock</Block>  
                  ...  
               </Data>  
            </File>  
         </Files>  
         <PermissionSet>PermissionSet</PermissionSet>  
      </Assembly>  
   <ObjectDefinition>  
</Create>  
```  
  
## <a name="see-also"></a>См. также:  
 [Управление сборками многомерной модели](../multidimensional-models/multidimensional-model-assemblies-management.md)   
 [Определение хранимых процедур](defining-stored-procedures.md)  
  
  
