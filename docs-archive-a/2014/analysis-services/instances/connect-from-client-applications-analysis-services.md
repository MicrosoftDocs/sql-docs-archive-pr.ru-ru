---
title: Подключение из клиентских приложений (Analysis Services) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b1e0f1d4-0b87-4ad3-8172-f746fe2f16a2
author: minewiskan
ms.author: owend
ms.openlocfilehash: cb93d3a44345d750070a3dda60f82693fd61500b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87731109"
---
# <a name="connect-from-client-applications-analysis-services"></a><span data-ttu-id="75aab-102">Подключение из клиентских приложений (службы Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="75aab-102">Connect from client applications (Analysis Services)</span></span>
  <span data-ttu-id="75aab-103">Начинающим пользователям служб Analysis Services следует использовать сведения в этом разделе для подключения к существующему экземпляру служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] с помощью стандартных средств и приложений.</span><span class="sxs-lookup"><span data-stu-id="75aab-103">If you are new to Analysis Services, use the information in this topic to connect to an existing instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] using common tools and applications.</span></span> <span data-ttu-id="75aab-104">В этом разделе также объясняется, как подключаться для тестирования под разными удостоверениями пользователей.</span><span class="sxs-lookup"><span data-stu-id="75aab-104">This topic also explains how to connect under different user identities for testing purposes.</span></span>  
  
-   [<span data-ttu-id="75aab-105">Подключение с помощью SQL Server Management Studio (SSMS)</span><span class="sxs-lookup"><span data-stu-id="75aab-105">Connect using SQL Server Management Studio (SSMS)</span></span>](#bkmk_SSMS)  
  
-   [<span data-ttu-id="75aab-106">Подключение с использованием Excel</span><span class="sxs-lookup"><span data-stu-id="75aab-106">Connect using Excel</span></span>](#bkmk_excel)  
  
-   [<span data-ttu-id="75aab-107">Соединение с помощью SQL Server Data Tools</span><span class="sxs-lookup"><span data-stu-id="75aab-107">Connect using SQL Server Data Tools</span></span>](#bkmk_SSDT)  
  
-   [<span data-ttu-id="75aab-108">Проверка подключения</span><span class="sxs-lookup"><span data-stu-id="75aab-108">Test connections</span></span>](#bkmk_tshoot)  
  
 <span data-ttu-id="75aab-109">Справочная документация по строкам подключений предоставляется отдельно.</span><span class="sxs-lookup"><span data-stu-id="75aab-109">Connection string reference documentation is provided separately.</span></span> <span data-ttu-id="75aab-110">Дополнительные сведения см. в разделе [Свойства строки подключения (службы Analysis Services)](connection-string-properties-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="75aab-110">For more information, see [Connection String Properties &#40;Analysis Services&#41;](connection-string-properties-analysis-services.md).</span></span>  
  
 <span data-ttu-id="75aab-111">Успешные подключения зависят от допустимой настройки портов и соответствующих разрешений пользователя.</span><span class="sxs-lookup"><span data-stu-id="75aab-111">Successful connections depend on a valid port configuration and appropriate user permissions.</span></span> <span data-ttu-id="75aab-112">Для более подробного знакомства с каждым требованием воспользуйтесь следующими ссылками.</span><span class="sxs-lookup"><span data-stu-id="75aab-112">Click the following links to learn more about each requirement.</span></span>  
  
-   [<span data-ttu-id="75aab-113">Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services</span><span class="sxs-lookup"><span data-stu-id="75aab-113">Configure the Windows Firewall to Allow Analysis Services Access</span></span>](configure-the-windows-firewall-to-allow-analysis-services-access.md)  
  
-   [<span data-ttu-id="75aab-114">Предоставление доступа к объектам и операциям (службы Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="75aab-114">Authorizing access to objects and operations &#40;Analysis Services&#41;</span></span>](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)  
  
##  <a name="connect-using-sql-server-management-studio-ssms"></a><a name="bkmk_SSMS"></a> <span data-ttu-id="75aab-115">Подключение с помощью среды SQL Server Management Studio (SSMS)</span><span class="sxs-lookup"><span data-stu-id="75aab-115">Connect using SQL Server Management Studio (SSMS)</span></span>  
 <span data-ttu-id="75aab-116">Подключение к службам Analysis Services в среде SSMS для управления экземплярами сервера и базами данных в интерактивном режиме.</span><span class="sxs-lookup"><span data-stu-id="75aab-116">Connect to Analysis Services in SSMS to manage server instances and databases interactively.</span></span> <span data-ttu-id="75aab-117">Можно также запустить запросы XMLA или многомерных выражений для выполнения задач администрирования или получения данных.</span><span class="sxs-lookup"><span data-stu-id="75aab-117">You can also run XMLA or MDX queries to perform administrative tasks or retrieve data.</span></span> <span data-ttu-id="75aab-118">В отличие от других средств и приложений, которые загружают базы данных, только если отправляется запрос, среда SSMS загружает все базы данных при соединении с сервером, предполагая, что разрешение на просмотр базы данных имеется.</span><span class="sxs-lookup"><span data-stu-id="75aab-118">In contrast with other tools and applications that only load databases when a query is sent, SSMS loads all databases when you connect to the server, assuming you have permission to view the database.</span></span> <span data-ttu-id="75aab-119">Это означает, что, если на сервере есть множество табличных баз данных, все они будут загружены в память системы при установке соединения с помощью среды SSMS.</span><span class="sxs-lookup"><span data-stu-id="75aab-119">This means that if you have numerous tabular databases on the server, all are loaded into system memory when you connect using SSMS.</span></span>  
  
 <span data-ttu-id="75aab-120">Разрешения можно проверить с помощью среды SSMS с определенным удостоверением пользователя, а затем подключиться к службам Analysis Services от имени этого пользователя.</span><span class="sxs-lookup"><span data-stu-id="75aab-120">You can test permissions by running SSMS under a specific user identity and then connect to Analysis Services as that user.</span></span>  
  
 <span data-ttu-id="75aab-121">Удерживайте клавишу SHIFT и щелкните правой кнопкой мыши значок **Среда SQL Server Management Studio** , чтобы получить доступ к параметру **Запуск от имени другого пользователя** .</span><span class="sxs-lookup"><span data-stu-id="75aab-121">Hold-down the Shift key and right-click the **SQL Server Management Studio** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="75aab-122">Запустите среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="75aab-122">Start [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="75aab-123">В диалоговом окне **Соединение с сервером** выберите тип сервера служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75aab-123">In the **Connect to Server** dialog box, select the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server type.</span></span>  
  
2.  <span data-ttu-id="75aab-124">На вкладке «Вход» введите имя сервера, указав имя компьютера, на котором запущен сервер.</span><span class="sxs-lookup"><span data-stu-id="75aab-124">In the Login tab, enter the server name by typing the name of the computer on which the server is running.</span></span> <span data-ttu-id="75aab-125">Сервер можно указать с помощью его сетевого имени или полного имени домена.</span><span class="sxs-lookup"><span data-stu-id="75aab-125">You can specify the server using its network name or a fully-qualified domain name.</span></span>  
  
     <span data-ttu-id="75aab-126">Для именованного экземпляра имя сервера необходимо указывать в следующем формате: имя_сервера\имя_экземпляра.</span><span class="sxs-lookup"><span data-stu-id="75aab-126">For a named instance, the server name must be specified in this format: servername\instance name.</span></span> <span data-ttu-id="75aab-127">Примером такого контекста именования может быть ADV-SRV062\Finance для сервера с сетевым именем ADV-SRV062, где службы Analysis Services были установлены в качестве именованного экземпляра под названием Finance.</span><span class="sxs-lookup"><span data-stu-id="75aab-127">An example of this naming convention might be ADV-SRV062\Finance for a server that has a network name of ADV-SRV062, where Analysis Services was installed as a named instance entitled Finance.</span></span>  
  
     <span data-ttu-id="75aab-128">Подключение к серверам, развернутым в отказоустойчивом кластере, выполняется с использованием сетевого имени кластера службы SSAS.</span><span class="sxs-lookup"><span data-stu-id="75aab-128">For servers deployed in a failover cluster, connect using the network name of the SSAS cluster.</span></span> <span data-ttu-id="75aab-129">Это имя указывается во время установки SQL Server как **Сетевое имя SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="75aab-129">This name is specified during SQL Server setup, as **SQL Server Network Name**.</span></span> <span data-ttu-id="75aab-130">Обратите внимание, что при установке служб SSAS в качестве именованного экземпляра в отказоустойчивый кластер Windows Server (WSFC) при установке соединения имя экземпляра никогда не добавляется.</span><span class="sxs-lookup"><span data-stu-id="75aab-130">Note that if you installed SSAS as a named instance onto a Windows Server Failover Cluster (WSFC), you never add the instance name on the connection.</span></span> <span data-ttu-id="75aab-131">Это уникальная особенность служб SSAS. Именованный же экземпляр кластеризованного ядра реляционной базы данных, напротив, содержит имя экземпляра.</span><span class="sxs-lookup"><span data-stu-id="75aab-131">This practice is unique to SSAS; in contrast, a named instance of a clustered relational database engine does include the instance name.</span></span> <span data-ttu-id="75aab-132">Например, если установлены и службы SSAS, и ядро СУБД как именованный экземпляр (Contoso-Accounting) с сетевым именем SQL Server «SQL-CLU», то для подключения к службам SSAS следует использовать имя «SQL-CLU», а к ядру СУБД — «SQL-CLU\Contoso-Accounting».</span><span class="sxs-lookup"><span data-stu-id="75aab-132">For example, if you installed both SSAS and the database engine as named instance (Contoso-Accounting) with a SQL Server Network Name of SQL-CLU, you would connect to SSAS using "SQL-CLU" and to the database engine as "SQL-CLU\Contoso-Accounting".</span></span> <span data-ttu-id="75aab-133">Дополнительные сведения и примеры см. в разделе [Кластеризация служб SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) .</span><span class="sxs-lookup"><span data-stu-id="75aab-133">See [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) for more information and examples.</span></span>  
  
     <span data-ttu-id="75aab-134">Подключение к серверам, развернутым в кластере с балансировкой нагрузки, устанавливается с использованием имени виртуального сервера NLB.</span><span class="sxs-lookup"><span data-stu-id="75aab-134">For servers deployed in a network load balanced cluster, connect using the virtual server name of the NLB.</span></span>  
  
3.  <span data-ttu-id="75aab-135">Проверка подлинности всегда осуществляется средствами Windows, а удостоверение пользователя всегда означает пользователя Windows, который подключается посредством среды Management Studio.</span><span class="sxs-lookup"><span data-stu-id="75aab-135">Authentication is always Windows authentication, and the user identity is always the Windows user who is connecting via Management Studio.</span></span>  
  
     <span data-ttu-id="75aab-136">Для успешного подключения необходимо разрешение на доступ к серверу или к базе данных на сервере.</span><span class="sxs-lookup"><span data-stu-id="75aab-136">In order for the connection to succeed, you must have permission to access the server or a database on the server.</span></span> <span data-ttu-id="75aab-137">Для большинства задач, которые нужно выполнять в среде Management Studio, требуется разрешение администратора.</span><span class="sxs-lookup"><span data-stu-id="75aab-137">Most tasks that you want to perform in Management Studio require administrative permissions.</span></span> <span data-ttu-id="75aab-138">Убедитесь, что учетная запись, с которой устанавливается соединение, является членом роли администратора сервера.</span><span class="sxs-lookup"><span data-stu-id="75aab-138">Ensure that the account you are connecting with is a member of the Server Administrator role.</span></span> <span data-ttu-id="75aab-139">Дополнительные сведения см. в статьях [предоставление разрешений администратора сервера &#40;Analysis Services&#41;](grant-server-admin-rights-to-an-analysis-services-instance.md).</span><span class="sxs-lookup"><span data-stu-id="75aab-139">For more information, see [Grant Server Administrator Permissions &#40;Analysis Services&#41;](grant-server-admin-rights-to-an-analysis-services-instance.md).</span></span>  
  
4.  <span data-ttu-id="75aab-140">Нажмите кнопку **Свойства соединения** , чтобы указать конкретную базу данных, задать время ожидания или параметры шифрования.</span><span class="sxs-lookup"><span data-stu-id="75aab-140">Click **Connection Properties** to specify a particular database, set timeout values, or encryption options.</span></span> <span data-ttu-id="75aab-141">Дополнительные сведения о соединении содержат свойства соединения, используемые только для текущего соединения.</span><span class="sxs-lookup"><span data-stu-id="75aab-141">Optional connection information includes connection properties used for the current connection only.</span></span>  
  
5.  <span data-ttu-id="75aab-142">Перейдите на вкладку **Дополнительные параметры соединения** , чтобы задать свойства соединения, недоступные в диалоговом окне «Подключение к серверу».</span><span class="sxs-lookup"><span data-stu-id="75aab-142">Click **Additional Connection Parameters** tab to set connection properties not available in the Connect to Server dialog box.</span></span> <span data-ttu-id="75aab-143">Например, можно ввести `Roles=Reader` в текстовом поле.</span><span class="sxs-lookup"><span data-stu-id="75aab-143">For example, you might type `Roles=Reader` in the text box.</span></span>  
  
     <span data-ttu-id="75aab-144">Подключение через роль с меньшим числом разрешений позволяет протестировать поведение базы данных, когда активна эта роль.</span><span class="sxs-lookup"><span data-stu-id="75aab-144">Connecting through a role with less permission lets you test database behaviors when that role is in effect.</span></span>  
  
    ```  
    Provider=MSOLAP; Data Source=SERVERNAME; Initial Catalog=AdventureWorks2012; Roles=READER  
    ```  
  
##  <a name="connect-using-excel"></a><a name="bkmk_excel"></a><span data-ttu-id="75aab-145">Подключение с помощью Excel</span><span class="sxs-lookup"><span data-stu-id="75aab-145">Connect using Excel</span></span>  
 <span data-ttu-id="75aab-146">Microsoft Excel часто используется для анализа бизнес-данных.</span><span class="sxs-lookup"><span data-stu-id="75aab-146">Microsoft Excel is often used for analyzing business data.</span></span> <span data-ttu-id="75aab-147">В рамках установки Excel пакет Office устанавливает поставщик OLE DB для служб Analysis Services (MSOLAP DDL), ADOMD.NET и другие поставщики данных, облегчающие подготовку к использованию данных на сетевых серверах.</span><span class="sxs-lookup"><span data-stu-id="75aab-147">As part of an Excel installation, Office installs the Analysis Services OLE DB provider (MSOLAP DLL), ADOMD.NET, and other data providers so that you can more readily use the data on your network servers.</span></span> <span data-ttu-id="75aab-148">При использовании одной из новых версий служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] с клиентом более старой версии Excel, вероятнее всего, потребуется установить более новые версии поставщиков данных на каждую рабочую станцию, которая подключается к службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="75aab-148">If you are using a newer version of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] with an older version of Excel, you most likely need to install newer data providers on each workstation that connects to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="75aab-149">Дополнительные сведения см. в разделе [Поставщики данных, используемые для соединений со службами Analysis Services](data-providers-used-for-analysis-services-connections.md) .</span><span class="sxs-lookup"><span data-stu-id="75aab-149">See [Data providers used for Analysis Services connections](data-providers-used-for-analysis-services-connections.md) for more information.</span></span>  
  
 <span data-ttu-id="75aab-150">При настройке соединения с кубом служб Analysis Services или шаблоном базы данных Excel сохраняет сведения о соединении в ODC-файле для использования в будущем.</span><span class="sxs-lookup"><span data-stu-id="75aab-150">When you set up a connection to an Analysis Services cube or tabular model database, Excel saves the connection information in .odc file for future use.</span></span> <span data-ttu-id="75aab-151">Соединение выполняется в контексте безопасности текущего пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="75aab-151">The connection is made in security context of the current Windows user.</span></span> <span data-ttu-id="75aab-152">Для успешного соединения у этой учетной записи пользователя должно быть разрешение на чтение базы данных.</span><span class="sxs-lookup"><span data-stu-id="75aab-152">The user account must have read permissions on the database in order for the connection to succeed.</span></span>  
  
 <span data-ttu-id="75aab-153">При использовании данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] из книги Excel соединения поддерживаются в течение времени выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="75aab-153">When using [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data in an Excel workbook, connections are held for the duration of a query request.</span></span> <span data-ttu-id="75aab-154">Именно поэтому при отслеживании рабочей нагрузки по обработке запросов из Excel, вероятнее всего, будет видно большое количество соединений для каждого сеанса, которые поддерживаются в течение очень короткого периода времени.</span><span class="sxs-lookup"><span data-stu-id="75aab-154">This is why you are likely to see lots of connections for each session, held for very short periods of time, when monitoring a query workload from Excel.</span></span>  
  
 <span data-ttu-id="75aab-155">Разрешения можно проверить, запуская Excel с конкретным удостоверением пользователя.</span><span class="sxs-lookup"><span data-stu-id="75aab-155">You can test permissions by starting Excel under a specific user identity.</span></span>  
  
 <span data-ttu-id="75aab-156">Удерживайте клавишу SHIFT и щелкните правой кнопкой мыши значок **Excel** , чтобы получить доступ к параметру **Запуск от имени другого пользователя** .</span><span class="sxs-lookup"><span data-stu-id="75aab-156">Hold-down the Shift key and right-click the **Excel** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="75aab-157">На вкладке «Данные» в Excel щелкните **«Из других источников**», затем щелкните **«Из служб Analysis Services**».</span><span class="sxs-lookup"><span data-stu-id="75aab-157">On the Data tab in Excel, click **From Other Sources**, and then click **From Analysis Services**.</span></span> <span data-ttu-id="75aab-158">Введите имя сервера, а затем выберите куб или перспективу для запроса.</span><span class="sxs-lookup"><span data-stu-id="75aab-158">Enter the server name, and then select a cube or perspective to query.</span></span>  
  
     <span data-ttu-id="75aab-159">Для серверов, развернутых в кластере с балансировкой нагрузки, используйте виртуальное имя сервера, назначенное кластеру.</span><span class="sxs-lookup"><span data-stu-id="75aab-159">For servers deployed in a load-balanced cluster, use the virtual server name assigned to the cluster.</span></span>  
  
2.  <span data-ttu-id="75aab-160">При настройке соединения в Excel на последней странице мастера подключения к данным можно указать настройки проверки подлинности для служб Excel.</span><span class="sxs-lookup"><span data-stu-id="75aab-160">When setting up a connection in Excel, on the last page of the Data Connection Wizard, you can specify authentication settings for Excel Services.</span></span> <span data-ttu-id="75aab-161">Эти настройки используются для задания свойств книги при ее загрузке на сервер SharePoint, содержащий службы Excel.</span><span class="sxs-lookup"><span data-stu-id="75aab-161">These settings are used to set properties on the workbook should you upload it to a SharePoint server that has Excel Services.</span></span> <span data-ttu-id="75aab-162">Настройки используются в операциях обновления данных.</span><span class="sxs-lookup"><span data-stu-id="75aab-162">The settings are used in data refresh operations.</span></span> <span data-ttu-id="75aab-163">Возможные параметры: **Проверка подлинности Windows**, **Служба Secure Store** (SSS) и **Нет**.</span><span class="sxs-lookup"><span data-stu-id="75aab-163">Options include **Windows Authentication**, **Secure Store Service** (SSS), and **None**.</span></span>  
  
     <span data-ttu-id="75aab-164">Следует избегать использования значения **Нет**.</span><span class="sxs-lookup"><span data-stu-id="75aab-164">Avoid using **None**.</span></span> <span data-ttu-id="75aab-165">Службы Analysis Services не позволяют указывать имя пользователя и пароль в строке подключения, если соединение выполняется не с сервером, для которого настроен доступ по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="75aab-165">Analysis Services does not let you specify a user name and password on the connection string unless you are connecting to a server that has been configured for HTTP access.</span></span> <span data-ttu-id="75aab-166">Точно так же не следует использовать SSS, если только вы не знаете, что идентификатор целевого приложения SSS сопоставлен с набором учетных данных пользователя Windows, обладающего доступом к базам данных служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="75aab-166">Similarly, do not use SSS unless you already know that the SSS target application ID is mapped to a set of Windows user credentials that have user access to the Analysis Services databases.</span></span> <span data-ttu-id="75aab-167">В большинстве сценариев лучше всего использовать настройку проверки подлинности Windows по умолчанию для подключения к службам Analysis Services из Excel.</span><span class="sxs-lookup"><span data-stu-id="75aab-167">For most scenarios, using the default option of Windows authentication is the best choice for an Analysis Services connection from Excel.</span></span>  
  
 <span data-ttu-id="75aab-168">Дополнительные сведения см. в разделе [Подключение к службам SQL Server Analysis Services или импорт данных из них](https://go.microsoft.com/fwlink/?linkID=215150).</span><span class="sxs-lookup"><span data-stu-id="75aab-168">For more information, see [Connect to or import data from SQL Server Analysis Services](https://go.microsoft.com/fwlink/?linkID=215150).</span></span>  
  
##  <a name="connect-using-sql-server-data-tools"></a><a name="bkmk_SSDT"></a><span data-ttu-id="75aab-169">Подключение с помощью SQL Server Data Tools</span><span class="sxs-lookup"><span data-stu-id="75aab-169">Connect using SQL Server Data Tools</span></span>  
 <span data-ttu-id="75aab-170">SQL Server Data Tools используется для построения решения бизнес-аналитики, в том числе моделей служб Analysis Services, отчетов служб Reporting Services и пакетов служб SSIS.</span><span class="sxs-lookup"><span data-stu-id="75aab-170">SQL Server Data Tools is used for building BI solutions, including Analysis Services models, Reporting Services reports, and SSIS packages.</span></span> <span data-ttu-id="75aab-171">При построении отчетов или пакетов можно указать подключение к службам Analysis services.</span><span class="sxs-lookup"><span data-stu-id="75aab-171">When building reports or packages, you might need to specify a connection to Analysis Services.</span></span>  
  
 <span data-ttu-id="75aab-172">По следующим ссылкам можно найти сведения о подключении к службам Analysis Services из проекта сервера отчетов или проекта служб Integration Services.</span><span class="sxs-lookup"><span data-stu-id="75aab-172">The following links explain how to connect to Analysis Services from a Report Server project or an Integration Services project:</span></span>  
  
-   [<span data-ttu-id="75aab-173">Тип соединения служб Analysis Services для запросов многомерных выражений (службы SSRS)</span><span class="sxs-lookup"><span data-stu-id="75aab-173">Analysis Services Connection Type for MDX &#40;SSRS&#41;</span></span>](../../reporting-services/report-data/analysis-services-connection-type-for-mdx-ssrs.md)  
  
-   [<span data-ttu-id="75aab-174">Диспетчер подключений служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="75aab-174">Analysis Services Connection Manager</span></span>](../../integration-services/connection-manager/analysis-services-connection-manager.md)  
  
> [!NOTE]  
>  <span data-ttu-id="75aab-175">При использовании SQL Server Data Tools для работы над существующим проектом служб Analysis Services не забудьте, что можно выполнить подключение в режиме «вне сети» с помощью локального проекта или проекта с управлением версиями или установить соединение в режиме «в сети» для обновления объектов служб Analysis Services при запущенной базе данных.</span><span class="sxs-lookup"><span data-stu-id="75aab-175">When using SQL Server Data Tools to work on an existing Analysis Services project, remember that you can connect offline using a local or version controlled project, or connect in online mode to update Analysis Services objects while the database is running.</span></span> <span data-ttu-id="75aab-176">Дополнительные сведения см. в разделе [Connect in Online Mode to an Analysis Services Database](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md).</span><span class="sxs-lookup"><span data-stu-id="75aab-176">For more information, see [Connect in Online Mode to an Analysis Services Database](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md).</span></span> <span data-ttu-id="75aab-177">Часто подключения из среды [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] выполняются в режиме проекта, когда изменения развертываются в базе данных только при явном развертывании проекта.</span><span class="sxs-lookup"><span data-stu-id="75aab-177">More commonly, connections from [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] are in project mode, where changes are deployed to the database only when you explicitly deploy the project.</span></span>  
  
##  <a name="test-connections"></a><a name="bkmk_tshoot"></a><span data-ttu-id="75aab-178">Проверить подключения</span><span class="sxs-lookup"><span data-stu-id="75aab-178">Test connections</span></span>  
 <span data-ttu-id="75aab-179">Можно использовать приложение SQL Server Profiler для контроля за соединениями со службами Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="75aab-179">You can use SQL Server Profiler to monitor connections to Analysis Services.</span></span> <span data-ttu-id="75aab-180">События Audit Login и Audit Logout предоставляют свидетельство соединения.</span><span class="sxs-lookup"><span data-stu-id="75aab-180">The Audit Login and Audit Logout events provide evidence of a connection.</span></span> <span data-ttu-id="75aab-181">Столбец идентификаторов указывает контекст безопасности, в котором устанавливается соединение.</span><span class="sxs-lookup"><span data-stu-id="75aab-181">The identity column indicates the security context under which the connection is made.</span></span>  
  
1.  <span data-ttu-id="75aab-182">Запустите приложение **SQL Server Profiler** на экземпляре служб Analysis Services, затем запустите новую трассировку.</span><span class="sxs-lookup"><span data-stu-id="75aab-182">Start **SQL Server Profiler** on the Analysis Services instance and then start a new trace.</span></span>  
  
2.  <span data-ttu-id="75aab-183">В разделе «Выбор событий» убедитесь, что объекты `Audit Login` и `Audit Logout` отмечены в разделе «Аудит безопасности».</span><span class="sxs-lookup"><span data-stu-id="75aab-183">In Events Selection, verify that `Audit Login` and `Audit Logout` are checked in the Security Audit section.</span></span>  
  
3.  <span data-ttu-id="75aab-184">Подключитесь к службам Analysis Services через службу приложений (например, SharePoint или службы Reporting Services) с удаленного клиентского компьютера.</span><span class="sxs-lookup"><span data-stu-id="75aab-184">Connect to Analysis Services via an application service (such as SharePoint or Reporting Services) from a remote client computer.</span></span> <span data-ttu-id="75aab-185">Событие «Имя входа учетной записи аудита» отобразит удостоверение пользователя, подключенного к службам Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="75aab-185">The Audit Login event will show the identity of the user connecting to Analysis Services.</span></span>  
  
 <span data-ttu-id="75aab-186">Ошибки соединения часто трассируются к неполной или недопустимой конфигурации сервера.</span><span class="sxs-lookup"><span data-stu-id="75aab-186">Connection errors are often traced to an incomplete or invalid server configuration.</span></span> <span data-ttu-id="75aab-187">Сначала всегда проверьте конфигурацию сервера.</span><span class="sxs-lookup"><span data-stu-id="75aab-187">Always check server configuration first:</span></span>  
  
-   <span data-ttu-id="75aab-188">Проверьте связь с сервером с удаленного компьютера, чтобы убедиться, что он разрешает удаленные соединения.</span><span class="sxs-lookup"><span data-stu-id="75aab-188">Ping the server from a remote computer to ensure it allows remote connections.</span></span>  
  
-   <span data-ttu-id="75aab-189">**Правила брандмауэра на сервере разрешают входящие соединения от клиентов в том же домене.**</span><span class="sxs-lookup"><span data-stu-id="75aab-189">**Firewall rules on the server allow inbound connections from clients in the same domain**</span></span>  
  
     <span data-ttu-id="75aab-190">За исключением PowerPivot для SharePoint, все подключения к удаленному серверу требуют настройки брандмауэра для разрешения доступа к порту, который прослушивают службы Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="75aab-190">With the exception of PowerPivot for SharePoint, all connections to a remote server require that you have configured the firewall to allow access to the port that Analysis Services is listening on.</span></span> <span data-ttu-id="75aab-191">При получении ошибок соединения проверьте, что порт доступен, а пользователю предоставлены разрешения на соответствующие базы данных.</span><span class="sxs-lookup"><span data-stu-id="75aab-191">If you are getting connection errors, verify that the port is accessible and that user permissions are granted to the appropriate databases.</span></span>  
  
     <span data-ttu-id="75aab-192">Для проверки используйте Excel или SSMS на удаленном компьютере, указывая IP-адрес и порт, используемые экземпляром служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="75aab-192">To test, use Excel or SSMS to on a remote computer, specifying the IP address and port used by the Analysis Services instance.</span></span> <span data-ttu-id="75aab-193">В случае удачной попытки соединения правила брандмауэра допустимы для экземпляра и экземпляр разрешает удаленные соединения.</span><span class="sxs-lookup"><span data-stu-id="75aab-193">If you can connection, the firewall rules are valid for the instance and the instance allows remote connections.</span></span>  
  
     <span data-ttu-id="75aab-194">Кроме того, при использовании протокола TCP/IP для соединения следует помнить, что службы Analysis Services требуют, чтобы подключения клиента исходили из того же домена или доверенного домена.</span><span class="sxs-lookup"><span data-stu-id="75aab-194">Also, when using TCP/IP for the connection protocol, remember that Analysis Services requires client connections originate from the same domain or a trusted domain.</span></span> <span data-ttu-id="75aab-195">Если соединения проходят через периметр безопасности, вероятнее всего, потребуется настроить доступ по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="75aab-195">If connections flow across security boundaries, you will most likely need to configure HTTP access.</span></span> <span data-ttu-id="75aab-196">Дополнительные сведения см. в разделе [Настройка HTTP-доступа к службам Analysis Services в службах Internet Information Services (IIS) 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="75aab-196">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
-   <span data-ttu-id="75aab-197">Можно ли подключиться, используя одни средства, но не другие?</span><span class="sxs-lookup"><span data-stu-id="75aab-197">Can you connect using some tools but not others?</span></span> <span data-ttu-id="75aab-198">Проблема может заключаться в неверной версии клиентских библиотек.</span><span class="sxs-lookup"><span data-stu-id="75aab-198">The problem might be the wrong version of a client library.</span></span> <span data-ttu-id="75aab-199">Получить клиентские библиотеки можно на странице загрузки «Пакет дополнительных компонентов SQL Server».</span><span class="sxs-lookup"><span data-stu-id="75aab-199">You can get client libraries from the SQL Server Feature Pack download page.</span></span>  
  
 <span data-ttu-id="75aab-200">Ресурсы, которые могут быть полезными в устранении ошибок соединения:</span><span class="sxs-lookup"><span data-stu-id="75aab-200">Resources that can help you resolve connection failures include the following:</span></span>  
  
 <span data-ttu-id="75aab-201">[Устранение проблем с возможным подключением для подключений служб SQL Server 2005 Analysis Services](https://technet.microsoft.com/library/cc917670.aspx).</span><span class="sxs-lookup"><span data-stu-id="75aab-201">[Resolving Common Connectivity Issues in SQL Server 2005 Analysis Services Connectivity Scenarios](https://technet.microsoft.com/library/cc917670.aspx).</span></span> <span data-ttu-id="75aab-202">Этот документ был опубликован несколько лет назад, но сведения и методологии по-прежнему актуальны.</span><span class="sxs-lookup"><span data-stu-id="75aab-202">This document is a few years old, but the information and methodologies still apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="75aab-203">См. также:</span><span class="sxs-lookup"><span data-stu-id="75aab-203">See Also</span></span>  
 <span data-ttu-id="75aab-204">[Подключение к Analysis Services](connect-to-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="75aab-204">[Connect to Analysis Services](connect-to-analysis-services.md) </span></span>  
 <span data-ttu-id="75aab-205">[Методологии проверки подлинности, поддерживаемые Analysis Services](authentication-methodologies-supported-by-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="75aab-205">[Authentication methodologies supported by Analysis Services](authentication-methodologies-supported-by-analysis-services.md) </span></span>  
 <span data-ttu-id="75aab-206">[Олицетворение &#40;табличные&#41;SSAS](../tabular-models/impersonation-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="75aab-206">[Impersonation &#40;SSAS Tabular&#41;](../tabular-models/impersonation-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="75aab-207">Создание источника данных (многомерные службы SSAS)</span><span class="sxs-lookup"><span data-stu-id="75aab-207">Create a Data Source &#40;SSAS Multidimensional&#41;</span></span>](../multidimensional-models/create-a-data-source-ssas-multidimensional.md)  
  
  
