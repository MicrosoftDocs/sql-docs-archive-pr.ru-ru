---
title: Подключение из клиентских приложений (Analysis Services) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b1e0f1d4-0b87-4ad3-8172-f746fe2f16a2
author: minewiskan
ms.author: owend
ms.openlocfilehash: cb93d3a44345d750070a3dda60f82693fd61500b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87731109"
---
# <a name="connect-from-client-applications-analysis-services"></a>Подключение из клиентских приложений (службы Analysis Services)
  Начинающим пользователям служб Analysis Services следует использовать сведения в этом разделе для подключения к существующему экземпляру служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] с помощью стандартных средств и приложений. В этом разделе также объясняется, как подключаться для тестирования под разными удостоверениями пользователей.  
  
-   [Подключение с помощью SQL Server Management Studio (SSMS)](#bkmk_SSMS)  
  
-   [Подключение с использованием Excel](#bkmk_excel)  
  
-   [Соединение с помощью SQL Server Data Tools](#bkmk_SSDT)  
  
-   [Проверка подключения](#bkmk_tshoot)  
  
 Справочная документация по строкам подключений предоставляется отдельно. Дополнительные сведения см. в разделе [Свойства строки подключения (службы Analysis Services)](connection-string-properties-analysis-services.md).  
  
 Успешные подключения зависят от допустимой настройки портов и соответствующих разрешений пользователя. Для более подробного знакомства с каждым требованием воспользуйтесь следующими ссылками.  
  
-   [Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services](configure-the-windows-firewall-to-allow-analysis-services-access.md)  
  
-   [Предоставление доступа к объектам и операциям (службы Analysis Services)](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)  
  
##  <a name="connect-using-sql-server-management-studio-ssms"></a><a name="bkmk_SSMS"></a> Подключение с помощью среды SQL Server Management Studio (SSMS)  
 Подключение к службам Analysis Services в среде SSMS для управления экземплярами сервера и базами данных в интерактивном режиме. Можно также запустить запросы XMLA или многомерных выражений для выполнения задач администрирования или получения данных. В отличие от других средств и приложений, которые загружают базы данных, только если отправляется запрос, среда SSMS загружает все базы данных при соединении с сервером, предполагая, что разрешение на просмотр базы данных имеется. Это означает, что, если на сервере есть множество табличных баз данных, все они будут загружены в память системы при установке соединения с помощью среды SSMS.  
  
 Разрешения можно проверить с помощью среды SSMS с определенным удостоверением пользователя, а затем подключиться к службам Analysis Services от имени этого пользователя.  
  
 Удерживайте клавишу SHIFT и щелкните правой кнопкой мыши значок **Среда SQL Server Management Studio** , чтобы получить доступ к параметру **Запуск от имени другого пользователя** .  
  
1.  Запустите среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]. В диалоговом окне **Соединение с сервером** выберите тип сервера служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
2.  На вкладке «Вход» введите имя сервера, указав имя компьютера, на котором запущен сервер. Сервер можно указать с помощью его сетевого имени или полного имени домена.  
  
     Для именованного экземпляра имя сервера необходимо указывать в следующем формате: имя_сервера\имя_экземпляра. Примером такого контекста именования может быть ADV-SRV062\Finance для сервера с сетевым именем ADV-SRV062, где службы Analysis Services были установлены в качестве именованного экземпляра под названием Finance.  
  
     Подключение к серверам, развернутым в отказоустойчивом кластере, выполняется с использованием сетевого имени кластера службы SSAS. Это имя указывается во время установки SQL Server как **Сетевое имя SQL Server**. Обратите внимание, что при установке служб SSAS в качестве именованного экземпляра в отказоустойчивый кластер Windows Server (WSFC) при установке соединения имя экземпляра никогда не добавляется. Это уникальная особенность служб SSAS. Именованный же экземпляр кластеризованного ядра реляционной базы данных, напротив, содержит имя экземпляра. Например, если установлены и службы SSAS, и ядро СУБД как именованный экземпляр (Contoso-Accounting) с сетевым именем SQL Server «SQL-CLU», то для подключения к службам SSAS следует использовать имя «SQL-CLU», а к ядру СУБД — «SQL-CLU\Contoso-Accounting». Дополнительные сведения и примеры см. в разделе [Кластеризация служб SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) .  
  
     Подключение к серверам, развернутым в кластере с балансировкой нагрузки, устанавливается с использованием имени виртуального сервера NLB.  
  
3.  Проверка подлинности всегда осуществляется средствами Windows, а удостоверение пользователя всегда означает пользователя Windows, который подключается посредством среды Management Studio.  
  
     Для успешного подключения необходимо разрешение на доступ к серверу или к базе данных на сервере. Для большинства задач, которые нужно выполнять в среде Management Studio, требуется разрешение администратора. Убедитесь, что учетная запись, с которой устанавливается соединение, является членом роли администратора сервера. Дополнительные сведения см. в статьях [предоставление разрешений администратора сервера &#40;Analysis Services&#41;](grant-server-admin-rights-to-an-analysis-services-instance.md).  
  
4.  Нажмите кнопку **Свойства соединения** , чтобы указать конкретную базу данных, задать время ожидания или параметры шифрования. Дополнительные сведения о соединении содержат свойства соединения, используемые только для текущего соединения.  
  
5.  Перейдите на вкладку **Дополнительные параметры соединения** , чтобы задать свойства соединения, недоступные в диалоговом окне «Подключение к серверу». Например, можно ввести `Roles=Reader` в текстовом поле.  
  
     Подключение через роль с меньшим числом разрешений позволяет протестировать поведение базы данных, когда активна эта роль.  
  
    ```  
    Provider=MSOLAP; Data Source=SERVERNAME; Initial Catalog=AdventureWorks2012; Roles=READER  
    ```  
  
##  <a name="connect-using-excel"></a><a name="bkmk_excel"></a>Подключение с помощью Excel  
 Microsoft Excel часто используется для анализа бизнес-данных. В рамках установки Excel пакет Office устанавливает поставщик OLE DB для служб Analysis Services (MSOLAP DDL), ADOMD.NET и другие поставщики данных, облегчающие подготовку к использованию данных на сетевых серверах. При использовании одной из новых версий служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] с клиентом более старой версии Excel, вероятнее всего, потребуется установить более новые версии поставщиков данных на каждую рабочую станцию, которая подключается к службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Дополнительные сведения см. в разделе [Поставщики данных, используемые для соединений со службами Analysis Services](data-providers-used-for-analysis-services-connections.md) .  
  
 При настройке соединения с кубом служб Analysis Services или шаблоном базы данных Excel сохраняет сведения о соединении в ODC-файле для использования в будущем. Соединение выполняется в контексте безопасности текущего пользователя Windows. Для успешного соединения у этой учетной записи пользователя должно быть разрешение на чтение базы данных.  
  
 При использовании данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] из книги Excel соединения поддерживаются в течение времени выполнения запроса. Именно поэтому при отслеживании рабочей нагрузки по обработке запросов из Excel, вероятнее всего, будет видно большое количество соединений для каждого сеанса, которые поддерживаются в течение очень короткого периода времени.  
  
 Разрешения можно проверить, запуская Excel с конкретным удостоверением пользователя.  
  
 Удерживайте клавишу SHIFT и щелкните правой кнопкой мыши значок **Excel** , чтобы получить доступ к параметру **Запуск от имени другого пользователя** .  
  
1.  На вкладке «Данные» в Excel щелкните **«Из других источников**», затем щелкните **«Из служб Analysis Services**». Введите имя сервера, а затем выберите куб или перспективу для запроса.  
  
     Для серверов, развернутых в кластере с балансировкой нагрузки, используйте виртуальное имя сервера, назначенное кластеру.  
  
2.  При настройке соединения в Excel на последней странице мастера подключения к данным можно указать настройки проверки подлинности для служб Excel. Эти настройки используются для задания свойств книги при ее загрузке на сервер SharePoint, содержащий службы Excel. Настройки используются в операциях обновления данных. Возможные параметры: **Проверка подлинности Windows**, **Служба Secure Store** (SSS) и **Нет**.  
  
     Следует избегать использования значения **Нет**. Службы Analysis Services не позволяют указывать имя пользователя и пароль в строке подключения, если соединение выполняется не с сервером, для которого настроен доступ по протоколу HTTP. Точно так же не следует использовать SSS, если только вы не знаете, что идентификатор целевого приложения SSS сопоставлен с набором учетных данных пользователя Windows, обладающего доступом к базам данных служб Analysis Services. В большинстве сценариев лучше всего использовать настройку проверки подлинности Windows по умолчанию для подключения к службам Analysis Services из Excel.  
  
 Дополнительные сведения см. в разделе [Подключение к службам SQL Server Analysis Services или импорт данных из них](https://go.microsoft.com/fwlink/?linkID=215150).  
  
##  <a name="connect-using-sql-server-data-tools"></a><a name="bkmk_SSDT"></a>Подключение с помощью SQL Server Data Tools  
 SQL Server Data Tools используется для построения решения бизнес-аналитики, в том числе моделей служб Analysis Services, отчетов служб Reporting Services и пакетов служб SSIS. При построении отчетов или пакетов можно указать подключение к службам Analysis services.  
  
 По следующим ссылкам можно найти сведения о подключении к службам Analysis Services из проекта сервера отчетов или проекта служб Integration Services.  
  
-   [Тип соединения служб Analysis Services для запросов многомерных выражений (службы SSRS)](../../reporting-services/report-data/analysis-services-connection-type-for-mdx-ssrs.md)  
  
-   [Диспетчер подключений служб Analysis Services](../../integration-services/connection-manager/analysis-services-connection-manager.md)  
  
> [!NOTE]  
>  При использовании SQL Server Data Tools для работы над существующим проектом служб Analysis Services не забудьте, что можно выполнить подключение в режиме «вне сети» с помощью локального проекта или проекта с управлением версиями или установить соединение в режиме «в сети» для обновления объектов служб Analysis Services при запущенной базе данных. Дополнительные сведения см. в разделе [Connect in Online Mode to an Analysis Services Database](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md). Часто подключения из среды [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] выполняются в режиме проекта, когда изменения развертываются в базе данных только при явном развертывании проекта.  
  
##  <a name="test-connections"></a><a name="bkmk_tshoot"></a>Проверить подключения  
 Можно использовать приложение SQL Server Profiler для контроля за соединениями со службами Analysis Services. События Audit Login и Audit Logout предоставляют свидетельство соединения. Столбец идентификаторов указывает контекст безопасности, в котором устанавливается соединение.  
  
1.  Запустите приложение **SQL Server Profiler** на экземпляре служб Analysis Services, затем запустите новую трассировку.  
  
2.  В разделе «Выбор событий» убедитесь, что объекты `Audit Login` и `Audit Logout` отмечены в разделе «Аудит безопасности».  
  
3.  Подключитесь к службам Analysis Services через службу приложений (например, SharePoint или службы Reporting Services) с удаленного клиентского компьютера. Событие «Имя входа учетной записи аудита» отобразит удостоверение пользователя, подключенного к службам Analysis Services.  
  
 Ошибки соединения часто трассируются к неполной или недопустимой конфигурации сервера. Сначала всегда проверьте конфигурацию сервера.  
  
-   Проверьте связь с сервером с удаленного компьютера, чтобы убедиться, что он разрешает удаленные соединения.  
  
-   **Правила брандмауэра на сервере разрешают входящие соединения от клиентов в том же домене.**  
  
     За исключением PowerPivot для SharePoint, все подключения к удаленному серверу требуют настройки брандмауэра для разрешения доступа к порту, который прослушивают службы Analysis Services. При получении ошибок соединения проверьте, что порт доступен, а пользователю предоставлены разрешения на соответствующие базы данных.  
  
     Для проверки используйте Excel или SSMS на удаленном компьютере, указывая IP-адрес и порт, используемые экземпляром служб Analysis Services. В случае удачной попытки соединения правила брандмауэра допустимы для экземпляра и экземпляр разрешает удаленные соединения.  
  
     Кроме того, при использовании протокола TCP/IP для соединения следует помнить, что службы Analysis Services требуют, чтобы подключения клиента исходили из того же домена или доверенного домена. Если соединения проходят через периметр безопасности, вероятнее всего, потребуется настроить доступ по протоколу HTTP. Дополнительные сведения см. в разделе [Настройка HTTP-доступа к службам Analysis Services в службах Internet Information Services (IIS) 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).  
  
-   Можно ли подключиться, используя одни средства, но не другие? Проблема может заключаться в неверной версии клиентских библиотек. Получить клиентские библиотеки можно на странице загрузки «Пакет дополнительных компонентов SQL Server».  
  
 Ресурсы, которые могут быть полезными в устранении ошибок соединения:  
  
 [Устранение проблем с возможным подключением для подключений служб SQL Server 2005 Analysis Services](https://technet.microsoft.com/library/cc917670.aspx). Этот документ был опубликован несколько лет назад, но сведения и методологии по-прежнему актуальны.  
  
## <a name="see-also"></a>См. также:  
 [Подключение к Analysis Services](connect-to-analysis-services.md)   
 [Методологии проверки подлинности, поддерживаемые Analysis Services](authentication-methodologies-supported-by-analysis-services.md)   
 [Олицетворение &#40;табличные&#41;SSAS](../tabular-models/impersonation-ssas-tabular.md)   
 [Создание источника данных (многомерные службы SSAS)](../multidimensional-models/create-a-data-source-ssas-multidimensional.md)  
  
  
