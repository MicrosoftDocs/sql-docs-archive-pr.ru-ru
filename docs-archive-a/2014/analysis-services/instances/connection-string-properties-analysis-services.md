---
title: Свойства строки подключения (Analysis Services) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 29a00a41-5b0d-44b2-8a86-1b16fe507768
author: minewiskan
ms.author: owend
ms.openlocfilehash: 304525ae8a3ff5c910916352ff354cde8c354d44
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87731086"
---
# <a name="connection-string-properties-analysis-services"></a>Свойства строки подключения (службы Analysis Services)
  В этом разделе описываются свойства строки подключения, которые можно задать в конструкторе или одном из средств управления. Также эти свойства есть в строках подключения, созданных клиентскими приложениями, которые подключаются и запрашивают данные служб Analysis Services. Описывается только подмножество доступных свойств. Полный список содержит множество свойств сервера и базы данных, позволяющих настроить соединение для конкретного приложения независимо от того, как экземпляр или база данных настроены на сервере.  
  
 Разработчики, которые создают пользовательские строки подключения в коде приложений, могут найти более подробный список в документации по API-интерфейсам для клиента ADOMD.NET: <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A>  
  
 Свойства, описанные в этом разделе, используются клиентскими библиотеками служб Analysis Services, ADOMD.NET, объектами AMO и поставщиком OLE DB для служб Analysis Services. Большинство свойств строки подключения можно использовать со всеми тремя клиентскими библиотеками. Исключения приведены в описании.  
  
 Этот раздел включает следующие подразделы:  
  
 [Часто применяемые параметры соединения](#bkmk_common)  
  
 [Проверка подлинности и безопасность](#bkmk_auth)  
  
 [Специальные параметры](#bkmk_special)  
  
 [Зарезервировано для будущего использования](#bkmk_reserved)  
  
 [Примеры строк подключения](#bkmk_examples)  
  
 [Форматы строк подключения, используемые в службах Analysis Services](#bkmk_supportedstrings)  
  
 [Шифрование строк соединения](#bkmk_encrypt)  
  
> [!NOTE]  
>  Если при задании свойств одно и то же свойство было задано дважды, то в строке подключения используется последнее.  
  
 Дополнительные сведения о том, как настроить подключение к службам Analysis Services в существующих приложениях корпорации Майкрософт, см. в разделе [Подключение из клиентских приложений (службы Analysis Services)](connect-from-client-applications-analysis-services.md).  
  
##  <a name="connection-parameters-in-common-use"></a><a name="bkmk_common"></a>Параметры подключения в общем использовании  
 В следующей таблице приведены описания свойств, наиболее часто используемых при создании строки подключения.  
  
|Свойство|Описание|Пример|  
|--------------|-----------------|-------------|  
|`Data Source` или `DataSource`|Задает экземпляр сервера. Это свойство является обязательным для всех соединений. Допустимые значения — сетевое имя или IP-адрес сервера, local или localhost для локальных соединений, URL-адрес, если на сервере настроен доступ по протоколу HTTP или HTTPS, или имя файла для локального куба (CUB).|`Data source=AW-SRV01` — порт (TCP 2383) и экземпляр по умолчанию.<br /><br /> `Data source=AW-SRV01$Finance:8081` — фиксированный порт и именованный экземпляр ($Finance).<br /><br /> `Data source=AW-SRV01.corp.Adventure-Works.com` — полное доменное имя для экземпляра и порта по умолчанию.<br /><br /> `Data source=172.16.254.1` для IP-адреса сервера без уточняющегозапроса DNS, что удобно для устранения проблем с соединением.|  
|`Initial Catalog` или `Catalog`|Определяет имя базы данных служб Analysis Services, к которой необходимо подключиться. База данных должна быть развернута на службах Analysis Services, и необходимо иметь разрешение на подключение к ней. Это свойство является необязательным для AMO-соединений, но необходимо для ADOMD.NET.|`Initial catalog=AdventureWorks2012`|  
|`Provider`|Допустимые значения: MSOLAP или MSOLAP. \<version> , где \<version> имеет значение 3, 4 или 5. В файловой системе имя поставщика данных будет msolap110.dll для SQL Server версии 2012, msolap100.dll для SQL Server 2008 и 2008 R2 и msolap90.dll для SQL Server 2005.<br /><br /> Текущая версия — MSOLAP.5. Это свойство является необязательным. По умолчанию клиентские библиотеки считывают текущую версию поставщика OLE DB из реестра. Устанавливать это свойство необходимо, только если требуется определенная версия поставщика данных, например для подключения к экземпляру SQL Server 2008.<br /><br /> Поставщики данных соответствуют версиям SQL Server. Если ваша организация использует текущую и предыдущую версии служб Analysis Services, то, скорее всего, нужно будет указать поставщик данных для строк подключений, созданных вручную. Также, возможно, потребуется загрузить и установить определенные версии поставщика данных на компьютерах, на которых нет нужных вам версий. Поставщик OLE DB можно загрузить с веб-страниц пакета дополнительных компонентов SQL Server (из центра загрузки). Откройте адрес [Microsoft SQL Server 2012 Feature Pack](https://go.microsoft.com/fwlink/?LinkId=296473) , чтобы загрузить поставщик OLE DB служб Analysis Services для SQL Server 2012.<br /><br /> MSOLAP.4 был выпущен как в SQL Server 2008, так и в SQL Server 2008 R2. Версия 2008 R2 поддерживает книги PowerPivot, иногда ее необходимо устанавливать вручную на серверах SharePoint. Чтобы отличить эти две версии, необходимо проверить номер сборки в свойствах файла поставщика. Перейдите в "Program files\Microsoft Analysis Services\AS OLEDB\10". Щелкните правой кнопкой мыши файл msolap110.dll и выберите пункт **Свойства**. Щелкните **Сведения**. Просмотрите информацию о версии файла. Версия должна включать 10,50.\<buildnumber> для SQL Server 2008 R2. Дополнительные сведения см. в статьях [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md) и [Поставщики данных, используемые для соединений со службами Analysis Services](data-providers-used-for-analysis-services-connections.md).<br /><br /> MSOLAP. 3 был выпущен в SQL Server 2005.<br /><br /> MSOLAP. 4 был выпущен в SQL Server 2008 и еще раз SQL Server 2008 R2<br /><br /> MSOLAP. 5 был выпущен в SQL Server 2012|`Provider=MSOLAP.3` используется для подключений, которые требуют версию SQL Server 2005 поставщика OLE DB для служб Analysis Services.|  
|`Cube`|Имя куба или имя перспективы. База данных может содержать несколько кубов и перспектив. Если возможны несколько целей, включите куб или имя перспективы в строку подключения.|`Cube=SalesPerspective` обозначает, что можно использовать свойство Cube строки подключения для указания имени куба или перспективы.|  
  
##  <a name="authentication-and-security"></a><a name="bkmk_auth"></a>Проверка подлинности и безопасность  
 В этом разделе описываются свойства строки подключения, относящиеся к проверке подлинности и шифрованию. Службы Analysis Services используют только проверку подлинности Windows, однако в строке подключения можно задать свойства для передачи заданного имени пользователя и пароля.  
  
 Свойства перечисляются в алфавитном порядке.  
  
|Свойство|Описание|  
|--------------|-----------------|  
|`EffectiveUserName`|Используется, когда идентификатор пользователя должен быть олицетворен на сервере. Укажите учетную запись в следующем формате: «домен\пользователь». Чтобы использовать это свойство, вызывающая сторона должна иметь разрешения системного администратора служб Analysis Services. Дополнительные сведения об использовании свойства этого свойства в книге Excel из SharePoint см. в разделе [Использование свойства EffectiveUserName служб Analysis Services в SharePoint Server 2013](https://go.microsoft.com/fwlink/?LinkId=311905). Примеры использования этого свойства со службами Reporting Services см. в разделе [Использование EffectiveUserName для олицетворения в SSAS](https://www.artisconsulting.com/blogs/greggalloway/2010/4/1/using-effectiveusername-to-impersonate-in-ssas).<br /><br /> `EffectiveUserName` используется в установке PowerPivot для SharePoint для сбора данных об использовании. Удостоверение пользователя предоставляется серверу, чтобы события или ошибки, включающие удостоверение пользователя, могли быть записаны в файлах журналов. В случае с PowerPivot не используется для выполнения авторизации.|  
|**Encrypt Password**|Указывает, применяется ли для шифрования локальных кубов локальный пароль. Допустимые значения — True и False. Значение по умолчанию — False.|  
|`Encryption Password`|Пароль, используемый для расшифровки зашифрованного локального куба. Значение по умолчанию — empty. Это значение должно быть прямо задано пользователем.|  
|`Impersonation Level`|Указывает уровень олицетворения, который разрешен серверу при олицетворении клиента. Допустимые значения:<br /><br /> **Anonymous**: клиент является анонимным для сервера. Серверному процессу не удается получить идентификационные сведения о клиенте, также клиент не может быть олицетворен.<br /><br /> **Идентификация**. серверный процесс может получить удостоверение клиента. Сервер может олицетворять клиента для авторизации, но не может получить доступ к системным объектам от имени клиента.<br /><br /> **Impersonate**: это значение по умолчанию. Клиент может быть олицетворен, но только при установке соединения, а не при каждом вызове.<br /><br /> **Delegate**: серверный процесс может олицетворять контекст безопасности клиента, действуя от имени клиента. Серверный процесс также может отправлять исходящие вызовы другим серверам, действуя от имени клиента.|  
|`Integrated Security`|Идентификатор участника Windows вызывающей стороны используется для подключения к службам Analysis Services. Допустимые значения — blank (пусто), SSPI и BASIC.<br /><br /> `Integrated Security`=`SSPI`— Это значение по умолчанию для TCP-подключений, допускающее NTLM, Kerberos или анонимную проверку подлинности. Значение по умолчанию для HTTP-соединений — blank (пустое значение).<br /><br /> При использовании `SSPI` аргумент `ProtectionLevel` должен иметь одно из следующих значений: `Connect`, `PktIntegrity`, `PktPrivacy`.|  
|`Persist Encrypted`|Установите это свойство, если клиентское приложение требует, чтобы объект источника данных хранил конфиденциальные данные проверки подлинности, например пароль в зашифрованном виде. По умолчанию сведения о проверке подлинности не сохраняются.|  
|`Persist Security Info`|Допустимые значения — True или False. Если задано значение True, сведения о безопасности, например идентификатор пользователя и пароль, указанные в строке подключения, можно получить из соединения после того, как соединение установлено. Значение по умолчанию равно False.|  
|`ProtectionLevel`|Определяет уровень безопасности, используемый для соединения. Допустимые значения:<br /><br /> `None`. Без проверки подлинности или анонимные соединения. Не выполняется проверка подлинности на данных, отправляемых на сервер.<br /><br /> `Connect`. Проверенные на подлинность соединения. Проверка проходит успешно только в том случае, когда клиент устанавливает соединение с сервером.<br /><br /> `PktIntegrity`. Зашифрованные соединения. Проверяет, что все данные получаются от клиента и что они не меняются во время передачи.<br /><br /> `PktPrivacy`. Шифрование подписями поддерживается только для XMLA. Проверяется, что все данные получаются от клиента и без изменений во время передачи в пути. Конфиденциальность данных защищается путем шифрования.<br /><br /> <br /><br /> Дополнительные сведения см. в разделе [Establishing Secure Connections in ADOMD.NET](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-client/connections-in-adomd-net-establishing-secure-connections).|  
|`Roles`|Укажите разделенный запятыми список стандартных ролей для подключения к серверу и базе данных с помощью разрешений, переданных этой роли. Если это свойство пропущено, используются все роли и применяются разрешения как сочетания всех ролей. Если задать для свойства пустое значение (например, Roles = ' '), клиентское соединение не будет иметь членства в роли.<br /><br /> Администратор, применяя это свойство, соединяется с использованием разрешений, представленных ролью. Некоторые команды могут завершиться ошибкой, если роль не предоставляет достаточные разрешения.|  
|`SSPI`|Явно указывает, какой пакет безопасности следует использовать для проверки подлинности клиента, когда для `Integrated Security` задано значение `SSPI`. SSPI поддерживает несколько пакетов, однако с помощью этого свойства можно указать определенный пакет. Допустимые значения: Negotiate, NTLM, Kerberos и Anonymous User. Если это свойство не задано, то для соединения будут доступны все пакеты.|  
|`Use Encryption for Data`|Шифрует передачу данных. Возможными значениями являются True и False.|  
|`User ID`=...;`Password`=|`User ID`и `Password` используются вместе. Службы Analysis Services олицетворяют удостоверение пользователя, указанное с помощью этих учетных данных. В соединении служб Analysis Services учетные данные в командной строке используются только в том случае, если на сервере настроен доступ по HTTP-протоколу и указана обычная проверка подлинности вместо встроенной безопасности виртуального каталога IIS.<br /><br /> Имя пользователя и пароль могут быть учетными данными удостоверения Windows или учетной записью локального пользователя или пользователя домена. Обратите внимание, что `User ID` имеет внедренный пробел. Другие псевдонимы для этого свойства: `UserName` (без пробела) и `UID`. Псевдоним для `Password` — `PWD`.|  
  
##  <a name="special-purpose-parameters"></a><a name="bkmk_special"></a>Параметры специального назначения  
 В этом разделе описываются остальные параметры строки подключения. Они используются для предоставления приложению конкретных режимов подключения.  
  
 Свойства перечисляются в алфавитном порядке.  
  
|Свойство|Описание|  
|--------------|-----------------|  
|`Application Name`|Задает имя приложения, связанного с соединением. Это значение может быть полезно для мониторинга событий трассировки, особенно при наличии нескольких приложений, обращающихся к одним и тем же базам данных. Например, Добавление имени приложения = "Test" в строку подключения приводит к тому, что "Test" будет отображаться в SQL Server Profiler трассировке, как показано на следующем снимке экрана:<br /><br /> ![SSAS_AppNameExcample](../media/ssas-appnameexcample.gif "SSAS_AppNameExcample")<br /><br /> Псевдонимы для этого свойства: `sspropinitAppName` и `AppName`. Дополнительные сведения см. разделе [Использование параметра Application Name при соединении с SQL Server](https://www.connectionstrings.com/use-application-name-sql-server/).|  
|`AutoSyncPeriod`|Задает частоту (в миллисекундах) синхронизации кэша клиента и сервера. ADOMD.NET предоставляет механизм кэширования клиента для часто используемых объектов, имеющий минимальные издержки на использование памяти. Это способствует сокращению циклов приема-передачи данных с сервера и на сервер. Значение по умолчанию равно 10000 миллисекунд (10 секундам). Если задано значение NULL или 0, то автоматическая синхронизация отключена.|  
|`Character Encoding`|Определяет, как кодируются символы в запросе. Допустимые значения: Default (по умолчанию), UTF-8 (это эквивалент Default) и UTF-16|  
|`CompareCaseSensitiveStringFlags`|Задает учет регистра при сравнении строк для указанной локали. Дополнительные сведения об установке данного свойства см. в разделе [Свойство CompareCaseSensitiveStringFlags](https://msdn.microsoft.com/library/aa237459\(v=sql.80\).aspx)|  
|`Compression Level`|Если `TransportCompression` задано как XPRESS, то можно задать используемый уровень сжатия. Допустимые значения: от 0 до 9, где 0 дает наименьшее сжатие, а 9 — самое большое. Более высокое сжатие снижает производительность. Значение по умолчанию — 0.|  
|`Connect Timeout`|Определяет максимальное время (в секундах), в течение которого клиент пытается подключиться, прежде чем истечет время ожидания. Если подключение не выполняется в течение этого периода, клиент завершает попытки подключения и создает ошибку.|  
|`MDX Compatibility`|Назначение этого свойства — обеспечить согласованное выполнение запросов многомерных выражений для приложений, которые их используют. В Excel при использовании запросов многомерных выражений для заполнения и вычисления сводных таблиц, подключенных к службам Analysis Services, этому свойству присваивается значение 1, чтобы обеспечить отображение в сводной таблице элементов-заполнителей из неоднородных иерархий. Допустимые значения — 0, 1, 2.<br /><br /> При 0 и 1 элементы-заполнители доступны, при 2 — нет. Если значение пустое, то используется 0.|  
|`MDX Missing Member Mode=Error`|Указывает на то, что отсутствующие элементы в инструкциях многомерных выражений не обрабатываются. Допустимые значения: Default, Error и Ignore. При Default используется значение, определенное на сервере. При Error формируется ошибка, если элемент не существует. При использовании значения Ignore отсутствующие значения пропускаются.|  
|`Optimize Response`|Битовая маска, определяющая используемую оптимизацию ответа на запрос.<br /><br /> 0x01: по умолчанию. Использование Нормалтуплесет <br />0x02: использовать, если срезы пусты|  
|`Packet Size`|Размер пакета (в байтах) между 512 и 32 767. Размер сетевых пакетов по умолчанию равен 4096.|  
|`Protocol Format`|Задает формат XML-данных, отправляемых на сервер. Допустимые значения: Default, XML, Binary. Протокол — XMLA. Можно указать, что следует отправлять XML-данные в сжатом виде (это применяется по умолчанию), в несжатом виде или в двоичной форме. XML-элементы и атрибуты кодируются в двоичном формате, что уменьшает их размер. Для сжатия используется внутренний формат, что еще сильнее уменьшает размер запросов и ответов. Сжатие и двоичные форматы используются для ускорения запросов передачи данных и ответов.<br /><br /> Если используется двоичный или сжатый формат, то для соединения нужно применять клиентскую библиотеку. Поставщик OLE DB может форматировать запросы и ответы в двоичном или в сжатом виде. Объекты AMO и ADOMD.NET форматируют запросы как текст, но принимают ответы в двоичном или сжатом формате.<br /><br /> Эта строка подключения — эквивалент параметрам конфигурации сервера `EnableBinaryXML` и `EnableCompression`.|  
|`Real Time Olap`|Установите это свойство, чтобы обойти кэширование, в результате чего все секции будут активно ожидать уведомления о запросах. По умолчанию это свойство не задано.|  
|`Safety Options`|Устанавливает уровень безопасности для определяемых пользователем функций и действий. Допустимые значения: 0, 1, 2. В соединении Excel это свойство соответствует Safety Options=2. Сведения об этом параметре см. в разделе <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A>.|  
|`SQLQueryMode`|Указывает, содержат ли SQL-запросы вычисления. Допустимые значения: Data, Calculated, IncludeEmpty. Data — вычисления не разрешены. Calculated — вычисления разрешены. IncludeEmpty — позволяет возвращать в результатах запроса вычисления и пустые строки.|  
|`Timeout`|Задает время (в миллисекундах) ожидания клиентской библиотекой завершения команды перед формированием ошибки.|  
|`Transport Compression`|Определяет способ сжатия пакетов в канале «клиент-сервер», когда сжатие задано свойством `Protocol Format`. Допустимые значения: Default, None, Compressed и `gzip`. По умолчанию для TCP сжатия нет, для HTTP применяется `gzip`. None — никакое сжатие не используется. Compressed — применяется сжатие XPress (SQL Server 2008 и более поздние версии). Значение `gzip` допустимо только для HTTP-запросов, где запрос включает строку Accept-Encoding=gzip.|  
|`UseExistingFile`|Используется для соединения с локальным кубом. Это свойство определяет, следует ли перезаписывать локальный куб. Допустимые значения — True и False. Если значение — True, то файл куба должен существовать. Существующий файл будет целевым объектом соединения. Если значение — False, то файл куба перезаписывается.|  
|`VisualMode`|Задайте с помощью этого свойства, как объединяются элементы при применении настроек безопасности измерения.<br /><br /> Есть смысл выполнять статистическую обработку всех членов данных куба, которые могут видеть все, поскольку видимы все значения, входящую в общую сумму. Однако если на основе идентификатора пользователя применяется фильтрация и ограничиваются измерения, то отображение общей суммы по всем элементам (куда входят разрешенные и закрытые значения) может выдавать непонятный результат или раскрывать больше данных, чем следует.<br /><br /> Чтобы указать способ статистической обработки членов при применении средств безопасности измерения, можно установить это свойство в значение True. Это приведет к использованию в агрегате только допустимых значений. Если указать False, то это исключит ограниченные значения из общей суммы.<br /><br /> Если задать это свойство в строке подключения, оно будет применяться к кубу или уровню перспективы. В модели можно управлять видимыми итогами на более детальном уровне.<br /><br /> Допустимые значения: 0, 1, и 2.<br /><br /> Значение по умолчанию равно 0. В настоящее время по умолчанию применяются правила для значения 2, где агрегаты содержат значения, скрытые от пользователя.<br /><br /> При значении 1 скрытые значения не входят в общую сумму. Так по умолчанию происходит в Excel.<br /><br /> 2 — скрытые значения входят в итоги. Это значение по умолчанию на сервере.<br /><br /> <br /><br /> Псевдонимы для этого свойства: `Visual Total` и `Default MDX Visual Mode`.|  
  
##  <a name="reserved-for-future-use"></a><a name="bkmk_reserved"></a>Зарезервировано для будущего использования  
 Следующие свойства являются допустимыми в строке подключения, но не работают в текущих выпусках служб Analysis Services.  
  
-   прошедший проверку пользователь  
  
-   Проверка подлинности Cache  
  
-   Cache Mode, режим кэша (Использование этого свойства было разобрано в более ранних версиях. Хотя в некоторых блогах рекомендуется использовать это свойство, не следует задавать его, если только вы не получили соответствующие инструкции от службы технической поддержки Майкрософт).  
  
-   Политика кэша  
  
-   Cache Ratio  
  
-   Cache Ratio2  
  
-   Dynamic Debug Limit  
  
-   Режим отладки  
  
-   Режим  
  
-   SQLCompatibility  
  
-   Use Formula Cache  
  
##  <a name="example-connection-strings"></a><a name="bkmk_examples"></a>Примеры строк подключения  
 В этом разделе показана строка подключения, которая, скорее всего, будет использоваться при настройке подключения Analysis Services в часто используемых приложениях.  
  
 **Общая строка подключения**  
  
 Подобную строку подключения можно использовать, если настраивается соединение из служб Reporting Services.  
  
 `Data source=<servername>; initial catalog=<databasename>`  
  
 **Строка подключения в Excel**  
  
 Стандартная строка подключения ADOMD.NET в Excel указывает поставщик данных, сервер, имя базы данных и учетные сведения встроенной безопасности Windows. Уровень совместимости многомерного выражения всегда задается как 1. Можно изменить это значение для текущего сеанса, но Excel при открытии следующего файла сбросит уровень совместимости многомерного выражения в 1.  
  
 `Provider=MSOLAP.5;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=Adventure Works DW 2008R2;Data Source=AW-SRV01;MDX Compatibility=1;Safety Options=2;MDX Missing Member Mode=Error`  
  
 Дополнительные сведения см. в статьях [подключения к данным, источники данных и строки подключения в Reporting Services](../../reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md) и [Проверка подлинности данных для служб Excel в SharePoint Server 2013](https://go.microsoft.com/fwlink/?LinkId=296350).  
  
##  <a name="connection-string-formats-used-in-analysis-services"></a><a name="bkmk_supportedstrings"></a>Форматы строк подключения, используемые в Analysis Services  
 В этом разделе перечислены все форматы строк подключения, поддерживаемые службами Analysis Services. За исключением соединений с базами данных PowerPivot, эти строки подключения можно указывать в соединениях, которые подключаются к службам Analysis Services.  
  
 **Собственные (или прямые) соединения с сервером**  
  
 `Data Source=server[:port][\instance]`где "Port" и "\" являются необязательными. Например, при указании "Data Source = Server1" открывается соединение с экземпляром по умолчанию (и портом по умолчанию 2383) на сервере с именем Server1.  
  
 "Data Source = Server1: Port1" откроет подключение к экземпляру Analysis Services, работающему по порту "Port1" на сервере Server1.  
  
 "Data Source = server1\instance1" откроет подключение к обозреватель SQL (по его порту по умолчанию 2382), разрешите порт для именованного экземпляра "instance1", а затем откройте подключение к этому Analysis Services порту.  
  
 "Data Source = Server1: port1\instance1" откроет подключение к обозреватель SQL на "Port1", разрешите порт для именованного экземпляра "instance1", а затем откройте подключение к этому Analysis Services порту.  
  
 **Соединение с локальными кубами (файлы CUB)**  
  
 `Data Source=<path>`, например "Data Source = c:\temp\a.cub"  
  
 **Соединения по HTTP(S) с msmdpump.dll**  
  
 `Data Source=<URL>`, где «URL» является адресом HTTP или HTTPS виртуальной папки IIS, которая содержит файл msmdpump.dll. Дополнительные сведения см. в разделе [Настройка HTTP-доступа к службам Analysis Services в службах Internet Information Services (IIS) 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).  
  
 **Соединения по HTTP(S) с книгами PowerPivot (файлы XLSX, XLSB или XLSM)**  
  
 `Data Source=<URL>`, где «URL» — это путь SharePoint к книге PowerPivot, опубликованной в библиотеке SharePoint. Например, «Data Source = <http://localhost/Shared> Documents/Sales.xlsx».  
  
 **Соединения по HTTP(S) с файлами соединения семантической модели бизнес-аналитики**  
  
 `Data Source=<URL>` , где «URL» — путь SharePoint к BISM-файлу. Например, «Data Source = <http://localhost/Shared> Documents/Sales. BISM».  
  
 **Внедренные соединения PowerPivot**  
  
 `Data Source=$Embedded$`, где «$Embedded$» — моникер, ссылающийся на внедренную в книгу модель данных PowerPivot. Такая строка подключения создается и управляется внутренними системными механизмами. Не изменяйте ее. Внедренные строки подключения разрешаются надстройкой PowerPivot для Excel на клиентских рабочих станциях или экземплярами PowerPivot для SharePoint в ферме SharePoint.  
  
 **Контекст локального сервера в хранимых процедурах служб Analysis Services**  
  
 `Data Source=*`, где * разрешается в локальный экземпляр.  
  
##  <a name="encrypting-connection-strings"></a><a name="bkmk_encrypt"></a>Шифрование строк подключения  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] шифруют и сохраняют строки подключения, используемые для подключения к каждому из источников данных. Если для соединения с источником данных необходимы имя пользователя и пароль, то службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] могут сохранять эти имя и пароль в строке соединения или запрашивать имя и пароль каждый раз, когда будет необходимо соединение с источником данных. Если службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] запрашивают данные о пользователе, то эти данные не нужно хранить и шифровать. Однако при сохранении этих данных в строке соединения эти данные необходимо шифровать и обеспечивать их безопасность.  
  
 Чтобы зашифровать и защитить данные строки подключения, службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] используют API-интерфейс защиты данных. Службы[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] используют отдельный ключ шифрования для шифрования данных строки подключения каждой из баз данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] . [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] создают этот ключ при создании базы данных и шифруют данные из строки соединения на основании стартовой учетной записи входа служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] . При запуске служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] зашифрованный ключ для каждой из баз данных считывается, расшифровывается и сохраняется. Затем службы[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] используют соответствующий расшифрованный ключ для расшифровки строки подключения к источнику данных, когда службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] необходимо подключиться к источнику данных.  
  
## <a name="see-also"></a>См. также:  
 [Настройка доступа по протоколу HTTP к Analysis Services на службы IIS &#40;IIS&#41; 8,0](configure-http-access-to-analysis-services-on-iis-8-0.md)   
 [Настройка Analysis Services для ограниченного делегирования Kerberos](configure-analysis-services-for-kerberos-constrained-delegation.md)   
 [Поставщики данных, используемые для подключений Analysis Services](data-providers-used-for-analysis-services-connections.md)   
 [Подключение к службам Analysis Services](connect-to-analysis-services.md)  
  
  
