---
title: Миграция PowerPivot в SharePoint 2013 | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: f698ceb1-d53e-4717-a3a0-225b346760d0
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1e59c6d6553cc9c43155b059fedf4eb6e124ca55
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729918"
---
# <a name="migrate-powerpivot-to-sharepoint-2013"></a><span data-ttu-id="90bf7-102">Перенос PowerPivot на SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="90bf7-102">Migrate PowerPivot to SharePoint 2013</span></span>


 <span data-ttu-id="90bf7-103">SharePoint 2013 не поддерживает обновление на месте.</span><span class="sxs-lookup"><span data-stu-id="90bf7-103">SharePoint 2013 does not support in-place upgrade.</span></span> <span data-ttu-id="90bf7-104">Однако **поддерживается процедура обновления присоединения к базе данных**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-104">However the procedure of **database-attach upgrade is supported**.</span></span> <span data-ttu-id="90bf7-105">Это поведение отличается от обновления до версии SharePoint 2010, при котором клиент может выбрать между двумя базовыми подходами к обновлению: обновление на месте и обновление присоединением базы данных.</span><span class="sxs-lookup"><span data-stu-id="90bf7-105">The behavior is different from upgrading to SharePoint 2010, where a customer could choose between the two basic upgrade approaches, in-place upgrade and database-attach upgrade.</span></span>

 <span data-ttu-id="90bf7-106">Если имеется установленная версия [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] , интегрированная с SharePoint 2010, нельзя обновить сервер SharePoint на месте.</span><span class="sxs-lookup"><span data-stu-id="90bf7-106">If you have a [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] installation integrated with SharePoint 2010, you cannot upgrade in-place the SharePoint server.</span></span> <span data-ttu-id="90bf7-107">Однако можно выполнить миграцию баз данных содержимого и баз данных приложения службы из фермы SharePoint 2010 в ферму SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="90bf7-107">However you can migrate content databases and service application databases from the SharePoint 2010 farm to a SharePoint 2013 farm.</span></span> <span data-ttu-id="90bf7-108">В этом разделе описаны этапы, необходимые для обновления присоединением базы данных и переноса применительно к PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="90bf7-108">This topic is an overview of the steps required to complete a database-attach upgrade and complete a migration related to PowerPivot:</span></span>

 <span data-ttu-id="90bf7-109">**[!INCLUDE[applies](../../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="90bf7-109">**[!INCLUDE[applies](../../../includes/applies-md.md)]**  SharePoint 2013</span></span>

### <a name="migration-overview"></a><span data-ttu-id="90bf7-110">Общие сведения о переносе</span><span class="sxs-lookup"><span data-stu-id="90bf7-110">Migration Overview</span></span>

|<span data-ttu-id="90bf7-111">1</span><span class="sxs-lookup"><span data-stu-id="90bf7-111">1</span></span>|<span data-ttu-id="90bf7-112">2</span><span class="sxs-lookup"><span data-stu-id="90bf7-112">2</span></span>|<span data-ttu-id="90bf7-113">3</span><span class="sxs-lookup"><span data-stu-id="90bf7-113">3</span></span>|<span data-ttu-id="90bf7-114">4</span><span class="sxs-lookup"><span data-stu-id="90bf7-114">4</span></span>|
|-------|-------|-------|-------|
|<span data-ttu-id="90bf7-115">Подготовка фермы SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="90bf7-115">Prepare the SharePoint 2013 farm</span></span>|<span data-ttu-id="90bf7-116">Резервное копирование, копирование и восстановление баз данных.</span><span class="sxs-lookup"><span data-stu-id="90bf7-116">Backup, copy, restore databases.</span></span>|<span data-ttu-id="90bf7-117">Подключение баз данных содержимого</span><span class="sxs-lookup"><span data-stu-id="90bf7-117">Mount content databases</span></span>|<span data-ttu-id="90bf7-118">Перенос расписаний [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)]</span><span class="sxs-lookup"><span data-stu-id="90bf7-118">Migrate [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] Schedules</span></span>|
||[!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]|<span data-ttu-id="90bf7-119">Центр администрирования SharePoint</span><span class="sxs-lookup"><span data-stu-id="90bf7-119">SharePoint Central Administration</span></span><br /><br /> <span data-ttu-id="90bf7-120">Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="90bf7-120">Windows PowerShell</span></span>|<span data-ttu-id="90bf7-121">Страницы приложения SharePoint</span><span class="sxs-lookup"><span data-stu-id="90bf7-121">SharePoint application Pages</span></span><br /><br /> <span data-ttu-id="90bf7-122">Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="90bf7-122">Windows PowerShell</span></span>|

 <span data-ttu-id="90bf7-123">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="90bf7-123">**In this topic:**</span></span>

-   [<span data-ttu-id="90bf7-124">1) Подготовка фермы SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="90bf7-124">1) Prepare the SharePoint 2013 Farm</span></span>](#bkmk_prepare_sharepoint2013)

-   [<span data-ttu-id="90bf7-125">2) Резервное копирование, копирование и восстановление баз данных</span><span class="sxs-lookup"><span data-stu-id="90bf7-125">2) Backup, Copy, Restore the Databases</span></span>](#bkmk_backup_restore)

-   [<span data-ttu-id="90bf7-126">3) Подготовка веб-приложений и присоединение баз данных содержимого</span><span class="sxs-lookup"><span data-stu-id="90bf7-126">3) Prepare Web Applications and Mount Content Databases</span></span>](#bkmk_prepare_mount_databases)

-   [<span data-ttu-id="90bf7-127">4) Обновление расписаний PowerPivot</span><span class="sxs-lookup"><span data-stu-id="90bf7-127">4) Upgrade PowerPivot Schedules</span></span>](#bkmk_upgrade_powerpivot_schedules)

-   [<span data-ttu-id="90bf7-128">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="90bf7-128">Additional Resources</span></span>](#bkmk_additional_resources)

##  <a name="1-prepare-the-sharepoint-2013-farm"></a><a name="bkmk_prepare_sharepoint2013"></a><span data-ttu-id="90bf7-129">1) Подготовка фермы SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="90bf7-129">1) Prepare the SharePoint 2013 Farm</span></span>

1.  > [!TIP]
    >  <span data-ttu-id="90bf7-130">Просмотр метода проверки подлинности, для которого настроены существующие веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="90bf7-130">Review the authentication method your existing web applications are configured for.</span></span> <span data-ttu-id="90bf7-131">В веб-приложениях для SharePoint 2013 по умолчанию применяется проверка подлинности на основе утверждений.</span><span class="sxs-lookup"><span data-stu-id="90bf7-131">SharePoint 2013 web applications default to claims-based authentication.</span></span> <span data-ttu-id="90bf7-132">Веб-приложения SharePoint 2010, настроенные для проверки подлинности в классическом режиме, требуют дополнительных действий при переносе баз данных из SharePoint 2010 в SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="90bf7-132">SharePoint 2010 web applications configured for classic-mode authentication require additional steps to migrate databases from SharePoint 2010 to SharePoint 2013.</span></span> <span data-ttu-id="90bf7-133">Если веб-приложения настроены для проверки подлинности в классическом режиме, см. документацию по продукту SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="90bf7-133">If your web applications are configured for classic-mode authentication, review the SharePoint 2013 documentation.</span></span>

2.  <span data-ttu-id="90bf7-134">Установка новой фермы SharePoint Server 2013</span><span class="sxs-lookup"><span data-stu-id="90bf7-134">Install a new SharePoint Server 2013 farm.</span></span>

3.  <span data-ttu-id="90bf7-135">Установите экземпляр [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] сервера в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="90bf7-135">Install an instance of a [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server in SharePoint mode.</span></span> <span data-ttu-id="90bf7-136">Дополнительные сведения см. в разделе [PowerPivot for SharePoint 2013 Installation](https://docs.microsoft.com/analysis-services/instances/install-windows/install-analysis-services-in-power-pivot-mode).</span><span class="sxs-lookup"><span data-stu-id="90bf7-136">For more information, see [PowerPivot for SharePoint 2013 Installation](https://docs.microsoft.com/analysis-services/instances/install-windows/install-analysis-services-in-power-pivot-mode).</span></span>

4.  <span data-ttu-id="90bf7-137">Запустите пакет установки [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] 2013 **spPowerPivot.msi** на каждом сервере в ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="90bf7-137">Run the [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] 2013 installation package **spPowerPivot.msi** on each server in the SharePoint farm.</span></span> <span data-ttu-id="90bf7-138">Дополнительные сведения см. в разделе [Установка или удаление надстройки PowerPivot для SharePoint &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span><span class="sxs-lookup"><span data-stu-id="90bf7-138">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>

5.  <span data-ttu-id="90bf7-139">В центре администрирования SharePoint 2013 настройте приложение служб Excel для использования сервера служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] в режиме интеграции с SharePoint, созданного на предыдущем шаге.</span><span class="sxs-lookup"><span data-stu-id="90bf7-139">In SharePoint 2013 Central Administration, configure the Excel Services service application to use the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] SharePoint mode server created in the previous step.</span></span> <span data-ttu-id="90bf7-140">Дополнительные сведения см. в разделе "Настройка базовой интеграции Analysis Services SharePoint" статьи [установка PowerPivot для SharePoint 2013](https://docs.microsoft.com/analysis-services/instances/install-windows/install-analysis-services-in-power-pivot-mode).</span><span class="sxs-lookup"><span data-stu-id="90bf7-140">For more information, see the "Configure Basic Analysis Services SharePoint Integration" section of [PowerPivot for SharePoint 2013 Installation](https://docs.microsoft.com/analysis-services/instances/install-windows/install-analysis-services-in-power-pivot-mode).</span></span>

##  <a name="2-backup-copy-restore-the-databases"></a><a name="bkmk_backup_restore"></a><span data-ttu-id="90bf7-141">2) резервное копирование, копирование, восстановление баз данных</span><span class="sxs-lookup"><span data-stu-id="90bf7-141">2) Backup, Copy, Restore the Databases</span></span>
 <span data-ttu-id="90bf7-142">Процесс "обновление присоединения к базе данных SharePoint" — это последовательность действий по резервному копированию, копированию и восстановлению связанных с PowerPivot содержимого и баз данных приложений службы в ферме SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="90bf7-142">The "SharePoint database-attach upgrade" process is a sequence of steps to back up, copy, and restore PowerPivot related content and service application databases to the SharePoint 2013 farm.</span></span>

1.  <span data-ttu-id="90bf7-143">**Перевод базы данных в режим только чтения.** В [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]щелкните правой кнопкой мыши имя базы данных и выберите пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-143">**Set Database to read-only:** In [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], right-click the database name and click **Properties**.</span></span> <span data-ttu-id="90bf7-144">На странице **Параметры** установите значение свойства **База данных доступна только для чтения** , равное **True**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-144">On the **Options** page, set the **Database read-Only** property to **True**.</span></span>

2.  <span data-ttu-id="90bf7-145">**Создание резервной копии.** Создайте резервную копию каждой базы данных содержимого и базы данных приложения службы, для которых необходимо выполнить перенос в ферму SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="90bf7-145">**Back up:** Back up each content database and service application database that you want to migrate to the SharePoint 2013 farm.</span></span> <span data-ttu-id="90bf7-146">В [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]щелкните правой кнопкой мыши имя базы данных, выберите пункт **Задачи**, а затем команду **Создать резервную копию**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-146">In [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], right-click the database name, click **Tasks**, and click **Back up**.</span></span>

3.  <span data-ttu-id="90bf7-147">Скопируйте файлы резервной копии базы данных (BAK) на целевой сервер.</span><span class="sxs-lookup"><span data-stu-id="90bf7-147">File copy the database backup files (.bak) to the desired destination server.</span></span>

4.  <span data-ttu-id="90bf7-148">**Восстановление.** Восстановите базу данных в назначение [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="90bf7-148">**Restore:** Restore the databases to the destination [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)].</span></span> <span data-ttu-id="90bf7-149">Этот этап можно выполнить с помощью [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="90bf7-149">This step can be completed using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span>

5.  <span data-ttu-id="90bf7-150">**Перевод базы данных в режим доступа для чтения и записи.** Задайте для параметра **База данных доступна только для чтения** значение **False**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-150">**Set Database to read-write:** Set the **Database read-Only** to **False**.</span></span>

##  <a name="3-prepare-web-applications-and-mount-content-databases"></a><a name="bkmk_prepare_mount_databases"></a><span data-ttu-id="90bf7-151">3) подготовка веб-приложений и подключение баз данных содержимого</span><span class="sxs-lookup"><span data-stu-id="90bf7-151">3) Prepare Web Applications and Mount Content Databases</span></span>
 <span data-ttu-id="90bf7-152">Более подробное описание следующих процедур см. в разделе [Upgrade databases from sharepoint 2010 to sharepoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256690) ( https://go.microsoft.com/fwlink/p/?LinkId=256690) .</span><span class="sxs-lookup"><span data-stu-id="90bf7-152">For a more detailed explanation of the following procedures, see [Upgrade databases from SharePoint 2010 to SharePoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256690) (https://go.microsoft.com/fwlink/p/?LinkId=256690).</span></span>

1.  <span data-ttu-id="90bf7-153">**Перевод баз данных в режим «вне сети».**</span><span class="sxs-lookup"><span data-stu-id="90bf7-153">**Take Databases Offline:**</span></span>

     <span data-ttu-id="90bf7-154">Переведите в режим «вне сети» все базы данных содержимого SharePoint 2013 с помощью центра администрирования SharePoint.</span><span class="sxs-lookup"><span data-stu-id="90bf7-154">Take each SharePoint 2013 content database offline, using SharePoint Central Administration.</span></span> <span data-ttu-id="90bf7-155">Базы данных содержимого заменяются базами данных, скопированными с перекрытием.</span><span class="sxs-lookup"><span data-stu-id="90bf7-155">The content databases are replaced by the databases you copied over.</span></span> <span data-ttu-id="90bf7-156">Выберите оптимальную последовательность для вашей среды.</span><span class="sxs-lookup"><span data-stu-id="90bf7-156">Consider what is the best sequence for your environment.</span></span> <span data-ttu-id="90bf7-157">Рекомендуется перевести каждую базу данных в режим «вне сети» и подключить соответствующую ей заменяющую базу данных перед переводом следующей базы данных содержимого в режим «вне сети».</span><span class="sxs-lookup"><span data-stu-id="90bf7-157">Consider taking each database offline and mount its relevant replacement database before taking the next content database offline.</span></span> <span data-ttu-id="90bf7-158">Еще один вариант состоит в переводе всех баз данных содержимого в режим «вне сети» в виде группы.</span><span class="sxs-lookup"><span data-stu-id="90bf7-158">Another option is to take all the content databases offline as a group.</span></span>

    1.  <span data-ttu-id="90bf7-159">В центре администрирования SharePoint перейдите на страницу **Управление приложением**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-159">In SharePoint Central Administration, click **Application Management**.</span></span>

    2.  <span data-ttu-id="90bf7-160">Нажмите кнопку **Управление базами данных содержимого**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-160">Click **Manage Content Databases**.</span></span>

    3.  <span data-ttu-id="90bf7-161">Нажмите имя пользователя базы данных.</span><span class="sxs-lookup"><span data-stu-id="90bf7-161">Click the name of the database.</span></span>

    4.  <span data-ttu-id="90bf7-162">В окне **Управление параметрами базы данных содержимого**установите значение **Состояние базы данных** , равное **Вне сети**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-162">On the **Manage Content Database Settings**, set **Database status** to **Offline**.</span></span>

    5.  <span data-ttu-id="90bf7-163">Выберите **Удалить базу данных содержимого**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-163">Select **Remove Content Database**.</span></span> <span data-ttu-id="90bf7-164">Обратите внимание на предупреждение о том, что сайты, сохраненные в базе данных содержимого, становятся недоступными.</span><span class="sxs-lookup"><span data-stu-id="90bf7-164">Note the warning that sites stored in the content database will no longer be accessible.</span></span>

-   <span data-ttu-id="90bf7-165">**Подключение баз данных содержимого.**</span><span class="sxs-lookup"><span data-stu-id="90bf7-165">**Mount content databases:**</span></span>

     <span data-ttu-id="90bf7-166">Используйте командлеты PowerShell в консоли управления SharePoint 2013 для подключения перенесенной базы данных содержимого.</span><span class="sxs-lookup"><span data-stu-id="90bf7-166">Use PowerShell cmdlets in the SharePoint 2013 Management shell to mount the migrated content database.</span></span> <span data-ttu-id="90bf7-167">Базу данных приложения службы не нужно монтировать, а только базы данных содержимого: содержимое, ![связанное с PowerShell](../../../reporting-services/media/rs-powershellicon.jpg "Содержимое, связанное с PowerShell")</span><span class="sxs-lookup"><span data-stu-id="90bf7-167">The service application database does not need to be mounted, only the content databases: ![PowerShell related content](../../../reporting-services/media/rs-powershellicon.jpg "PowerShell related content")</span></span>

    ```powershell
    Mount-SPContentDatabase "SharePoint_Content_O14-KJSP1" -DatabaseServer "[server name]\powerpivot" -WebApplication [web application URL]
    ```

     <span data-ttu-id="90bf7-168">Дополнительные сведения см. в разделе [присоединение или отсоединение баз данных содержимого (SharePoint Server 2010)](https://technet.microsoft.com/library/ff628582.aspx) ( https://technet.microsoft.com/library/ff628582.aspx) .</span><span class="sxs-lookup"><span data-stu-id="90bf7-168">For more information, see [Attach or detach content databases (SharePoint Server 2010)](https://technet.microsoft.com/library/ff628582.aspx) (https://technet.microsoft.com/library/ff628582.aspx).</span></span>

     <span data-ttu-id="90bf7-169">**Состояние после завершения этого шага.**  После завершения операции подключения пользователи могут видеть файлы, которые присутствовали в старой базе данных содержимого.</span><span class="sxs-lookup"><span data-stu-id="90bf7-169">**Status when the step is complete:**  When the mount operation is complete, users can see files that were in the old content database.</span></span> <span data-ttu-id="90bf7-170">Поэтому пользователи могут видеть и открывать книги в библиотеке документов.</span><span class="sxs-lookup"><span data-stu-id="90bf7-170">Therefore users can see and open the workbooks in the document library.</span></span>

    > [!TIP]
    >  <span data-ttu-id="90bf7-171">На этом этапе в процессе переноса можно создавать новые расписания для перенесенных книг.</span><span class="sxs-lookup"><span data-stu-id="90bf7-171">It is possible at this point in the migration process to create new schedules for the migrated workbooks.</span></span> <span data-ttu-id="90bf7-172">Однако эти расписания создаются в новой базе данных приложения службы [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] , а не в базе данных, скопированной из старой фермы SharePoint.</span><span class="sxs-lookup"><span data-stu-id="90bf7-172">However, the schedules are created in the new [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] service application database, and not the database you copied from the old SharePoint farm.</span></span> <span data-ttu-id="90bf7-173">Поэтому она не содержит ни одного из старых расписаний.</span><span class="sxs-lookup"><span data-stu-id="90bf7-173">Therefore it will not contain any of the old schedules.</span></span> <span data-ttu-id="90bf7-174">После выполнения следующей процедуры для использования старой базы данных и переноса старых расписаний новые расписания недоступны.</span><span class="sxs-lookup"><span data-stu-id="90bf7-174">After you complete the following steps to use the old database and migrate the old schedules, the new schedules are not available.</span></span>

### <a name="troubleshoot-issues-when-you-attempt-to-mount-databases"></a><span data-ttu-id="90bf7-175">Устранение неполадок при попытке подключения баз данных</span><span class="sxs-lookup"><span data-stu-id="90bf7-175">Troubleshoot issues when you attempt to mount databases</span></span>
 <span data-ttu-id="90bf7-176">В этом разделе описаны возможные проблемы, обнаруживаемые при подключении базы данных.</span><span class="sxs-lookup"><span data-stu-id="90bf7-176">This section summarizes possible issues encountered when mounting the database.</span></span>

1.  <span data-ttu-id="90bf7-177">**Ошибки проверки подлинности.** При обнаружении ошибок, связанных с проверкой подлинности, определите, какой режим проверки подлинности используется в исходных веб-приложениях.</span><span class="sxs-lookup"><span data-stu-id="90bf7-177">**Authentication errors:** If you see errors related to authentication, review what authentication mode the source web applications are using.</span></span> <span data-ttu-id="90bf7-178">Ошибка может быть вызвана несовпадением способов проверки подлинности между веб-приложением SharePoint 2013 и веб-приложением SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="90bf7-178">The error could be caused by a mismatch in authentication between the SharePoint 2013 web application and the SharePoint 2010 web application.</span></span> <span data-ttu-id="90bf7-179">Дополнительные сведения см. в разделе [1) Подготовка фермы SharePoint 2013](#bkmk_prepare_sharepoint2013) .</span><span class="sxs-lookup"><span data-stu-id="90bf7-179">See the [1) Prepare the SharePoint 2013 Farm](#bkmk_prepare_sharepoint2013) for more information.</span></span>

2.  <span data-ttu-id="90bf7-180">**Отсутствие PowerPivot.Files.** Возникновение ошибок, связанных с отсутствием библиотек DLL PowerPivot, указывает, что не выполнена установка **spPowerPivot.msi** или для настройки PowerPivot не использовалось средство настройки [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="90bf7-180">**Missing PowerPivot.Files:** If you see errors related to missing PowerPivot .dlls, the **spPowerPivot.msi** has not been installed or the [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] Configuration Tool has not been used to configure PowerPivot.</span></span>

##  <a name="4-upgrade-powerpivot-schedules"></a><a name="bkmk_upgrade_powerpivot_schedules"></a><span data-ttu-id="90bf7-181">4) обновление расписаний PowerPivot</span><span class="sxs-lookup"><span data-stu-id="90bf7-181">4) Upgrade PowerPivot Schedules</span></span>
 <span data-ttu-id="90bf7-182">Этот раздел содержит сведения и параметры для переноса расписаний PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="90bf7-182">This section describes the details and options for migrating PowerPivot schedules.</span></span> <span data-ttu-id="90bf7-183">Изменение расписания — двухэтапный процесс.</span><span class="sxs-lookup"><span data-stu-id="90bf7-183">Schedule migration is a two-step process.</span></span> <span data-ttu-id="90bf7-184">Вначале настройте приложение службы PowerPivot на использование перенесенной базы данных.</span><span class="sxs-lookup"><span data-stu-id="90bf7-184">First configure the PowerPivot service application to use the migrated service application database.</span></span> <span data-ttu-id="90bf7-185">После этого необходимо выбрать один из двух вариантов переноса расписания.</span><span class="sxs-lookup"><span data-stu-id="90bf7-185">Second, choose one of two options for schedule migration.</span></span>

 <span data-ttu-id="90bf7-186">**Настройка приложения службы на использование перенесенной базы данных приложения службы.**</span><span class="sxs-lookup"><span data-stu-id="90bf7-186">**Configure the service application to use the migrated service application database.**</span></span>

 <span data-ttu-id="90bf7-187">В центре администрирования SharePoint, чтобы настроить приложение службы PowerPivot на использование старой базы данных приложения службы, поверх которой было выполнено копирование.</span><span class="sxs-lookup"><span data-stu-id="90bf7-187">In SharePoint Central Administration to configure the PowerPivot services application to use the old service application database you copied over.</span></span> <span data-ttu-id="90bf7-188">Служба PowerPivot обновляет базу данных приложения службы до новой схемы.</span><span class="sxs-lookup"><span data-stu-id="90bf7-188">The PowerPivot Service upgrades the service application database to the new schema.</span></span>

1.  <span data-ttu-id="90bf7-189">В центре администрирования SharePoint выберите **Управление приложениями службы**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-189">In SharePoint Central Administration, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="90bf7-190">Найдите приложение службы PowerPivot, например "приложение службы PowerPivot по умолчанию", щелкните имя приложения службы и нажмите кнопку **Свойства** на ленте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="90bf7-190">Find the PowerPivot service application, for example "Default PowerPivot Service Application", click the name of the service application and click **Properties** in the SharePoint ribbon.</span></span>

3.  <span data-ttu-id="90bf7-191">Обновление имен экземпляра сервера базы данных и базы данных.</span><span class="sxs-lookup"><span data-stu-id="90bf7-191">Update the database server name-instance and the database name.</span></span> <span data-ttu-id="90bf7-192">Исправление имен для базы данных, для которой была создана резервная копия, проведено копирование и восстановление.</span><span class="sxs-lookup"><span data-stu-id="90bf7-192">To the correct names for the database you backed up, copied, and restored.</span></span> <span data-ttu-id="90bf7-193">После нажатия кнопки **ОК**обновляется база данных приложения службы.</span><span class="sxs-lookup"><span data-stu-id="90bf7-193">Once you click **Ok**, the service application database is upgraded.</span></span> <span data-ttu-id="90bf7-194">Ошибки будут записаны в журнал ULS.</span><span class="sxs-lookup"><span data-stu-id="90bf7-194">Errors will be in the ULS log.</span></span>

 <span data-ttu-id="90bf7-195">**Обновление расписаний PowerPivot**</span><span class="sxs-lookup"><span data-stu-id="90bf7-195">**Upgrade PowerPivot schedules**</span></span>

 <span data-ttu-id="90bf7-196">Настройка приложения службы PowerPivot для переноса обновленных расписаний.</span><span class="sxs-lookup"><span data-stu-id="90bf7-196">Configure the PowerPivot service application to migrate refresh schedules.</span></span>

-   <span data-ttu-id="90bf7-197">**Перенос расписаний, вариант 1. Администратор фермы SharePoint**</span><span class="sxs-lookup"><span data-stu-id="90bf7-197">**Migrate Schedules option1: SharePoint farm administrator**</span></span>

    1.  <span data-ttu-id="90bf7-198">В службе управления SharePoint 2013 выполните `Set-PowerPivotServiceApplication` командлет с `-StartMigratingRefreshSchedules` параметром, чтобы включить автоматическое включение в расписание миграции ![содержимого, связанного с PowerShell](../../../reporting-services/media/rs-powershellicon.jpg "Содержимое, связанное с PowerShell").</span><span class="sxs-lookup"><span data-stu-id="90bf7-198">In the SharePoint 2013 Management Run the `Set-PowerPivotServiceApplication` cmdlet with the `-StartMigratingRefreshSchedules` switch to enable automatic on demand schedule migration ![PowerShell related content](../../../reporting-services/media/rs-powershellicon.jpg "PowerShell related content").</span></span> <span data-ttu-id="90bf7-199">При использовании следующего скрипта Windows PowerShell предполагается наличие только одного приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="90bf7-199">The following Windows PowerShell script assumes that there is only one PowerPivot service application.</span></span>

        ```powershell
        $app = Get-PowerPivotServiceApplication
        Set-PowerPivotServiceApplication $app -StartMigratingRefreshSchedules
        ```

         <span data-ttu-id="90bf7-200">После выполнения скрипта Windows PowerShell расписания активны и запускаются в следующий плановый момент времени.</span><span class="sxs-lookup"><span data-stu-id="90bf7-200">After the Windows PowerShell script is run, the schedules are active and the schedules will run at the next appropriate time.</span></span> <span data-ttu-id="90bf7-201">Однако одна из страниц обновления расписания не переходит в состояние «включено».</span><span class="sxs-lookup"><span data-stu-id="90bf7-201">However, the status one the schedule refresh page is not enabled.</span></span> <span data-ttu-id="90bf7-202">После первого запуска расписания выполняется его перенос и на странице обновления расписания значение **Включено**  становится равным true.</span><span class="sxs-lookup"><span data-stu-id="90bf7-202">When the schedule runs the first time it will be migrated and on the schedule refresh page, **Enabled**  will be true.</span></span>

    2.  <span data-ttu-id="90bf7-203">Чтобы проверить текущее значение свойства StartMigratingRefreshSchedules, выполните следующий скрипт PowerShell.</span><span class="sxs-lookup"><span data-stu-id="90bf7-203">If you want to check the current value of the StartMigratingRefreshSchedules property, run the following PowerShell script.</span></span> <span data-ttu-id="90bf7-204">Этот скрипт обрабатывает в цикле все объекты приложения службы PowerPivot и отображает имя и значение свойства.</span><span class="sxs-lookup"><span data-stu-id="90bf7-204">The Script loops through all PowerPivot service application objects and display the name and property values:</span></span>

        ```powershell
        $apps = Get-PowerPivotServiceApplication
        foreach ($app in $apps){ Get-PowerPivotServiceApplication $app | Format-Table -Property displayname, id, StartMigratingRefreshSchedules }
        ```

     <span data-ttu-id="90bf7-205">**Перенос расписаний, вариант 2. Пользователь обновляет каждую книгу**</span><span class="sxs-lookup"><span data-stu-id="90bf7-205">**Migrate Schedules option2: User updates each workbook**</span></span>

    1.  <span data-ttu-id="90bf7-206">Еще один способ переноса расписания состоит в том, чтобы включить обновление расписания для каждой книги.</span><span class="sxs-lookup"><span data-stu-id="90bf7-206">Another option to migrate schedules is to enable the schedule refresh for each workbook.</span></span> <span data-ttu-id="90bf7-207">Перейдите к библиотеке документов, которая содержит книги.</span><span class="sxs-lookup"><span data-stu-id="90bf7-207">Navigate to the document library that contains the workbooks.</span></span>

    2.  <span data-ttu-id="90bf7-208">Откройте контекстное меню книги и выберите пункт **Управление обновлением данных PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-208">Open the context menu and click **Manage PowerPivot Data Refresh**.</span></span>

    3.  <span data-ttu-id="90bf7-209">В разделе **Обновление по расписанию** щелкните **Включить**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-209">In the **schedule refresh** section, click **Enable**.</span></span>

    4.  <span data-ttu-id="90bf7-210">Можно выбрать **Кроме того, обновить данные как можно скорее**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-210">You can select **Also refresh as soon as possible**.</span></span> <span data-ttu-id="90bf7-211">Этот параметр добавляет один экземпляр обновления в очередь после нажатия кнопки «ОК».</span><span class="sxs-lookup"><span data-stu-id="90bf7-211">This option adds one instance of the refresh to the queue as soon as you click ok.</span></span> <span data-ttu-id="90bf7-212">В соответствующий момент времени все равно запускается обычное расписание обновления.</span><span class="sxs-lookup"><span data-stu-id="90bf7-212">The regular refresh schedule still triggers at the appropriate time.</span></span>

    5.  <span data-ttu-id="90bf7-213">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="90bf7-213">Click **Ok**.</span></span> <span data-ttu-id="90bf7-214">На странице расписания обновления отображается журнал обновления и в обычное время активизируется расписание.</span><span class="sxs-lookup"><span data-stu-id="90bf7-214">The refresh history is now visible in the refresh page, the schedule will fire at the normal time.</span></span>

 <span data-ttu-id="90bf7-215">**Книги SQL Server 2008 R2 PowerPivot**</span><span class="sxs-lookup"><span data-stu-id="90bf7-215">**SQL Server 2008 R2 PowerPivot workbooks**</span></span>

-   <span data-ttu-id="90bf7-216">Книги SQL Server 2008 R2 PowerPivot не обновляются автоматически при их использовании в SQL Server 2012 PowerPivot с пакетом обновления 1 (SP1) для SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="90bf7-216">SQL Server 2008 R2 PowerPivot workbooks do not automatically upgrade when they are used in SQL Server 2012 SP1 PowerPivot for SharePoint 2013.</span></span> <span data-ttu-id="90bf7-217">После переноса базы данных содержимого, которая содержит книги 2008 R2, можно использовать книги, но обновление расписаний не происходит.</span><span class="sxs-lookup"><span data-stu-id="90bf7-217">After you migrate a content database containing the 2008 R2 workbooks, you can use the workbooks but the schedules do not upgrade.</span></span>

-   <span data-ttu-id="90bf7-218">Дополнительные сведения см. в статье [Обновление книг и запланированное обновление данных (SharePoint 2013 )](https://docs.microsoft.com/analysis-services/instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013).</span><span class="sxs-lookup"><span data-stu-id="90bf7-218">For more information, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013).</span></span>

##  <a name="additional-resources"></a><a name="bkmk_additional_resources"></a> <span data-ttu-id="90bf7-219">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="90bf7-219">Additional Resources</span></span>

> [!NOTE]
>  <span data-ttu-id="90bf7-220">Дополнительные сведения по [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] и обновлению присоединением базы данных SharePoint см. в разделах:</span><span class="sxs-lookup"><span data-stu-id="90bf7-220">For more information on [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] and SharePoint database-attach upgrade, see the following:</span></span>

-   <span data-ttu-id="90bf7-221">[Обновление книг и запланированное обновление данных (SharePoint 2013)](https://docs.microsoft.com/analysis-services/instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013).</span><span class="sxs-lookup"><span data-stu-id="90bf7-221">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013).</span></span>

-   <span data-ttu-id="90bf7-222">[Общие сведения о процессе обновления до SharePoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256688) ( https://go.microsoft.com/fwlink/p/?LinkId=256688) .</span><span class="sxs-lookup"><span data-stu-id="90bf7-222">[Overview of the upgrade process to SharePoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256688) (https://go.microsoft.com/fwlink/p/?LinkId=256688).</span></span>

-   <span data-ttu-id="90bf7-223">[Выполните предварительную подготовку перед обновлением до SharePoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256689) ( https://go.microsoft.com/fwlink/p/?LinkId=256689) .</span><span class="sxs-lookup"><span data-stu-id="90bf7-223">[Clean up preparations before an upgrade to SharePoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256689) (https://go.microsoft.com/fwlink/p/?LinkId=256689).</span></span>

-   <span data-ttu-id="90bf7-224">[Обновите базы данных с sharepoint 2010 на sharepoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256690) ( https://go.microsoft.com/fwlink/p/?LinkId=256690) .</span><span class="sxs-lookup"><span data-stu-id="90bf7-224">[Upgrade databases from SharePoint 2010 to SharePoint 2013](https://go.microsoft.com/fwlink/p/?LinkId=256690) (https://go.microsoft.com/fwlink/p/?LinkId=256690).</span></span>
