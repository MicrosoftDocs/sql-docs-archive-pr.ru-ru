---
title: Обновление книг и обновление данных по расписанию (SharePoint 2013) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: a49c4af4-e243-4926-be97-74da1f9d54eb
author: minewiskan
ms.author: owend
ms.openlocfilehash: 185fe0864bc4c1cdda9a63fa97a17319d65dc87d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729914"
---
# <a name="upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013"></a><span data-ttu-id="37999-102">Обновление книг и запланированное обновление данных (SharePoint 2013)</span><span class="sxs-lookup"><span data-stu-id="37999-102">Upgrade Workbooks and Scheduled Data Refresh (SharePoint 2013)</span></span>
  <span data-ttu-id="37999-103">В этом разделе описываются способы использования книг, созданных в предыдущих средах PowerPivot, и способы обновления книг PowerPivot с целью получения преимуществ от новых функций этого выпуска.</span><span class="sxs-lookup"><span data-stu-id="37999-103">This topic explains the user experience of workbooks created in previous PowerPivot environments and how to upgrade PowerPivot workbooks so that you can take advantage of new features introduced in this release.</span></span> <span data-ttu-id="37999-104">Дополнительные сведения о новых возможностях см. в разделе [новые возможности PowerPivot](https://go.microsoft.com/fwlink/?LinkID=203917).</span><span class="sxs-lookup"><span data-stu-id="37999-104">To learn more about new features, see [What's New in PowerPivot](https://go.microsoft.com/fwlink/?LinkID=203917).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="37999-105">Невозможно выполнить откат обновления для книг, автоматически обновленных на сервере.</span><span class="sxs-lookup"><span data-stu-id="37999-105">You cannot rollback upgrade for workbooks that are upgraded automatically on the server.</span></span> <span data-ttu-id="37999-106">После обновления книги она остается обновленной.</span><span class="sxs-lookup"><span data-stu-id="37999-106">Once a workbook is upgraded, it remains upgraded.</span></span> <span data-ttu-id="37999-107">Для использования предыдущей версии можно повторно опубликовать предыдущую книгу в SharePoint, восстановить предыдущую версию или повторно использовать книгу.</span><span class="sxs-lookup"><span data-stu-id="37999-107">To use a previous version, you can republish the previous workbook to SharePoint, restore a previous version, or recycle the workbook.</span></span> <span data-ttu-id="37999-108">Дополнительные сведения о восстановлении и повторном использовании документа в SharePoint см. в разделе [Планирование защиты содержимого с использованием корзин и управления версиями](https://go.microsoft.com/fwlink/?LinkId=238669).</span><span class="sxs-lookup"><span data-stu-id="37999-108">For more information about restoring or recycling a document in SharePoint, see [Plan to protect content by using recycle bins and versioning](https://go.microsoft.com/fwlink/?LinkId=238669).</span></span>  
  
 <span data-ttu-id="37999-109">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="37999-109">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="37999-110">Общие сведения об обновлении книг</span><span class="sxs-lookup"><span data-stu-id="37999-110">Overview of Upgrading Workbooks</span></span>](#bkmk_overview)  
  
-   [<span data-ttu-id="37999-111">Выполните обновление до книг версии SQL Server 2012 с пакетом обновления 1 (SP1) от книг 2008 R2</span><span class="sxs-lookup"><span data-stu-id="37999-111">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>](#bkmk_to_2012sp1_from_2008r2)  
  
-   [<span data-ttu-id="37999-112">Обновление до книг Office 2013 из версий, созданных с помощью надстройки PowerPivot 2012 для Excel</span><span class="sxs-lookup"><span data-stu-id="37999-112">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>](#bkmk_to_2012sp1_from_2012)  
  
-   [<span data-ttu-id="37999-113">Обновление до книг SQL Server 2012 из версий, созданных с помощью надстройки 2008 R2 PowerPivot для Excel 2010</span><span class="sxs-lookup"><span data-stu-id="37999-113">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>](#bkmk_to_2012_from_2008R2)  
  
-   [<span data-ttu-id="37999-114">Запуск нескольких версий книги на более новом сервере</span><span class="sxs-lookup"><span data-stu-id="37999-114">Running Multiple Workbook Versions on a Newer Server</span></span>](#bkmk_runold)  
  
##  <a name="overview-of-upgrading-workbooks"></a><a name="bkmk_overview"></a><span data-ttu-id="37999-115">Общие сведения об обновлении книг</span><span class="sxs-lookup"><span data-stu-id="37999-115">Overview of Upgrading Workbooks</span></span>  
 <span data-ttu-id="37999-116">Книга PowerPivot — это книга Excel с внедренными данными PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37999-116">A PowerPivot workbook is an Excel workbook that contains embedded PowerPivot data.</span></span> <span data-ttu-id="37999-117">Обновление книги обеспечивает два преимущества.</span><span class="sxs-lookup"><span data-stu-id="37999-117">Upgrading a workbook has two benefits:</span></span>  
  
-   <span data-ttu-id="37999-118">Используйте новые возможности [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="37999-118">Use new features in [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)].</span></span>  
  
-   <span data-ttu-id="37999-119">Становится возможным плановое обновление данных для книг, которые работают с сервером служб [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services в режиме интеграции с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37999-119">Enables scheduled data refresh for workbooks that run with a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services server in SharePoint mode.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="37999-120">Нельзя выполнить откат обновленной книги, поэтому обязательно создайте копию файла, если предполагается его использование в предыдущих версиях [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)]или [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="37999-120">You cannot rollback an upgraded workbook, so be sure to make a copy of the file if you want to use it in the previous version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], or on a previous version of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="37999-121">В следующей таблице перечислены поддержка и поведение книг PowerPivot в зависимости от среды, в которой была создана книга.</span><span class="sxs-lookup"><span data-stu-id="37999-121">The following table lists the support and behavior of PowerPivot workbooks based on the environment  in which the workbook was created.</span></span> <span data-ttu-id="37999-122">Описанное поведение включает общие методы работы пользователя, поддерживаемые варианты обновления книги в определенной среде и плановое обновление данных книги, которая еще не была обновлена.</span><span class="sxs-lookup"><span data-stu-id="37999-122">The behavior described includes the general user experience, the supported upgrade options to upgrade the workbook to the particular environment, and the behavior of scheduled data refresh of a workbook that has not yet been upgraded.</span></span>  
  
### <a name="workbook-behavior-and-upgrade-options"></a><span data-ttu-id="37999-123">Поведение и варианты обновления книги</span><span class="sxs-lookup"><span data-stu-id="37999-123">Workbook Behavior and Upgrade Options</span></span>  
  
|<span data-ttu-id="37999-124">Создано в</span><span class="sxs-lookup"><span data-stu-id="37999-124">Created In</span></span>|\<|<span data-ttu-id="37999-125">Поддержка и поведение</span><span class="sxs-lookup"><span data-stu-id="37999-125">Support and Behavior</span></span>|>|  
|----------------|--------|--------------------------|--------|  
||<span data-ttu-id="37999-126">**2008 R2 PowerPivot для SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="37999-126">**2008 R2 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="37999-127">**2012 PowerPivot для SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="37999-127">**2012 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="37999-128">**2012 PowerPivot с пакетом обновления 1 (SP1) для SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="37999-128">**2012 SP1 PowerPivot for SharePoint 2013**</span></span>|  
|<span data-ttu-id="37999-129">**2008 R2 PowerPivot для Excel 2010**</span><span class="sxs-lookup"><span data-stu-id="37999-129">**2008 R2 PowerPivot for Excel 2010**</span></span>|<span data-ttu-id="37999-130">Все компоненты</span><span class="sxs-lookup"><span data-stu-id="37999-130">All Features</span></span>|<span data-ttu-id="37999-131">**Взаимодействие.** Пользователи могут взаимодействовать с книгой в браузере и использовать ее в качестве источника данных для других решений.</span><span class="sxs-lookup"><span data-stu-id="37999-131">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="37999-132">**Обновление.** Автоматическое обновление книг в библиотеке документов, если автоматическое обновление включено для системной службы PowerPivot в ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37999-132">**Upgrade:** Workbooks will auto upgrade in the document library if Auto Upgrade is enabled for the PowerPivot system Service in the SharePoint farm,</span></span><br /><br /> <span data-ttu-id="37999-133">**Расписание обновления данных.** НЕ поддерживается.</span><span class="sxs-lookup"><span data-stu-id="37999-133">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="37999-134">Книгу необходимо обновить.</span><span class="sxs-lookup"><span data-stu-id="37999-134">Workbook needs to be upgraded.</span></span>|<span data-ttu-id="37999-135">**Взаимодействие.** Пользователи могут взаимодействовать с книгой и использовать ее в качестве источника данных для других решений.</span><span class="sxs-lookup"><span data-stu-id="37999-135">**Experience:** Users can interact with the workbook and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="37999-136">**Обновление.** Автоматическое обновление недоступно.</span><span class="sxs-lookup"><span data-stu-id="37999-136">**Upgrade:** Auto upgrade is not available.</span></span> <span data-ttu-id="37999-137">Необходимо вручную обновить книги 2008 R2 до версии 2012 или до версии Office 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-137">Users must manually upgrade their 2008 R2 workbooks to the 2012 version or to the office 2013 version.</span></span><br /><br /> <span data-ttu-id="37999-138">**Расписание обновления данных.** НЕ поддерживается.</span><span class="sxs-lookup"><span data-stu-id="37999-138">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="37999-139">Книгу необходимо обновить.</span><span class="sxs-lookup"><span data-stu-id="37999-139">Workbook needs to be upgraded.</span></span>|  
|<span data-ttu-id="37999-140">**2012 PowerPivot для Excel**</span><span class="sxs-lookup"><span data-stu-id="37999-140">**2012 PowerPivot for Excel**</span></span>|<span data-ttu-id="37999-141">Не поддерживается</span><span class="sxs-lookup"><span data-stu-id="37999-141">Not supported</span></span>|<span data-ttu-id="37999-142">Все компоненты</span><span class="sxs-lookup"><span data-stu-id="37999-142">All Features</span></span>|<span data-ttu-id="37999-143">**Взаимодействие.** Пользователи могут взаимодействовать с книгой в браузере и использовать ее в качестве источника данных для других решений.</span><span class="sxs-lookup"><span data-stu-id="37999-143">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span> <span data-ttu-id="37999-144">Расписание обновления данных доступно.</span><span class="sxs-lookup"><span data-stu-id="37999-144">Schedule data refresh is available.</span></span><br /><br /> <span data-ttu-id="37999-145">**Обновление.** Автоматическое обновление не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="37999-145">**Upgrade:** Auto upgrade is not supported.</span></span> <span data-ttu-id="37999-146">Пользователи могут вручную обновить книги до версии Office 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-146">Users can manually upgrade their workbooks to the Office 2013 version.</span></span><br /><br /> <span data-ttu-id="37999-147">**Расписание обновления данных:** поддерживается.</span><span class="sxs-lookup"><span data-stu-id="37999-147">**Schedule data refresh:** supported.</span></span>|  
|<span data-ttu-id="37999-148">**Excel 2013**</span><span class="sxs-lookup"><span data-stu-id="37999-148">**Excel 2013**</span></span>|<span data-ttu-id="37999-149">Не поддерживается</span><span class="sxs-lookup"><span data-stu-id="37999-149">Not supported</span></span>|<span data-ttu-id="37999-150">Не поддерживается</span><span class="sxs-lookup"><span data-stu-id="37999-150">Not supported</span></span>|<span data-ttu-id="37999-151">Все компоненты</span><span class="sxs-lookup"><span data-stu-id="37999-151">All Features</span></span>|  
  
##  <a name="upgrade-to-sql-server-2012-service-pack-1-sp1-workbooks-from-2008-r2-workbooks"></a><a name="bkmk_to_2012sp1_from_2008r2"></a><span data-ttu-id="37999-152">Обновление до SQL Server 2012 книг с пакетом обновления 1 (SP1) из книг 2008 R2</span><span class="sxs-lookup"><span data-stu-id="37999-152">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>  
 <span data-ttu-id="37999-153">В этом разделе описывается обновление книг SQL Server 2012 PowerPivot с пакетом обновления 1 (SP1) для Excel 2013 от книг SQL Server 2008 R2 PowerPivot для Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="37999-153">This section describes upgrading to SQL Server 2012 SP1 PowerPivot for Excel 2013 workbooks from SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="37999-154">**Изменения в работе.** Книги SQL Server 2008 R2 PowerPivot не обновляются автоматически при их использовании в SQL Server 2012 PowerPivot с пакетом обновления 1 (SP1) для SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-154">**Behavior Change:** SQL Server 2008 R2 PowerPivot workbooks will not be automatically upgraded  when they are used in SQL Server 2012 SP1 PowerPivot for SharePoint 2013.</span></span> <span data-ttu-id="37999-155">Поэтому плановые обновления данных не будут действовать для книг SQL Server 2008 R2 PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37999-155">Therefore, scheduled data refreshes will not work for SQL Server 2008 R2 PowerPivot workbooks</span></span>  
  
 <span data-ttu-id="37999-156">Книги 2008 R2 открываются в PowerPivot для SharePoint 2013, однако плановые обновления данных не выполняются.</span><span class="sxs-lookup"><span data-stu-id="37999-156">2008 R2 workbooks will open in PowerPivot for SharePoint 2013, however scheduled data refreshes will not work.</span></span> <span data-ttu-id="37999-157">При просмотре журнала обновления обнаруживается сообщение об ошибке следующего вида:</span><span class="sxs-lookup"><span data-stu-id="37999-157">If you review the refresh history you will see an error message similar to the following:</span></span>  
  
 <span data-ttu-id="37999-158">"Книга содержит неподдерживаемую модель PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37999-158">"The workbook contains an unsupported PowerPivot model.</span></span> <span data-ttu-id="37999-159">Модель PowerPivot в книге представлена в формате SQL Server 2008 R2 PowerPivot для Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="37999-159">The PowerPivot model in the workbook is in the SQL Server 2008 R2 PowerPivot for Excel 2010 format.</span></span> <span data-ttu-id="37999-160">Поддерживаются следующие модели PowerPivot:</span><span class="sxs-lookup"><span data-stu-id="37999-160">Supported PowerPivot models are the following:</span></span>  
  
-   <span data-ttu-id="37999-161">SQL Server 2012 PowerPivot для Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="37999-161">SQL Server 2012 PowerPivot for Excel 2010.</span></span>  
  
-   <span data-ttu-id="37999-162">SQL Server 2012 PowerPivot для Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-162">SQL Server 2012 PowerPivot for Excel 2013.</span></span>  
  
 <span data-ttu-id="37999-163">**Обновление книги.** Плановое обновление данных не будет работать, пока книга не будет обновлена до книги 2012.</span><span class="sxs-lookup"><span data-stu-id="37999-163">**How to upgrade a workbook:** The Scheduled data refresh will not work until you upgrade the workbook to a 2012 workbook.</span></span> <span data-ttu-id="37999-164">Для обновления книги и содержащейся в ней модели выполните одно из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="37999-164">To upgrade the workbook and model it contains, complete one of the following:</span></span>  
  
-   <span data-ttu-id="37999-165">Загрузите и откройте книгу в Microsoft Excel 2010 с помощью установленной надстройки SQL Server 2012 PowerPivot для Excel.</span><span class="sxs-lookup"><span data-stu-id="37999-165">Download and open the workbook in Microsoft Excel 2010 with the SQL Server 2012 PowerPivot for Excel add-in installed.</span></span>  
  
     <span data-ttu-id="37999-166">Откройте окно PowerPivot и обновите модель PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37999-166">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="37999-167">Сохраните книгу и повторно опубликуйте ее в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37999-167">Then save the workbook and republish it to SharePoint.</span></span>  
  
-   <span data-ttu-id="37999-168">Загрузите и откройте книгу в Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-168">Download and open the workbook in Microsoft Excel 2013.</span></span>  
  
     <span data-ttu-id="37999-169">Откройте окно PowerPivot и обновите модель PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37999-169">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="37999-170">Затем сохраните книгу и повторно опубликуйте ее на сервере SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37999-170">Then save the workbook and republish it to the SharePoint server.</span></span>  
  
 <span data-ttu-id="37999-171">Дополнительные сведения об изменениях в Analysis Services компонентах см. в разделе [изменения в работе функций Analysis Services в SQL Server 2014](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md) .</span><span class="sxs-lookup"><span data-stu-id="37999-171">For more information on Changes to Analysis Services features, see [Behavior Changes to Analysis Services Features in SQL Server 2014](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md)</span></span>  
  
 <span data-ttu-id="37999-172">Дополнительные сведения о журнале обновления см. в статье [Просмотр журнала обновления данных &#40;PowerPivot для SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="37999-172">For more information on refresh history, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>  
  
##  <a name="upgrade-to-office-2013-workbooks-from-versions-created-by-using-the-2012-powerpivot-add-in-for-excel"></a><a name="bkmk_to_2012sp1_from_2012"></a><span data-ttu-id="37999-173">Обновление до книг Office 2013 из версий, созданных с помощью надстройки 2012 PowerPivot для Excel</span><span class="sxs-lookup"><span data-stu-id="37999-173">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>  
 <span data-ttu-id="37999-174">В этом разделе описывается обновление **до** SQL Server 2012 PowerPivot с пакетом обновления 1 (SP1) в Excel 2013 **от** книг SQL Server 2012 PowerPivot для Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="37999-174">This section describes Upgrading **to** SQL Server 2012 SP1 PowerPivot in Excel 2013 **from** SQL Server 2012 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="37999-175">Обновление книги устраняет следующие ошибки, которые возникают при попытке обновления данных книги предшествующей версии по расписанию:</span><span class="sxs-lookup"><span data-stu-id="37999-175">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="37999-176">"Операция обновления для книг, созданных с использованием более ранней версии PowerPivot, недоступна".</span><span class="sxs-lookup"><span data-stu-id="37999-176">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="37999-177">**Обновление книги**</span><span class="sxs-lookup"><span data-stu-id="37999-177">**How to upgrade a workbook**</span></span>  
  
1.  <span data-ttu-id="37999-178">Обновите каждую книгу вручную, открыв ее в Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-178">Upgrade each workbook manually by opening it in Microsoft Excel 2013.</span></span>  
  
2.  <span data-ttu-id="37999-179">Для обновления книги и содержащейся в ней модели загрузите и откройте книгу в приложении Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-179">To upgrade the workbook and model it contains, download and open the workbook in Microsoft Excel 2013.</span></span>  
  
3.  <span data-ttu-id="37999-180">Откройте окно PowerPivot и обновите модель PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37999-180">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
4.  <span data-ttu-id="37999-181">Затем сохраните книгу и повторно опубликуйте ее на сервере SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="37999-181">Then save the workbook and republish it to the SharePoint 2013 server.</span></span>  
  
##  <a name="upgrade-to-sql-server-2012-workbooks-from-versions-created-by-using-the-2008-r2-powerpivot-add-in-for-excel-2010"></a><a name="bkmk_to_2012_from_2008R2"></a><span data-ttu-id="37999-182">Обновление до SQL Server 2012 книг из версий, созданных с помощью надстройки 2008 R2 PowerPivot для Excel 2010</span><span class="sxs-lookup"><span data-stu-id="37999-182">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>  
 <span data-ttu-id="37999-183">В этом разделе описывается обновление **до** SQL Server 2012 PowerPivot для Excel 2010 **от** книг SQL Server 2008 R2 PowerPivot для Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="37999-183">This section describes Upgrading **to** SQL Server 2012 PowerPivot for Excel 2010 **from** SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="37999-184">Обновление книги устраняет следующие ошибки, которые возникают при попытке обновления данных книги предшествующей версии по расписанию:</span><span class="sxs-lookup"><span data-stu-id="37999-184">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="37999-185">"Операция обновления для книг, созданных с использованием более ранней версии PowerPivot, недоступна".</span><span class="sxs-lookup"><span data-stu-id="37999-185">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="37999-186">**Обновление книги**</span><span class="sxs-lookup"><span data-stu-id="37999-186">**How to upgrade a workbook**</span></span>  
  
 <span data-ttu-id="37999-187">Существует два способа обновления.</span><span class="sxs-lookup"><span data-stu-id="37999-187">There are two ways to upgrade:</span></span>  
  
1.  <span data-ttu-id="37999-188">Обновить версию каждой книги вручную путем ее открытия в Excel на компьютере, где установлена версия [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] PowerPivot для Excel с последующей повторной публикацией на сервере.</span><span class="sxs-lookup"><span data-stu-id="37999-188">Upgrade each workbook manually by opening it in Excel on a computer that has the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of PowerPivot for Excel, and then republish it to the server.</span></span> <span data-ttu-id="37999-189">При открытии книги в последней версии надстройки выполняются следующие внутренние операции. Поставщик данных в строке подключения к данным книги обновляется до MSOLAP.5, обновляются также метаданные, и выполняется воссоздание связей для соответствия более новой реализации.</span><span class="sxs-lookup"><span data-stu-id="37999-189">When you open the workbook in the newer version of the add-in, the following internal operations occur: the data provider in the workbook data connection string is updated to MSOLAP.5, metadata is updated, and relationships are recreated to conform to a newer implementation.</span></span>  
  
2.  <span data-ttu-id="37999-190">Иначе администратор SharePoint может включить функцию автоматического обновления для службы PowerPivot в ферме SharePoint, чтобы автоматически обновить книгу [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot при выполнении обновления данных по расписанию (обновлены только книги, для которых настроено обновление данных по расписанию).</span><span class="sxs-lookup"><span data-stu-id="37999-190">Alternatively, a SharePoint Administrator  can enable the auto-upgrade feature for the PowerPivot System Service in a SharePoint farm to  automatically upgrade a [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot workbook when schedule data refresh runs (only workbooks that are configured for scheduled data refresh are upgraded).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="37999-191">Автоматическое обновление — это функция настройки сервера; его нельзя включить или отключить для конкретной книги, библиотеки или семейства веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="37999-191">Automatic upgrade is a server configuration feature; you cannot enable or disable it for specific workbooks, libraries, or site collections.</span></span>  
  
 <span data-ttu-id="37999-192">**Настройка автоматического обновления во время обновления данных**</span><span class="sxs-lookup"><span data-stu-id="37999-192">**How to configure automatic upgrade during data refresh**</span></span>  
  
 <span data-ttu-id="37999-193">Чтобы включить автоматическое обновление, необходимо установить флажок **Автоматически обновлять книги PowerPivot для обновления данных с сервера** в программе настройки PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37999-193">To use automatic upgrade, you must select the **Automatically upgrade PowerPivot workbooks to enable data refresh from the server** checkbox in the PowerPivot Configuration Tool.</span></span> <span data-ttu-id="37999-194">Флажок находится на странице **Обновление системной службы PowerPivot** этой программы либо на странице **Создание приложения службы PowerPivot** при настройке новой установки.</span><span class="sxs-lookup"><span data-stu-id="37999-194">Within the tool, the checkbox is on the **Upgrade PowerPivot System Service** page, and on the **Create PowerPivot Service Application** page if you are configuring a new installation.</span></span>  
  
 <span data-ttu-id="37999-195">Запустив следующий командлет, можно проверить, включена ли функция автоматического обновления.</span><span class="sxs-lookup"><span data-stu-id="37999-195">You can run the following cmdlet to verify whether automatic upgrade is enabled:</span></span>  
  
```  
PS C:\Windows\system32> Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="37999-196">Результатом вызова Get-PowerPivotSystemService будет список свойств вместе с соответствующими значениями.</span><span class="sxs-lookup"><span data-stu-id="37999-196">The output from Get-PowerPivotSystemService is a list of properties and corresponding values.</span></span> <span data-ttu-id="37999-197">В списке свойств нужно найти `WorkbookUpgradeOnDataRefresh`.</span><span class="sxs-lookup"><span data-stu-id="37999-197">You should see `WorkbookUpgradeOnDataRefresh` in the property list.</span></span> <span data-ttu-id="37999-198">Оно будет иметь значение **true** , если автоматическое обновление включено.</span><span class="sxs-lookup"><span data-stu-id="37999-198">It will be set to **true** if automatic upgrade is enabled.</span></span> <span data-ttu-id="37999-199">Если же это свойство имеет значение **false**, перейдите на следующий шаг и включите автоматическое обновление книги.</span><span class="sxs-lookup"><span data-stu-id="37999-199">If it is **false**, continue to the next step, enabling automatic workbook upgrade.</span></span>  
  
 <span data-ttu-id="37999-200">Чтобы включить автоматическое обновление книги, выполните следующую команду:</span><span class="sxs-lookup"><span data-stu-id="37999-200">To enable automatic workbook upgrade, run the following command:</span></span>  
  
```  
PS C:\Windows\system32> Set-PowerPivotSystemService -WorkbookUpgradeOnDataRefresh:$true -Confirm:$false  
```  
  
 <span data-ttu-id="37999-201">После обновления книги можно пользоваться обновлением данных по расписанию и новыми возможностями надстройки PowerPivot для Excel.</span><span class="sxs-lookup"><span data-stu-id="37999-201">After you upgrade the workbook, you can use scheduled data refresh and new features in the PowerPivot for Excel add-in.</span></span>  
  
##  <a name="running-multiple-workbook-versions-on-a-newer-server"></a><a name="bkmk_runold"></a> <span data-ttu-id="37999-202">Запуск нескольких версий книги на сервере более новых версий</span><span class="sxs-lookup"><span data-stu-id="37999-202">Running Multiple Workbook Versions on a Newer Server</span></span>  
 <span data-ttu-id="37999-203">Книги PowerPivot более старых и новых версий можно использовать одновременно на экземпляре [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)][!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="37999-203">You can run older and newer versions of PowerPivot workbooks side by side on a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] instance of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="37999-204">В зависимости от метода установки сервера **может потребоваться** установить предыдущую версию поставщика OLE DB служб Analysis Services, чтобы на одном сервере можно было открывать книги как старых, так и новых версий.</span><span class="sxs-lookup"><span data-stu-id="37999-204">Depending on how you installed the server, **you might need** to install a previous version of the Analysis Services OLE DB provider before you can access older and newer workbooks on the same server.</span></span>  
  
 <span data-ttu-id="37999-205">Обратите внимание, что не поддерживается публикация книг новой версии на предшествующих экземплярах SQL Server [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="37999-205">Note that Publishing newer version workbooks on previous SQL Server instances of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] is not supported.</span></span> <span data-ttu-id="37999-206">Экземпляр [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] не загружает книги, созданные в версии [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)][!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], а экземпляр SQL Server 2012 не будет загружать книги Office 2013 с расширенными моделями данных, созданные с использованием PowerPivot версии [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] в Excel.</span><span class="sxs-lookup"><span data-stu-id="37999-206">A [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] instance will not load a workbook that you created in the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], and a SQL Server 2012 instance will not load Office 2013 workbooks with advanced data models that you created using the [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] version of PowerPivot in Excel.</span></span>  
  
###  <a name="how-to-check-for-msolap-data-provider-information-in-a-powerpivot-workbook"></a><a name="bkmk_msolapxslx"></a><span data-ttu-id="37999-207">Проверка сведений о поставщике данных MSOLAP в книге PowerPivot</span><span class="sxs-lookup"><span data-stu-id="37999-207">How to Check for MSOLAP Data Provider Information in a PowerPivot Workbook</span></span>  
 <span data-ttu-id="37999-208">Для определения текущей версии поставщика OLE DB для книги PowerPivot выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="37999-208">Use the following instructions to check which OLE DB provider is used in a PowerPivot workbook.</span></span> <span data-ttu-id="37999-209">Для проверки сведений подключения к данным не требуется установка надстройки [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="37999-209">Checking the data connection information does not require the [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] add-in to be installed.</span></span>  
  
1.  <span data-ttu-id="37999-210">Нажмите кнопку **Соединения**на вкладке «Данные» в Excel.</span><span class="sxs-lookup"><span data-stu-id="37999-210">In Excel, on the Data tab, click **Connections**.</span></span> <span data-ttu-id="37999-211">Нажмите кнопку **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="37999-211">Click **Properties**.</span></span>  
  
2.  <span data-ttu-id="37999-212">На вкладке **Определение** в начале строки подключения отображается версия поставщика.</span><span class="sxs-lookup"><span data-stu-id="37999-212">On the **Definition** tab, the provider version appears at the beginning of the connection string.</span></span>  
  
     <span data-ttu-id="37999-213">**Provider=MSOLAP.5** указывает, что книга версии [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="37999-213">**Provider=MSOLAP.5** indicates the workbook is [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
     <span data-ttu-id="37999-214">**Provider=MSOLAP.4** указывает на версию [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="37999-214">**Provider=MSOLAP.4** indicates [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span>  
  
     <span data-ttu-id="37999-215">**Data Source = $Embedded $** указывает, что книга является книгой PowerPivot, использующей внедренную базу данных.</span><span class="sxs-lookup"><span data-stu-id="37999-215">**Data Source=$Embedded$** indicates that the workbook is a PowerPivot workbook, using an embedded database.</span></span>  
  
###  <a name="how-to-check-for-the-current-version-of-the-msolap-data-provider-on-a-local-computer"></a><a name="bkmk_msolappc"></a> <span data-ttu-id="37999-216">Проверка текущей версии поставщика данных MSOLAP на локальном компьютере</span><span class="sxs-lookup"><span data-stu-id="37999-216">How to Check for the Current Version of the MSOLAP Data Provider on a Local Computer</span></span>  
 <span data-ttu-id="37999-217">Для определения текущей версии поставщика OLE DB на сервере или рабочей станции, на которой запускаются книги PowerPivot, используйте инструкции, приведенные ниже.</span><span class="sxs-lookup"><span data-stu-id="37999-217">Use the following instructions to check which OLE DB provider is the current version on the server or workstation that runs PowerPivot workbooks.</span></span> <span data-ttu-id="37999-218">Сведения о текущей версии позволят выполнять диагностику ошибок подключений к данным после обновления.</span><span class="sxs-lookup"><span data-stu-id="37999-218">Knowing the current version can help you troubleshoot data connection errors after upgrading.</span></span>  
  
1.  <span data-ttu-id="37999-219">В редакторе реестра перейдите в раздел HKEY_CLASSES_ROOT</span><span class="sxs-lookup"><span data-stu-id="37999-219">In the Registry Editor, go to HKEY_CLASSES_ROOT</span></span>  
  
2.  <span data-ttu-id="37999-220">С помощью прокрутки перейдите в раздел MSOLAP.</span><span class="sxs-lookup"><span data-stu-id="37999-220">Scroll down to MSOLAP.</span></span> <span data-ttu-id="37999-221">Убедитесь, что в списке поставщиков OLAP, установленных в системе, указан MSOLAP.5.</span><span class="sxs-lookup"><span data-stu-id="37999-221">Verify that MSOLAP.5 is listed among the OLAP providers installed on the system.</span></span> <span data-ttu-id="37999-222">Убедитесь, что для параметра MSOLAP | CurVer задано значение MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="37999-222">Verify that MSOLAP | CurVer is set to MSOLAP.5</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37999-223">См. также:</span><span class="sxs-lookup"><span data-stu-id="37999-223">See Also</span></span>  
 <span data-ttu-id="37999-224">[Перенос PowerPivot в SharePoint 2013](migrate-power-pivot-to-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="37999-224">[Migrate PowerPivot to SharePoint 2013](migrate-power-pivot-to-sharepoint-2013.md) </span></span>  
 <span data-ttu-id="37999-225">[PowerPivot для SharePoint обновления](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="37999-225">[Upgrade PowerPivot for SharePoint](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span></span>  
 <span data-ttu-id="37999-226">[Новые возможности Analysis Services и бизнес-аналитики](../../what-s-new-in-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="37999-226">[What's New in Analysis Services and Business Intelligence](../../what-s-new-in-analysis-services.md) </span></span>  
 [<span data-ttu-id="37999-227">Просмотр журнала обновления данных &#40;PowerPivot для SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="37999-227">View Data Refresh History &#40;PowerPivot for SharePoint&#41;</span></span>](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)  
  
  
