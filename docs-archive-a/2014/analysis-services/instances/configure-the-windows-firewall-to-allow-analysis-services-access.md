---
title: Настройка брандмауэра Windows на разрешение доступа к Analysis Services | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ports [Analysis Services]
- Windows Firewall [Analysis Services]
- firewall systems [Analysis Services]
ms.assetid: 7673acc5-75f0-4703-9ce2-87425ea39d49
author: minewiskan
ms.author: owend
ms.openlocfilehash: f7d63b392148bf10a6b121dd4d201b7a7c61e0c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87731110"
---
# <a name="configure-the-windows-firewall-to-allow-analysis-services-access"></a><span data-ttu-id="fd7fe-102">Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-102">Configure the Windows Firewall to Allow Analysis Services Access</span></span>
  <span data-ttu-id="fd7fe-103">Важный первый шаг предоставления доступа к [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] или [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] по сети состоит в определении того, требуется ли разблокировать порты брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-103">An essential first step in making [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] or [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] available on the network is to determine whether you need to unblock ports in a firewall.</span></span> <span data-ttu-id="fd7fe-104">Для большинства установок необходимо создать по крайней мере одно правило брандмауэра для входящих подключений, которое разрешает подключаться к службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd7fe-104">Most installations will require that you create at least one in-bound firewall rule that allows connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="fd7fe-105">Требования к конфигурации брандмауэра зависят от того, как был установлен компонент служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd7fe-105">Firewall configuration requirements vary depending on how you installed [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="fd7fe-106">При установке экземпляра по умолчанию или создании отказоустойчивого кластера служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] откройте TCP-порт 2383.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-106">Open TCP port 2383 when installing a default instance or creating an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster.</span></span>  
  
-   <span data-ttu-id="fd7fe-107">При установке именованного экземпляра откройте TCP-порт 2382.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-107">Open TCP port 2382 when installing a named instance.</span></span> <span data-ttu-id="fd7fe-108">Именованные экземпляры используют динамическое назначение портов.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-108">Named instances use dynamic port assignments.</span></span> <span data-ttu-id="fd7fe-109">В качестве службы обнаружения для служб Analysis Services служба обозревателя SQL Server прослушивает TCP-порт 2382 и перенаправляет запрос на подключение к порту, используемому в настоящее время службами [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd7fe-109">As the discovery service for Analysis Services, SQL Server Browser service listens on TCP port 2382 and redirects the connection request to the port currently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="fd7fe-110">При установке служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в режиме интеграции с SharePoint для поддержки [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013 откройте TCP-порт 2382.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-110">Open TCP port 2382 when installing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode to support [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span></span> <span data-ttu-id="fd7fe-111">В [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013 экземпляр служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] находится за пределами SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-111">In [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance is external to SharePoint.</span></span> <span data-ttu-id="fd7fe-112">Входящие запросы к именованному экземпляру PowerPivot исходят от веб-приложений SharePoint по сетевому подключению, поэтому для них требуется открытый порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-112">Inbound requests to the named 'PowerPivot' instance originate from SharePoint web applications over a network connection, requiring an open port.</span></span> <span data-ttu-id="fd7fe-113">Как и в случае с другими именованными экземплярами служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , создайте правило для входящих подключений для службы обозревателя SQL Server на TCP-порт 2382, чтобы разрешить доступ к [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd7fe-113">As with other [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, create an inbound rule for SQL Server Browser service on TCP 2382 to allow access to [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="fd7fe-114">Для [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010 открывать порты в брандмауэре Windows не требуется.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-114">For [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, do not open ports in Windows Firewall.</span></span> <span data-ttu-id="fd7fe-115">В качестве надстройки к SharePoint служба использует порты, настроенные для SharePoint, и устанавливает только локальные соединения с экземпляром служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , который загружает модели данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] и выполняет к ним запросы.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-115">As an add-in to SharePoint, the service uses ports configured for SharePoint and makes only local connections to the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance that loads and queries [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models.</span></span>  
  
-   <span data-ttu-id="fd7fe-116">Для [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] экземпляров, работающих на виртуальных машинах Azure, используйте альтернативные инструкции по настройке доступа к серверу.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-116">For [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instances running on Azure Virtual Machines, use alternate instructions for configuring server access.</span></span> <span data-ttu-id="fd7fe-117">См. статью [SQL Server бизнес-аналитика на виртуальных машинах Azure](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-117">See [SQL Server Business Intelligence in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span></span>  
  
 <span data-ttu-id="fd7fe-118">Несмотря на то, что экземпляр по умолчанию [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] прослушивает TCP-порт 2383, можно настроить сервер на прослушивание другого фиксированного порта, подключившись к серверу в следующем формате: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-118">Although the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383, you can configure the server to listen on a different fixed port, connecting to the server in this format: \<servername>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="fd7fe-119">Экземпляр служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] может использовать только один TCP-порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-119">Only one TCP port can be used by an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="fd7fe-120">На компьютерах с несколькими сетевыми платами или несколькими IP-адресами службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] прослушивают один TCP-порт для всех IP-адресов, назначенных этому компьютеру или указанных ему с помощью псевдонима.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-120">On computers having multiple network cards or multiple IP addresses, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on one TCP port for all IP addresses assigned or aliased to the computer.</span></span> <span data-ttu-id="fd7fe-121">Если имеются особые требования в отношении нескольких портов, попробуйте настроить службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] для доступа по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-121">If you have specific multi-port requirements, consider configuring [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] for HTTP access.</span></span> <span data-ttu-id="fd7fe-122">Затем можно установить несколько конечных точек HTTP для любых портов в выбранном формате.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-122">You can then set up multiple HTTP endpoints on whatever ports you choose.</span></span> <span data-ttu-id="fd7fe-123">См. раздел [Настройка HTTP-доступа к службам Analysis Services в службах Internet Information Services (IIS) 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-123">See [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="fd7fe-124">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-124">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="fd7fe-125">Проверка параметров порта и брандмауэра для служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-125">Check port and firewall settings for Analysis Services</span></span>](#bkmk_checkport)  
  
-   [<span data-ttu-id="fd7fe-126">Настройка брандмауэра Windows для экземпляра по умолчанию Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-126">Configure Windows Firewall for a default instance of Analysis Services</span></span>](#bkmk_default)  
  
-   [<span data-ttu-id="fd7fe-127">Настройка доступа в брандмауэре Windows для именованного экземпляра служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-127">Configure Windows Firewall access for a named instance of Analysis Services</span></span>](#bkmk_named)  
  
-   [<span data-ttu-id="fd7fe-128">Настройка порта для кластера служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-128">Port configuration for an Analysis Services cluster</span></span>](#bkmk_cluster)  
  
-   [<span data-ttu-id="fd7fe-129">Настройка порта PowerPivot для SharePoint</span><span class="sxs-lookup"><span data-stu-id="fd7fe-129">Port configuration for PowerPivot for SharePoint</span></span>](#bkmk_powerpivot)  
  
-   [<span data-ttu-id="fd7fe-130">Использовать фиксированный порт для именованного экземпляра или экземпляра по умолчанию служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-130">Use a fixed port for a default or named instance of Analysis Services</span></span>](#bkmk_fixed)  
  
 <span data-ttu-id="fd7fe-131">Дополнительные сведения о настройках брандмауэра Windows по умолчанию и описание портов TCP, влияющих на компонент Database Engine, службы Analysis Services, службы Reporting Services и службы Integration Services, см. в разделе [Настройка брандмауэра Windows для разрешения доступа к SQL Server](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-131">For more information about the default Windows firewall settings, and a description of the TCP ports that affect the Database Engine, Analysis Services, Reporting Services, and Integration Services, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span></span>  
  
##  <a name="check-port-and-firewall-settings-for-analysis-services"></a><a name="bkmk_checkport"></a><span data-ttu-id="fd7fe-132">Проверьте параметры порта и брандмауэра для Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-132">Check port and firewall settings for Analysis Services</span></span>  
 <span data-ttu-id="fd7fe-133">В операционных системах Microsoft Windows, поддерживаемых [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], брандмауэр Windows включен по умолчанию и блокирует удаленные соединения.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-133">On the Microsoft Windows operating systems that are supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], Windows Firewall is on by default and is blocking remote connections.</span></span> <span data-ttu-id="fd7fe-134">Чтобы разрешить входящие запросы к службам Analysis Services, необходимо вручную открыть порт в брандмауэре.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-134">You must manually open a port in the firewall to allow inbound requests to Analysis Services.</span></span> <span data-ttu-id="fd7fe-135">Программа установки SQL Server не выполняет этот шаг автоматически.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-135">SQL Server Setup does not perform this step for you.</span></span>  
  
 <span data-ttu-id="fd7fe-136">Параметры порта указываются в файле msmdsrv.ini и на странице свойств «Общие» экземпляра служб Analysis Services в среде SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-136">Port settings are specified in the msmdsrv.ini file and in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span> <span data-ttu-id="fd7fe-137">Если для `Port` установлено положительное целочисленное значение, служба прослушивает фиксированный порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-137">If `Port` is set to a positive integer, the service is listening on a fixed port.</span></span> <span data-ttu-id="fd7fe-138">Если для `Port` установлено значение 0, служба прослушивает порт 2383, если это экземпляр по умолчанию, или динамически назначенный порт, если это именованный экземпляр.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-138">If `Port` is set to 0, the service is listening on port 2383 if it is the default instance or on a dynamically assigned port if it is a named instance.</span></span>  
  
 <span data-ttu-id="fd7fe-139">Динамические назначения портов используются только именованными экземплярами.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-139">Dynamic port assignments are only used by named instances.</span></span> <span data-ttu-id="fd7fe-140">При запуске службы `MSOLAP$InstanceName` определяется, какой порт следует использовать.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-140">The `MSOLAP$InstanceName` service determines which port to use when it starts up.</span></span> <span data-ttu-id="fd7fe-141">Можно определить действительный номер порта, используемый именованным экземпляром, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-141">You can determine the actual port number in use by a named instance by doing the following:</span></span>  
  
-   <span data-ttu-id="fd7fe-142">Запустите диспетчер задач и щелкните **службы** , чтобы получить идентификатор процесса `MSOLAP$InstanceName` .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-142">Start Task Manager and then click **Services** to get the PID of the `MSOLAP$InstanceName`.</span></span>  
  
-   <span data-ttu-id="fd7fe-143">Запустите `netstat -ao -p TCP` из командной строки, чтобы просмотреть сведения TCP-порта для этого идентификатора PID.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-143">Run `netstat -ao -p TCP` from the command line to view the TCP port information for that PID.</span></span>  
  
-   <span data-ttu-id="fd7fe-144">Проверьте порт с помощью SQL Server Management Studio и подключитесь к серверу Analysis Services в следующем формате: \<IPAddress> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-144">Verify the port by using SQL Server Management Studio and connect to an Analysis Services server in this format: \<IPAddress>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="fd7fe-145">Хотя приложение может прослушивать указанный порт, подключения будут неудачными, если брандмауэр блокирует доступ.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-145">Although an application might be listening on a specific port, connections will not succeed if a firewall is blocking access.</span></span> <span data-ttu-id="fd7fe-146">Для подключений к экземпляру служб Analysis Services необходимо разблокировать доступ к файлу msmdsrv.exe или фиксированному порту в брандмауэре, по которому ведется прослушивание.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-146">In order for connections to reach a named Analysis Services instance, you must unblock access to either msmdsrv.exe or the fixed port on which it is listening in the firewall.</span></span> <span data-ttu-id="fd7fe-147">Остальные подразделы в этом разделе содержат соответствующие инструкции.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-147">The remaining sections in this topic provide instructions for doing so.</span></span>  
  
 <span data-ttu-id="fd7fe-148">Чтобы выяснить, были ли параметры брандмауэра для служб Analysis Services определены ранее, используйте брандмауэр Windows в режиме повышенной безопасности на панели управления.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-148">To check whether firewall settings are already defined for Analysis Services, use Windows Firewall with Advanced Security in Control Panel.</span></span> <span data-ttu-id="fd7fe-149">На странице «Брандмауэр» в папке «Мониторинг» показан полный список правил, определенный для локального сервера.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-149">The Firewall page in the Monitoring folder shows a complete list of the rules defined for the local server.</span></span>  
  
 <span data-ttu-id="fd7fe-150">Обратите внимание, что для служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]все правила брандмауэра необходимо задавать вручную.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-150">Note that for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], all firewall rules must be manually defined.</span></span> <span data-ttu-id="fd7fe-151">Хотя службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] и обозреватель SQL Server резервируют порты 2382 и 2383, ни программа установки SQL Server, ни одно из средств настройки не определяет правила брандмауэра, которые разрешают доступ к портам или исполняемым файлам программы.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-151">Although [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and SQL Server Browser reserve ports 2382 and 2383, neither the SQL Server setup program nor any of the configuration tools define firewall rules that allow access to either the ports or the program executable files.</span></span>  
  
##  <a name="configure-windows-firewall-for-a-default-instance-of-analysis-services"></a><a name="bkmk_default"></a> <span data-ttu-id="fd7fe-152">Настройка брандмауэра Windows для экземпляра по умолчанию служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-152">Configure Windows Firewall for a default instance of Analysis Services</span></span>  
 <span data-ttu-id="fd7fe-153">Экземпляр служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] по умолчанию прослушивает TCP-порт 2383.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-153">The default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383.</span></span> <span data-ttu-id="fd7fe-154">Если установлен экземпляр по умолчанию и требуется использовать этот порт, то необходимо лишь разблокировать входящий доступ к TCP-порту 2383 в брандмауэре Windows, чтобы разрешить удаленный доступ к экземпляру по умолчанию служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd7fe-154">If you installed the default instance and want to use this port, you only need to unblock inbound access to TCP port 2383 in Windows Firewall to enable remote access to the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="fd7fe-155">Если установлен экземпляр по умолчанию и необходимо настроить службу для прослушивания фиксированного порта, см. подраздел [Использовать фиксированный порт для именованного экземпляра или экземпляра по умолчанию служб Analysis Services](#bkmk_fixed) в данном разделе.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-155">If you installed the default instance but want to configure the service to listen on a fixed port, see [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic.</span></span>  
  
 <span data-ttu-id="fd7fe-156">Чтобы определить, выполняется ли служба как экземпляр по умолчанию (MSSQLServerOLAPService), проверьте имя службы в диспетчере конфигурации SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-156">To verify whether the service is running as the default instance (MSSQLServerOLAPService), check the service name in SQL Server Configuration Manager.</span></span> <span data-ttu-id="fd7fe-157">Экземпляр служб Analysis Services по умолчанию всегда указывается как **Службы SQL Server Analysis Services (MSSQLSERVER)**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-157">A default instance of Analysis Services is always listed as **SQL Server Analysis Services (MSSQLSERVER)**.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fd7fe-158">В различных операционных системах Windows имеются различные средства для настройки брандмауэра Windows.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-158">Different Windows operating systems provide alternative tools for configuring Windows Firewall.</span></span> <span data-ttu-id="fd7fe-159">В большинстве из этих средств можно выбирать между открытием определенного порта или исполняемого файла программы.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-159">Most of these tools let you choose between opening a specific port or program executable.</span></span> <span data-ttu-id="fd7fe-160">Если нет особой причины указать исполняемый файл программы, рекомендуется указать порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-160">Unless you have a reason for specifying the program executable, we recommend that you specify the port.</span></span>  
  
 <span data-ttu-id="fd7fe-161">При указании правила входящего подключения следует применять соглашение об именах, с помощью которого можно будет без труда находить правила впоследствии (например, **службы SQL Server Analysis Services (TCP-in) 2383**).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-161">When specifying an inbound rule, be sure to adopt a naming convention that allows you to easily find the rules later (for example, **SQL Server Analysis Services (TCP-in) 2383**).</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="fd7fe-162">Брандмауэр Windows в режиме повышенной безопасности</span><span class="sxs-lookup"><span data-stu-id="fd7fe-162">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="fd7fe-163">В Windows 7 или в Windows Vista на панели управления выберите раздел **Система и безопасность**, затем **Брандмауэр Windows**и **Расширенные параметры**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-163">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="fd7fe-164">В Windows Server 2008 и в Windows Server 2008 R2 откройте меню "Администрирование" и выберите пункт **Брандмауэр Windows в режиме повышенной безопасности**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-164">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="fd7fe-165">В Windows Server 2012 откройте страницу "Приложения" и введите **Брандмауэр Windows**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-165">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="fd7fe-166">Щелкните правой кнопкой мыши **Правила для входящих подключений** и выберите **Создать правило**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-166">Right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="fd7fe-167">В списке Тип правила выберите `Port` и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-167">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="fd7fe-168">В окне Протокол и порты выберите **TCP** , а затем `2383` введите **определенные локальные порты**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-168">In Protocol and Ports, select **TCP** and then type `2383` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="fd7fe-169">В поле "Действие" выберите значение **Разрешить соединение** и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-169">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="fd7fe-170">В поле "Профиль" уберите все сетевые расположения, не применимые к текущему развертыванию, и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-170">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="fd7fe-171">В списке Имя введите описательное имя для этого правила (например, `SQL Server Analysis Services (tcp-in) 2383` ), а затем нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-171">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services (tcp-in) 2383`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="fd7fe-172">Чтобы проверить, разрешены ли удаленные соединения, откройте среду SQL Server Management Studio или Excel на другом компьютере и подключитесь к службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , указав сетевое имя сервера в поле **Имя сервера**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-172">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] by specifying the network name of the server in **Server name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fd7fe-173">Другие пользователи не будут иметь доступа к этому серверу, пока им не будут предоставлены разрешения.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-173">Other users will not have access to this server until you grant permissions.</span></span> <span data-ttu-id="fd7fe-174">Дополнительные сведения см. в разделе [Предоставление доступа к объектам и операциям (Analysis Services)](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-174">For more information, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="fd7fe-175">Синтаксис Netsh AdvFirewall</span><span class="sxs-lookup"><span data-stu-id="fd7fe-175">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="fd7fe-176">Следующая команда создает правило входящего подключения, которое разрешает входящие запросы для порта TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-176">The following command creates an inbound rule that allows incoming requests on TCP port 2383.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services inbound on TCP 2383" dir=in action=allow protocol=TCP localport=2383 profile=domain  
    ```  
  
##  <a name="configure-windows-firewall-access-for-a-named-instance-of-analysis-services"></a><a name="bkmk_named"></a><span data-ttu-id="fd7fe-177">Настройка доступа к брандмауэру Windows для именованного экземпляра Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-177">Configure Windows Firewall access for a named instance of Analysis Services</span></span>  
 <span data-ttu-id="fd7fe-178">Именованные экземпляры служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] могут прослушивать либо указанный фиксированный порт, либо динамически назначаемый порт, при этом служба обозревателя SQL Server предоставляет сведения о соединении, используемом службой на момент соединения.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-178">Named instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can either listen on a fixed port or on a dynamically assigned port, where SQL Server Browser service provides the connection information that is current for the service at the time of the connection.</span></span>  
  
 <span data-ttu-id="fd7fe-179">Служба обозревателя SQL Server прослушивает TCP-порт 2382.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-179">SQL Server Browser service listens on TCP port 2382.</span></span> <span data-ttu-id="fd7fe-180">Протокол UDP не используется.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-180">UDP is not used.</span></span> <span data-ttu-id="fd7fe-181">TCP — единственный протокол передачи, используемый службами [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd7fe-181">TCP is the only transmission protocol used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="fd7fe-182">Чтобы разрешить удаленный доступ к именованному экземпляру служб Analysis Services, выберите один из следующих методов:</span><span class="sxs-lookup"><span data-stu-id="fd7fe-182">Choose one of the following approaches to enable remote access to a named instance of Analysis Services:</span></span>  
  
-   <span data-ttu-id="fd7fe-183">Используйте динамическое назначение порта и службу обозревателя SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-183">Use dynamic port assignments and SQL Server Browser service.</span></span> <span data-ttu-id="fd7fe-184">Разблокируйте порт, используемый службой обозревателя SQL Server, в брандмауэре Windows.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-184">Unblock the port used by SQL Server Browser service in Windows Firewall.</span></span> <span data-ttu-id="fd7fe-185">Подключитесь к серверу в следующем формате: \<servername> \\<instanceName \> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-185">Connect to the server in this format: \<servername>\\<instancename\>.</span></span>  
  
-   <span data-ttu-id="fd7fe-186">Используйте совместно фиксированный порт и службу обозревателя SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-186">Use a fixed port and SQL Server Browser service together.</span></span> <span data-ttu-id="fd7fe-187">Такой подход позволяет подключаться с использованием этого формата: \<servername> \\<instanceName \> , идентичный принципу назначения динамического порта, за исключением того, что в данном случае сервер прослушивает фиксированный порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-187">This approach lets you connect using this format: \<servername>\\<instancename\>, identical to the dynamic port assignment approach, except that in this case the server listens on a fixed port.</span></span> <span data-ttu-id="fd7fe-188">В этом варианте служба обозревателя SQL Server обеспечивает разрешение имен для экземпляра служб Analysis Services, прослушивающего фиксированный порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-188">In this scenario, SQL Server Browser Service provides name resolution to the Analysis Services instance listening on the fixed port.</span></span> <span data-ttu-id="fd7fe-189">Для использования этого метода настройте сервер на прослушивание фиксированного порта, разблокируйте доступ к этому порту и разблокируйте доступ к порту, используемому службой обозревателя SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-189">To use this approach, configure the server to listen on a fixed port, unblock access to that port, and unblock access to the port used by SQL Server Browser service.</span></span>  
  
 <span data-ttu-id="fd7fe-190">Служба обозревателя SQL Server используется только с именованными экземплярами, с экземпляром по умолчанию она не используется никогда.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-190">SQL Server Browser service is only used with named instances, never with the default instance.</span></span> <span data-ttu-id="fd7fe-191">Эта служба автоматически устанавливается и включается при установке любого компонента SQL Server в качестве именованного экземпляра.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-191">The service is automatically installed and enabled whenever you install any SQL Server feature as a named instance.</span></span> <span data-ttu-id="fd7fe-192">Если выбран метод, для которого требуется служба обозревателя SQL Server, необходимо следить за тем, чтобы она оставалась включенной и запускалась на сервере.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-192">If you choose an approach that requires SQL Server Browser service, be sure it remains enabled and started on your server.</span></span>  
  
 <span data-ttu-id="fd7fe-193">Если использовать службу обозревателя SQL Server невозможно, необходимо назначить фиксированный порт в строке подключения, минуя разрешение имени домена.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-193">If you cannot use SQL Server Browser service, you must assign a fixed port in the connection string, bypassing domain name resolution.</span></span> <span data-ttu-id="fd7fe-194">Если служба обозревателя SQL Server не используется, то в строке подключения всех клиентских соединений должен указываться номер порта (например, AW-SRV01:54321).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-194">Without SQL Server Browser service, all client connections must include the port number on the connection string (for example, AW-SRV01:54321).</span></span>  
  
 <span data-ttu-id="fd7fe-195">**Вариант 1: используйте динамическое назначение порта и разблокируйте доступ к службе браузера SQL Server.**</span><span class="sxs-lookup"><span data-stu-id="fd7fe-195">**Option 1: Use dynamic port assignments and unblock access to SQL Server Browser service**</span></span>  
  
 <span data-ttu-id="fd7fe-196">Динамическое назначение портов для именованных экземпляров служб Analysis Services выполняется с помощью `MSOLAP$InstanceName` при запуске службы.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-196">Dynamic port assignments for named instances of Analysis Services are established by the `MSOLAP$InstanceName` when the service starts.</span></span> <span data-ttu-id="fd7fe-197">По умолчанию служба требует первый обнаруженный доступный номер порта, используя различные номера портов при каждом перезапуске службы.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-197">By default, the service claims the first available port number that it finds, using a different port number each time the service is restarted.</span></span>  
  
 <span data-ttu-id="fd7fe-198">Разрешение имени экземпляра обеспечивается службой обозревателя SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-198">Instance name resolution is handled by the SQL Server browser service.</span></span> <span data-ttu-id="fd7fe-199">Разблокирование TCP-порта 2382 для службы обозревателя SQL Server всегда необходимо, если для именованного экземпляра используется динамическое назначение порта.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-199">Unblocking TCP port 2382 for SQL Server Browser service is always required if you are using dynamic port assignments with a named instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fd7fe-200">Служба обозревателя SQL Server прослушивает как порт UDP 1434, так и порт TCP 2382 для компонента Database Engine и служб Analysis Services соответственно.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-200">SQL Server Browser service listens on both UDP port 1434 and TCP port 2382 for the Database Engine and Analysis Services, respectively.</span></span> <span data-ttu-id="fd7fe-201">Даже если порт UDP 1434 уже разблокирован для службы обозревателя SQL Server, необходимо разблокировать порт TCP 2382 для служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-201">Even if you already unblocked UDP port 1434 for the SQL Server Browser service, you must still unblock TCP port 2382 for Analysis Services.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="fd7fe-202">Брандмауэр Windows в режиме повышенной безопасности</span><span class="sxs-lookup"><span data-stu-id="fd7fe-202">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="fd7fe-203">В Windows 7 или в Windows Vista на панели управления выберите раздел **Система и безопасность**, затем **Брандмауэр Windows**и **Расширенные параметры**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-203">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="fd7fe-204">В Windows Server 2008 и в Windows Server 2008 R2 откройте меню "Администрирование" и выберите пункт **Брандмауэр Windows в режиме повышенной безопасности**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-204">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="fd7fe-205">В Windows Server 2012 откройте страницу "Приложения" и введите **Брандмауэр Windows**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-205">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="fd7fe-206">Чтобы разблокировать доступ к службе обозревателя SQL Server, щелкните правой кнопкой мыши **Правила для входящих подключений** и выберите **Создать правило**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-206">To unblock access to SQL Server Browser service, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="fd7fe-207">В списке Тип правила выберите `Port` и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-207">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="fd7fe-208">В окне Протокол и порты выберите **TCP** , а затем `2382` введите **определенные локальные порты**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-208">In Protocol and Ports, select **TCP** and then type `2382` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="fd7fe-209">В поле "Действие" выберите значение **Разрешить соединение** и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-209">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="fd7fe-210">В поле "Профиль" уберите все сетевые расположения, не применимые к текущему развертыванию, и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-210">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="fd7fe-211">В списке Имя введите описательное имя для этого правила (например, `SQL Server Browser Service (tcp-in) 2382` ), а затем нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-211">In Name, type a descriptive name for this rule (for example, `SQL Server Browser Service (tcp-in) 2382`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="fd7fe-212">Чтобы убедиться, что удаленные подключения включены, откройте SQL Server Management Studio или Excel на другом компьютере и подключитесь к Analysis Services, указав сетевое имя сервера и имя экземпляра в следующем формате: \<servername> \\<имя_экземпляра \> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-212">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the instance name in this format: \<servername>\\<instancename\>.</span></span> <span data-ttu-id="fd7fe-213">Например, на сервере с именем **AW-SRV01** и именованным экземпляром **Finance**именем сервера будет **AW-SRV01\Finance**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-213">For example, on a server named **AW-SRV01** with a named instance of **Finance**, the server name is **AW-SRV01\Finance**.</span></span>  
  
 <span data-ttu-id="fd7fe-214">**Вариант 2: используйте фиксированный порт для именованного экземпляра.**</span><span class="sxs-lookup"><span data-stu-id="fd7fe-214">**Option 2: Use a fixed port for a named instance**</span></span>  
  
 <span data-ttu-id="fd7fe-215">В качестве альтернативы можно назначить фиксированный порт, а затем разблокировать доступ к этому порту.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-215">Alternatively, you can assign a fixed port, and then unblock access to that port.</span></span> <span data-ttu-id="fd7fe-216">Этот метод обеспечивает лучшие возможности аудита, чем те, которые доступны при разрешении доступа к исполняемому файлу программы.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-216">This approach offers better auditing capability than if you allowed access to the program executable.</span></span> <span data-ttu-id="fd7fe-217">По этой причине использование фиксированного порта — рекомендуемый метод для доступа к любому экземпляру служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-217">For this reason, using a fixed port is the recommended approach for accessing any Analysis Services instance.</span></span>  
  
 <span data-ttu-id="fd7fe-218">Чтобы назначить фиксированный порт, следуйте инструкциям в подразделе [Использовать фиксированный порт для именованного экземпляра или экземпляра по умолчанию служб Analysis Services](#bkmk_fixed) этого раздела, затем вернитесь к этому подразделу, чтобы разблокировать порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-218">To assign a fixed port, follow the instructions in [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic, then return to this section to unblock the port.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="fd7fe-219">Брандмауэр Windows в режиме повышенной безопасности</span><span class="sxs-lookup"><span data-stu-id="fd7fe-219">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="fd7fe-220">В Windows 7 или в Windows Vista на панели управления выберите раздел **Система и безопасность**, затем **Брандмауэр Windows**и **Расширенные параметры**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-220">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="fd7fe-221">В Windows Server 2008 и в Windows Server 2008 R2 откройте меню "Администрирование" и выберите пункт **Брандмауэр Windows в режиме повышенной безопасности**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-221">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="fd7fe-222">В Windows Server 2012 откройте страницу "Приложения" и введите **Брандмауэр Windows**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-222">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="fd7fe-223">Чтобы разблокировать доступ к службам Analysis Services, щелкните правой кнопкой мыши **Правила для входящих подключений** и выберите **Создать правило**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-223">To unblock access to Analysis Services, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="fd7fe-224">В списке Тип правила выберите `Port` и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-224">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="fd7fe-225">В диалоговом окне "Протокол и порты" выберите протокол **TCP** и введите фиксированный порт в поле **Определенные локальные порты**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-225">In Protocol and Ports, select **TCP** and then type the fixed port in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="fd7fe-226">В поле "Действие" выберите значение **Разрешить соединение** и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-226">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="fd7fe-227">В поле "Профиль" уберите все сетевые расположения, не применимые к текущему развертыванию, и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-227">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="fd7fe-228">В списке Имя введите описательное имя для этого правила (например, `SQL Server Analysis Services on port 54321` ), а затем нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-228">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services on port 54321`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="fd7fe-229">Чтобы убедиться, что удаленные подключения включены, откройте SQL Server Management Studio или Excel на другом компьютере и подключитесь к Analysis Services, указав сетевое имя сервера и номер порта в следующем формате: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-229">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the port number in this format: \<servername>:\<portnumber>.</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="fd7fe-230">Синтаксис Netsh AdvFirewall</span><span class="sxs-lookup"><span data-stu-id="fd7fe-230">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="fd7fe-231">Следующие команды создают правила для входящих подключений, которые разблокируют TCP-порт 2382 для службы обозревателя SQL Server и фиксированный порт, указанный для экземпляра служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-231">The following commands create inbound rules that unblock TCP 2382 for SQL Server Browser service and unblock the fixed port that you specified for the Analysis Services instance.</span></span> <span data-ttu-id="fd7fe-232">Можно выполнить любую из этих команд, чтобы разрешить доступ к именованному экземпляру служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-232">You can run either one to allow access to a named Analysis Services instance.</span></span>  
  
     <span data-ttu-id="fd7fe-233">В этом образце команды порт 54321 фиксированный.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-233">In this sample command, port 54321 is the fixed port.</span></span> <span data-ttu-id="fd7fe-234">Обязательно замените его на действительный порт, используемый в вашей системе.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-234">Be sure to replace it with the actual port in use on your system.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services (tcp-in) on 54321" dir=in action=allow protocol=TCP localport=54321 profile=domain  
    ```  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Browser Services inbound on TCP 2382" dir=in action=allow protocol=TCP localport=2382 profile=domain  
    ```  
  
##  <a name="use-a-fixed-port-for-a-default-or-named-instance-of-analysis-services"></a><a name="bkmk_fixed"></a><span data-ttu-id="fd7fe-235">Использовать фиксированный порт для именованного экземпляра по умолчанию или Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-235">Use a fixed port for a default or named instance of Analysis Services</span></span>  
 <span data-ttu-id="fd7fe-236">В этом разделе объясняется, как настроить службы Analysis Services для прослушивания фиксированного порта.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-236">This section explains how to configure Analysis Services to listen on a fixed port.</span></span> <span data-ttu-id="fd7fe-237">Фиксированный порт обычно используется, если службы Analysis Services установлены как именованный экземпляр, но к этому методу можно также прибегнуть, если требования бизнеса или безопасности указывают, что не следует использовать порты по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-237">Using a fixed port is common if you installed Analysis Services as a named instance, but you can also use this approach if business or security requirements specify that you use non-default port assignments.</span></span>  
  
 <span data-ttu-id="fd7fe-238">Обратите внимание, что при использовании фиксированного порта изменяется синтаксис соединения для экземпляра по умолчанию: необходимо добавить номер порта к имени сервера.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-238">Note that using a fixed port will alter the connection syntax for the default instance by requiring you to append the port number to the server name.</span></span> <span data-ttu-id="fd7fe-239">Например, при подключении к локальному, используемому по умолчанию экземпляру служб Analysis Services, прослушивающему порт 54321 в среде SQL Server Management Studio, потребуется ввести «localhost:54321» в качестве имени сервера в диалоговом окне «Соединение с сервером» в среде Management Studio.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-239">For example, connecting to a local, default Analysis Services instance listening on port 54321 in SQL Server Management Studio would require that you type localhost:54321 as the server name in the Connect to Server dialog box in Management Studio.</span></span>  
  
 <span data-ttu-id="fd7fe-240">При использовании именованного экземпляра можно назначить фиксированный порт без изменений, указав имя сервера (в частности, можно использовать \<servername\instancename> для подключения к именованному экземпляру, который прослушивает фиксированный порт).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-240">If you are using a named instance, you can assign a fixed port with no changes to how you specify the server name (specifically, you can use \<servername\instancename> to connect to a named instance listening on a fixed port).</span></span> <span data-ttu-id="fd7fe-241">Это применимо, только если служба обозревателя SQL Server работает, а порт, который она прослушивает, разблокирован.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-241">This works only if SQL Server Browser service is running and you unblocked the port on which it is listening.</span></span> <span data-ttu-id="fd7fe-242">Обозреватель SQL Server служба будет предоставлять перенаправление на фиксированный порт на основе \<servername\instancename> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-242">SQL Server Browser service will provide redirection to the fixed port based on \<servername\instancename>.</span></span> <span data-ttu-id="fd7fe-243">Если открыты порты как для службы обозревателя SQL Server, так и для именованного экземпляра Analysis Services, прослушивающего фиксированный порт, служба обозревателя SQL Server разрешит соединение с именованным экземпляром.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-243">As long as you open ports for both SQL Server Browser service and the named instance of Analysis Services listening on the fixed port, SQL Server Browser service will resolve the connection to a named instance.</span></span>  
  
1.  <span data-ttu-id="fd7fe-244">Определите доступный порт TCP/IP, который можно использовать.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-244">Determine an available TCP/IP port to use.</span></span>  
  
     <span data-ttu-id="fd7fe-245">Список зарезервированных и зарегистрированных портов, которые не следует использовать, см. в разделе [Номера портов (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-245">To view a list of reserved and registered ports that you should avoid using, see [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span></span> <span data-ttu-id="fd7fe-246">Для просмотра списка TCP-портов, которые уже используются в системе, откройте окно командной строки и введите `netstat -a -p TCP`.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-246">To view a list of ports that are already in use on your system, open a command prompt window and type `netstat -a -p TCP` to display a list of the TCP ports that are open on the system.</span></span>  
  
2.  <span data-ttu-id="fd7fe-247">После выбора порта укажите его, изменив настройку конфигурации `Port` в файле msmdsrv.ini. Указать порт можно также на странице «Общие свойства» экземпляра служб Analysis Services в среде SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-247">After you determine which port to use, specify the port by either editing the `Port` configuration setting in the msmdsrv.ini file or in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span>  
  
3.  <span data-ttu-id="fd7fe-248">Перезапустите службу.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-248">Restart the service.</span></span>  
  
4.  <span data-ttu-id="fd7fe-249">Настройте в брандмауэре Windows разблокировку выбранного порта TCP.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-249">Configure Windows Firewall to unblock the TCP port you specified.</span></span> <span data-ttu-id="fd7fe-250">Или, если для именованного экземпляра используется фиксированный порт, разблокируйте TCP-порт, указанный для этого экземпляра, и TCP-порт 2382 для службы обозревателя SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-250">Or, if you are using a fixed port for a named instance, unblock both the TCP port you specified for that instance and TCP port 2382 for SQL Server Browser service.</span></span>  
  
5.  <span data-ttu-id="fd7fe-251">Выполните проверку, подключившись локально (в среде Management Studio), а затем удаленно из клиентского приложения на другом компьютере.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-251">Verify by connecting locally (in Management Studio) and then remotely from a client application on another computer.</span></span> <span data-ttu-id="fd7fe-252">Чтобы использовать Management Studio, подключитесь к экземпляру Analysis Services по умолчанию, указав имя сервера в следующем формате: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-252">To use Management Studio, connect to an Analysis Services default instance by specifying a server name in this format: \<servername>:\<portnumber>.</span></span> <span data-ttu-id="fd7fe-253">Для именованного экземпляра укажите имя сервера в виде \<servername> \\<instanceName \> .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-253">For a named instance, specify the server name as \<servername>\\<instancename\>.</span></span>  
  
##  <a name="port-configuration-for-an-analysis-services-cluster"></a><a name="bkmk_cluster"></a><span data-ttu-id="fd7fe-254">Настройка порта для кластера Analysis Services</span><span class="sxs-lookup"><span data-stu-id="fd7fe-254">Port configuration for an Analysis Services cluster</span></span>  
 <span data-ttu-id="fd7fe-255">Отказоустойчивый кластер служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] всегда прослушивает TCP-порт 2383 независимо от того, установлен ли он как экземпляр по умолчанию или именованный экземпляр.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-255">An [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster always listens on TCP port 2383, regardless of whether you installed it as a default instance or named instance.</span></span> <span data-ttu-id="fd7fe-256">После установки в отказоустойчивый кластер Windows службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] не используют динамическое назначение портов.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-256">Dynamic port assignments are not used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] when it is installed on a Windows failover cluster.</span></span> <span data-ttu-id="fd7fe-257">Необходимо открыть TCP-порт 2383 на каждом узле кластера, на котором работают службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fd7fe-257">Be sure to open TCP 2383 on every node running [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in the cluster.</span></span> <span data-ttu-id="fd7fe-258">Дополнительные сведения о кластеризации служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]см. в разделе [Кластеризация служб SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-258">For more information about clustering [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span></span>  
  
##  <a name="port-configuration-for-powerpivot-for-sharepoint"></a><a name="bkmk_powerpivot"></a><span data-ttu-id="fd7fe-259">Конфигурация порта для PowerPivot для SharePoint</span><span class="sxs-lookup"><span data-stu-id="fd7fe-259">Port configuration for PowerPivot for SharePoint</span></span>  
 <span data-ttu-id="fd7fe-260">Архитектура сервера для [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] существенно различается в зависимости от используемой версии SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-260">Server architecture for [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is fundamentally different depending on which version of SharePoint you are using.</span></span>  
  
 <span data-ttu-id="fd7fe-261">**SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="fd7fe-261">**SharePoint 2013**</span></span>  
  
 <span data-ttu-id="fd7fe-262">В SharePoint 2013 службы Excel перенаправляют запросы к модели данных Power Pivot, которые будут загружены в экземпляр служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] за пределами среды SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-262">In SharePoint 2013, Excel Services redirects requests for Power Pivot data models, which are subsequently loaded on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance outside of the SharePoint environment.</span></span> <span data-ttu-id="fd7fe-263">Соединения устанавливаются стандартным образом, когда клиентская библиотека служб Analysis Services на локальном компьютере отправляет запрос удаленному экземпляру служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в той же сети.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-263">Connections follow the typical pattern, where an Analysis Services client library on a local computer sends a connection request to a remote [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in the same network.</span></span>  
  
 <span data-ttu-id="fd7fe-264">Так как [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] всегда устанавливает службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] как именованный экземпляр, необходимо помнить о наличии службы обозревателя SQL Server и использовании динамического назначения портов.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-264">Because [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] always installs [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] as a named instance, you should assume SQL Server Browser service and dynamic port assignments.</span></span> <span data-ttu-id="fd7fe-265">Как упоминалось ранее, служба обозревателя SQL Server прослушивает TCP-порт 2382 для определения запросов на подключение, отправляемых к именованным экземплярам служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , и перенаправляет их на текущий порт.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-265">As noted earlier, SQL Server Browser service listens on TCP port 2382 for connection requests sent to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, redirecting the request to the current port.</span></span>  
  
 <span data-ttu-id="fd7fe-266">Обратите внимание, что службы Excel в SharePoint 2013 не поддерживают синтаксис соединения с фиксированным портом, поэтому удостоверьтесь в том, что служба обозревателя SQL Server доступна.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-266">Note that Excel Services in SharePoint 2013 does not support the fixed port connection syntax, so make sure SQL Server Browser service is accessible.</span></span>  
  
 <span data-ttu-id="fd7fe-267">**SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="fd7fe-267">**SharePoint 2010**</span></span>  
  
 <span data-ttu-id="fd7fe-268">При использовании SharePoint 2010 открывать порты в брандмауэре Windows не нужно.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-268">If you are using SharePoint 2010, you do not need to open ports in Windows Firewall.</span></span> <span data-ttu-id="fd7fe-269">SharePoint открывает необходимые порты, а такие надстройки, как PowerPivot для SharePoint, работают в пределах среды SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-269">SharePoint opens the ports that it requires, and add-ins such as PowerPivot for SharePoint operate within the SharePoint environment.</span></span> <span data-ttu-id="fd7fe-270">В установке PowerPivot для SharePoint 2010 системная служба PowerPivot имеет монопольное право на использование локального экземпляра обозревателя служб SQL Server Analysis Services (PowerPivot), установленного на том же компьютере.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-270">In a PowerPivot for SharePoint 2010 installation, the PowerPivot System Service has exclusive use of the local SQL Server Analysis Services (PowerPivot) service instance that is installed with it on the same computer.</span></span> <span data-ttu-id="fd7fe-271">Используются локальные, но не сетевые подключения для доступа к локальным службам Analysis Services, которые загружают, выполняют запросы и обрабатывают данные PowerPivot на сервере SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-271">It uses local connections, not network connections, to access the local Analysis Services engine service that loads, queries, and processes PowerPivot data on the SharePoint server.</span></span> <span data-ttu-id="fd7fe-272">Для запроса данных PowerPivot от клиентских приложений запросы направляются через порты, открытые программой установки SharePoint (в частности, правила для входящих подключений определяются для разрешения доступа к SharePoint — 80, центру администрирования SharePoint V4, веб-службам SharePoint и SPUserCodeV4).</span><span class="sxs-lookup"><span data-stu-id="fd7fe-272">To request PowerPivot data from client applications, requests are routed through ports that are opened by SharePoint Setup (specifically, inbound rules are defined to allow access to SharePoint - 80, SharePoint Central Administration v4, SharePoint Web Services, and SPUserCodeV4).</span></span> <span data-ttu-id="fd7fe-273">Веб-службы PowerPivot выполняются в пределах фермы SharePoint, поэтому правил брандмауэра SharePoint достаточно для удаленного доступа к данным PowerPivot в ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="fd7fe-273">Because PowerPivot web services run within a SharePoint farm, the SharePoint firewall rules are sufficient for remote access to PowerPivot data in a SharePoint farm.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fd7fe-274">См. также:</span><span class="sxs-lookup"><span data-stu-id="fd7fe-274">See Also</span></span>  
 <span data-ttu-id="fd7fe-275">[Обозреватель SQL Server службы &#40;ядро СУБД и SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="fd7fe-275">[SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span></span>  
 <span data-ttu-id="fd7fe-276">[Запуск, остановка, приостановка, возобновление и перезапуск ядра СУБД, агента SQL Server и обозревателя SQL Server](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span><span class="sxs-lookup"><span data-stu-id="fd7fe-276">[Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span></span>  
 [<span data-ttu-id="fd7fe-277">Настройка брандмауэра Windows для доступа к компоненту Database Engine</span><span class="sxs-lookup"><span data-stu-id="fd7fe-277">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
  
