---
title: Операции с журналом в Analysis Services | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: aa1db060-95dc-4198-8aeb-cffdda44b140
author: minewiskan
ms.author: owend
ms.openlocfilehash: 95d0e41576e449ab10b243ef49cbe283940afe0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87666260"
---
# <a name="log-operations-in-analysis-services"></a><span data-ttu-id="37fea-102">Журнал операций в службах Analysis Services</span><span class="sxs-lookup"><span data-stu-id="37fea-102">Log operations in Analysis Services</span></span>
  <span data-ttu-id="37fea-103">Экземпляр Analysis Services будет регистрировать уведомления сервера, ошибки и предупреждения в файле msmdsrv. log — по одному для каждого устанавливаемого экземпляра.</span><span class="sxs-lookup"><span data-stu-id="37fea-103">An Analysis Services instance will log server notifications, errors, and warnings to the msmdsrv.log file - one for each instance you install.</span></span> <span data-ttu-id="37fea-104">Администраторы обращаются к этому журналу для анализа как обычных, так и непредвиденных событий.</span><span class="sxs-lookup"><span data-stu-id="37fea-104">Administrators refer to this log for insights into routine and extraordinary events alike.</span></span> <span data-ttu-id="37fea-105">В последних версиях ведение журнала было усовершенствовано, чтобы собирать больше сведений.</span><span class="sxs-lookup"><span data-stu-id="37fea-105">In recent releases, logging has been enhanced to include more information.</span></span> <span data-ttu-id="37fea-106">Записи журнала теперь включают сведения о версии и выпуске продукта, а также о процессоре, памяти, подключении и событиях блокировки.</span><span class="sxs-lookup"><span data-stu-id="37fea-106">Log records now include product version and edition information, as well as processor, memory, connectivity, and blocking events.</span></span> <span data-ttu-id="37fea-107">Список всех изменений можно просмотреть в разделе [Улучшения ведения журнала](https://support.microsoft.com/kb/2965035).</span><span class="sxs-lookup"><span data-stu-id="37fea-107">You can review the entire change list at [Logging improvements](https://support.microsoft.com/kb/2965035).</span></span>  
  
 <span data-ttu-id="37fea-108">Помимо встроенного ведения журнала, многие администраторы и разработчики используют средства, предоставляемые сообществом служб Analysis Services для сбора данных об операциях сервера, например **ASTrace**.</span><span class="sxs-lookup"><span data-stu-id="37fea-108">Besides the built-in logging feature, many administrators and developers also use tools provided by the Analysis Services community to collect data about server operations, such as **ASTrace**.</span></span> <span data-ttu-id="37fea-109">Ссылки на загрузки вы найдете здесь: [Примеры для служб аналитики, предоставленные сообществом Microsoft SQL Server](https://sqlsrvanalysissrvcs.codeplex.com/) .</span><span class="sxs-lookup"><span data-stu-id="37fea-109">See [Microsoft SQL Server Community Samples: Analysis Services](https://sqlsrvanalysissrvcs.codeplex.com/) for the download links.</span></span>  
  
 <span data-ttu-id="37fea-110">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="37fea-110">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="37fea-111">Расположение и типы журналов</span><span class="sxs-lookup"><span data-stu-id="37fea-111">Location and types of logs</span></span>](#bkmk_location)  
  
-   [<span data-ttu-id="37fea-112">Общие сведения о параметрах конфигурации файла журнала</span><span class="sxs-lookup"><span data-stu-id="37fea-112">General information on log file configuration settings</span></span>](#bkmk_general)  
  
-   [<span data-ttu-id="37fea-113">Файл журнала службы MSMDSRV</span><span class="sxs-lookup"><span data-stu-id="37fea-113">MSMDSRV service log file</span></span>](#bkmk_msmdsrv)  
  
-   [<span data-ttu-id="37fea-114">Журналы запросов</span><span class="sxs-lookup"><span data-stu-id="37fea-114">Query logs</span></span>](#bkmk_querylog)  
  
-   [<span data-ttu-id="37fea-115">Файлы мини-дампа (\*.mdmp)</span><span class="sxs-lookup"><span data-stu-id="37fea-115">Mini dump (.mdmp) files</span></span>](#bkmk_mdmp)  
  
-   [<span data-ttu-id="37fea-116">Советы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="37fea-116">Tips and best practices</span></span>](#bkmk_tips)  
  
> [!NOTE]  
>  <span data-ttu-id="37fea-117">Если необходимы дополнительные сведения о ведении журнала, узнайте об операциях трассировки, показывающих пути выполнения запросов и обработки.</span><span class="sxs-lookup"><span data-stu-id="37fea-117">If you're looking for information about logging, you might also be interested in tracing operations that show processing and query execution paths.</span></span> <span data-ttu-id="37fea-118">Объекты трассировки для динамической и длительной трассировки (например, аудит доступа к кубу), а также рекомендации о том, как лучше использовать "черный ящик", приложения SQL Server Profiler и xEvents, можно найти по ссылкам на этой странице: [Наблюдение за экземпляром служб Analysis Services](monitor-an-analysis-services-instance.md).</span><span class="sxs-lookup"><span data-stu-id="37fea-118">Trace objects for ad hoc and sustained tracing (such as auditing cube access) ─ as well as recommendations on how to best use Flight Recorder, SQL Server Profiler, and xEvents ─ can be found through the links on this page: [Monitor an Analysis Services Instance](monitor-an-analysis-services-instance.md).</span></span>  
  
##  <a name="location-and-types-of-logs"></a><a name="bkmk_location"></a><span data-ttu-id="37fea-119">Расположение и типы журналов</span><span class="sxs-lookup"><span data-stu-id="37fea-119">Location and types of logs</span></span>  
 <span data-ttu-id="37fea-120">Службы Analysis Services предоставляют журналы, описанные ниже.</span><span class="sxs-lookup"><span data-stu-id="37fea-120">Analysis Services provides the logs described below.</span></span>  
  
|<span data-ttu-id="37fea-121">Имя файла или расположение</span><span class="sxs-lookup"><span data-stu-id="37fea-121">File name or Location</span></span>|<span data-ttu-id="37fea-122">Type</span><span class="sxs-lookup"><span data-stu-id="37fea-122">Type</span></span>|<span data-ttu-id="37fea-123">Используется для</span><span class="sxs-lookup"><span data-stu-id="37fea-123">Used for</span></span>|<span data-ttu-id="37fea-124">По умолчанию включено</span><span class="sxs-lookup"><span data-stu-id="37fea-124">On by default</span></span>|  
|---------------------------|----------|--------------|-------------------|  
|<span data-ttu-id="37fea-125">Msmdsrv.log</span><span class="sxs-lookup"><span data-stu-id="37fea-125">Msmdsrv.log</span></span>|<span data-ttu-id="37fea-126">Журнал ошибок</span><span class="sxs-lookup"><span data-stu-id="37fea-126">Error log</span></span>|<span data-ttu-id="37fea-127">Постоянное наблюдение и устранение основных неполадок</span><span class="sxs-lookup"><span data-stu-id="37fea-127">Routine monitoring and basic troubleshooting</span></span>|<span data-ttu-id="37fea-128">Да</span><span class="sxs-lookup"><span data-stu-id="37fea-128">Yes</span></span>|  
|<span data-ttu-id="37fea-129">Таблица OlapQueryLog реляционной базы данных</span><span class="sxs-lookup"><span data-stu-id="37fea-129">OlapQueryLog table in a relational database</span></span>|<span data-ttu-id="37fea-130">Журнал запросов</span><span class="sxs-lookup"><span data-stu-id="37fea-130">Query log</span></span>|<span data-ttu-id="37fea-131">Сбор входных данных для мастера оптимизации использования</span><span class="sxs-lookup"><span data-stu-id="37fea-131">Collect inputs for the Usage Optimization Wizard</span></span>|<span data-ttu-id="37fea-132">Нет</span><span class="sxs-lookup"><span data-stu-id="37fea-132">No</span></span>|  
|<span data-ttu-id="37fea-133">\<guid>Файлы файлы sqldmp. mdmp</span><span class="sxs-lookup"><span data-stu-id="37fea-133">SQLDmp\<guid>.mdmp files</span></span>|<span data-ttu-id="37fea-134">Сбои и исключения</span><span class="sxs-lookup"><span data-stu-id="37fea-134">Crashes and exceptions</span></span>|<span data-ttu-id="37fea-135">Устранение серьезных неполадок</span><span class="sxs-lookup"><span data-stu-id="37fea-135">Deep troubleshooting</span></span>|<span data-ttu-id="37fea-136">Нет</span><span class="sxs-lookup"><span data-stu-id="37fea-136">No</span></span>|  
  
 <span data-ttu-id="37fea-137">Настоятельно рекомендуется ознакомиться со следующей ссылкой для получения дополнительных сведений, не охваченных в этом разделе. [Подсказки к начальному сбору данных от службы технической поддержки Майкрософт](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx).</span><span class="sxs-lookup"><span data-stu-id="37fea-137">We highly recommend the following link for additional information resources not covered in this topic: [Initial data collection tips from Microsoft Support](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx).</span></span>  
  
##  <a name="general-information-on-log-file-configuration-settings"></a><a name="bkmk_general"></a><span data-ttu-id="37fea-138">Общие сведения о параметрах конфигурации файла журнала</span><span class="sxs-lookup"><span data-stu-id="37fea-138">General information on log file configuration settings</span></span>  
 <span data-ttu-id="37fea-139">Разделы для каждого журнала можно найти в файле конфигурации сервера msmdsrv.ini, расположенном в папке \Program Files\Microsoft SQL Server\MSAS12.MSSQLSERVER\OLAP\Config.</span><span class="sxs-lookup"><span data-stu-id="37fea-139">You can find sections for each log in the msmdsrv.ini server configuration file, located in the \Program Files\Microsoft SQL Server\MSAS12.MSSQLSERVER\OLAP\Config folder.</span></span> <span data-ttu-id="37fea-140">Инструкции по изменению файла см. в разделе [Configure Server Properties in Analysis Services](../server-properties/server-properties-in-analysis-services.md) .</span><span class="sxs-lookup"><span data-stu-id="37fea-140">See [Configure Server Properties in Analysis Services](../server-properties/server-properties-in-analysis-services.md) for instructions on editing the file.</span></span>  
  
 <span data-ttu-id="37fea-141">По возможности рекомендуется задать свойства ведения журнала на странице свойств сервера Management Studio.</span><span class="sxs-lookup"><span data-stu-id="37fea-141">Where possible, we suggest that you set logging properties in the server properties page of Management Studio.</span></span> <span data-ttu-id="37fea-142">Тем не менее иногда необходимо изменить файл msmdsrv.ini непосредственно для настройки параметров, которые не отображаются в средствах администрирования.</span><span class="sxs-lookup"><span data-stu-id="37fea-142">Although in some cases, you must edit the msmdsrv.ini file directly to configure settings that are not visible in the administrative tools.</span></span>  
  
 <span data-ttu-id="37fea-143">![Раздел файла конфигурации, показывающий параметры журнала](../media/ssas-logfilesettings.png "Раздел файла конфигурации, показывающий параметры журнала")</span><span class="sxs-lookup"><span data-stu-id="37fea-143">![Section of the config file showing log settings](../media/ssas-logfilesettings.png "Section of the config file showing log settings")</span></span>  
  
##  <a name="msmdsrv-service-log-file"></a><a name="bkmk_msmdsrv"></a><span data-ttu-id="37fea-144">Файл журнала службы MSMDSRV</span><span class="sxs-lookup"><span data-stu-id="37fea-144">MSMDSRV service log file</span></span>  
 <span data-ttu-id="37fea-145">Службы Analysis Services записывают операции сервера в файл msmdsrv.log, по одному на экземпляр, расположенный в папке \Program files\Microsoft SQL Server\\<экземпляр\>\Olap\Log.</span><span class="sxs-lookup"><span data-stu-id="37fea-145">Analysis Services logs server operations to the msmdsrv.log file, one per instance, located at \program files\Microsoft SQL Server\\<instance\>\Olap\Log.</span></span>  
  
 <span data-ttu-id="37fea-146">Этот файл журнала очищается при каждом перезапуске службы.</span><span class="sxs-lookup"><span data-stu-id="37fea-146">This log file is emptied at each service restart.</span></span> <span data-ttu-id="37fea-147">В предыдущих выпусках администраторы иногда перезапускали службу с единственной целью очистить файл журнала, прежде чем он станет настолько большим, что его нельзя будет использовать.</span><span class="sxs-lookup"><span data-stu-id="37fea-147">In previous releases, administrators would sometimes restart the service for the sole purpose of flushing the log file before it could grow so large as to become unusable.</span></span> <span data-ttu-id="37fea-148">Это больше не требуется.</span><span class="sxs-lookup"><span data-stu-id="37fea-148">This is no longer necessary.</span></span> <span data-ttu-id="37fea-149">Параметры конфигурации, появившиеся с выходом в SQL Server 2012 с пакетом обновления 2 (SP2) и более поздних версий, позволяют управлять размером файла журнала и его историей:</span><span class="sxs-lookup"><span data-stu-id="37fea-149">Configuration settings, introduced in SQL Server 2012 SP2 and later, give you control over the size of the log file and its history:</span></span>  
  
-   <span data-ttu-id="37fea-150">`MaxFileSizeMB` определяет максимальный размер файла журнала в мегабайтах.</span><span class="sxs-lookup"><span data-stu-id="37fea-150">`MaxFileSizeMB` specifies a maximum log file size in megabytes.</span></span> <span data-ttu-id="37fea-151">Значение по умолчанию равно 256.</span><span class="sxs-lookup"><span data-stu-id="37fea-151">The default is 256.</span></span> <span data-ttu-id="37fea-152">Допустимое замещающее значение должно быть положительным целым числом.</span><span class="sxs-lookup"><span data-stu-id="37fea-152">A valid replacement value must be a positive integer.</span></span> <span data-ttu-id="37fea-153">Когда будет достигнут размер `MaxFileSizeMB`, службы Analysis Services переименовывают текущий файл в msmdsrv{текущая_отметка_времени}.log и начинают новый файл msmdsrv.log.</span><span class="sxs-lookup"><span data-stu-id="37fea-153">When `MaxFileSizeMB` is reached, Analysis Services renames the current file as msmdsrv{current timestamp}.log file, and starts a new msmdsrv.log file.</span></span>  
  
-   <span data-ttu-id="37fea-154">`MaxNumberFiles`Задает хранение старых файлов журнала.</span><span class="sxs-lookup"><span data-stu-id="37fea-154">`MaxNumberFiles` specifies retention of older log files.</span></span> <span data-ttu-id="37fea-155">Значение по умолчанию равно 0 (отключено).</span><span class="sxs-lookup"><span data-stu-id="37fea-155">The default is 0 (disabled).</span></span> <span data-ttu-id="37fea-156">Его можно изменить на положительное целое число, чтобы хранить версии файла журнала.</span><span class="sxs-lookup"><span data-stu-id="37fea-156">You can change it to a positive integer to keep versions of the log file.</span></span> <span data-ttu-id="37fea-157">Когда будет достигнуто `MaxNumberFiles`, службы Analysis Services удаляют файл с самой старой отметкой времени в имени.</span><span class="sxs-lookup"><span data-stu-id="37fea-157">When `MaxNumberFiles` is reached, Analysis Services deletes the file with the oldest timestamp in its name.</span></span>  
  
 <span data-ttu-id="37fea-158">Чтобы использовать эти параметры, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="37fea-158">To use these settings, do the following:</span></span>  
  
1.  <span data-ttu-id="37fea-159">Откройте msmdsrv.ini в блокноте.</span><span class="sxs-lookup"><span data-stu-id="37fea-159">Open msmdsrv.ini in NotePad.</span></span>  
  
2.  <span data-ttu-id="37fea-160">Скопируйте следующие две строки:</span><span class="sxs-lookup"><span data-stu-id="37fea-160">Copy the following two lines:</span></span>  
  
    ```  
    <MaxFileSizeMB>256</MaxFileSizeMB>  
    <MaxNumberOfLogFiles>5</MaxNumberOfLogFiles>  
    ```  
  
3.  <span data-ttu-id="37fea-161">Вставьте две строки в раздел Log msmdsrv.ini под именем файла для msmdsrv.log.</span><span class="sxs-lookup"><span data-stu-id="37fea-161">Paste the two lines into the Log section of msmdsrv.ini, below the filename for msmdsrv.log.</span></span> <span data-ttu-id="37fea-162">Оба параметра необходимо добавить вручную.</span><span class="sxs-lookup"><span data-stu-id="37fea-162">Both settings must be added manually.</span></span> <span data-ttu-id="37fea-163">В файле msmdsrv.ini для них не существует заполнителей.</span><span class="sxs-lookup"><span data-stu-id="37fea-163">There are no placeholders for them in the msmdsrv.ini file.</span></span>  
  
     <span data-ttu-id="37fea-164">Измененный файл конфигурации должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="37fea-164">The changed configuration file should look like the following:</span></span>  
  
    ```  
    <Log>  
    <File>msmdsrv.log</File>  
    <MaxFileSizeMB>256</MaxFileSizeMB>  
    <MaxNumberOfLogFiles>5</MaxNumberOfLogFiles>  
    <FileBufferSize>0</FileBufferSize>  
  
    ```  
  
4.  <span data-ttu-id="37fea-165">Измените значения, если описанные выше отличаются от необходимых.</span><span class="sxs-lookup"><span data-stu-id="37fea-165">Edit the values if those provided differ from what you want.</span></span>  
  
5.  <span data-ttu-id="37fea-166">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="37fea-166">Save the file.</span></span>  
  
6.  <span data-ttu-id="37fea-167">Перезапустите службу.</span><span class="sxs-lookup"><span data-stu-id="37fea-167">Restart the service.</span></span>  
  
##  <a name="query-logs"></a><a name="bkmk_querylog"></a><span data-ttu-id="37fea-168">Журналы запросов</span><span class="sxs-lookup"><span data-stu-id="37fea-168">Query logs</span></span>  
 <span data-ttu-id="37fea-169">Журнал запросов — немного неверное название, в том смысле, что он не регистрирует действия пользователей, связанные с запросами MDX или DAX.</span><span class="sxs-lookup"><span data-stu-id="37fea-169">The query log is a bit of a misnomer in that it does not log the MDX or DAX query activity of your users.</span></span> <span data-ttu-id="37fea-170">Вместо этого он собирает данные о запросах, сформированные службами Analysis Services, которые впоследствии используются в качестве входных данных в мастере оптимизации с учетом использования.</span><span class="sxs-lookup"><span data-stu-id="37fea-170">Instead, it collects data about queries generated by Analysis Services, which is subsequently used as data input in the Usage Based Optimization Wizard.</span></span> <span data-ttu-id="37fea-171">Данные, собранные в журнале запросов, не предназначены для прямого анализа.</span><span class="sxs-lookup"><span data-stu-id="37fea-171">The data collected in the query log is not intended for direct analysis.</span></span> <span data-ttu-id="37fea-172">В частности, наборы данных описаны в битовых массивах, при этом ноль или один указывают на части набора данных, включенные в запрос.</span><span class="sxs-lookup"><span data-stu-id="37fea-172">Specifically, the datasets are described in bit arrays, with a zero or a one indicating the parts of dataset is included in the query.</span></span> <span data-ttu-id="37fea-173">Эти данные тоже предназначены для мастера.</span><span class="sxs-lookup"><span data-stu-id="37fea-173">Again, this data is meant for the wizard.</span></span>  
  
 <span data-ttu-id="37fea-174">Для мониторинга и устранения неполадок запросов многие разработчики и администраторы используют средство сообщества **ASTrace**.</span><span class="sxs-lookup"><span data-stu-id="37fea-174">For query monitoring and troubleshooting, many developers and administrators use a community tool, **ASTrace**, to monitor queries.</span></span> <span data-ttu-id="37fea-175">Также можно использовать приложение SQL Server Profiler, xEvents или трассировку служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="37fea-175">You can also use SQL Server Profiler, xEvents, or an Analysis Services trace.</span></span> <span data-ttu-id="37fea-176">Ссылки, связанные с трассировкой, см. в разделе [Наблюдение за экземпляром служб Analysis Services](monitor-an-analysis-services-instance.md) .</span><span class="sxs-lookup"><span data-stu-id="37fea-176">See [Monitor an Analysis Services Instance](monitor-an-analysis-services-instance.md) for tracing-related links.</span></span>  
  
 <span data-ttu-id="37fea-177">Когда следует использовать журнал запросов</span><span class="sxs-lookup"><span data-stu-id="37fea-177">When should you use the query log?</span></span> <span data-ttu-id="37fea-178">Рекомендуется включить журнал запросов как часть процедуры по настройке производительности запросов, включающей мастер оптимизации с учетом использования.</span><span class="sxs-lookup"><span data-stu-id="37fea-178">We recommend enabling the query log as part of a query performance tuning exercise that includes the Usage Based Optimization Wizard.</span></span> <span data-ttu-id="37fea-179">Журнал запросов не существует, пока не включен компонент, не создана поддерживающая структура данных и не заданы свойства, используемые службами Analysis Services для обнаружения и заполнения журнала.</span><span class="sxs-lookup"><span data-stu-id="37fea-179">The query log does not exist until you enable the feature, create the data structures to support it, and set properties used by Analysis Services to locate and populate the log.</span></span>  
  
 <span data-ttu-id="37fea-180">Чтобы включить журнал запросов, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="37fea-180">To enable the query log, follow these steps:</span></span>  
  
1.  <span data-ttu-id="37fea-181">Создайте реляционную базу данных SQL Server для хранения журнала запросов.</span><span class="sxs-lookup"><span data-stu-id="37fea-181">Create a SQL Server relational database to store the query log.</span></span>  
  
2.  <span data-ttu-id="37fea-182">Предоставьте учетной записи службы Analysis Services достаточно разрешений в базе данных.</span><span class="sxs-lookup"><span data-stu-id="37fea-182">Grant the Analysis Services service account sufficient permissions on the database.</span></span> <span data-ttu-id="37fea-183">Учетной записи необходимо предоставить разрешение на создание таблицы, записи в таблицу и считывания из таблицы.</span><span class="sxs-lookup"><span data-stu-id="37fea-183">The account needs permission to create a table, write to the table, and read from the table.</span></span>  
  
3.  <span data-ttu-id="37fea-184">В SQL Server Management Studio щелкните правой кнопкой мыши **Analysis Services**  |  **Свойства**  |  **Общие**, установите для **CreateQueryLogTable** значение true.</span><span class="sxs-lookup"><span data-stu-id="37fea-184">In SQL Server Management Studio, right-click **Analysis Services** | **Properties** | **General**, set **CreateQueryLogTable** to true.</span></span>  
  
4.  <span data-ttu-id="37fea-185">При необходимости измените **QueryLogSampling** или **QueryLogTableName** , если необходимо собирать образцы запросов с другой скоростью или использовать другое имя для таблицы.</span><span class="sxs-lookup"><span data-stu-id="37fea-185">Optionally, change **QueryLogSampling** or **QueryLogTableName** if you want to sample queries at a different rate, or use a different name for the table.</span></span>  
  
 <span data-ttu-id="37fea-186">Таблица журнала запросов не будет создана, пока не выполнится достаточно запросов многомерных выражений для соответствия требованиям выборки.</span><span class="sxs-lookup"><span data-stu-id="37fea-186">The query log table will not be created until you have run enough MDX queries to meet the sampling requirements.</span></span> <span data-ttu-id="37fea-187">Например, если оставить значение по умолчанию 10, то необходимо запустить по крайней мере 10 запросов, прежде чем таблица будет создана.</span><span class="sxs-lookup"><span data-stu-id="37fea-187">For example, if you keep the default value of 10, you must run at least 10 queries before the table will be created.</span></span>  
  
 <span data-ttu-id="37fea-188">Параметры журнала запросов применяются ко всему серверу.</span><span class="sxs-lookup"><span data-stu-id="37fea-188">Query log settings are server wide.</span></span> <span data-ttu-id="37fea-189">Указанные настройки будут использоваться всеми базами данных на этом сервере.</span><span class="sxs-lookup"><span data-stu-id="37fea-189">The settings you specify will be used by all databases running on this server.</span></span>  
  
 <span data-ttu-id="37fea-190">![Параметры журнала запросов в среде Management Studio](../media/ssas-querylogsettings.png "Параметры журнала запросов в среде Management Studio")</span><span class="sxs-lookup"><span data-stu-id="37fea-190">![Query log settings in Management Studio](../media/ssas-querylogsettings.png "Query log settings in Management Studio")</span></span>  
  
 <span data-ttu-id="37fea-191">После того как параметры конфигурации указаны, запустите запрос многомерных выражений несколько раз.</span><span class="sxs-lookup"><span data-stu-id="37fea-191">After the configuration settings are specified, run an MDX query multiple times.</span></span> <span data-ttu-id="37fea-192">Если значение выборки равно 10, запустите запрос 11 раз. Убедитесь, что таблица создана.</span><span class="sxs-lookup"><span data-stu-id="37fea-192">If sampling is set to 10, run the query 11 times.Verify the table is created.</span></span> <span data-ttu-id="37fea-193">В среде Management Studio подключитесь к ядру реляционной СУБД, откройте папку базы данных, откройте папку **Таблицы** и убедитесь, что **OlapQueryLog** существует.</span><span class="sxs-lookup"><span data-stu-id="37fea-193">In Management Studio, connect to the relational database engine, open the database folder, open the **Tables** folder, and verify that **OlapQueryLog** exists.</span></span> <span data-ttu-id="37fea-194">Если таблица сразу не отображается, обновите содержимое папки, чтобы отобразить изменения содержимого.</span><span class="sxs-lookup"><span data-stu-id="37fea-194">If you do not immediately see the table, refresh the folder to pick up any changes to its contents.</span></span>  
  
 <span data-ttu-id="37fea-195">Разрешите журналу запросов накопить достаточно данных для мастера оптимизации с учетом использования.</span><span class="sxs-lookup"><span data-stu-id="37fea-195">Allow the query log to accumulate sufficient data for the Usage Based Optimization Wizard.</span></span> <span data-ttu-id="37fea-196">Если запросы томов являются цикличными, необходимо захватить достаточно трафика, чтобы получить репрезентативный набор данных.</span><span class="sxs-lookup"><span data-stu-id="37fea-196">If query volumes are cyclical, capture enough traffic to have a representative set of data.</span></span> <span data-ttu-id="37fea-197">Инструкции по запуску мастера см. в разделе [Мастер оптимизации с учетом использования](https://msdn.microsoft.com/library/ms189706.aspx) .</span><span class="sxs-lookup"><span data-stu-id="37fea-197">See [Usage Based Optimization Wizard](https://msdn.microsoft.com/library/ms189706.aspx) for instructions on how to run the wizard.</span></span>  
  
 <span data-ttu-id="37fea-198">Дополнительные сведения о настройке журнала запросов см. в разделе [Настройка журнала запросов служб Analysis Services](https://technet.microsoft.com/library/Cc917676) .</span><span class="sxs-lookup"><span data-stu-id="37fea-198">See [Configuring the Analysis Services Query Log](https://technet.microsoft.com/library/Cc917676) to learn more about query log configuration.</span></span> <span data-ttu-id="37fea-199">Несмотря на то что документ довольно старый, настройка журнала запросов не изменилась в последних выпусках и сведения этого раздела до сих пор актуальны.</span><span class="sxs-lookup"><span data-stu-id="37fea-199">Although the paper is quite old, query log configuration has not changed in recent releases and the information it contains still applies.</span></span>  
  
##  <a name="mini-dump-mdmp-files"></a><a name="bkmk_mdmp"></a><span data-ttu-id="37fea-200">Файлы мини-дампа (. mdmp)</span><span class="sxs-lookup"><span data-stu-id="37fea-200">Mini dump (.mdmp) files</span></span>  
 <span data-ttu-id="37fea-201">Файлы дампа записывают данные, используемые для анализа непредвиденных событий.</span><span class="sxs-lookup"><span data-stu-id="37fea-201">Dump files capture data used for analyzing extraordinary events.</span></span> <span data-ttu-id="37fea-202">Службы Analysis Services автоматически создают мини-дампы (с расширением MDMP) в ответ на сбой сервера, исключения и ошибки конфигурации.</span><span class="sxs-lookup"><span data-stu-id="37fea-202">Analysis Services automatically generates mini dumps (.mdmp) in response to a server crash, exception, and some configuration errors.</span></span> <span data-ttu-id="37fea-203">Эта функция включена, но автоматически не отправляет отчеты о сбоях.</span><span class="sxs-lookup"><span data-stu-id="37fea-203">The feature is enabled, but does not send crash reports automatically.</span></span>  
  
 <span data-ttu-id="37fea-204">Отчеты о сбоях настраиваются через раздел Exception в файле Msmdsrv.ini.</span><span class="sxs-lookup"><span data-stu-id="37fea-204">Crash reports are configured through the Exception section in the Msmdsrv.ini file.</span></span> <span data-ttu-id="37fea-205">На основе этих параметров создается файл дампа памяти.</span><span class="sxs-lookup"><span data-stu-id="37fea-205">These settings control memory dump file generation.</span></span> <span data-ttu-id="37fea-206">Следующий фрагмент кода показывает значения по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="37fea-206">The following snippet shows the default values:</span></span>  
  
```  
<Exception>  
<CreateAndSendCrashReports>1</CreateAndSendCrashReports>  
<CrashReportsFolder/>  
<SQLDumperFlagsOn>0x0</SQLDumperFlagsOn>  
<SQLDumperFlagsOff>0x0</SQLDumperFlagsOff>  
<MiniDumpFlagsOn>0x0</MiniDumpFlagsOn>  
<MiniDumpFlagsOff>0x0</MiniDumpFlagsOff>  
<MinidumpErrorList>0xC1000000, 0xC1000001, 0xC102003F, 0xC1360054, 0xC1360055</MinidumpErrorList>  
<ExceptionHandlingMode>0</ExceptionHandlingMode>  
<CriticalErrorHandling>1</CriticalErrorHandling>  
<MaxExceptions>500</MaxExceptions>  
<MaxDuplicateDumps>1</MaxDuplicateDumps>  
</Exception>  
```  
  
 <span data-ttu-id="37fea-207">**Настройка отчетов о сбоях**</span><span class="sxs-lookup"><span data-stu-id="37fea-207">**Configure Crash Reports**</span></span>  
  
 <span data-ttu-id="37fea-208">Если иное не рекомендуется службой поддержки корпорации Майкрософт, большинство администраторов используют параметры по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="37fea-208">Unless otherwise directed by Microsoft Support, most administrators use the default settings.</span></span> <span data-ttu-id="37fea-209">Эта старая статья базы знаний еще используется для предоставления инструкций по настройке файлов дампа. [Настройка служб Analysis Services для создания файлов дампа памяти](https://support.microsoft.com/kb/919711).</span><span class="sxs-lookup"><span data-stu-id="37fea-209">This older KB article is still used to provide instruction on how to configure dump files: [How to configure Analysis Services to generate memory dump files](https://support.microsoft.com/kb/919711).</span></span>  
  
 <span data-ttu-id="37fea-210">Наиболее вероятный параметр конфигурации, который будет изменен, — `CreateAndSendCrashReports`. Он используется, чтобы определить, будет ли создаваться файл дампа памяти.</span><span class="sxs-lookup"><span data-stu-id="37fea-210">The configuration setting most likely to be modified is the `CreateAndSendCrashReports` setting used to determine whether a memory dump file will be generated.</span></span>  
  
|<span data-ttu-id="37fea-211">Значение</span><span class="sxs-lookup"><span data-stu-id="37fea-211">Value</span></span>|<span data-ttu-id="37fea-212">Описание</span><span class="sxs-lookup"><span data-stu-id="37fea-212">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="37fea-213">0</span><span class="sxs-lookup"><span data-stu-id="37fea-213">0</span></span>|<span data-ttu-id="37fea-214">Отключает файл дампа памяти.</span><span class="sxs-lookup"><span data-stu-id="37fea-214">Turns off the memory dump file.</span></span> <span data-ttu-id="37fea-215">Все остальные параметры в разделе Exception игнорируются.</span><span class="sxs-lookup"><span data-stu-id="37fea-215">All other settings under the Exception section are ignored.</span></span>|  
|<span data-ttu-id="37fea-216">1</span><span class="sxs-lookup"><span data-stu-id="37fea-216">1</span></span>|<span data-ttu-id="37fea-217">(По умолчанию) Включает, но не отправляет файл дампа памяти.</span><span class="sxs-lookup"><span data-stu-id="37fea-217">(Default) Enables, but does not send, the memory dump file.</span></span>|  
|<span data-ttu-id="37fea-218">2</span><span class="sxs-lookup"><span data-stu-id="37fea-218">2</span></span>|<span data-ttu-id="37fea-219">Включает и автоматически отправляет отчет об ошибках в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="37fea-219">Enables and automatically sends an error report to Microsoft.</span></span>|  
  
 <span data-ttu-id="37fea-220">`CrashReportsFolder` — местоположение файлов дампа.</span><span class="sxs-lookup"><span data-stu-id="37fea-220">`CrashReportsFolder` is the location of the dump files.</span></span> <span data-ttu-id="37fea-221">По умолчанию MDMP-файл и связанные записи журнала можно найти в папке \Olap\Log.</span><span class="sxs-lookup"><span data-stu-id="37fea-221">By default, an .mdmp file and associated log records can be found in the \Olap\Log folder.</span></span>  
  
 <span data-ttu-id="37fea-222">`SQLDumperFlagsOn` используется для создания полного дампа.</span><span class="sxs-lookup"><span data-stu-id="37fea-222">`SQLDumperFlagsOn` is used to generate a full dump.</span></span> <span data-ttu-id="37fea-223">По умолчанию полные дампы памяти не включены.</span><span class="sxs-lookup"><span data-stu-id="37fea-223">By default, full dumps are not enabled.</span></span> <span data-ttu-id="37fea-224">Для этого свойства можно задать значение `0x34`.</span><span class="sxs-lookup"><span data-stu-id="37fea-224">You can set this property to `0x34`.</span></span>  
  
 <span data-ttu-id="37fea-225">Дополнительные сведения см. по следующим ссылкам:</span><span class="sxs-lookup"><span data-stu-id="37fea-225">The following links provide more background:</span></span>  
  
-   [<span data-ttu-id="37fea-226">Углубленный анализ SQL Server с помощью мини-дампов</span><span class="sxs-lookup"><span data-stu-id="37fea-226">Looking Deeper into SQL Server using Minidumps</span></span>](https://blogs.msdn.com/b/sqlcat/archive/2009/09/11/looking-deeper-into-sql-server-using-minidumps.aspx)  
  
-   [<span data-ttu-id="37fea-227">Создание файла дампа пользовательского режима</span><span class="sxs-lookup"><span data-stu-id="37fea-227">How to create a user mode dump file</span></span>](https://support.microsoft.com/kb/931673)  
  
-   [<span data-ttu-id="37fea-228">Использование служебной программы Sqldumper.exe для создания файла дампа памяти в SQL Server</span><span class="sxs-lookup"><span data-stu-id="37fea-228">How to use the Sqldumper.exe utility to generate a dump file in SQL Server</span></span>](https://support.microsoft.com/kb/917825)  
  
##  <a name="tips-and-best-practices"></a><a name="bkmk_tips"></a><span data-ttu-id="37fea-229">Советы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="37fea-229">Tips and best practices</span></span>  
 <span data-ttu-id="37fea-230">Этот раздел содержит повторение советов, упоминаемых в этой статье.</span><span class="sxs-lookup"><span data-stu-id="37fea-230">This section is a recap of the tips mentioned throughout this article.</span></span>  
  
-   <span data-ttu-id="37fea-231">Настройка файла msmdsrv.log для управления размером и количеством файлов журнала msmdsrv.</span><span class="sxs-lookup"><span data-stu-id="37fea-231">Configure the msmdsrv.log file to control the size and number of msmdsrv log file.</span></span> <span data-ttu-id="37fea-232">Параметры не включены по умолчанию, поэтому необходимо добавить их в качестве шага после выполнения установки.</span><span class="sxs-lookup"><span data-stu-id="37fea-232">The settings are not enabled by default, so be sure to add them as post-installation step.</span></span> <span data-ttu-id="37fea-233">См. раздел [Файл журнала службы MSMDSRV](#bkmk_msmdsrv) в этой статье.</span><span class="sxs-lookup"><span data-stu-id="37fea-233">See [MSMDSRV service log file](#bkmk_msmdsrv) in this topic.</span></span>  
  
-   <span data-ttu-id="37fea-234">Ознакомьтесь с этой записью блога от службы поддержки клиентов Майкрософт, чтобы узнать, какие ресурсы используются для получения сведений об операциях сервера: [Начальный сбор данных](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx)</span><span class="sxs-lookup"><span data-stu-id="37fea-234">Review this blog post from Microsoft Customer Support to learn what resources they use to get information about server operations: [Initial Data Collection](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx)</span></span>  
  
-   <span data-ttu-id="37fea-235">Используйте ASTrace2012 вместо журнала запросов, чтобы узнать, кто отправляет запросы к кубам.</span><span class="sxs-lookup"><span data-stu-id="37fea-235">Use ASTrace2012, rather than a query log, to find out who is querying cubes.</span></span> <span data-ttu-id="37fea-236">Журнал запросов обычно используется для ввода данных в мастер оптимизации с учетом использования, и данные, которые он записывает, не просто прочитать или интерпретировать.</span><span class="sxs-lookup"><span data-stu-id="37fea-236">The query log is typically used to provide input into the Usage Based Optimization Wizard, and the data it captures is not easy to read or interpret.</span></span> <span data-ttu-id="37fea-237">ASTrace2012 — это широко используемое средство сообщества, собирающее операции запросов.</span><span class="sxs-lookup"><span data-stu-id="37fea-237">ASTrace2012 is a community tool, widely used, that captures query operations.</span></span> <span data-ttu-id="37fea-238">Ссылки для загрузки см. в разделе [Примеры сообщества Microsoft SQL Server: службы Analysis Services](https://sqlsrvanalysissrvcs.codeplex.com/).</span><span class="sxs-lookup"><span data-stu-id="37fea-238">See [Microsoft SQL Server Community Samples: Analysis Services](https://sqlsrvanalysissrvcs.codeplex.com/).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37fea-239">См. также:</span><span class="sxs-lookup"><span data-stu-id="37fea-239">See Also</span></span>  
 <span data-ttu-id="37fea-240">[Управление экземплярами Analysis Services](analysis-services-instance-management.md) </span><span class="sxs-lookup"><span data-stu-id="37fea-240">[Analysis Services Instance Management](analysis-services-instance-management.md) </span></span>  
 <span data-ttu-id="37fea-241">[Общие сведения о мониторинге Analysis Services с помощью SQL Server Profiler](introduction-to-monitoring-analysis-services-with-sql-server-profiler.md) </span><span class="sxs-lookup"><span data-stu-id="37fea-241">[Introduction to Monitoring Analysis Services with SQL Server Profiler](introduction-to-monitoring-analysis-services-with-sql-server-profiler.md) </span></span>  
 [<span data-ttu-id="37fea-242">Настройка свойств сервера в службах Analysis Services</span><span class="sxs-lookup"><span data-stu-id="37fea-242">Configure Server Properties in Analysis Services</span></span>](../server-properties/server-properties-in-analysis-services.md)  
  
  
