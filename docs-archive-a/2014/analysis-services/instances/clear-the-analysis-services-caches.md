---
title: Очистка Analysis Services кэшей | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 6bf66fdd-6a03-4cea-b7e2-eb676ff276ff
author: minewiskan
ms.author: owend
ms.openlocfilehash: e4890dd322406dcf48bc6b8eca89f292cfe132a3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87729962"
---
# <a name="clear-the-analysis-services-caches"></a><span data-ttu-id="821d2-102">Очистка кэша служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="821d2-102">Clear the Analysis Services Caches</span></span>
  <span data-ttu-id="821d2-103">Службы Analysis Services кэшируют данные для повышения производительности запросов.</span><span class="sxs-lookup"><span data-stu-id="821d2-103">Analysis Services caches data to boost query performance.</span></span> <span data-ttu-id="821d2-104">В этом разделе приводятся рекомендации по использованию команды XMLA ClearCache для очистки кэшей, созданных в ответ на запрос многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="821d2-104">This topic provides recommendations for using the XMLA ClearCache command to clear caches that were created in response to an MDX query.</span></span> <span data-ttu-id="821d2-105">Эффекты выполнения команды ClearCache различаются в зависимости от используемой модели (табличной или многомерной).</span><span class="sxs-lookup"><span data-stu-id="821d2-105">The effects of running ClearCache vary depending on whether you are using a tabular or multidimensional model.</span></span>  
  
 <span data-ttu-id="821d2-106">**Время очистки кэша для многомерных моделей**</span><span class="sxs-lookup"><span data-stu-id="821d2-106">**When to clear the cache for multidimensional models**</span></span>  
  
 <span data-ttu-id="821d2-107">Для многомерных баз данных службы Analysis Services строят кэши в обработчике формул при выполнении вычисления и в подсистеме хранилища для результатов запросов измерений и запросов групп мер.</span><span class="sxs-lookup"><span data-stu-id="821d2-107">For multidimensional databases, Analysis Services builds caches in the formula engine when evaluating a calculation, and in the storage engine for the results of dimension queries and measure group queries.</span></span> <span data-ttu-id="821d2-108">Запросы групп мер выполняются, когда обработчику формул необходимы данные мер для координаты ячейки или вложенного куба.</span><span class="sxs-lookup"><span data-stu-id="821d2-108">Measure group queries occur when the formula engine needs measure data for a cell coordinate or subcube.</span></span> <span data-ttu-id="821d2-109">Запросы измерения выполняются при запросе неестественных иерархий и применении автоматических проверок существования.</span><span class="sxs-lookup"><span data-stu-id="821d2-109">Dimension queries occur when querying unnatural hierarchies and when applying autoexists.</span></span>  
  
 <span data-ttu-id="821d2-110">Очистка кэша рекомендуется при проведении тестирования производительности.</span><span class="sxs-lookup"><span data-stu-id="821d2-110">Clearing the cache is recommended when conducting performance testing.</span></span> <span data-ttu-id="821d2-111">Очистка кэша между последовательными выполнениями тестов обеспечивает независимость результатов тестирования, измеряющих эффект изменения структуры запроса.</span><span class="sxs-lookup"><span data-stu-id="821d2-111">By clearing the cache between test runs, you ensure that caching does not skew any test results that measure the impact of a query design change.</span></span>  
  
 <span data-ttu-id="821d2-112">**Время очистки кэша для табличных моделей**</span><span class="sxs-lookup"><span data-stu-id="821d2-112">**When to clear the cache for tabular models**</span></span>  
  
 <span data-ttu-id="821d2-113">Табличные модели обычно хранятся в памяти, где агрегаты и другие вычисления выполняются во время выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="821d2-113">Tabular models are generally stored in memory, where aggregations and other calculations are performed at the time a query is executed.</span></span> <span data-ttu-id="821d2-114">Поэтому команда ClearCache имеет ограниченное влияние на табличные модели.</span><span class="sxs-lookup"><span data-stu-id="821d2-114">As such, the ClearCache command has a limited effect on tabular models.</span></span> <span data-ttu-id="821d2-115">Для табличной модели данные могут добавляться в кэши служб Analysis Services, если к ним выполняются запросы многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="821d2-115">For a tabular model, data may be added to the Analysis Services caches if MDX queries are run against it.</span></span> <span data-ttu-id="821d2-116">В частности, меры расширений интеллектуального анализа данных, упоминаемые в многомерных выражениях, и операции автоматической проверки существования могут кэшировать результаты соответственно в кэше формул и кэше измерений.</span><span class="sxs-lookup"><span data-stu-id="821d2-116">In particular, DAX measures referenced by MDX and autoexists operations can cache results in the formula cache and dimension cache respectively.</span></span> <span data-ttu-id="821d2-117">Заметьте, что неестественные иерархии и запросы групп мер не кэшируют результаты в подсистеме хранилища.</span><span class="sxs-lookup"><span data-stu-id="821d2-117">Note however, that unnatural hierarchies and measure group queries do not cache results in the storage engine.</span></span> <span data-ttu-id="821d2-118">Кроме того, важно понимать, что запросы расширений интеллектуального анализа данных не кэшируют результаты в обработчике формул и подсистеме хранилища.</span><span class="sxs-lookup"><span data-stu-id="821d2-118">Additionally, it is important to recognize that DAX queries do not cache results in the formula and storage engine.</span></span> <span data-ttu-id="821d2-119">Пока кэши существуют как результат запросов многомерных выражений, выполнение команды ClearCache для табличной модели сделает недопустимыми все кэшированные данные в системе.</span><span class="sxs-lookup"><span data-stu-id="821d2-119">To the extent that caches exist as a result of MDX queries, running ClearCache against a tabular model will invalidate any cached data from the system.</span></span>  
  
 <span data-ttu-id="821d2-120">Выполнение команды ClearCache также очищает кэши в памяти подсистемы VertiPaq аналитики в памяти xVelocity.</span><span class="sxs-lookup"><span data-stu-id="821d2-120">Running ClearCache will also clear in-memory caches in the xVelocity in-memory analytics engine (VertiPaq).</span></span> <span data-ttu-id="821d2-121">Подсистема xVelocity хранит в кэше небольшой набор результатов.</span><span class="sxs-lookup"><span data-stu-id="821d2-121">The xVelocity engine maintains a small set of cached results.</span></span> <span data-ttu-id="821d2-122">Выполнение команды ClearCache сделает эти кэши в подсистеме xVelocity недопустимыми.</span><span class="sxs-lookup"><span data-stu-id="821d2-122">Running ClearCache will invalidate these caches in the xVelocity engine.</span></span>  
  
 <span data-ttu-id="821d2-123">Наконец, выполнение ClearCache также удаляет данные, оставшиеся в памяти при изменении конфигурации табличной модели для режима `DirectQuery`.</span><span class="sxs-lookup"><span data-stu-id="821d2-123">Finally, running ClearCache will also remove residual data that is left in memory when a tabular model is reconfigured for `DirectQuery` mode.</span></span> <span data-ttu-id="821d2-124">Это особенно важно, если модель содержит конфиденциальные данные, подлежащие строгому управлению.</span><span class="sxs-lookup"><span data-stu-id="821d2-124">This is particularly important if the model contains sensitive data that is subject to tight controls.</span></span> <span data-ttu-id="821d2-125">В этом случае выполнение команды ClearCache служит мерой предосторожности, обеспечивающей наличие конфиденциальных данных только в соответствующих местах.</span><span class="sxs-lookup"><span data-stu-id="821d2-125">In this case, running ClearCache is a precautionary action that you can take to ensure that sensitive data exists only where you expect it to be.</span></span> <span data-ttu-id="821d2-126">Если для развертывания модели и изменения режима запроса используется среда [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] , то необходимо очистить кэш вручную.</span><span class="sxs-lookup"><span data-stu-id="821d2-126">Clearing the cache manually is necessary if you are using [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] to deploy the model and change the query mode.</span></span> <span data-ttu-id="821d2-127">Напротив, при использовании среды [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] для указания режима `DirectQuery` в модели и секциях кэш очищается автоматически, когда модель переключается для использования этого режима запросов.</span><span class="sxs-lookup"><span data-stu-id="821d2-127">In contrast, using [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] to specify `DirectQuery` on the model and partitions will automatically clear the cache when you switch the model to use that query mode.</span></span>  
  
 <span data-ttu-id="821d2-128">В отличие от очистки кэшей многомерной модели при тестировании производительности, для очистки кэшей табличной модели нет общих рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="821d2-128">Compared with recommendations for clearing multidimensional model caches during performance testing, there is no broad recommendation for clearing tabular model caches.</span></span> <span data-ttu-id="821d2-129">Если в среде табличной модели, в которой содержатся конфиденциальные данные, не выполняется развертывание, то ни одна из административных задач сама по себе не требует очистки кэша.</span><span class="sxs-lookup"><span data-stu-id="821d2-129">If you are not managing the deployment of a tabular model that contains sensitive data, there is no specific administrative task that calls for clearing the cache.</span></span>  
  
## <a name="clear-the-cache-for-analysis-services-models"></a><span data-ttu-id="821d2-130">Очистка кэша для моделей служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="821d2-130">Clear the cache for Analysis Services models</span></span>  
 <span data-ttu-id="821d2-131">Чтобы очистить кэш, используйте XMLA и среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="821d2-131">To clear the cache, use XMLA and [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="821d2-132">Кэш вы можете очищать на уровне базы данных, куба, измерения, таблицы или группы мер.</span><span class="sxs-lookup"><span data-stu-id="821d2-132">You can clear the cache at the database, cube, dimension or table, or measure group level.</span></span> <span data-ttu-id="821d2-133">Следующие действия по очистке кэша на уровне базы данных относятся и к многомерным и к табличным моделям.</span><span class="sxs-lookup"><span data-stu-id="821d2-133">The following steps for clearing the cache at the database level apply to both multidimensional models and tabular models.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="821d2-134">Для тщательного тестирования производительности может потребоваться комплексный подход к очистке кэша.</span><span class="sxs-lookup"><span data-stu-id="821d2-134">Rigorous performance testing might require a more comprehensive approach to clearing the cache.</span></span> <span data-ttu-id="821d2-135">Инструкции по записи на диск служб Analysis Services и файловой системы см. в разделе, посвященном очистке кэшей, в руководстве [SQL Server 2008 R2 Analysis Services Operations Guide (на английском языке)](https://go.microsoft.com/fwlink/?linkID=https://go.microsoft.com/fwlink/?LinkID=225539).</span><span class="sxs-lookup"><span data-stu-id="821d2-135">For instructions on how to flush Analysis Services and file system caches, see the section on clearing caches in the [SQL Server 2008 R2 Analysis Services Operations Guide](https://go.microsoft.com/fwlink/?linkID=https://go.microsoft.com/fwlink/?LinkID=225539).</span></span>  
  
 <span data-ttu-id="821d2-136">Для многомерных и табличных моделей очистка некоторых из этих кэшей может выполняться в два этапа: выполнение команды ClearCache, делающей кэш недопустимым, и очистка кэша при получении следующего запроса.</span><span class="sxs-lookup"><span data-stu-id="821d2-136">For both multidimensional and tabular models, clearing some of these caches can be a two-step process that consists of invalidating the cache when ClearCache executes, followed by emptying the cache when the next query is received.</span></span> <span data-ttu-id="821d2-137">Сокращение объема используемой памяти будет заметно только после окончательной очистки кэша.</span><span class="sxs-lookup"><span data-stu-id="821d2-137">A reduction in memory consumption will be evident only after the cache is actually emptied.</span></span>  
  
 <span data-ttu-id="821d2-138">Для очистки кэша необходимо указать идентификатор объекта в инструкции `ClearCache` в запросе XMLA.</span><span class="sxs-lookup"><span data-stu-id="821d2-138">Clearing the cache requires that you provide an object identifier to the `ClearCache` statement in an XMLA query.</span></span> <span data-ttu-id="821d2-139">Сначала в этом разделе описывается, как получить идентификатор объекта.</span><span class="sxs-lookup"><span data-stu-id="821d2-139">The first step in this topic explains how to get an object identifier.</span></span>  
  
#### <a name="step-1-get-the-object-identifier"></a><span data-ttu-id="821d2-140">Шаг 1. Получение идентификатора объекта</span><span class="sxs-lookup"><span data-stu-id="821d2-140">Step 1: Get the object identifier</span></span>  
  
1.  <span data-ttu-id="821d2-141">В среде [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]щелкните объект правой кнопкой мыши, выберите пункт **Свойства**и скопируйте значение свойства "Идентификатор" на панели **Свойства** .</span><span class="sxs-lookup"><span data-stu-id="821d2-141">In [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], right-click an object, select **Properties**, and copy the value from the ID property in the **Properties** pane.</span></span> <span data-ttu-id="821d2-142">Такой подход работает для баз данных, кубов, измерений и таблиц.</span><span class="sxs-lookup"><span data-stu-id="821d2-142">This approach works for the database, cube, dimension, or table.</span></span>  
  
2.  <span data-ttu-id="821d2-143">Чтобы получить идентификатор группы мер, щелкните правой кнопкой мыши группу мер и выберите пункт **Создать скрипт для группы мер**.</span><span class="sxs-lookup"><span data-stu-id="821d2-143">To get the measure group ID, right-click the measure group and select **Script Measure Group As**.</span></span> <span data-ttu-id="821d2-144">Выберите команду **CREATE** или **ALTER**и отправьте запрос в окно.</span><span class="sxs-lookup"><span data-stu-id="821d2-144">Choose either **Create** or **Alter**, and send the query to a window.</span></span> <span data-ttu-id="821d2-145">Идентификатор группы мер будет виден в определении объекта.</span><span class="sxs-lookup"><span data-stu-id="821d2-145">The ID of the measure group will be visible in the object definition.</span></span> <span data-ttu-id="821d2-146">Скопируйте идентификатор определения объекта.</span><span class="sxs-lookup"><span data-stu-id="821d2-146">Copy the ID of the object definition.</span></span>  
  
#### <a name="step-2-run-the-query"></a><span data-ttu-id="821d2-147">Шаг 2. Запуск запроса</span><span class="sxs-lookup"><span data-stu-id="821d2-147">Step 2: Run the query</span></span>  
  
1.  <span data-ttu-id="821d2-148">В среде [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]щелкните правой кнопкой мыши базу данных, укажите пункт **Создать запрос**и выберите пункт **XMLA**.</span><span class="sxs-lookup"><span data-stu-id="821d2-148">In [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], right-click a database, point to **New Query**, and select **XMLA**.</span></span>  
  
2.  <span data-ttu-id="821d2-149">Скопируйте следующий пример кода в окно запроса XMLA.</span><span class="sxs-lookup"><span data-stu-id="821d2-149">Copy the following code example into the XMLA query window.</span></span> <span data-ttu-id="821d2-150">Замените `DatabaseID` на идентификатор базы данных для текущего соединения.</span><span class="sxs-lookup"><span data-stu-id="821d2-150">Change `DatabaseID` to the ID of the database on the current connection.</span></span>  
  
    ```  
    <ClearCache xmlns="https://schemas.microsoft.com/analysisservices/2003/engine">  
      <Object>  
        <DatabaseID> Adventure Works DW Multidimensional</DatabaseID>  
      </Object>  
    </ClearCache>  
  
    ```  
  
     <span data-ttu-id="821d2-151">Также вы можете указать путь к дочернему объекту, например группе мер, чтобы очистить кэш только для этого объекта.</span><span class="sxs-lookup"><span data-stu-id="821d2-151">Alternatively, you can specify a path of a child object, such as a measure group, to clear the cache for just that object.</span></span>  
  
    ```  
    <ClearCache xmlns="https://schemas.microsoft.com/analysisservices/2003/engine">  
      <Object>  
        <DatabaseID>Adventure Works DW Multidimensional</DatabaseID>  
            <CubeID>Adventure Works</CubeID>  
            <MeasureGroupID>Fact Currency Rate</MeasureGroupID>  
      </Object>  
    </ClearCache>  
    ```  
  
3.  <span data-ttu-id="821d2-152">Нажмите клавишу F5, чтобы выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="821d2-152">Press F5 to execute the query.</span></span> <span data-ttu-id="821d2-153">Вы должны увидеть следующий результат:</span><span class="sxs-lookup"><span data-stu-id="821d2-153">You should see the following result:</span></span>  
  
    ```  
    <return xmlns="urn:schemas-microsoft-com:xml-analysis">  
      <root xmlns="urn:schemas-microsoft-com:xml-analysis:empty" />  
    </return>  
    ```  
  
## <a name="see-also"></a><span data-ttu-id="821d2-154">См. также:</span><span class="sxs-lookup"><span data-stu-id="821d2-154">See Also</span></span>  
 <span data-ttu-id="821d2-155">[Создание скриптов административных задач в Analysis Services](../script-administrative-tasks-in-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="821d2-155">[Script Administrative Tasks in Analysis Services](../script-administrative-tasks-in-analysis-services.md) </span></span>  
 [<span data-ttu-id="821d2-156">Наблюдение за экземпляром служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="821d2-156">Monitor an Analysis Services Instance</span></span>](monitor-an-analysis-services-instance.md)  
  
  
