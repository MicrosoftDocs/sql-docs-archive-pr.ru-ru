---
title: Вычисляемые столбцы (табличные службы SSAS) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: e1011278-556d-4984-b01d-a37f8a33b304
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5d77b36ee3327d1b9e0d31ac97e5dbe135093a63
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87727353"
---
# <a name="calculated-columns-ssas-tabular"></a><span data-ttu-id="4308b-102">Вычисляемые столбцы (табличные службы SSAS)</span><span class="sxs-lookup"><span data-stu-id="4308b-102">Calculated Columns (SSAS Tabular)</span></span>
  <span data-ttu-id="4308b-103">Вычисляемые столбцы в табличной модели позволяют добавлять новые данные в модель.</span><span class="sxs-lookup"><span data-stu-id="4308b-103">Calculated columns, in tabular models, allow you to add new data to your model.</span></span> <span data-ttu-id="4308b-104">Вместо того чтобы вставлять или импортировать значения в столбец, необходимо создать формулу DAX, определяющую значения на уровне строк столбца.</span><span class="sxs-lookup"><span data-stu-id="4308b-104">Instead of pasting or importing values into the column, you create a DAX formula that defines the column's row level values.</span></span> <span data-ttu-id="4308b-105">Вычисляемый столбец впоследствии может использоваться в отчете, сводной таблице или сводной диаграмме, как и любой другой столбец.</span><span class="sxs-lookup"><span data-stu-id="4308b-105">The calculated column can then be used in a report, PivotTable, or PivotChart as would any other column.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4308b-106">Вычисляемые столбцы не поддерживаются для табличных моделей в режиме DirectQuery.</span><span class="sxs-lookup"><span data-stu-id="4308b-106">Calculated columns are not supported for tabular models in DirectQuery mode.</span></span> <span data-ttu-id="4308b-107">Дополнительные сведения см. в разделе [Режим DirectQuery (табличные службы SSAS)](directquery-mode-ssas-tabular.md).</span><span class="sxs-lookup"><span data-stu-id="4308b-107">For more information, see [DirectQuery Mode &#40;SSAS Tabular&#41;](directquery-mode-ssas-tabular.md).</span></span>  
  
 <span data-ttu-id="4308b-108">Разделы данной темы:</span><span class="sxs-lookup"><span data-stu-id="4308b-108">Sections in this topic:</span></span>  
  
-   [<span data-ttu-id="4308b-109">Преимущества</span><span class="sxs-lookup"><span data-stu-id="4308b-109">Benefits</span></span>](#bkmk_understanding)  
  
-   [<span data-ttu-id="4308b-110">Присвоение имени вычисляемому столбцу</span><span class="sxs-lookup"><span data-stu-id="4308b-110">Naming a Calculated Column</span></span>](#bkmk_naming)  
  
-   [<span data-ttu-id="4308b-111">Производительность вычисляемых столбцов</span><span class="sxs-lookup"><span data-stu-id="4308b-111">Performance of Calculated Columns</span></span>](#bkmk_perf)  
  
-   [<span data-ttu-id="4308b-112">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="4308b-112">Related Tasks</span></span>](#bkmk_rel_tasks)  
  
##  <a name="benefits"></a><a name="bkmk_understanding"></a> <span data-ttu-id="4308b-113">Преимущества</span><span class="sxs-lookup"><span data-stu-id="4308b-113">Benefits</span></span>  
 <span data-ttu-id="4308b-114">Формулы в вычисляемых столбцах очень похожи на формулы, применяемые в Excel.</span><span class="sxs-lookup"><span data-stu-id="4308b-114">Formulas in calculated columns are much like formulas in Excel.</span></span> <span data-ttu-id="4308b-115">Однако в отличие от Excel невозможно создать разные формулы для разных строк таблицы, вместо этого формула DAX автоматически применяется ко всему столбцу.</span><span class="sxs-lookup"><span data-stu-id="4308b-115">Unlike Excel, however, you cannot create different formulas for different rows in a table; instead, the DAX formula is automatically applied to the entire column.</span></span>  
  
 <span data-ttu-id="4308b-116">Если столбец содержит формулу, значение вычисляется для каждой строки.</span><span class="sxs-lookup"><span data-stu-id="4308b-116">When a column contains a formula, the value is computed for each row.</span></span> <span data-ttu-id="4308b-117">Результаты вычисляются для столбца, как только будет введена допустимая формула.</span><span class="sxs-lookup"><span data-stu-id="4308b-117">The results are calculated for the column when you enter a valid formula.</span></span> <span data-ttu-id="4308b-118">Значения столбца затем повторно вычисляются по мере необходимости, например при обновлении базовых данных.</span><span class="sxs-lookup"><span data-stu-id="4308b-118">Column values are then recalculated as necessary, such as when the underlying data is refreshed.</span></span>  
  
 <span data-ttu-id="4308b-119">Можно создавать вычисляемые столбцы на основе мер и других вычисляемых столбцов.</span><span class="sxs-lookup"><span data-stu-id="4308b-119">You can create calculated columns that are based on measures and other calculated columns.</span></span> <span data-ttu-id="4308b-120">Например, можно создать один вычисляемый столбец для извлечения номера из текстовой строки, а затем использовать это число в другом вычисляемом столбце.</span><span class="sxs-lookup"><span data-stu-id="4308b-120">For example, you might create one calculated column to extract a number from a string of text, and then use that number in another calculated column.</span></span>  
  
 <span data-ttu-id="4308b-121">Вычисляемый столбец создается на основе данных, которые уже присутствуют в существующей таблице, или создается с помощью формулы DAX.</span><span class="sxs-lookup"><span data-stu-id="4308b-121">A calculated column is based on data that you already have in an existing table, or created by using a DAX formula.</span></span> <span data-ttu-id="4308b-122">Например, можно выполнять объединение, сложение, извлечение подстрок и сравнение значений в других полях.</span><span class="sxs-lookup"><span data-stu-id="4308b-122">For example, you might choose to concatenate values, perform addition, extract substrings, or compare the values in other fields.</span></span> <span data-ttu-id="4308b-123">Для добавления вычисляемого столбца в модели должна быть хотя бы одна таблица.</span><span class="sxs-lookup"><span data-stu-id="4308b-123">To add a calculated column, you must have at least one table in your model.</span></span>  
  
 <span data-ttu-id="4308b-124">В этом примере демонстрируется простая формула в вычисляемом столбце:</span><span class="sxs-lookup"><span data-stu-id="4308b-124">This example demonstrates a simple formula in a calculated column:</span></span>  
  
```  
=EOMONTH([StartDate],0])  
  
```  
  
 <span data-ttu-id="4308b-125">Эта формула извлекает месяц из столбца StartDate.</span><span class="sxs-lookup"><span data-stu-id="4308b-125">This formula extracts the month from the StartDate column.</span></span> <span data-ttu-id="4308b-126">Затем для каждой строки в таблице вычисляется значение конца месяца.</span><span class="sxs-lookup"><span data-stu-id="4308b-126">It then calculates the end of the month value for each row in the table.</span></span> <span data-ttu-id="4308b-127">Второй параметр задает число месяцев до или после месяца в дате StartDate. В этом случае 0 означает тот же самый месяц.</span><span class="sxs-lookup"><span data-stu-id="4308b-127">The second parameter specifies the number of months before or after the month in StartDate; in this case, 0 means the same month.</span></span> <span data-ttu-id="4308b-128">Например, если столбец StartDate имеет 6/1/2001, то значение в вычисляемом столбце будет также 6/30/2001.</span><span class="sxs-lookup"><span data-stu-id="4308b-128">For example, if the value in the StartDate column is 6/1/2001, the value in the calculated column will be 6/30/2001.</span></span>  
  
##  <a name="naming-a-calculated-column"></a><a name="bkmk_naming"></a><span data-ttu-id="4308b-129">Присвоение имени вычисляемому столбцу</span><span class="sxs-lookup"><span data-stu-id="4308b-129">Naming a Calculated Column</span></span>  
 <span data-ttu-id="4308b-130">По умолчанию новый вычисляемый столбец добавляется справа от других столбцов в таблице, и столбцу автоматически присваивается имя по умолчанию: **CalculatedColumn1**, **CalculatedColumn2**и т. д.</span><span class="sxs-lookup"><span data-stu-id="4308b-130">By default, new calculated columns are added to the right of other columns in a table, and the column is automatically assigned the default name of **CalculatedColumn1**, **CalculatedColumn2**, and so forth.</span></span> <span data-ttu-id="4308b-131">Чтобы создать новый столбец между двумя существующими, можно также щелкнуть столбец правой кнопкой мыши и выбрать команду «Вставить столбец».</span><span class="sxs-lookup"><span data-stu-id="4308b-131">You can also right click a column, and then click Insert Column to create a new column between two existing columns.</span></span> <span data-ttu-id="4308b-132">Столбцы в одной таблице можно переупорядочить перетаскиванием, а также переименовать после создания, однако необходимо учитывать следующие ограничения на внесение изменений в вычисляемые столбцы.</span><span class="sxs-lookup"><span data-stu-id="4308b-132">You can rearrange columns within the same table by clicking and dragging, and you can rename columns after they are created; however, you should be aware of the following restrictions on changes to calculated columns:</span></span>  
  
-   <span data-ttu-id="4308b-133">Имя каждого столбца должно быть уникальным в пределах таблицы.</span><span class="sxs-lookup"><span data-stu-id="4308b-133">Each column name must be unique within a table.</span></span>  
  
-   <span data-ttu-id="4308b-134">Не следует использовать имена, которые уже использовались для мер внутри одной модели.</span><span class="sxs-lookup"><span data-stu-id="4308b-134">Avoid names that have already been used for measures within the same model.</span></span> <span data-ttu-id="4308b-135">Допускается наличие одинаковых имен у меры и вычисляемого столбца, но если они будут неуникальными, то возможно появление ошибок при вычислениях.</span><span class="sxs-lookup"><span data-stu-id="4308b-135">Although it is possible for a measure and a calculated column to have the same name, if names are not unique you can get calculation errors.</span></span> <span data-ttu-id="4308b-136">Чтобы исключить случайный вызов меры при обращении к столбцу, всегда используйте полную ссылку на столбец.</span><span class="sxs-lookup"><span data-stu-id="4308b-136">To avoid accidentally invoking a measure, when referring to a column always use a fully qualified column reference.</span></span>  
  
-   <span data-ttu-id="4308b-137">Если меняется имя вычисляемого столбца, необходимо также вручную обновить все зависящие от него формулы.</span><span class="sxs-lookup"><span data-stu-id="4308b-137">When you rename a calculated column, any formulas that rely on the column must be updated manually.</span></span> <span data-ttu-id="4308b-138">Обновление результатов формул происходит автоматически, если не включен режим ручного обновления.</span><span class="sxs-lookup"><span data-stu-id="4308b-138">Unless you are in manual update mode, updating the results of formulas takes place automatically.</span></span> <span data-ttu-id="4308b-139">Однако эта операция может занять некоторое время.</span><span class="sxs-lookup"><span data-stu-id="4308b-139">However, this operation might take some time.</span></span>  
  
-   <span data-ttu-id="4308b-140">Некоторые символы нельзя использовать в именах столбцов.</span><span class="sxs-lookup"><span data-stu-id="4308b-140">There are some characters that cannot be used within the names of columns.</span></span> <span data-ttu-id="4308b-141">Дополнительные сведения см. в подразделе «Требования к именам» раздела [DAX Syntax Specification for PowerPivot](/dax/dax-syntax-reference).</span><span class="sxs-lookup"><span data-stu-id="4308b-141">For more information, see "Naming Requirements" in [DAX Syntax Specification for PowerPivot](/dax/dax-syntax-reference).</span></span>  
  
##  <a name="performance-of-calculated-columns"></a><a name="bkmk_perf"></a><span data-ttu-id="4308b-142">Производительность вычисляемых столбцов</span><span class="sxs-lookup"><span data-stu-id="4308b-142">Performance of Calculated Columns</span></span>  
 <span data-ttu-id="4308b-143">Формула для вычисляемого столбца может потреблять больше ресурсов, чем формулы, используемые для мер.</span><span class="sxs-lookup"><span data-stu-id="4308b-143">The formula for a calculated column can be more resource-intensive than the formula used for a measure.</span></span> <span data-ttu-id="4308b-144">Одна из причин этого заключается в том, что результат вычисляемого столбца всегда вычисляется для каждой строки таблицы, а мера вычисляется только для ячеек, указанных в фильтре отчета, сводной таблице или сводной диаграмме.</span><span class="sxs-lookup"><span data-stu-id="4308b-144">One reason is that the result for a calculated column is always calculated for each row in a table, whereas a measure is only calculated for the cells defined by the filter used in a report, PivotTable, or PivotChart.</span></span> <span data-ttu-id="4308b-145">Например, вычисляемый столбец в таблице из миллиона строк всегда будет содержать миллион строк, что соответствующим образом отразится на производительности.</span><span class="sxs-lookup"><span data-stu-id="4308b-145">For example, a table with a million rows will always have a calculated column with a million results, and a corresponding effect on performance.</span></span> <span data-ttu-id="4308b-146">Однако в сводной таблице обычно производится фильтрация данных, применяются заголовки строк и столбцы, поэтому мера вычисляется только для подмножества данных в каждой ячейке сводной таблицы.</span><span class="sxs-lookup"><span data-stu-id="4308b-146">However, a PivotTable generally filters data by applying row and column headings; therefore, a measure is calculated only for the subset of data in each cell of the PivotTable.</span></span>  
  
 <span data-ttu-id="4308b-147">Формула имеет зависимости от объектов, на которые в ней существуют ссылки, например от других столбцов и выражений, вычисляющих значения.</span><span class="sxs-lookup"><span data-stu-id="4308b-147">A formula has dependencies on the objects that are referenced in the formula, such as other columns or expressions that evaluate values.</span></span> <span data-ttu-id="4308b-148">Например, вычисляемый столбец, основанный на другом столбце, или вычисление, содержащее выражение со ссылкой на столбец, не могут быть вычислены до тех пор, пока не будет вычислен этот столбец.</span><span class="sxs-lookup"><span data-stu-id="4308b-148">For example, a calculated column that is based on another column, or a calculation that contains an expression with a column reference, cannot be evaluated until the other column is evaluated.</span></span> <span data-ttu-id="4308b-149">По умолчанию автоматическое обновление в книгах включено, поэтому все такие зависимости могут влиять на производительность при обновлении значений и формул.</span><span class="sxs-lookup"><span data-stu-id="4308b-149">By default, automatic refresh is enabled in workbooks; therefore, all such dependencies can affect performance while values are updated and formulas refreshed.</span></span>  
  
 <span data-ttu-id="4308b-150">Чтобы избежать проблем с производительностью, при создании вычисляемых столбцов необходимо придерживаться следующих рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="4308b-150">To avoid performance issues when you create calculated columns, follow these guidelines:</span></span>  
  
-   <span data-ttu-id="4308b-151">Вместо того чтобы включать в одну формулу множество сложных зависимостей, создавайте формулы последовательно, сохраняя результаты в столбцах. Это позволит проверить результаты и оценить производительность.</span><span class="sxs-lookup"><span data-stu-id="4308b-151">Rather than create a single formula that contains many complex dependencies, create the formulas in steps, with results saved to columns, so that you can validate the results and assess performance.</span></span>  
  
-   <span data-ttu-id="4308b-152">Изменение данных часто приводит к необходимости повторного вычисления вычисляемых столбцов.</span><span class="sxs-lookup"><span data-stu-id="4308b-152">Modification of data will often require that calculated columns be recalculated.</span></span> <span data-ttu-id="4308b-153">Это можно изменить, выбрав режим повторного вычисления вручную. Но при этом в том случае, если какие-либо значения в вычисляемом столбце окажутся неверными, столбец будет выделен серым и станет неактивным до того момента, пока данные не будут обновлены и повторно рассчитаны.</span><span class="sxs-lookup"><span data-stu-id="4308b-153">You can prevent this by setting the recalculation mode to manual; however, if any values in the calculated column are incorrect the column will be grayed out until you refresh and recalculate the data.</span></span>  
  
-   <span data-ttu-id="4308b-154">Если изменить или удалить связи между таблицами, то формулы, в которых используются столбцы из этих таблиц, могут стать неверными.</span><span class="sxs-lookup"><span data-stu-id="4308b-154">If you change or delete relationships between tables, formulas that use columns in those tables will become invalid.</span></span>  
  
-   <span data-ttu-id="4308b-155">При создании формулы, содержащей циклическую зависимость или зависимость со ссылкой на себя, возникнет ошибка.</span><span class="sxs-lookup"><span data-stu-id="4308b-155">If you create a formula that contains a circular or self-referencing dependency, an error will occur.</span></span>  
  
##  <a name="related-tasks"></a><a name="bkmk_rel_tasks"></a> <span data-ttu-id="4308b-156">Связанные задачи</span><span class="sxs-lookup"><span data-stu-id="4308b-156">Related Tasks</span></span>  
  
|<span data-ttu-id="4308b-157">Раздел</span><span class="sxs-lookup"><span data-stu-id="4308b-157">Topic</span></span>|<span data-ttu-id="4308b-158">Описание</span><span class="sxs-lookup"><span data-stu-id="4308b-158">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="4308b-159">Создание вычисляемого столбца (табличные службы SSAS)</span><span class="sxs-lookup"><span data-stu-id="4308b-159">Create a Calculated Column &#40;SSAS Tabular&#41;</span></span>](ssas-calculated-columns-create-a-calculated-column.md)|<span data-ttu-id="4308b-160">Задачи в данном разделе описывают добавление нового вычисляемого столбца в таблицу.</span><span class="sxs-lookup"><span data-stu-id="4308b-160">Tasks in this topic describe how to add a new calculated column to a table.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4308b-161">См. также:</span><span class="sxs-lookup"><span data-stu-id="4308b-161">See Also</span></span>  
 <span data-ttu-id="4308b-162">[Таблицы и столбцы &#40;табличные&#41;SSAS](tables-and-columns-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="4308b-162">[Tables and Columns &#40;SSAS Tabular&#41;](tables-and-columns-ssas-tabular.md) </span></span>  
 <span data-ttu-id="4308b-163">[Меры &#40;табличных&#41;SSAS](measures-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="4308b-163">[Measures &#40;SSAS Tabular&#41;](measures-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="4308b-164">Вычисления (табличные службы SSAS)</span><span class="sxs-lookup"><span data-stu-id="4308b-164">Calculations &#40;SSAS Tabular&#41;</span></span>](calculations-ssas-tabular.md)  
  
  
