---
title: Прогноз (средства анализа таблиц для Excel) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- Table Analysis tools
- forecasting
- mining model, time series
- time series [data mining]
ms.assetid: 22bb0b5e-78f5-484e-883d-2b5985a12749
author: minewiskan
ms.author: owend
ms.openlocfilehash: abca22dbcb9ae6426e839f92e391a658f5029e31
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656690"
---
# <a name="forecast-table-analysis-tools-for-excel"></a><span data-ttu-id="7d86a-102">Прогноз (средства анализа таблиц для Excel)</span><span class="sxs-lookup"><span data-stu-id="7d86a-102">Forecast (Table Analysis Tools for Excel)</span></span>
  <span data-ttu-id="7d86a-103">![Кнопка «Прогноз» на ленте «Средства анализа таблиц»](media/tat-forecast.gif "Кнопка «Прогноз» на ленте «Средства анализа таблиц»")</span><span class="sxs-lookup"><span data-stu-id="7d86a-103">![Forecast button in Table Analysis tools ribbon](media/tat-forecast.gif "Forecast button in Table Analysis tools ribbon")</span></span>  
  
 <span data-ttu-id="7d86a-104">Средство **прогнозирования** позволяет создавать прогнозы на основе данных в таблице данных Excel или другом источнике данных, а также при необходимости просматривать вероятности, связанные с каждым прогнозируемым значением.</span><span class="sxs-lookup"><span data-stu-id="7d86a-104">The **Forecast** tool helps you make predictions based on data in an Excel data table or other data source, and optionally view the probabilities associated with each predicted value.</span></span> <span data-ttu-id="7d86a-105">Например, если данные содержат столбец даты и столбец, показывающий объем продаж по каждому дню месяца, можно прогнозировать объем продаж на будущие дни.</span><span class="sxs-lookup"><span data-stu-id="7d86a-105">For example, if your data contains a date column and a column that shows total sales for each day of the month, you could predict the sales for future days.</span></span> <span data-ttu-id="7d86a-106">Также можно указать количество выполняемых прогнозов.</span><span class="sxs-lookup"><span data-stu-id="7d86a-106">You can also specify the number of predictions to make.</span></span> <span data-ttu-id="7d86a-107">Например, пять дней или тридцать.</span><span class="sxs-lookup"><span data-stu-id="7d86a-107">For example, you can predict five days, or thirty.</span></span>  
  
 <span data-ttu-id="7d86a-108">После завершения средства новые прогнозы добавятся в конец таблицы источника данных, а новые значения будут выделены цветом.</span><span class="sxs-lookup"><span data-stu-id="7d86a-108">When the tool completes, it appends the new predictions to the end of the source data table, and highlights the new values.</span></span> <span data-ttu-id="7d86a-109">Новые значения рядов времени не добавлены; это позволяет сначала предварительно просмотреть прогнозы.</span><span class="sxs-lookup"><span data-stu-id="7d86a-109">New time series values are not appended; this allows you to review the predictions first.</span></span>  
  
 <span data-ttu-id="7d86a-110">Средство также создает новый лист с именем « **отчет о прогнозировании**».</span><span class="sxs-lookup"><span data-stu-id="7d86a-110">The tool also creates a new worksheet named **Forecasting Report**.</span></span> <span data-ttu-id="7d86a-111">Этот лист сообщает об успешности создания прогноза мастером.</span><span class="sxs-lookup"><span data-stu-id="7d86a-111">This worksheet reports whether the wizard successfully created a prediction.</span></span> <span data-ttu-id="7d86a-112">Новый лист также содержит линейную диаграмму, показывающую тренды предыстории.</span><span class="sxs-lookup"><span data-stu-id="7d86a-112">The new worksheet also contains a line graph that shows the historical trends.</span></span>  
  
 <span data-ttu-id="7d86a-113">При расширении ряда времени для включения новых прогнозов прогнозируемые значения добавляются в линейную диаграмму.</span><span class="sxs-lookup"><span data-stu-id="7d86a-113">When you extend the time series to include the new predictions, the predicted values are added to the line graph.</span></span> <span data-ttu-id="7d86a-114">Значения с предысторией отображаются сплошной линией, а прогнозы — точечной.</span><span class="sxs-lookup"><span data-stu-id="7d86a-114">The historical values are shown as a solid line and the predictions are shown as a dotted line.</span></span>  
  
## <a name="using-the-forecast-tool"></a><span data-ttu-id="7d86a-115">Использование средства «Прогноз»</span><span class="sxs-lookup"><span data-stu-id="7d86a-115">Using the Forecast Tool</span></span>  
  
1.  <span data-ttu-id="7d86a-116">Откройте таблицу Excel, которая содержит прогнозируемые числовые данные.</span><span class="sxs-lookup"><span data-stu-id="7d86a-116">Open an Excel table that contains predictable numeric data.</span></span>  
  
2.  <span data-ttu-id="7d86a-117">На вкладке **анализ** щелкните **Прогноз** .</span><span class="sxs-lookup"><span data-stu-id="7d86a-117">Click **Forecast** on the **Analyze** tab.</span></span>  
  
3.  <span data-ttu-id="7d86a-118">Укажите столбцы для прогноза.</span><span class="sxs-lookup"><span data-stu-id="7d86a-118">Specify the columns to forecast.</span></span> <span data-ttu-id="7d86a-119">Средство автоматически выбирает столбцы в данных с прогнозируемым типом данных, то есть непрерывными числовыми данными.</span><span class="sxs-lookup"><span data-stu-id="7d86a-119">The tool automatically selects columns in the data that have a predictable data type-that is, continuous numeric data.</span></span> <span data-ttu-id="7d86a-120">Может оказаться, что применение этого средства не привело к выбору некоторых столбцов, которые содержат непрерывные числовые данные, если эти столбцы включают много значений NULL или нулевых значений, поскольку недостающие данные могут повлиять на результаты.</span><span class="sxs-lookup"><span data-stu-id="7d86a-120">The tool might not select some columns that have continuous numeric data if the columns contain many null or zero values, because the missing data might affect the results.</span></span> <span data-ttu-id="7d86a-121">В этом случае данные можно исправить с помощью средства [переразметка &#40;SQL Server надстройки интеллектуального анализа данных&#41;](relabel-sql-server-data-mining-add-ins.md) средстве.</span><span class="sxs-lookup"><span data-stu-id="7d86a-121">If this happens, you can fix the data by using the [Relabel &#40;SQL Server Data Mining Add-ins&#41;](relabel-sql-server-data-mining-add-ins.md) tool.</span></span>  
  
4.  <span data-ttu-id="7d86a-122">Укажите столбец, содержащий дату, время или другой идентификатор последовательности.</span><span class="sxs-lookup"><span data-stu-id="7d86a-122">Specify the column that contains the date, time, or other series identifier.</span></span> <span data-ttu-id="7d86a-123">При выборе параметра **\<no time stamp>** средство создаст ряд, основанный на последовательности строк в исходных данных.</span><span class="sxs-lookup"><span data-stu-id="7d86a-123">If you select the option **\<no time stamp>** the tool will create a series based on the sequence of rows in the source data.</span></span>  
  
5.  <span data-ttu-id="7d86a-124">Укажите количество выполняемых прогнозов.</span><span class="sxs-lookup"><span data-stu-id="7d86a-124">Specify the number of predictions to make.</span></span>  
  
6.  <span data-ttu-id="7d86a-125">Дополнительно можно предоставить алгоритму подсказку о том, будут ли данные повторяться еженедельно, ежемесячно или с иной периодичностью.</span><span class="sxs-lookup"><span data-stu-id="7d86a-125">Optionally, provide a hint to the algorithm about whether you expect your data to repeat weekly, monthly, or in other periods.</span></span> <span data-ttu-id="7d86a-126">Если данные не соответствуют ни одному из заданных шаблонов или отсутствуют какие бы то ни было закономерности, выберите, **\<detect automatically>** чтобы средство обнаружило повторяющиеся периоды времени.</span><span class="sxs-lookup"><span data-stu-id="7d86a-126">If your data does not fit any of the given patterns, or if you are unaware of any patterns, select **\<detect automatically>** to have the tool find the repeating time periods.</span></span>  
  
7.  <span data-ttu-id="7d86a-127">Мастер добавит прогнозы в таблицу источника и создаст отчет о прогнозе на новом листе.</span><span class="sxs-lookup"><span data-stu-id="7d86a-127">The wizard adds the predictions to the source table, and creates a forecasting report in a new worksheet.</span></span>  
  
8.  <span data-ttu-id="7d86a-128">Для добавления новых значений в диаграмму прогнозирования расширьте временной ряд, чтобы включить спрогнозированные значения.</span><span class="sxs-lookup"><span data-stu-id="7d86a-128">To add the new values to the prediction graph, extend the time series to include the forecasted values.</span></span>  
  
### <a name="requirements"></a><span data-ttu-id="7d86a-129">Требования</span><span class="sxs-lookup"><span data-stu-id="7d86a-129">Requirements</span></span>  
 <span data-ttu-id="7d86a-130">Столбец для прогнозирования должен содержать непрерывные числовые данные, например данные типа валюты или другого числового типа.</span><span class="sxs-lookup"><span data-stu-id="7d86a-130">The columns that you predict must contain continuous numeric data, such as currency or other numbers.</span></span>  
  
 <span data-ttu-id="7d86a-131">По возможности данные должны также включать столбец, содержащий ряд времени или даты.</span><span class="sxs-lookup"><span data-stu-id="7d86a-131">If possible, your data should also include a column that contains a series of times or dates.</span></span> <span data-ttu-id="7d86a-132">Вместо данных даты и времени можно использовать числовые ряды (1, 2, 3....).</span><span class="sxs-lookup"><span data-stu-id="7d86a-132">You can use a numeric series (1,2,3....) instead of date and time data.</span></span> <span data-ttu-id="7d86a-133">Однако значения в столбце последовательности должны быть уникальны.</span><span class="sxs-lookup"><span data-stu-id="7d86a-133">However, values in the series column must be unique.</span></span> <span data-ttu-id="7d86a-134">Если средство **прогнозирования** находит дублирующиеся значения в столбце ряда, возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="7d86a-134">An error occurs if the **Forecast** tool finds duplicate values in the series column.</span></span>  
  
 <span data-ttu-id="7d86a-135">Вы не можете предсказать дату с помощью средства **прогнозирования** .</span><span class="sxs-lookup"><span data-stu-id="7d86a-135">You cannot predict a date by using the **Forecast** tool.</span></span> <span data-ttu-id="7d86a-136">Хотя ошибка может и не произойти, данный алгоритм не предназначен для использования дат в качестве прогнозируемых значений.</span><span class="sxs-lookup"><span data-stu-id="7d86a-136">Although an error might not occur, this algorithm is not designed to use dates as predictable values.</span></span>  
  
### <a name="understanding-time-stamps"></a><span data-ttu-id="7d86a-137">Основные сведения о временных метках</span><span class="sxs-lookup"><span data-stu-id="7d86a-137">Understanding Time Stamps</span></span>  
 <span data-ttu-id="7d86a-138">Необходимо указать столбец для использования в качестве *отметки времени*.</span><span class="sxs-lookup"><span data-stu-id="7d86a-138">You must identify a column to use as a *time stamp*.</span></span> <span data-ttu-id="7d86a-139">Временная метка служит для двух целей.</span><span class="sxs-lookup"><span data-stu-id="7d86a-139">The time stamp serves two purposes.</span></span> <span data-ttu-id="7d86a-140">Во-первых, однозначно определяет значение во временном ряду.</span><span class="sxs-lookup"><span data-stu-id="7d86a-140">First, it uniquely identifies a value in a time series.</span></span> <span data-ttu-id="7d86a-141">Например, если рассматриваются данные о продажах за день, должно существовать только одно значение о продажах за каждый день.</span><span class="sxs-lookup"><span data-stu-id="7d86a-141">For example, if you are tracking sales on a daily basis, you should have only one sales value for each day.</span></span> <span data-ttu-id="7d86a-142">В качестве временной метки может использоваться календарная дата.</span><span class="sxs-lookup"><span data-stu-id="7d86a-142">The calendar date can be used as the time stamp.</span></span> <span data-ttu-id="7d86a-143">Во-вторых, столбец временной метки указывает, какая единица измерения применяется для выполнения прогнозов.</span><span class="sxs-lookup"><span data-stu-id="7d86a-143">Second, the time stamp column indicates the unit for making predictions.</span></span> <span data-ttu-id="7d86a-144">Если отслеживаются результаты продажи за день, в прогнозах в качестве единиц измерения также должны использоваться дни.</span><span class="sxs-lookup"><span data-stu-id="7d86a-144">If you are tracking daily sales, your predictions will also be in units of days.</span></span>  
  
 <span data-ttu-id="7d86a-145">Если данные не имеют столбца даты или времени, данное средство автоматически создаст временный ключевой столбец с именем _RowIndex.</span><span class="sxs-lookup"><span data-stu-id="7d86a-145">If your data does not include a date or time column, the tool will automatically create a temporary series key, named _RowIndex.</span></span> <span data-ttu-id="7d86a-146">Этот ключ будет основан на порядке строк в наборе данных.</span><span class="sxs-lookup"><span data-stu-id="7d86a-146">The key will be based on the order of the rows in the data set.</span></span>  
  
 <span data-ttu-id="7d86a-147">При указании количества прогнозов необходимо ввести целое число, которое указывает количество шагов.</span><span class="sxs-lookup"><span data-stu-id="7d86a-147">When you specify the number of predictions, you enter a whole number that indicates the number of steps.</span></span> <span data-ttu-id="7d86a-148">Величина этих шагов зависит от единиц измерения, используемых в исходных данных для ряда времени и дат.</span><span class="sxs-lookup"><span data-stu-id="7d86a-148">The units for these steps depend on the units used in the time and date series in your data.</span></span> <span data-ttu-id="7d86a-149">Если данные содержат результаты продаж за месяц, прогноз будет выполнен для ряда месяцев.</span><span class="sxs-lookup"><span data-stu-id="7d86a-149">If your data lists sales results by the month, the prediction will be for a series of months.</span></span> <span data-ttu-id="7d86a-150">Выбранную единицу измерения времени нельзя изменить до тех пор, пока не изменится источник данных.</span><span class="sxs-lookup"><span data-stu-id="7d86a-150">You cannot change the units of time unless you change the source data.</span></span>  
  
### <a name="understanding-periodicity"></a><span data-ttu-id="7d86a-151">Основные сведения о периодичности</span><span class="sxs-lookup"><span data-stu-id="7d86a-151">Understanding Periodicity</span></span>  
 <span data-ttu-id="7d86a-152">В основе прогноза лежит выявление закономерностей, повторяющихся в течение определенного периода времени.</span><span class="sxs-lookup"><span data-stu-id="7d86a-152">A forecast is based on repeating patterns over a period of time.</span></span> <span data-ttu-id="7d86a-153">Поэтому в алгоритме временных рядов (Майкрософт) выполняются вычисления, чтобы определить периоды времени, имеющие наиболее ярко выраженные закономерности.</span><span class="sxs-lookup"><span data-stu-id="7d86a-153">Therefore, the Microsoft Time Series algorithm performs calculations to determine the time periods that have the strongest patterns.</span></span> <span data-ttu-id="7d86a-154">*Периодичность* относится к этим периодам времени.</span><span class="sxs-lookup"><span data-stu-id="7d86a-154">*Periodicity* refers to these time periods.</span></span>  
  
 <span data-ttu-id="7d86a-155">Временной ряд может содержать много потенциальных закономерностей.</span><span class="sxs-lookup"><span data-stu-id="7d86a-155">A time series can contain many potential patterns.</span></span> <span data-ttu-id="7d86a-156">Если есть уверенность в том, что какие-то конкретные данные содержат определенную закономерность, можно попытаться улучшить качество прогноза путем предоставления подсказки алгоритму.</span><span class="sxs-lookup"><span data-stu-id="7d86a-156">If you are certain that your data contains a certain pattern, you may be able to improve the quality of prediction by providing a hint to the algorithm.</span></span>  
  
 <span data-ttu-id="7d86a-157">Например, если предполагается, что данные повторяются еженедельно, можно выбрать значение «Еженедельно», чтобы указать, что алгоритм должен искать еженедельные закономерности.</span><span class="sxs-lookup"><span data-stu-id="7d86a-157">For example, if you expect that your data repeats on a weekly basis, you can select Weekly to indicate that the algorithm should look for weekly patterns.</span></span> <span data-ttu-id="7d86a-158">Но, если какие-либо ярко выраженные еженедельные закономерности не будут найдены, алгоритм не будет учитывать подсказку.</span><span class="sxs-lookup"><span data-stu-id="7d86a-158">However, if no strong weekly patterns are found, the algorithm will ignore the hint.</span></span>  
  
## <a name="understanding-the-forecasting-report"></a><span data-ttu-id="7d86a-159">Основные сведения о прогнозирующем отчете</span><span class="sxs-lookup"><span data-stu-id="7d86a-159">Understanding the Forecasting Report</span></span>  
 <span data-ttu-id="7d86a-160">На этой диаграмме исторические данные из таблицы данных отображаются темной линией.</span><span class="sxs-lookup"><span data-stu-id="7d86a-160">In this graph, the historical values from your data table appear as a dark line.</span></span> <span data-ttu-id="7d86a-161">Прогнозируемые значения отображаются пунктирными линиями.</span><span class="sxs-lookup"><span data-stu-id="7d86a-161">The predicted values appear as dotted lines.</span></span> <span data-ttu-id="7d86a-162">Можно щелкнуть по точке на линии для просмотра прогнозируемого значения.</span><span class="sxs-lookup"><span data-stu-id="7d86a-162">You can click a point on the line to see the forecasted value.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d86a-163">Если на оси времени для прогнозируемых значений на диаграмме не отображаются метки, откройте лист, содержащий прогнозируемые значения, и используйте функцию **Fill, Series** в Excel, чтобы расширить столбец временных меток, чтобы включить прогнозируемые значения.</span><span class="sxs-lookup"><span data-stu-id="7d86a-163">If you do not see labels on the time axis for the predicted values in the graph, open the worksheet that contains the predicted values, and use the **Fill, Series** function in Excel to extend the time stamp column to include the predicted values.</span></span>  
  
 <span data-ttu-id="7d86a-164">Иногда прогнозу может не хватать необходимого количества временных срезов.</span><span class="sxs-lookup"><span data-stu-id="7d86a-164">In some cases, the forecast may not have as many time slices as requested.</span></span> <span data-ttu-id="7d86a-165">Обычно это означает, что алгоритму недостаточно данных для прогноза на более продолжительное время.</span><span class="sxs-lookup"><span data-stu-id="7d86a-165">This usually means that data was insufficient to allow the algorithm to forecast that far into the future.</span></span> <span data-ttu-id="7d86a-166">Средство **прогнозирования** будет выполнять только прогнозы, соответствующие минимальному пороговому значению вероятности.</span><span class="sxs-lookup"><span data-stu-id="7d86a-166">The **Forecast** tool will only make predictions that meet a minimum probability threshold.</span></span>  
  
## <a name="related-tools"></a><span data-ttu-id="7d86a-167">Дополнительные средства</span><span class="sxs-lookup"><span data-stu-id="7d86a-167">Related Tools</span></span>  
 <span data-ttu-id="7d86a-168">Клиент интеллектуального анализа данных для Excel, который является отдельной надстройкой, обеспечивающей расширенную функциональность интеллектуального анализа данных, также содержит мастер прогноза.</span><span class="sxs-lookup"><span data-stu-id="7d86a-168">The Data Mining Client for Excel, which is a separate add-in that provides more advanced data mining functionality, also contains a wizard for forecasting.</span></span>  
  
 <span data-ttu-id="7d86a-169">Как средство **прогнозирования** (в средствах анализа таблиц для Excel), так и мастер **прогнозов** (в клиенте интеллектуального анализа данных для Excel) используют [!INCLUDE[msCoName](../includes/msconame-md.md)] алгоритм временных рядов.</span><span class="sxs-lookup"><span data-stu-id="7d86a-169">Both the **Forecast** tool (in the Table Analysis Tools for Excel) and the **Forecast** wizard (in the Data Mining Client for Excel) use the [!INCLUDE[msCoName](../includes/msconame-md.md)] Time Series algorithm.</span></span>  
  
-   <span data-ttu-id="7d86a-170">Средство **прогнозирования** проще в использовании, так как оно автоматически настраивает алгоритм для использования параметров, наиболее подходящих для ваших данных.</span><span class="sxs-lookup"><span data-stu-id="7d86a-170">The **Forecast** tool is easier to use because it automatically configures the algorithm to use the settings that are best for your data.</span></span>  
  
-   <span data-ttu-id="7d86a-171">Мастер **прогнозов** в клиенте интеллектуального анализа данных для Excel предоставляет возможность настройки параметров.</span><span class="sxs-lookup"><span data-stu-id="7d86a-171">The **Forecast** wizard in the Data Mining Client for Excel provides you with the ability to customize the parameters.</span></span>  
  
 <span data-ttu-id="7d86a-172">Дополнительные сведения о мастере **прогнозов** см. в разделе [мастер прогнозов &#40;надстройки интеллектуального анализа данных для&#41;Excel ](forecast-wizard-data-mining-add-ins-for-excel.md).</span><span class="sxs-lookup"><span data-stu-id="7d86a-172">For more information about the **Forecast** wizard, see [Forecast Wizard &#40;Data Mining Add-ins for Excel&#41;](forecast-wizard-data-mining-add-ins-for-excel.md).</span></span> <span data-ttu-id="7d86a-173">Дополнительные сведения об алгоритме прогнозирования см. в разделе «Алгоритм временных рядов (Майкрософт)» электронной документации по [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d86a-173">For more information about the algorithm used for forecasting, see the topic "Microsoft Time Series Algorithm" in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Books Online.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7d86a-174">См. также:</span><span class="sxs-lookup"><span data-stu-id="7d86a-174">See Also</span></span>  
 [<span data-ttu-id="7d86a-175">Средства анализа таблиц для Excel</span><span class="sxs-lookup"><span data-stu-id="7d86a-175">Table Analysis Tools for Excel</span></span>](table-analysis-tools-for-excel.md)  
  
  
