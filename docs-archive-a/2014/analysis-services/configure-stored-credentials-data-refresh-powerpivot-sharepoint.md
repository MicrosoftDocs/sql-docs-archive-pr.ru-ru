---
title: Настройка сохраненных учетных данных для обновления данных PowerPivot (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 987eff0f-bcfe-4bbd-81e0-9aca993a2a75
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5a1350c5d776891397401e9d3127b7849281b106
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656751"
---
# <a name="configure-stored-credentials-for-powerpivot-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="53551-102">Настройка сохраненных учетных данных для обновления данных PowerPivot (PowerPivot для SharePoint)</span><span class="sxs-lookup"><span data-stu-id="53551-102">Configure Stored Credentials for PowerPivot Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="53551-103">Задания обновления данных PowerPivot могут работать от любой учетной записи Windows, если в службе Secure Store создано целевое приложение для сохранения нужных учетных данных.</span><span class="sxs-lookup"><span data-stu-id="53551-103">PowerPivot data refresh jobs can run under any Windows user account as long as you create a target application in Secure Store Service to store the credentials you want to use.</span></span> <span data-ttu-id="53551-104">Аналогичным образом, если нужно предоставить имя входа базы данных, отличное от указанного при первоначальном импорте данных в PowerPivot для Excel, то эти учетные данные можно сопоставить с целевым приложением службы Secure Store, а затем указать это целевое приложение в расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-104">Similarly, if you want to provide a database login that varies from the one used to originally import the data in PowerPivot for Excel, you can map those credentials to a Secure Store Service target application, and then specify that target application in a data refresh schedule.</span></span>  
  
 <span data-ttu-id="53551-105">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="53551-105">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="53551-106">Придерживаясь инструкций, приведенных в этом разделе, можно получить возможность использовать следующий вариант задания учетных данных на странице расписания обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="53551-106">After you follow the instructions in this topic, you will be able to use the following credentials option in the PowerPivot data refresh schedule page:</span></span>  
  
 <span data-ttu-id="53551-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span><span class="sxs-lookup"><span data-stu-id="53551-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span></span>  
  
 <span data-ttu-id="53551-108">В этом разделе описано, как настроить имена пользователей и пароли, используемые при выполнении операции обновления данных PowerPivot в ферме SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="53551-108">This topic explains how to set up the user names and passwords that are used for PowerPivot data refresh in a SharePoint 2010 farm.</span></span> <span data-ttu-id="53551-109">Прежде чем можно будет переходить к этим шагам, необходимо включить службу Secure Store и создать главный ключ.</span><span class="sxs-lookup"><span data-stu-id="53551-109">Before you can use these steps, you must have enabled Secure Store Service and generated a master key.</span></span> <span data-ttu-id="53551-110">Дополнительные сведения см. [в статье обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) .</span><span class="sxs-lookup"><span data-stu-id="53551-110">For more information, see [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span></span>  
  
 <span data-ttu-id="53551-111">Этот раздел состоит из следующих подразделов.</span><span class="sxs-lookup"><span data-stu-id="53551-111">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="53551-112">Настройка любой учетной записи Windows для обновления данных</span><span class="sxs-lookup"><span data-stu-id="53551-112">Configure any Windows account for data refresh</span></span>](#configAny)  
  
 [<span data-ttu-id="53551-113">Настройка стандартной учетной записи для доступа к внешним источникам данных или источникам данных сторонних поставщиков</span><span class="sxs-lookup"><span data-stu-id="53551-113">Configure a predefined account for accessing external or third-party data sources</span></span>](#config3rd)  
  
 <span data-ttu-id="53551-114">Если у вас возникли проблемы при настройке или использовании обновления данных, ознакомьтесь со статьей [Устранение неполадок с обновлением данных PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) на вики-сайте TechNet, чтобы получить возможные решения.</span><span class="sxs-lookup"><span data-stu-id="53551-114">If you have problems configuring or using data refresh, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>  
  
##  <a name="configure-any-windows-account-for-data-refresh"></a><a name="configAny"></a><span data-ttu-id="53551-115">Настройка любой учетной записи Windows для обновления данных</span><span class="sxs-lookup"><span data-stu-id="53551-115">Configure any Windows account for data refresh</span></span>  
 <span data-ttu-id="53551-116">Если пользователь SharePoint задает расписание обновления данных, он должен указать идентификатор пользователя, под которым выполняется обновление данных.</span><span class="sxs-lookup"><span data-stu-id="53551-116">When a SharePoint user defines a data refresh schedule, he or she must specify the user identity under which data refresh is performed.</span></span> <span data-ttu-id="53551-117">Среди вариантов — выбор учетной записи автоматического обновления данных PowerPivot, ввод собственной учетной записи пользователя домена Windows или ввод другой учетной записи пользователя Windows, которая подходит для обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-117">Options include selecting the PowerPivot unattended data refresh account, entering his or her Windows domain user account, or entering some other Windows user account that is valid for data refresh purposes.</span></span> <span data-ttu-id="53551-118">Шаги в этом разделе предназначены для последнего варианта: указания другой учетной записи Windows.</span><span class="sxs-lookup"><span data-stu-id="53551-118">The steps in this section are for the last option: specifying some other Windows account.</span></span>  
  
 <span data-ttu-id="53551-119">Этот способ можно выбрать, если нужна альтернатива использованию учетной записи автоматического обновления данных PowerPivot (доступно всем пользователям PowerPivot на SharePoint) или учетных данных владельца книги.</span><span class="sxs-lookup"><span data-stu-id="53551-119">You might choose this approach if you want an alternative to using the PowerPivot unattended data refresh account (available to all PowerPivot users on SharePoint) or the credentials of the workbook owner.</span></span> <span data-ttu-id="53551-120">Например, можно создать несколько учетных записей обновления данных, доступных для разных рабочих групп, что помогает управлять процессом обновления данных на уровне организации.</span><span class="sxs-lookup"><span data-stu-id="53551-120">For example, you might want to make a series of data refresh accounts available to different workgroups to help you track and manage data refresh activity at the organizational level.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="53551-121">Пользователи и приложения, которые используют это целевое приложение (и хранящиеся в нем учетные данные) должны быть перечислены в списке членов этого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-121">People and applications that use this target application (and the credentials that it stores) must be listed as members of the application.</span></span> <span data-ttu-id="53551-122">В этот список должно быть добавлено удостоверение каждого приложения службы PowerPivot, которое будет использовать целевое приложение, ваша учетная запись Windows и группа учетных записей пользователей, которые будут указывать это целевое приложение в своих расписаниях обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-122">You must add the identity of each PowerPivot service application that will use the target application, your Windows account, and the group or user accounts of people who will be specifying this target application in their data refresh schedules.</span></span> <span data-ttu-id="53551-123">Можно указать все эти учетные записи при создании целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-123">You can specify all of these accounts when you create the target application.</span></span> <span data-ttu-id="53551-124">Если все пользователи и группы, которым потребуется доступ к этому приложению, заранее неизвестны, их можно будет добавить позже, после создания целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-124">If you do not know all of the user and group accounts that will require access to this application, you can add them later after the target application is created.</span></span>  
  
 <span data-ttu-id="53551-125">Настройка сохраненных учетных данных для обновления данных состоит из следующих четырех частей.</span><span class="sxs-lookup"><span data-stu-id="53551-125">There are 4 parts to configuring stored credentials for data refresh:</span></span>  
  
-   <span data-ttu-id="53551-126">Создание целевого приложения, которое сохраняет учетные данные.</span><span class="sxs-lookup"><span data-stu-id="53551-126">Create the target application that stores the credentials.</span></span>  
  
-   <span data-ttu-id="53551-127">Предоставьте учетной записи разрешения «Участие».</span><span class="sxs-lookup"><span data-stu-id="53551-127">Grant Contribute permissions to the account.</span></span>  
  
-   <span data-ttu-id="53551-128">Предоставьте учетной записи разрешения на чтение для обеспечения доступа к внешним источникам данных при обновлении данных.</span><span class="sxs-lookup"><span data-stu-id="53551-128">Grant the account read permissions to access external data sources during data refresh.</span></span>  
  
-   <span data-ttu-id="53551-129">Проверка того, работает ли обновление данных при указании этого целевого приложения в расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-129">Verify that data refresh works when you specify this target application in a data refresh schedule.</span></span>  
  
### <a name="step-1-create-a-target-application"></a><span data-ttu-id="53551-130">Шаг 1. Создание целевого приложения</span><span class="sxs-lookup"><span data-stu-id="53551-130">Step 1: Create a target application</span></span>  
  
1.  <span data-ttu-id="53551-131">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="53551-131">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="53551-132">Щелкните **Служба Secure Store**.</span><span class="sxs-lookup"><span data-stu-id="53551-132">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="53551-133">В окне Управление целевыми приложениями нажмите кнопку **создать**.</span><span class="sxs-lookup"><span data-stu-id="53551-133">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="53551-134">В поле «Идентификатор целевого приложения» введите текстовую строку.</span><span class="sxs-lookup"><span data-stu-id="53551-134">In Target application ID, type a text string.</span></span> <span data-ttu-id="53551-135">Строка должна быть уникальной, но легко запоминающейся.</span><span class="sxs-lookup"><span data-stu-id="53551-135">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="53551-136">Пользователи будут вводить эту строку на страницах расписания обновления данных, когда им потребуется использование учетных данных, хранящихся в этом приложении.</span><span class="sxs-lookup"><span data-stu-id="53551-136">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="53551-137">В поле «Отображаемое имя» введите описательное имя.</span><span class="sxs-lookup"><span data-stu-id="53551-137">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="53551-138">Это имя используется только для отображения.</span><span class="sxs-lookup"><span data-stu-id="53551-138">This name is used for display purposes only.</span></span> <span data-ttu-id="53551-139">Она не используется для указания целевого приложения в расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-139">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="53551-140">В поле «Адрес электронной почты» введите адрес.</span><span class="sxs-lookup"><span data-stu-id="53551-140">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="53551-141">В списке Тип целевого приложения выберите **Группа**.</span><span class="sxs-lookup"><span data-stu-id="53551-141">In Target Application Type, select **Group**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="53551-142">Выбор типа учетной записи «Групповой» является необходимым, поскольку такой выбор позволяет указать все учетные записи пользователей и служб, которым требуется доступ к этим учетным данным.</span><span class="sxs-lookup"><span data-stu-id="53551-142">Choosing a Group account type is necessary because it allows you to specify all of the user and service accounts requesting access to the credentials.</span></span> <span data-ttu-id="53551-143">Применительно к каждому запросу системная служба PowerPivot проверяет, является ли запрашивающий объект членом целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-143">For each request, PowerPivot System Service verifies whether the requestor is a member of the target application.</span></span>  
  
8.  <span data-ttu-id="53551-144">Пропустите URL-адрес страницы целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-144">Skip Target Application Page URL.</span></span> <span data-ttu-id="53551-145">Обновление данных PowerPivot не использует его.</span><span class="sxs-lookup"><span data-stu-id="53551-145">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="53551-146">Щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="53551-146">Click **Next**.</span></span>  
  
10. <span data-ttu-id="53551-147">На странице **Укажите поля учетных данных для целевого приложения Secure Store** примите значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="53551-147">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values.</span></span> <span data-ttu-id="53551-148">Имена полей и типы должны быть следующими: «Имя пользователя Windows» и «Пароль Windows».</span><span class="sxs-lookup"><span data-stu-id="53551-148">Field names and types should be Windows User Name and Windows Password.</span></span>  
  
11. <span data-ttu-id="53551-149">Нажмите кнопку "Далее".</span><span class="sxs-lookup"><span data-stu-id="53551-149">Click Next.</span></span>  
  
12. <span data-ttu-id="53551-150">В поле «Администраторы целевых приложений» укажите учетные записи пользователей домена Windows для пользователей SharePoint, которые должны иметь права администратора для доступа к настройкам целевого приложения (например, способность добавлять или удалять учетные записи в списке членов).</span><span class="sxs-lookup"><span data-stu-id="53551-150">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to target application settings (for example, the ability to add or remove accounts from the Members list).</span></span>  
  
13. <span data-ttu-id="53551-151">В поле «Члены» добавьте следующие учетные записи пользователя и группы.</span><span class="sxs-lookup"><span data-stu-id="53551-151">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="53551-152">В качестве создателя приложения добавьте в список свою учетную запись пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="53551-152">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="53551-153">Добавьте удостоверение пула приложений для приложения службы PowerPivot, чтобы оно могло извлекать учетные данные в момент запланированного запуска обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-153">Add the application pool identity of the PowerPivot service application so that it can retrieve the credentials when data refresh is scheduled to run.</span></span> <span data-ttu-id="53551-154">Чтобы просмотреть удостоверение пула приложений, перейдите к разделу **Управление приложениями службы**, выберите приложение службы PowerPivot, щелкнув пустое пространство рядом с именем (выбирает строку) и нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="53551-154">To view the application pool identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="53551-155">Учетная запись безопасности, отображаемая на этой странице, — это учетная запись, добавляемая в качестве члена целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-155">The security account that appears on this page is the account to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="53551-156">Добавьте учетные записи пользователей и групп Windows, которые будут входить в это целевое приложение в расписаниях обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-156">Add Windows user and group accounts that will be entering this target application in data refresh schedules.</span></span>  
  
14. <span data-ttu-id="53551-157">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="53551-157">Click **OK**.</span></span>  
  
15. <span data-ttu-id="53551-158">Выберите только что созданное целевое приложение, нажмите кнопку со стрелкой вниз и выберите **задать учетные данные.**</span><span class="sxs-lookup"><span data-stu-id="53551-158">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="53551-159">Обратите внимание на то, что в разделе «Владелец учетных данных» список владельцев учетных данных предназначен только для чтения.</span><span class="sxs-lookup"><span data-stu-id="53551-159">In Credential Owner, notice that the list of credential owners is read-only.</span></span> <span data-ttu-id="53551-160">Учетные записи, имеющие право владения этими учетными данными, являются членами целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-160">The accounts who have ownership over the credentials are the members of the target application.</span></span> <span data-ttu-id="53551-161">Для добавления или удаления владельцев учетных данных необходимо добавлять или удалять учетные записи в списке членов целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-161">To add or remove a credential owner, you must add or remove accounts from the target application members list.</span></span>  
  
     <span data-ttu-id="53551-162">В полях «Имя пользователя Windows» и «Пароль Windows» введите учетные данные той учетной записи пользователя Windows, которая будет служить для запуска обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-162">In Windows User Name and Windows Password, type credentials of Windows user account that will be used to run data refresh.</span></span>  
  
17. <span data-ttu-id="53551-163">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="53551-163">Click **OK**.</span></span>  
  
###  <a name="step-2-grant-contribute-permissions-to-the-account"></a><a name="bkmk_grant"></a><span data-ttu-id="53551-164">Шаг 2. предоставление разрешения на участие в учетной записи</span><span class="sxs-lookup"><span data-stu-id="53551-164">Step 2: Grant Contribute permissions to the account</span></span>  
 <span data-ttu-id="53551-165">Прежде чем появится возможность использовать сохраненные учетные данные, учетной записи необходимо назначить разрешения «Участие» во всех книгах PowerPivot, где она будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="53551-165">Before you can use the stored credentials, the account must be assigned Contribute permissions on any PowerPivot workbook for which it is used.</span></span> <span data-ttu-id="53551-166">Этот уровень разрешений необходим для открытия книги из библиотеки и сохранения книги в библиотеке после обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-166">This permission level is necessary to open the workbook from a library and then save it back to the library after the data is refreshed.</span></span>  
  
 <span data-ttu-id="53551-167">Назначение разрешений выполняется администратором семейства веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="53551-167">Assigning permissions is a step that is performed by the site collection administrator.</span></span> <span data-ttu-id="53551-168">Разрешения SharePoint можно назначать в корневом семействе сайтов или на любом уровне ниже, включая уровень отдельных документов и элементов.</span><span class="sxs-lookup"><span data-stu-id="53551-168">SharePoint permissions can be assigned at the root site collection or at any level below that, including on individual documents and items.</span></span> <span data-ttu-id="53551-169">Порядок задания разрешений зависит от требуемой гранулярности разрешений.</span><span class="sxs-lookup"><span data-stu-id="53551-169">How you set permissions will vary depending on how granular you need them to be.</span></span> <span data-ttu-id="53551-170">В следующих действиях показан один из способов предоставления разрешений.</span><span class="sxs-lookup"><span data-stu-id="53551-170">The following steps show you one approach for granting permissions.</span></span>  
  
1.  <span data-ttu-id="53551-171">На сайте SharePoint в меню Действия сайта выберите **разрешения сайта**.</span><span class="sxs-lookup"><span data-stu-id="53551-171">On a SharePoint site, in Site Actions, click **Site Permissions**.</span></span>  
  
2.  <span data-ttu-id="53551-172">Нажмите кнопку **Предоставить разрешения**.</span><span class="sxs-lookup"><span data-stu-id="53551-172">Click **Grant Permissions**.</span></span>  
  
3.  <span data-ttu-id="53551-173">В поле «Выберите пользователей» введите имя учетной записи пользователя домена Windows, которая указана в целевом приложении.</span><span class="sxs-lookup"><span data-stu-id="53551-173">In Select users, type the name of the Windows domain user account that you specified in the target application.</span></span>  
  
4.  <span data-ttu-id="53551-174">В окне предоставление разрешений выберите **предоставить разрешения пользователям напрямую**.</span><span class="sxs-lookup"><span data-stu-id="53551-174">In Grant Permissions, select **Grant users permission directly**.</span></span>  
  
5.  <span data-ttu-id="53551-175">Выберите элемент **Contribute**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="53551-175">Select **Contribute**, and then click **OK**.</span></span>  
  
###  <a name="step-3-grant-read-permissions-to-access-external-data-sources-used-in-data-refresh"></a><a name="bkmk_dbread"></a><span data-ttu-id="53551-176">Шаг 3. Предоставление разрешений на чтение для доступа к внешним источникам данных, используемым при обновлении данных</span><span class="sxs-lookup"><span data-stu-id="53551-176">Step 3: Grant read permissions to access external data sources used in data refresh</span></span>  
 <span data-ttu-id="53551-177">При импорте данных в книгу PowerPivot соединения с внешними данными часто основываются на доверенных соединениях или олицетворенных подключениях, использующих идентификатор текущего пользователя для подключения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="53551-177">When importing data into a PowerPivot workbook, connections to external data are often based on trusted connections or impersonated connections that use the identity of the current user to connect to the data source.</span></span> <span data-ttu-id="53551-178">Эти типы подключений работают только тогда, когда текущий пользователь имеет разрешение на чтение данных, которые импортирует.</span><span class="sxs-lookup"><span data-stu-id="53551-178">These types of connections work only when the current user has permission to read the data that he or she is importing.</span></span>  
  
 <span data-ttu-id="53551-179">В сценарии обновления данных для обновления данных повторно используется та же строка подключения, которая использовалась для импорта данных.</span><span class="sxs-lookup"><span data-stu-id="53551-179">In a data refresh scenario, the same connection string that was used to import data is now reused to refresh the data.</span></span> <span data-ttu-id="53551-180">Если строка подключения предполагает текущего пользователя (например, включает параметр Integrated_Security=SSPI), то системная служба PowerPivot передает идентификатор пользователя, указанный в целевом приложении в качестве текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="53551-180">If the connection string assumes the current user (for example, a string that includes Integrated_Security=SSPI), then the PowerPivot System Service will pass the user identity specified in the target application as the current user.</span></span> <span data-ttu-id="53551-181">Это соединение завершится успешно только в том случае, если учетная запись имеет разрешения на чтение для внешнего источника данных.</span><span class="sxs-lookup"><span data-stu-id="53551-181">This connection will only succeed if the account has read permissions on the external data source.</span></span>  
  
 <span data-ttu-id="53551-182">По этой причине необходимо предоставить учетной записи разрешения только на чтение для всех внешних источников данных, используемых при обновлении данных.</span><span class="sxs-lookup"><span data-stu-id="53551-182">For this reason, you must grant the account read-only permissions on all of the external data sources that are used during data refresh.</span></span>  
  
 <span data-ttu-id="53551-183">Администратор источников данных, используемых в организации, может создать имя входа и назначить необходимые разрешения.</span><span class="sxs-lookup"><span data-stu-id="53551-183">If you are an administrator of the data sources used in your organization, you can create a login and assign the necessary permissions.</span></span> <span data-ttu-id="53551-184">В противном случае необходимо обратиться к владельцам данных и получить сведения об учетной записи.</span><span class="sxs-lookup"><span data-stu-id="53551-184">Otherwise, you must contact the data owners and provide the account information.</span></span> <span data-ttu-id="53551-185">Обязательно укажите учетную запись пользователя домена Windows, которая отображается на целевое приложение.</span><span class="sxs-lookup"><span data-stu-id="53551-185">Be sure to specify the Windows domain user account that maps to the target application.</span></span> <span data-ttu-id="53551-186">Это учетная запись, указанная в разделе «Шаг 1. Создание целевого приложения» этого раздела.</span><span class="sxs-lookup"><span data-stu-id="53551-186">This is the account you specified in "Step 1: Create a target application" in this topic.</span></span>  
  
###  <a name="step-4-verify-account-availability-in-data-refresh-configuration-pages"></a><a name="bkmk_verify"></a><span data-ttu-id="53551-187">Шаг 4. Проверка доступности учетной записи на страницах конфигурации обновления данных</span><span class="sxs-lookup"><span data-stu-id="53551-187">Step 4: Verify account availability in data refresh configuration pages</span></span>  
  
1.  <span data-ttu-id="53551-188">Откройте страницу настройки обновления данных для опубликованной книги, которая содержит данные PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="53551-188">Open a data refresh configuration page for a published workbook that contains PowerPivot data.</span></span> <span data-ttu-id="53551-189">Инструкции по открытию страницы см. в разделе [планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="53551-189">For instructions on how to open the page, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="53551-190">Убедитесь в том, что параметр **подключиться с использованием учетных данных, сохраненных в Служба Secure Store (SSS) для входа в источник данных** включен на странице Конфигурация обновления данных, а затем введите имя целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-190">Verify that the **Connect using the credentials saved in Secure Store Service (SSS) to log on to the data source** option is enabled in the data refresh configuration page, and then enter the name of the target application.</span></span>  
  
3.  <span data-ttu-id="53551-191">Установите флажок **также обновлять как можно скорее** , а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="53551-191">Select the **Also refresh as soon as possible** checkbox, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="53551-192">В библиотеке, содержащей книгу, выберите книгу, щелкните стрелку вниз, которая отображается справа, а затем выберите **Управление обновлением данных PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="53551-192">In the library that contains the workbook, select the workbook, click the down arrow that appears to right, and then select **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="53551-193">Может потребоваться подождать в течение нескольких минут, если задание обновления данных возвращает большой объем данных.</span><span class="sxs-lookup"><span data-stu-id="53551-193">You might need to wait several minutes if the data refresh job is returning a large amount of data.</span></span>  
  
 <span data-ttu-id="53551-194">При возникновении ошибки можно нажать кнопку **настроить расписание** на странице Журнал обновления данных, чтобы попробовать использовать другие учетные данные.</span><span class="sxs-lookup"><span data-stu-id="53551-194">If an error occurs, you can click **Configure schedule** in the data refresh history page to try different credentials.</span></span> <span data-ttu-id="53551-195">Может также потребоваться проверка сведений о соединении с источником данных в исходной книге для просмотра строки подключения, которая используется во время обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-195">You might also need to inspect the data source connection information in the original workbook to view the connection string that is used during data refresh.</span></span> <span data-ttu-id="53551-196">Строка подключения предоставляет сведения о местонахождении сервера и базы данных, которые можно использовать для устранения проблемы.</span><span class="sxs-lookup"><span data-stu-id="53551-196">The connection string will provide information about the server location and database that you can use to troubleshoot the problem.</span></span>  
  
 <span data-ttu-id="53551-197">Дополнительные сведения об устранении неполадок см. в разделе [Устранение неполадок при обновлении данных PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) на вики-сайте TechNet.</span><span class="sxs-lookup"><span data-stu-id="53551-197">For more information about troubleshooting, see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/p/?LinkID=223279) on the TechNet Wiki.</span></span>  
  
##  <a name="configure-a-predefined-account-for-accessing-external-or-third-party-data-sources"></a><a name="config3rd"></a><span data-ttu-id="53551-198">Настройка предопределенной учетной записи для доступа к внешним или сторонним источникам данных</span><span class="sxs-lookup"><span data-stu-id="53551-198">Configure a predefined account for accessing external or third-party data sources</span></span>  
 <span data-ttu-id="53551-199">У серверов баз данных часто имеются собственные способы проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="53551-199">Database servers often come with their own authentication methods.</span></span> <span data-ttu-id="53551-200">При наличии книги PowerPivot, которой требуются учетные данные для доступа к внешнему источнику данных во время обновления данных, можно создать идентификатор целевого приложения для учетных данных, а затем указать его в разделе «Источники данных» на странице обновления данных по расписанию.</span><span class="sxs-lookup"><span data-stu-id="53551-200">If you have a PowerPivot workbook that requires database credentials to access an external data source during data refresh, you can create a target application ID for the credentials, and then specify the target application in the Data Sources section of the schedule data refresh page.</span></span>  
  
 <span data-ttu-id="53551-201">Это действие необходимо только в том случае, если требуется дать пользователям возможность переопределения учетных данных базы данных, которые уже встроены в книгу PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="53551-201">This step is only necessary if you want to provide users with an option of overriding the database credentials that are already embedded in the PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="53551-202">Этот шаг является применимым, только если строка подключения уже содержит имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="53551-202">This step only works if the connection string already includes a user name and password.</span></span> <span data-ttu-id="53551-203">Следует учитывать, что обычно не принято указывать учетные данные в строке подключения, поэтому возможность использовать этот вариант является довольно ограниченной.</span><span class="sxs-lookup"><span data-stu-id="53551-203">Note that having credentials in the connection string is relatively uncommon, so your ability to make use of this option is somewhat limited.</span></span> <span data-ttu-id="53551-204">В большинстве случаев идентификатор пользователя и пароль задаются в строке подключения, только если используется проверка подлинности базы данных для подключения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="53551-204">In most cases, you will only have a user ID and password in the connection string if you are using database authentication to connect to the data source.</span></span> <span data-ttu-id="53551-205">Дополнительные сведения о том, как проверить строку подключения, чтобы узнать, содержит ли она идентификатор пользователя и пароль, см. в разделе "предоставление разрешений для создания расписаний и доступ к внешним данным" статьи [Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span><span class="sxs-lookup"><span data-stu-id="53551-205">For more information about how to check the connection string to see if it includes a User ID and password, see the "Grant permissions to create schedules and access external data" section in [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span></span>  
  
1.  <span data-ttu-id="53551-206">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="53551-206">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="53551-207">Щелкните **Служба Secure Store**.</span><span class="sxs-lookup"><span data-stu-id="53551-207">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="53551-208">В окне Управление целевыми приложениями нажмите кнопку **создать**.</span><span class="sxs-lookup"><span data-stu-id="53551-208">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="53551-209">В поле «Идентификатор целевого приложения» введите текстовую строку.</span><span class="sxs-lookup"><span data-stu-id="53551-209">In Target application ID, type a text string.</span></span> <span data-ttu-id="53551-210">Строка должна быть уникальной, но легко запоминающейся.</span><span class="sxs-lookup"><span data-stu-id="53551-210">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="53551-211">Пользователи будут вводить эту строку на страницах расписания обновления данных, когда им потребуется использование учетных данных, хранящихся в этом приложении.</span><span class="sxs-lookup"><span data-stu-id="53551-211">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="53551-212">В поле «Отображаемое имя» введите описательное имя.</span><span class="sxs-lookup"><span data-stu-id="53551-212">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="53551-213">Это имя используется только для отображения.</span><span class="sxs-lookup"><span data-stu-id="53551-213">This name is used for display purposes only.</span></span> <span data-ttu-id="53551-214">Она не используется для указания целевого приложения в расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="53551-214">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="53551-215">В поле «Адрес электронной почты» введите адрес.</span><span class="sxs-lookup"><span data-stu-id="53551-215">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="53551-216">В списке Тип целевого приложения выберите **Группа**.</span><span class="sxs-lookup"><span data-stu-id="53551-216">In Target Application Type, select **Group**.</span></span>  
  
8.  <span data-ttu-id="53551-217">Пропустите URL-адрес страницы целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-217">Skip Target Application Page URL.</span></span> <span data-ttu-id="53551-218">Обновление данных PowerPivot не использует его.</span><span class="sxs-lookup"><span data-stu-id="53551-218">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="53551-219">Щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="53551-219">Click **Next**.</span></span>  
  
10. <span data-ttu-id="53551-220">На странице **Укажите поля учетных данных для целевого приложения Secure Store** примите значения по умолчанию, только если в источнике данных используется проверка подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="53551-220">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values only if the data source uses Windows authentication.</span></span> <span data-ttu-id="53551-221">В противном случае выберите типы полей, допустимые для вашего источника данных, затем измените имена полей в соответствии с типом.</span><span class="sxs-lookup"><span data-stu-id="53551-221">Otherwise, choose the field types that are valid for your data source, and then edit the field names to match the type.</span></span>  
  
     <span data-ttu-id="53551-222">Например, в качестве имен полей можно указать «Имя пользователя SQL Server» и «Пароль пользователя SQL Server», а затем выбрать «Имя пользователя» и «Пароль» в качестве типов полей.</span><span class="sxs-lookup"><span data-stu-id="53551-222">For example, you might specify SQL Server User Name and SQL Server User Password for field names, and then choose User Name and Password for field types.</span></span>  
  
11. <span data-ttu-id="53551-223">Нажмите кнопку "Далее".</span><span class="sxs-lookup"><span data-stu-id="53551-223">Click Next.</span></span>  
  
12. <span data-ttu-id="53551-224">В поле «Администраторы целевых приложений» укажите учетные записи пользователей домена Windows для пользователей SharePoint, которые должны иметь права администратора для доступа к настройкам приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-224">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to the application settings.</span></span>  
  
13. <span data-ttu-id="53551-225">В поле «Члены» добавьте следующие учетные записи пользователя и группы.</span><span class="sxs-lookup"><span data-stu-id="53551-225">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="53551-226">В качестве создателя приложения добавьте в список свою учетную запись пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="53551-226">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="53551-227">Добавьте удостоверение пула приложений для каждого приложения службы PowerPivot, которое будет использовать целевое приложение для доступа к сохраненным учетным данным.</span><span class="sxs-lookup"><span data-stu-id="53551-227">Add the application pool identity of each PowerPivot service application that will be using the target application to access its stored credentials.</span></span> <span data-ttu-id="53551-228">Чтобы просмотреть удостоверение, перейдите к разделу **Управление приложениями службы**, выберите приложение службы PowerPivot, щелкнув пустое пространство рядом с именем (выбирает строку) и нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="53551-228">To view the identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="53551-229">Учетная запись безопасности, отображаемая на этой странице, является учетной записью, которую необходимо добавить в качестве члена целевого приложения.</span><span class="sxs-lookup"><span data-stu-id="53551-229">The security account that appears on this page is the account that you want to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="53551-230">Добавьте в разделе источников данных на странице расписания обновления данных учетные записи пользователей и групп Windows, которые будут входить в это целевое приложение.</span><span class="sxs-lookup"><span data-stu-id="53551-230">Add Windows user and group accounts that will be entering this target application in the data sources section of a data refresh schedule page.</span></span>  
  
14. <span data-ttu-id="53551-231">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="53551-231">Click **OK**.</span></span>  
  
15. <span data-ttu-id="53551-232">Выберите только что созданное целевое приложение, нажмите кнопку со стрелкой вниз и выберите **задать учетные данные.**</span><span class="sxs-lookup"><span data-stu-id="53551-232">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="53551-233">Введите учетные данные, которые будут использоваться для подключения к источнику данных (например, имя пользователя и пароль, которые соответствуют имени входа SQL Server).</span><span class="sxs-lookup"><span data-stu-id="53551-233">Enter the credentials that will be used to connect to the data source (for example, the user name and password of a SQL Server login).</span></span>  
  
17. <span data-ttu-id="53551-234">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="53551-234">Click **OK**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="53551-235">См. также:</span><span class="sxs-lookup"><span data-stu-id="53551-235">See Also</span></span>  
 <span data-ttu-id="53551-236">[Планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="53551-236">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="53551-237">Обновление данных PowerPivot с SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="53551-237">PowerPivot Data Refresh with SharePoint 2010</span></span>](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
