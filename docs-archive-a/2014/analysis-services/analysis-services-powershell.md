---
title: Analysis Services PowerShell | Документация Майкрософт
ms.custom: ''
ms.date: 03/11/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 60bb9610-7229-42eb-a95f-a377268a8720
author: minewiskan
ms.author: owend
ms.openlocfilehash: 56af6f26c29e5c1ddb278b620b6f525c70bd1203
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87656909"
---
# <a name="analysis-services-powershell"></a><span data-ttu-id="5818e-102">Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="5818e-102">Analysis Services PowerShell</span></span>
  <span data-ttu-id="5818e-103">В службах [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] имеется поставщик Analysis Services PowerShell (SQLAS) и командлеты, позволяющие использовать Windows PowerShell для навигации, администрирования и выполнения запросов к объектам служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5818e-103">[!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] includes an Analysis Services PowerShell (SQLAS) provider and cmdlets so that you can use Windows PowerShell to navigate, administer, and query Analysis Services objects.</span></span>  
  
 <span data-ttu-id="5818e-104">В состав Analysis Services PowerShell входит следующее.</span><span class="sxs-lookup"><span data-stu-id="5818e-104">Analysis Services PowerShell consists of the following:</span></span>  
  
-   <span data-ttu-id="5818e-105">Поставщик `SQLAS`, используемый для навигации по иерархии объектов AMO.</span><span class="sxs-lookup"><span data-stu-id="5818e-105">`SQLAS` provider used for navigating the Analysis Management Object (AMO) hierarchy.</span></span>  
  
-   <span data-ttu-id="5818e-106">Командлет `Invoke-ASCmd`, используемый для выполнения скриптов многомерного анализа данных (MDX), расширений интеллектуального анализа данных (DMX) или XML для аналитики.</span><span class="sxs-lookup"><span data-stu-id="5818e-106">`Invoke-ASCmd` cmdlet used for executing MDX, DMX, or XMLA script.</span></span>  
  
-   <span data-ttu-id="5818e-107">Командлеты для отдельных задач, выполняющие типовые операции, в частности, обработку, управление ролями, управление секциями, резервное копирование и восстановление.</span><span class="sxs-lookup"><span data-stu-id="5818e-107">Task-specific cmdlets for routine operations, such as processing, role management, partition management, backup and restore.</span></span>  
  
## <a name="in-this-article"></a><span data-ttu-id="5818e-108">В этой статье</span><span class="sxs-lookup"><span data-stu-id="5818e-108">In this article</span></span>  
 [<span data-ttu-id="5818e-109">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="5818e-109">Prerequisites</span></span>](#bkmk_prereq)  
  
 [<span data-ttu-id="5818e-110">Поддерживаемые версии и режимы служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5818e-110">Supported Versions and Modes of Analysis Services</span></span>](#bkmk_vers)  
  
 [<span data-ttu-id="5818e-111">Требования проверки подлинности и соображения безопасности</span><span class="sxs-lookup"><span data-stu-id="5818e-111">Authentication Requirements and Security Considerations</span></span>](#bkmk_auth)  
  
 [<span data-ttu-id="5818e-112">Задачи Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="5818e-112">Analysis Services PowerShell Tasks</span></span>](#bkmk_tasks)  

<span data-ttu-id="5818e-113">Дополнительные сведения о синтаксисе и примерах см. в [справочнике по Analysis Services PowerShell](/sql/analysis-services/powershell/analysis-services-powershell-reference).</span><span class="sxs-lookup"><span data-stu-id="5818e-113">For more information about syntax and examples, see [Analysis Services PowerShell Reference](/sql/analysis-services/powershell/analysis-services-powershell-reference).</span></span>

##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="5818e-114">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="5818e-114">Prerequisites</span></span>  
 <span data-ttu-id="5818e-115">Должна быть установлена оболочка Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="5818e-115">Windows PowerShell 2.0 must be installed.</span></span> <span data-ttu-id="5818e-116">В последних версиях операционных систем Windows она устанавливается по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="5818e-116">It is installed by default on newer versions of the Windows operating systems.</span></span> <span data-ttu-id="5818e-117">Дополнительные сведения см. в [статье Install Windows PowerShell 2,0](https://msdn.microsoft.com/library/ff637750.aspx)</span><span class="sxs-lookup"><span data-stu-id="5818e-117">For more information, see [Install Windows PowerShell 2.0](https://msdn.microsoft.com/library/ff637750.aspx)</span></span>

<!-- ff637750.aspx above is linked to by:  (https://go.microsoft.com/fwlink/?LinkId=227613). -->
  
 <span data-ttu-id="5818e-118">Необходимо установить компонент SQL Server, включающий модуль SQL Server PowerShell (SQLPS) и клиентские библиотеки.</span><span class="sxs-lookup"><span data-stu-id="5818e-118">You must install a SQL Server feature that includes the SQL Server PowerShell (SQLPS) module and client libraries.</span></span> <span data-ttu-id="5818e-119">Проще всего это сделать, установив среду SQL Server Management Studio, которая уже включает компонент PowerShell и клиентские библиотеки.</span><span class="sxs-lookup"><span data-stu-id="5818e-119">The easiest way to do this is by installing SQL Server Management Studio, which includes the PowerShell feature and client libraries automatically.</span></span> <span data-ttu-id="5818e-120">Модуль SQL Server PowerShell (SQLPS) содержит поставщики PowerShell и командлеты для всех компонентов SQL Server, включая модуль SQLASCmdlets и поставщик SQLAS, используемый для навигации по иерархии объектов служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5818e-120">The SQL Server PowerShell (SQLPS) module contains the PowerShell providers and cmdlets for all SQL Server features, including the SQLASCmdlets module and SQLAS provider used for navigating the Analysis Services object hierarchy.</span></span>  
  
 <span data-ttu-id="5818e-121">Для использования **SQLPS** `SQLAS` поставщика и командлетов необходимо импортировать модуль sqlps.</span><span class="sxs-lookup"><span data-stu-id="5818e-121">You must import the **SQLPS** module before you can use the `SQLAS` provider and cmdlets.</span></span> <span data-ttu-id="5818e-122">Поставщик SQLAS является расширением `SQLServer` поставщика.</span><span class="sxs-lookup"><span data-stu-id="5818e-122">The SQLAS provider is an extension of the `SQLServer` provider.</span></span> <span data-ttu-id="5818e-123">Имеется несколько способов импорта модуля SQLPS.</span><span class="sxs-lookup"><span data-stu-id="5818e-123">There are several ways to import the SQLPS module.</span></span> <span data-ttu-id="5818e-124">Дополнительные сведения см. в разделе [Импорт модуля SQLPS](../../2014/database-engine/import-the-sqlps-module.md).</span><span class="sxs-lookup"><span data-stu-id="5818e-124">For more information, see [Import the SQLPS Module](../../2014/database-engine/import-the-sqlps-module.md).</span></span>  
  
 <span data-ttu-id="5818e-125">Для удаленного доступа к экземпляру служб Analysis Services требуется включить удаленное администрирование и общий доступ к файлам.</span><span class="sxs-lookup"><span data-stu-id="5818e-125">Remote access to an Analysis Services instance requires that you enable remote administration and file sharing.</span></span> <span data-ttu-id="5818e-126">Дополнительные сведения см. в разделе [Включение удаленного администрирования](#bkmk_remote) этого раздела.</span><span class="sxs-lookup"><span data-stu-id="5818e-126">For more information, see [Enable Remote Administration](#bkmk_remote) in this topic.</span></span>  
  
##  <a name="supported-versions-and-modes-of-analysis-services"></a><a name="bkmk_vers"></a><span data-ttu-id="5818e-127">Поддерживаемые версии и режимы Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5818e-127">Supported Versions and Modes of Analysis Services</span></span>  
 <span data-ttu-id="5818e-128">В настоящее время Analysis Services PowerShell поддерживается всеми выпусками служб [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] Analysis Services, работающими под управлением Windows Server 2008 R2, Windows Server 2008 SP1 или Windows 7.</span><span class="sxs-lookup"><span data-stu-id="5818e-128">Currently, Analysis Services PowerShell is supported on any edition of [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] Analysis Services running on Windows Server 2008 R2, Windows Server 2008 SP1, or Windows 7.</span></span>  
  
 <span data-ttu-id="5818e-129">В следующей таблице приведены данные по доступности Analysis Services PowerShell в различных контекстах.</span><span class="sxs-lookup"><span data-stu-id="5818e-129">The following table shows the availability of Analysis Services PowerShell in different contexts.</span></span>  
  
|<span data-ttu-id="5818e-130">Контекст</span><span class="sxs-lookup"><span data-stu-id="5818e-130">Context</span></span>|<span data-ttu-id="5818e-131">Доступность функций PowerShell</span><span class="sxs-lookup"><span data-stu-id="5818e-131">PowerShell Feature Availability</span></span>|  
|-------------|-------------------------------------|  
|<span data-ttu-id="5818e-132">Многомерные экземпляры и базы данных</span><span class="sxs-lookup"><span data-stu-id="5818e-132">Multidimensional instances and databases</span></span>|<span data-ttu-id="5818e-133">Поддерживается локальное и удаленное администрирование.</span><span class="sxs-lookup"><span data-stu-id="5818e-133">Supported for local and remote administration.</span></span><br /><br /> <span data-ttu-id="5818e-134">Для слияния секций необходимо локальное соединение.</span><span class="sxs-lookup"><span data-stu-id="5818e-134">Merge-partition requires a local connection.</span></span>|  
|<span data-ttu-id="5818e-135">Табличные экземпляры и базы данных</span><span class="sxs-lookup"><span data-stu-id="5818e-135">Tabular instances and databases</span></span>|<span data-ttu-id="5818e-136">Поддерживается локальное и удаленное администрирование.</span><span class="sxs-lookup"><span data-stu-id="5818e-136">Supported for local and remote administration.</span></span><br /><br /> <span data-ttu-id="5818e-137">Дополнительные сведения см. в блоге 2011 августа об [управлении табличными моделями с помощью PowerShell](https://go.microsoft.com/fwlink/?linkID=227685).</span><span class="sxs-lookup"><span data-stu-id="5818e-137">For more information, see an August 2011 blog about [Manage Tabular Models Using PowerShell](https://go.microsoft.com/fwlink/?linkID=227685).</span></span>|  
|<span data-ttu-id="5818e-138">Экземпляры и базы данных PowerPivot для SharePoint</span><span class="sxs-lookup"><span data-stu-id="5818e-138">PowerPivot for SharePoint instances and databases</span></span>|<span data-ttu-id="5818e-139">Ограниченная поддержка.</span><span class="sxs-lookup"><span data-stu-id="5818e-139">Limited support.</span></span> <span data-ttu-id="5818e-140">Для просмотра сведений об экземпляре и базе данных можно использовать соединения HTTP и поставщик SQLAS.</span><span class="sxs-lookup"><span data-stu-id="5818e-140">You can use HTTP connections and the SQLAS provider to view instance and database information.</span></span><br /><br /> <span data-ttu-id="5818e-141">Однако использование командлетов не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="5818e-141">However, using the cmdlets is not supported.</span></span> <span data-ttu-id="5818e-142">Надстройку PowerShell для служб Analysis Services не следует использовать для резервного копирования и восстановления хранящихся в памяти баз данных PowerPivot, а также для добавления и удаления ролей, обработки данных или запуска произвольных скриптов XMLA.</span><span class="sxs-lookup"><span data-stu-id="5818e-142">You must not use Analysis Services PowerShell to backup and restore in-memory PowerPivot database, nor should you add or remove roles, process data, or run arbitrary XMLA script.</span></span><br /><br /> <span data-ttu-id="5818e-143">В целях настройки в PowerPivot для SharePoint имеется встроенная поддержка PowerShell, реализуемая отдельно.</span><span class="sxs-lookup"><span data-stu-id="5818e-143">For configuration purposes, PowerPivot for SharePoint has built-in PowerShell support that is provided separately.</span></span> <span data-ttu-id="5818e-144">Дополнительные сведения см. в [справочнике по PowerShell для PowerPivot для SharePoint](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint).</span><span class="sxs-lookup"><span data-stu-id="5818e-144">For more information, see [PowerShell Reference for PowerPivot for SharePoint](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint).</span></span>|  
|<span data-ttu-id="5818e-145">Собственные соединения с локальными кубами</span><span class="sxs-lookup"><span data-stu-id="5818e-145">Native connections to local cubes</span></span><br /><br /> <span data-ttu-id="5818e-146">"Data Source = к:\баккуп\тест.куб"</span><span class="sxs-lookup"><span data-stu-id="5818e-146">"Data Source=c:\backup\test.cub"</span></span>|<span data-ttu-id="5818e-147">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="5818e-147">Not supported.</span></span>|  
|<span data-ttu-id="5818e-148">Соединения HTTP с файлами соединений семантических моделей бизнес-аналитики (BISM-файлами) в SharePoint</span><span class="sxs-lookup"><span data-stu-id="5818e-148">HTTP connections to BI semantic model (.bism) connection files in SharePoint</span></span><br /><br /> <span data-ttu-id="5818e-149">"Data Source = http://server/shared_docs/name.bism "</span><span class="sxs-lookup"><span data-stu-id="5818e-149">"Data Source=http://server/shared_docs/name.bism"</span></span>|<span data-ttu-id="5818e-150">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="5818e-150">Not supported.</span></span>|  
|<span data-ttu-id="5818e-151">Встроенные соединения с базами данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="5818e-151">Embedded connections to PowerPivot databases</span></span><br /><br /> <span data-ttu-id="5818e-152">"Data Source = $Embedded $"</span><span class="sxs-lookup"><span data-stu-id="5818e-152">"Data Source=$Embedded$"</span></span>|<span data-ttu-id="5818e-153">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="5818e-153">Not supported.</span></span>|  
|<span data-ttu-id="5818e-154">Контекст локального сервера в хранимых процедурах служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5818e-154">Local server context in Analysis Services stored procedures</span></span><br /><br /> <span data-ttu-id="5818e-155">"Data Source = \*"</span><span class="sxs-lookup"><span data-stu-id="5818e-155">"Data Source=\*"</span></span>|<span data-ttu-id="5818e-156">Не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="5818e-156">Not supported.</span></span>|  
  
##  <a name="authentication-requirements-and-security-considerations"></a><a name="bkmk_auth"></a><span data-ttu-id="5818e-157">Требования к проверке подлинности и вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="5818e-157">Authentication Requirements and Security Considerations</span></span>  
 <span data-ttu-id="5818e-158">При соединении со службами Analysis Services необходимо использовать идентификатор пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="5818e-158">When connecting to Analysis Services, you must make the connection using a Windows user identity.</span></span> <span data-ttu-id="5818e-159">В большинстве случаев соединение осуществляется с использованием встроенной проверки подлинности Windows, при этом идентификатор текущего пользователя задает контекст, в котором выполняются серверные операции.</span><span class="sxs-lookup"><span data-stu-id="5818e-159">For the most part, a connection is made using Windows integrated security, where the identity of the current user sets the security context under which server operations are performed.</span></span> <span data-ttu-id="5818e-160">Однако после настройки доступа к службам Analysis Services по HTTP становятся доступными дополнительные методы проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="5818e-160">However, additional authentication methods become available when you configure HTTP access to Analysis Services.</span></span> <span data-ttu-id="5818e-161">В этом разделе описывается, как тип соединения влияет на возможные параметры проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="5818e-161">This section explains how the type of connection determines which authentication options you can use.</span></span>  
  
 <span data-ttu-id="5818e-162">Соединение к службам Analysis Services может быть собственным либо соединением по HTTP.</span><span class="sxs-lookup"><span data-stu-id="5818e-162">Connections to Analysis Services are characterized as either native connections or HTTP connections.</span></span> <span data-ttu-id="5818e-163">Собственное соединение — это прямое соединение клиентского приложения к серверу.</span><span class="sxs-lookup"><span data-stu-id="5818e-163">A native connection is a direct connection from a client application to the server.</span></span> <span data-ttu-id="5818e-164">В сеансе PowerShell клиент PowerShell использует поставщик OLE DB для служб Analysis Services для прямого подключения к экземпляру служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5818e-164">In a PowerShell session, the PowerShell client uses the OLE DB provider for Analysis Services to connect directly to an Analysis Services instance.</span></span> <span data-ttu-id="5818e-165">Собственные соединения всегда осуществляются с использованием встроенной безопасности Windows, при этом PowerShell выполняется от имени текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="5818e-165">A native connection is always made using Windows integrated security, where Analysis Services PowerShell executes as the current user.</span></span> <span data-ttu-id="5818e-166">Службы Analysis Services не поддерживают олицетворение.</span><span class="sxs-lookup"><span data-stu-id="5818e-166">Analysis Services does not support impersonation.</span></span> <span data-ttu-id="5818e-167">Если необходимо выполнить операцию от имени определенного пользователя, запустите сеанс PowerShell от имени этого пользователя.</span><span class="sxs-lookup"><span data-stu-id="5818e-167">If you want to perform an operation as a specific user, you must start the PowerShell session as that user.</span></span>  
  
 <span data-ttu-id="5818e-168">HTTP-соединения производятся непрямым образом через IIS, что обеспечивает дополнительные возможности проверки подлинности, например использование обычной проверки подлинности при подключении к экземпляру служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5818e-168">HTTP connections are made indirectly through IIS, allowing for additional authentication options, such as Basic authentication, to connect to an Analysis Services instance.</span></span> <span data-ttu-id="5818e-169">Поскольку службы IIS поддерживают олицетворение, в строке подключения можно указать учетные данные, которые будут использоваться IIS для олицетворения при соединении.</span><span class="sxs-lookup"><span data-stu-id="5818e-169">Because IIS supports impersonation, you can provide a connection string that includes credentials IIS will use to impersonate when making a connection.</span></span> <span data-ttu-id="5818e-170">Чтобы указать учетные данные, можно использовать параметр-Credential.</span><span class="sxs-lookup"><span data-stu-id="5818e-170">To provide credentials, you can use the -Credential parameter.</span></span>  
  
 <span data-ttu-id="5818e-171">**Использование параметра-Credential в PowerShell**</span><span class="sxs-lookup"><span data-stu-id="5818e-171">**Using the -Credential Parameter in PowerShell**</span></span>  
  
 <span data-ttu-id="5818e-172">Параметр-Credential принимает объект PSCredential, указывающий имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="5818e-172">The -Credential parameter takes a PSCredential object that specifies a user name and password.</span></span> <span data-ttu-id="5818e-173">В Analysis Services PowerShell параметр-Credential доступен для командлетов, которые делают запрос на соединение Analysis Services, в отличие от командлетов, которые выполняются в контексте существующего соединения.</span><span class="sxs-lookup"><span data-stu-id="5818e-173">In Analysis Services PowerShell, the -Credential parameter is available for cmdlets that make a connection request to Analysis Services, as opposed to cmdlets that run within the context of an existing connection.</span></span> <span data-ttu-id="5818e-174">К командлетам, осуществляющим запрос на соединение, относятся Invoke-ASCmd, Backup-ASDatabase и Restore-ASDatabase.</span><span class="sxs-lookup"><span data-stu-id="5818e-174">Cmdlets that make a connection request include Invoke-ASCmd, Backup-ASDatabase, and Restore-ASDatabase.</span></span> <span data-ttu-id="5818e-175">Для этих командлетов можно использовать параметр-Credential, если выполняются следующие условия.</span><span class="sxs-lookup"><span data-stu-id="5818e-175">For these cmdlets, the -Credential parameter can be used, assuming the following criteria are met:</span></span>  
  
1.  <span data-ttu-id="5818e-176">Сервер настроен на доступ по HTTP, то есть соединение обрабатывается сервером IIS, который считывает имя пользователя и пароль и олицетворяет соответствующий идентификатор пользователя при соединении со службами Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5818e-176">The server is configured for HTTP access, which means that IIS handles the connection, reads the user name and password, and impersonates that user identity when connecting to Analysis Services.</span></span> <span data-ttu-id="5818e-177">Дополнительные сведения см. в разделе [Настройка HTTP-доступа к службам Analysis Services в службах Internet Information Services (IIS) 8.0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="5818e-177">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
2.  <span data-ttu-id="5818e-178">Виртуальный каталог IIS, созданный для доступа к службам Analysis Services по HTTP, настроен на обычную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="5818e-178">The IIS virtual directory that was created for Analysis Services HTTP access is configured for Basic authentication.</span></span>  
  
3.  <span data-ttu-id="5818e-179">Имя пользователя и пароль, предоставляемые объектом учетных данных, разрешаются в идентификатор пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="5818e-179">The user name and password provided by the credential object resolves to a Windows user identity.</span></span> <span data-ttu-id="5818e-180">Службы Analysis Services используют этот идентификатор в качестве текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="5818e-180">Analysis Services uses this identity as the current user.</span></span> <span data-ttu-id="5818e-181">Если пользователь не является пользователем Windows или у него недостаточно прав для выполнения запрошенной операции, запрос завершается с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="5818e-181">If the user is not a Windows user, or lacks sufficient permissions to perform the requested operation, the request will fail.</span></span>  
  
 <span data-ttu-id="5818e-182">Чтобы создать объект учетных данных, можно воспользоваться командлетом Get-Credential для получения учетных данных от оператора.</span><span class="sxs-lookup"><span data-stu-id="5818e-182">To create a credential object, you can use the Get-Credential cmdlet to collect the credentials from the operator.</span></span> <span data-ttu-id="5818e-183">Затем этот объект учетных данных можно использовать в команде подключения к службам Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5818e-183">You can then use the credential object on a command that connects to Analysis Services.</span></span> <span data-ttu-id="5818e-184">В следующем примере показан один из подходов.</span><span class="sxs-lookup"><span data-stu-id="5818e-184">The following example illustrates one approach.</span></span> <span data-ttu-id="5818e-185">В этом примере соединение выполняется с локальным экземпляром ( `SQLSERVER:\SQLAS\HTTP_DS` ), настроенным для доступа по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="5818e-185">In this example, the connection is to a local instance (`SQLSERVER:\SQLAS\HTTP_DS`) configured for HTTP access.</span></span>  
  
```powershell
$cred = Get-Credential adventureworks\dbadmin  
Invoke-ASCmd -Inputfile:"c:\discoverconnections.xmla" -Credential:$cred  
```  
  
 <span data-ttu-id="5818e-186">При использовании обычной проверки подлинности следует всегда использовать протокол HTTPS с включенным SSL, чтобы имя пользователя и пароль передавались по зашифрованному соединению.</span><span class="sxs-lookup"><span data-stu-id="5818e-186">When using Basic authentication, you should always use HTTPS with SSL so that username and passwords are sent over an encrypted connection.</span></span> <span data-ttu-id="5818e-187">Дополнительные сведения см. в статьях [настройка SSL в iis 7,0](https://go.microsoft.com/fwlink/?linkID=184299) и [Настройка обычной проверки подлинности (IIS 7)](https://go.microsoft.com/fwlink/?LinkId=230776).</span><span class="sxs-lookup"><span data-stu-id="5818e-187">For more information, see [Configure Secure Sockets Layer in IIS 7.0](https://go.microsoft.com/fwlink/?linkID=184299) and [Configure Basic Authentication (IIS 7)](https://go.microsoft.com/fwlink/?LinkId=230776).</span></span>  
  
 <span data-ttu-id="5818e-188">Не забывайте, что учетные данные, запросы и команды, вводимые в PowerShell, передаются на транспортный уровень без изменений.</span><span class="sxs-lookup"><span data-stu-id="5818e-188">Remember that credentials, queries, and commands that you provide in PowerShell are passed unchanged to the transport layer.</span></span> <span data-ttu-id="5818e-189">Включение конфиденциальных данных в скрипты повышает вероятность вредоносной атаки типа «инъекция».</span><span class="sxs-lookup"><span data-stu-id="5818e-189">Including sensitive content in your scripts increases the risk of a malicious injection attack.</span></span>  
  
 <span data-ttu-id="5818e-190">**Указание пароля в объекте Microsoft.Secure.String**</span><span class="sxs-lookup"><span data-stu-id="5818e-190">**Providing a password as a Microsoft.Secure.String object**</span></span>  
  
 <span data-ttu-id="5818e-191">Некоторые операции, например резервное копирование и восстановление, поддерживают параметры шифрования, которые включаются при указании в команде пароля.</span><span class="sxs-lookup"><span data-stu-id="5818e-191">Some operations, such as backup and restore, support encryption options that are activated when you provide a password in the command.</span></span> <span data-ttu-id="5818e-192">Указание пароля дает службам Analysis Services команду на шифрование или расшифровку файла резервной копии.</span><span class="sxs-lookup"><span data-stu-id="5818e-192">Providing the password signals Analysis Services to encrypt or decrypt the backup file.</span></span> <span data-ttu-id="5818e-193">В службах Analysis Services экземпляр этого пароля создается в виде объекта защищенной строки.</span><span class="sxs-lookup"><span data-stu-id="5818e-193">In Analysis Services, this password is instantiated as a secure string object.</span></span> <span data-ttu-id="5818e-194">В следующем примере показано, как получить пароль от оператора во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5818e-194">The following example provides an illustration of how to collect a password from the operator at run time.</span></span>  
  
```powershell
$pwd = read-host -AsSecureString -Prompt "Password"  
$pwd -is [System.IDisposable]  
```  
  
 <span data-ttu-id="5818e-195">Теперь можно создавать резервную копию зашифрованного файла базы данных и восстанавливать ее, передавая переменную $pwd в параметр пароля.</span><span class="sxs-lookup"><span data-stu-id="5818e-195">You can now backup or restore an encrypted database file, passing the $pwd variable to the password parameter.</span></span> <span data-ttu-id="5818e-196">Полный пример, объединяющий эту иллюстрацию с другими командлетами, см. в разделе [командлет Backup-ASDatabase](/powershell/module/sqlserver/backup-asdatabase) и [командлет Restore-ASDatabase](/powershell/module/sqlserver/restore-asdatabase).</span><span class="sxs-lookup"><span data-stu-id="5818e-196">To view a complete example that combines this illustration with other cmdlets, see [Backup-ASDatabase cmdlet](/powershell/module/sqlserver/backup-asdatabase) and [Restore-ASDatabase cmdlet](/powershell/module/sqlserver/restore-asdatabase).</span></span>
  
 <span data-ttu-id="5818e-197">В качестве следующего шага удалите пароль и переменную из сеанса.</span><span class="sxs-lookup"><span data-stu-id="5818e-197">As a follow up step, remove both the password and variable from the session.</span></span>  
  
```powershell
$pwd.Dispose()  
Remove-Variable -Name pwd  
```  
  
##  <a name="analysis-services-powershell-tasks"></a><a name="bkmk_tasks"></a><span data-ttu-id="5818e-198">Analysis Services задач PowerShell</span><span class="sxs-lookup"><span data-stu-id="5818e-198">Analysis Services PowerShell Tasks</span></span>  
 <span data-ttu-id="5818e-199">Службы Analysis Services PowerShell можно запустить из консоли управления Windows PowerShell или командной строки Windows.</span><span class="sxs-lookup"><span data-stu-id="5818e-199">You can run Analysis Services PowerShell from the Windows PowerShell management shell or a Windows command prompt.</span></span> <span data-ttu-id="5818e-200">Запуск служб Analysis Services PowerShell из среды [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)] не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="5818e-200">Running Analysis Services PowerShell from [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)] is not supported.</span></span>  
  
 <span data-ttu-id="5818e-201">В этом разделе описываются типичные задачи, для выполнения которых используется Analysis Services PowerShell.</span><span class="sxs-lookup"><span data-stu-id="5818e-201">This section describes common tasks for using Analysis Services PowerShell.</span></span>  
  
-   [<span data-ttu-id="5818e-202">Загрузка поставщика служб Analysis Services и командлетов</span><span class="sxs-lookup"><span data-stu-id="5818e-202">Load the Analysis Services Provider and Cmdlets</span></span>](#bkmk_load)  
  
-   [<span data-ttu-id="5818e-203">Включение удаленного администрирования</span><span class="sxs-lookup"><span data-stu-id="5818e-203">Enable Remote Administration</span></span>](#bkmk_remote)  
  
-   [<span data-ttu-id="5818e-204">Подключение к объекту служб Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5818e-204">Connect to an Analysis Services Object</span></span>](#bkmk_connect)  
  
-   [<span data-ttu-id="5818e-205">Администрирование службы</span><span class="sxs-lookup"><span data-stu-id="5818e-205">Administer the Service</span></span>](#bkmk_admin)  
  
-   [<span data-ttu-id="5818e-206">Получение справки по Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="5818e-206">Get Help for Analysis Services PowerShell</span></span>](#bkmk_help)  
  
###  <a name="load-the-analysis-services-provider-and-cmdlets"></a><a name="bkmk_load"></a><span data-ttu-id="5818e-207">Загрузка поставщика Analysis Services и командлетов</span><span class="sxs-lookup"><span data-stu-id="5818e-207">Load the Analysis Services Provider and Cmdlets</span></span>  
 <span data-ttu-id="5818e-208">Поставщик Analysis Services — это расширение корневого поставщика SQL Server, которое становится доступным при импорте модуля SQLPS.</span><span class="sxs-lookup"><span data-stu-id="5818e-208">The Analysis Services provider is an extension of the SQL Server root provider that becomes available when you import the SQLPS module.</span></span> <span data-ttu-id="5818e-209">Командлеты служб Analysis Services загружаются одновременно; их также можно загружать по отдельности, если вы хотите использовать их без поставщика.</span><span class="sxs-lookup"><span data-stu-id="5818e-209">Analysis Services cmdlets are loaded simultaneously; you can also load them independently if you want to use them without the provider.</span></span>  
  
-   <span data-ttu-id="5818e-210">Запустите командлет Import-module, чтобы загрузить SQLPS, включающий всю функциональность Analysis Services PowerShell.</span><span class="sxs-lookup"><span data-stu-id="5818e-210">Run the Import-module cmdlet to load SQLPS that includes all of the Analysis Services PowerShell functionality.</span></span> <span data-ttu-id="5818e-211">Если импортировать модуль невозможно, можно временно сменить политику выполнения на неограниченную, чтобы загрузить этот модуль.</span><span class="sxs-lookup"><span data-stu-id="5818e-211">If you cannot import the module, you can temporarily change the execution policy to unrestricted for the purpose of the loading the module.</span></span> <span data-ttu-id="5818e-212">Дополнительные сведения см. в разделе [Импорт модуля SQLPS](../../2014/database-engine/import-the-sqlps-module.md).</span><span class="sxs-lookup"><span data-stu-id="5818e-212">For more information, see [Import the SQLPS Module](../../2014/database-engine/import-the-sqlps-module.md).</span></span>  
  
    ```powershell
    Import-Module "sqlps"  
    ```  
  
     <span data-ttu-id="5818e-213">Вместо этого можно использовать команду `import-module "sqlps" -disablenamechecking` для подавления предупреждений о несоответствии имен команд утвержденным.</span><span class="sxs-lookup"><span data-stu-id="5818e-213">Alternatively, use `import-module "sqlps" -disablenamechecking` to suppress the warning about unapproved verb names.</span></span>  
  
-   <span data-ttu-id="5818e-214">Чтобы загрузить лишь командлеты служб Analysis Services для определенной задачи, без поставщика служб Analysis Services или командлета Invoke-ASCmd, можно загрузить модуль SQLASCmdlets в рамках независимой операции.</span><span class="sxs-lookup"><span data-stu-id="5818e-214">To load just the task-specific Analysis Services cmdlets, without the Analysis Services provider or the Invoke-ASCmd cmdlet, you can load the SQLASCmdlets module as an independent operation.</span></span>  
  
    ```powershell
    Import-Module "sqlascmdlets"  
    ```  
  
###  <a name="enable-remote-administration"></a><a name="bkmk_remote"></a><span data-ttu-id="5818e-215">Включить удаленное администрирование</span><span class="sxs-lookup"><span data-stu-id="5818e-215">Enable Remote Administration</span></span>  
 <span data-ttu-id="5818e-216">Чтобы можно было использовать службы Analysis Services PowerShell с удаленным экземпляром служб Analysis Services, сначала необходимо включить удаленное администрирование и общий доступ к файлам.</span><span class="sxs-lookup"><span data-stu-id="5818e-216">Before you can use Analysis Services PowerShell with a remote Analysis Services instance, you must first enable remote administration and file sharing.</span></span> <span data-ttu-id="5818e-217">Следующая ошибка указывает на ошибку конфигурации брандмауэра: "сервер RPC недоступен.</span><span class="sxs-lookup"><span data-stu-id="5818e-217">The following error indicates a firewall configuration issue: "The RPC server is unavailable.</span></span> <span data-ttu-id="5818e-218">(Исключение HRESULT: 0x800706BA.)".</span><span class="sxs-lookup"><span data-stu-id="5818e-218">(Exception from HRESULT: 0x800706BA)".</span></span>  
  
1.  <span data-ttu-id="5818e-219">Убедитесь, что и на локальном, и на удаленном компьютерах установлена версия [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] клиентских и серверных средств.</span><span class="sxs-lookup"><span data-stu-id="5818e-219">Verify that both local and remote computers have the [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] versions of the client and server tools.</span></span>  
  
2.  <span data-ttu-id="5818e-220">На удаленном сервере, на котором размещен экземпляр служб Analysis Services, откройте в брандмауэре Windows порт TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="5818e-220">On the remote server that is hosting an Analysis Services instance, open TCP port 2383 in Windows Firewall.</span></span> <span data-ttu-id="5818e-221">Если службы Analysis Services установлены как именованный экземпляр или используют заданный пользователем порт, номер порта будет другим.</span><span class="sxs-lookup"><span data-stu-id="5818e-221">If you installed Analysis Services as a named instance or are using a custom port, the port number will be different.</span></span> <span data-ttu-id="5818e-222">Дополнительные сведения см. в статье [Configure the Windows Firewall to Allow Analysis Services Access](instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span><span class="sxs-lookup"><span data-stu-id="5818e-222">For more information, see [Configure the Windows Firewall to Allow Analysis Services Access](instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
3.  <span data-ttu-id="5818e-223">Убедитесь, что на удаленном сервере запущены следующие службы: служба удаленного вызова процедур (RPC), служба модуля поддержки NetBIOS TCP/IP, служба инструментарий управления Windows (WMI) (WMI), служба служба удаленного управления Windows (WS-Management).</span><span class="sxs-lookup"><span data-stu-id="5818e-223">On the remote server, verify that the followings services are started:  Remote Procedure Call (RPC) service, TCP/IP NetBIOS Helper service, Windows Management Instrumentation (WMI) service, Windows Remote Management (WS-Management) service.</span></span>  
  
4.  <span data-ttu-id="5818e-224">На удаленном сервере запустите оснастку редактора объектов групповой политики (gpedit.msc).</span><span class="sxs-lookup"><span data-stu-id="5818e-224">On the remote server, start the Group Policy Object Editor snap-in (gpedit.msc).</span></span>  
  
5.  <span data-ttu-id="5818e-225">Откройте последовательно следующие элементы: «Настройка компьютера»,«Административные шаблоны», «Сеть», «Сетевые подключения», «Брандмауэр Windows» и «Профиль домена».</span><span class="sxs-lookup"><span data-stu-id="5818e-225">Open Computer Configuration, open Administrative Templates, open Network, open Network Connections, open Windows Firewall, and then open Domain Profile.</span></span>  
  
6.  <span data-ttu-id="5818e-226">Дважды щелкните **Брандмауэр Windows: разрешить исключение для входящего удаленного администрирования**, выберите **включено**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5818e-226">Double-click **Windows Firewall: Allow inbound remote administration exception**, select **Enabled**, and then click **OK**.</span></span>  
  
7.  <span data-ttu-id="5818e-227">Дважды щелкните **Брандмауэр Windows: разрешить исключение для входящего общего доступа к файлам и принтерам**, выберите **включено**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="5818e-227">Double-click **Windows Firewall: Allow inbound file and printer sharing exception**, select **Enabled**, and then click **OK**.</span></span>  
  
8.  <span data-ttu-id="5818e-228">На локальном компьютере с клиентскими средствами используйте следующие командлеты для проверки удаленного администрирования, подставив фактическое имя сервера для заполнителя *Remote-Server-Name* .</span><span class="sxs-lookup"><span data-stu-id="5818e-228">On the local computer that has the client tools, use the following cmdlets to verify remote administration, substituting the actual server name for the *remote-server-name* placeholder.</span></span> <span data-ttu-id="5818e-229">Пропустите имя экземпляра, если службы Analysis Services установлены как экземпляр по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="5818e-229">Omit the instance name if Analysis Services is installed as the default instance.</span></span> <span data-ttu-id="5818e-230">Чтобы эта команда работала, необходимо предварительно импортировать модуль SQLPS.</span><span class="sxs-lookup"><span data-stu-id="5818e-230">You must have previously imported the SQLPS module in order for the command to work.</span></span>  
  
    ```
    PS SQLSERVER:\> cd sqlas
    PS SQLSERVER:\sqlas> cd <remote-server-name\instance-name>  
    PS SQLSERVER:\sqlas\<remote-server-name\instance-name> dir  
    ```  
  
 <span data-ttu-id="5818e-231">В некоторых случаях может понадобиться дополнительная настройка.</span><span class="sxs-lookup"><span data-stu-id="5818e-231">In some cases, additional configuration might be necessary.</span></span> <span data-ttu-id="5818e-232">Возможно, потребуется ввести на удаленном сервере следующую команду, прежде чем на нем можно будет выполнять команды с другого компьютера:</span><span class="sxs-lookup"><span data-stu-id="5818e-232">You might need to type the following on the remote server before you can issue commands to it from another computer:</span></span>  
  
```powershell
Enable-PSRemoting  
```  
  
  
###  <a name="connect-to-an-analysis-services-object"></a><a name="bkmk_connect"></a><span data-ttu-id="5818e-233">Подключение к объекту Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5818e-233">Connect to an Analysis Services Object</span></span>  
 <span data-ttu-id="5818e-234">Поставщик Analysis Services PowerShell поддерживает навигацию по иерархии объектов служб Analysis Services и задает контекст для выполнения команд.</span><span class="sxs-lookup"><span data-stu-id="5818e-234">The Analysis Services PowerShell provider supports navigation of the Analysis Services object hierarchy and sets the context for running commands.</span></span> <span data-ttu-id="5818e-235">Поставщик является расширением корневого поставщика SQLSERVER, доступного в модуле SQLPS.</span><span class="sxs-lookup"><span data-stu-id="5818e-235">The provider is an extension of the SQLSERVER root provider available through the SQLPS module.</span></span> <span data-ttu-id="5818e-236">После загрузки модуля SQLPS становится доступной навигация по пути.</span><span class="sxs-lookup"><span data-stu-id="5818e-236">After you load the SQLPS module, you can navigate the path.</span></span>  
  
 <span data-ttu-id="5818e-237">Возможно подключение как к локальному, так и к удаленному экземпляру, но некоторые командлеты работают только на локальном экземпляре (например, merge-partition).</span><span class="sxs-lookup"><span data-stu-id="5818e-237">You can connect to a local or remote instance, but some cmdlets only run on a local instance (namely, merge-partition).</span></span> <span data-ttu-id="5818e-238">Можно использовать собственное соединение или HTTP-соединение с серверами служб Analysis Services, настроенными на доступ по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="5818e-238">You can use a native connection or an HTTP connection for Analysis Services servers that you configured for HTTP access.</span></span> <span data-ttu-id="5818e-239">На следующих рисунках показан путь навигации для собственных соединений и для соединений по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="5818e-239">The following illustrations show the navigation path for native and HTTP connections.</span></span> <span data-ttu-id="5818e-240">На следующих рисунках показан путь навигации для собственных соединений и для соединений по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="5818e-240">The following illustrations show the navigation path for native and HTTP connections.</span></span>  
  
 <span data-ttu-id="5818e-241">**Собственные соединения со службами Analysis Services**</span><span class="sxs-lookup"><span data-stu-id="5818e-241">**Native Connections to Analysis Services**</span></span>  
  
 <span data-ttu-id="5818e-242">![Собственное соединение со службами Analysis Services](media/ssas-powershell-nativeconnection.gif "Собственное соединение со службами Analysis Services")</span><span class="sxs-lookup"><span data-stu-id="5818e-242">![Native connection to Analysis Services](media/ssas-powershell-nativeconnection.gif "Native connection to Analysis Services")</span></span>  
  
 <span data-ttu-id="5818e-243">Следующий пример показывает использование собственного соединения для навигации по иерархии объектов.</span><span class="sxs-lookup"><span data-stu-id="5818e-243">The following example is a demonstration of how to use a native connection to navigate object hierarchy.</span></span> <span data-ttu-id="5818e-244">На поставщике можно воспользоваться командой `dir` для просмотра сведений об экземпляре.</span><span class="sxs-lookup"><span data-stu-id="5818e-244">From the provider, you can issue a `dir` to view instance information.</span></span> <span data-ttu-id="5818e-245">Команда `cd` позволяет просмотреть объекты на этом экземпляре.</span><span class="sxs-lookup"><span data-stu-id="5818e-245">You can use `cd` to view objects of that instance.</span></span>  
  
```  
PS SQLSERVER:> cd sqlas  
PS SQLSERVER\sqlas:> dir  
PS SQLSERVER\sqlas:> cd localhost\default  
PS SQLSERVER\sqlas\localhost\default:> dir  
```  
  
 <span data-ttu-id="5818e-246">Должны отобразиться следующие коллекции: сборки, базы данных, роли и трассировки.</span><span class="sxs-lookup"><span data-stu-id="5818e-246">You should see the following collections: Assemblies, Databases, Roles, and Traces.</span></span> <span data-ttu-id="5818e-247">Продолжая использовать `cd` и `dir`, можно просмотреть содержимое всех коллекций.</span><span class="sxs-lookup"><span data-stu-id="5818e-247">Continuing to use `cd` and `dir`, you can view the contents of each collection.</span></span>  
  
 <span data-ttu-id="5818e-248">**Соединения по протоколу HTTP со службами Analysis Services**</span><span class="sxs-lookup"><span data-stu-id="5818e-248">**HTTP Connections to Analysis Services**</span></span>  
  
 <span data-ttu-id="5818e-249">![HTTP-соединение со службами Analysis Services](media/ssas-powershell-httpconnection.gif "HTTP-соединение со службами Analysis Services")</span><span class="sxs-lookup"><span data-stu-id="5818e-249">![HTTP Connection to Analysis Services](media/ssas-powershell-httpconnection.gif "HTTP Connection to Analysis Services")</span></span>  
  
 <span data-ttu-id="5818e-250">HTTP-подключения полезны, если вы настроили сервер для доступа по протоколу HTTP, выполнив инструкции в этом разделе: [Настройка доступа по протоколу HTTP к Analysis Services на службы IIS &#40;IIS&#41; 8,0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md)</span><span class="sxs-lookup"><span data-stu-id="5818e-250">HTTP connections are useful if you configured your server for HTTP access using the instructions in this topic: [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md)</span></span>  
  
 <span data-ttu-id="5818e-251">Если предположить, что URL-адрес сервера для http://localhost/olap/msmdpump.dll , соединение может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="5818e-251">Assuming a server URL of http://localhost/olap/msmdpump.dll, a connection might look like the following:</span></span>  
  
```  
PS SQLSERVER\sqlas:> cd http_ds  
PS SQLSERVER\sqlas\http_ds:> $Url=Encode-SqlName "http://localhost/olap/msmdpump.dll"  
PS SQLSERVER\sqlas\http_ds:> cd $Url  
PS SQLSERVER\sqlas\http_ds\http%3A%2F%2Flocalhost%2olap%2msmdpump%2Edll:> dir  
```  
  
 <span data-ttu-id="5818e-252">Должны отобразиться следующие коллекции: сборки, базы данных, роли и трассировки.</span><span class="sxs-lookup"><span data-stu-id="5818e-252">You should see the following collections: Assemblies, Databases, Roles, and Traces.</span></span> <span data-ttu-id="5818e-253">Если просмотреть содержимое этих коллекций не удается, проверьте параметры проверки подлинности в виртуальном каталоге OLAP.</span><span class="sxs-lookup"><span data-stu-id="5818e-253">If you cannot view the contents of these collections, check the authentication settings on the OLAP virtual directory.</span></span> <span data-ttu-id="5818e-254">Убедитесь, что анонимный доступ отключен.</span><span class="sxs-lookup"><span data-stu-id="5818e-254">Make sure that Anonymous Access is disabled.</span></span> <span data-ttu-id="5818e-255">Если используется проверка подлинности Windows, убедитесь, что у учетной записи пользователя Windows имеются административные разрешения для экземпляра служб Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5818e-255">If you are using Windows Authentication, be sure that your Windows user account has administrative permissions on the Analysis Services instance.</span></span>  
  
###  <a name="administer-the-service"></a><a name="bkmk_admin"></a><span data-ttu-id="5818e-256">Администрирование службы</span><span class="sxs-lookup"><span data-stu-id="5818e-256">Administer the Service</span></span>  
 <span data-ttu-id="5818e-257">Убедитесь в том, что служба запущена.</span><span class="sxs-lookup"><span data-stu-id="5818e-257">Verify the service is running.</span></span> <span data-ttu-id="5818e-258">Возвращает состояние, имя и отображаемое имя служб SQL Server, включая службы Analysis Services (MSSQLServerOLAPService) и компонент Database Engine.</span><span class="sxs-lookup"><span data-stu-id="5818e-258">Returns status, name, and display name for SQL Server services, including Analysis Services (MSSQLServerOLAPService) and the Database Engine.</span></span>  
  
```powershell
Get-Service mssql*  
```  
  
 <span data-ttu-id="5818e-259">Возвращает свойства процесса, включая идентификатор процесса, количество дескрипторов и объем используемой памяти:</span><span class="sxs-lookup"><span data-stu-id="5818e-259">Returns properties about a process, including process ID, handle count, and memory usage:</span></span>  
  
```powershell
Get-Process msmdsrv  
```  
  
 <span data-ttu-id="5818e-260">Перезапускает службу, когда пользователь выполняет следующий командлет из оболочки администратора:</span><span class="sxs-lookup"><span data-stu-id="5818e-260">Restarts the service when you issue the following cmdlet from the administrator shell:</span></span>  
  
```powershell
Restart-Service mssqlserverolapservice  
```  
  
###  <a name="get-help-for-analysis-services-powershell"></a><a name="bkmk_help"></a><span data-ttu-id="5818e-261">Получение справки по Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="5818e-261">Get Help for Analysis Services PowerShell</span></span>  
 <span data-ttu-id="5818e-262">Используйте любой из следующих командлетов, чтобы проверить доступность командлетов и получить дополнительные сведения о службах, процессах и объектах.</span><span class="sxs-lookup"><span data-stu-id="5818e-262">Use any of the following cmdlets to verify cmdlet availability and to get more information about services, processes, and objects.</span></span>  
  
1.  <span data-ttu-id="5818e-263">`Get-Help` возвращает встроенную справку для командлета служб Analysis Services, включая примеры:</span><span class="sxs-lookup"><span data-stu-id="5818e-263">`Get-Help` returns the built-in help for an Analysis Services cmdlet, including examples:</span></span>  
  
    ```powershell
    Get-Help invoke-ascmd -Examples  
    ```  
  
2.  <span data-ttu-id="5818e-264">`Get-Command` возвращает список из одиннадцати командлетов Analysis Services PowerShell:</span><span class="sxs-lookup"><span data-stu-id="5818e-264">`Get-Command` returns a list of the eleven Analysis Services PowerShell cmdlets:</span></span>  
  
    ```powershell
    Get-Command -module SQLASCmdlets  
    ```  
  
3.  <span data-ttu-id="5818e-265">`Get-Member` возвращает свойства или методы службы или процесса.</span><span class="sxs-lookup"><span data-stu-id="5818e-265">`Get-Member` returns properties or methods of a service or process.</span></span>  
  
    ```powershell
    Get-Service mssqlserverolapservice | Get-Member -Type Property  
    ```  
  
    ```powershell
    Get-Service mssqlserverolapservice | Get-Member -Type Method  
    ```  
  
    ```powershell
    Get-Process msmdsrv | Get-Member -Type Property  
    ```  
  
4.  <span data-ttu-id="5818e-266">`Get-Member` также может использоваться для возвращения свойств или методов объекта (например, методов AMO у серверного объекта) с применением поставщика SQLAS, задающего экземпляр сервера.</span><span class="sxs-lookup"><span data-stu-id="5818e-266">`Get-Member` can also be used to return properties or methods of an object (for example, AMO methods on the server object) using the SQLAS provider to specify the server instance.</span></span>  
  
    ```
    PS SQLSERVER:\sqlas\localhost\default > $serverObj = New-Object Microsoft.AnalysisServices.Server  
    PS SQLSERVER:\sqlas\localhost\default > $serverObj = | Get-Member -Type Method  
    ```  
  
5.  <span data-ttu-id="5818e-267">`Get-PSdrive` возвращает список поставщиков, установленных в настоящий момент.</span><span class="sxs-lookup"><span data-stu-id="5818e-267">`Get-PSdrive` returns a list of the providers that are currently installed.</span></span> <span data-ttu-id="5818e-268">Если модуль SQLPS импортирован, в списке отобразится поставщик `SQLServer` (SQLAS входит в состав поставщика SQLServer и никогда не появляется в списке отдельно от него):</span><span class="sxs-lookup"><span data-stu-id="5818e-268">If you imported the SQLPS module, you will see the `SQLServer` provider in the list (SQLAS is part of the SQLServer provider and never appears separately in the list):</span></span>  
  
    ```powershell
    Get-PSDrive  
    ```  
  
## <a name="see-also"></a><span data-ttu-id="5818e-269">См. также:</span><span class="sxs-lookup"><span data-stu-id="5818e-269">See Also</span></span>  
 <span data-ttu-id="5818e-270">[Установка SQL Server PowerShell](../database-engine/install-windows/install-sql-server-powershell.md) </span><span class="sxs-lookup"><span data-stu-id="5818e-270">[Install SQL Server PowerShell](../database-engine/install-windows/install-sql-server-powershell.md) </span></span>  
 <span data-ttu-id="5818e-271">[Управление табличными моделями с помощью PowerShell (блог)](https://go.microsoft.com/fwlink/?linkID=227685) </span><span class="sxs-lookup"><span data-stu-id="5818e-271">[Manage Tabular Models Using PowerShell (blog)](https://go.microsoft.com/fwlink/?linkID=227685) </span></span>  
 [<span data-ttu-id="5818e-272">Настройка HTTP-доступа к службам Analysis Services в службах Internet Information Services (IIS) 8.0</span><span class="sxs-lookup"><span data-stu-id="5818e-272">Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0</span></span>](instances/configure-http-access-to-analysis-services-on-iis-8-0.md)  
  
  
