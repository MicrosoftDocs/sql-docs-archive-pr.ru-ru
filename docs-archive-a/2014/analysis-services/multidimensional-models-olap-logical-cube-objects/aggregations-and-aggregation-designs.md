---
title: Агрегаты и статистические схемы | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- aggregations [Analysis Services], about aggregations
- storage [Analysis Services], aggregations
- Storage Design Wizard
- data summary [Analysis Services]
- data storage [Analysis Services]
- storing data [Analysis Services], aggregations
- aggregations [Analysis Services]
ms.assetid: 35bd8589-39fa-4e0b-b28f-5a07d70da0a2
author: minewiskan
ms.author: owend
ms.openlocfilehash: c56e80482ef71e8041f8518ae9901691a1809990
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87732153"
---
# <a name="aggregations-and-aggregation-designs"></a><span data-ttu-id="5bba4-102">Aggregations and Aggregation Designs</span><span class="sxs-lookup"><span data-stu-id="5bba4-102">Aggregations and Aggregation Designs</span></span>
  <span data-ttu-id="5bba4-103">Объект <xref:Microsoft.AnalysisServices.AggregationDesign> задает ряд определений статистической обработки, которые могут совместно использоваться в нескольких секциях.</span><span class="sxs-lookup"><span data-stu-id="5bba4-103">An <xref:Microsoft.AnalysisServices.AggregationDesign> object defines a set of aggregation definitions that can be shared across multiple partitions.</span></span>  
  
 <span data-ttu-id="5bba4-104">Объект <xref:Microsoft.AnalysisServices.Aggregation> представляет результат суммирования данных группы мер при определенной гранулярности измерений.</span><span class="sxs-lookup"><span data-stu-id="5bba4-104">An <xref:Microsoft.AnalysisServices.Aggregation> object represents the summarization of measure group data at certain granularity of the dimensions.</span></span>  
  
 <span data-ttu-id="5bba4-105">Простой объект <xref:Microsoft.AnalysisServices.Aggregation> состоит из базовых сведений и измерений.</span><span class="sxs-lookup"><span data-stu-id="5bba4-105">A simple <xref:Microsoft.AnalysisServices.Aggregation> object is composed of: basic information and dimensions.</span></span> <span data-ttu-id="5bba4-106">Основная информация включает в себя имя статистической обработки, идентификатор, аннотации и описание.</span><span class="sxs-lookup"><span data-stu-id="5bba4-106">Basic information includes the name of the aggregation, the ID, annotations, and a description.</span></span> <span data-ttu-id="5bba4-107">Измерения — это коллекции объектов <xref:Microsoft.AnalysisServices.AggregationDimension>, которые содержат список атрибутов гранулярности для измерения.</span><span class="sxs-lookup"><span data-stu-id="5bba4-107">The dimensions are a collection of <xref:Microsoft.AnalysisServices.AggregationDimension> objects that contain the list of granularity attributes for the dimension.</span></span>  
  
 <span data-ttu-id="5bba4-108">Агрегаты — это предварительно вычисляемые сводные данные конечных ячеек.</span><span class="sxs-lookup"><span data-stu-id="5bba4-108">Aggregations are precalculated summaries of data from leaf cells.</span></span> <span data-ttu-id="5bba4-109">Агрегаты содержат ответы на еще не заданные вопросы, что позволяет значительно сократить время ответа на запрос.</span><span class="sxs-lookup"><span data-stu-id="5bba4-109">Aggregations improve query response time by preparing the answers before the questions are asked.</span></span> <span data-ttu-id="5bba4-110">Например, когда данные в таблице фактов хранилища данных содержат сотни тысяч строк, обработка запроса суммарных значений недельных продаж для конкретной линии продуктов может занять значительное время — ведь чтобы получить ответ, при его выполнении необходимо просмотреть и сложить все строки в таблице фактов.</span><span class="sxs-lookup"><span data-stu-id="5bba4-110">For example, when a data warehouse fact table contains hundreds of thousands of rows, a query requesting the weekly sales totals for a particular product line can take a long time to answer if all the rows in the fact table have to be scanned and summed at query time to compute the answer.</span></span> <span data-ttu-id="5bba4-111">Однако ответ может быть практически немедленным, если были предварительно вычислены сводные данные для ответа на этот запрос.</span><span class="sxs-lookup"><span data-stu-id="5bba4-111">However, the response can be almost immediate if the summarization data to answer this query has been precalculated.</span></span> <span data-ttu-id="5bba4-112">Это предварительное вычисление сводных данных происходит во время обработки и является основой быстрого отклика технологии OLAP.</span><span class="sxs-lookup"><span data-stu-id="5bba4-112">This precalculation of summary data occurs during processing and is the foundation for the rapid response times of OLAP technology.</span></span>  
  
 <span data-ttu-id="5bba4-113">Кубы в технологии OLAP являются способом организации сводных данных в многомерные структуры.</span><span class="sxs-lookup"><span data-stu-id="5bba4-113">Cubes are the way that OLAP technology organizes summary data into multidimensional structures.</span></span> <span data-ttu-id="5bba4-114">Измерения и их иерархии атрибутов отражают запросы, которые могут быть применены к кубу.</span><span class="sxs-lookup"><span data-stu-id="5bba4-114">Dimensions and their hierarchies of attributes reflect the queries that can be asked of the cube.</span></span> <span data-ttu-id="5bba4-115">Агрегаты хранятся в многомерной структуре в ячейках с координатами, заданными измерениями.</span><span class="sxs-lookup"><span data-stu-id="5bba4-115">Aggregations are stored in the multidimensional structure in cells at coordinates specified by the dimensions.</span></span> <span data-ttu-id="5bba4-116">Например, вопрос "Каков объем продаж продукта X в 1998 году в северо-западном регионе?"</span><span class="sxs-lookup"><span data-stu-id="5bba4-116">For example, the question "What were the sales of product X in 1998 for the Northwest region?"</span></span> <span data-ttu-id="5bba4-117">включает в себя три измерения ("Продукт", "Время" и "География") и одну меру ("Продажи").</span><span class="sxs-lookup"><span data-stu-id="5bba4-117">involves three dimensions (Product, Time, and Geography) and one measure (Sales).</span></span> <span data-ttu-id="5bba4-118">Значение ячейки в кубе, расположенной в заданных координатах («Продукт X», «1998», «Северо-запад»), представляет собой ответ, одиночное числовое значение.</span><span class="sxs-lookup"><span data-stu-id="5bba4-118">The value of the cell in the cube at the specified coordinates (product X, 1998, Northwest) is the answer, a single numeric value.</span></span>  
  
 <span data-ttu-id="5bba4-119">Другие вопросы могут возвращать несколько значений,</span><span class="sxs-lookup"><span data-stu-id="5bba4-119">Other questions may return multiple values.</span></span> <span data-ttu-id="5bba4-120">например: «Каковы поквартальные объемы продаж оборудования по регионам в 1998 году?».</span><span class="sxs-lookup"><span data-stu-id="5bba4-120">For example, "How much were the sales of hardware products by quarter by region for 1998?"</span></span> <span data-ttu-id="5bba4-121">Подобные запросы возвращают наборы ячеек из координат, удовлетворяющих заданным условиям.</span><span class="sxs-lookup"><span data-stu-id="5bba4-121">Such queries return sets of cells from the coordinates that satisfy the specified conditions.</span></span> <span data-ttu-id="5bba4-122">Количество ячеек, возвращаемых запросом, зависит от количества элементов на уровне «Оборудование» измерения «Продукт», четырех кварталов в 1998 году и числа регионов в измерении «География».</span><span class="sxs-lookup"><span data-stu-id="5bba4-122">The number of cells returned by the query depends on the number of items in the Hardware level of the Product dimension, the four quarters in 1998, and the number of regions in the Geography dimension.</span></span> <span data-ttu-id="5bba4-123">Если все сводные данные были предварительно рассчитаны в агрегатах, то время отклика на запрос будет зависеть только от того, сколько времени понадобится для извлечения значений из указанных ячеек.</span><span class="sxs-lookup"><span data-stu-id="5bba4-123">If all summary data has been precalculated into aggregations, the response time of the query will depend only on the time that is required to extract the specified cells.</span></span> <span data-ttu-id="5bba4-124">Вычисление и чтение данных из таблицы фактов при этом не потребуются.</span><span class="sxs-lookup"><span data-stu-id="5bba4-124">No calculation or reading of data from the fact table is required.</span></span>  
  
 <span data-ttu-id="5bba4-125">Хотя предварительные вычисления всех возможных агрегатов в кубе могут обеспечить самое малое время отклика для всех запросов, службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] достаточно легко вычисляют значения некоторых агрегатов на основе других предварительно вычисленных агрегатов.</span><span class="sxs-lookup"><span data-stu-id="5bba4-125">Although precalculation of all possible aggregations in a cube might provide the fastest possible response time for all queries, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can easily calculate some aggregrated values from other precalculated aggregations.</span></span> <span data-ttu-id="5bba4-126">Кроме того, вычисление значений всех возможных агрегатов требует значительных затрат на вычисление и хранение.</span><span class="sxs-lookup"><span data-stu-id="5bba4-126">Additionally, calculating all possible aggregations requires significant processing time and storage.</span></span> <span data-ttu-id="5bba4-127">Следовательно, существует компромисс между требованиями к объему хранилища и количеством возможных агрегатов, для которых производятся предварительные вычисления (в процентах).</span><span class="sxs-lookup"><span data-stu-id="5bba4-127">Therefore, there is a tradeoff between storage requirements and the percentage of possible aggregations that are precalculated.</span></span> <span data-ttu-id="5bba4-128">Если значения агрегатов не вычисляются (0 %), то необходимое время обработки и место для хранения будут для куба минимальны, но запросы будут выполняться медленно, потому что необходимые для ответа данные должны будут извлекаться из конечных ячеек и затем статистически обрабатываться при обработке каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="5bba4-128">If no aggregations are precalculated (0%), the amount of required processing time and storage space for a cube is minimized, but query response time may be slow because the data required to answer each query must be retrieved from the leaf cells and then aggregated at query time to answer each query.</span></span> <span data-ttu-id="5bba4-129">Например, чтобы получить единственное число в ответ на упомянутый выше вопрос («Каков объем продаж продукта X в 1998 году в Северо-Западном регионе?») может потребовать считывания тысяч строк данных и извлечения для каждой из них значения столбца, в котором хранятся значения меры «Продажи».</span><span class="sxs-lookup"><span data-stu-id="5bba4-129">For example, returning a single number that answers the question asked earlier ("What were the sales of product X in 1998 for the Northwest region") might require reading thousands of rows of data, extracting the value of the column used to provide the Sales measure from each row, and then calculating the sum.</span></span> <span data-ttu-id="5bba4-130">Более того, продолжительность времени, необходимого для получения этих данных, будет зависеть от режима хранения, выбранного для Data-MOLAP, HOLAP или ROLAP.</span><span class="sxs-lookup"><span data-stu-id="5bba4-130">Moreover, the length of time required to retrieve that data will very depending on the storage mode chosen for the data-MOLAP, HOLAP, or ROLAP.</span></span>  
  
## <a name="designing-aggregations"></a><span data-ttu-id="5bba4-131">Проектирование статистических схем</span><span class="sxs-lookup"><span data-stu-id="5bba4-131">Designing Aggregations</span></span>  
 [!INCLUDE[msCoName](../../includes/msconame-md.md)]<span data-ttu-id="5bba4-132">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] включает сложный алгоритм для выбора агрегатов для предварительного вычисления, чтобы другие агрегаты можно было быстро вычислить на основе предварительно вычисленных значений.</span><span class="sxs-lookup"><span data-stu-id="5bba4-132">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] incorporates a sophisticated algorithm to select aggregations for precalculation so that other aggregations can be quickly computed from the precalculated values.</span></span> <span data-ttu-id="5bba4-133">Например, если существуют предварительно вычисленные агрегаты для уровня «Месяц» измерения «Время», то вычисление для уровня «Квартал» потребует всего лишь сложения трех чисел, которое быстро выполняется по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="5bba4-133">For example, if the aggregations are precalculated for the Month level of a Time hierarchy, the calculation for a Quarter level requires only the summarization of three numbers, which can be quickly computed on demand.</span></span> <span data-ttu-id="5bba4-134">Такой подход позволяет сократить время обработки и снизить требования к объему хранилища, практически не сказываясь при этом на времени отклика.</span><span class="sxs-lookup"><span data-stu-id="5bba4-134">This technique saves processing time and reduces storage requirements, with minimal effect on query response time.</span></span>  
  
 <span data-ttu-id="5bba4-135">Мастер статистических схем предоставляет возможность задать ограничения хранилища и процентных показателей для алгоритма, позволяя достичь компромисса между временем отклика запросов и требованиями к объему хранилища.</span><span class="sxs-lookup"><span data-stu-id="5bba4-135">The Aggregation Design Wizard provides options for you to specify storage and percentage constraints on the algorithm to achieve a satisfactory tradeoff between query response time and storage requirements.</span></span> <span data-ttu-id="5bba4-136">Однако алгоритм мастера статистических схем предполагает, что все возможные запросы одинаково вероятны.</span><span class="sxs-lookup"><span data-stu-id="5bba4-136">However, the Aggregation Design Wizard's algorithm assumes that all possible queries are equally likely.</span></span> <span data-ttu-id="5bba4-137">Мастер оптимизации с учетом использования позволяет изменить статистическую схему для группы мер путем анализа запросов, которые выдавались клиентскими приложениями.</span><span class="sxs-lookup"><span data-stu-id="5bba4-137">The Usage-Based Optimization Wizard lets you adjust the aggregation design for a measure group by analyzing the queries that have been submitted by client applications.</span></span> <span data-ttu-id="5bba4-138">Мастер для настройки статистической схемы куба позволяет уменьшить время отклика на часто выполняемые запросы за счет редко выполняемых, не оказывая при этом значительного влияния на необходимый для куба объем хранилища.</span><span class="sxs-lookup"><span data-stu-id="5bba4-138">By using the wizard to tune a cube's aggregation you can increase responsiveness to frequent queries and decrease responsiveness to infrequent queries without significantly affecting the storage needed for the cube.</span></span>  
  
 <span data-ttu-id="5bba4-139">Агрегаты проектируются при помощи мастеров, но не вычисляются до момента обработки секции, для которой они были спроектированы.</span><span class="sxs-lookup"><span data-stu-id="5bba4-139">Aggregations are designed by using the wizards but are not actually calculated until the partition for which the aggregations are designed is processed.</span></span> <span data-ttu-id="5bba4-140">Если после создания агрегата структура куба изменилась либо в исходных таблицах куба были изменены или добавлены данные, то обычно требуется проверка агрегатов куба и его повторная обработка.</span><span class="sxs-lookup"><span data-stu-id="5bba4-140">After the aggregation has been created, if the structure of a cube ever changes, or if data is added to or changed in a cube's source tables, it is usually necessary to review the cube's aggregations and process the cube again.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5bba4-141">См. также:</span><span class="sxs-lookup"><span data-stu-id="5bba4-141">See Also</span></span>  
 [<span data-ttu-id="5bba4-142">Режимы хранения и обработка секции</span><span class="sxs-lookup"><span data-stu-id="5bba4-142">Partition Storage Modes and Processing</span></span>](partitions-partition-storage-modes-and-processing.md)  
  
  
