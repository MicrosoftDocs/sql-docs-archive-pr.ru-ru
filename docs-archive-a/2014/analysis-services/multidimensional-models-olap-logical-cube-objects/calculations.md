---
title: Вычисления | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738978"
---
# <a name="calculations"></a><span data-ttu-id="9359f-102">Вычисления</span><span class="sxs-lookup"><span data-stu-id="9359f-102">Calculations</span></span>
  <span data-ttu-id="9359f-103">Вычисление — это многомерное выражение (MDX) или скрипт, который используется для определения вычисляемого элемента, именованного набора или назначения с областью действия в Кубе в [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9359f-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="9359f-104">Вычисления позволяют добавлять объекты, определенные не данными куба, а выражениями, которые могут ссылаться на прочие части куба, другие кубы, или даже данные вне базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9359f-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="9359f-105">Вычисления позволяют расширить возможности куба, увеличивая гибкость и производительность приложений бизнес-аналитики.</span><span class="sxs-lookup"><span data-stu-id="9359f-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="9359f-106">Дополнительные сведения о создании скриптов см. в разделе [Введение в скрипты многомерных выражений в Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span><span class="sxs-lookup"><span data-stu-id="9359f-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="9359f-107">Дополнительные сведения о проблемах с производительностью, связанных с запросами и вычислениями многомерных выражений, см. в статье [SQL Server 2005 Analysis Services по производительности](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span><span class="sxs-lookup"><span data-stu-id="9359f-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="9359f-108">Вычисляемые элементы</span><span class="sxs-lookup"><span data-stu-id="9359f-108">Calculated Members</span></span>  
 <span data-ttu-id="9359f-109">Вычисляемый элемент представляет собой элемент, значение которого вычисляется в процессе выполнения при помощи многомерного выражения, которое задается во время определения вычисляемого элемента.</span><span class="sxs-lookup"><span data-stu-id="9359f-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="9359f-110">Вычисляемый элемент доступен для приложений бизнес-аналитики, равно как и любой другой.</span><span class="sxs-lookup"><span data-stu-id="9359f-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="9359f-111">Вычисляемые элементы не увеличивают размер куба, потому что в кубе хранятся только определения; значения вычисляются в памяти, когда возникает необходимость ответить на запрос.</span><span class="sxs-lookup"><span data-stu-id="9359f-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="9359f-112">Вычисляемые элементы можно определять для любого измерения, включая измерение мер.</span><span class="sxs-lookup"><span data-stu-id="9359f-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="9359f-113">Вычисляемые элементы, созданные в измерении мер, называются вычисляемыми мерами.</span><span class="sxs-lookup"><span data-stu-id="9359f-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="9359f-114">Хотя вычисляемые элементы обычно основаны на данных, уже существующих в кубе, можно создавать сложные выражения, объединяя данные с арифметическими операторами, числами и функциями.</span><span class="sxs-lookup"><span data-stu-id="9359f-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="9359f-115">Функции многомерных выражений, такие как LookupCube, можно также использовать для доступа к другим кубам в базе данных [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9359f-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="9359f-116">В состав служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] входят библиотеки стандартизированных функций Visual Studio, при этом хранимые процедуры можно использовать для извлечения данных из источника, отличного от текущей базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9359f-116">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="9359f-117">Дополнительные сведения о хранимых процедурах см. в разделе [Определение хранимых процедур](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span><span class="sxs-lookup"><span data-stu-id="9359f-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="9359f-118">Например, предположим, что руководство судоходной компании хочет определить типы груза, наиболее выгодные с точки зрения перевозки, используя для этого показатель прибыли в расчете на единицу объема.</span><span class="sxs-lookup"><span data-stu-id="9359f-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="9359f-119">Берется куб «Перевозки», содержащий измерения «Груз», «Флот» и «Время» и меры «Цена_за_судно», «Стоимость_за_судно» и «Объем_в_кубических_метрах»; однако в кубе нет меры для прибыльности.</span><span class="sxs-lookup"><span data-stu-id="9359f-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="9359f-120">В кубе можно создать вычисляемый элемент как меру, именуемую «Прибыль_за_кубический_метр», путем объединения существующих мер в следующем выражении:</span><span class="sxs-lookup"><span data-stu-id="9359f-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="9359f-121">После создания вычисляемого элемента при следующем просмотре куба «Перевозки», мера «Прибыль_за_кубический_метр» появится вместе с другими мерами.</span><span class="sxs-lookup"><span data-stu-id="9359f-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="9359f-122">Для создания вычисляемых элементов используйте вкладку **вычисления**в конструкторе кубов.</span><span class="sxs-lookup"><span data-stu-id="9359f-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="9359f-123">Дополнительные сведения см. в разделе [Создание вычисляемых элементов](../multidimensional-models/create-calculated-members.md) .</span><span class="sxs-lookup"><span data-stu-id="9359f-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="9359f-124">Именованные наборы</span><span class="sxs-lookup"><span data-stu-id="9359f-124">Named Sets</span></span>  
 <span data-ttu-id="9359f-125">Именованным набором является многомерное выражение инструкции CREATE SET, которое возвращает набор.</span><span class="sxs-lookup"><span data-stu-id="9359f-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="9359f-126">МНОГОМЕРное выражение сохраняется как часть определения куба в [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9359f-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="9359f-127">Именованный набор создается для многократного использования в запросах многомерных выражений.</span><span class="sxs-lookup"><span data-stu-id="9359f-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="9359f-128">Именованный набор обеспечивает пользователям простоту создания запросов и, зачастую, позволяет использовать имя набора вместо выражений набора для сложных и часто применяемых выражений набора.</span><span class="sxs-lookup"><span data-stu-id="9359f-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="9359f-129">**Связанные разделы:** [Создание именованных наборов](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="9359f-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="9359f-130">Команды скриптов</span><span class="sxs-lookup"><span data-stu-id="9359f-130">Script Commands</span></span>  
 <span data-ttu-id="9359f-131">Команда скрипта представляет собой скрипт многомерного выражения, включенный в состав определения куба.</span><span class="sxs-lookup"><span data-stu-id="9359f-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="9359f-132">Команды скрипта позволяют осуществлять практически любое действие, поддерживаемое многомерными выражениями в кубе, такие как отнесение вычисления только к части куба.</span><span class="sxs-lookup"><span data-stu-id="9359f-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="9359f-133">В [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] скрипты многомерных выражений могут применяться либо ко всему кубу, либо к конкретным разделам куба в определенные моменты во время выполнения скрипта.</span><span class="sxs-lookup"><span data-stu-id="9359f-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="9359f-134">Команда скрипта по умолчанию, являющаяся инструкцией CALCULATE, заполняет ячейки в кубе статистическими данными, основанными на области по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="9359f-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="9359f-135">Областью по умолчанию является весь куб, но можно определить более ограниченную область, известную как вложенный куб, а затем применить скрипт многомерных выражений только к этому конкретному пространству куба.</span><span class="sxs-lookup"><span data-stu-id="9359f-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="9359f-136">Инструкция SCOPE определяет область всех последующих многомерных выражений и инструкций в пределах скрипта вычислений до окончания или переопределения области.</span><span class="sxs-lookup"><span data-stu-id="9359f-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="9359f-137">Затем используется инструкция THIS, чтобы применить многомерное выражение к текущей области.</span><span class="sxs-lookup"><span data-stu-id="9359f-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="9359f-138">Можно использовать инструкцию BACK_COLOR, чтобы задать фоновый цвет ячеек в текущей области, что может быть полезно при отладке.</span><span class="sxs-lookup"><span data-stu-id="9359f-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="9359f-139">Например, можно использовать команду скрипта для распределения между сотрудниками квот на продажи по времени и территории продаж на основе взвешенных значений продаж за предыдущий период времени.</span><span class="sxs-lookup"><span data-stu-id="9359f-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9359f-140">См. также:</span><span class="sxs-lookup"><span data-stu-id="9359f-140">See Also</span></span>  
 [<span data-ttu-id="9359f-141">Вычисления в многомерных моделях</span><span class="sxs-lookup"><span data-stu-id="9359f-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
