---
title: Вычисления | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738978"
---
# <a name="calculations"></a>Вычисления
  Вычисление — это многомерное выражение (MDX) или скрипт, который используется для определения вычисляемого элемента, именованного набора или назначения с областью действия в Кубе в [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] . Вычисления позволяют добавлять объекты, определенные не данными куба, а выражениями, которые могут ссылаться на прочие части куба, другие кубы, или даже данные вне базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Вычисления позволяют расширить возможности куба, увеличивая гибкость и производительность приложений бизнес-аналитики. Дополнительные сведения о создании скриптов см. в разделе [Введение в скрипты многомерных выражений в Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892). Дополнительные сведения о проблемах с производительностью, связанных с запросами и вычислениями многомерных выражений, см. в статье [SQL Server 2005 Analysis Services по производительности](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).  
  
## <a name="calculated-members"></a>Вычисляемые элементы  
 Вычисляемый элемент представляет собой элемент, значение которого вычисляется в процессе выполнения при помощи многомерного выражения, которое задается во время определения вычисляемого элемента. Вычисляемый элемент доступен для приложений бизнес-аналитики, равно как и любой другой. Вычисляемые элементы не увеличивают размер куба, потому что в кубе хранятся только определения; значения вычисляются в памяти, когда возникает необходимость ответить на запрос.  
  
 Вычисляемые элементы можно определять для любого измерения, включая измерение мер. Вычисляемые элементы, созданные в измерении мер, называются вычисляемыми мерами.  
  
 Хотя вычисляемые элементы обычно основаны на данных, уже существующих в кубе, можно создавать сложные выражения, объединяя данные с арифметическими операторами, числами и функциями. Функции многомерных выражений, такие как LookupCube, можно также использовать для доступа к другим кубам в базе данных [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. В состав служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] входят библиотеки стандартизированных функций Visual Studio, при этом хранимые процедуры можно использовать для извлечения данных из источника, отличного от текущей базы данных служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Дополнительные сведения о хранимых процедурах см. в разделе [Определение хранимых процедур](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).  
  
 Например, предположим, что руководство судоходной компании хочет определить типы груза, наиболее выгодные с точки зрения перевозки, используя для этого показатель прибыли в расчете на единицу объема. Берется куб «Перевозки», содержащий измерения «Груз», «Флот» и «Время» и меры «Цена_за_судно», «Стоимость_за_судно» и «Объем_в_кубических_метрах»; однако в кубе нет меры для прибыльности. В кубе можно создать вычисляемый элемент как меру, именуемую «Прибыль_за_кубический_метр», путем объединения существующих мер в следующем выражении:  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 После создания вычисляемого элемента при следующем просмотре куба «Перевозки», мера «Прибыль_за_кубический_метр» появится вместе с другими мерами.  
  
 Для создания вычисляемых элементов используйте вкладку **вычисления**в конструкторе кубов. Дополнительные сведения см. в разделе [Создание вычисляемых элементов](../multidimensional-models/create-calculated-members.md) .  
  
## <a name="named-sets"></a>Именованные наборы  
 Именованным набором является многомерное выражение инструкции CREATE SET, которое возвращает набор. МНОГОМЕРное выражение сохраняется как часть определения куба в [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] . Именованный набор создается для многократного использования в запросах многомерных выражений. Именованный набор обеспечивает пользователям простоту создания запросов и, зачастую, позволяет использовать имя набора вместо выражений набора для сложных и часто применяемых выражений набора. **Связанные разделы:** [Создание именованных наборов](../multidimensional-models/create-named-sets.md)  
  
## <a name="script-commands"></a>Команды скриптов  
 Команда скрипта представляет собой скрипт многомерного выражения, включенный в состав определения куба. Команды скрипта позволяют осуществлять практически любое действие, поддерживаемое многомерными выражениями в кубе, такие как отнесение вычисления только к части куба. В [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] скрипты многомерных выражений могут применяться либо ко всему кубу, либо к конкретным разделам куба в определенные моменты во время выполнения скрипта. Команда скрипта по умолчанию, являющаяся инструкцией CALCULATE, заполняет ячейки в кубе статистическими данными, основанными на области по умолчанию.  
  
 Областью по умолчанию является весь куб, но можно определить более ограниченную область, известную как вложенный куб, а затем применить скрипт многомерных выражений только к этому конкретному пространству куба. Инструкция SCOPE определяет область всех последующих многомерных выражений и инструкций в пределах скрипта вычислений до окончания или переопределения области. Затем используется инструкция THIS, чтобы применить многомерное выражение к текущей области. Можно использовать инструкцию BACK_COLOR, чтобы задать фоновый цвет ячеек в текущей области, что может быть полезно при отладке.  
  
 Например, можно использовать команду скрипта для распределения между сотрудниками квот на продажи по времени и территории продаж на основе взвешенных значений продаж за предыдущий период времени.  
  
## <a name="see-also"></a>См. также:  
 [Вычисления в многомерных моделях](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
