---
title: Связи измерений | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- relationships [Analysis Services]
- member groups [Analysis Services]
- regular dimensions [Analysis Services]
- many-to-many relationships [Analysis Services]
- cubes [Analysis Services], relationships
- reference dimensions
- dimensions [Analysis Services], relationships
- fact dimensions [Analysis Services]
- relationships [Analysis Services], dimensions
ms.assetid: de54c059-cb0f-4f66-bd70-8605af05ec4f
author: minewiskan
ms.author: owend
ms.openlocfilehash: 2334c1a97bb4172fff70550dbece5376eb1cb9d7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738972"
---
# <a name="dimension-relationships"></a><span data-ttu-id="e1cfb-102">Связи измерений</span><span class="sxs-lookup"><span data-stu-id="e1cfb-102">Dimension Relationships</span></span>
  <span data-ttu-id="e1cfb-103">Использование измерений определяет связи между измерением куба и группами мер в нем.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-103">Dimension usage defines the relationships between a cube dimension and the measure groups in a cube.</span></span> <span data-ttu-id="e1cfb-104">Измерение куба представляет собой экземпляр измерения базы данных, используемый в конкретном кубе.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-104">A cube dimension is an instance of a database dimension that is used in a specific cube.</span></span> <span data-ttu-id="e1cfb-105">Куб может содержать (и часто содержит) измерения, которые не связаны непосредственно с группой мер, но которые могут быть косвенно связаны с ней через другое измерение или группу мер.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-105">A cube can, and frequently does, have cube dimensions that are not directly related to a measure group, but which might be indirectly related to the measure group through another dimension or measure group.</span></span> <span data-ttu-id="e1cfb-106">При добавлении измерения базы данных или группы мер в куб [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] пытается определить использование измерения путем проверки связей между таблицами измерений и таблицами фактов в представлении источника данных куба, а также путем проверки связей между атрибутами в измерениях.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-106">When you add a database dimension or measure group to a cube, [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tries to determine dimension usage by examining relationships between the dimension tables and fact tables in the cube's data source view, and by examining the relationships between attributes in dimensions.</span></span> <span data-ttu-id="e1cfb-107">Службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] автоматически устанавливают параметры использования измерений для связей, которые они смогли обнаружить.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-107">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] automatically sets the dimension usage settings for the relationships that it can detect.</span></span>  
  
 <span data-ttu-id="e1cfb-108">Связь между измерением и группой мер состоит из таблиц измерений и фактов, участвующих в связи, и атрибута гранулярности, указывающего детализацию измерения в конкретной группе мер.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-108">A relationship between a dimension and a measure group consists of the dimension and fact tables participating in the relationship and a granularity attribute that specifies the granularity of the dimension in the particular measure group.</span></span>  
  
## <a name="regular-dimension-relationships"></a><span data-ttu-id="e1cfb-109">Связи обычного измерения</span><span class="sxs-lookup"><span data-stu-id="e1cfb-109">Regular Dimension Relationships</span></span>  
 <span data-ttu-id="e1cfb-110">Связь обычного измерения между измерением куба и группой мер существует, когда ключевой столбец для измерения соединен непосредственно с таблицей фактов.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-110">A regular dimension relationship between a cube dimension and a measure group exists when the key column for the dimension is joined directly to the fact table.</span></span> <span data-ttu-id="e1cfb-111">Эта прямая связь основана на связи "первичный ключ — внешний ключ" в базовой реляционной базе данных, но может также основываться на логической связи, определенной в представлении источника данных.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-111">This direct relationship is based on a primary key-foreign key relationship in the underlying relational database, but might also be based on a logical relationship that is defined in the data source view.</span></span> <span data-ttu-id="e1cfb-112">Связь обычного измерения представляет связь между таблицами измерений и таблицей фактов в традиционной структуре схемы «звезда».</span><span class="sxs-lookup"><span data-stu-id="e1cfb-112">A regular dimension relationship represents the relationship between dimension tables and a fact table in a traditional star schema design.</span></span> <span data-ttu-id="e1cfb-113">Дополнительные сведения о обычных связях см. [в разделе Определение обычной связи и свойств обычных связей](../multidimensional-models/define-a-regular-relationship-and-regular-relationship-properties.md).</span><span class="sxs-lookup"><span data-stu-id="e1cfb-113">For more information about regular relationships, see [Define a Regular Relationship and Regular Relationship Properties](../multidimensional-models/define-a-regular-relationship-and-regular-relationship-properties.md).</span></span>  
  
## <a name="reference-dimension-relationships"></a><span data-ttu-id="e1cfb-114">Связи ссылочного измерения</span><span class="sxs-lookup"><span data-stu-id="e1cfb-114">Reference Dimension Relationships</span></span>  
 <span data-ttu-id="e1cfb-115">Связь ссылочного измерения между измерением куба и группой мер существует в том случае, когда ключевой столбец измерения косвенно соединен с таблицей фактов по ключу в другой таблице измерения, как показано на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-115">A reference dimension relationship between a cube dimension and a measure group exists when the key column for the dimension is joined indirectly to the fact table through a key in another dimension table, as shown in the following illustration.</span></span>  
  
 <span data-ttu-id="e1cfb-116">![Логическая диаграмма, связь измерений, на которую дана ссылка](../../analysis-services/dev-guide/media/as-refdimension1.gif "Логическая диаграмма, связь измерений, на которую дана ссылка")</span><span class="sxs-lookup"><span data-stu-id="e1cfb-116">![Logical diagram, referenced dimension relationship](../../analysis-services/dev-guide/media/as-refdimension1.gif "Logical diagram, referenced dimension relationship")</span></span>  
  
 <span data-ttu-id="e1cfb-117">Связь ссылочного измерения представляет связь между таблицами измерений и таблицей фактов в структуре схемы «снежинка».</span><span class="sxs-lookup"><span data-stu-id="e1cfb-117">A reference dimension relationship represents the relationship between dimension tables and a fact table in a snowflake schema design.</span></span> <span data-ttu-id="e1cfb-118">Когда таблицы измерений связаны по схеме «снежинка», можно определить либо одно измерение с использованием столбцов из нескольких таблиц, либо определить отдельные измерения на основе отдельных таблиц измерений, а затем задать связь между ними при помощи параметров связи ссылочного измерения.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-118">When dimension tables are connected in a snowflake schema, you can define a single dimension using columns from multiple tables, or you can define separate dimensions based on the separate dimension tables and then define a link between them using the reference dimension relationship setting.</span></span> <span data-ttu-id="e1cfb-119">На следующем рисунке показана одна таблица фактов с именем **InternetSales**и две таблицы измерений, называемые **Customer** и **Geography**, в схеме «снежинка».</span><span class="sxs-lookup"><span data-stu-id="e1cfb-119">The following figure shows one fact table named **InternetSales**, and two dimension tables called **Customer** and **Geography**, in a snowflake schema.</span></span>  
  
 <span data-ttu-id="e1cfb-120">![Логическая схема, связь измерений, на которую дана ссылка](../../analysis-services/dev-guide/media/as-refdim-schema1.gif "Логическая схема, связь измерений, на которую дана ссылка")</span><span class="sxs-lookup"><span data-stu-id="e1cfb-120">![Logical schema, referenced dimension relationship](../../analysis-services/dev-guide/media/as-refdim-schema1.gif "Logical schema, referenced dimension relationship")</span></span>  
  
 <span data-ttu-id="e1cfb-121">Можно создать измерение с таблицей **Customer** в качестве главной таблицы измерения и таблицы **Geography** , входящей в состав связанной таблицы.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-121">You can create a dimension with the **Customer** table as the dimension main table and the **Geography** table included as a related table.</span></span> <span data-ttu-id="e1cfb-122">После этого определяется обычная связь между измерением и группой мер «Интернет-продажи».</span><span class="sxs-lookup"><span data-stu-id="e1cfb-122">A regular relationship is then defined between the dimension and the InternetSales measure group.</span></span>  
  
 <span data-ttu-id="e1cfb-123">Кроме того, можно создать два измерения, связанные с группой мер InternetSales: измерение, основанное на таблице **Customer** , и измерение, основанное на таблице **Geography** .</span><span class="sxs-lookup"><span data-stu-id="e1cfb-123">Alternatively, you can create two dimensions related to the InternetSales measure group: a dimension based on the **Customer** table, and a dimension based on the **Geography** table.</span></span> <span data-ttu-id="e1cfb-124">После этого можно связать измерение «География» с группой мер «Интернет-продажи», используя связь ссылочного измерения, в которую входит измерение «Заказчик».</span><span class="sxs-lookup"><span data-stu-id="e1cfb-124">You can then relate the Geography dimension to the InternetSales measure group using a reference dimension relationship using the Customer dimension.</span></span> <span data-ttu-id="e1cfb-125">В этом случае, когда факты в группе мер «Интернет-продажи» измеряются измерением «География», факты измеряются по заказчикам и по географии.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-125">In this case, when the facts in the InternetSales measure group are dimensioned by the Geography dimension, the facts are dimensioned by customer and by geography.</span></span> <span data-ttu-id="e1cfb-126">Если куб содержит вторую группу мер «Товарооборот посредников», то измерить факты в группе мер «Товарооборот посредников» по таблице Geography невозможно, поскольку связи между группой мер «Товарооборот посредников» и Geography не существует.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-126">If the cube contained a second measure group named Reseller Sales, you would be unable to dimension the facts in the Reseller Sales measure group by Geography because no relationship would exist between Reseller Sales and Geography.</span></span>  
  
 <span data-ttu-id="e1cfb-127">Ограничения на количество ссылочных измерений, которые могут быть соединены друг с другом, нет, как показано на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-127">There is no limit to the number of reference dimensions that can be chained together, as shown in the following illustration.</span></span>  
  
 <span data-ttu-id="e1cfb-128">![Логическая диаграмма, связь измерений, на которую дана ссылка](../../analysis-services/dev-guide/media/as-refdimension2.gif "Логическая диаграмма, связь измерений, на которую дана ссылка")</span><span class="sxs-lookup"><span data-stu-id="e1cfb-128">![Logical diagram, referenced dimension relationship](../../analysis-services/dev-guide/media/as-refdimension2.gif "Logical diagram, referenced dimension relationship")</span></span>  
  
 <span data-ttu-id="e1cfb-129">Дополнительные сведения о ссылочных связях см. [в разделе Определение ссылочной связи и свойств ссылочной связи](../multidimensional-models/define-a-referenced-relationship-and-referenced-relationship-properties.md).</span><span class="sxs-lookup"><span data-stu-id="e1cfb-129">For more information about referenced relationships, see [Define a Referenced Relationship and Referenced Relationship Properties](../multidimensional-models/define-a-referenced-relationship-and-referenced-relationship-properties.md).</span></span>  
  
## <a name="fact-dimension-relationships"></a><span data-ttu-id="e1cfb-130">Связи измерения фактов</span><span class="sxs-lookup"><span data-stu-id="e1cfb-130">Fact Dimension Relationships</span></span>  
 <span data-ttu-id="e1cfb-131">Измерения фактов, обычно называемые вырожденными измерениями, представляют собой стандартные измерения, составленные из столбцов атрибутов в таблицах фактов, а не из столбцов атрибутов в таблицах измерений.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-131">Fact dimensions, frequently referred to as degenerate dimensions, are standard dimensions that are constructed from attribute columns in fact tables instead of from attribute columns in dimension tables.</span></span> <span data-ttu-id="e1cfb-132">Полезные данные измерений иногда хранятся в таблице фактов с целью снижения дублирования.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-132">Useful dimensional data is sometimes stored in a fact table to reduce duplication.</span></span> <span data-ttu-id="e1cfb-133">Например, на следующей диаграмме показана таблица фактов **FactResellerSales** из [!INCLUDE[ssAWDWsp](../../includes/ssawdwsp-md.md)] образца базы данных.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-133">For example, the following diagram displays the **FactResellerSales** fact table, from the [!INCLUDE[ssAWDWsp](../../includes/ssawdwsp-md.md)] sample database.</span></span>  
  
 <span data-ttu-id="e1cfb-134">![Столбцы таблицы фактов, поддерживающие измерения](../../analysis-services/dev-guide/media/as-factdim.gif "Столбцы таблицы фактов, поддерживающие измерения")</span><span class="sxs-lookup"><span data-stu-id="e1cfb-134">![Columns in fact table can support dimensions](../../analysis-services/dev-guide/media/as-factdim.gif "Columns in fact table can support dimensions")</span></span>  
  
 <span data-ttu-id="e1cfb-135">Эта таблица содержит данные об атрибутах не только для каждой строки заказа, оформленного посредником, но и для самого заказа.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-135">The table contains attribute information not only for each line of an order issued by a reseller, but about the order itself.</span></span> <span data-ttu-id="e1cfb-136">Атрибуты, кружки на предыдущей схеме, указывают сведения в таблице **FactResellerSales** , которые могут использоваться в качестве атрибутов в измерении.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-136">The attributes circled in the previous diagram identify the information in the **FactResellerSales** table that could be used as attributes in a dimension.</span></span> <span data-ttu-id="e1cfb-137">В этом случае два дополнительных элемента данных — сопроводительный номер перевозчика и номер заказа на покупку, оформленного посредником, представлены столбцами атрибутов CarrierTrackingNumber и CustomerPONumber.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-137">In this case, two additional pieces of information, the carrier tracking number and the purchase order number issued by the reseller, are represented by the CarrierTrackingNumber and CustomerPONumber attribute columns.</span></span> <span data-ttu-id="e1cfb-138">Эти сведения являются интересными. Например, пользователи наверняка заинтересованы в просмотре статистических данных, таких как общая стоимость продукта, для всех заказов, отправляемых по одному номеру для отслеживания.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-138">This information is interesting-for example, users would definitely be interested in seeing aggregated information, such as the total product cost, for all the orders being shipped under a single tracking number.</span></span> <span data-ttu-id="e1cfb-139">Однако без измерения данные по этим двум атрибутам не могут быть ни организованы, ни статистически обработаны.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-139">But, without a dimension data for these two attributes cannot be organized or aggregated.</span></span>  
  
 <span data-ttu-id="e1cfb-140">Теоретически можно создать таблицу измерения, использующую те же самые ключевые данные, что и таблица FactResellerSales, и переместить два остальных столбца атрибутов, CarrierTrackingNumber и CustomerPONumber, в эту таблицу измерения.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-140">In theory, you could create a dimension table that uses the same key information as the FactResellerSales table and move the other two attribute columns, CarrierTrackingNumber and CustomerPONumber, to that dimension table.</span></span> <span data-ttu-id="e1cfb-141">Однако при этом произойдет дублирование значительной части данных, а также излишнее усложнение хранилища данных с целью представления всего двух атрибутов в отдельном измерении.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-141">However, you would be duplicating a significant portion of data and adding unnecessary complexity to the data warehouse to represent just two attributes as a separate dimension.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e1cfb-142">Измерения фактов часто используются для поддержки операций детализации.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-142">Fact dimensions are frequently used to support drillthrough actions.</span></span> <span data-ttu-id="e1cfb-143">Дополнительные сведения о действиях см. в разделе [Действия (службы Analysis Services — многомерные данные)](../multidimensional-models/actions-analysis-services-multidimensional-data.md).</span><span class="sxs-lookup"><span data-stu-id="e1cfb-143">For more information about actions, see [Actions &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models/actions-analysis-services-multidimensional-data.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e1cfb-144">Необходимо осуществлять добавочное обновление измерений фактов после каждого обновления группы мер, на которую ссылается связь фактов.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-144">Fact dimensions must be incrementally updated after every update to the measure group that is referenced by the fact relationship.</span></span> <span data-ttu-id="e1cfb-145">Если измерение фактов является измерением ROLAP, то механизм обработки служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] очищает все кэши и осуществляет добавочную обработку группы мер.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-145">If the fact dimension is a ROLAP dimension, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] processing engine drops any caches and incrementally processes the measure group.</span></span>  
  
 <span data-ttu-id="e1cfb-146">Дополнительные сведения о связях фактов см. [в разделе Определение связей фактов и свойств связей фактов](../multidimensional-models/define-a-fact-relationship-and-fact-relationship-properties.md).</span><span class="sxs-lookup"><span data-stu-id="e1cfb-146">For more information about fact relationships, see [Define a Fact Relationship and Fact Relationship Properties](../multidimensional-models/define-a-fact-relationship-and-fact-relationship-properties.md).</span></span>  
  
## <a name="many-to-many-dimension-relationships"></a><span data-ttu-id="e1cfb-147">Связи измерений «многие ко многим»</span><span class="sxs-lookup"><span data-stu-id="e1cfb-147">Many to Many Dimension Relationships</span></span>  
 <span data-ttu-id="e1cfb-148">В большинстве измерений каждый факт соединяется с одним и только одним элементом измерения, а один элемент измерения может быть связан с несколькими фактами.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-148">In most dimensions, each fact joins to one and only one dimension member, and a single dimension member can be associated with multiple facts.</span></span> <span data-ttu-id="e1cfb-149">В терминах реляционных баз данных такая связь имеет название «один ко многим».</span><span class="sxs-lookup"><span data-stu-id="e1cfb-149">In relational database terminology, this is referred to as a one-to-many relationship.</span></span> <span data-ttu-id="e1cfb-150">Однако часто полезно соединять один факт с несколькими элементами измерения.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-150">However, it is frequently useful to join a single fact to multiple dimension members.</span></span> <span data-ttu-id="e1cfb-151">Например, клиент банка может иметь несколько счетов (чековый, сберегательный, кредитный и инвестиционный), в то время как счет также может иметь нескольких владельцев или совладельцев.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-151">For example, a bank customer might have multiple accounts (checking, saving, credit card, and investment accounts), and an account can also have joint or multiple owners.</span></span> <span data-ttu-id="e1cfb-152">Измерение «Клиент», построенное на основе таких связей, имело бы несколько элементов, относящихся к одной транзакции по счету.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-152">The Customer dimension constructed from such relationships would then have multiple members that relate to a single account transaction.</span></span>  
  
 <span data-ttu-id="e1cfb-153">![Логическая схема или связь измерений «многие ко многим»](../../analysis-services/dev-guide/media/as-many-dimension1.gif "Логическая схема или связь измерений «многие ко многим»")</span><span class="sxs-lookup"><span data-stu-id="e1cfb-153">![Logical schema/many-to-many dimension relationship](../../analysis-services/dev-guide/media/as-many-dimension1.gif "Logical schema/many-to-many dimension relationship")</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="e1cfb-154">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]позволяет определить связь «многие ко многим» между измерением и таблицей фактов.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-154">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] lets you define a many-to-many relationship between a dimension and a fact table.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e1cfb-155">Для обеспечения поддержки связи измерений «многие ко многим» в представлении источника данных должна быть установлена связь по внешнему ключу между всеми участвующими таблицами, как показано на предыдущей диаграмме.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-155">To support a many-to-many dimension relationship, the data source view must have established a foreign key relationship between all the tables involved, as shown in the previous diagram.</span></span> <span data-ttu-id="e1cfb-156">В противном случае вы не сможете выбрать правильную промежуточную группу мер при установлении связи на вкладке **Использование измерений** конструктора измерений.</span><span class="sxs-lookup"><span data-stu-id="e1cfb-156">Otherwise, you will be unable to select the correct intermediate measure group when establishing the relationship in the **Dimension Usage** tab of Dimension Designer.</span></span>  
  
 <span data-ttu-id="e1cfb-157">Дополнительные сведения о связях "многие ко многим" см. в разделе Определение связи "многие ко многим" [и свойства связи "многие ко](../multidimensional-models/define-a-many-to-many-relationship-and-many-to-many-relationship-properties.md)многим".</span><span class="sxs-lookup"><span data-stu-id="e1cfb-157">For more information about many-to-many relationships, see [Define a Many-to-Many Relationship and Many-to-Many Relationship Properties](../multidimensional-models/define-a-many-to-many-relationship-and-many-to-many-relationship-properties.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e1cfb-158">См. также:</span><span class="sxs-lookup"><span data-stu-id="e1cfb-158">See Also</span></span>  
 [<span data-ttu-id="e1cfb-159">Измерения (службы Analysis Services — многомерные данные)</span><span class="sxs-lookup"><span data-stu-id="e1cfb-159">Dimensions &#40;Analysis Services - Multidimensional Data&#41;</span></span>](../multidimensional-models-olap-logical-dimension-objects/dimensions-analysis-services-multidimensional-data.md)  
  
  
