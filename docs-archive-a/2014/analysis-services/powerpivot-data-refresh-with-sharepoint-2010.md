---
title: Обновление данных PowerPivot с SharePoint 2010 | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 01b54e6f-66e5-485c-acaa-3f9aa53119c9
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01874bf521055d1441b695a238d09440021d2718
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87735553"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2010"></a><span data-ttu-id="dd7eb-102">Обновление данных PowerPivot с SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="dd7eb-102">PowerPivot Data Refresh with SharePoint 2010</span></span>
  <span data-ttu-id="dd7eb-103">Обновление данных [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] представляет собой плановую операцию на сервере, при выполнении которой отправляются запросы внешним источникам данных для обновления внедренных данных [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] в книге Excel 2010, хранящейся в библиотеке содержимого.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-103">[!INCLUDE[ssGemini](../includes/ssgemini-md.md)]t data refresh is a scheduled server-side operation that queries external data sources to update embedded [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data in an Excel 2010 workbook that is stored in a content library.</span></span>

 <span data-ttu-id="dd7eb-104">Обновление данных — встроенная функция [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] для SharePoint, однако для ее использования необходимо наличие специальных служб и заданий таймера на ферме SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-104">Data refresh is a built-in feature of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint, but using it requires that you run specific services and timer jobs in your SharePoint 2010 farm.</span></span> <span data-ttu-id="dd7eb-105">Дополнительные шаги администрирования, такие как установка поставщиков данных и проверка разрешений баз данных, зачастую являются обязательными для выполнения обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-105">Additional administrative steps, such as installing data providers and checking database permissions, are often required for data refresh to succeed.</span></span>

 <span data-ttu-id="dd7eb-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="dd7eb-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>

> [!NOTE]
>  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="dd7eb-107">и SharePoint Server 2013 Excel Services используется другая архитектура для обновления сведений в моделях данных [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="dd7eb-107">and SharePoint Server 2013 Excel Services use a different architecture for data refresh of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data models.</span></span> <span data-ttu-id="dd7eb-108">Новая архитектура в качестве основного компонента для загрузки моделей данных PowerPivot использует службы Excel.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-108">The new architecture utilizes Excel Services as the primary component to load PowerPivot data models.</span></span> <span data-ttu-id="dd7eb-109">В прежней архитектуре обновления данных для загрузки моделей данных использовался сервер с PowerPivot System Service и [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] в режиме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-109">The previous data refresh architecture used relied on a server running PowerPivot System Service and [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] in SharePoint mode to load data models.</span></span> <span data-ttu-id="dd7eb-110">Дополнительные сведения см. [в разделе PowerPivot Data Refresh with SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-110">For more information, see [PowerPivot Data Refresh with SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span></span>

 <span data-ttu-id="dd7eb-111">**В этом разделе:**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-111">**In this topic:**</span></span>

 [<span data-ttu-id="dd7eb-112">Шаг 1. Включение служба Secure Store и создание главного ключа</span><span class="sxs-lookup"><span data-stu-id="dd7eb-112">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>](#bkmk_services)

 [<span data-ttu-id="dd7eb-113">Шаг 2. Отключение параметров учетных данных, которые не требуется поддерживать</span><span class="sxs-lookup"><span data-stu-id="dd7eb-113">Step 2: Turn off credential options that you do not want to support</span></span>](#bkmk_creds)

 [<span data-ttu-id="dd7eb-114">Шаг 3. Создание целевых приложений для хранения учетных данных, используемых при обновлении данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-114">Step 3: Create target applications to store credentials used in data refresh</span></span>](#bkmk_stored)

 [<span data-ttu-id="dd7eb-115">Шаг 4. Настройка масштабируемого обновления данных на сервере</span><span class="sxs-lookup"><span data-stu-id="dd7eb-115">Step 4: Configure the server for scalable data refresh</span></span>](#bkmk_scale)

 [<span data-ttu-id="dd7eb-116">Шаг 5. Установка поставщиков данных, используемых для импорта данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="dd7eb-116">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>](#bkmk_installdp)

 [<span data-ttu-id="dd7eb-117">Шаг 6. Предоставление разрешений на создание расписаний и доступ к внешним источникам данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-117">Step 6: Grant permissions to create schedules and access external data sources</span></span>](#bkmk_accounts)

 [<span data-ttu-id="dd7eb-118">Шаг 7. Включение обновления данных в книге</span><span class="sxs-lookup"><span data-stu-id="dd7eb-118">Step 7: Enable workbook upgrade for data refresh</span></span>](#bkmk_upgradewrkbk)

 [<span data-ttu-id="dd7eb-119">Шаг 8. Проверка конфигурации обновления данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-119">Step 8: Verify data refresh configuration</span></span>](#bkmk_verify)

 [<span data-ttu-id="dd7eb-120">Изменение параметров конфигурации для обновления данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-120">Modify Configuration Settings for Data Refresh</span></span>](#bkmk_config)

 [<span data-ttu-id="dd7eb-121">Изменение расписания для задания таймера обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="dd7eb-121">Reschedule the PowerPivot Data Refresh timer job</span></span>](#configTimerJob)

 [<span data-ttu-id="dd7eb-122">Отключение задания таймера обновления данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-122">Disable the Data Refresh Timer Job</span></span>](#bkmk_disableDR)

 <span data-ttu-id="dd7eb-123">После того как среда и разрешения сервера настроены, обновление данных готово к использованию.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-123">After you ensure that the server environment and permissions are configured, data refresh is ready to use.</span></span> <span data-ttu-id="dd7eb-124">Чтобы обновить данные, пользователь SharePoint должен создать расписание для книги PowerPivot, в котором будет указано, как часто должно происходить обновление данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-124">To use data refresh, a SharePoint user creates a schedule on a PowerPivot workbook that specifies how often data refresh occurs.</span></span> <span data-ttu-id="dd7eb-125">Создание расписания обычно выполняется владельцем книги или автором, опубликовавшим файл на SharePoint.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-125">Creating the schedule is typically done by the workbook owner or author who published the file to SharePoint.</span></span> <span data-ttu-id="dd7eb-126">Пользователь должен создать расписание обновления данных для принадлежащих ему книг и управлять созданными расписаниями.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-126">This person creates and manages the data refresh schedules for the workbooks that he or she owns.</span></span> <span data-ttu-id="dd7eb-127">Дополнительные сведения см. [в разделе планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-127">For more information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>

##  <a name="step-1-enable-secure-store-service-and-generate-a-master-key"></a><a name="bkmk_services"></a><span data-ttu-id="dd7eb-128">Шаг 1. Включение служба Secure Store и создание главного ключа</span><span class="sxs-lookup"><span data-stu-id="dd7eb-128">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>
 <span data-ttu-id="dd7eb-129">Обновление данных PowerPivot зависит от служб Secure Store, которые хранят учетные данные, используемые для запуска заданий обновления данных и для соединения с внешними источниками данных, в которых хранятся эти учетные данные.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-129">PowerPivot data refresh depends on Secure Store Service to provide credentials used to run data refresh jobs and to connect to external data sources that use stored credentials.</span></span>

 <span data-ttu-id="dd7eb-130">При установке PowerPivot для SharePoint в режиме «Новый сервер» служба Secure Store настраивается автоматически.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-130">If you installed PowerPivot for SharePoint using the New Server option, the Secure Store Service is configured for you.</span></span> <span data-ttu-id="dd7eb-131">При любом другом варианте установки необходимо создать и настроить приложение службы и создать главный ключ шифрования для службы Secure Store.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-131">For all other installation scenarios, you must create and configure a service application and generate a master encryption key for Secure Store Service.</span></span>

> [!NOTE]
>  <span data-ttu-id="dd7eb-132">Чтобы настроить службу Secure Store, следует иметь права администратора или делегировать управление службой Secure Store другому пользователю.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-132">You must be a farm administrator to configure Secure Store Service or delegate Secure Store Service administration to another user.</span></span> <span data-ttu-id="dd7eb-133">Чтобы настроить или изменить параметры после включения службы, необходимо иметь права администратора приложения службы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-133">You must be a service application administrator to configure or modify settings after it is enabled.</span></span>

1.  <span data-ttu-id="dd7eb-134">В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-134">In Central Administration, in Application Management, click **Manage service applications**.</span></span>

2.  <span data-ttu-id="dd7eb-135">На ленте приложения службы в поле Создать щелкните **создать.**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-135">In the Service Applications ribbon, in Create, click **New**.</span></span>

3.  <span data-ttu-id="dd7eb-136">Выберите **Служба Secure Store**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-136">Select **Secure Store Service**.</span></span>

4.  <span data-ttu-id="dd7eb-137">На странице **Создание приложения Secure Store** введите имя приложения.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-137">In the **Create Secure Store Application** page, enter a name for the application.</span></span>

5.  <span data-ttu-id="dd7eb-138">В поле **база данных**укажите экземпляр SQL Server, в котором будет размещена база данных для этого приложения службы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-138">In **Database**, specify the SQL Server instance that will host the database for this service application.</span></span> <span data-ttu-id="dd7eb-139">Значением по умолчанию является экземпляр компонента SQL Server Database Engine, в котором размещены базы данных конфигураций фермы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-139">The default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span>

6.  <span data-ttu-id="dd7eb-140">В поле **имя базы данных**введите имя базы данных приложения службы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-140">In **Database Name**, enter the name of the service application database.</span></span> <span data-ttu-id="dd7eb-141">Значение по умолчанию — Secure_Store_Service_DB_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="dd7eb-141">The default value is Secure_Store_Service_DB_\<guid>.</span></span> <span data-ttu-id="dd7eb-142">Имя, используемое по умолчанию, соответствует используемому по умолчанию имени приложения службы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-142">The default name corresponds to the default name of the service application.</span></span> <span data-ttu-id="dd7eb-143">Если было введено уникальное имя приложения службы, следуйте аналогичным соглашениях об именах при выборе имени базы данных, чтобы ими можно было управлять совместно.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-143">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>

7.  <span data-ttu-id="dd7eb-144">В списке **Проверка подлинности базы данных**по умолчанию выбрано значение «Проверка подлинности Windows».</span><span class="sxs-lookup"><span data-stu-id="dd7eb-144">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="dd7eb-145">Если выбран параметр «Проверка подлинности SQL», то рекомендации по использованию проверки подлинности этого типа см. в руководстве администратора SharePoint.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-145">If you choose SQL Authentication, refer to the SharePoint administrator guide for guidance on how to use the authentication type in your farm.</span></span>

8.  <span data-ttu-id="dd7eb-146">В списке пул приложений выберите **создать новый пул приложений.**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-146">In Application Pool, select **Create new application pool.**</span></span> <span data-ttu-id="dd7eb-147">Укажите описательное имя, которое поможет другим администраторам понять, как используется этот пул приложений.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-147">Specify a descriptive name that will help other server administrators identify how the application pool is used.</span></span>

9. <span data-ttu-id="dd7eb-148">Выберите учетную запись безопасности для пула приложений.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-148">Select a security account for the application pool.</span></span> <span data-ttu-id="dd7eb-149">Укажите управляемую учетную запись, которая будет использовать учетную запись пользователя домена.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-149">Specify a managed account to use a domain user account.</span></span>

10. <span data-ttu-id="dd7eb-150">Примите остальные значения по умолчанию и нажмите кнопку **ОК.**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-150">Accept the remaining default values, and then click **OK.**</span></span> <span data-ttu-id="dd7eb-151">Приложение службы появится рядом с другими управляемыми службами в списке приложений служб фермы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-151">The service application will appear alongside other managed services in the farm's service application list.</span></span>

11. <span data-ttu-id="dd7eb-152">Щелкните приложение службы Secure Store в списке.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-152">Click the Secure Store Service application from the list.</span></span>

12. <span data-ttu-id="dd7eb-153">На ленте приложения службы щелкните **Управление**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-153">In the Service Applications ribbon, click **Manage**.</span></span>

13. <span data-ttu-id="dd7eb-154">В разделе Управление ключами щелкните **создать новый ключ**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-154">In Key Management, click **Generate New Key**.</span></span>

14. <span data-ttu-id="dd7eb-155">Введите, а затем подтвердите парольную фразу.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-155">Enter and then confirm a pass phrase.</span></span> <span data-ttu-id="dd7eb-156">Эта фраза будет использоваться для добавления других общих приложений служб безопасных хранилищ.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-156">The pass phrase will be used to add additional secure store shared service applications.</span></span>

15. <span data-ttu-id="dd7eb-157">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-157">Click **OK**.</span></span>

 <span data-ttu-id="dd7eb-158">Прежде чем станет доступным ведение журналов аудита операций службы Secure Store, которое может оказаться полезным для целей отладки, его необходимо включить.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-158">Audit logging of Store Service operations, which is useful for troubleshooting purposes, must be enabled before it is available.</span></span> <span data-ttu-id="dd7eb-159">Дополнительные сведения о том, как включить ведение журнала, см. в разделе [Configure служба Secure Store (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-159">For more information about how to enable logging, see [Configure Secure Store Service (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span></span>

##  <a name="step-2-turn-off-credential-options-that-you-do-not-want-to-support"></a><a name="bkmk_creds"></a><span data-ttu-id="dd7eb-160">Шаг 2. Отключение параметров учетных данных, которые не требуется поддерживать</span><span class="sxs-lookup"><span data-stu-id="dd7eb-160">Step 2: Turn off credential options that you do not want to support</span></span>
 <span data-ttu-id="dd7eb-161">Обновление данных PowerPivot предусматривает три режима использования учетных данных в расписании.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-161">PowerPivot data refresh provides three credential options in a data refresh schedule.</span></span> <span data-ttu-id="dd7eb-162">Когда владелец книги планирует обновление данных, он выбирает один из трех вариантов, определяя таким образом учетную запись, от которой будут запускаться задания обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-162">When a workbook owner schedules data refresh, he or she chooses one of these options, thereby determining the account under which the data refresh job runs.</span></span> <span data-ttu-id="dd7eb-163">Как администратор вы можете определить, какие варианты использования учетных данных будут доступны владельцам расписания.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-163">As an administrator, you can determine which credential options are available to schedule owners.</span></span>

 <span data-ttu-id="dd7eb-164">Для обновления данных должен быть доступен хотя бы один вариант.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-164">You must have at least one option that is available in order for data refresh to work.</span></span>

 <span data-ttu-id="dd7eb-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="dd7eb-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="dd7eb-166">Вариант 1. **Используйте учетную запись обновления данных, настроенную администратором**, всегда отображается на странице Определение расписания, но работает только при настройке учетной записи автоматического обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-166">Option 1, **Use the data refresh account configured by the administrator**, always appears on the schedule definition page, but only works if you configure the unattended data refresh account.</span></span> <span data-ttu-id="dd7eb-167">Дополнительные сведения о создании учетной записи см. в статье [Настройка учетной записи автоматического обновления данных PowerPivot &#40;PowerPivot для SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-167">For more information on how to create the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="dd7eb-168">Вариант 2, **Connect с использованием следующих учетных данных Windows**, всегда отображается на странице, но работает только при включении параметра **Разрешить пользователям вводить пользовательские учетные данные Windows** на странице Конфигурация приложения службы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-168">Option 2, **Connect using the following windows credentials**, always appears on the page, but only works when you enable the **Allow users to enter custom Windows credentials** option in the service application configuration page.</span></span> <span data-ttu-id="dd7eb-169">Этот параметр включен по умолчанию, но его можно отключить, если минусы его использования превышают плюсы (см. ниже).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-169">This option is enabled by default, but you can disable it if the disadvantages of using it outweigh the advantages (see below).</span></span>

 <span data-ttu-id="dd7eb-170">Вариант 3. **подключение с использованием учетных данных, сохраненных в Служба Secure Store**, всегда отображается на странице, но работает только в том случае, если владелец расписания предоставляет допустимое целевое приложение.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-170">Option 3, **Connect using the credentials saved in Secure Store Service**, always appears on the page, but only works when a schedule owner provides a valid target application.</span></span> <span data-ttu-id="dd7eb-171">Администратор должен предварительно создать это целевое приложение и сообщить его имя создателю расписания обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-171">An administrator must create these target applications in advance and then provide the application name to those who create the data refresh schedules.</span></span> <span data-ttu-id="dd7eb-172">Дополнительные сведения о создании целевого приложения для операций обновления данных см. в статье [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-172">For more information on how to create a target application for data refresh operations, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="dd7eb-173">**Настройка параметра учетных данных 2 "подключение с использованием следующих учетных данных пользователя Windows"**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-173">**Configuring credential option 2, "Connect using the following Windows user credentials"**</span></span>

 <span data-ttu-id="dd7eb-174">Приложение службы PowerPivot включает параметр учетных данных, который позволяет владельцу расписания ввести произвольные имя пользователя и пароль Windows для запуска задания обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-174">PowerPivot service application includes a credential option that allows schedule owners to enter an arbitrary Windows user name and password for running a data refresh job.</span></span> <span data-ttu-id="dd7eb-175">Это второй параметр на странице определения расписания:</span><span class="sxs-lookup"><span data-stu-id="dd7eb-175">This is the second credential option in the schedule definition page:</span></span>

 <span data-ttu-id="dd7eb-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="dd7eb-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span></span>

 <span data-ttu-id="dd7eb-177">Этот вариант учетных данных включен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-177">This credential option is enabled by default.</span></span> <span data-ttu-id="dd7eb-178">Если он включен, то системная служба PowerPivot сформирует в службе Secure Store целевое приложение для хранения имени и пароля, введенных владельцем расписания.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-178">When this credential option is enabled, PowerPivot System Service will generate a target application in Secure Store Service to store the user name and password entered by the schedule owner.</span></span> <span data-ttu-id="dd7eb-179">Созданное целевое приложение создается с использованием этого соглашения об именовании: PowerPivotDataRefresh_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="dd7eb-179">A generated target application is created using this naming convention: PowerPivotDataRefresh_\<guid>.</span></span> <span data-ttu-id="dd7eb-180">Для каждого набора учетных данных Windows создается одно целевое приложение.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-180">One target application is created for each set of Windows credentials.</span></span> <span data-ttu-id="dd7eb-181">Если существует целевое приложение, принадлежащее системной службе PowerPivot и хранящее имя пользователя и пароль, введенные пользователем, которым было определено расписание, то системная служба PowerPivot будет использовать это приложение, а не создаст новое.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-181">If a target application already exists that is owned by the PowerPivot System Service and stores the username and password entered by the person defining the schedule, PowerPivot System Service will use that target application rather than create a new one.</span></span>

 <span data-ttu-id="dd7eb-182">Главное преимущество использования этого варианта хранения учетных данных — простота.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-182">The primary advantage of using this credential option is ease of use and simplicity.</span></span> <span data-ttu-id="dd7eb-183">Предварительная работа сводится к минимуму, так как целевые приложения создаются автоматически.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-183">Advance work is minimal because target applications are created for you.</span></span> <span data-ttu-id="dd7eb-184">Кроме того, запуск обновления данных от учетных данных владельца расписания (который, скорее всего, является и создателем книги) упрощает выполнение требований к передаче разрешений.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-184">Also, running data refresh under the credentials of the schedule owner (who is most likely the person who created the workbook) simplifies permission requirements downstream.</span></span> <span data-ttu-id="dd7eb-185">Скорее всего, этот пользователь уже имеет разрешения для целевой базы данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-185">Most likely, this user already has permissions on the target database.</span></span> <span data-ttu-id="dd7eb-186">Когда обновление данных выполняется с учетными данными пользователя Windows этого пользователя, любые подключения к данным, указывающие "текущий пользователь", будут работать автоматически.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-186">When data refresh runs under this person's Windows user identity, any data connections that specify 'current user' will work automatically.</span></span>

 <span data-ttu-id="dd7eb-187">Недостатком являются ограниченные возможности управления.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-187">The disadvantage is limited management capability.</span></span> <span data-ttu-id="dd7eb-188">Хотя целевое приложение создается автоматически, оно не обновляется и не удаляется при изменении учетной записи.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-188">Although target applications are created automatically, they are not deleted automatically or updated as account information changes.</span></span> <span data-ttu-id="dd7eb-189">Применение политик истечения срока действия паролей может привести к тому, что целевые приложения станут неактуальными.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-189">Password expiration policies might cause these target applications to become out of date.</span></span> <span data-ttu-id="dd7eb-190">Задания обновления данных, сроки действия учетных данных которых истекли, не смогут запуститься.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-190">Data refresh jobs that use expired credentials will start to fail.</span></span> <span data-ttu-id="dd7eb-191">В этом случае владельцу расписания необходимо обновить учетные данные, указав имя пользователя и пароль в расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-191">When this occurs, schedule owners will need to update their credentials by providing current user name and password values in a data refresh schedule.</span></span> <span data-ttu-id="dd7eb-192">Тогда будет создано новое целевое приложение.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-192">A new target application will be created at that point.</span></span> <span data-ttu-id="dd7eb-193">По мере того как пользователи добавляют и корректируют информацию об учетных данных в своих расписаниях обновления данных, может сложиться такая ситуация, когда в системе имеется великое множество автоматически созданных целевых приложений.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-193">Over time, as users add and revise credential information in their data refresh schedules, you might find that you have a large number of auto-generated target applications on your system.</span></span>

 <span data-ttu-id="dd7eb-194">В настоящее время не существует способа определить, активно ли то или иное целевое приложение. Не существует также и способа отслеживания конкретного целевого приложения из создавшего его задания обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-194">Currently, there is no way to determine which of these target applications are active or inactive, nor is there a way to trace a specific target application back to the data refresh schedules that use it.</span></span> <span data-ttu-id="dd7eb-195">Лучше не трогать целевые приложения, так как их удаление может привести к прекращению работы расписаний обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-195">In general, you should leave the target applications alone, as deleting them might break existing data refresh schedules.</span></span> <span data-ttu-id="dd7eb-196">Удаление целевого приложения, которое по-прежнему используется, приведет к сбою обновления данных с сообщением "целевое приложение не найдено", отображаемое на странице журнала обновления данных книги.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-196">Deleting a target application that is still in use will cause data refresh to fail with the message, "Target application not found", appearing in the data refresh history page of the workbook.</span></span>

 <span data-ttu-id="dd7eb-197">Отключив этот параметр, можно безопасно удалить целевые приложения, созданные для обновления данных PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-197">Should you choose to disable this credential option, you can safely delete all of the target applications that were generated for PowerPivot data refresh.</span></span>

 <span data-ttu-id="dd7eb-198">**Отключение использования произвольных учетных данных Windows в расписаниях обновления данных**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-198">**Disabling the use of arbitrary Windows credentials in data refresh schedules**</span></span>

1.  <span data-ttu-id="dd7eb-199">В центре администрирования в окне "Управление приложениями" выберите **Управление приложения службы**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-199">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="dd7eb-200">Щелкните имя приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-200">Click the PowerPivot service application name.</span></span> <span data-ttu-id="dd7eb-201">Откроется панель мониторинга PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-201">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="dd7eb-202">В меню действия выберите **настроить параметры приложения службы** , чтобы открыть страницу Параметры приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-202">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="dd7eb-203">В разделе Обновление данных снимите флажок **Разрешить пользователям вводить настраиваемые учетные данные Windows** .</span><span class="sxs-lookup"><span data-stu-id="dd7eb-203">In the Data Refresh section, clear the **Allow users to enter custom Windows credentials** checkbox.</span></span>

     <span data-ttu-id="dd7eb-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span><span class="sxs-lookup"><span data-stu-id="dd7eb-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span></span>

##  <a name="step-3-create-target-applications-to-store-credentials-used-in-data-refresh"></a><a name="bkmk_stored"></a><span data-ttu-id="dd7eb-205">Шаг 3. Создание целевых приложений для хранения учетных данных, используемых при обновлении данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-205">Step 3: Create target applications to store credentials used in data refresh</span></span>
 <span data-ttu-id="dd7eb-206">После завершения настройки службы Secure Store администраторы SharePoint смогут создавать целевые приложения для обеспечения доступности сохраненных учетных данных при обновлениях, включая учетную запись автоматического обновления данных PowerPivot и другие учетные записи, которые используются для выполнения задания или соединения с внешними источниками данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-206">Once Secure Store Service is configured, SharePoint administrators can create target applications to make stored credentials available for data refresh purposes, including the PowerPivot unattended data refresh account or any other account that is used to either run the job or connect to external data sources.</span></span>

 <span data-ttu-id="dd7eb-207">Ранее уже говорилось, что для использования учетных данных необходимо создать целевые приложения.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-207">Recall from the previous section that you need to create target applications in order for certain credential options to be usable.</span></span> <span data-ttu-id="dd7eb-208">В частности, необходимо создать целевые приложения для учетной записи автоматического обновления PowerPivot, а также для всех необходимых учетных данных, использование которых планируется в операциях обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-208">Specifically, you must create target applications for the PowerPivot unattended data refresh account, plus any additional stored credentials that you expect would be used in data refresh operations.</span></span>

 <span data-ttu-id="dd7eb-209">Дополнительные сведения о создании целевых приложений, содержащих сохраненные учетные данные, см. [в статьях Настройка учетной записи автоматического обновления данных powerpivot &#40;PowerPivot для SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) и [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-209">For more information about how to create target applications that contain stored credentials, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) and [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

##  <a name="step-4-configure-the-server-for-scalable-data-refresh"></a><a name="bkmk_scale"></a><span data-ttu-id="dd7eb-210">Шаг 4. Настройка масштабируемого обновления данных на сервере</span><span class="sxs-lookup"><span data-stu-id="dd7eb-210">Step 4: Configure the server for scalable data refresh</span></span>
 <span data-ttu-id="dd7eb-211">По умолчанию каждая установка PowerPivot для SharePoint поддерживает обновление по запросу и по расписанию.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-211">By default, each PowerPivot for SharePoint installation supports both on-demand queries and scheduled data refresh.</span></span>

 <span data-ttu-id="dd7eb-212">Для каждой установки можно указать, будет ли поддерживать экземпляр служб Analysis Services обновление данных обоими способами, или будет привязан к какому-то конкретному типу операций.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-212">For each installation, you can specify whether the Analysis Services server instance supports both query and scheduled data refresh, or is dedicated to a specific type of operation.</span></span> <span data-ttu-id="dd7eb-213">Если на ферме имеется несколько установок PowerPivot для SharePoint и задания обновления данных выполняются долго или с ошибками, то можно подумать над установкой выделенного сервера, который будет заниматься только операциями обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-213">If you have multiple installations of PowerPivot for SharePoint in your farm, you might consider dedicating a server for just data refresh operations if you find that jobs are delayed or failing.</span></span>

 <span data-ttu-id="dd7eb-214">Кроме того, можно увеличить число параллельно выполняющихся заданий обновления, если оборудование это позволяет.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-214">Additionally, if the underlying hardware supports it, you can increase the number of data refresh jobs that run in parallel.</span></span> <span data-ttu-id="dd7eb-215">По умолчанию число одновременно выполняемых заданий вычисляется исходя из объема системной памяти, но его можно увеличить, если мощности ЦП достаточно для этого.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-215">By default, the number of jobs that can run in parallel is calculated based on system memory, but you can increase that number if you have additional CPU capacity to support the workload.</span></span>

 <span data-ttu-id="dd7eb-216">Дополнительные сведения см. в статьях [Настройка выделенного обновления данных или обработка только запросов &#40;PowerPivot для SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-216">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span>

##  <a name="step-5-install-data-providers-used-to-import-powerpivot-data"></a><a name="bkmk_installdp"></a><span data-ttu-id="dd7eb-217">Шаг 5. Установка поставщиков данных, используемых для импорта данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="dd7eb-217">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>
 <span data-ttu-id="dd7eb-218">Операция обновления данных по сути является повторным выполнением операции импорта, при которой извлекаются исходные данные.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-218">A data refresh operation is essentially a repeat of an import operation that retrieved the original data.</span></span> <span data-ttu-id="dd7eb-219">Это означает, что поставщики данных, которые используются для импорта данных в клиентские приложения PowerPivot, также должны быть установлены на сервере PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-219">This means that the same data providers used to import the data in the PowerPivot client application must also be installed on the PowerPivot server.</span></span>

 <span data-ttu-id="dd7eb-220">Поставщиков данных на сервере Windows могут устанавливать только локальные администраторы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-220">You must be a local administrator to install data providers on a Windows server.</span></span> <span data-ttu-id="dd7eb-221">При установке дополнительных данных необходимо убедиться, что они установлены на компьютере в ферме SharePoint, где установлен PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-221">If you install additional drivers, be sure to install them on each computer in the SharePoint farm that has an installation of PowerPivot for SharePoint.</span></span> <span data-ttu-id="dd7eb-222">Если в ферме имеется несколько серверов PowerPivot, то поставщики необходимо установить на всех серверах.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-222">If you have multiple PowerPivot servers in the farm, you must install the providers on each one.</span></span>

 <span data-ttu-id="dd7eb-223">Помните, что серверы SharePoint являются 64-разрядными приложениями.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-223">Remember that SharePoint servers are 64-bit applications.</span></span> <span data-ttu-id="dd7eb-224">Убедитесь, что установлена 64-разрядная версия поставщиков данных — именно эти поставщики используются для операций обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-224">Be sure to install the 64-bit version of the data providers you are using to support data refresh operations.</span></span>

##  <a name="step-6-grant-permissions-to-create-schedules-and-access-external-data-sources"></a><a name="bkmk_accounts"></a><span data-ttu-id="dd7eb-225">Шаг 6. Предоставление разрешений на создание расписаний и доступ к внешним источникам данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-225">Step 6: Grant permissions to create schedules and access external data sources</span></span>
 <span data-ttu-id="dd7eb-226">Владельцы книг или авторы должны иметь разрешение **Участие** , чтобы иметь возможность создавать расписание обновления данных для книги.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-226">Workbook owners or authors must have **Contribute** permission to schedule data refresh on a workbook.</span></span> <span data-ttu-id="dd7eb-227">Учитывая этот уровень разрешений, он может открыть и изменить страницу настройки обновления данных книги, чтобы указать учетные данные и расписание, используемое для обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-227">Given this permission level, he or she can open and edit the workbook's data refresh configuration page to specify the credentials and schedule information used to refresh the data.</span></span>

 <span data-ttu-id="dd7eb-228">Чтобы во время обновления данных учетным записям хватило прав доступа, необходимых для выполнения операции, помимо разрешений SharePoint необходимо также проверить разрешения для внешних источников данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-228">In addition to SharePoint permissions, database permissions on external data sources must also be reviewed to ensure that accounts used during data refresh have sufficient access rights to the data.</span></span> <span data-ttu-id="dd7eb-229">Определение необходимых разрешений потребует внимательности с вашей стороны, так как разрешения, которые необходимо предоставить, в большой степени зависят от строки подключения, заданной в книге, и удостоверения пользователя, с которым запускается задание обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-229">Determining permission requirements will require careful evaluation on your part because the permissions that you need to grant will vary depending on the connection string in the workbook and the user identity under which the data refresh job is running.</span></span>

 <span data-ttu-id="dd7eb-230">**Почему существующие строки подключения в книге PowerPivot влияют на операции обновления данных PowerPivot**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-230">**Why existing connection strings in a PowerPivot workbook matter to PowerPivot data refresh operations**</span></span>

 <span data-ttu-id="dd7eb-231">При запуске обновления данных сервер отправляет внешнему источнику данных запрос на соединение через строку подключения, созданную во время первоначального импорта данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-231">When data refresh runs, the server sends a connection request to the external data source using the connection string that was created when the data was originally imported.</span></span> <span data-ttu-id="dd7eb-232">Размещение сервера, имя базы данных и параметры проверки подлинности, указанные в строке подключения, будут повторно использованы для доступа к тем же источникам данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-232">The server location, database name, and authentication parameters specified in that connection string are now reused during data refresh to access the same data sources.</span></span> <span data-ttu-id="dd7eb-233">Строку подключения и ее общую конструкцию нельзя изменить для целей обновления.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-233">The connection string and its overall construction cannot be modified for data refresh purposes.</span></span> <span data-ttu-id="dd7eb-234">Она просто повторно используется во время обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-234">It is simply reused as-is during data refresh.</span></span> <span data-ttu-id="dd7eb-235">В некоторых случаях, если для соединения с источником данных используется проверка подлинности, отличная от Windows, можно переопределить имя пользователя и пароль, указанные в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-235">In some cases, if you are using non-Windows authentication to connect to a data source, you can override the user name and password in the connection string.</span></span> <span data-ttu-id="dd7eb-236">Подробности приведены ниже в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-236">More detail about this is provided further on in this topic.</span></span>

 <span data-ttu-id="dd7eb-237">Для большинства рабочих нагрузок при соединении вариантом проверки подлинности по умолчанию является использование доверительных соединений или встроенной проверки подлинности Windows, когда строка подключения содержит `SSPI=IntegratedSecurity` или `SSPI=TrustedConnection`.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-237">For most workbooks, the default authentication option on the connection is to use trusted connections or Windows integrated security, resulting in connection strings that include `SSPI=IntegratedSecurity` or `SSPI=TrustedConnection`.</span></span> <span data-ttu-id="dd7eb-238">Если эта строка подключения используется во время обновления данных, учетная запись, используемая для запуска задания обновления данных, становится "текущим пользователем".</span><span class="sxs-lookup"><span data-stu-id="dd7eb-238">When this connection string is used during data refresh, the account used to run the data refresh job becomes the 'current user'.</span></span> <span data-ttu-id="dd7eb-239">Этой учетной записи и нужны разрешения на чтение любых источников данных, доступ к которым производится через доверительное соединение.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-239">As such, this account needs read permissions on any external data source that is accessed via a trusted connection.</span></span>

 <span data-ttu-id="dd7eb-240">**Включена ли учетная запись автоматического обновления PowerPivot?**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-240">**Did you enable the PowerPivot unattended data refresh account?**</span></span>

 <span data-ttu-id="dd7eb-241">Если да, то необходимо предоставить этой учетной записи разрешения на чтение источников данных, доступ к которым производится во время обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-241">If yes, then you should grant that account read permissions on data sources that are accessed during data refresh.</span></span> <span data-ttu-id="dd7eb-242">Причина, по которой этой учетной записи требуются разрешения на чтение, заключается в том, что в книге, использующей параметры проверки подлинности по умолчанию, учетная запись автоматической установки будет "текущий пользователь" во время обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-242">The reason why this account needs read permissions is because in a workbook that uses the default authentication options, the unattended account will be the 'current user' during data refresh.</span></span> <span data-ttu-id="dd7eb-243">Если владелец расписания переопределяет учетные данные в строке подключения, то этой учетной записи потребуются разрешения на чтение источников данных, активно используемых в вашей организации.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-243">Unless the schedule owner overrides the credentials in the connection string, this account will need read permissions on any number of data sources that are actively used in your organization.</span></span>

 <span data-ttu-id="dd7eb-244">**Используется ли второй вариант учетных данных, который позволяет владельцу расписания вводить имя и пароль пользователя Windows?**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-244">**Are you using credential option 2: allowing the schedule owner to enter a Windows user name and password?**</span></span>

 <span data-ttu-id="dd7eb-245">Как правило, пользователь, который создал книгу PowerPivot, уже имеет достаточно разрешений, так как он уже выполнял первоначальный импорт данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-245">Typically, users who create PowerPivot workbooks already have sufficient permissions because he or she already imported the data in the first place.</span></span> <span data-ttu-id="dd7eb-246">Если такой пользователь впоследствии настроит обновление данных на запуск от собственной учетной записи пользователя Windows, который подошел для базы данных, то он будет использоваться и для получения данных во время обновления.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-246">If these users subsequently configure data refresh to run under their own Windows user identity, their Windows user account, which already has rights on the database, will be used to retrieve data during data refresh.</span></span> <span data-ttu-id="dd7eb-247">Существующих разрешений должно быть достаточно.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-247">Existing permissions should be sufficient.</span></span>

 <span data-ttu-id="dd7eb-248">**Используется ли третий вариант учетных данных: использование целевых приложений службы Secure Store для хранения удостоверения пользователя для запуска заданий обновления данных?**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-248">**Are you using credential option 3: using a Secure Store Service target application to provide a user identity for running data refresh jobs?**</span></span>

 <span data-ttu-id="dd7eb-249">Любая учетная запись для запуска задания обновления данных должна иметь разрешения на чтение по тем же причинам, которые описаны выше для учетной записи автоматического обновления PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-249">Any account used to run a data refresh job needs read permissions, for the same reasons as those described for the PowerPivot unattended data refresh account.</span></span>

 <span data-ttu-id="dd7eb-250">**Как проверить строку подключения и определить, можно ли переопределить указанные в ней учетные данные для обновления данных**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-250">**How to check connection strings to determine whether you can override credentials used during data refresh**</span></span>

 <span data-ttu-id="dd7eb-251">Как уже отмечалось, на уровне задания обновления данных можно указать другое имя пользователя и пароль, если в строке соединения указана проверка подлинности, отличная от Windows (например, проверка подлинности SQL Server).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-251">As previously noted, you can substitute a different user name and password at the data refresh job level if the connection is using non-Windows authentication (for example, SQL Server authentication).</span></span> <span data-ttu-id="dd7eb-252">Учетные данные, отличные от Windows, передаются в строке соединения в параметрах User ID и Password.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-252">Non-Windows credentials are passed on the connection string using the User ID and Password parameters.</span></span> <span data-ttu-id="dd7eb-253">Если в книге содержится строка подключения с этими параметрами, то можно указать другие имя пользователя и пароль для обновления данных из источника данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-253">If your workbook contains a connection string with these parameters, you can optionally specify a different user name and password for refreshing data from that data source.</span></span>

 <span data-ttu-id="dd7eb-254">В следующих шагах объясняется, как определить, допускает ли строка подключения переопределение имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-254">The following steps explain how to determine whether you have a connection string that accepts user name and password overrides.</span></span>

1.  <span data-ttu-id="dd7eb-255">Откройте книгу в Excel.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-255">Open the workbook in Excel.</span></span>

2.  <span data-ttu-id="dd7eb-256">Откройте окно PowerPivot (щелкните PowerPivot на ленте Excel).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-256">Open the PowerPivot window (in Excel, on the PowerPivot ribbon, click PowerPivot Window).</span></span>

3.  <span data-ttu-id="dd7eb-257">Нажмите кнопку **конструктор**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-257">Click **Design**.</span></span>

4.  <span data-ttu-id="dd7eb-258">Щелкните **существующие соединения**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-258">Click **Existing Connections**.</span></span>

     <span data-ttu-id="dd7eb-259">Все подключения, используемые в книге, перечислены в разделе **подключения к данным PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-259">All of the connections used in the workbook are listed under **PowerPivot Data Connections**.</span></span>

5.  <span data-ttu-id="dd7eb-260">Выберите соединение и нажмите кнопку **изменить**, а затем — **Дополнительно**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-260">Select the connection and click **Edit**, and then click **Advanced**.</span></span> <span data-ttu-id="dd7eb-261">Строка подключения находится в нижней части страницы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-261">The connection string is at the bottom of the page.</span></span>

 <span data-ttu-id="dd7eb-262">Если в строке подключения отображается **Integrated Security = SSPI** , то нельзя переопределить учетные данные в строке подключения.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-262">If you see **Integrated Security=SSPI** in the connection string, you cannot override the credentials in the connection string.</span></span> <span data-ttu-id="dd7eb-263">Соединение всегда будет использовать учетные данные текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-263">The connection will always use the current user.</span></span> <span data-ttu-id="dd7eb-264">Любые указанные учетные данные не будут использоваться.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-264">Any credentials that you provide are ignored.</span></span>

 <span data-ttu-id="dd7eb-265">Если вы видите параметр **сохранить сведения о безопасности = false, Password = \* \* \* \* \* \* \* \* \* \* \* , \<userlogin> UserID =**, то у вас есть строка подключения, которая будет принимать переопределения учетных данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-265">If you see **Persist Security Info=False, Password=\*\*\*\*\*\*\*\*\*\*\*, UserID=\<userlogin>**,then you have a connection string that will accept credential overrides.</span></span> <span data-ttu-id="dd7eb-266">Учетные данные в строке подключения (UserID и Password) являются не учетными данными Windows, а именем входа базы данных или зарегистрированной учетной записью на целевом источнике данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-266">Credentials that appear in a connection string (such as UserID and Password) are not Windows credentials, but rather database logins or other sign-in accounts that are valid for the target data source.</span></span>

 <span data-ttu-id="dd7eb-267">**Как переопределить учетные данные в строке подключения**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-267">**How to override credentials in the connection string**</span></span>

 <span data-ttu-id="dd7eb-268">Переопределение учетных данных выполняется путем указания учетных данных источника данных в расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-268">Overriding credentials is done by specifying data source credentials in the data refresh schedule.</span></span> <span data-ttu-id="dd7eb-269">Пользователь с правами администратора может указать целевое приложение в службе Secure Store, которое сопоставляет учетные данные для доступа к внешним данным.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-269">As an administrator, you can provide a target application in Secure Store Service that maps the credentials used to access external data.</span></span> <span data-ttu-id="dd7eb-270">После этого владелец расписания может ввести идентификатор целевого приложения в расписание обновления данных, определенное им же.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-270">The schedule owner can then enter the target application ID in the data refresh schedule that he or she defines.</span></span> <span data-ttu-id="dd7eb-271">Дополнительные сведения о создании этого целевого приложения см. в статье [Настройка сохраненных учетных данных для &#40;обновления данных PowerPivot PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-271">For more information about creating this target application, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="dd7eb-272">В качестве альтернативы владелец расписания может ввести набор учетных данных, которые будут использоваться для соединения с источниками данных во время обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-272">Alternatively, the schedule owner can type in the set of credentials that are used to connect to data sources during data refresh.</span></span> <span data-ttu-id="dd7eb-273">На следующей иллюстрации показан параметр источника данных на странице определения расписания.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-273">The following illustration shows this data source option in the schedule definition page.</span></span>

 <span data-ttu-id="dd7eb-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span><span class="sxs-lookup"><span data-stu-id="dd7eb-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span></span>

 <span data-ttu-id="dd7eb-275">**Определение требований доступа к данным**</span><span class="sxs-lookup"><span data-stu-id="dd7eb-275">**Identifying data access requirements**</span></span>

 <span data-ttu-id="dd7eb-276">Как уже говорилось, учетная запись для запуска обновления данных и учетная запись для соединения с внешними источниками данных часто означают одно и то же.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-276">As noted in previous sections, the account used to run data refresh and connect to external data sources is often one and the same.</span></span> <span data-ttu-id="dd7eb-277">Учетная запись для доступа к внешним источникам данных определяется параметрами, заданными на этой странице расписания обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-277">As such, the account used to access external data sources is determined by the options set in this part of the data refresh schedule page.</span></span> <span data-ttu-id="dd7eb-278">Это может быть учетная запись автоматического обновления данных PowerPivot, учетная запись Windows конкретного пользователя или учетная запись, которая хранится в предопределенном целевом приложении.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-278">This might be the PowerPivot unattended data refresh account, the Windows account of an individual user, or the account that is stored in a predefined target application.</span></span>

 <span data-ttu-id="dd7eb-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="dd7eb-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="dd7eb-280">В тех случаях, когда учетная запись, используемая для запуска обновления данных, отличается от учетной записи, используемой для импорта данных (например, учетная запись автоматического обновления данных PowerPivot по первому варианту или какой-либо другой набор сохраненных учетных данных по третьему варианту), для этой учетной записи придется создать новое имя входа в базе данных и предоставить ему разрешения на чтение во внешних источниках данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-280">In cases where the account used to run data refresh is different from the account used to import data (for example, the PowerPivot unattended data refresh account via credential option one, or some other set of stored credentials via credential option three), you will need to create a new database login for that account and grant it read permissions on the external data sources.</span></span>

 <span data-ttu-id="dd7eb-281">Разобравшись, каким учетным записям требуется доступ к данным, можно проверить разрешения в источниках данных, наиболее часто используемых в книгах PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-281">Once you understand which accounts require data access, you can begin to check permissions on the data sources that are most often used in PowerPivot workbooks.</span></span> <span data-ttu-id="dd7eb-282">Начните с хранилищ данных и баз данных отчетов, которые чаще всего используются, а также выясните у наиболее активных пользователей PowerPivot, какими источниками данных они пользуются.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-282">Start with any data warehouses or reporting databases that are actively used, but also solicit input from your most active PowerPivot users to find out which data sources they are using.</span></span> <span data-ttu-id="dd7eb-283">Составив список источников данных, можно их один за другим проверить и убедиться, правильно ли для них настроены разрешения.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-283">Once you have a list of data sources, you can begin checking each one to ensure that permissions are set correctly.</span></span>

##  <a name="step-7-enable-workbook-upgrade-for-data-refresh"></a><a name="bkmk_upgradewrkbk"></a><span data-ttu-id="dd7eb-284">Шаг 7. Включение обновления данных в книге</span><span class="sxs-lookup"><span data-stu-id="dd7eb-284">Step 7: Enable workbook upgrade for data refresh</span></span>
 <span data-ttu-id="dd7eb-285">По умолчанию книги, созданные с помощью версии [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] PowerPivot для Excel, нельзя настроить для планового обновления данных на [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] PowerPivot для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-285">By default, workbooks that were created using the [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel cannot be configured for scheduled data refresh on a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version of PowerPivot for SharePoint.</span></span> <span data-ttu-id="dd7eb-286">При размещении более новых и более поздних версий книг PowerPivot в среде SharePoint следует сначала обновить книги [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)], прежде чем создавать расписание для автоматического обновления данных на сервере.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-286">If you host newer and older versions of PowerPivot workbooks in your SharePoint environment, you must upgrade any [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] workbooks first before they can be scheduled for automatic data refresh on the server.</span></span>

##  <a name="step-8-verify-data-refresh-configuration"></a><a name="bkmk_verify"></a><span data-ttu-id="dd7eb-287">Шаг 8. Проверка конфигурации обновления данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-287">Step 8: Verify data refresh configuration</span></span>
 <span data-ttu-id="dd7eb-288">Чтобы проверить обновление данных, необходима книга PowerPivot, опубликованная на сайте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-288">To verify data refresh, you must have a PowerPivot workbook that is published to a SharePoint site.</span></span> <span data-ttu-id="dd7eb-289">Вы должны иметь разрешения на участие для этой книги, а также разрешения на доступ к любым источникам данных, включенных в расписание обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-289">You must have Contribute permissions on the workbook and permissions to access any data sources that are included in the data refresh schedule.</span></span>

 <span data-ttu-id="dd7eb-290">При создании расписания установите флажок **также обновлять как можно скорее** , чтобы немедленно запустить обновление данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-290">When you create the schedule, select the **Also refresh as soon as possible** checkbox to run data refresh immediately.</span></span> <span data-ttu-id="dd7eb-291">Затем можно на странице журнала обновления данных книги проверить, правильно ли оно запустилось.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-291">You can then check the data refresh history page of that workbook to verify that it ran successfully.</span></span> <span data-ttu-id="dd7eb-292">Помните, что задание таймера обновления данных PowerPivot запускается раз в минуту.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-292">Recall that the PowerPivot Data Refresh timer job runs every minute.</span></span> <span data-ttu-id="dd7eb-293">То есть подтверждение о запуске обновления данных может потребоваться подождать в течение этого времени.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-293">It will take at least that long to get confirmation that data refresh succeeded.</span></span>

 <span data-ttu-id="dd7eb-294">Обязательно попробуйте все варианты учетных данных, поддержка которых планируется.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-294">Be sure to try all of the credential options you plan to support.</span></span> <span data-ttu-id="dd7eb-295">Например, если настроена учетная запись автоматического обновления данных PowerPivot, то нужно проверить, успешно ли выполняется обновление данных в этом режиме.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-295">For example, if you configured the PowerPivot unattended data refresh account, verify that data refresh succeeds using that option.</span></span> <span data-ttu-id="dd7eb-296">Дополнительные сведения о планировании и просмотре сведений о состоянии см. в статьях [планирование &#40;обновления данных PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) и [Просмотр журнала обновления данных &#40;PowerPivot для SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-296">For more information about scheduling and viewing status information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) and [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="dd7eb-297">Если обновление данных завершается неудачно, обратитесь к странице [Устранение неполадок обновления данных PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) на вики-сайте TechNet, чтобы получить возможные решения.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-297">If data refresh fails, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>

##  <a name="modify-configuration-settings-for-data-refresh"></a><a name="bkmk_config"></a><span data-ttu-id="dd7eb-298">Изменение параметров конфигурации для обновления данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-298">Modify Configuration Settings for Data Refresh</span></span>
 <span data-ttu-id="dd7eb-299">Каждое приложение службы PowerPivot имеет параметры конфигурации, используемые в операциях обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-299">Each PowerPivot service application has configuration settings that affect data refresh operations.</span></span> <span data-ttu-id="dd7eb-300">В этом разделе описано, как изменить эти параметры.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-300">This section explains how to modify those settings.</span></span>

###  <a name="set-business-hours-to-determine-off-hours-processing"></a><a name="procIntervals"></a><span data-ttu-id="dd7eb-301">Задайте "рабочие часы", чтобы определить обработку в нерабочее время</span><span class="sxs-lookup"><span data-stu-id="dd7eb-301">Set 'Business Hours' to determine off-hours processing</span></span>
 <span data-ttu-id="dd7eb-302">Пользователи SharePoint, создающие расписания для операций обновления данных, могут задать самое раннее время запуска «По окончании рабочего дня».</span><span class="sxs-lookup"><span data-stu-id="dd7eb-302">SharePoint users who schedule data refresh operations can specify an earliest start time of "After business hours".</span></span> <span data-ttu-id="dd7eb-303">Это может быть полезно, если нужно получить данные бизнес-транзакций, накопленные за рабочий день.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-303">This may be useful if they want to retrieve business transaction data that accumulated during the business day.</span></span> <span data-ttu-id="dd7eb-304">Администратор фермы может задать временной диапазон, наиболее точно характеризующий начало и конец рабочего дня на данном предприятии.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-304">As a farm administrator, you can specify the range of hours that best defines a business day for your organization.</span></span> <span data-ttu-id="dd7eb-305">Если задать начало рабочего дня в 04:00 и конец в 20:00, то обработка обновления данных, для которой задано время запуска «По окончании рабочего дня», начнется в 20:01.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-305">If you define the business day to be from 04:00 to 20:00, then data refresh processing that is based on an "After business hours" start time will begin at 20:01.</span></span>

 <span data-ttu-id="dd7eb-306">Запросы обновления данных, запущенные вне рабочих часов, добавляются в очередь в порядке получения запроса.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-306">Data refresh requests that run during off-hours are added to the queue in the order in which the request is received.</span></span> <span data-ttu-id="dd7eb-307">Индивидуальные запросы обрабатываются по мере высвобождения ресурсов сервера.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-307">Individual requests will be processed as server resources become available.</span></span>

1.  <span data-ttu-id="dd7eb-308">В центре администрирования в окне "Управление приложениями" выберите **Управление приложения службы**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-308">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="dd7eb-309">Щелкните имя приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-309">Click the PowerPivot service application name.</span></span> <span data-ttu-id="dd7eb-310">Откроется панель мониторинга PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-310">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="dd7eb-311">В меню действия выберите **настроить параметры приложения службы** , чтобы открыть страницу Параметры приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-311">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="dd7eb-312">В разделе «Обновление данных» в поле «Часы работы» введите начальное и конечное время, которое определяет период обработки данных по окончании рабочего дня.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-312">In the Data Refresh section, in Business Hours, enter a start time and end time that defines the after business hours processing period.</span></span>

     <span data-ttu-id="dd7eb-313">Если не нужно задавать период, в который обработка не производится, можно задать одно и то же значение для «Времени начала» и «Времени окончания», например 12:00 для обоих полей.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-313">If you do not want an off-hours processing period defined, you can enter the same value for both Start Time and End Time (for example, 12:00 for both times).</span></span> <span data-ttu-id="dd7eb-314">Однако следует помнить, что на страницах определения расписания сайтов SharePoint по-прежнему будет значиться параметр «По окончании рабочего дня».</span><span class="sxs-lookup"><span data-stu-id="dd7eb-314">However, be aware that the schedule definition pages on the SharePoint sites will still have "After business hours" as an option.</span></span> <span data-ttu-id="dd7eb-315">Пользователи, выбирающие этот параметр на ферме, где не задан период, в который обработка данных не производится, будут получать ошибки обновления данных, так как задачи по обработке не будут запускаться.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-315">Users who select that option on a farm that has no off-hour processing range defined for it will eventually get data refresh errors as processing jobs fail to start.</span></span>

5.  <span data-ttu-id="dd7eb-316">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-316">Click **OK**.</span></span>

###  <a name="limit-how-long-data-refresh-history-is-retained"></a><a name="usagehist"></a><span data-ttu-id="dd7eb-317">Ограничение времени хранения журнала обновления данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-317">Limit how long data refresh history is retained</span></span>
 <span data-ttu-id="dd7eb-318">Журнал обновления данных представляет собой подробную регистрацию накапливаемых со временем сообщений об успехе и неудаче операций обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-318">Data refresh history is a detailed record of the success and failure messages that are generated for data refresh operations over time.</span></span> <span data-ttu-id="dd7eb-319">Данные журнала собираются и управляются через существующую на ферме систему сбора данных об использовании.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-319">History information is gathered and managed through the usage data collection system in the farm.</span></span> <span data-ttu-id="dd7eb-320">Все ограничения, наложенные на журнал данных об использовании, применяются также и к журналу обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-320">As such, limits that you set on usage data history also apply to data refresh history.</span></span> <span data-ttu-id="dd7eb-321">Поскольку отчеты об использовании извлекают данные из различных мест системы PowerPivot, единая настройка журнала управляет хранением данных как для журнала обновления данных, так и для любых других собираемых и хранимых данных об использовании.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-321">Because the usage activity reports pull together data from across the PowerPivot system, a single history setting is used to control data retention for both data refresh history and all other usage data that is collected and stored.</span></span>

1.  <span data-ttu-id="dd7eb-322">В центре администрирования в окне "Управление приложениями" выберите **Управление приложения службы**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-322">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="dd7eb-323">Щелкните имя приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-323">Click the PowerPivot service application name.</span></span> <span data-ttu-id="dd7eb-324">Откроется панель мониторинга PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-324">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="dd7eb-325">В меню действия выберите **настроить параметры приложения службы** , чтобы открыть страницу Параметры приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-325">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="dd7eb-326">В разделе «Сбор данных об использовании» в поле «Журнал данных об использовании» введите число дней, в течение которых должны сохраняться записи об операциях обновления данных для каждой книги.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-326">In the Usage Data Collection section, in Usage Data History, type the number of days for which you want to keep a record of data refresh activity for each workbook.</span></span>

     <span data-ttu-id="dd7eb-327">Значение по умолчанию — 365 суток.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-327">The default is 365 days.</span></span> <span data-ttu-id="dd7eb-328">Минимальное значение — 1 сутки, максимальное — 5 000 суток.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-328">The minimum value is 1 day and the maximum is 5000 days.</span></span> <span data-ttu-id="dd7eb-329">0 означает неограниченный срок хранения, данные не удаляются.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-329">0 specifies an unlimited retention period; data is never deleted.</span></span> <span data-ttu-id="dd7eb-330">Обратите внимание, что для отключения журнала параметра нет.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-330">Note that there is no setting for turning off history.</span></span>

5.  <span data-ttu-id="dd7eb-331">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-331">Click **OK**.</span></span>

 <span data-ttu-id="dd7eb-332">Сведения из журнала доступны пользователям SharePoint при выборе параметра «Управление обновлением данных» в книге, в которой совершались операции обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-332">History information is made available to SharePoint users when they choose the Manage Data Refresh option on a workbook that has a data refresh history.</span></span> <span data-ttu-id="dd7eb-333">Эти сведения также используются на панели мониторинга PowerPivot, с помощью которой администраторы фермы управляют работой службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-333">This information is also used in the PowerPivot Management Dashboard used by farm administrators to manage PowerPivot service operations.</span></span> <span data-ttu-id="dd7eb-334">Дополнительные сведения см. в разделе [Просмотр журнала обновления данных &#40;PowerPivot для SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-334">For more information, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="dd7eb-335">Для долговременного физического хранения данных журнала для приложения службы PowerPivot используется база данных приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-335">Long-term physical storage of history data is in the PowerPivot service application database for the PowerPivot service application.</span></span> <span data-ttu-id="dd7eb-336">Дополнительные сведения о сборе и хранении данных об использовании см. в разделе [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-336">For more information about how usage data is collected and stored, see [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span></span>

##  <a name="reschedule-the-powerpivot-data-refresh-timer-job"></a><a name="configTimerJob"></a><span data-ttu-id="dd7eb-337">Изменение расписания для задания таймера обновления данных PowerPivot</span><span class="sxs-lookup"><span data-stu-id="dd7eb-337">Reschedule the PowerPivot Data Refresh timer job</span></span>
 <span data-ttu-id="dd7eb-338">Запланированное обновление данных запускается заданием таймера обновления данных PowerPivot, которая с интервалом в 1 минуту считывает сведения о расписании из базы данных приложения службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-338">Scheduled data refresh is triggered by a PowerPivot Data Refresh timer job that scans schedule information in the PowerPivot service application database at one minute intervals.</span></span> <span data-ttu-id="dd7eb-339">Когда по расписанию должно начаться обновление данных, задание таймера добавляет запрос в очередь обработки на доступном сервере PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-339">When data refresh is scheduled to begin, the timer job adds the request to a processing queue on an available PowerPivot server.</span></span>

 <span data-ttu-id="dd7eb-340">Для оптимизации производительности можно увеличить продолжительность интервалов между сканированиями.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-340">You can increase the length of time between scans as a performance tuning technique.</span></span> <span data-ttu-id="dd7eb-341">Можно также отключить задание таймера для временной приостановки операций обновления данных на время отладки системы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-341">You can also disable the timer job to temporarily stop data refresh operations while you troubleshoot problems.</span></span>

 <span data-ttu-id="dd7eb-342">Значение по умолчанию — одна минута. Это минимальное значение, которое можно задать.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-342">The default setting is one minute, which is the lowest value you can specify.</span></span> <span data-ttu-id="dd7eb-343">Рекомендуется использовать именно это значение, поскольку оно обеспечивает наиболее прогнозирующий результат для расписаний, задающих выполнение задач в произвольные моменты в течение дня.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-343">This value is recommended because it provides the most predictable outcome for schedules that run at arbitrary times throughout the day.</span></span> <span data-ttu-id="dd7eb-344">Например, если пользователь указывает, что обновление данных должно начаться в 16:15, и задание таймера сканирует расписания ежеминутно, запрос на запланированное обновление данных будет обнаружен в 16:15 и его выполнение начнется самое большее через несколько минут.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-344">For example, if a user schedules data refresh for 4:15 PM, and the timer job scans for schedules every minute, the scheduled data refresh request will be detected at 4:15 and processing will occur within a few minutes of 4:15.</span></span>

 <span data-ttu-id="dd7eb-345">Если значительно увеличить интервал сканирования (например, указать, что сканирование должно производиться раз в сутки в полночь), то все операции обновления данных, запланированные к запуску в этом интервале, будут добавлены в очередь обработки одновременно, что может привести к перегрузке сервера и лишить другие приложения системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-345">If you raise the scan interval so that it runs very infrequently (for example, once a day at midnight), all of the data refresh operations that were scheduled to run during that interval are added to the processing queue all at once, potentially overwhelming the server and starving other applications of system resources.</span></span> <span data-ttu-id="dd7eb-346">В зависимости от количества запланированных обновлений очередь обработки операций обновления данных может разрастись настолько, что не все задания смогут завершиться.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-346">Depending on the number of scheduled refreshes, the processing queue for data refresh operations might build up to such an extent that not all jobs will be able to complete.</span></span> <span data-ttu-id="dd7eb-347">Запросы обновления данных, попавшие в конец очереди, могут быть отменены, если попадут в следующий интервал обработки.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-347">Data refresh requests at the end of the queue might be dropped if they run into the next processing interval.</span></span>

 <span data-ttu-id="dd7eb-348">Если позволяет оборудование, можно уменьшить этот риск, указав дополнительные процессоры, которые понадобятся для параллельного запуска большего числа заданий обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-348">If your hardware supports it, you can mitigate this problem by specifying additional processors to run more data refresh jobs in parallel.</span></span> <span data-ttu-id="dd7eb-349">Дополнительные сведения см. в статьях [Настройка выделенного обновления данных или обработка только запросов &#40;PowerPivot для SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-349">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span> <span data-ttu-id="dd7eb-350">Дополнительные сведения об обнаружении запросов на обновление данных, добавлении их в очередь и обработке см. в разделе [PowerPivot Data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span><span class="sxs-lookup"><span data-stu-id="dd7eb-350">For more information about how data refresh requests are discovered, added to a queue, and processed, see [PowerPivot Data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span></span>

1.  <span data-ttu-id="dd7eb-351">В центре администрирования нажмите **Наблюдение**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-351">In Central Administration, click **Monitoring**.</span></span>

2.  <span data-ttu-id="dd7eb-352">Щелкните **проверить определения заданий**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-352">Click **Review Job Definitions**.</span></span>

3.  <span data-ttu-id="dd7eb-353">Выберите **Задание таймера обновления данных PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-353">Select the **PowerPivot Data Refresh Timer Job**.</span></span>

4.  <span data-ttu-id="dd7eb-354">Измените указанную в расписании частоту, с которой задание таймера сканирует сведения о расписании обновления данных.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-354">Modify the schedule frequency to change how often the timer job scans for data refresh schedule information.</span></span>

##  <a name="disable-the-data-refresh-timer-job"></a><a name="bkmk_disableDR"></a><span data-ttu-id="dd7eb-355">Отключение задания таймера обновления данных</span><span class="sxs-lookup"><span data-stu-id="dd7eb-355">Disable the Data Refresh Timer Job</span></span>
 <span data-ttu-id="dd7eb-356">Задание таймера обновления данных PowerPivot представляет собой задание таймера уровня фермы, которое можно либо включить, либо отключить для всех экземпляров сервера PowerPivot в пределах фермы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-356">The PowerPivot data refresh timer job is a farm-level timer job that is either enabled or disabled for all PowerPivot server instances in the farm.</span></span> <span data-ttu-id="dd7eb-357">Оно не привязано к конкретному веб-приложению или приложению службы PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-357">It is not tied to a specific Web application or PowerPivot service application.</span></span> <span data-ttu-id="dd7eb-358">Его нельзя отключить на отдельных серверах фермы для ускорения обработки обновления данных на других серверах этой фермы.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-358">You cannot disable it on some servers to force data refresh processing to other servers in the farm.</span></span>

 <span data-ttu-id="dd7eb-359">Если отключить задание таймера обновления данных PowerPivot, запросы, которые уже попали в очередь, будут обработаны, но новые запросы не будут добавляться в очередь, пока задание не будет снова включено.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-359">If you disable the PowerPivot data refresh timer job, requests that were already in the queue will be processed, but no new requests will be added until you re-enable the job.</span></span> <span data-ttu-id="dd7eb-360">Запросы, момент запуска которых по расписанию прошел, запускаться не будут.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-360">Requests that were scheduled to occur in the past are not processed.</span></span>

 <span data-ttu-id="dd7eb-361">Отключение задания таймера не влияет на доступность функций на страницах приложения.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-361">Disabling the timer job has no effect on feature availability in application pages.</span></span> <span data-ttu-id="dd7eb-362">Спрятать или убрать функцию обновления данных в веб-приложениях невозможно.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-362">There is no way to remove or hide the data refresh feature in web applications.</span></span> <span data-ttu-id="dd7eb-363">Пользователи, имеющие разрешения уровня «Участие» или выше, смогут создавать новые расписания для операций обновления данных, даже если задание таймера постоянно отключено.</span><span class="sxs-lookup"><span data-stu-id="dd7eb-363">Users who have Contribute permissions or above will still be able to create new schedules for data refresh operations, even if the timer job is permanently disabled.</span></span>

## <a name="see-also"></a><span data-ttu-id="dd7eb-364">См. также:</span><span class="sxs-lookup"><span data-stu-id="dd7eb-364">See Also</span></span>
 <span data-ttu-id="dd7eb-365">[Запланируйте обновление данных &#40;PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [настроить выделенное обновление данных или обработку только для запросов &#40;PowerPivot для SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [настроить учетную запись автоматического обновления данных PowerPivot &#40;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) PowerPivot для SharePoint&#41;[Настройка сохраненных учетных данных для обновления данных PowerPivot &#40;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) PowerPivot для SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="dd7eb-365">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)</span></span>


