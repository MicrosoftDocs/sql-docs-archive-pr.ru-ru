---
title: Расчет прогноза (средства анализа таблиц для Excel) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- mining model, regression
- Table Analysis tools
- scorecard
- logistic regression
- prediction calculator
ms.assetid: 8bb8c318-e85f-4fd6-b32b-4cdfb13ca1b5
author: minewiskan
ms.author: owend
ms.openlocfilehash: c6e7aece740dc1b9dab0b27affc76954bf372d8a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750287"
---
# <a name="prediction-calculator-table-analysis-tools-for-excel"></a>Расчет прогноза (средства анализа таблиц для Excel)
  ![Расчет прогнозов](media/tat-predcal.gif "Расчет прогнозов")  
  
 Средство **Расчет прогноза** помогает создать систему показателей, которую можно использовать для анализа новых данных и оценки параметров или риска. Например, если у вас есть исторические и демографические данные о клиентах, средство **Расчет прогноза** может помочь вам в использовании двух ключевых задач:  
  
-   формирование базового демографического анализа, поведения при покупках и различных других факторов;  
  
-   создание рабочего оценочного листа, помогающего оценить членов и сделать рекомендации для предложений новых продуктов или услуг.  
  
 Мастер также создает лист, в котором хранятся все базовые вычисления, так что пользователь может взаимодействовать с моделью и видеть, как различные входные значения влияют на окончательную оценку.  
  
 При необходимости мастер может также создать печатную версию листа, которую можно использовать для автономной оценки. Нельзя взаимодействовать с моделью, как это можно с книгой Excel, но печатная версия предоставляет все расчеты, необходимые для ввода значений и вычисления окончательной оценки.  
  
## <a name="using-the-prediction-calculator-tool"></a>Использование средства «Расчет прогноза»  
  
1.  Откройте таблицу Excel, содержащую данные для анализа.  
  
2.  Щелкните **Расчет прогноза** на вкладке **анализ** .  
  
3.  В диалоговом окне **Расчет прогноза** в поле цель выберите столбец, который необходимо спрогнозировать, например поведение при покупке.  
  
4.  Укажите целевое значение. Если значение является числовым, используйте параметр **в поле диапазон**, а затем введите минимальное и максимальное значения для нужного диапазона. Если значение дискретное, выберите параметр **точно** , а затем выберите значение из раскрывающегося списка.  
  
5.  Нажмите кнопку **выбрать столбцы для использования при анализе**.  
  
6.  В диалоговом окне **Расширенный выбор столбцов** выберите столбцы с полезной информацией. Удалите все столбцы, не имеющие отношение к анализу. Нажмите кнопку **ОК**.  
  
     Чтобы избежать смещения результатов, необходимо также удалить столбцы с повторяющимися данными. Например, если имеется столбец «Доход», содержащий числовые данные, и столбец «Группа дохода», содержащий метки «Высокий», «Средний» и «Низкий», нельзя включать оба столбца в одну модель. Вместо этого можно создать отдельную модель для каждого столбца.  
  
7.  В разделе **Параметры вывода** выберите **оперативный калькулятор** для создания анализа и показателей в книге Excel. Выберите **калькулятор, готовый для печати** , чтобы создать анализ, а также создать отчет, который можно распечатать и использовать для оценки вручную.  
  
8.  Нажмите кнопку **Запустить**.  
  
     Средство создает новые листы, содержащие отчеты и оценочные листы.  
  
### <a name="requirements"></a>Требования  
 Средство **Расчет прогноза** использует алгоритм логистической регрессии (Майкрософт), который может работать с дискретными значениями, а также дискретными и непрерывными числовыми данными.  
  
## <a name="understanding-the-scoring-reports"></a>Основные сведения об отчетах оценки  
 При выборе обоих параметров выхода расчет прогноза создает следующие три новых листа в текущей книге.  
  
-   **Прогнозирующий отчет**, который содержит результаты анализа, заполненные интерактивными таблицами и графами, которые помогают экспериментировать с взаимодействием и прибылью.  
  
-   Интерактивный **Расчет прогноза** , который помогает создавать оценки.  
  
-   Калькулятор с возможностью **печати** с инструкциями и коэффициентами, которые следует использовать для оценки.  
  
-   В этом разделе описываются сведения каждого отчета, а также способы использования различных параметров отчетов.  
  
### <a name="prediction-report-with-graphs"></a>Отчет прогноза с графиками  
 Первый прогнозный отчет озаглавлен **Расчет прогноза отчет для \<target state> \<target attribute> **. Отчет содержит таблицу коэффициентов, определенных в результате анализа, вместе со средствами оценки влияния конкретного анализа на финансовые показатели.  
  
#### <a name="table-for-specifying-costs-and-profits"></a>Таблица для указания затрат и прибылей  
 Первым средством в этом отчете является находящаяся в левой верхней части отчета таблица, в которой можно указать затраты и прибыли, связанные с верным и неверным прогнозом значения.  Значения расходов и прибыли необходимы, чтобы вычислить оптимальный оценочный порог для калькулятора.  
  
|Элемент|Описание и пример|  
|----------|-----------------------------|  
|Ложный положительный результат — расходы|Затраты в предположении, что модель правильно прогнозировала положительный результат, если в действительности прогноз неверен.<br /><br /> Например, модель прогнозирует, что клиент купит что-то, и на основании этого рекомендуется кампания, имеющая своей целью этого клиента. Здесь можно ввести стоимость оказания помощи клиенту.|  
|Ложный отрицательный результат — расходы|Затраты в предположении, что модель правильно прогнозировала отрицательный результат, если в действительности прогноз неверен.<br /><br /> Например, модель могла прогнозировать, что пожилые клиенты вряд ли будут покупать велосипеды, но обнаруживается, что модель была искажена, и в результате был упущен шанс привлечь пожилых клиентов. Здесь можно назначить стоимость утраченной возможности.|  
|Истинный положительный результат — прибыль|Прибыль в результате правильного прогнозирования положительного результата. Например, если целью является привлечение правильных клиентов и результаты помощи при продаже, здесь можно было бы ввести прибыль на каждого клиента.|  
|Истинный отрицательный результат — прибыль|Прибыль в результате правильного прогнозирования отрицательного результата.<br /><br /> Например, если можно правильно определить клиентов, на которых не следует рассчитывать, здесь можно ввести сумму, затрачиваемую на рекламу на одного клиента.|  
  
#### <a name="chart-for-viewing-maximum-profit"></a>Диаграмма для просмотра максимальной прибыли  
 При вводе в таблицу данных автоматически обновляются соответствующие графики для отображения наилучшей точки для наибольшего увеличения доходов при текущей модели. На линейном графике права от таблицы отображается прибыль для различных порогов оценки. Прибыль оценивается с помощью показателей прибыли и затрат, вводимых в таблицу, на основании прогнозов и значений вероятности, получаемых из модели.  
  
 Например, если в верхней левой таблице ячейка **с предложенным пороговым значением для достижения максимальной прибыли** выводит значение 500, то на диаграмме справа будет отображаться 500 в качестве самой высокой точки на линейном графике. Значение 500 означает, что для максимизации прибыли необходимо использовать 500 первых рекомендаций модели интеллектуального анализа данных, представленных в порядке убывания вероятности.  
  
#### <a name="table-listing-scores-for-each-attribute-and-value"></a>Табличные списки оценок для каждого атрибута и значения  
 В таблице в нижнем левом углу отчета показано подробное разбиение полученных значений и показатели того, как каждое значение влияет на результат. Значения в этой таблице изменять нельзя; они отображаются, чтобы облегчить понимание прогноза.  
  
 Например, в следующей таблице показан пример результатов, где целевым результатом является покупка клиентом велосипеда.  В таблице перечислены все входные столбцы, использованные в модели, независимо от того, повлияли ли эти входные данные на модель. В таблице также перечислены дискретные и дискретизированные значения, если входной столбец содержал непрерывные числовые данные.  
  
 Значения в столбце **относительного влияния** — это вероятности, представленные в виде процентных долей. Затенение ячейки служит визуальным представлением влияния этого значения на результаты.  
  
|attribute|Значение|Относительное влияние|  
|---------------|-----------|---------------------|  
|Семейное положение|Состоит в браке|0|  
|Семейное положение|Single|71|  
|пол;|Жен.|13|  
|пол;|Муж.|0|  
  
 Эти значения можно интерпретировать следующим образом.  
  
-   Если клиент состоит в браке, это не влияет на вероятность покупки велосипеда.  
  
-   Однако, если клиент не состоит в браке, это является устойчивым признаком (70 процентов), что он купит велосипед.  
  
-   Пол клиента имеет лишь незначительное влияние (13 процентов) на прогнозируемое поведение в покупке велосипеда, если этот клиент — женщина, и не влияет на прогнозируемое поведение, если клиент — мужчина.  
  
#### <a name="chart-of-cumulative-misclassification-cost"></a>Диаграмма совокупных затрат ошибок классификации  
 На диаграмме с областями в нижней правой части отчета показаны совокупные затраты ошибок классификации для различных пороговых значений оценки. На этой диаграмме используются также показатели затрат и прибыли, вводимые для ложных положительных, истинных положительных, ложных отрицательных и истинных отрицательных результатов.  
  
 В отличие от диаграммы в верхнем правом углу отчета, ориентированной на максимальное увеличение прибыли, эта диаграмма включает стоимость неверного прогноза. Эта диаграмма особенно полезна в таких сценариях, как предотвращение, где стоимость принятия неверного решения значительно перевешивает стоимость правильного угадывания.  
  
 Например, хотя на первой диаграмме предполагается, что ориентирование на 500 наиболее выгодных клиентов в модели является способом максимального увеличения прибыли, после просмотра второй диаграммы можно решить, что стоимость неправильного выбора целевых клиентов слишком велика, и вместо этого можно решить ориентировать маркетинговую кампанию на 400 наиболее выгодных клиентов.  
  
### <a name="interactive-prediction-calculator"></a>Интерактивный расчет прогноза  
 Второй лист, созданный средством расчет прогноза, заголовком **Расчет прогноза для \<target state> элемента \<target attribute> **. Именно этот интерактивный лист можно использовать для расчета отдельных оценок. Так как этот лист использует закономерности и статистические данные, хранящиеся в модели, можно поэкспериментировать с различными значениями и посмотреть, как они влияют на прогнозируемую оценку. Этот отчет также содержит два раздела: один интерактивный, а другой — как ссылка.  
  
#### <a name="first-table"></a>Первая таблица  
 Можно выбрать или ввести новое значение в столбце **значение** таблицы, чтобы увидеть, как изменение значения влияет на оценку.  
  
 Например, если отчет содержит следующие значения, можно уменьшить значение «Автомобили» до 1, а затем до 0, чтобы посмотреть, как это влияет на поведение клиента при покупке. При изменении значения **автомобилей** на 0 прогноз в нижней части изменяется на true.  
  
|attribute|Значение|Относительное влияние|  
|---------------|-----------|---------------------|  
|Семейное положение|Состоит в браке|0|  
|пол;|Муж.|0|  
|Доходы|39050-71062|117|  
|Дети|0|157|  
|Образование|Бакалавры|22|  
|Род занятий|Квалифицированный ручной труд|33|  
|Владелец дома|Да|8|  
|Автомобили|2|50|  
|Расстояние до работы|0–1 км|99|  
|Регион|Северная Америка|0|  
|Возраст|37-46|5|  
|Итог||491|  
|Прогноз для «Да»||FALSE|  
  
 При вводе нового значения оценка, отображаемая в ячейке, прогноз для «да», изменяется на «истина», и также обновляются показатели **относительного влияния** для различных атрибутов.  
  
> [!NOTE]  
>  Даже при изменении только одного значения, например числа автомобилей, значения и влияние других атрибутов могут также измениться. Это является следствием того, что модели интеллектуального анализа данных часто находят сложные связи между данными, и изменение одной переменной может сказаться непредвиденным образом. Поэтому рекомендуется использовать интерактивное средство «Расчет прогноза» для экспериментирования с разными значениями или просмотреть модель интеллектуального анализа данных, чтобы лучше понять взаимодействия. Дополнительные сведения см. в разделе [Обзор моделей](prediction-calculator-table-analysis-tools-for-excel.md).  
  
#### <a name="score-breakdown"></a>Распределение рейтинга  
 В этой таблице показаны отдельные оценки для каждого возможного состояния входных столбцов и относительное влияние, которое оценка оказывает на результаты. Эта таблица является статической и отображается только для справки.  
  
### <a name="printable-prediction-calculator"></a>Рачет прогноза с возможностью печати  
 Третий лист, созданный средством расчет прогноза, называется **Принтаблепредиктион калькулятором для \<target state> \<target attribute> **. Этот оценочный лист можно напечатать, так что с его помощью можно вручную рассчитывать оценки, если нет под рукой компьютера.  
  
##### <a name="to-print-and-use-the-scoring-report-generated-by-the-prediction-calculator"></a>Печать и использование отчета оценки, формируемого средством «Расчет прогноза»  
  
1.  Щелкните вкладку с заголовком **Расчет прогноза для \<attribute> печати **.  
  
2.  В меню файл Excel выберите **Предварительный просмотр**.  
  
3.  Измените ориентацию страницы, поля и другие параметры печати, чтобы разместить оценочный лист на странице.  
  
     Это статический оценочный лист, и он не связан с моделью, так что можно перемещать столбцы и строки для улучшения форматирования, не влияя на базовые данные.  
  
4.  Напечатайте оценочный лист.  
  
5.  Для каждого атрибута выберите только одно значение. Для выбранного значения установите флажок в поле и запишите соответствующий номер в столбце **Оценка** .  
  
6.  Чтобы обеспечить точность, заполните как можно больше атрибутов.  
  
7.  Вычислите сумму оценок для каждого атрибута и введите это число в строке **итогов** .  
  
8.  Преобразуйте оценку в прогнозируемый результат, используя критерии, выводимые на листе сразу после строки **итогов** .  
  
## <a name="related-tools"></a>Дополнительные средства  
 Службы [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] предоставляют алгоритм логистической регрессии (Майкрософт) для использования в анализе этого типа. Если вы уже знакомы с логистической регрессией, можно легко создавать модели логистической регрессии с помощью **расширенного** параметра клиента интеллектуального анализа данных для Excel. Дополнительные сведения см. в разделе [Расширенное моделирование &#40;надстроек интеллектуального анализа данных для Excel&#41;](advanced-modeling-data-mining-add-ins-for-excel.md). Дополнительные сведения о параметрах и параметрах для моделей логистической регрессии см. в разделе «Алгоритм логистической регрессии (Майкрософт)» [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] электронной документации по.  
  
## <a name="see-also"></a>См. также:  
 [Средства анализа таблиц для Excel](table-analysis-tools-for-excel.md)  
  
  
